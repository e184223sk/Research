More than 1 year has passed since last update.C#のNAudioライブラリを使ってwaveファイルの再生を行い、その際、smplチャンクを見てループに対応したストリーム再生をします。ソースファイルはgithubに置いてあります。
https://github.com/unknown-ds/sndstrm_play GitHub Link Card Creator を利用させて頂きました。Windiws 10
Visual Studio Express 2017 for Windows DesktopNAudio ver.1.8.5waveフォーマットのまとめ。
必須のfmtとdataとループ情報のsmplチャンクについて。データフォーマットが記載されています。オーディオデータの実体部分です。よくわからないデータが多いですが、ループ数cSampleLoopsとループ情報の開始dwStart, 終了dwEndあたりだけ着目します。後ろにループ情報が付きます。テスト用ファイルtest.wavです。以下のような音源で左チャンネル再生、右チャンネル再生、ステレオ再生を行った後、7秒の位置(ステレオ再生位置)へループ指定しています。ほとんど BufferedWaveProvider に投げているだけです、現在の再生位置が欲しい場合は、自前で計算する必要があります。
また、ループ情報は１つのみで回数無限としています。チャンクデータの確認とbufferedWaveProviderやwavePlayerの用意を行っています。バッファは別で監視を行っているためPlay()した後は何もしていません。await でディレイをかけて一定時間置きにバッファを監視して空いた部分に音源のバイトデータを追加しています。ループ処理部分を工夫すればイントロ-&gt;ループ-&gt;アウトロのようなデータも再生できます。（綺麗につなぐためのデータの作成が大変だと思います）単純にループで再生させる場合以下のようなコードでいけます。
ただしループ時にわずかにノイズが乗る感じがします。（waveファイルデータ次第？）


