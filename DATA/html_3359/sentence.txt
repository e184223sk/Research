More than 1 year has passed since last update.VOICEROID2の琴葉茜ちゃんをPowerShellでしゃべらせます。この際、なるべくどこでも動くように、UIAutoMationを使用します。環境：古式ゆかしいWindowsアプリの実装ではないので、Spyでは茜ちゃんの画面構成を調べることはできません。
Inspect.exeを使用して、茜ちゃんを隅々まで調べてから実装しましょう。Inspect
https://docs.microsoft.com/en-us/windows/desktop/winauto/inspect-objectsPowerShellでいきなり実装するのは辛いので、まずC#で実装してみます。※ボタンの増減で動かなくなるコードです続いてPowerShellで実装します。PowerShellのスクリプトファイルを実行するには管理者権限を用いて実行ポリシーを変更するか、以下のようにバッチファイル経由で実行ポリシーを指定して起動します。…実は、UIAutomationでは自動操作できない箇所があります。
ボイスとチューニングにあるタブの中身のコントロールは操作できません。UIAutomation で タブの内側の要素が取れない
https://teratail.com/questions/53276上記のページに記載してあるとおりアプリの作り方によって、タブの中身の情報がとれなくなるようです。なお、偉大なる先駆者様はFriendlyというライブラリを使って解決しているようです。TTSController
https://github.com/mikoto2000/TTSControllerFriendly
https://github.com/Codeer-Software/Friendly


