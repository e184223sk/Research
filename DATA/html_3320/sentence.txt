Freeradicalの中の人、yamarahです。
私が知っているだけでも、片手以上のAPIのbugがあるのですが、明らかに気付くbugは除外して、気づきにくいbug、つまりははまりやすいbugについて記載します。結論を言うと、都度dummyにnullをセットすると良い。これはVBAにおけるValiant型のハンドリングについて、inventor.interop.dll内にbugがあるんだろうけど、とにかく事前にnullを入れておけば大丈夫。実際に私がはまった時の形はこれ。これの2行目で落ちられたら、byteArrayの方を疑ってしまって、時間がかかったよ。下のコメントにある通り、特定の条件においてActivatedObjectの値が信用できない。SelectEventsに限らないのかもしれませんが、EventHandlerを持っているobjectへの参照を保持していないと、追加した関数は実行されません。
例えば、このcodeでは、「原則的に」SelectEvents_OnPreSelectとSelectEvents_onSelectが実行されません。
実行させるには、コメントアウトしてある2行を有効にする必要があります。
さて、「原則的に」と括弧書きにした理由は、InteractionEvents.Start()した直後の数百ミリ秒だけは反応するからです。例えば、通常のPlanarSketch編集中に直線を選択して実行すれば、その直線に垂直拘束が付与されます。
しかし、SketchBlockDefinitionを編集中に(一般的にはスケッチブロック編集中に)、直線を選択して実行すると、エラーが発生します。
どうやら、SketchBlockDefinition.GeometricConstarints.AddXXX()は全滅のようです。Inventor2022で"モデル状態"なるものが導入されました。これの詳細については本稿から外れるので各自ググってもらうとして、問題として2021年5月現在では、Model状態が有効なドキュメントのiProertyをApprenticeServerから変更できません。例えば部品番号を変更できないので、該当ドキュメントをデザインアシスタントで操作できないという事態になっています。
Autodeskはこの問題を認識しているので、厳密にはバグではないのかもしれませんが、当然この問題は解消されるべきだし、そうなると信じてここに記しておきます。APIに限らず、Inventorに関するbugを見つけた場合に、ユーザーはどうすれば良いのでしょう?
信じがたいことに、Autodeskには公のbug報告の窓口がありません。これらの方法は、どうも効果がないように見えます。今、一番効果があるのは、Autodesk Feedback Communityに登録して、Inventorのベータ登録をし、そこでbugレポートを上げることです。
当然、英語での報告になるのでハードルは高いのですが、Autodeskとして不具合を認識し(Defect Accepted)、開発チームのデータベースに載ったかまでは、確実に分かります。
Defect Acceptedが、必ずしもbug修正と同義ではない(放置されることも多々ある)のですが、現時点では一番有効な方法だと思います。Autodesk Inventor API Hacking (概略)


