以下のMicrosoftドキュメントを参考に作成してみました。ドキュメント通りに動かなかった箇所があり、いくつか修正をして動くようにしたので記事にしてみました。ドキュメントの方では、を使って、JSONの処理をしますが、私がこの通りにやった時にうまく動かなかったため、「Newtonsoft.Json」を使いました。
おそらくFamilyクラスのIdをキーに使う際に小文字のidに適用させたいところ、うまく小文字のidにならなかったのが原因なのかなと思います。ドキュメント通りです。
フィールド変数のEndpointUrlとAuthorizationKeyは前提で取得しておいたURIとプライマリキーに書き換えればOKです。
ここから、Main関数で実行されている関数たちを定義していきます。databaseの型はCosmosDatabaseではなく、Databaseに書き換えています。containerの型はCosmosContainerではなく、Containerに書き換えています。id取得の際にドキュメントでは
andersenFamilyResponse.Value.IdやwakefieldFamilyResponse.Value.Idといった形で取得していますが、うまく取得できませんでした。
私の場合はandersenFamilyResponse.Resource.IdやwakefieldFamilyResponse.Resource.Idに書き換えることで取得できるようになりました。ここは、割とドキュメント通りには動きませんでした。上記のように修正することでうまく動くようになります。
やりたいことは同じだと思います。ちなみに、familiesのリストがありますが、使わなかったのでコメントアウトしています。wakefieldFamilyResponse.Valueではなく、wakefieldFamilyResponse.Resourceぐらいでほとんどドキュメント通りです。containerの型はCosmosContainerではなく、Containerに書き換えています。databaseの型はCosmosDatabaseではなく、Databaseに書き換えています。全体的に動くように、細かい部分で書き換えています。
説明できずに書き換えている箇所もあるかもしれませんが、ご理解お願いします。


