More than 3 years have passed since last update.VisualStudioには標準で依存関係プロパティと添付プロパティのコードスニペットが組み込まれています。
しかし、これらのコードスニペットは古くイマイチな部分があります。
そこで最新のC#7の文法に合わせた新しいコードスニペットを定義します。とりあえず使ってみたい場合は最後の使用方法だけ参照ください。まず、VisualStudio組込バージョンと今回作ったNewバージョンの実行結果を比較します。↓↓これは好みが分かれるところですが、複数の依存関係or添付プロパティが並んだ場合に読みやすくなります。
そもそもregionが必要になること自体が言語設計に問題があることを実はこのコードスニペット全体でC#7が必要なのは依存関係プロパティのgetterのみ依存関係プロパティ自体の説明を個別のプロパティの中に入れる必要性無いですよね。実行結果だけだと前と変わらないように見えますが、コードスニペットを実行した場所のクラス名が自動で入るようになりました。
後述するコードスニペット内の&lt;Function&gt;ClassName()&lt;/Function&gt;の機能です。
コンストラクタのコードスニペットctorと同じ動きです。文字列からnameof演算子にすることでより安全になります。添付プロパティでも使用したかったのですが、そもそも添付プロパティには
$プロパティ名$Propertyはいても$プロパティ名$はいなかったので、できませんでした。どうしても添付プロパティでも文字列指定を削除したい場合は
プロパティ名を取得するメソッドを別に用意して、引数にCallerMemberNameを使えばできます。PropertyMetadataの既定値が型に関係なく常に0だったのをdefault(型)に変更
コードスニペットのLiteralのDefaultは他のLiteralの値を使用できないので、型名Literalを元にMetadata既定値にしています。ただしMetadata既定値用のLiteralはDefaultを空にして残してあるので、既定値を変更したい場合はジャンプすることができます。ちなみにうっかり以下のようにすると既定値がnullになります。既存のコードスニペットを削除します。場所は以下のところに書いてあります。
VisualStudio上Menu＞ツール＞コードスニペットマネージャ＞NetFX30私の環境(VS2017)では以下の場所でした。
C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC#\Snippets\1041\NetFX30次に以下2つのコードスニペットをファイルに保存してコードスニペットマネージャからインポートします。DependencyProperty.snippet-GitHub
AttachedProperty.snippet-GitHub


