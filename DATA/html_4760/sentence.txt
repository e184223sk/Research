More than 3 years have passed since last update.TwitterのUserStreamの廃止が8/16に迫ってきましたが皆さんいかがお過ごしでしょうか。ここでは、応急処置としてフォローを全てコピーしたリストを作り、それを読み込ませることで既存のサードパーティークライアントで使う方法を解説したいと思います。※公式アプリや、公式ブラウザで閲覧する場合この処置は不要です
※大量に（1000、2000単位）でリストを一気に追加すると、Twitterからスパム認定（？）されて一時的にリスト登録が制限されるケースがあります。自分はなりました。手加減しながらやってみてください。UserStreamでなくホームタイムラインをAPIから取得する場合、「GET statuses/home_timeline」を使います。ただし、これはレート制限がえらく少なく15分で15回しか呼び出せません。つまりツイ廃のように15秒、30秒単位でホームを更新してるとすぐレート切れを起こします。一方でリストの読み込みは「GET lists/statuses」ですが、こちらのAPI上限は潤沢で15分で900回呼び出せます。（注意）いくら15分900回読み込めるといっても、リストを1秒単位で更新とかするとDoS攻撃と誤認されるおそれが高いので、常識的な頻度にするようにしてください。また、リストの呼び出し回数はリスト単位ではなく、ユーザー単位・アプリケーション単位で900/15minなので、マルチタブにする場合は他のリストの呼び出し回数も考慮するようにしてください。リストはTwitterの仕様上、1リストに5000人まで登録できます。未だにUserStream使っている人よりも、フォローが5000人越えている人のほうが（おそらく）少ないと思われるので、フォローが5000人までのUserStreamなくなったら困るという人にはかなりコストパフォーマンスの高い方法だと思います。リストの追加には「POST lists/members/create_all」というAPIを使うのですが、このドキュメントによると、Please note that there can be issues with lists that rapidly remove and add memberships. Take care when using these methods such that you are not too rapidly switching between removals and adds on the same list.という注意書きがあります（要は短期間に大量の人を同一のリストに入れたり削除したりするな）。自分も一気に2100人ぐらいリストに突っ込もうとしたら、1900人突っ込んだ後から突っ込めなくなりました。こうなるとブラウザから手動で突っ込もうとしても蹴られます（「その操作は許可されていない」とか怒られます）。丸1日経ったら解除されましたが、この基準が公開されていなくよくわからないのでフォローが多い方は手加減しながらやってください。Twitter Application Managerから権限を「Read/Write」でアプリケーションを作成し、CosumerKey、ComsumerSecretを取得します。電話番号認証が必要な場合もあります。今回は自分で使うだけのアプリケーションなので、ページの下にある「Your Access Token」のAccessToken、AccessTokenSecretをそのまま利用します。違うアカウントを認証させたい、不特定多数に利用させたい場合は、oAuthで認証させてください。oAuthのやり方はCoreTweetの公式Wikiを参考にしてください。NuGetから「CoreTweet」をダウンロードしてきます。以下コンソールアプリで作ります。CoreTweet側からやってもいいのですが、面倒なのでブラウザで新しいリストを作っておきます。ここでは名前を「timeline」としておきましょう。他の方法でも取得できるかもしれませんが、先程作ったtimelineのリストIDを取得します。自分で使うアプリなので、トークンの類はSettingsのクラスにハードコーディングさせました。これをgithubに公開するとTwitter垢乗っ取られるから気をつけてね。出力ではリストIDとリスト名の対応が出てきます。名前が「timeline」のIDをコピーしておきます。これがメインコードです。listidのところに先程抜いたtimelineのリストIDを代入します。フォロー数が多い場合はループを分割するか、Delayの値を増やすかで調整してください。フォローをすべてコピーしたリストが出来上がりました。自分の場合は途中怒られて丸一日かかってしまいましたが、フォロー数が少なかったり、ちゃんと手加減しながらやればすぐできるはずです。自分はしばらくこれで様子を見ようと思います。クライアントアプリのソースをいじることなくできるので、ユーザー側の対応としてはコストパフォーマンスいいんじゃないのかな？と思います。


