More than 3 years have passed since last update.これは、Visual Basic Advent Calendar 2016 の24日目の記事となります。メリークリスマス！。今年は映画の「君の名は。」が大ヒットしましたね。勤めている会社の近くに映画館があるので、サービスデイを選んで映画をよく観に行きます。
「君の名は。」ですがアニメという前提知識だけで監督やプロデューサーが誰とか知らないでスポーツジムで疲れた後に観ました。つまらないと寝てしまうかもと思って見始めたのですがそんなことは全く無く、むしろ観終わった後にこんな脚本を自分でも書いてみたいと思った程です。さて、「君の名は。」の2大要素といえば、入れ替わりとタイムリープですよね。
これをモチーフにして.NETの2大言語であるVisual BasicとC#で何かしらやってみようという試みです。映画『君の名は。』で有名なワンシーン
「これってもしかして、俺たち・私たち、入れ替わってるー！？」体はVisual Basicなのに、心はC＃体はC＃なのに、心はVisual Basic※Microsoft.CodeAnalysis.VisualBasic.Scriptingについては、NuGetパッケージの管理の検索では見つからず、パッケージマネージャーコンソールからインストールしました。2011年に隕石("Roslyn"(ロズリン))が落下してきました。1それから4年後のVisual Studio 2015に次世代コンパイラRoslyn改め.NETコンパイラープラットフォームとして搭載されました。
これにより前述の入れ替わり(.NET4.6以降)が出来るようになり、C#に置いていかれていた印象2があったVisual Basicも機能的にはほぼ追いつきました。3
Visual StudioのIDEにおいては、リファクタリング機能やインポートの整理と並び替えがC#同様に出来るようになりました。やっと、C#に「君の名は」と尋ねることが出来るのです・・・かなりかなり強引ではありますが、「君の名は。」を実現してみ・ま・し・た・・・。あーものを投げないで・・・！！「君の名は。」については下記のネタでも使いました、良かったらご覧ください。
TensorFlowコトハジメ Word2Vecで「君の名は。」と戯れてみたRoslynは2011年に初のCTP（コミュニティ技術プレビュー版）を発表 ↩大きな新機能(async, await, Task)はVS2010でC#同様に追加されたが、「yield」などはVS2012でやっと追加された。 ↩ラムダ式の制限が多かったり、逐語的リテラル文字列、式の途中でコメント、メソッド内のリージョンなどが出来ないなど格差がありました。 ↩


