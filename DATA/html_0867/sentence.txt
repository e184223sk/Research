More than 1 year has passed since last update.Microsoft Docs 右側のサイドメニュー？みたいなのをWPFで作らないといけなかったので、自分の実装方法を備忘録として書いておきます。githubにソースコード置いています。
https://github.com/pisa-kun/SideBarSample先にどんな感じのものを作ったかを公開しておきます。Grid.Column をサイドメニューとメイン部分(選択されたサイドメニューで切り替わるコンテンツ)で二分割しています。
サイドメニューのボタンはとりあえず二つ用意し、メイン部分には今回何も割り当てていません。あくまでサイドメニューのデモということで。マウスオーバーされるとボタンの背景を少しだけ白で透過(15%程度)させます。マウスクリックされるとマウスオーバー時よりも白で透過(30%)させています。マウスクリックされて選択中になると左側に白の長方形が表示され、ボタンの背景も白で透過させます。ButtonAを選択中にButtonBをクリックすると、ButtonAの選択中を解除してButtonBを選択中にするところまでできています。次からソースコードの解説になります。
プロジェクト構成は下記のようにしています。必要そうな箇所のみ説明します。ToggleButtonのテンプレートを編集して無理やりRectangle, Image, TextBlockをまとめて一つのそれっぽいコントロールを作っています。ImageのSourceプロパティ、TextBlockのTextプロパティ、ToggleButtonのIsCheckedとCommandプロパティはDependencyPropertyを使ってMainWindow.xamlで設定できるようにしておきます。また、ControlTemplate.Triggersでマウスオーバー、マウスプレス、クリック時などの条件でRectangleのVisibilityやPanelのBackgroundを調整します。コードビハインド(MainWindow.xaml.cs)についてはコンストラクタに this.DataContext = new ViewModel();を追加しているだけなので割愛します。説明すべきは下記の部分でしょうか。ImageFileNameにpng画像のファイルパスをセット。
ButtonCommandに押されたときのAction、IsSelectedに選択中かどうかのbool値をViewModelからBindingします。viewModelではbool型のButtonプロパティとDelegateCommandを記述します。ButtonCommandについてはMessageBoxを表示してButtonのプロパティを変更することを行っています。
アプリとして完成させるならメイン画面のページ遷移などをここに記述しましょう。UWPだとすでにこういうコントロールあるんでしょうか。


