More than 5 years have passed since last update.前稿を受けて、サブクラス化にてカラム直接編集を実現してみたいと思います。序なので、ふっかちゃんバージョンも紹介しときましょう。
ただ、実はふっかちゃん、MSのサイトからうまくコピーできないパターンがあります。（改行がぐちゃぐちゃで…）
copyしてくる時はちょっと古めの下記サイトを参照してください。（両方必要です）あ、後 Win32 の中に
[DllImport("coredll.dll")]
ってのが11ヶ所ありますが、何か宜しくないので、
[DllImport("user32.dll")]
に変えて下さい。問題ない筈です。前稿のコードに前出ふたつのコードを合わせた上で、以下の様にコードを追加すればOKです。ListView のスクロールバーを触ると、直接編集ちっくモード抜けたでしょ？
ふっかちゃん、中々やるなーいきなりソース！
のみっ！いやいや、使用説明だけはしなくては…使いたいプロジェクトの中に ListVIewEx.cs のクラスファイルを追加して、上記ソースをまるっと貼り付けちゃって下さい。
一旦全体ビルドしたら、ツールボックスに ListViewEx が増えている筈なのでデザイナ画面で使えます。（勿論ビルドエラーがあったらダメですよ）

機能は名前から推し量って下さい。（投げやり）EditColumn メソッドはフォームに張り付けた ListViewEx の MouseDoubleClick イベント辺りで必要性を確認の上呼びだす仕様です。

コードで説明すると、こんな感じ↓
これで前稿と同じく、カラム2だけが編集対象となります。一つ忘れものがありました。
カラムサイズを調整した時にもモード抜けないといけないですね。サブクラスバージョンでは織り込んであります。今回のサブクラス化では、どのカラムが編集対象であるかは、外部からコントロールしなければなりません。
カラム位置で判定していたりすると、コードの可読性は落ちますしメンテナンス性も悪くなります。ここはひとつListViewItemのカラムヘッダ辺りに Editable みたいなプロパティがあると良いのになーとか思っちゃったのが運の尽き。
更に泥沼にはまっていく…ちゅー事で次はColumnHeaderのサブクラス対応かっ？
請うご期待！

※ 一旦脳味噌クールダウン図って別ネタを挟むかも…


