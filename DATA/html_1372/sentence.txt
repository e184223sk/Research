More than 1 year has passed since last update.C#でファイル名を変更するにはFile.Move(元ファイルパス,後ファイルパス)を使うのが一番ラクですが、実はこのメソッドには2つ落とし穴があるので、それを回避する方法を説明します。Fileなので当たり前といえばそうですが、フォルダかどうかは気にせずファイル名を変更したいですね。
フォルダの場合は代わりにDirectory.Move()を使用します。
そして、指定されたパスがフォルダかどうかはFileInfo.Attributesから調べます。たとえば、C:\abc→C:\ABCといった変更は直接できません。ですので一度別のファイル名に変更してから再変更します。なお、この問題はFile.Move()では発生しません。謎い。以上２つの解決策をまとめると、以下のようになります。
他にもこんな落とし穴がある、とかあったら教えてください。VisualStudio2019
.NET Core 3.1
C#8


