More than 3 years have passed since last update.私、iPhone使いです。
音楽聞く習慣がないので、パソコンにiTunes入れる必要性を感じません。と云うか入れたくありません。私、秘密主義者です。
誰に覗かれるか分からないクラウドストレージはイマイチ不安。と云うか全く信用していません。私、激烈心配性です。
離席中にひょっとして誰かにファイル抜かれたら嫌だなぁ。と云う事でWPDも無効化しちゃいました。

……………………
iPhoneに溜まり続ける写真。
何とかしてパソコンに吸い上げられないかなぁ…
なんて我儘で贅沢な悩みでしょうか。
こんだけ周りに壁を立てておいて、写真だけは特別扱いしたいなんて。ま、実際問題としてそんな事って良くありますけどね。
でも、そんな状況に出くわしてしまうと、思わずめらめらと何かが燃え上がってしまう自分がいます。

さて、そんな時取り敢えず思いつくのはやっぱりWebアプリですね。クラウドに向かっては出て行きたくないので、パソコンとiPhone間のプライベートネットワークって感じでしょうか。
となると、万人が「あーこりゃ簡単・便利！」って感じにはなりそうにもありませんが、まぁ「こんな事もできるんだねぇ…」位に思って貰えれば嬉しいかな。全体的な想定構成を決めておきましょう。
基本的に、動作検証の取れた自前の環境って事ですが…一番オーソドックスな方法です。パソコンをWebサーバに見立てて（？いや、しっかりとWebサーバですけど）、iPhoneからそこにアクセスする感じです。
まず、iPhoneでパソコンにアクセスできるかどうか確認してみましょう。パソコンのIPアドレスを確認した処、現時点ではWiFiアダプタのIPアドレスは192.168.0.11でした。んじゃ、iPhoneでsafari立ち上げてhttp://192.168.0.11とすると…よしよし。じゃぁ、画像をアップロードする為に、c:\inetpub\wwwrootの下に以下のファイルを置きましょう。（UTF-8で保存してね）あ、■■■■の所は自分のユーザ名にして下さい。
そして、デスクトップにupImageフォルダを作って、EveryOneに対してFullControlを与えておく必要があります。ここら辺が、IISのセットアップと共に面倒臭いハードルですかねぇ…で、safariでhttp://192.168.0.11/select.htmlにアクセスすると…ファイル選択ボタンを押すと…よしよしよし…画像を選択して、転送ボタンを押すとデスクトップのupImageに画像ファイルが転送されました。
よしよしよしよし…できるのはできたけど、やっぱりIIS立てたり、転送先を絶対パスで固定したり、妙なアクセス権付けたり…
と、イマイチ感がハンパないです。なんとかなんないのー、どらヱモ～〇っ！

　—　という事で、良いもの見つけました。
その名もOWIN。IIS不要！
起動するだけでＯＫ！！自分の中にWebサーバを抱え込んでくれる、と云う優れモノ。
つまりexeを起動するだけで外部からのWebアクセスを引き受けてくれると云う…

では、始まりーあ～～～でもぉ、コンパイルが通らないぃ～　orz
OWINのRequestにはFilesがなかったのかー

いや、でも何か解決策がある筈！
　　　：
ある筈…
　：見つからない…
NancyってのではFilesを扱っている例は見つけたんですが、残念ながらナンシー嬢、私の環境へのお誘いにはつれない感じ…
コンパイルまでも辿り着けない体たらく。已むを得ん！
この際無理矢理にでもファイルを取り出してやるっ！って事で、無理矢理感満載の解決を見ました。
HTTPのInputStreamから直接ファイルを切り出す方式です。
※ エラーになる事を基本的に想定していない実装なので、とても打たれ弱いです
　 今日の所はこれ位で勘弁して下さい…

ざっくりと方向性を説明すると—では、まず上記クラスから—後はヘルパさん達…
で、Startup1.csの一部を—こんな感じ…

実際にiPhoneと連携したい時は、デバッグ実行では無理っぽい感じなので、以下の手順で実行完了を整えてください。で、実行環境は整いました。
今度は実行手順です。（toolsフォルダで話を続けます）画像ファイルが転送できる事は前ケースで確認できました。
でも、前提が色々なぁ…つまり、家にいてホームネットワークが構築されている状況が仮定されています。
ホームネットワークがない時にはどうしたら良いでしょうか？
例えば、旅行中とか、もにょもにょとか…

そういう時は、パソコンとiPhone間で直接ネットワークを構築するって技があります。
これならば、外出していても写真を吸い上げることができます。直接ネットワークを構築する時には、パソコン側をWiFi親機にしてあげる必要があります。
SoftAPって奴ですかねぇ。
まぁ、ここら辺を確認してみて下さい。以下ざっとした手順。（cmd.exeを管理者モードで起動しておいて下さい）1.netsh wlan set hostednetwork mode=allow
2.netsh wlan set hostednetwork ssid=■■■ （■■■欄は希望のSSID）
3.netsh wlan set hostednetwork key=■■■ keyusage=persistent （■■■欄は希望のパスワード）※ここまでは一度設定したら、毎回入力は不要4.netsh wlan start hostednetwork※転送を開始するときに入力
5.netsh wlan stop hostednetwork※転送が完了したら入力………
なんですけど、ここまでやって衝撃の事実にぶち当たりました。
私のパソコンhostednetworkモードに対応していない…
（ぼっこいネットワークカード使いやがって、もー）

という事で、一応情報の提供までという事で。
御粗末様でした…


