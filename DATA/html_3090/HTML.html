<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。コードのサンプルです。 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/oyk3865b/items/7c89f81f2c4e17e78281" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Fg/plfVIfqC9UDorn9lPcpdszLO75iWi2HtfDcAtpd4UzRQERRD2bH8Gi7WItNEGz5nQ2VbMunyZCG7z7F26PA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@oyk3865b" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。コードのサンプルです。 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WbWx6ZFdGc0lGTjBkV1JwYnlBeU1ERTU0NEd1UXlQamdhdmpnYWJqZ0lIa3VLM2pnYTU0Yld6amdwTG5tN1RtanFYbGo2bmpnWVRqZ2FaUFJGUGpncExsaDdybGlwdmpnWm5qZ292amdJTGpnclBqZzd6amc0bmpnYTdqZ3JYamc3UGpnNWZqZzZ2amdhZmpnWm5qZ0lJJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWYxYjkwNDc0NDBmNjBlM2NlY2U3ZWRiMmZmN2ExMzdm&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzk1YXpNNE5qVmkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz02MWYwOGQxZmRhMjE3NDM0ZmVlYWY5NjdmZWUxM2ZkZg&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=db93e957398b6b75ecea3214ba1ca10e"><meta property="og:description" content="表題の通り
Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。
コードのサンプルでございます。

odsは、LibreOfficeや、OpenOfficeなどで使用できるファイル形式で
それぞれが..."><meta content="https://qiita.com/oyk3865b/items/7c89f81f2c4e17e78281" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,ods" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-836a7260-9a9d-4b39-956e-dcbc041ecb14"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Foyk3865b%2Fitems%2F7c89f81f2c4e17e78281">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Foyk3865b%2Fitems%2F7c89f81f2c4e17e78281">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-836a7260-9a9d-4b39-956e-dcbc041ecb14">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-07-15T18:25:19.000+09:00","dateModified":"2019-07-15T18:25:19.000+09:00","headline":"Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。コードのサンプルです。","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WbWx6ZFdGc0lGTjBkV1JwYnlBeU1ERTU0NEd1UXlQamdhdmpnYWJqZ0lIa3VLM2pnYTU0Yld6amdwTG5tN1RtanFYbGo2bmpnWVRqZ2FaUFJGUGpncExsaDdybGlwdmpnWm5qZ292amdJTGpnclBqZzd6amc0bmpnYTdqZ3JYamc3UGpnNWZqZzZ2amdhZmpnWm5qZ0lJJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWYxYjkwNDc0NDBmNjBlM2NlY2U3ZWRiMmZmN2ExMzdm\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzk1YXpNNE5qVmkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz02MWYwOGQxZmRhMjE3NDM0ZmVlYWY5NjdmZWUxM2ZkZg\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=db93e957398b6b75ecea3214ba1ca10e","mainEntityOfPage":"https://qiita.com/oyk3865b/items/7c89f81f2c4e17e78281","author":{"@type":"Person","address":"","email":null,"identifier":"oyk3865b","name":"oyk3865b","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F462441%2F0d2ff6e3b7ec799eeb711a5afb4d8d1e71335f62%2Flarge.png%3F1618139424?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=2e9b5eeeaded934621e02c84c31721a7","url":"https://qiita.com/oyk3865b","description":"下手の横好きで、汚いコードを独学で書いています。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"oyk3865b","type":"items","id":"7c89f81f2c4e17e78281"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"oyk3865b","type":"items","id":"7c89f81f2c4e17e78281"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"oyk3865b","type":"items","id":"7c89f81f2c4e17e78281"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/oyk3865b/items/7c89f81f2c4e17e78281","location":"/oyk3865b/items/7c89f81f2c4e17e78281","scheme":"https","host":"qiita.com","port":null,"pathname":"/oyk3865b/items/7c89f81f2c4e17e78281","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"HzP6KxR01eMCMHYACJ34f2Yn/ojldE9mzErc6EVqno0d8Qe6pCxdL8Bmx54f8GYLPtLi4ghe0LiNOe0WaRqBbw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-89c5f488-fca7-4411-b65d-414132083949"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/oyk3865b/items/7c89f81f2c4e17e78281/likers" class="css-1iupg5d">2</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">0</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/7c89f81f2c4e17e78281/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/oyk3865b/items/7c89f81f2c4e17e78281/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/oyk3865b/items/7c89f81f2c4e17e78281/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/oyk3865b/items/7c89f81f2c4e17e78281/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/oyk3865b/items/7c89f81f2c4e17e78281.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/oyk3865b"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/462441/0d2ff6e3b7ec799eeb711a5afb4d8d1e71335f62/large.png?1618139424" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/oyk3865b" class="css-10ougpm">@<!-- -->oyk3865b</a><div class="css-1ay9vb9"><time dateTime="2019-07-15T09:25:19Z" class="css-m19uds">posted at 2019-07-15</time></div></div></div></div></div><h1 class="css-cgzq40">Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。コードのサンプルです。</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/ods" class="css-4czcte">ods</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>表題の通り<br>
Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。<br>
コードのサンプルでございます。</p>

<p>odsは、LibreOfficeや、OpenOfficeなどで使用できるファイル形式で<br>
それぞれが、インストールされていない環境下でも、作成できます。<br>
また、odsは、Microsoft Excelでも扱えますが、ずれが生じたりします。</p>

<p>尚、Microsoft Excelで扱うxlsxは、<br>
内部は、似たようなxmlをzipでアーカイブしたものなので<br>
[参考サイト]<br>
<a href="https://stackoverflow.com/questions/50738119/how-to-create-and-write-to-excel-file-xlsx/50886486" rel="nofollow noopener" target="_blank">java - How to create and write to Excel file (.xlsx)? - Stack Overflow</a><br>
上記のサイト様を参考にして、<br>
xmlの内容になるよう書き換えれば、xlsxファイルを、<br>
Excelが存在しない環境下でも、作成できるようになります。</p>

<p>特段、NuGetなど他のプラグインや<br>
別途外部dllを必要としないようにしています。</p>

<p>要は、バイナリを以下のように、直接叩いています。<br>
<b>1.</b>ods内部のxmlのファイルの記述<br>
<b>2.</b>xmlファイルを無圧縮でzipにアーカイブ。<br>
<b>3.</b>画像は、メモリにJpeg形式で保存した上でアーカイブ。</p>

<p>※アーカイブするファイルの順番には、決まった順番があります。<br>
※私は素人ですし<br>
今回のコードは、あくまで最低限の動作する部分にとどめていますので、汚いです。<br>
例外処理や、解放など至らぬ点が、多々ございます。ご了承ください。<br>
もし実際に参考にされる際は、必要個所を必ず訂正してからにしてください。</p>

<p>下の画像は、今回コードでの作成例です。<br>
<a href="https://camo.qiitausercontent.com/2694e530c2eaa135c047e8c297375fc0fd4e095e/68747470733a2f2f626c6f672d696d67732d3133302e6663322e636f6d2f6f2f792f6b2f6f796b33383635622f32303139303731353138303730363733612e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fblog-imgs-130.fc2.com%2Fo%2Fy%2Fk%2Foyk3865b%2F2019071518070673a.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6ec397db0b9cb7f06c50499552965d50" alt="参考画像" data-canonical-src="https://blog-imgs-130.fc2.com/o/y/k/oyk3865b/2019071518070673a.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fblog-imgs-130.fc2.com%2Fo%2Fy%2Fk%2Foyk3865b%2F2019071518070673a.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f5f3f7ce41417a8bc5984a7f2520f07f 1x" loading="lazy"></a></p>

<p>[コード作成参考サイト]<br>
<a href="https://code.msdn.microsoft.com/office/VBACRC-32-dad7d087" rel="nofollow noopener" target="_blank">[VBA]CRC-32の計算 言語: VB.NET</a><br>
<a href="https://blog.csdn.net/ciaos/article/details/12490911" rel="nofollow noopener" target="_blank">C#实现crc32函数 - 时间是把杀刀猪 - CSDN博客</a><br>
<a href="http://sanity-free.org/12/crc32_implementation_in_csharp.html" rel="nofollow noopener" target="_blank">A CRC32 implementation in C# - Sanity Free Coding - C#, .NET, PHP</a></p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">CreateODS.cs</span></div>
<div class="highlight"><pre><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Drawing</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CreateODS</span>
<span class="p">{</span>   <span class="c1">//LibreOfficeや、OpenOfficeなどで使用できるODS形式を作成する。</span>
    <span class="c1">//Excelでも、扱えるが、ズレたりします。。。</span>

    <span class="c1">//グローバル変数用</span>

    <span class="c1">//■Local file header関係+++++++++++++++++++++++++++++++++++++++++++++++</span>
    <span class="c1">//Local file headerの識別子 4bytes(0x04034b50)</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">local_file_header_signature</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="m">0x4034B50</span><span class="p">));</span>

    <span class="c1">//解凍に最低必要なバージョン 2bytes 今回は、ver.1.0で、無圧縮を指定(Default value)→0x000A </span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">version_needed_to_extract</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt16</span><span class="p">(</span><span class="m">0xA</span><span class="p">));</span>

    <span class="c1">//オプションフラグと、圧縮方法 2+2bytes{今回はオプションもなく、圧縮もしないので、0を指定共に0x0000}</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">general_purpose_and_compression_method</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="m">0x0</span><span class="p">));</span>

    <span class="c1">//ファイル更新時間 2bytes (秒数は偶数のみ指定可能)</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">last_mod_file_time</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span> <span class="p">};</span> <span class="c1">//00:00:00固定とする。</span>

    <span class="c1">//ファイル更新年月日 2bytes</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">last_mod_file_date</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">{</span> <span class="m">147</span><span class="p">,</span> <span class="m">76</span> <span class="p">};</span> <span class="c1">//2018/4/19固定とする。</span>

    <span class="c1">//CRC-32 4bytes{アーカイブ前の生ファイルから生成するCRC32}</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">crc_32</span><span class="p">;</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span> <span class="n">ary_crc_32s</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span> <span class="c1">//zip内の各ファイルの、CRC-32を格納。</span>

    <span class="c1">//圧縮後のファイルサイズ 4bytes{今回は無圧縮なので圧縮前の値と同値}</span>
    <span class="c1">//圧縮前のファイルサイズ 4bytes</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">uncompressed_size</span><span class="p">;</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span> <span class="n">ary_uncompressed_sizes</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span> <span class="c1">//zip内の各ファイルの、圧縮前のファイルサイズを格納。</span>

    <span class="c1">//アーカイブ前のファイル名のサイズを格納する 2bytes</span>
    <span class="kt">string</span> <span class="n">file_name</span><span class="p">;</span> <span class="c1">//ファイル名</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">file_name_ary</span><span class="p">;</span> <span class="c1">// ファイル名のバイナリ</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">ary_file_name_arys</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span> <span class="c1">//zip内の各ファイルの、ファイル名のバイナリを格納。</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">file_name_length</span><span class="p">;</span> <span class="c1">//ファイル名のバイナリサイズ</span>

    <span class="c1">//拡張フィールドのサイズ 2bytes{今回は、指定しないので0x0000}</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">extra_field_length</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt16</span><span class="p">(</span><span class="m">0x0</span><span class="p">));</span>


    <span class="c1">//■Central file header関係+++++++++++++++++++++++++++++++++++++++++++++++</span>
    <span class="c1">//Central file headerの識別子 4bytes(0x02014b50)</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">central_file_header_signature</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="m">0x2014B50</span><span class="p">));</span>

    <span class="c1">//作成したバージョン　1+1bytes{今回は、ver.1.0で、無圧縮を指定(Default value)→0x000A }</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">version_made_by</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt16</span><span class="p">(</span><span class="m">0xA</span><span class="p">));</span>

    <span class="c1">//ファイルの属性などの情報　2+2+2+4bytes　→　今回は無視するのですべて0</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">file_attributes_etc</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">10</span><span class="p">]</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span> <span class="p">};</span>

    <span class="c1">//対応するファイルのlocal file header信号のある位置　4bytes</span>
    <span class="c1">//出力zipの各local_file_header signatureの、バイト開始位置を示す4バイトのバイナリ配列を格納。</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span> <span class="n">relative_offset_of_local_header</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>


    <span class="c1">//■End of central directory record関係+++++++++++++++++++++++++++++++++++++++++++++++</span>
    <span class="c1">//End of central directory record 4bytes(0x06054b50)</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">end_of_central_dir_signature</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="m">0x6054B50</span><span class="p">));</span>

    <span class="c1">//ディスク分割情報　2+2bytes{ディスク分割はしていないのですべて0}</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">number_of_this_disk</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="m">0x0</span><span class="p">));</span>

    <span class="c1">//アーカイブしたファイルの個数 2+2bytes{ディスク分割はしていないので同じ内容の重複}</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">total_number_of_entries</span><span class="p">;</span>

    <span class="c1">//全Central file headerに要したの合計バイト数 4bytes</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">size_of_the_central_directory</span><span class="p">;</span>

    <span class="c1">//最初のCentral file headerの記述されたバイト位置 4bytes</span>
    <span class="kt">long</span> <span class="n">offset_of_start_of_central_directory_int</span><span class="p">;</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">offset_of_start_of_central_directory</span><span class="p">;</span>

    <span class="c1">//zipファイルへのコメントのサイズ 2bytes{今回は、指定しないので0x0000}</span>
    <span class="k">readonly</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">ZIP_file_comment_length</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt16</span><span class="p">(</span><span class="m">0x0</span><span class="p">));</span>

    <span class="c1">//◆zipファイル入出力など、取扱関係+++++++++++++++++++++++++++++</span>
    <span class="c1">//出力zipのバイナリ一時格納用。</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">ary_zip_file</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>



    <span class="c1">//■アーカイブする文字列関係+++++++++++++++++++++++++++++++++++++++++++++++</span>
    <span class="c1">//OpenDocument Spreadsheetであることを示す</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">mimetype_xml</span> <span class="p">=</span> <span class="s">"application/vnd.oasis.opendocument.spreadsheet"</span><span class="p">;</span>

    <span class="c1">//ドキュメントの印刷情報など</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">styles_xml</span> <span class="p">=</span> <span class="s">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:document-styles xmlns:table=\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\" xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:text=\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\" "</span> <span class="p">+</span>
            <span class="s">"xmlns:style=\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\" xmlns:draw=\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\" xmlns:fo=\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\" "</span> <span class="p">+</span>
            <span class="s">"xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:number=\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\" xmlns:svg=\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\" "</span> <span class="p">+</span>
            <span class="s">"xmlns:of=\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\" office:version=\"1.2\"&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:font-face-decls&gt;&lt;style:font-face style:name=\"ＭＳ Ｐゴシック\" svg:font-family=\"ＭＳ Ｐゴシック\"/&gt;&lt;/office:font-face-decls&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:styles&gt;&lt;number:number-style style:name=\"N0\"&gt;&lt;number:number number:min-integer-digits=\"1\"/&gt;&lt;/number:number-style&gt;&lt;style:style style:name=\"Default\" style:family=\"table-cell\" style:data-style-name=\"N0\"&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:table-cell-properties style:vertical-align=\"middle\" fo:background-color=\"transparent\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:text-properties fo:color=\"#000000\" style:font-name=\"ＭＳ Ｐゴシック\" style:font-name-asian=\"ＭＳ Ｐゴシック\" style:font-name-complex=\"ＭＳ Ｐゴシック\" fo:font-size=\"11pt\" style:font-size-asian=\"11pt\" style:font-size-complex=\"11pt\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:style style:family=\"graphic\" style:name=\"Graphics\"/&gt;&lt;style:default-style style:family=\"graphic\"&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:graphic-properties draw:fill=\"solid\" draw:fill-color=\"#000000\" draw:opacity=\"100%\" draw:stroke=\"solid\" svg:stroke-width=\"0.01389in\" svg:stroke-color=\"#ffffff\" svg:stroke-opacity=\"100%\" draw:stroke-linejoin=\"miter\" svg:stroke-linecap=\"butt\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;/style:default-style&gt;&lt;/office:styles&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:automatic-styles&gt;&lt;style:page-layout style:name=\"pm1\"&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:page-layout-properties fo:margin-top=\"0.3cm\" fo:margin-bottom=\"0.3cm\" fo:margin-left=\"0.7cm\" fo:margin-right=\"0.7cm\" style:print-orientation=\"portrait\" style:print-page-order=\"ttb\" style:first-page-number=\"continue\" style:scale-to=\"100%\" style:table-centering=\"both\" style:print=\"objects charts drawings\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:header-style&gt;&lt;style:header-footer-properties fo:min-height=\"0.45cm\" fo:margin-left=\"0.7cm\" fo:margin-right=\"0.7cm\" fo:margin-bottom=\"0cm\"/&gt;&lt;/style:header-style&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:footer-style&gt;&lt;style:header-footer-properties fo:min-height=\"0.45cm\" fo:margin-left=\"0.7cm\" fo:margin-right=\"0.7cm\" fo:margin-top=\"0cm\"/&gt;&lt;/style:footer-style&gt;&lt;/style:page-layout&gt;&lt;/office:automatic-styles&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:master-styles&gt;&lt;style:master-page style:name=\"mp1\" style:page-layout-name=\"pm1\"&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:header&gt;&lt;text:p&gt;ヘッダー文字列&lt;/text:p&gt;&lt;/style:header&gt;&lt;style:header-left style:display=\"false\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;style:footer&gt;&lt;text:p&gt;フッター文字列&lt;/text:p&gt;&lt;/style:footer&gt;&lt;style:footer-left style:display=\"false\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;/style:master-page&gt;&lt;/office:master-styles&gt;&lt;/office:document-styles&gt;"</span><span class="p">;</span>

    <span class="c1">//このシートで使用するファイル一覧</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">META_INF_manifest_xml_header</span> <span class="p">=</span> <span class="s">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\"&gt;&lt;manifest:file-entry manifest:full-path=\"/\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;manifest:file-entry manifest:full-path=\"styles.xml\" manifest:media-type=\"text/xml\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;manifest:file-entry manifest:full-path=\"content.xml\" manifest:media-type=\"text/xml\"/&gt;"</span><span class="p">;</span>

    <span class="c1">//画像指定用</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">META_INF_manifest_xml_image</span> <span class="p">=</span> <span class="s">"&lt;manifest:file-entry manifest:full-path=\"media/image1.jpeg\" manifest:media-type=\"image/jpeg\"/&gt;"</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">META_INF_manifest_xml_footer</span> <span class="p">=</span> <span class="s">"&lt;manifest:file-entry manifest:full-path=\"meta.xml\" manifest:media-type=\"text/xml\"/&gt;&lt;/manifest:manifest&gt;"</span><span class="p">;</span>


    <span class="c1">//シートの内容すべてを格納するxml</span>
    <span class="c1">//※列幅、行高、画像のサイズの単位は、cmで統一。</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_header</span> <span class="p">=</span> <span class="s">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:document-content xmlns:table=\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\" xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:text=\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\" "</span> <span class="p">+</span>
            <span class="s">"xmlns:style=\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\" xmlns:draw=\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\" xmlns:fo=\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\" "</span> <span class="p">+</span>
            <span class="s">"xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:number=\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\" xmlns:svg=\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\" "</span> <span class="p">+</span>
            <span class="s">"xmlns:of=\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\" office:version=\"1.2\"&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:font-face-decls&gt;&lt;style:font-face style:name=\"ＭＳ Ｐゴシック\" svg:font-family=\"ＭＳ Ｐゴシック\"/&gt;&lt;/office:font-face-decls&gt;&lt;office:automatic-styles&gt;"</span><span class="p">;</span>

    <span class="c1">//このシートで使用するセルの書式設定を格納</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_cell_style</span> <span class="p">=</span> <span class="s">"&lt;style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N0\"/&gt;"</span> <span class="p">+</span> <span class="c1">//標準スタイル</span>
        <span class="s">"&lt;style:style style:name=\"ce2\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N0\"&gt;&lt;style:table-cell-properties style:vertical-align=\"middle\" style:repeat-content=\"false\"/&gt;&lt;style:paragraph-properties fo:text-align=\"center\"/&gt;&lt;style:text-properties fo:font-size=\"12pt\" style:font-size-asian=\"12pt\" style:font-size-complex=\"12pt\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//サブタイトル書式</span>
        <span class="s">"&lt;style:style style:name=\"ce3\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N0\"&gt;&lt;style:table-cell-properties fo:border=\"thin solid #000000\" style:vertical-align=\"middle\" style:repeat-content=\"false\"/&gt;&lt;style:paragraph-properties fo:text-align=\"center\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//肩書用</span>
        <span class="s">"&lt;style:style style:name=\"ce4\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N0\"&gt;&lt;style:table-cell-properties style:vertical-align=\"middle\" style:repeat-content=\"false\"/&gt;&lt;style:paragraph-properties fo:text-align=\"center\"/&gt;&lt;style:text-properties fo:font-size=\"16pt\" style:font-size-asian=\"16pt\" style:font-size-complex=\"16pt\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//タイトル用</span>
        <span class="s">"&lt;style:style style:name=\"ce5\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N0\"&gt;&lt;style:table-cell-properties fo:border=\"thin solid #000000\" style:vertical-align=\"middle\" style:repeat-content=\"false\"/&gt;&lt;style:paragraph-properties fo:text-align=\"start\" fo:margin-left=\"0.353cm\"/&gt;&lt;/style:style&gt;"</span><span class="p">;</span> <span class="c1">//本文用</span>

    <span class="c1">//列の幅</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_column_style</span> <span class="p">=</span> <span class="s">"&lt;style:style style:name=\"co1\" style:family=\"table-column\"&gt;&lt;style:table-column-properties fo:break-before=\"auto\" style:column-width=\"11.5cm\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//1列目の設定</span>
        <span class="s">"&lt;style:style style:name=\"co2\" style:family=\"table-column\"&gt;&lt;style:table-column-properties fo:break-before=\"auto\" style:column-width=\"2.0cm\"/&gt;&lt;/style:style&gt;"</span><span class="p">;</span> <span class="c1">//2～4列目の設定</span>

    <span class="c1">//行の高さ</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_row_style</span> <span class="p">=</span> <span class="s">"&lt;style:style style:name=\"ro1\" style:family=\"table-row\"&gt;&lt;style:table-row-properties style:row-height=\"0.48cm\" style:use-optimal-row-height=\"false\" fo:break-before=\"avoid\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//タイトル・肩書の行高</span>
        <span class="s">"&lt;style:style style:name=\"ro2\" style:family=\"table-row\"&gt;&lt;style:table-row-properties style:row-height=\"1.06cm\" style:use-optimal-row-height=\"false\" fo:break-before=\"avoid\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//タイトル下部・押印枠上部</span>
        <span class="s">"&lt;style:style style:name=\"ro3\" style:family=\"table-row\"&gt;&lt;style:table-row-properties style:row-height=\"0.5cm\" style:use-optimal-row-height=\"false\" fo:break-before=\"avoid\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//サブタイトル・押印枠下部</span>
        <span class="s">"&lt;style:style style:name=\"ro4\" style:family=\"table-row\"&gt;&lt;style:table-row-properties style:row-height=\"0.48cm\" style:use-optimal-row-height=\"true\" fo:break-before=\"avoid\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//タイトルと本文の間隔</span>
        <span class="s">"&lt;style:style style:name=\"ro5\" style:family=\"table-row\"&gt;&lt;style:table-row-properties style:row-height=\"0.85cm\" style:use-optimal-row-height=\"false\" fo:break-before=\"avoid\"/&gt;&lt;/style:style&gt;"</span> <span class="p">+</span> <span class="c1">//本文用</span>
        <span class="s">"&lt;style:style style:name=\"ro6\" style:family=\"table-row\"&gt;&lt;style:table-row-properties style:row-height=\"0.48cm\" style:use-optimal-row-height=\"false\" fo:break-before=\"page\"/&gt;&lt;/style:style&gt;"</span><span class="p">;</span> <span class="c1">//タイトル用（改行付き）</span>

    <span class="c1">//表全体</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_table_style</span> <span class="p">=</span> <span class="s">"&lt;style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\"&gt;&lt;style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/&gt;&lt;/style:style&gt;"</span><span class="p">;</span>

    <span class="c1">//画像</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_graphics_style</span> <span class="p">=</span> <span class="s">"&lt;style:style style:family=\"graphic\" style:name=\"a0\" style:parent-style-name=\"Graphics\"&gt;&lt;style:graphic-properties draw:fill=\"none\" draw:stroke=\"none\"/&gt;&lt;/style:style&gt;"</span><span class="p">;</span>

    <span class="c1">//スタイルフッター・シート本体開始</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_span1</span> <span class="p">=</span> <span class="s">"&lt;/office:automatic-styles&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:body&gt;&lt;office:spreadsheet&gt;&lt;table:calculation-settings table:case-sensitive=\"false\" table:search-criteria-must-apply-to-whole-cell=\"true\" table:use-wildcards=\"true\" table:use-regular-expressions=\"false\" table:automatic-find-labels=\"false\"/&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;table:table table:name=\"Sheet1\" table:style-name=\"ta1\"&gt;"</span> <span class="p">+</span> <span class="c1">//シート名</span>
        <span class="s">"&lt;table:table-column table:style-name=\"co1\" table:default-cell-style-name=\"ce1\"/&gt;"</span> <span class="p">+</span> <span class="c1">//1行目の書式設定</span>
        <span class="s">"&lt;table:table-column table:style-name=\"co2\" table:number-columns-repeated=\"3\" table:default-cell-style-name=\"ce1\"/&gt;"</span><span class="p">;</span> <span class="c1">//2→4行目の書式設定</span>

    <span class="c1">//フッター。</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">content_xml_footer</span> <span class="p">=</span> <span class="s">"&lt;/table:table&gt;&lt;/office:spreadsheet&gt;&lt;/office:body&gt;&lt;/office:document-content&gt;"</span><span class="p">;</span>

    <span class="c1">//更新日時など</span>
    <span class="k">readonly</span> <span class="kt">string</span> <span class="n">meta_xml</span> <span class="p">=</span> <span class="s">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;office:meta&gt;&lt;meta:generator&gt;photoreport.attachment.style&lt;/meta:generator&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;meta:initial-creator&gt;TageSP&lt;/meta:initial-creator&gt;&lt;dc:creator&gt;TageSP&lt;/dc:creator&gt;"</span> <span class="p">+</span>
        <span class="s">"&lt;meta:creation-date&gt;"</span> <span class="p">+</span>
            <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"yyyy-MM-dd"</span><span class="p">)</span> <span class="p">+</span> <span class="s">"T"</span> <span class="p">+</span>
            <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"hh:mm:ss"</span><span class="p">)</span> <span class="p">+</span> <span class="s">"Z"</span> <span class="p">+</span>
        <span class="s">"&lt;/meta:creation-date&gt;&lt;dc:date&gt;"</span> <span class="p">+</span>
            <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"yyyy-MM-dd"</span><span class="p">)</span> <span class="p">+</span> <span class="s">"T"</span> <span class="p">+</span>
            <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"hh:mm:ss"</span><span class="p">)</span> <span class="p">+</span> <span class="s">"Z"</span> <span class="p">+</span>
        <span class="s">"&lt;/dc:date&gt;&lt;/office:meta&gt;&lt;/office:document-meta&gt;"</span><span class="p">;</span>



    <span class="k">public</span> <span class="k">async</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span> <span class="nf">create_ods</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">imagepath</span><span class="p">,</span> <span class="kt">string</span> <span class="n">filepath</span><span class="p">)</span>
    <span class="p">{</span>


        <span class="k">if</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
        <span class="p">{</span>   <span class="c1">//上書きする前に削除する</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">File</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="n">filepath</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">{</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//◎使用する各配列の初期化++++++++++++++++++++++++++</span>
        <span class="nf">ary_Clear</span><span class="p">(</span><span class="k">ref</span> <span class="n">ary_zip_file</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
        <span class="n">ary_crc_32s</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">};</span>
        <span class="n">ary_uncompressed_sizes</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">};</span>
        <span class="n">ary_file_name_arys</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">};</span>
        <span class="n">relative_offset_of_local_header</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">};</span>

        <span class="c1">//zipは、無圧縮で自分でバイナリを打っていく。</span>
        <span class="k">using</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">FileStream</span> <span class="n">fs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="nf">FileStream</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">FileMode</span><span class="p">.</span><span class="n">Create</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">FileAccess</span><span class="p">.</span><span class="n">Write</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">StringBuilder</span> <span class="n">sheetdata</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>
            <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="m">5</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="c1">//実際に格納するバイナリを格納する</span>
                <span class="kt">byte</span><span class="p">[]</span> <span class="n">moto_bs</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

                <span class="c1">//順番に従った格納をする。</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>   <span class="c1">//アーカイブの先頭はmimetype固定。</span>
                    <span class="n">moto_bs</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">mimetype_xml</span><span class="p">);</span>
                    <span class="n">file_name</span> <span class="p">=</span> <span class="s">"mimetype"</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
                <span class="p">{</span>   <span class="c1">//印刷設定</span>
                    <span class="n">moto_bs</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">styles_xml</span><span class="p">);</span>
                    <span class="n">file_name</span> <span class="p">=</span> <span class="s">"styles.xml"</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">2</span><span class="p">)</span>
                <span class="p">{</span>   <span class="c1">//使用するファイルのリスト</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">META_INF_manifest_xml_header</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">META_INF_manifest_xml_image</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">META_INF_manifest_xml_footer</span><span class="p">);</span>
                    <span class="n">moto_bs</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">sheetdata</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
                    <span class="n">file_name</span> <span class="p">=</span> <span class="s">"META-INF/manifest.xml"</span><span class="p">;</span>

                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">3</span><span class="p">)</span>
                <span class="p">{</span>   <span class="c1">//シート本文</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_header</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_cell_style</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_column_style</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_row_style</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_table_style</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_graphics_style</span><span class="p">);</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_span1</span><span class="p">);</span>

                    <span class="c1">//本文は別処理</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="nf">content_xml_make_main</span><span class="p">());</span>

                    <span class="c1">//フッターで閉じる</span>
                    <span class="n">sheetdata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">content_xml_footer</span><span class="p">);</span>

                    <span class="n">moto_bs</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">sheetdata</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
                    <span class="n">file_name</span> <span class="p">=</span> <span class="s">"content.xml"</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">4</span><span class="p">)</span>
                <span class="p">{</span>   <span class="c1">//更新日時など</span>
                    <span class="n">moto_bs</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">meta_xml</span><span class="p">);</span>
                    <span class="n">file_name</span> <span class="p">=</span> <span class="s">"meta.xml"</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">5</span><span class="p">)</span>
                <span class="p">{</span>   <span class="c1">//挿入画像</span>
                    <span class="k">using</span> <span class="p">(</span><span class="n">Bitmap</span> <span class="n">bitmap</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Bitmap</span><span class="p">(</span><span class="n">imagepath</span><span class="p">[</span><span class="m">0</span><span class="p">]))</span>
                    <span class="p">{</span>
                        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">baos</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">())</span>
                        <span class="p">{</span>   <span class="c1">//今回は、とりあえず1つだけ画像を適用する。  </span>
                            <span class="n">bitmap</span><span class="p">.</span><span class="nf">Save</span><span class="p">(</span><span class="n">baos</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Imaging</span><span class="p">.</span><span class="n">ImageFormat</span><span class="p">.</span><span class="n">Jpeg</span><span class="p">);</span>
                            <span class="n">moto_bs</span> <span class="p">=</span> <span class="p">((</span><span class="n">MemoryStream</span><span class="p">)</span><span class="n">baos</span><span class="p">).</span><span class="nf">ToArray</span><span class="p">();</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="n">file_name</span> <span class="p">=</span> <span class="s">"media/image1.jpeg"</span><span class="p">;</span>
                <span class="p">}</span>




                <span class="c1">//■Local file headerの作成------------ここから-----------------</span>
                <span class="c1">//●予めlocal_file_header_signatureの記述位置を格納しておく(4バイト)</span>
                <span class="n">relative_offset_of_local_header</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">fs</span><span class="p">.</span><span class="n">Length</span><span class="p">));</span> <span class="c1">//つまり現在のファイルサイズ</span>

                <span class="c1">//○local_file_header_signatureの記述(4バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">local_file_header_signature</span><span class="p">);</span>

                <span class="c1">//○解凍に必要なバージョンの記述(2バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">version_needed_to_extract</span><span class="p">);</span>

                <span class="c1">//○オプションフラグと、圧縮方法の記述(2+2バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">general_purpose_and_compression_method</span><span class="p">);</span>

                <span class="c1">//ファイルの更新時刻を格納(2バイト)//////////////////////////////////</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">last_mod_file_time</span><span class="p">);</span>

                <span class="c1">//○ファイルの更新年月日を格納(2バイト)//////////////////////////////////</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">last_mod_file_date</span><span class="p">);</span>


                <span class="c1">//○CRC32(4バイト)</span>
                <span class="c1">//元ファイルのバイナリからCRC-32を取得する。</span>
                <span class="n">crc_32</span> <span class="p">=</span> <span class="k">await</span> <span class="nf">CRC_32_Checksum</span><span class="p">(</span><span class="n">moto_bs</span><span class="p">);</span> <span class="c1">//計算に時間がかかるので、待機させる</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">crc_32</span><span class="p">);</span>
                <span class="c1">//再計算が面倒なので、central file headerに再利用するために記憶しておく。</span>
                <span class="n">ary_crc_32s</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">BitConverter</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">crc_32</span><span class="p">,</span> <span class="m">0</span><span class="p">));</span>


                <span class="c1">//○圧縮後のファイルサイズの取得(4バイト)｛無圧縮なので圧縮後のサイズと同値｝</span>
                <span class="n">uncompressed_size</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">moto_bs</span><span class="p">.</span><span class="n">Length</span><span class="p">));</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">uncompressed_size</span><span class="p">);</span>

                <span class="c1">//○圧縮前のファイルサイズの取得(4バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">uncompressed_size</span><span class="p">);</span>
                <span class="c1">//再計算が面倒なので、central file headerに再利用するために記憶しておく。</span>
                <span class="n">ary_uncompressed_sizes</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">moto_bs</span><span class="p">.</span><span class="n">Length</span><span class="p">));</span>

                <span class="c1">//○圧縮前のファイル名のサイズの取得(2バイト)</span>
                <span class="c1">//文字列をUTF-8コードとしてバイナリ化する</span>
                <span class="n">file_name_ary</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">file_name</span><span class="p">);</span>

                <span class="c1">//文字列長を取得する。</span>
                <span class="n">file_name_length</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt16</span><span class="p">(</span><span class="n">file_name_ary</span><span class="p">.</span><span class="n">Length</span><span class="p">));</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">file_name_length</span><span class="p">);</span> <span class="c1">//格納</span>

                <span class="c1">//○拡張フィールドのサイズ指定(2バイト){今回は指定なし}</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">extra_field_length</span><span class="p">);</span> <span class="c1">//格納</span>


                <span class="c1">//○アーカイブ前のファイル名の格納</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">file_name_ary</span><span class="p">);</span>
                <span class="c1">//file_name_aryに再利用するために記憶しておく。</span>
                <span class="n">ary_file_name_arys</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">file_name</span><span class="p">);</span>

                <span class="k">try</span>
                <span class="p">{</span> <span class="c1">//一旦、書き貯めたバイト型配列の内容をファイルに出力する</span>
                    <span class="n">fs</span><span class="p">.</span><span class="nf">Write</span><span class="p">((</span><span class="kt">byte</span><span class="p">[])</span><span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">(),</span> <span class="m">0</span><span class="p">,</span> <span class="n">ary_zip_file</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>
                    <span class="n">fs</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">{</span> <span class="p">}</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span> <span class="c1">//初期化</span>
                <span class="c1">//■Local file headerの作成------------ここまで-----------------</span>
                <span class="k">await</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>


                <span class="c1">//■ファイル本体のバイナリを書き込む</span>
                <span class="k">try</span>
                <span class="p">{</span> <span class="c1">//ファイルに出力する</span>
                    <span class="n">fs</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">moto_bs</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">moto_bs</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
                    <span class="n">fs</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">{</span> <span class="p">}</span>
                <span class="k">await</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="m">10</span><span class="p">);</span><span class="c1">//これがないと、書き込み途中で放棄される？？</span>

                <span class="c1">//初期化</span>
                <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">moto_bs</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">moto_bs</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
                <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">crc_32</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">crc_32</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
                <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">file_name_length</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">file_name_length</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
                <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">file_name_ary</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">file_name_ary</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
            <span class="p">}</span>


            <span class="c1">//★中盤戦。central file headerの記述********************************************</span>
            <span class="c1">//予め最初のCentral file headerの記述開始バイト位置を記憶しておく</span>
            <span class="n">offset_of_start_of_central_directory_int</span> <span class="p">=</span> <span class="n">fs</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
            <span class="n">offset_of_start_of_central_directory</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">offset_of_start_of_central_directory_int</span><span class="p">));</span>


            <span class="c1">//各ファイル分ループ</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">ary_file_name_arys</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="kt">byte</span><span class="p">[]</span> <span class="n">bs</span><span class="p">;</span>
                <span class="c1">//■central file headerの作成------------ここから-----------------</span>
                <span class="c1">//○central_file_header_signatureの記述(4バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">central_file_header_signature</span><span class="p">);</span>

                <span class="c1">//○zipを作った時のバージョンとOSの記述(1+1バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">version_made_by</span><span class="p">);</span>

                <span class="c1">//○解凍に必要なバージョンの記述(2バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">version_needed_to_extract</span><span class="p">);</span>

                <span class="c1">//○オプションフラグと圧縮方法の記述(2+2バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">general_purpose_and_compression_method</span><span class="p">);</span>

                <span class="c1">//○ファイルの更新時刻(2バイト)[固定値]</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">last_mod_file_time</span><span class="p">);</span>

                <span class="c1">//○ファイルの更新年月日(2バイト)[固定値]</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">last_mod_file_date</span><span class="p">);</span>

                <span class="c1">//○CRC-32(4バイト)</span>
                <span class="c1">//https://www.morgantechspace.com/2013/08/convert-object-to-byte-array-and-vice.html</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">ary_crc_32s</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>


                <span class="c1">//○圧縮後のファイルサイズ(4バイト) {今回は、無圧縮なので、圧縮前のファイルサイズを流用}</span>
                <span class="n">bs</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">ary_uncompressed_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">bs</span><span class="p">);</span>

                <span class="c1">//○圧縮前のファイルサイズ(4バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">bs</span><span class="p">);</span>
                <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">bs</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span><span class="c1">//初期化</span>

                <span class="c1">//○ファイル名のサイズ(2バイト)</span>
                <span class="kt">byte</span><span class="p">[]</span> <span class="n">name_bs</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">ary_file_name_arys</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt16</span><span class="p">(</span><span class="n">name_bs</span><span class="p">.</span><span class="n">Length</span><span class="p">)));</span>


                <span class="c1">//○拡張フィールドのサイズ(2バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">extra_field_length</span><span class="p">);</span>

                <span class="c1">//○ファイルの属性などの情報(2+2+2+4バイト)</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">file_attributes_etc</span><span class="p">);</span>

                <span class="c1">//○対応するファイルのlocal File header信号のある位置(4バイト)</span>
                <span class="n">bs</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">relative_offset_of_local_header</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">bs</span><span class="p">);</span>
                <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">bs</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span><span class="c1">//初期化</span>


                <span class="c1">//○アーカイブ前のファイル名の格納</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">name_bs</span><span class="p">);</span>
                <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">name_bs</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">name_bs</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span><span class="c1">//初期化</span>

                <span class="k">try</span>
                <span class="p">{</span> <span class="c1">//一旦、書き貯めたバイト型配列の内容をファイルに出力する</span>
                    <span class="n">fs</span><span class="p">.</span><span class="nf">Write</span><span class="p">((</span><span class="kt">byte</span><span class="p">[])</span><span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">(),</span> <span class="m">0</span><span class="p">,</span> <span class="n">ary_zip_file</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>
                    <span class="n">fs</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">{</span> <span class="p">}</span>
                <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span> <span class="c1">//初期化</span>
                <span class="c1">//■central file headerの作成------------ここまで-----------------</span>
                <span class="k">await</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">//◎使用する各配列の一旦、クリア++++++++++++++++++++++++++</span>
            <span class="n">ary_crc_32s</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">ary_uncompressed_sizes</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">relative_offset_of_local_header</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>


            <span class="c1">//★終盤戦End of central directory recordの記述********************************************</span>
            <span class="c1">//全Central file headerに要したの合計バイト数を予め算出しておく</span>
            <span class="n">size_of_the_central_directory</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span>
                <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">fs</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="n">offset_of_start_of_central_directory_int</span><span class="p">));</span>

            <span class="c1">//■End of central directory recordの作成------------ここから-----------------</span>
            <span class="c1">//○end_of_central_dir_signatureの記述(4バイト)</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">end_of_central_dir_signature</span><span class="p">);</span>

            <span class="c1">//○ディスク分割情報(2+2バイト)</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">number_of_this_disk</span><span class="p">);</span>

            <span class="c1">//○アーカイブしたファイルの個数(2+2バイト){同じ内容を重複して格納}</span>
            <span class="n">total_number_of_entries</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt16</span><span class="p">(</span><span class="n">ary_file_name_arys</span><span class="p">.</span><span class="n">Count</span><span class="p">));</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">total_number_of_entries</span><span class="p">);</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">total_number_of_entries</span><span class="p">);</span> <span class="c1">//※重複分</span>

            <span class="c1">//○全Central file headerに要したの合計バイト数を格納(4バイト)</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">size_of_the_central_directory</span><span class="p">);</span>

            <span class="c1">//○最初のCentral file headerの記述されたバイト位置(4バイト)</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">offset_of_start_of_central_directory</span><span class="p">);</span>

            <span class="c1">//○ファイルへのコメントのサイズ(2バイト){今回はなし}</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">ZIP_file_comment_length</span><span class="p">);</span>

            <span class="k">try</span>
            <span class="p">{</span> <span class="c1">//一旦、書き貯めたバイト型配列の内容をファイルに出力する</span>
                <span class="n">fs</span><span class="p">.</span><span class="nf">Write</span><span class="p">((</span><span class="kt">byte</span><span class="p">[])</span><span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">(),</span> <span class="m">0</span><span class="p">,</span> <span class="n">ary_zip_file</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>
                <span class="n">fs</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                <span class="k">await</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="m">10</span><span class="p">);</span><span class="c1">//これがないと、書き込み途中で放棄される？？</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">{</span> <span class="p">}</span>
            <span class="n">ary_zip_file</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span> <span class="c1">//初期化</span>
            <span class="c1">//■End of central directory recordの作成------------ここまで-----------------</span>


            <span class="c1">//初期化</span>
            <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">total_number_of_entries</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">total_number_of_entries</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
            <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">size_of_the_central_directory</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">size_of_the_central_directory</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span><span class="c1">//初期化</span>
            <span class="n">Array</span><span class="p">.</span><span class="nf">Clear</span><span class="p">(</span><span class="n">offset_of_start_of_central_directory</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">offset_of_start_of_central_directory</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span><span class="c1">//初期化</span>


            <span class="c1">//◎使用する各配列の念のためクリア++++++++++++++++++++++++++</span>
            <span class="n">ary_crc_32s</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">ary_uncompressed_sizes</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">relative_offset_of_local_header</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="c1">//◎配列の初期化2++++++++++++++++++++++++++</span>
            <span class="nf">ary_Clear</span><span class="p">(</span><span class="k">ref</span> <span class="n">ary_zip_file</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
            <span class="n">ary_file_name_arys</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="c1">//■後処理</span>
            <span class="n">fs</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span> <span class="c1">//ファイルを閉じる </span>
        <span class="p">}</span>


    <span class="p">}</span>


    <span class="k">public</span> <span class="kt">string</span> <span class="n">title_string</span> <span class="p">=</span> <span class="s">"タイトル"</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">subtitle_string</span> <span class="p">=</span> <span class="s">"サブタイトル"</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">seal_string</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">main_string</span><span class="p">;</span>

    <span class="k">public</span> <span class="n">StringBuilder</span> <span class="nf">content_xml_make_main</span><span class="p">()</span>
    <span class="p">{</span>   <span class="c1">//content.xmlの本文を作成する場所</span>
        <span class="n">StringBuilder</span> <span class="n">xmldata</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

        <span class="c1">//◆1行目（タイトル・肩書）</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-row table:style-name=\"ro1\"&gt;"</span><span class="p">);</span>
        <span class="c1">//1列目{2行目と結合}</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:number-columns-spanned=\"1\" table:number-rows-spanned=\"2\" table:style-name=\"ce4\"&gt;&lt;text:p&gt;"</span> <span class="p">+</span>
            <span class="n">title_string</span> <span class="p">+</span>
            <span class="s">"&lt;/text:p&gt;&lt;/table:table-cell&gt;"</span><span class="p">);</span>

        <span class="c1">//2列目(空白)</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell table:style-name=\"ce1\"/&gt;"</span><span class="p">);</span>

        <span class="c1">//3列目(肩書1)</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:style-name=\"ce3\"&gt;&lt;text:p&gt;"</span> <span class="p">+</span>
            <span class="n">seal_string</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">+</span>
            <span class="s">"&lt;/text:p&gt;&lt;/table:table-cell&gt;"</span><span class="p">);</span>
        <span class="c1">//4列目(肩書2)</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:style-name=\"ce3\"&gt;&lt;text:p&gt;"</span> <span class="p">+</span>
            <span class="n">seal_string</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">+</span>
            <span class="s">"&lt;/text:p&gt;&lt;/table:table-cell&gt;"</span><span class="p">);</span>

        <span class="c1">//1行目おわり</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;/table:table-row&gt;"</span><span class="p">);</span>


        <span class="c1">//◆2行目（押印枠）</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-row table:style-name=\"ro2\"&gt;"</span><span class="p">);</span>
        <span class="c1">//1列目は、1行目との結合で遮蔽されている</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:covered-table-cell/&gt;"</span><span class="p">);</span>
        <span class="c1">//2列目(空白)</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell table:style-name=\"ce1\"/&gt;"</span><span class="p">);</span>
        <span class="c1">//3列目(押印枠1){3行目と結合}</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:number-columns-spanned=\"1\" table:number-rows-spanned=\"2\" table:style-name=\"ce3\"/&gt;"</span><span class="p">);</span>
        <span class="c1">//4列目(押印枠1){3行目と結合}</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:number-columns-spanned=\"1\" table:number-rows-spanned=\"2\" table:style-name=\"ce3\"/&gt;"</span><span class="p">);</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;/table:table-row&gt;"</span><span class="p">);</span>

        <span class="c1">//◆3行目（サブタイトル）</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-row table:style-name=\"ro3\"&gt;"</span><span class="p">);</span>
        <span class="c1">//1列目（サブタイトル）</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:style-name=\"ce2\"&gt;&lt;text:p&gt;"</span> <span class="p">+</span>
            <span class="n">subtitle_string</span> <span class="p">+</span>
            <span class="s">"&lt;/text:p&gt;&lt;/table:table-cell&gt;"</span><span class="p">);</span>
        <span class="c1">//2列目(空白)</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell table:style-name=\"ce1\"/&gt;"</span><span class="p">);</span>
        <span class="c1">//3、4列目は、2行目との結合で遮蔽されている</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:covered-table-cell/&gt;"</span><span class="p">);</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:covered-table-cell/&gt;"</span><span class="p">);</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;/table:table-row&gt;"</span><span class="p">);</span>

        <span class="c1">//◆4行目（全て空白）</span>
        <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-row table:style-name=\"ro4\"/&gt;"</span><span class="p">);</span>

        <span class="c1">//◆5→14行目（本文）{10行分}</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-row table:style-name=\"ro5\"&gt;"</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//1行目は写真の挿入</span>
                <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:number-columns-spanned=\"1\" table:number-rows-spanned=\"10\" table:style-name=\"ce3\"&gt;"</span> <span class="p">+</span>
                    <span class="s">"&lt;text:p/&gt;"</span> <span class="p">+</span> <span class="c1">//文字はなし</span>
                    <span class="s">"&lt;draw:frame draw:z-index=\"1\" draw:id=\"id0\" draw:style-name=\"a0\" draw:name=\"pic_image1\" svg:x=\"0.5cm\" svg:y=\"0.1cm\" svg:width=\"10.5cm\" svg:height=\"8.3cm\" style:rel-width=\"scale\" style:rel-height=\"scale\"&gt;"</span> <span class="p">+</span>
                    <span class="s">"&lt;draw:image xlink:href=\"media/image1.jpeg\" xlink:type=\"simple\" xlink:show=\"embed\" xlink:actuate=\"onLoad\"/&gt;"</span> <span class="p">+</span>
                    <span class="s">"&lt;svg:title/&gt;&lt;svg:desc/&gt;&lt;/draw:frame&gt;&lt;/table:table-cell&gt;"</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="c1">//上のセルと結合</span>
                <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:covered-table-cell/&gt;"</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">//コメント本文の記述</span>
            <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:table-cell office:value-type=\"string\" table:number-columns-spanned=\"3\" table:number-rows-spanned=\"1\" table:style-name=\"ce3\"&gt;&lt;text:p&gt;"</span> <span class="p">+</span>
                <span class="n">main_string</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">+</span>
                <span class="s">"&lt;/text:p&gt;&lt;/table:table-cell&gt;"</span><span class="p">);</span>

            <span class="c1">//右2行は結合により遮蔽されている。</span>
            <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;table:covered-table-cell table:number-columns-repeated=\"2\"/&gt;"</span><span class="p">);</span>
            <span class="n">xmldata</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"&lt;/table:table-row&gt;"</span><span class="p">);</span>

        <span class="p">}</span>

        <span class="k">return</span> <span class="n">xmldata</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">ary_Clear</span><span class="p">(</span><span class="k">ref</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">ary</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">Clear_only_flg</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//指定した配列の初期化をする</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ary</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ary</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">ary</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">//初期化のみの場合→出る</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Clear_only_flg</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">//新たに配列をセットしなおす</span>
        <span class="n">ary</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;();</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">async</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">[</span><span class="k">]&gt;</span> <span class="nf">CRC_32_Checksum</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//★CRC32の計算をするところ  </span>
        <span class="c1">//UIntegerの方法では、上手くできないのですorz  </span>
        <span class="c1">//また、返数をByte()でなく、Long型にすると、値が狂います。  </span>

        <span class="c1">//https://code.msdn.microsoft.com/office/VBACRC-32-dad7d087  </span>
        <span class="c1">//https://blog.csdn.net/ciaos/article/details/12490911</span>
        <span class="c1">//http://sanity-free.org/12/crc32_implementation_in_csharp.html</span>

        <span class="c1">//計算に時間がかかるので、待機させる</span>
        <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">[</span><span class="k">]&gt;</span> <span class="n">uploadTask</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">.</span><span class="n">Task</span><span class="p">.</span><span class="n">Factory</span><span class="p">.</span><span class="n">StartNew</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">[</span><span class="k">]&gt;</span><span class="p">(</span>
        <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="c1">//■CRC32のテーブル情報の事前生成  </span>
            <span class="kt">uint</span><span class="p">[]</span> <span class="n">crc32Table</span> <span class="p">=</span> <span class="k">new</span> <span class="n">UInt32</span><span class="p">[</span><span class="m">256</span><span class="p">];</span>
            <span class="c1">//CRC-32 の除数0x104c11db7を、予めビットの並び順を左右逆転させた値(0xEDB88320) を使用する。</span>
            <span class="kt">uint</span> <span class="n">poly</span> <span class="p">=</span> <span class="m">0xedb88320</span><span class="p">;</span>

            <span class="kt">uint</span> <span class="n">temp</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">uint</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">crc32Table</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">temp</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">8</span><span class="p">;</span> <span class="n">j</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">;</span> <span class="p">--</span><span class="n">j</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">((</span><span class="n">temp</span> <span class="p">&amp;</span> <span class="m">1</span><span class="p">)</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="c1">//&amp;で、andのビット演算</span>
                    <span class="p">{</span>
                        <span class="n">temp</span> <span class="p">=</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)((</span><span class="n">temp</span> <span class="p">&gt;&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="p">^</span> <span class="n">poly</span><span class="p">);</span> <span class="c1">//^で、xorのビット演算</span>
                    <span class="p">}</span>
                    <span class="k">else</span>
                    <span class="p">{</span>
                        <span class="n">temp</span> <span class="p">&gt;&gt;=</span> <span class="m">1</span><span class="p">;</span> <span class="c1">//÷(2の1乗)と同じ効果  </span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">crc32Table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">temp</span><span class="p">;</span>
            <span class="p">}</span>


            <span class="c1">//初期化  </span>
            <span class="kt">uint</span> <span class="n">crc</span> <span class="p">=</span> <span class="m">0xffffffff</span><span class="p">;</span>

            <span class="c1">//■渡されたファイルのバイナリから、CRC-32を算出して返す </span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
            <span class="p">{</span>   <span class="c1">//■計算の引き合いに出すテーブルのインデックス番号の算出  </span>
                <span class="kt">byte</span> <span class="n">index</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(((</span><span class="n">crc</span><span class="p">)</span> <span class="p">&amp;</span> <span class="m">0xff</span><span class="p">)</span> <span class="p">^</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>

                <span class="c1">//■次のビットにスライドする。  </span>
                <span class="c1">//→(crc &gt;&gt; 8)は、crcを(2の8乗)で割っていることと同義  </span>
                <span class="n">crc</span> <span class="p">=</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)((</span><span class="n">crc</span> <span class="p">&gt;&gt;</span> <span class="m">8</span><span class="p">)</span> <span class="p">^</span> <span class="n">crc32Table</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>
            <span class="p">}</span>

            <span class="c1">//ビット反転後バイト配列に変換して返す</span>
            <span class="k">return</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(~</span><span class="n">crc</span><span class="p">);</span> <span class="c1">//^で、notのビット演算</span>
        <span class="p">});</span>

        <span class="k">return</span> <span class="k">await</span> <span class="n">uploadTask</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
</div>

<p>例えば、<br>
以下のようなコードで、ファイルを選択して<br>
変換することが出来ます。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">Form1.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">private</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">Form1_Load</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>   <span class="c1">//ここは適当に記述しています。</span>
            <span class="k">using</span> <span class="p">(</span><span class="n">OpenFileDialog</span> <span class="n">fileDialog</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenFileDialog</span><span class="p">())</span>
            <span class="p">{</span>   <span class="c1">//PDFに直接変換したい画像ファイルを複数選択できるようにしている。</span>
                <span class="n">fileDialog</span><span class="p">.</span><span class="n">Filter</span> <span class="p">=</span> <span class="s">"画像データ (*.bmp;*jpeg;*.jpg;*.png)|*.bmp;*jpeg;*.jpg;*.png"</span><span class="p">;</span>
                <span class="n">fileDialog</span><span class="p">.</span><span class="n">Multiselect</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

                <span class="c1">//「開く」ボタンが選択された時の処理</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">fileDialog</span><span class="p">.</span><span class="nf">ShowDialog</span><span class="p">()</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
                <span class="p">{</span>   
                    <span class="c1">//変換したい画像のリストを取得</span>
                    <span class="kt">string</span><span class="p">[]</span> <span class="n">fileName</span> <span class="p">=</span> <span class="n">fileDialog</span><span class="p">.</span><span class="n">FileNames</span><span class="p">;</span>  <span class="c1">//こんな感じで選択されたファイルのパスが取得できる</span>

                    <span class="c1">//PDFは、今回は仮に、最初のファイルと同じフォルダに「test.pdf」として生成される。</span>
                    <span class="n">CreateODS</span> <span class="n">cls</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CreateODS</span><span class="p">();</span>

                    <span class="c1">//入力する文字を横着して、ここにて指定。</span>
                    <span class="n">cls</span><span class="p">.</span><span class="n">title_string</span> <span class="p">=</span> <span class="s">"ここにタイトル"</span><span class="p">;</span>
                    <span class="n">cls</span><span class="p">.</span><span class="n">subtitle_string</span> <span class="p">=</span> <span class="s">"ここにサブタイトル"</span><span class="p">;</span>
                    <span class="n">cls</span><span class="p">.</span><span class="n">seal_string</span> <span class="p">=</span><span class="err">　</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"肩書1"</span><span class="p">,</span> <span class="s">"肩書2"</span> <span class="p">};</span>
                    <span class="c1">//本文のところ。</span>
                    <span class="n">cls</span><span class="p">.</span><span class="n">main_string</span> <span class="p">=</span><span class="err">　</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"以下、本文です"</span><span class="p">,</span> <span class="s">"今日は晴れ"</span><span class="p">,</span>
                        <span class="s">"湿度は高め"</span><span class="p">,</span> <span class="s">"温度も高め"</span><span class="p">,</span> <span class="s">"いわゆる猛暑日"</span><span class="p">,</span> <span class="s">"とても暑い"</span><span class="p">,</span>
                        <span class="s">"困ったものです"</span><span class="p">,</span> <span class="s">"しかし、"</span><span class="p">,</span> <span class="s">"これも夏"</span><span class="p">,</span> <span class="s">"楽しまねば"</span><span class="p">};</span>

                    <span class="k">await</span> <span class="n">cls</span><span class="p">.</span><span class="nf">create_ods</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span>
                        <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="nf">GetDirectoryName</span><span class="p">(</span><span class="n">fileName</span><span class="p">[</span><span class="m">0</span><span class="p">]),</span> <span class="s">"test.ods"</span><span class="p">));</span>

                    <span class="c1">//おしまいのメッセージ</span>
                    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"END"</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">//さようなら</span>
            <span class="n">Application</span><span class="p">.</span><span class="nf">Exit</span><span class="p">();</span>
        <span class="p">}</span>

</code></pre></div>
</div>

<p>以上のコードを実行すると<br>
指定した画像のフォルダに、odsが生成されてあると思います。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Foyk3865b%2Fitems%2F7c89f81f2c4e17e78281&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Foyk3865b%2Fitems%2F7c89f81f2c4e17e78281&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/oyk3865b/items/7c89f81f2c4e17e78281/likers" class="css-1iupg5d">2</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">0</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/7c89f81f2c4e17e78281/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/oyk3865b/items/7c89f81f2c4e17e78281/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/oyk3865b/items/7c89f81f2c4e17e78281/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/oyk3865b/items/7c89f81f2c4e17e78281/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/oyk3865b/items/7c89f81f2c4e17e78281.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-89c5f488-fca7-4411-b65d-414132083949">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-d4c6cf3c-848e-4a15-9f1b-08e372810165"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-d4c6cf3c-848e-4a15-9f1b-08e372810165">{}</script>
      
<div id="LoginModal-react-component-1677d112-940b-4869-a49d-f54ef7fed6a8"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-1677d112-940b-4869-a49d-f54ef7fed6a8">{}</script>
      
<div id="StockModal-react-component-1e0b4cdf-8a5c-4136-aaa9-23ec9f31b5e6"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-1e0b4cdf-8a5c-4136-aaa9-23ec9f31b5e6">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;GK5OHhmOBsLM60koTuY1TNdeJMNi5AcIMD6D0CvZeVAabLOPqdaODg69+LZZi6s4j6s4qY/OmNZxTbIuB6lmsg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e表題の通り\u003cbr\u003e\nVisual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。\u003cbr\u003e\nコードのサンプルでございます。\u003c/p\u003e\n\n\u003cp\u003eodsは、LibreOfficeや、OpenOfficeなどで使用できるファイル形式で\u003cbr\u003e\nそれぞれが、インストールされていない環境下でも、作成できます。\u003cbr\u003e\nまた、odsは、Microsoft Excelでも扱えますが、ずれが生じたりします。\u003c/p\u003e\n\n\u003cp\u003e尚、Microsoft Excelで扱うxlsxは、\u003cbr\u003e\n内部は、似たようなxmlをzipでアーカイブしたものなので\u003cbr\u003e\n[参考サイト]\u003cbr\u003e\n\u003ca href=\"https://stackoverflow.com/questions/50738119/how-to-create-and-write-to-excel-file-xlsx/50886486\" rel=\"nofollow noopener\" target=\"_blank\"\u003ejava - How to create and write to Excel file (.xlsx)? - Stack Overflow\u003c/a\u003e\u003cbr\u003e\n上記のサイト様を参考にして、\u003cbr\u003e\nxmlの内容になるよう書き換えれば、xlsxファイルを、\u003cbr\u003e\nExcelが存在しない環境下でも、作成できるようになります。\u003c/p\u003e\n\n\u003cp\u003e特段、NuGetなど他のプラグインや\u003cbr\u003e\n別途外部dllを必要としないようにしています。\u003c/p\u003e\n\n\u003cp\u003e要は、バイナリを以下のように、直接叩いています。\u003cbr\u003e\n\u003cb\u003e1.\u003c/b\u003eods内部のxmlのファイルの記述\u003cbr\u003e\n\u003cb\u003e2.\u003c/b\u003exmlファイルを無圧縮でzipにアーカイブ。\u003cbr\u003e\n\u003cb\u003e3.\u003c/b\u003e画像は、メモリにJpeg形式で保存した上でアーカイブ。\u003c/p\u003e\n\n\u003cp\u003e※アーカイブするファイルの順番には、決まった順番があります。\u003cbr\u003e\n※私は素人ですし\u003cbr\u003e\n今回のコードは、あくまで最低限の動作する部分にとどめていますので、汚いです。\u003cbr\u003e\n例外処理や、解放など至らぬ点が、多々ございます。ご了承ください。\u003cbr\u003e\nもし実際に参考にされる際は、必要個所を必ず訂正してからにしてください。\u003c/p\u003e\n\n\u003cp\u003e下の画像は、今回コードでの作成例です。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/2694e530c2eaa135c047e8c297375fc0fd4e095e/68747470733a2f2f626c6f672d696d67732d3133302e6663322e636f6d2f6f2f792f6b2f6f796b33383635622f32303139303731353138303730363733612e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fblog-imgs-130.fc2.com%2Fo%2Fy%2Fk%2Foyk3865b%2F2019071518070673a.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6ec397db0b9cb7f06c50499552965d50\" alt=\"参考画像\" data-canonical-src=\"https://blog-imgs-130.fc2.com/o/y/k/oyk3865b/2019071518070673a.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fblog-imgs-130.fc2.com%2Fo%2Fy%2Fk%2Foyk3865b%2F2019071518070673a.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f5f3f7ce41417a8bc5984a7f2520f07f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[コード作成参考サイト]\u003cbr\u003e\n\u003ca href=\"https://code.msdn.microsoft.com/office/VBACRC-32-dad7d087\" rel=\"nofollow noopener\" target=\"_blank\"\u003e[VBA]CRC-32の計算 言語: VB.NET\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://blog.csdn.net/ciaos/article/details/12490911\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC#实现crc32函数 - 时间是把杀刀猪 - CSDN博客\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://sanity-free.org/12/crc32_implementation_in_csharp.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eA CRC32 implementation in C# - Sanity Free Coding - C#, .NET, PHP\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eCreateODS.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Drawing\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCreateODS\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//LibreOfficeや、OpenOfficeなどで使用できるODS形式を作成する。\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//Excelでも、扱えるが、ズレたりします。。。\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//グローバル変数用\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//■Local file header関係+++++++++++++++++++++++++++++++++++++++++++++++\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//Local file headerの識別子 4bytes(0x04034b50)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003elocal_file_header_signature\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0x4034B50\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//解凍に最低必要なバージョン 2bytes 今回は、ver.1.0で、無圧縮を指定(Default value)→0x000A \u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eversion_needed_to_extract\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0xA\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//オプションフラグと、圧縮方法 2+2bytes{今回はオプションもなく、圧縮もしないので、0を指定共に0x0000}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003egeneral_purpose_and_compression_method\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0x0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//ファイル更新時間 2bytes (秒数は偶数のみ指定可能)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003elast_mod_file_time\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e \u003cspan class=\"c1\"\u003e//00:00:00固定とする。\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//ファイル更新年月日 2bytes\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003elast_mod_file_date\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"m\"\u003e147\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e76\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e \u003cspan class=\"c1\"\u003e//2018/4/19固定とする。\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//CRC-32 4bytes{アーカイブ前の生ファイルから生成するCRC32}\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ecrc_32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eary_crc_32s\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//zip内の各ファイルの、CRC-32を格納。\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//圧縮後のファイルサイズ 4bytes{今回は無圧縮なので圧縮前の値と同値}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//圧縮前のファイルサイズ 4bytes\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003euncompressed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eary_uncompressed_sizes\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//zip内の各ファイルの、圧縮前のファイルサイズを格納。\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//アーカイブ前のファイル名のサイズを格納する 2bytes\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efile_name\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//ファイル名\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003efile_name_ary\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ファイル名のバイナリ\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eary_file_name_arys\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//zip内の各ファイルの、ファイル名のバイナリを格納。\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003efile_name_length\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//ファイル名のバイナリサイズ\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//拡張フィールドのサイズ 2bytes{今回は、指定しないので0x0000}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eextra_field_length\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0x0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e//■Central file header関係+++++++++++++++++++++++++++++++++++++++++++++++\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//Central file headerの識別子 4bytes(0x02014b50)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ecentral_file_header_signature\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0x2014B50\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//作成したバージョン　1+1bytes{今回は、ver.1.0で、無圧縮を指定(Default value)→0x000A }\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eversion_made_by\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0xA\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//ファイルの属性などの情報　2+2+2+4bytes　→　今回は無視するのですべて0\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003efile_attributes_etc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//対応するファイルのlocal file header信号のある位置　4bytes\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//出力zipの各local_file_header signatureの、バイト開始位置を示す4バイトのバイナリ配列を格納。\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003erelative_offset_of_local_header\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e//■End of central directory record関係+++++++++++++++++++++++++++++++++++++++++++++++\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//End of central directory record 4bytes(0x06054b50)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eend_of_central_dir_signature\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0x6054B50\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//ディスク分割情報　2+2bytes{ディスク分割はしていないのですべて0}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003enumber_of_this_disk\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0x0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//アーカイブしたファイルの個数 2+2bytes{ディスク分割はしていないので同じ内容の重複}\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003etotal_number_of_entries\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//全Central file headerに要したの合計バイト数 4bytes\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003esize_of_the_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//最初のCentral file headerの記述されたバイト位置 4bytes\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory_int\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//zipファイルへのコメントのサイズ 2bytes{今回は、指定しないので0x0000}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eZIP_file_comment_length\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0x0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//◆zipファイル入出力など、取扱関係+++++++++++++++++++++++++++++\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//出力zipのバイナリ一時格納用。\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n\n    \u003cspan class=\"c1\"\u003e//■アーカイブする文字列関係+++++++++++++++++++++++++++++++++++++++++++++++\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//OpenDocument Spreadsheetであることを示す\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003emimetype_xml\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"application/vnd.oasis.opendocument.spreadsheet\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//ドキュメントの印刷情報など\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estyles_xml\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:document-styles xmlns:table=\\\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\\\" xmlns:office=\\\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\\\" xmlns:text=\\\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\\\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"xmlns:style=\\\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\\\" xmlns:draw=\\\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\\\" xmlns:fo=\\\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\\\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:number=\\\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\\\" xmlns:svg=\\\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\\\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"xmlns:of=\\\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\\\" office:version=\\\"1.2\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:font-face-decls\u0026gt;\u0026lt;style:font-face style:name=\\\"ＭＳ Ｐゴシック\\\" svg:font-family=\\\"ＭＳ Ｐゴシック\\\"/\u0026gt;\u0026lt;/office:font-face-decls\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:styles\u0026gt;\u0026lt;number:number-style style:name=\\\"N0\\\"\u0026gt;\u0026lt;number:number number:min-integer-digits=\\\"1\\\"/\u0026gt;\u0026lt;/number:number-style\u0026gt;\u0026lt;style:style style:name=\\\"Default\\\" style:family=\\\"table-cell\\\" style:data-style-name=\\\"N0\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:table-cell-properties style:vertical-align=\\\"middle\\\" fo:background-color=\\\"transparent\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:text-properties fo:color=\\\"#000000\\\" style:font-name=\\\"ＭＳ Ｐゴシック\\\" style:font-name-asian=\\\"ＭＳ Ｐゴシック\\\" style:font-name-complex=\\\"ＭＳ Ｐゴシック\\\" fo:font-size=\\\"11pt\\\" style:font-size-asian=\\\"11pt\\\" style:font-size-complex=\\\"11pt\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:family=\\\"graphic\\\" style:name=\\\"Graphics\\\"/\u0026gt;\u0026lt;style:default-style style:family=\\\"graphic\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:graphic-properties draw:fill=\\\"solid\\\" draw:fill-color=\\\"#000000\\\" draw:opacity=\\\"100%\\\" draw:stroke=\\\"solid\\\" svg:stroke-width=\\\"0.01389in\\\" svg:stroke-color=\\\"#ffffff\\\" svg:stroke-opacity=\\\"100%\\\" draw:stroke-linejoin=\\\"miter\\\" svg:stroke-linecap=\\\"butt\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;/style:default-style\u0026gt;\u0026lt;/office:styles\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:automatic-styles\u0026gt;\u0026lt;style:page-layout style:name=\\\"pm1\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:page-layout-properties fo:margin-top=\\\"0.3cm\\\" fo:margin-bottom=\\\"0.3cm\\\" fo:margin-left=\\\"0.7cm\\\" fo:margin-right=\\\"0.7cm\\\" style:print-orientation=\\\"portrait\\\" style:print-page-order=\\\"ttb\\\" style:first-page-number=\\\"continue\\\" style:scale-to=\\\"100%\\\" style:table-centering=\\\"both\\\" style:print=\\\"objects charts drawings\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:header-style\u0026gt;\u0026lt;style:header-footer-properties fo:min-height=\\\"0.45cm\\\" fo:margin-left=\\\"0.7cm\\\" fo:margin-right=\\\"0.7cm\\\" fo:margin-bottom=\\\"0cm\\\"/\u0026gt;\u0026lt;/style:header-style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:footer-style\u0026gt;\u0026lt;style:header-footer-properties fo:min-height=\\\"0.45cm\\\" fo:margin-left=\\\"0.7cm\\\" fo:margin-right=\\\"0.7cm\\\" fo:margin-top=\\\"0cm\\\"/\u0026gt;\u0026lt;/style:footer-style\u0026gt;\u0026lt;/style:page-layout\u0026gt;\u0026lt;/office:automatic-styles\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:master-styles\u0026gt;\u0026lt;style:master-page style:name=\\\"mp1\\\" style:page-layout-name=\\\"pm1\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:header\u0026gt;\u0026lt;text:p\u0026gt;ヘッダー文字列\u0026lt;/text:p\u0026gt;\u0026lt;/style:header\u0026gt;\u0026lt;style:header-left style:display=\\\"false\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:footer\u0026gt;\u0026lt;text:p\u0026gt;フッター文字列\u0026lt;/text:p\u0026gt;\u0026lt;/style:footer\u0026gt;\u0026lt;style:footer-left style:display=\\\"false\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;/style:master-page\u0026gt;\u0026lt;/office:master-styles\u0026gt;\u0026lt;/office:document-styles\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//このシートで使用するファイル一覧\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eMETA_INF_manifest_xml_header\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;manifest:manifest xmlns:manifest=\\\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\\\"\u0026gt;\u0026lt;manifest:file-entry manifest:full-path=\\\"/\\\" manifest:media-type=\\\"application/vnd.oasis.opendocument.spreadsheet\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;manifest:file-entry manifest:full-path=\\\"styles.xml\\\" manifest:media-type=\\\"text/xml\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;manifest:file-entry manifest:full-path=\\\"content.xml\\\" manifest:media-type=\\\"text/xml\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//画像指定用\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eMETA_INF_manifest_xml_image\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;manifest:file-entry manifest:full-path=\\\"media/image1.jpeg\\\" manifest:media-type=\\\"image/jpeg\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eMETA_INF_manifest_xml_footer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;manifest:file-entry manifest:full-path=\\\"meta.xml\\\" manifest:media-type=\\\"text/xml\\\"/\u0026gt;\u0026lt;/manifest:manifest\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e//シートの内容すべてを格納するxml\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//※列幅、行高、画像のサイズの単位は、cmで統一。\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_header\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:document-content xmlns:table=\\\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\\\" xmlns:office=\\\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\\\" xmlns:text=\\\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\\\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"xmlns:style=\\\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\\\" xmlns:draw=\\\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\\\" xmlns:fo=\\\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\\\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:number=\\\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\\\" xmlns:svg=\\\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\\\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"xmlns:of=\\\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\\\" office:version=\\\"1.2\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:font-face-decls\u0026gt;\u0026lt;style:font-face style:name=\\\"ＭＳ Ｐゴシック\\\" svg:font-family=\\\"ＭＳ Ｐゴシック\\\"/\u0026gt;\u0026lt;/office:font-face-decls\u0026gt;\u0026lt;office:automatic-styles\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//このシートで使用するセルの書式設定を格納\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_cell_style\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ce1\\\" style:family=\\\"table-cell\\\" style:parent-style-name=\\\"Default\\\" style:data-style-name=\\\"N0\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//標準スタイル\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ce2\\\" style:family=\\\"table-cell\\\" style:parent-style-name=\\\"Default\\\" style:data-style-name=\\\"N0\\\"\u0026gt;\u0026lt;style:table-cell-properties style:vertical-align=\\\"middle\\\" style:repeat-content=\\\"false\\\"/\u0026gt;\u0026lt;style:paragraph-properties fo:text-align=\\\"center\\\"/\u0026gt;\u0026lt;style:text-properties fo:font-size=\\\"12pt\\\" style:font-size-asian=\\\"12pt\\\" style:font-size-complex=\\\"12pt\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//サブタイトル書式\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ce3\\\" style:family=\\\"table-cell\\\" style:parent-style-name=\\\"Default\\\" style:data-style-name=\\\"N0\\\"\u0026gt;\u0026lt;style:table-cell-properties fo:border=\\\"thin solid #000000\\\" style:vertical-align=\\\"middle\\\" style:repeat-content=\\\"false\\\"/\u0026gt;\u0026lt;style:paragraph-properties fo:text-align=\\\"center\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//肩書用\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ce4\\\" style:family=\\\"table-cell\\\" style:parent-style-name=\\\"Default\\\" style:data-style-name=\\\"N0\\\"\u0026gt;\u0026lt;style:table-cell-properties style:vertical-align=\\\"middle\\\" style:repeat-content=\\\"false\\\"/\u0026gt;\u0026lt;style:paragraph-properties fo:text-align=\\\"center\\\"/\u0026gt;\u0026lt;style:text-properties fo:font-size=\\\"16pt\\\" style:font-size-asian=\\\"16pt\\\" style:font-size-complex=\\\"16pt\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//タイトル用\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ce5\\\" style:family=\\\"table-cell\\\" style:parent-style-name=\\\"Default\\\" style:data-style-name=\\\"N0\\\"\u0026gt;\u0026lt;style:table-cell-properties fo:border=\\\"thin solid #000000\\\" style:vertical-align=\\\"middle\\\" style:repeat-content=\\\"false\\\"/\u0026gt;\u0026lt;style:paragraph-properties fo:text-align=\\\"start\\\" fo:margin-left=\\\"0.353cm\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//本文用\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//列の幅\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_column_style\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"co1\\\" style:family=\\\"table-column\\\"\u0026gt;\u0026lt;style:table-column-properties fo:break-before=\\\"auto\\\" style:column-width=\\\"11.5cm\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//1列目の設定\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"co2\\\" style:family=\\\"table-column\\\"\u0026gt;\u0026lt;style:table-column-properties fo:break-before=\\\"auto\\\" style:column-width=\\\"2.0cm\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//2～4列目の設定\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//行の高さ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_row_style\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ro1\\\" style:family=\\\"table-row\\\"\u0026gt;\u0026lt;style:table-row-properties style:row-height=\\\"0.48cm\\\" style:use-optimal-row-height=\\\"false\\\" fo:break-before=\\\"avoid\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//タイトル・肩書の行高\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ro2\\\" style:family=\\\"table-row\\\"\u0026gt;\u0026lt;style:table-row-properties style:row-height=\\\"1.06cm\\\" style:use-optimal-row-height=\\\"false\\\" fo:break-before=\\\"avoid\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//タイトル下部・押印枠上部\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ro3\\\" style:family=\\\"table-row\\\"\u0026gt;\u0026lt;style:table-row-properties style:row-height=\\\"0.5cm\\\" style:use-optimal-row-height=\\\"false\\\" fo:break-before=\\\"avoid\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//サブタイトル・押印枠下部\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ro4\\\" style:family=\\\"table-row\\\"\u0026gt;\u0026lt;style:table-row-properties style:row-height=\\\"0.48cm\\\" style:use-optimal-row-height=\\\"true\\\" fo:break-before=\\\"avoid\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//タイトルと本文の間隔\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ro5\\\" style:family=\\\"table-row\\\"\u0026gt;\u0026lt;style:table-row-properties style:row-height=\\\"0.85cm\\\" style:use-optimal-row-height=\\\"false\\\" fo:break-before=\\\"avoid\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//本文用\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ro6\\\" style:family=\\\"table-row\\\"\u0026gt;\u0026lt;style:table-row-properties style:row-height=\\\"0.48cm\\\" style:use-optimal-row-height=\\\"false\\\" fo:break-before=\\\"page\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//タイトル用（改行付き）\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//表全体\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_table_style\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:name=\\\"ta1\\\" style:family=\\\"table\\\" style:master-page-name=\\\"mp1\\\"\u0026gt;\u0026lt;style:table-properties table:display=\\\"true\\\" style:writing-mode=\\\"lr-tb\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//画像\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_graphics_style\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;style:style style:family=\\\"graphic\\\" style:name=\\\"a0\\\" style:parent-style-name=\\\"Graphics\\\"\u0026gt;\u0026lt;style:graphic-properties draw:fill=\\\"none\\\" draw:stroke=\\\"none\\\"/\u0026gt;\u0026lt;/style:style\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//スタイルフッター・シート本体開始\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_span1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;/office:automatic-styles\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:body\u0026gt;\u0026lt;office:spreadsheet\u0026gt;\u0026lt;table:calculation-settings table:case-sensitive=\\\"false\\\" table:search-criteria-must-apply-to-whole-cell=\\\"true\\\" table:use-wildcards=\\\"true\\\" table:use-regular-expressions=\\\"false\\\" table:automatic-find-labels=\\\"false\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;table:table table:name=\\\"Sheet1\\\" table:style-name=\\\"ta1\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//シート名\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;table:table-column table:style-name=\\\"co1\\\" table:default-cell-style-name=\\\"ce1\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//1行目の書式設定\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;table:table-column table:style-name=\\\"co2\\\" table:number-columns-repeated=\\\"3\\\" table:default-cell-style-name=\\\"ce1\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//2→4行目の書式設定\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//フッター。\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent_xml_footer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;/table:table\u0026gt;\u0026lt;/office:spreadsheet\u0026gt;\u0026lt;/office:body\u0026gt;\u0026lt;/office:document-content\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//更新日時など\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003emeta_xml\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\u0026lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:document-meta xmlns:office=\\\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\\\" xmlns:meta=\\\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\\\" xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" office:version=\\\"1.2\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;office:meta\u0026gt;\u0026lt;meta:generator\u0026gt;photoreport.attachment.style\u0026lt;/meta:generator\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;meta:initial-creator\u0026gt;TageSP\u0026lt;/meta:initial-creator\u0026gt;\u0026lt;dc:creator\u0026gt;TageSP\u0026lt;/dc:creator\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;meta:creation-date\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUtcNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"yyyy-MM-dd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"T\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUtcNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"hh:mm:ss\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Z\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;/meta:creation-date\u0026gt;\u0026lt;dc:date\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUtcNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"yyyy-MM-dd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"T\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUtcNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"hh:mm:ss\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Z\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\u0026lt;/dc:date\u0026gt;\u0026lt;/office:meta\u0026gt;\u0026lt;/office:document-meta\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreate_ods\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eimagepath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilepath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilepath\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//上書きする前に削除する\u003c/span\u003e\n            \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilepath\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//◎使用する各配列の初期化++++++++++++++++++++++++++\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eary_Clear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eary_crc_32s\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eary_uncompressed_sizes\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eary_file_name_arys\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erelative_offset_of_local_header\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//zipは、無圧縮で自分でバイナリを打っていく。\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileStream\u003c/span\u003e \u003cspan class=\"n\"\u003efs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFileStream\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilepath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileAccess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//実際に格納するバイナリを格納する\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//順番に従った格納をする。\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//アーカイブの先頭はmimetype固定。\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emimetype_xml\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efile_name\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"mimetype\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//印刷設定\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estyles_xml\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efile_name\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"styles.xml\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//使用するファイルのリスト\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMETA_INF_manifest_xml_header\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMETA_INF_manifest_xml_image\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMETA_INF_manifest_xml_footer\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efile_name\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"META-INF/manifest.xml\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//シート本文\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_header\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_cell_style\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_column_style\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_row_style\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_table_style\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_graphics_style\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_span1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e//本文は別処理\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003econtent_xml_make_main\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e//フッターで閉じる\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtent_xml_footer\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                    \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esheetdata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efile_name\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"content.xml\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//更新日時など\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emeta_xml\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efile_name\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"meta.xml\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//挿入画像\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBitmap\u003c/span\u003e \u003cspan class=\"n\"\u003ebitmap\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eimagepath\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ebaos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMemoryStream\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//今回は、とりあえず1つだけ画像を適用する。  \u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ebitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebaos\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDrawing\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eImaging\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eImageFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eJpeg\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eMemoryStream\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ebaos\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efile_name\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"media/image1.jpeg\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n\n\n                \u003cspan class=\"c1\"\u003e//■Local file headerの作成------------ここから-----------------\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//●予めlocal_file_header_signatureの記述位置を格納しておく(4バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003erelative_offset_of_local_header\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e//つまり現在のファイルサイズ\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○local_file_header_signatureの記述(4バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elocal_file_header_signature\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○解凍に必要なバージョンの記述(2バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eversion_needed_to_extract\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○オプションフラグと、圧縮方法の記述(2+2バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egeneral_purpose_and_compression_method\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//ファイルの更新時刻を格納(2バイト)//////////////////////////////////\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elast_mod_file_time\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○ファイルの更新年月日を格納(2バイト)//////////////////////////////////\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elast_mod_file_date\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e//○CRC32(4バイト)\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//元ファイルのバイナリからCRC-32を取得する。\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecrc_32\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"nf\"\u003eCRC_32_Checksum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//計算に時間がかかるので、待機させる\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecrc_32\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//再計算が面倒なので、central file headerに再利用するために記憶しておく。\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_crc_32s\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecrc_32\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e//○圧縮後のファイルサイズの取得(4バイト)｛無圧縮なので圧縮後のサイズと同値｝\u003c/span\u003e\n                \u003cspan class=\"n\"\u003euncompressed_size\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euncompressed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○圧縮前のファイルサイズの取得(4バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euncompressed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//再計算が面倒なので、central file headerに再利用するために記憶しておく。\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_uncompressed_sizes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○圧縮前のファイル名のサイズの取得(2バイト)\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//文字列をUTF-8コードとしてバイナリ化する\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efile_name_ary\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//文字列長を取得する。\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efile_name_length\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_name_ary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_name_length\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//格納\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○拡張フィールドのサイズ指定(2バイト){今回は指定なし}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eextra_field_length\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//格納\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e//○アーカイブ前のファイル名の格納\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_name_ary\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//file_name_aryに再利用するために記憶しておく。\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_file_name_arys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e//一旦、書き貯めたバイト型配列の内容をファイルに出力する\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[])\u003c/span\u003e\u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFlush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//■Local file headerの作成------------ここまで-----------------\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelay\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e//■ファイル本体のバイナリを書き込む\u003c/span\u003e\n                \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e//ファイルに出力する\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFlush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelay\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//これがないと、書き込み途中で放棄される？？\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emoto_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecrc_32\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecrc_32\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_name_length\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efile_name_length\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_name_ary\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efile_name_ary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e//★中盤戦。central file headerの記述********************************************\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//予め最初のCentral file headerの記述開始バイト位置を記憶しておく\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory_int\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory_int\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e//各ファイル分ループ\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eary_file_name_arys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//■central file headerの作成------------ここから-----------------\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//○central_file_header_signatureの記述(4バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecentral_file_header_signature\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○zipを作った時のバージョンとOSの記述(1+1バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eversion_made_by\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○解凍に必要なバージョンの記述(2バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eversion_needed_to_extract\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○オプションフラグと圧縮方法の記述(2+2バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egeneral_purpose_and_compression_method\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○ファイルの更新時刻(2バイト)[固定値]\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elast_mod_file_time\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○ファイルの更新年月日(2バイト)[固定値]\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elast_mod_file_date\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○CRC-32(4バイト)\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//https://www.morgantechspace.com/2013/08/convert-object-to-byte-array-and-vice.html\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eary_crc_32s\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]));\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e//○圧縮後のファイルサイズ(4バイト) {今回は、無圧縮なので、圧縮前のファイルサイズを流用}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ebs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eary_uncompressed_sizes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○圧縮前のファイルサイズ(4バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○ファイル名のサイズ(2バイト)\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ename_bs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eary_file_name_arys\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e//○拡張フィールドのサイズ(2バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eextra_field_length\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○ファイルの属性などの情報(2+2+2+4バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_attributes_etc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//○対応するファイルのlocal File header信号のある位置(4バイト)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ebs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erelative_offset_of_local_header\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e//○アーカイブ前のファイル名の格納\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ename_bs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e//一旦、書き貯めたバイト型配列の内容をファイルに出力する\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[])\u003c/span\u003e\u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFlush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//■central file headerの作成------------ここまで-----------------\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelay\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//◎使用する各配列の一旦、クリア++++++++++++++++++++++++++\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_crc_32s\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_uncompressed_sizes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erelative_offset_of_local_header\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e//★終盤戦End of central directory recordの記述********************************************\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//全Central file headerに要したの合計バイト数を予め算出しておく\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esize_of_the_central_directory\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory_int\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//■End of central directory recordの作成------------ここから-----------------\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//○end_of_central_dir_signatureの記述(4バイト)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eend_of_central_dir_signature\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//○ディスク分割情報(2+2バイト)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumber_of_this_disk\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//○アーカイブしたファイルの個数(2+2バイト){同じ内容を重複して格納}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etotal_number_of_entries\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eary_file_name_arys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etotal_number_of_entries\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etotal_number_of_entries\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//※重複分\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//○全Central file headerに要したの合計バイト数を格納(4バイト)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esize_of_the_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//○最初のCentral file headerの記述されたバイト位置(4バイト)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//○ファイルへのコメントのサイズ(2バイト){今回はなし}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eZIP_file_comment_length\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e//一旦、書き貯めたバイト型配列の内容をファイルに出力する\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[])\u003c/span\u003e\u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFlush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelay\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//これがないと、書き込み途中で放棄される？？\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//■End of central directory recordの作成------------ここまで-----------------\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etotal_number_of_entries\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etotal_number_of_entries\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esize_of_the_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize_of_the_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eoffset_of_start_of_central_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//初期化\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e//◎使用する各配列の念のためクリア++++++++++++++++++++++++++\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_crc_32s\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_uncompressed_sizes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erelative_offset_of_local_header\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//◎配列の初期化2++++++++++++++++++++++++++\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eary_Clear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eary_zip_file\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary_file_name_arys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//■後処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e//ファイルを閉じる \u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etitle_string\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"タイトル\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esubtitle_string\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"サブタイトル\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eseal_string\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003emain_string\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e \u003cspan class=\"nf\"\u003econtent_xml_make_main\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//content.xmlの本文を作成する場所\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//◆1行目（タイトル・肩書）\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-row table:style-name=\\\"ro1\\\"\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//1列目{2行目と結合}\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:number-columns-spanned=\\\"1\\\" table:number-rows-spanned=\\\"2\\\" table:style-name=\\\"ce4\\\"\u0026gt;\u0026lt;text:p\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etitle_string\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"\u0026lt;/text:p\u0026gt;\u0026lt;/table:table-cell\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//2列目(空白)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell table:style-name=\\\"ce1\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//3列目(肩書1)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:style-name=\\\"ce3\\\"\u0026gt;\u0026lt;text:p\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eseal_string\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"\u0026lt;/text:p\u0026gt;\u0026lt;/table:table-cell\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//4列目(肩書2)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:style-name=\\\"ce3\\\"\u0026gt;\u0026lt;text:p\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eseal_string\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"\u0026lt;/text:p\u0026gt;\u0026lt;/table:table-cell\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//1行目おわり\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;/table:table-row\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\n        \u003cspan class=\"c1\"\u003e//◆2行目（押印枠）\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-row table:style-name=\\\"ro2\\\"\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//1列目は、1行目との結合で遮蔽されている\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:covered-table-cell/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//2列目(空白)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell table:style-name=\\\"ce1\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//3列目(押印枠1){3行目と結合}\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:number-columns-spanned=\\\"1\\\" table:number-rows-spanned=\\\"2\\\" table:style-name=\\\"ce3\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//4列目(押印枠1){3行目と結合}\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:number-columns-spanned=\\\"1\\\" table:number-rows-spanned=\\\"2\\\" table:style-name=\\\"ce3\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;/table:table-row\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//◆3行目（サブタイトル）\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-row table:style-name=\\\"ro3\\\"\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//1列目（サブタイトル）\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:style-name=\\\"ce2\\\"\u0026gt;\u0026lt;text:p\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esubtitle_string\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n            \u003cspan class=\"s\"\u003e\"\u0026lt;/text:p\u0026gt;\u0026lt;/table:table-cell\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//2列目(空白)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell table:style-name=\\\"ce1\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//3、4列目は、2行目との結合で遮蔽されている\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:covered-table-cell/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:covered-table-cell/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;/table:table-row\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//◆4行目（全て空白）\u003c/span\u003e\n        \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-row table:style-name=\\\"ro4\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//◆5→14行目（本文）{10行分}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-row table:style-name=\\\"ro5\\\"\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//1行目は写真の挿入\u003c/span\u003e\n                \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:number-columns-spanned=\\\"1\\\" table:number-rows-spanned=\\\"10\\\" table:style-name=\\\"ce3\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n                    \u003cspan class=\"s\"\u003e\"\u0026lt;text:p/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"c1\"\u003e//文字はなし\u003c/span\u003e\n                    \u003cspan class=\"s\"\u003e\"\u0026lt;draw:frame draw:z-index=\\\"1\\\" draw:id=\\\"id0\\\" draw:style-name=\\\"a0\\\" draw:name=\\\"pic_image1\\\" svg:x=\\\"0.5cm\\\" svg:y=\\\"0.1cm\\\" svg:width=\\\"10.5cm\\\" svg:height=\\\"8.3cm\\\" style:rel-width=\\\"scale\\\" style:rel-height=\\\"scale\\\"\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n                    \u003cspan class=\"s\"\u003e\"\u0026lt;draw:image xlink:href=\\\"media/image1.jpeg\\\" xlink:type=\\\"simple\\\" xlink:show=\\\"embed\\\" xlink:actuate=\\\"onLoad\\\"/\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n                    \u003cspan class=\"s\"\u003e\"\u0026lt;svg:title/\u0026gt;\u0026lt;svg:desc/\u0026gt;\u0026lt;/draw:frame\u0026gt;\u0026lt;/table:table-cell\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//上のセルと結合\u003c/span\u003e\n                \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:covered-table-cell/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//コメント本文の記述\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:table-cell office:value-type=\\\"string\\\" table:number-columns-spanned=\\\"3\\\" table:number-rows-spanned=\\\"1\\\" table:style-name=\\\"ce3\\\"\u0026gt;\u0026lt;text:p\u0026gt;\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n                \u003cspan class=\"n\"\u003emain_string\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e\n                \u003cspan class=\"s\"\u003e\"\u0026lt;/text:p\u0026gt;\u0026lt;/table:table-cell\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//右2行は結合により遮蔽されている。\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;table:covered-table-cell table:number-columns-repeated=\\\"2\\\"/\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;/table:table-row\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003exmldata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eary_Clear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eary\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eClear_only_flg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//指定した配列の初期化をする\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eary\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eary\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//初期化のみの場合→出る\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eClear_only_flg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//新たに配列をセットしなおす\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eary\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003e]\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eCRC_32_Checksum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebytes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//★CRC32の計算をするところ  \u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//UIntegerの方法では、上手くできないのですorz  \u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//また、返数をByte()でなく、Long型にすると、値が狂います。  \u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//https://code.msdn.microsoft.com/office/VBACRC-32-dad7d087  \u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//https://blog.csdn.net/ciaos/article/details/12490911\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//http://sanity-free.org/12/crc32_implementation_in_csharp.html\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//計算に時間がかかるので、待機させる\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003e]\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003euploadTask\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStartNew\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003e]\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//■CRC32のテーブル情報の事前生成  \u003c/span\u003e\n            \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ecrc32Table\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eUInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e256\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//CRC-32 の除数0x104c11db7を、予めビットの並び順を左右逆転させた値(0xEDB88320) を使用する。\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003epoly\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0xedb88320\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ecrc32Table\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//\u0026amp;で、andのビット演算\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e)((\u003c/span\u003e\u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"n\"\u003epoly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//^で、xorのビット演算\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//÷(2の1乗)と同じ効果  \u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecrc32Table\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etemp\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e//初期化  \u003c/span\u003e\n            \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ecrc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0xffffffff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//■渡されたファイルのバイナリから、CRC-32を算出して返す \u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebytes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//■計算の引き合いに出すテーブルのインデックス番号の算出  \u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e)(((\u003c/span\u003e\u003cspan class=\"n\"\u003ecrc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"m\"\u003e0xff\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"n\"\u003ebytes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//■次のビットにスライドする。  \u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//→(crc \u0026gt;\u0026gt; 8)は、crcを(2の8乗)で割っていることと同義  \u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecrc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e)((\u003c/span\u003e\u003cspan class=\"n\"\u003ecrc\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"n\"\u003ecrc32Table\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//ビット反転後バイト配列に変換して返す\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(~\u003c/span\u003e\u003cspan class=\"n\"\u003ecrc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//^で、notのビット演算\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003euploadTask\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e例えば、\u003cbr\u003e\n以下のようなコードで、ファイルを選択して\u003cbr\u003e\n変換することが出来ます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eForm1.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_Load\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//ここは適当に記述しています。\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eOpenFileDialog\u003c/span\u003e \u003cspan class=\"n\"\u003efileDialog\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eOpenFileDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//PDFに直接変換したい画像ファイルを複数選択できるようにしている。\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efileDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"画像データ (*.bmp;*jpeg;*.jpg;*.png)|*.bmp;*jpeg;*.jpg;*.png\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efileDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMultiselect\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//「開く」ボタンが選択された時の処理\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efileDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShowDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e   \n                    \u003cspan class=\"c1\"\u003e//変換したい画像のリストを取得\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efileDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileNames\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e//こんな感じで選択されたファイルのパスが取得できる\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e//PDFは、今回は仮に、最初のファイルと同じフォルダに「test.pdf」として生成される。\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eCreateODS\u003c/span\u003e \u003cspan class=\"n\"\u003ecls\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateODS\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e//入力する文字を横着して、ここにて指定。\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecls\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etitle_string\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ここにタイトル\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecls\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esubtitle_string\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ここにサブタイトル\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecls\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eseal_string\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"err\"\u003e　\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"s\"\u003e\"肩書1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"肩書2\"\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//本文のところ。\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecls\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emain_string\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"err\"\u003e　\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"s\"\u003e\"以下、本文です\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"今日は晴れ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"s\"\u003e\"湿度は高め\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"温度も高め\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"いわゆる猛暑日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"とても暑い\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"s\"\u003e\"困ったものです\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"しかし、\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"これも夏\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"楽しまねば\"\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003ecls\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate_ods\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ePath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCombine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDirectoryName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]),\u003c/span\u003e \u003cspan class=\"s\"\u003e\"test.ods\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e//おしまいのメッセージ\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"END\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//さようなら\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以上のコードを実行すると\u003cbr\u003e\n指定した画像のフォルダに、odsが生成されてあると思います。\u003c/p\u003e\n","createdAt":"2019-07-15T09:25:19Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"0sRUaskJhnRehnO/9mORJXGX3reGSwXh--ssPru+siUwMl5iPG--ctuXAVoXO9FTNZBR+d1Fgw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2019-07-15T09:25:19Z","likesCount":2,"linkUrl":"https://qiita.com/oyk3865b/items/7c89f81f2c4e17e78281","organization":null,"originalId":968483,"stockedCount":0,"title":"Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。コードのサンプルです。","toc":null,"totalPv":1189,"uuid":"7c89f81f2c4e17e78281","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"FtRMNK6EptuFRNKTXOANFVTo56/w--bPMcmYpFBbbCahxF--LNI+d255/xL6Gc2YUoDE8w==","originalId":462441,"description":"下手の横好きで、汚いコードを独学で書いています。","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"Tage SP","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/462441/0d2ff6e3b7ec799eeb711a5afb4d8d1e71335f62/large.png?1618139424","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F462441%2F0d2ff6e3b7ec799eeb711a5afb4d8d1e71335f62%2Flarge.png%3F1618139424?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=2f30ae5d1aac2e5f083167c781009204","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F462441%2F0d2ff6e3b7ec799eeb711a5afb4d8d1e71335f62%2Flarge.png%3F1618139424?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=2e9b5eeeaded934621e02c84c31721a7","urlName":"oyk3865b","websiteUrl":"http://oyk3865b.blog13.fc2.com/","twitterUrl":"https://twitter.com/oyk3865b","twitterUrlName":"oyk3865b","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"ods","urlName":"ods"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
