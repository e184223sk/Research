<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#によるPowerPoint図形操作のサンプル - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/JVoltex/items/6b7232dc2757c904dde0" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="F8MnKOGXrozmRJxJrkSkxUDXEg4MNvhwGy1qJymwFIu+BOeHYQGuLUQwJQltkHNZeDfQLwuzoT/VfC/VHCU9HA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="C#によるPowerPoint図形操作のサンプル - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2F2amdvampnb3RRYjNkbGNsQnZhVzUwNVp1ejViMmk1cE9ONUwyYzQ0R3U0NEsxNDRPejQ0T1g0NE9yJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWU3MmU0OWYxMjNhZDM3M2JjMmUxYWViY2I3MTA2NDBj&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRXBXYjJ4MFpYZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWJiZTM1OGJjODkyMDBmM2E2Y2JhZDgxZGRlOWQ1ZjNj&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=6f407d1d672f1c06eda7de229268ef61"><meta property="og:description" content="

はじめに

プログラムからPowerPointの図形追加をする際、日本語の簡易なコードサンプルが見つけられず時間を奪われたので、誰かが同じ苦労をしないようにコードサンプルを載せます。使用言語はC#です。Visual Studio ..."><meta content="https://qiita.com/JVoltex/items/6b7232dc2757c904dde0" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,PowerPoint,プレゼンテーション,OpenXML,図形" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-75647bb0-c702-4edf-8914-fe0b8adc5c08"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FJVoltex%2Fitems%2F6b7232dc2757c904dde0">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FJVoltex%2Fitems%2F6b7232dc2757c904dde0">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-75647bb0-c702-4edf-8914-fe0b8adc5c08">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-02-04T15:38:44.000+09:00","dateModified":"2017-02-05T07:08:13.000+09:00","headline":"C#によるPowerPoint図形操作のサンプル","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2F2amdvampnb3RRYjNkbGNsQnZhVzUwNVp1ejViMmk1cE9ONUwyYzQ0R3U0NEsxNDRPejQ0T1g0NE9yJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWU3MmU0OWYxMjNhZDM3M2JjMmUxYWViY2I3MTA2NDBj\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRXBXYjJ4MFpYZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWJiZTM1OGJjODkyMDBmM2E2Y2JhZDgxZGRlOWQ1ZjNj\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=6f407d1d672f1c06eda7de229268ef61","mainEntityOfPage":"https://qiita.com/JVoltex/items/6b7232dc2757c904dde0","author":{"@type":"Person","address":"","email":null,"identifier":"JVoltex","name":"JVoltex","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F125749%2Fprofile-images%2F1486211730?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e04464f8172aa27f8a311d8f4fdeb8fe","url":"https://qiita.com/JVoltex","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"JVoltex","type":"items","id":"6b7232dc2757c904dde0"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"JVoltex","type":"items","id":"6b7232dc2757c904dde0"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"JVoltex","type":"items","id":"6b7232dc2757c904dde0"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/JVoltex/items/6b7232dc2757c904dde0","location":"/JVoltex/items/6b7232dc2757c904dde0","scheme":"https","host":"qiita.com","port":null,"pathname":"/JVoltex/items/6b7232dc2757c904dde0","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"sUEElRsvYzQY+ZUybDqTLuC8JvCr4ZZd7tGlJpjPaK0YhsQ6m7ljlbqNLHKv7kSy2Fzk0axkzxIggODUrVpBOg==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-db1f9386-fa49-4d91-92ae-65d4bb111a31"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/JVoltex/items/6b7232dc2757c904dde0/likers" class="css-1iupg5d">8</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">11</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6b7232dc2757c904dde0/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/JVoltex/items/6b7232dc2757c904dde0/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/JVoltex/items/6b7232dc2757c904dde0/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/JVoltex/items/6b7232dc2757c904dde0/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/JVoltex/items/6b7232dc2757c904dde0.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/JVoltex"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/125749/profile-images/1486211730" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/JVoltex" class="css-10ougpm">@<!-- -->JVoltex</a><div class="css-1ay9vb9"><span><meta content="2017-02-04T06:38:44Z"/><time dateTime="2017-02-04T22:08:13Z" class="css-m19uds">updated at 2017-02-04</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#によるPowerPoint図形操作のサンプル</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/powerpoint" class="css-4czcte">PowerPoint</a><a href="/tags/%e3%83%97%e3%83%ac%e3%82%bc%e3%83%b3%e3%83%86%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3" class="css-4czcte">プレゼンテーション</a><a href="/tags/openxml" class="css-4czcte">OpenXML</a><a href="/tags/%e5%9b%b3%e5%bd%a2" class="css-4czcte">図形</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>プログラムからPowerPointの図形追加をする際、日本語の簡易なコードサンプルが見つけられず時間を奪われたので、誰かが同じ苦労をしないようにコードサンプルを載せます。使用言語はC#です。Visual Studio 2015を使います。</p>

<h1>
<span id="powerpointのファイル形式openxml" class="fragment"></span><a href="#powerpoint%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%BD%A2%E5%BC%8Fopenxml"><i class="fa fa-link"></i></a>PowerPointのファイル形式：OpenXML</h1>

<p>C#からのOfficeのファイル操作には、<a href="https://msdn.microsoft.com/ja-jp/library/office/bb448854.aspx" rel="nofollow noopener" target="_blank">OpenXML SDK</a>を利用できます。</p>

<h3>
<span id="openxml" class="fragment"></span><a href="#openxml"><i class="fa fa-link"></i></a>OpenXML</h3>

<p>Office 2007以降のPowerPointファイルは、<a href="https://msdn.microsoft.com/ja-jp/library/office/gg278325.aspx" rel="nofollow noopener" target="_blank">OpenXML</a>という仕様に準拠しています。OpenXMLの中でもPowerPointファイルを構成する言語を<a href="https://msdn.microsoft.com/ja-jp/library/office/gg278318.aspx" rel="nofollow noopener" target="_blank">PresentationML</a>と言います。実体はいくつかのXMLファイル（と、画像などのファイル）をzip圧縮したものです。試しにpptxファイルをzip解凍すると、アプリケーションが対象とするオブジェクト（例えばPowerPointのスライドマスター）に対応したXMLファイルを確認することができます。</p>

<h3>
<span id="openxml-sdk" class="fragment"></span><a href="#openxml-sdk"><i class="fa fa-link"></i></a>OpenXML SDK</h3>

<p>OpenXML SDKは、OpenXML形式のファイルの読み書きを支援するライブラリです。</p>

<p>OpenXML SDKでは、XMLの各要素に対応したクラスがあり、要素の属性に対応したプロパティがあります。<br>
例えばPowerPointでは、スライドを表すSlideクラス、図形を表すShapeクラス、図形の外線を表すOutlineがあり、線幅を表すOutlineのメンバ変数であるWidthがあります。</p>

<p>また、Microsoft の<a href="https://www.microsoft.com/en-us/download/details.aspx?id=30425" rel="nofollow noopener" target="_blank">ダウンロード センター</a>では、OpenXMLSDKToolV25.msiというツールがあります。<br>
OpenXMLの構造をグラフィカルに表示できるだけでなく、XMLの不正な点を検出したり（Validate）、2 つの OpenXML ファイルを比較（Compare Files）したりできるようです。</p>

<h1>
<span id="準備openxml-sdkパッケージのインストール" class="fragment"></span><a href="#%E6%BA%96%E5%82%99openxml-sdk%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>準備：OpenXML SDKパッケージのインストール</h1>

<p>準備として、<a href="https://www.nuget.org/" rel="nofollow noopener" target="_blank">Nuget</a>で<a href="https://github.com/OfficeDev/Open-XML-SDK" rel="nofollow noopener" target="_blank">OpenXML SDKのパッケージ</a>をインストールします。デフォルトのパッケージソースであるnuget.orgからは得られないので、まずパッケージソースの設定を行います。</p>

<h3>
<span id="パッケージソースの設定" class="fragment"></span><a href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>パッケージソースの設定</h3>

<p><a href="https://github.com/OfficeDev/Open-XML-SDK" rel="nofollow noopener" target="_blank">OpenXML SDKのパッケージ</a>に行って、Table 1: The latest builds are available via a MyGet feedからパッケージソースのFeed URLを得ます。Nuget V3であれば<a href="https://dotnet.myget.org/F/open-xml-sdk/api/v3/index.json" class="autolink" rel="nofollow noopener" target="_blank">https://dotnet.myget.org/F/open-xml-sdk/api/v3/index.json</a> になります。</p>

<p>次の手順でパッケージソースをVisual Studio Nugetパッケージマネージャーの設定に追加します。</p>

<ul>
<li>Visual Studio のツール -&gt; Nugetパッケージマネージャー -&gt; パッケージマネージャー設定 をクリックしてオプションを開く</li>
<li>Nugetパッケージマネージャー/パッケージソースの項目を開き、利用可能なパッケージソースに項目を追加</li>
<li>適当な名前（ここではdotnetopenxml）をつけ、ソースに先ほどのURLを記入して更新。</li>
</ul>

<p>参考：<a href="https://ufcpp.wordpress.com/2015/04/12/myget-%E3%81%8B%E3%82%89%E3%81%AE%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8F%96%E5%BE%97/" rel="nofollow noopener" target="_blank">mygetからのパッケージ取得</a>、<a href="https://github.com/OfficeDev/Open-XML-SDK" rel="nofollow noopener" target="_blank">github.com/OfficeDev/Open-XML-SDK</a></p>

<h3>
<span id="openxml-sdkパッケージのインストール" class="fragment"></span><a href="#openxml-sdk%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>OpenXML SDKパッケージのインストール</h3>

<p>ソリューションのNugetパッケージマネージャーを開いて、パッケージソースを先ほど加えたもの（dotnetopenxml）に変更すると、DocumentFormat.OpenXMLというパッケージが検出されます。それをインストールします。</p>

<h1>
<span id="コードサンプル" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB"><i class="fa fa-link"></i></a>コードサンプル</h1>

<p>ここからコードサンプルです。<br>
すでにスライドが生成されたpptxファイル（hoge.pptx）が用意されているものとします。</p>

<h2>
<span id="shapetreeオブジェクトの取得" class="fragment"></span><a href="#shapetree%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E5%8F%96%E5%BE%97"><i class="fa fa-link"></i></a>ShapeTreeオブジェクトの取得</h2>

<p>図形を加えたり、望みの図形を得るためには、まずhoge.pptxの適当なスライドから、図形をまとめて管理するオブジェクトである<a href="https://msdn.microsoft.com/ja-jp/library/documentformat.openxml.presentation.shapetree(v=office.14).aspx" rel="nofollow noopener" target="_blank">ShapeTree</a>を取得します。この辺りのちゃんとした説明は<a href="https://msdn.microsoft.com/ja-jp/library/office/cc850847.aspx" rel="nofollow noopener" target="_blank">[方法] プレゼンテーション内の図形の塗りつぶしの色を変更する (Open XML SDK)</a>が詳しいです。</p>

<p>では、コードの全体像を示します。流れは次のようになります。</p>

<ol>
<li>PresentationDocument.Openを使って、ファイル名fileNameからPresentationDocumentを取得</li>
<li>最初のスライドのスライド番号（relId）を取得</li>
<li>relIdが示すスライドのShapeTreeを取得（ppshapeTree）</li>
<li>generateShapes()（後述）でppshapeTreeに図形を追加</li>
<li>変更の保存をして終わり</li>
</ol>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">DocumentFormat.OpenXml.Presentation</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">DocumentFormat.OpenXml.Packaging</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">DocumentFormat.OpenXml</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">D</span> <span class="p">=</span> <span class="n">DocumentFormat</span><span class="p">.</span><span class="n">OpenXml</span><span class="p">.</span><span class="n">Drawing</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ShapeTree</span> <span class="n">ppshapeTree</span><span class="p">;</span>
        <span class="kt">string</span> <span class="n">fileName</span> <span class="p">=</span> <span class="s">"hoge.pptx"</span><span class="p">;</span>
        <span class="n">PresentationDocument</span> <span class="n">ppt</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="k">using</span> <span class="p">(</span><span class="n">ppt</span> <span class="p">=</span> <span class="n">PresentationDocument</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="k">true</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\""</span> <span class="p">+</span> <span class="n">fileName</span> <span class="p">+</span> <span class="s">"\" has opened."</span><span class="p">);</span>

            <span class="c1">// Get the relationship ID of the first slide.</span>
            <span class="n">PresentationPart</span> <span class="n">part</span> <span class="p">=</span> <span class="n">ppt</span><span class="p">.</span><span class="n">PresentationPart</span><span class="p">;</span>
            <span class="n">OpenXmlElementList</span> <span class="n">slideIds</span> <span class="p">=</span> <span class="n">part</span><span class="p">.</span><span class="n">Presentation</span><span class="p">.</span><span class="n">SlideIdList</span><span class="p">.</span><span class="n">ChildElements</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">relId</span> <span class="p">=</span> <span class="p">(</span><span class="n">slideIds</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="k">as</span> <span class="n">SlideId</span><span class="p">).</span><span class="n">RelationshipId</span><span class="p">;</span>

            <span class="c1">// Get the slide part from the relationship ID.</span>
            <span class="n">SlidePart</span> <span class="n">ppslide</span> <span class="p">=</span> <span class="p">(</span><span class="n">SlidePart</span><span class="p">)</span><span class="n">part</span><span class="p">.</span><span class="nf">GetPartById</span><span class="p">(</span><span class="n">relId</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ppslide</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">ppshapeTree</span> <span class="p">=</span> <span class="n">ppslide</span><span class="p">.</span><span class="n">Slide</span><span class="p">.</span><span class="n">CommonSlideData</span><span class="p">.</span><span class="n">ShapeTree</span><span class="p">;</span>
                <span class="nf">generateShapes</span><span class="p">(</span><span class="n">ppshapeTree</span><span class="p">);</span>

                <span class="n">ppslide</span><span class="p">.</span><span class="n">Slide</span><span class="p">.</span><span class="nf">Save</span><span class="p">();</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\""</span> <span class="p">+</span> <span class="n">fileName</span> <span class="p">+</span> <span class="s">"\" has been changed."</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>   
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2>
<span id="図形を生成してスライドに加えるメソッドの作成" class="fragment"></span><a href="#%E5%9B%B3%E5%BD%A2%E3%82%92%E7%94%9F%E6%88%90%E3%81%97%E3%81%A6%E3%82%B9%E3%83%A9%E3%82%A4%E3%83%89%E3%81%AB%E5%8A%A0%E3%81%88%E3%82%8B%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>図形を生成してスライドに加えるメソッドの作成</h2>

<p>generateShapes()の中で使用する汎用的な図形生成メソッドを作成していきます。<br>
名前はAddShape_()とします。</p>

<p>オブジェクトの追加は、そのオブジェクトの親のAppendメソッドによって追加していきます。図形の追加であれば、Shapeインスタンスを生成して、ppshapeTreeに対してAppendすればいいということになります。</p>

<h3>
<span id="shapeインスタンスの生成" class="fragment"></span><a href="#shape%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90"><i class="fa fa-link"></i></a>Shapeインスタンスの生成</h3>

<p>Shapeインスタンスを追加したい図形オブジェクトになるようにするには、そのメンバ変数で指定すればいいというわけではなく、特徴を表すインスタンスをAppendしていきます。</p>

<p>Shapeインスタンスには、次の4つのクラスのインスタンスをAppendする必要があります。</p>

<ul>
<li>NonVisualShapeProperties</li>
<li>ShapeProperties</li>
<li>ShapeStyle</li>
<li>TextBody</li>
</ul>

<p>したがって、AddShape_メソッドは次の手順で書かれています。</p>

<ol>
<li>Shapeインスタンスshape1を生成</li>
<li>NonVisualShapePropertiesを生成してshape1にAppend</li>
<li>ShapePropertiesに引数を渡して生成してshape1にAppend</li>
<li>ShapeStyleを生成してshape1にAppend</li>
<li>TextBodyを生成してshape1にAppend</li>
<li>shape1を引数ShapeTree ppshapeTreeにAppend</li>
</ol>

<p>ShapeインスタンスにAppendするインスタンスはmakeProperties（後述）をはじめとしたメソッドの中で作成しています。<br>
これらのインスタンスにもまた、その子オブジェクトのインスタンスをAppendしていく必要があります。<br>
足らないとファイルが開けなかったり、PowerPointを開いたときに正しく図形が表示できなかったりします。</p>

<p>Shapeインスタンスを追加したい図形オブジェクトになるようにするには、ShapePropertiesインスタンス以下を指定していきます。だから、AddShape_メソッドのppshapeTree以外の引数はmakeShapeProperties()に渡しています。makeShapeProperties()だけが関心事なので、以降でmakeShapeProperties()とそれ以外は分けて表示します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="k">static</span> <span class="k">class</span> <span class="nc">AddShape</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">cm2shapescale</span> <span class="p">=</span> <span class="m">360000</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">degree2shapescale</span> <span class="p">=</span> <span class="m">60000</span><span class="p">;</span>

        <span class="k">static</span> <span class="k">void</span> <span class="nf">AddShape_</span><span class="p">(</span>
                <span class="n">ShapeTree</span> <span class="n">ppshapeTree</span><span class="p">,</span>
                <span class="n">D</span><span class="p">.</span><span class="n">ShapeTypeValues</span> <span class="n">shapeType</span> <span class="p">=</span> <span class="n">D</span><span class="p">.</span><span class="n">ShapeTypeValues</span><span class="p">.</span><span class="n">Rectangle</span><span class="p">,</span><span class="c1">// Any of the built-in shapes (ellipse, rectangle, etc)</span>
                <span class="kt">string</span> <span class="n">fill_rgbColorHex</span> <span class="p">=</span> <span class="s">"EEECE1"</span><span class="p">,</span> <span class="c1">// Hexadecimal RGB color code to fill the shape.</span>
                <span class="kt">bool</span> <span class="n">isnooutline</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
                <span class="n">D</span><span class="p">.</span><span class="n">SchemeColorValues</span> <span class="n">outlineSchemeColor</span> <span class="p">=</span> <span class="n">D</span><span class="p">.</span><span class="n">SchemeColorValues</span><span class="p">.</span><span class="n">Text1</span><span class="p">,</span>
                <span class="kt">float</span> <span class="n">x</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="c1">// Represents the shape x position in 1 cm.</span>
                <span class="kt">float</span> <span class="n">y</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="c1">// Represents the shape y position in 2 cm.</span>
                <span class="kt">float</span> <span class="n">width</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="c1">// Shapw width in in 2 cm.</span>
                <span class="kt">float</span> <span class="n">height</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="c1">// Shapw height in in 2 cm.</span>
                <span class="kt">bool</span> <span class="n">horizontalFlip</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
                <span class="kt">bool</span> <span class="n">verticalFlip</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
                <span class="kt">int</span> <span class="n">angle</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>   <span class="c1">//degree</span>
                <span class="kt">bool</span> <span class="n">isdashline</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
                <span class="kt">bool</span> <span class="n">isTailEndArrow</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
                <span class="kt">bool</span> <span class="n">isHeadEndArrow</span> <span class="p">=</span> <span class="k">false</span>
            <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Shape</span> <span class="n">shape1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Shape</span><span class="p">();</span>
            <span class="n">shape1</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="nf">makeNonVisualShapeProperties</span><span class="p">());</span>
            <span class="n">shape1</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="nf">makeShapeProperties</span><span class="p">(</span>
                <span class="n">shapeType</span><span class="p">:</span> <span class="n">shapeType</span><span class="p">,</span>
                <span class="n">fill_rgbColorHex</span><span class="p">:</span> <span class="n">fill_rgbColorHex</span><span class="p">,</span>
                <span class="n">isnooutline</span><span class="p">:</span> <span class="n">isnooutline</span><span class="p">,</span>
                <span class="n">outlineSchemeColor</span><span class="p">:</span> <span class="n">outlineSchemeColor</span><span class="p">,</span>
                <span class="n">x</span><span class="p">:</span> <span class="nf">getcm2shapescale</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                <span class="n">y</span><span class="p">:</span> <span class="nf">getcm2shapescale</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                <span class="n">width</span><span class="p">:</span> <span class="nf">getcm2shapescale</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
                <span class="n">height</span><span class="p">:</span> <span class="nf">getcm2shapescale</span><span class="p">(</span><span class="n">height</span><span class="p">),</span>
                <span class="n">horizontalFlip</span><span class="p">:</span> <span class="n">horizontalFlip</span><span class="p">,</span> <span class="n">verticalFlip</span><span class="p">:</span> <span class="n">verticalFlip</span><span class="p">,</span>
                <span class="n">angle</span><span class="p">:</span> <span class="nf">getDegree2shapescale</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span>
                <span class="n">isdashline</span><span class="p">:</span> <span class="n">isdashline</span><span class="p">,</span>
                <span class="n">isTailEndArrow</span><span class="p">:</span> <span class="n">isTailEndArrow</span><span class="p">,</span>
                <span class="n">isHeadEndArrow</span><span class="p">:</span> <span class="n">isHeadEndArrow</span><span class="p">)</span>
                <span class="p">);</span>
            <span class="n">shape1</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="nf">makeShapeStyle</span><span class="p">());</span>
            <span class="n">shape1</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="nf">makeTextBody</span><span class="p">());</span>
            <span class="n">ppshapeTree</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">shape1</span><span class="p">);</span>

        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">long</span> <span class="nf">getcm2shapescale</span><span class="p">(</span><span class="kt">float</span> <span class="n">cm_val</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="p">(</span><span class="kt">long</span><span class="p">)(</span><span class="n">cm_val</span> <span class="p">*</span> <span class="n">cm2shapescale</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">int</span> <span class="nf">getDegree2shapescale</span><span class="p">(</span><span class="kt">int</span> <span class="n">angle</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">angle</span> <span class="p">*</span> <span class="n">degree2shapescale</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="p">.</span>
        <span class="p">.</span>
        <span class="p">.</span>

    <span class="p">}</span>
</code></pre></div></div>

<p>AddShape_メソッドの引数は次のようなことを表現します。<br>
</p><dl>
<br>
<dt>
<br>
shapeType<br>
<dt>
<br>
</dt>
</dt>
<dd>
<br>
図の外形になります。線（Line）にしたり四角形（Rectangle）にしたりできます。<a href="https://msdn.microsoft.com/ja-jp/library/documentformat.openxml.drawing.shapetypevalues(v=office.14).aspx" rel="nofollow noopener" target="_blank">ShapeTypeValues</a>に指定できる図の種類が示されています。<br>
<dd>
<br>
</dd>
</dd>
<dt>
<br>
fill_rgbColorHex<br>
<dt>
<br>
</dt>
</dt>
<dd>
<br>
図形の塗りつぶしの色になります。16進数RGBカラーコードを入力します。<br>
<dd>
<br>
</dd>
</dd>
<dt>
<br>
outlineSchemeColor<br>
<dt>
<br>
</dt>
</dt>
<dd>
<br>
図形の外線の線種・線色になります。<a href="https://msdn.microsoft.com/ja-jp/library/documentformat.openxml.drawing.schemecolorvalues(v=office.14).aspx" rel="nofollow noopener" target="_blank">SchemeColorValues</a>に指定できる値が示されています。<br>
<dd>
<br>
</dd>
</dd>
<dt>
<br>
xとy<br>
<dt>
<br>
</dt>
</dt>
<dd>
<br>
それぞれ横方向、縦方向の座標を表します。PowerPointスライドの左上が(x=0, y=0)です。cm単位です。<br>
<dd>
<br>
</dd>
</dd>
</dl>

<p>あとはだいたいわかると思います。getcm2shapescale()やgetDegree2shapescale()でShapeProperties以下での座標や角度のスケールに変換してからmakeShapePropertiesに値を渡します。</p>

<h3>
<span id="shapepropertiesインスタンスの生成" class="fragment"></span><a href="#shapeproperties%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90"><i class="fa fa-link"></i></a>ShapePropertiesインスタンスの生成</h3>

<p>makeShapeProperties()では、引数を該当のインスタンスのメンバ変数に代入していきます。</p>

<div class="code-frame" data-lang="charp"><div class="highlight"><pre class="with-code"><code>static private ShapeProperties makeShapeProperties(
            D.ShapeTypeValues shapeType = D.ShapeTypeValues.Rectangle,// Any of the built-in shapes (ellipse, rectangle, etc)
            string fill_rgbColorHex = "EEECE1", // Hexadecimal RGB color code to fill the shape.
            bool isnooutline = false,  //no outline
            D.SchemeColorValues outlineSchemeColor = D.SchemeColorValues.Text1,
            long x = 360000, // Represents the shape x position in 1/36000 cm.
            long y = 720000, // Represents the shape y position in 1/36000 cm.
            long width = 720000, // Shapw width in in 1/36000 cm.
            long height = 720000, // Shapw height in in 1/36000 cm.
            bool horizontalFlip = false,
            bool verticalFlip = false,
            int angle = 0,  //2700000 * 4 = 180 degree
            bool isdashline = false,
            bool isTailEndArrow = false,
            bool isHeadEndArrow = false
            )
        {
            ShapeProperties shapeProperties1 = new ShapeProperties();

            D.Transform2D transform2D1 = new D.Transform2D();
            D.Offset offset1 = new D.Offset() { X = x, Y = y };
            D.Extents extents1 = new D.Extents() { Cx = width, Cy = height };

            transform2D1.HorizontalFlip = horizontalFlip;
            transform2D1.VerticalFlip = verticalFlip;
            transform2D1.Rotation = angle;

            transform2D1.Append(offset1);
            transform2D1.Append(extents1);

            D.PresetGeometry presetGeometry1 = new D.PresetGeometry() { Preset = shapeType };
            D.AdjustValueList adjustValueList1 = new D.AdjustValueList();

            presetGeometry1.Append(adjustValueList1);

            D.SolidFill solidFill1 = new D.SolidFill();
            D.RgbColorModelHex rgbColorModelHex1 = new D.RgbColorModelHex() { Val = fill_rgbColorHex };

            solidFill1.Append(rgbColorModelHex1);

            D.Outline outline1 = new D.Outline() { Width = 12700 };
            if (isnooutline)
            {
                D.NoFill nofill = new D.NoFill();
                outline1.Append(nofill);
            }
            else
            {
                D.SolidFill solidFill2 = new D.SolidFill();
                D.SchemeColor schemeColor1 = new D.SchemeColor() { Val = outlineSchemeColor };
                solidFill2.Append(schemeColor1);
                outline1.Append(solidFill2);

                //dash
                if (isdashline)
                {
                    D.PresetDash presetDash = new D.PresetDash() { Val = D.PresetLineDashValues.Dash };
                    outline1.Append(presetDash);
                }

                //arrow
                if (isTailEndArrow)
                {
                    D.TailEnd tailend = new D.TailEnd() { Type = D.LineEndValues.Arrow };
                    outline1.Append(tailend);
                }
                if (isHeadEndArrow)
                {
                    D.HeadEnd headend = new D.HeadEnd() { Type = D.LineEndValues.Arrow };
                    outline1.Append(headend);
                }
            }

            shapeProperties1.Append(transform2D1);
            shapeProperties1.Append(presetGeometry1);
            shapeProperties1.Append(solidFill1);
            shapeProperties1.Append(outline1);
            return shapeProperties1;
        }

</code></pre></div></div>

<h3>
<span id="その他のインスタンスの生成" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90"><i class="fa fa-link"></i></a>その他のインスタンスの生成</h3>

<p>おまじないを書きます。<a href="http://stackoverflow.com/questions/18810001/how-to-insert-a-shape-in-a-powerpoint-slide" rel="nofollow noopener" target="_blank">ここ</a>を参考にしました。</p>

<div class="code-frame" data-lang="charp"><div class="highlight"><pre class="with-code"><code>        static private ShapeStyle makeShapeStyle()
        {
            ShapeStyle shapeStyle1 = new ShapeStyle();

            D.LineReference lineReference1 = new D.LineReference() { Index = (UInt32Value)2U };

            D.SchemeColor schemeColor2 = new D.SchemeColor() { Val = D.SchemeColorValues.Accent1 };
            D.Shade shade1 = new D.Shade() { Val = 50000 };

            schemeColor2.Append(shade1);

            lineReference1.Append(schemeColor2);

            D.FillReference fillReference1 = new D.FillReference() { Index = (UInt32Value)1U };
            D.SchemeColor schemeColor3 = new D.SchemeColor() { Val = D.SchemeColorValues.Accent1 };

            fillReference1.Append(schemeColor3);

            D.EffectReference effectReference1 = new D.EffectReference() { Index = (UInt32Value)0U };
            D.SchemeColor schemeColor4 = new D.SchemeColor() { Val = D.SchemeColorValues.Accent1 };

            effectReference1.Append(schemeColor4);

            D.FontReference fontReference1 = new D.FontReference() { Index = D.FontCollectionIndexValues.Minor };
            D.SchemeColor schemeColor5 = new D.SchemeColor() { Val = D.SchemeColorValues.Light1 };

            fontReference1.Append(schemeColor5);

            shapeStyle1.Append(lineReference1);
            shapeStyle1.Append(fillReference1);
            shapeStyle1.Append(effectReference1);
            shapeStyle1.Append(fontReference1);
            return shapeStyle1;

        }



        static private TextBody makeTextBody()
        {
            TextBody textBody1 = new TextBody();
            D.BodyProperties bodyProperties1 = new D.BodyProperties() { RightToLeftColumns = false, Anchor = D.TextAnchoringTypeValues.Center };
            D.ListStyle listStyle1 = new D.ListStyle();

            D.Paragraph paragraph1 = new D.Paragraph();
            D.ParagraphProperties paragraphProperties1 = new D.ParagraphProperties() { Alignment = D.TextAlignmentTypeValues.Center };
            D.EndParagraphRunProperties endParagraphRunProperties1 = new D.EndParagraphRunProperties() { Language = "es-ES" };

            paragraph1.Append(paragraphProperties1);
            paragraph1.Append(endParagraphRunProperties1);

            textBody1.Append(bodyProperties1);
            textBody1.Append(listStyle1);
            textBody1.Append(paragraph1);
            return textBody1;
        }


        static private NonVisualShapeProperties makeNonVisualShapeProperties()
        {
            NonVisualShapeProperties nonVisualShapeProperties1 = new NonVisualShapeProperties();
            NonVisualDrawingProperties nonVisualDrawingProperties1 = new NonVisualDrawingProperties() { Id = (UInt32Value)4U, Name = "1 Shape Name" };
            NonVisualShapeDrawingProperties nonVisualShapeDrawingProperties1 = new NonVisualShapeDrawingProperties();
            ApplicationNonVisualDrawingProperties applicationNonVisualDrawingProperties1 = new ApplicationNonVisualDrawingProperties();

            nonVisualShapeProperties1.Append(nonVisualDrawingProperties1);
            nonVisualShapeProperties1.Append(nonVisualShapeDrawingProperties1);
            nonVisualShapeProperties1.Append(applicationNonVisualDrawingProperties1);
            return nonVisualShapeProperties1;
        }

</code></pre></div></div>

<h2>
<span id="図形の生成例" class="fragment"></span><a href="#%E5%9B%B3%E5%BD%A2%E3%81%AE%E7%94%9F%E6%88%90%E4%BE%8B"><i class="fa fa-link"></i></a>図形の生成例</h2>

<p>generateShapes()の中で以降を呼び出せば、該当の図形が生成できます。</p>

<h3>
<span id="線" class="fragment"></span><a href="#%E7%B7%9A"><i class="fa fa-link"></i></a>線</h3>

<p>(x1,y1)から(x2,y2)への波線矢印</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="nf">AddShape_</span><span class="p">(</span>
    <span class="n">ppShapeTree</span><span class="p">,</span>
    <span class="n">D</span><span class="p">.</span><span class="n">ShapeTypeValues</span><span class="p">.</span><span class="n">Line</span><span class="p">,</span>
    <span class="n">outlineSchemeColor</span><span class="p">:</span> <span class="n">D</span><span class="p">.</span><span class="n">SchemeColorValues</span><span class="p">.</span><span class="n">Text1</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x1</span><span class="p">),</span>
    <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">y1</span><span class="p">),</span>
    <span class="n">width</span><span class="p">:</span> <span class="p">(</span><span class="n">x2</span> <span class="p">-</span> <span class="n">x1</span><span class="p">),</span>
    <span class="n">height</span><span class="p">:</span> <span class="p">(</span><span class="n">y2</span> <span class="p">-</span> <span class="n">y1</span><span class="p">),</span>
    <span class="n">isdashline</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
    <span class="n">isTailEndArrow</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
    <span class="n">isHeadEndArrow</span><span class="p">:</span> <span class="k">false</span>
    <span class="p">);</span>
</code></pre></div></div>

<h3>
<span id="四角形" class="fragment"></span><a href="#%E5%9B%9B%E8%A7%92%E5%BD%A2"><i class="fa fa-link"></i></a>四角形</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="nf">AddShape_</span><span class="p">(</span>
    <span class="n">ppShapeTree</span><span class="p">,</span>
    <span class="n">D</span><span class="p">.</span><span class="n">ShapeTypeValues</span><span class="p">.</span><span class="n">Rectangle</span><span class="p">,</span> 
    <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">),</span>
    <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">y</span><span class="p">),</span>
    <span class="n">width</span><span class="p">:</span> <span class="p">(</span><span class="n">w</span><span class="p">),</span>
    <span class="n">height</span><span class="p">:</span> <span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="p">);</span>
</code></pre></div></div>

<h3>
<span id="回転反転する" class="fragment"></span><a href="#%E5%9B%9E%E8%BB%A2%E5%8F%8D%E8%BB%A2%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>回転、反転する</h3>

<p>AddShape_のhorizontalFlipにtrueを渡せば水平方向に反転。<br>
angleに角度を渡せば回転。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FJVoltex%2Fitems%2F6b7232dc2757c904dde0&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FJVoltex%2Fitems%2F6b7232dc2757c904dde0&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/JVoltex/items/6b7232dc2757c904dde0/likers" class="css-1iupg5d">8</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">11</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6b7232dc2757c904dde0/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/JVoltex/items/6b7232dc2757c904dde0/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/JVoltex/items/6b7232dc2757c904dde0/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/JVoltex/items/6b7232dc2757c904dde0/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/JVoltex/items/6b7232dc2757c904dde0.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-db1f9386-fa49-4d91-92ae-65d4bb111a31">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-674f28e1-2e6a-4bbe-a2e6-e470f643f037"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-674f28e1-2e6a-4bbe-a2e6-e470f643f037">{}</script>
      
<div id="LoginModal-react-component-36ea4adf-c090-4803-b28b-88efbf799c71"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-36ea4adf-c090-4803-b28b-88efbf799c71">{}</script>
      
<div id="StockModal-react-component-eefbc793-2fae-4895-ad16-9b9c826d6901"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-eefbc793-2fae-4895-ad16-9b9c826d6901">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;iPygJr8hhvBP8JRlWjG6oOO2j55XkHcSW56R1qT7AKUhO2CJP7eGUe2ELSWZ5W0821ZNv1AVLl2Vz9QkkW4pMg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eプログラムからPowerPointの図形追加をする際、日本語の簡易なコードサンプルが見つけられず時間を奪われたので、誰かが同じ苦労をしないようにコードサンプルを載せます。使用言語はC#です。Visual Studio 2015を使います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"powerpointのファイル形式openxml\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#powerpoint%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%BD%A2%E5%BC%8Fopenxml\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePowerPointのファイル形式：OpenXML\u003c/h1\u003e\n\n\u003cp\u003eC#からのOfficeのファイル操作には、\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/office/bb448854.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eOpenXML SDK\u003c/a\u003eを利用できます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"openxml\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#openxml\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eOpenXML\u003c/h3\u003e\n\n\u003cp\u003eOffice 2007以降のPowerPointファイルは、\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/office/gg278325.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eOpenXML\u003c/a\u003eという仕様に準拠しています。OpenXMLの中でもPowerPointファイルを構成する言語を\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/office/gg278318.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePresentationML\u003c/a\u003eと言います。実体はいくつかのXMLファイル（と、画像などのファイル）をzip圧縮したものです。試しにpptxファイルをzip解凍すると、アプリケーションが対象とするオブジェクト（例えばPowerPointのスライドマスター）に対応したXMLファイルを確認することができます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"openxml-sdk\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#openxml-sdk\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eOpenXML SDK\u003c/h3\u003e\n\n\u003cp\u003eOpenXML SDKは、OpenXML形式のファイルの読み書きを支援するライブラリです。\u003c/p\u003e\n\n\u003cp\u003eOpenXML SDKでは、XMLの各要素に対応したクラスがあり、要素の属性に対応したプロパティがあります。\u003cbr\u003e\n例えばPowerPointでは、スライドを表すSlideクラス、図形を表すShapeクラス、図形の外線を表すOutlineがあり、線幅を表すOutlineのメンバ変数であるWidthがあります。\u003c/p\u003e\n\n\u003cp\u003eまた、Microsoft の\u003ca href=\"https://www.microsoft.com/en-us/download/details.aspx?id=30425\" rel=\"nofollow noopener\" target=\"_blank\"\u003eダウンロード センター\u003c/a\u003eでは、OpenXMLSDKToolV25.msiというツールがあります。\u003cbr\u003e\nOpenXMLの構造をグラフィカルに表示できるだけでなく、XMLの不正な点を検出したり（Validate）、2 つの OpenXML ファイルを比較（Compare Files）したりできるようです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"準備openxml-sdkパッケージのインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%BA%96%E5%82%99openxml-sdk%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e準備：OpenXML SDKパッケージのインストール\u003c/h1\u003e\n\n\u003cp\u003e準備として、\u003ca href=\"https://www.nuget.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eNuget\u003c/a\u003eで\u003ca href=\"https://github.com/OfficeDev/Open-XML-SDK\" rel=\"nofollow noopener\" target=\"_blank\"\u003eOpenXML SDKのパッケージ\u003c/a\u003eをインストールします。デフォルトのパッケージソースであるnuget.orgからは得られないので、まずパッケージソースの設定を行います。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"パッケージソースの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパッケージソースの設定\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/OfficeDev/Open-XML-SDK\" rel=\"nofollow noopener\" target=\"_blank\"\u003eOpenXML SDKのパッケージ\u003c/a\u003eに行って、Table 1: The latest builds are available via a MyGet feedからパッケージソースのFeed URLを得ます。Nuget V3であれば\u003ca href=\"https://dotnet.myget.org/F/open-xml-sdk/api/v3/index.json\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://dotnet.myget.org/F/open-xml-sdk/api/v3/index.json\u003c/a\u003e になります。\u003c/p\u003e\n\n\u003cp\u003e次の手順でパッケージソースをVisual Studio Nugetパッケージマネージャーの設定に追加します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eVisual Studio のツール -\u0026gt; Nugetパッケージマネージャー -\u0026gt; パッケージマネージャー設定 をクリックしてオプションを開く\u003c/li\u003e\n\u003cli\u003eNugetパッケージマネージャー/パッケージソースの項目を開き、利用可能なパッケージソースに項目を追加\u003c/li\u003e\n\u003cli\u003e適当な名前（ここではdotnetopenxml）をつけ、ソースに先ほどのURLを記入して更新。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e参考：\u003ca href=\"https://ufcpp.wordpress.com/2015/04/12/myget-%E3%81%8B%E3%82%89%E3%81%AE%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8F%96%E5%BE%97/\" rel=\"nofollow noopener\" target=\"_blank\"\u003emygetからのパッケージ取得\u003c/a\u003e、\u003ca href=\"https://github.com/OfficeDev/Open-XML-SDK\" rel=\"nofollow noopener\" target=\"_blank\"\u003egithub.com/OfficeDev/Open-XML-SDK\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"openxml-sdkパッケージのインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#openxml-sdk%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eOpenXML SDKパッケージのインストール\u003c/h3\u003e\n\n\u003cp\u003eソリューションのNugetパッケージマネージャーを開いて、パッケージソースを先ほど加えたもの（dotnetopenxml）に変更すると、DocumentFormat.OpenXMLというパッケージが検出されます。それをインストールします。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コードサンプル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコードサンプル\u003c/h1\u003e\n\n\u003cp\u003eここからコードサンプルです。\u003cbr\u003e\nすでにスライドが生成されたpptxファイル（hoge.pptx）が用意されているものとします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"shapetreeオブジェクトの取得\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#shapetree%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E5%8F%96%E5%BE%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eShapeTreeオブジェクトの取得\u003c/h2\u003e\n\n\u003cp\u003e図形を加えたり、望みの図形を得るためには、まずhoge.pptxの適当なスライドから、図形をまとめて管理するオブジェクトである\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/documentformat.openxml.presentation.shapetree(v=office.14).aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eShapeTree\u003c/a\u003eを取得します。この辺りのちゃんとした説明は\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/office/cc850847.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003e[方法] プレゼンテーション内の図形の塗りつぶしの色を変更する (Open XML SDK)\u003c/a\u003eが詳しいです。\u003c/p\u003e\n\n\u003cp\u003eでは、コードの全体像を示します。流れは次のようになります。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ePresentationDocument.Openを使って、ファイル名fileNameからPresentationDocumentを取得\u003c/li\u003e\n\u003cli\u003e最初のスライドのスライド番号（relId）を取得\u003c/li\u003e\n\u003cli\u003erelIdが示すスライドのShapeTreeを取得（ppshapeTree）\u003c/li\u003e\n\u003cli\u003egenerateShapes()（後述）でppshapeTreeに図形を追加\u003c/li\u003e\n\u003cli\u003e変更の保存をして終わり\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDocumentFormat.OpenXml.Presentation\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDocumentFormat.OpenXml.Packaging\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDocumentFormat.OpenXml\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eD\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDocumentFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOpenXml\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDrawing\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eProgram\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eShapeTree\u003c/span\u003e \u003cspan class=\"n\"\u003eppshapeTree\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"hoge.pptx\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ePresentationDocument\u003c/span\u003e \u003cspan class=\"n\"\u003eppt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eppt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ePresentationDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\\\"\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\\" has opened.\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// Get the relationship ID of the first slide.\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePresentationPart\u003c/span\u003e \u003cspan class=\"n\"\u003epart\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eppt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePresentationPart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eOpenXmlElementList\u003c/span\u003e \u003cspan class=\"n\"\u003eslideIds\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epart\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePresentation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSlideIdList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eChildElements\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003erelId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eslideIds\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eSlideId\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eRelationshipId\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// Get the slide part from the relationship ID.\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSlidePart\u003c/span\u003e \u003cspan class=\"n\"\u003eppslide\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSlidePart\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003epart\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetPartById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erelId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eppslide\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eppshapeTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eppslide\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSlide\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCommonSlideData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eShapeTree\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003egenerateShapes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eppshapeTree\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003eppslide\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSlide\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\\\"\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\\" has been changed.\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e   \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"図形を生成してスライドに加えるメソッドの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9B%B3%E5%BD%A2%E3%82%92%E7%94%9F%E6%88%90%E3%81%97%E3%81%A6%E3%82%B9%E3%83%A9%E3%82%A4%E3%83%89%E3%81%AB%E5%8A%A0%E3%81%88%E3%82%8B%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e図形を生成してスライドに加えるメソッドの作成\u003c/h2\u003e\n\n\u003cp\u003egenerateShapes()の中で使用する汎用的な図形生成メソッドを作成していきます。\u003cbr\u003e\n名前はAddShape_()とします。\u003c/p\u003e\n\n\u003cp\u003eオブジェクトの追加は、そのオブジェクトの親のAppendメソッドによって追加していきます。図形の追加であれば、Shapeインスタンスを生成して、ppshapeTreeに対してAppendすればいいということになります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"shapeインスタンスの生成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#shape%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eShapeインスタンスの生成\u003c/h3\u003e\n\n\u003cp\u003eShapeインスタンスを追加したい図形オブジェクトになるようにするには、そのメンバ変数で指定すればいいというわけではなく、特徴を表すインスタンスをAppendしていきます。\u003c/p\u003e\n\n\u003cp\u003eShapeインスタンスには、次の4つのクラスのインスタンスをAppendする必要があります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNonVisualShapeProperties\u003c/li\u003e\n\u003cli\u003eShapeProperties\u003c/li\u003e\n\u003cli\u003eShapeStyle\u003c/li\u003e\n\u003cli\u003eTextBody\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eしたがって、AddShape_メソッドは次の手順で書かれています。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eShapeインスタンスshape1を生成\u003c/li\u003e\n\u003cli\u003eNonVisualShapePropertiesを生成してshape1にAppend\u003c/li\u003e\n\u003cli\u003eShapePropertiesに引数を渡して生成してshape1にAppend\u003c/li\u003e\n\u003cli\u003eShapeStyleを生成してshape1にAppend\u003c/li\u003e\n\u003cli\u003eTextBodyを生成してshape1にAppend\u003c/li\u003e\n\u003cli\u003eshape1を引数ShapeTree ppshapeTreeにAppend\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eShapeインスタンスにAppendするインスタンスはmakeProperties（後述）をはじめとしたメソッドの中で作成しています。\u003cbr\u003e\nこれらのインスタンスにもまた、その子オブジェクトのインスタンスをAppendしていく必要があります。\u003cbr\u003e\n足らないとファイルが開けなかったり、PowerPointを開いたときに正しく図形が表示できなかったりします。\u003c/p\u003e\n\n\u003cp\u003eShapeインスタンスを追加したい図形オブジェクトになるようにするには、ShapePropertiesインスタンス以下を指定していきます。だから、AddShape_メソッドのppshapeTree以外の引数はmakeShapeProperties()に渡しています。makeShapeProperties()だけが関心事なので、以降でmakeShapeProperties()とそれ以外は分けて表示します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAddShape\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecm2shapescale\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e360000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003edegree2shapescale\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e60000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddShape_\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eShapeTree\u003c/span\u003e \u003cspan class=\"n\"\u003eppshapeTree\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eShapeTypeValues\u003c/span\u003e \u003cspan class=\"n\"\u003eshapeType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eShapeTypeValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRectangle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"c1\"\u003e// Any of the built-in shapes (ellipse, rectangle, etc)\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efill_rgbColorHex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"EEECE1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Hexadecimal RGB color code to fill the shape.\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisnooutline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSchemeColorValues\u003c/span\u003e \u003cspan class=\"n\"\u003eoutlineSchemeColor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSchemeColorValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Represents the shape x position in 1 cm.\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Represents the shape y position in 2 cm.\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Shapw width in in 2 cm.\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Shapw height in in 2 cm.\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003ehorizontalFlip\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003everticalFlip\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eangle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//degree\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisdashline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisTailEndArrow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisHeadEndArrow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eShape\u003c/span\u003e \u003cspan class=\"n\"\u003eshape1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eShape\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eshape1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003emakeNonVisualShapeProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eshape1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003emakeShapeProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eshapeType\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eshapeType\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efill_rgbColorHex\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efill_rgbColorHex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eisnooutline\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eisnooutline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eoutlineSchemeColor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eoutlineSchemeColor\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nf\"\u003egetcm2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nf\"\u003egetcm2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nf\"\u003egetcm2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nf\"\u003egetcm2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ehorizontalFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003ehorizontalFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003everticalFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003everticalFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eangle\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nf\"\u003egetDegree2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eangle\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eisdashline\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eisdashline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eisTailEndArrow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eisTailEndArrow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eisHeadEndArrow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eisHeadEndArrow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eshape1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003emakeShapeStyle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eshape1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003emakeTextBody\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eppshapeTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eshape1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"nf\"\u003egetcm2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ecm_val\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ecm_val\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ecm2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003egetDegree2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eangle\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eangle\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edegree2shapescale\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eAddShape_メソッドの引数は次のようなことを表現します。\u003cbr\u003e\n\u003c/p\u003e\u003cdl\u003e\n\u003cbr\u003e\n\u003cdt\u003e\n\u003cbr\u003e\nshapeType\u003cbr\u003e\n\u003cdt\u003e\n\u003cbr\u003e\n\u003c/dt\u003e\n\u003c/dt\u003e\n\u003cdd\u003e\n\u003cbr\u003e\n図の外形になります。線（Line）にしたり四角形（Rectangle）にしたりできます。\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/documentformat.openxml.drawing.shapetypevalues(v=office.14).aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eShapeTypeValues\u003c/a\u003eに指定できる図の種類が示されています。\u003cbr\u003e\n\u003cdd\u003e\n\u003cbr\u003e\n\u003c/dd\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\n\u003cbr\u003e\nfill_rgbColorHex\u003cbr\u003e\n\u003cdt\u003e\n\u003cbr\u003e\n\u003c/dt\u003e\n\u003c/dt\u003e\n\u003cdd\u003e\n\u003cbr\u003e\n図形の塗りつぶしの色になります。16進数RGBカラーコードを入力します。\u003cbr\u003e\n\u003cdd\u003e\n\u003cbr\u003e\n\u003c/dd\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\n\u003cbr\u003e\noutlineSchemeColor\u003cbr\u003e\n\u003cdt\u003e\n\u003cbr\u003e\n\u003c/dt\u003e\n\u003c/dt\u003e\n\u003cdd\u003e\n\u003cbr\u003e\n図形の外線の線種・線色になります。\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/documentformat.openxml.drawing.schemecolorvalues(v=office.14).aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSchemeColorValues\u003c/a\u003eに指定できる値が示されています。\u003cbr\u003e\n\u003cdd\u003e\n\u003cbr\u003e\n\u003c/dd\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\n\u003cbr\u003e\nxとy\u003cbr\u003e\n\u003cdt\u003e\n\u003cbr\u003e\n\u003c/dt\u003e\n\u003c/dt\u003e\n\u003cdd\u003e\n\u003cbr\u003e\nそれぞれ横方向、縦方向の座標を表します。PowerPointスライドの左上が(x=0, y=0)です。cm単位です。\u003cbr\u003e\n\u003cdd\u003e\n\u003cbr\u003e\n\u003c/dd\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\n\u003cp\u003eあとはだいたいわかると思います。getcm2shapescale()やgetDegree2shapescale()でShapeProperties以下での座標や角度のスケールに変換してからmakeShapePropertiesに値を渡します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"shapepropertiesインスタンスの生成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#shapeproperties%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eShapePropertiesインスタンスの生成\u003c/h3\u003e\n\n\u003cp\u003emakeShapeProperties()では、引数を該当のインスタンスのメンバ変数に代入していきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"charp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003estatic private ShapeProperties makeShapeProperties(\n            D.ShapeTypeValues shapeType = D.ShapeTypeValues.Rectangle,// Any of the built-in shapes (ellipse, rectangle, etc)\n            string fill_rgbColorHex = \"EEECE1\", // Hexadecimal RGB color code to fill the shape.\n            bool isnooutline = false,  //no outline\n            D.SchemeColorValues outlineSchemeColor = D.SchemeColorValues.Text1,\n            long x = 360000, // Represents the shape x position in 1/36000 cm.\n            long y = 720000, // Represents the shape y position in 1/36000 cm.\n            long width = 720000, // Shapw width in in 1/36000 cm.\n            long height = 720000, // Shapw height in in 1/36000 cm.\n            bool horizontalFlip = false,\n            bool verticalFlip = false,\n            int angle = 0,  //2700000 * 4 = 180 degree\n            bool isdashline = false,\n            bool isTailEndArrow = false,\n            bool isHeadEndArrow = false\n            )\n        {\n            ShapeProperties shapeProperties1 = new ShapeProperties();\n\n            D.Transform2D transform2D1 = new D.Transform2D();\n            D.Offset offset1 = new D.Offset() { X = x, Y = y };\n            D.Extents extents1 = new D.Extents() { Cx = width, Cy = height };\n\n            transform2D1.HorizontalFlip = horizontalFlip;\n            transform2D1.VerticalFlip = verticalFlip;\n            transform2D1.Rotation = angle;\n\n            transform2D1.Append(offset1);\n            transform2D1.Append(extents1);\n\n            D.PresetGeometry presetGeometry1 = new D.PresetGeometry() { Preset = shapeType };\n            D.AdjustValueList adjustValueList1 = new D.AdjustValueList();\n\n            presetGeometry1.Append(adjustValueList1);\n\n            D.SolidFill solidFill1 = new D.SolidFill();\n            D.RgbColorModelHex rgbColorModelHex1 = new D.RgbColorModelHex() { Val = fill_rgbColorHex };\n\n            solidFill1.Append(rgbColorModelHex1);\n\n            D.Outline outline1 = new D.Outline() { Width = 12700 };\n            if (isnooutline)\n            {\n                D.NoFill nofill = new D.NoFill();\n                outline1.Append(nofill);\n            }\n            else\n            {\n                D.SolidFill solidFill2 = new D.SolidFill();\n                D.SchemeColor schemeColor1 = new D.SchemeColor() { Val = outlineSchemeColor };\n                solidFill2.Append(schemeColor1);\n                outline1.Append(solidFill2);\n\n                //dash\n                if (isdashline)\n                {\n                    D.PresetDash presetDash = new D.PresetDash() { Val = D.PresetLineDashValues.Dash };\n                    outline1.Append(presetDash);\n                }\n\n                //arrow\n                if (isTailEndArrow)\n                {\n                    D.TailEnd tailend = new D.TailEnd() { Type = D.LineEndValues.Arrow };\n                    outline1.Append(tailend);\n                }\n                if (isHeadEndArrow)\n                {\n                    D.HeadEnd headend = new D.HeadEnd() { Type = D.LineEndValues.Arrow };\n                    outline1.Append(headend);\n                }\n            }\n\n            shapeProperties1.Append(transform2D1);\n            shapeProperties1.Append(presetGeometry1);\n            shapeProperties1.Append(solidFill1);\n            shapeProperties1.Append(outline1);\n            return shapeProperties1;\n        }\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"その他のインスタンスの生成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその他のインスタンスの生成\u003c/h3\u003e\n\n\u003cp\u003eおまじないを書きます。\u003ca href=\"http://stackoverflow.com/questions/18810001/how-to-insert-a-shape-in-a-powerpoint-slide\" rel=\"nofollow noopener\" target=\"_blank\"\u003eここ\u003c/a\u003eを参考にしました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"charp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        static private ShapeStyle makeShapeStyle()\n        {\n            ShapeStyle shapeStyle1 = new ShapeStyle();\n\n            D.LineReference lineReference1 = new D.LineReference() { Index = (UInt32Value)2U };\n\n            D.SchemeColor schemeColor2 = new D.SchemeColor() { Val = D.SchemeColorValues.Accent1 };\n            D.Shade shade1 = new D.Shade() { Val = 50000 };\n\n            schemeColor2.Append(shade1);\n\n            lineReference1.Append(schemeColor2);\n\n            D.FillReference fillReference1 = new D.FillReference() { Index = (UInt32Value)1U };\n            D.SchemeColor schemeColor3 = new D.SchemeColor() { Val = D.SchemeColorValues.Accent1 };\n\n            fillReference1.Append(schemeColor3);\n\n            D.EffectReference effectReference1 = new D.EffectReference() { Index = (UInt32Value)0U };\n            D.SchemeColor schemeColor4 = new D.SchemeColor() { Val = D.SchemeColorValues.Accent1 };\n\n            effectReference1.Append(schemeColor4);\n\n            D.FontReference fontReference1 = new D.FontReference() { Index = D.FontCollectionIndexValues.Minor };\n            D.SchemeColor schemeColor5 = new D.SchemeColor() { Val = D.SchemeColorValues.Light1 };\n\n            fontReference1.Append(schemeColor5);\n\n            shapeStyle1.Append(lineReference1);\n            shapeStyle1.Append(fillReference1);\n            shapeStyle1.Append(effectReference1);\n            shapeStyle1.Append(fontReference1);\n            return shapeStyle1;\n\n        }\n\n\n\n        static private TextBody makeTextBody()\n        {\n            TextBody textBody1 = new TextBody();\n            D.BodyProperties bodyProperties1 = new D.BodyProperties() { RightToLeftColumns = false, Anchor = D.TextAnchoringTypeValues.Center };\n            D.ListStyle listStyle1 = new D.ListStyle();\n\n            D.Paragraph paragraph1 = new D.Paragraph();\n            D.ParagraphProperties paragraphProperties1 = new D.ParagraphProperties() { Alignment = D.TextAlignmentTypeValues.Center };\n            D.EndParagraphRunProperties endParagraphRunProperties1 = new D.EndParagraphRunProperties() { Language = \"es-ES\" };\n\n            paragraph1.Append(paragraphProperties1);\n            paragraph1.Append(endParagraphRunProperties1);\n\n            textBody1.Append(bodyProperties1);\n            textBody1.Append(listStyle1);\n            textBody1.Append(paragraph1);\n            return textBody1;\n        }\n\n\n        static private NonVisualShapeProperties makeNonVisualShapeProperties()\n        {\n            NonVisualShapeProperties nonVisualShapeProperties1 = new NonVisualShapeProperties();\n            NonVisualDrawingProperties nonVisualDrawingProperties1 = new NonVisualDrawingProperties() { Id = (UInt32Value)4U, Name = \"1 Shape Name\" };\n            NonVisualShapeDrawingProperties nonVisualShapeDrawingProperties1 = new NonVisualShapeDrawingProperties();\n            ApplicationNonVisualDrawingProperties applicationNonVisualDrawingProperties1 = new ApplicationNonVisualDrawingProperties();\n\n            nonVisualShapeProperties1.Append(nonVisualDrawingProperties1);\n            nonVisualShapeProperties1.Append(nonVisualShapeDrawingProperties1);\n            nonVisualShapeProperties1.Append(applicationNonVisualDrawingProperties1);\n            return nonVisualShapeProperties1;\n        }\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"図形の生成例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9B%B3%E5%BD%A2%E3%81%AE%E7%94%9F%E6%88%90%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e図形の生成例\u003c/h2\u003e\n\n\u003cp\u003egenerateShapes()の中で以降を呼び出せば、該当の図形が生成できます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"線\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B7%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e線\u003c/h3\u003e\n\n\u003cp\u003e(x1,y1)から(x2,y2)への波線矢印\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"nf\"\u003eAddShape_\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eppShapeTree\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eShapeTypeValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLine\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eoutlineSchemeColor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSchemeColorValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex2\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ex1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey2\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ey1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eisdashline\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eisTailEndArrow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eisHeadEndArrow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"四角形\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9B%9B%E8%A7%92%E5%BD%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e四角形\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003eAddShape_\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eppShapeTree\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eShapeTypeValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRectangle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ew\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"回転反転する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9B%9E%E8%BB%A2%E5%8F%8D%E8%BB%A2%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e回転、反転する\u003c/h3\u003e\n\n\u003cp\u003eAddShape_のhorizontalFlipにtrueを渡せば水平方向に反転。\u003cbr\u003e\nangleに角度を渡せば回転。\u003c/p\u003e\n","createdAt":"2017-02-04T06:38:44Z","elapsedYearsFromLastModifiedAt":4,"encryptedId":"1E6lyqcEJtMk9tiG77b8NmDXg+V5UPOt--u2T6tT5rqicKOjm/--6Mx8JiGqEt+yd172eBJFrQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2017-02-04T22:08:13Z","likesCount":8,"linkUrl":"https://qiita.com/JVoltex/items/6b7232dc2757c904dde0","organization":null,"originalId":465742,"stockedCount":11,"title":"C#によるPowerPoint図形操作のサンプル","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#powerpoint%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%BD%A2%E5%BC%8Fopenxml\"\u003ePowerPointのファイル形式：OpenXML\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#openxml\"\u003eOpenXML\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#openxml-sdk\"\u003eOpenXML SDK\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cli\u003e\n\u003ca href=\"#%E6%BA%96%E5%82%99openxml-sdk%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e準備：OpenXML SDKパッケージのインストール\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eパッケージソースの設定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#openxml-sdk%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003eOpenXML SDKパッケージのインストール\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB\"\u003eコードサンプル\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#shapetree%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E5%8F%96%E5%BE%97\"\u003eShapeTreeオブジェクトの取得\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9B%B3%E5%BD%A2%E3%82%92%E7%94%9F%E6%88%90%E3%81%97%E3%81%A6%E3%82%B9%E3%83%A9%E3%82%A4%E3%83%89%E3%81%AB%E5%8A%A0%E3%81%88%E3%82%8B%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e図形を生成してスライドに加えるメソッドの作成\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#shape%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90\"\u003eShapeインスタンスの生成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#shapeproperties%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90\"\u003eShapePropertiesインスタンスの生成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E7%94%9F%E6%88%90\"\u003eその他のインスタンスの生成\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9B%B3%E5%BD%A2%E3%81%AE%E7%94%9F%E6%88%90%E4%BE%8B\"\u003e図形の生成例\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B7%9A\"\u003e線\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9B%9B%E8%A7%92%E5%BD%A2\"\u003e四角形\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9B%9E%E8%BB%A2%E5%8F%8D%E8%BB%A2%E3%81%99%E3%82%8B\"\u003e回転、反転する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n","totalPv":7480,"uuid":"6b7232dc2757c904dde0","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"7qda0gUEB/HvHeNQAsiezXVB/2q7--ovppVGDaLFRMrLx5--oF/6RlEaWlZ1ioZMa6BUJw==","originalId":125749,"description":"","facebookUrl":null,"githubUrl":"https://github.com/JVoltex","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"U J","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/125749/profile-images/1486211730","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F125749%2Fprofile-images%2F1486211730?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=9856748e674a62fde434a97addd19824","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F125749%2Fprofile-images%2F1486211730?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e04464f8172aa27f8a311d8f4fdeb8fe","urlName":"JVoltex","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"PowerPoint","urlName":"powerpoint"},{"name":"プレゼンテーション","urlName":"%e3%83%97%e3%83%ac%e3%82%bc%e3%83%b3%e3%83%86%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3"},{"name":"OpenXML","urlName":"openxml"},{"name":"図形","urlName":"%e5%9b%b3%e5%bd%a2"}],"followingLikers":{"edges":[]},"comments":{"totalCount":1}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
