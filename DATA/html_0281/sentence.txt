どうも、ろっさむです。
今回は下手したら使いどころを誤りそうな varについて、今後の自分のためにも改めて調査し、まとめていこうと思います。みんな大好き「型推論」を行う際に使用するキーワードがvarです。これはC#3.0から追加された機能です。コンパイラから見て、初期化値から変数の型がわかる場合にはvarを用いて、コンパイル時にコンパイラに型を推測させることができます。このようなローカル変数を「暗黙的型指定ローカル変数」といいます。ListやDictionary等のような初期化で二回書くのが面倒臭い冗長なコードに対して、varは効果を発揮します。そんな便利なvarですが使いどころを誤ると可読性が損なわれかねません。varキーワードはMicrosoftではコンストラクタ内で使用することを推奨しています。これは単にコンストラクタ内で初期化を行うのが一般的だからでしょう。上記の、メソッドからの返り値を格納するためのローカル変数にvarを使うのはMicrosoftのコーディング規約ではNGとなっています。ただ、チームで使用しているIDEが決まっている（例えばVisual Studio, Riderなど）場合は、そのIDEがvar変数の型を適宜表示してくれる機能があるので、優先すべきはチームでのコーディング規約かと思います。こちらはC#9.0以降の新しい機能となります。
詳しくはまた別の記事でまとめて紹介しようと思いますが、さらっと解説します。varは左辺の型を暗黙的に推論するために使用するキーワードでしたが、この「new式」は右辺に対して働きます。式の中の変数の型がわかっている場合には、初期化用の型の方を省略することができます。


