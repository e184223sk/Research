<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Xamarin.FormsでのFirebase利用が捗る５つのライブラリを作ってみた - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/f-miyu/items/1e8c519d58868a923aac" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="YQ2rRjVTSmGwRQR08NdG8B8yAse7cGaASZJOI1Fw0KuJwheKFqffc+aDcjI7AwCOS0jzu5E+7x833efnydmPHQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="Xamarin.FormsでのFirebase利用が捗る５つのライブラリを作ってみた - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XR0Z0WVhKcGJpNUdiM0p0Yy1PQnAtT0Jya1pwY21WaVlYTmw1WWlwNTVTbzQ0R001bzJYNDRLTDc3eVY0NEdrNDRHdTQ0T3A0NEtrNDRPVzQ0T3A0NE9xNDRLUzVMMmM0NEdqNDRHbTQ0R180NEdmJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPThkMTcxMjFkNmQ0NWE5NjU1MzQzMjZhMWQ2YzYwNzc3&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR1l0YldsNWRRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZmVlMzgxMmZhMGUzZTUwZTFkOTM3MTkzZTc2Yjk1MjQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=594f09b412246a7bee20b40dbbe3092a"><meta property="og:description" content="この記事は、Xamarin Advent Calendar 2018の５日目です。

Firebaseすごく便利です。データベース、ストレージ、認証などなど、バックエンドで必要な機能が簡単に使えてしまいます。Xamarinでもライブラ..."><meta content="https://qiita.com/f-miyu/items/1e8c519d58868a923aac" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Xamarin,Xamarin.Forms,Firebase" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-dd776c18-04f7-4f21-88e1-c5e3a815103e"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Ff-miyu%2Fitems%2F1e8c519d58868a923aac">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Ff-miyu%2Fitems%2F1e8c519d58868a923aac">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-dd776c18-04f7-4f21-88e1-c5e3a815103e">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-12-04T22:30:48.000+09:00","dateModified":"2018-12-05T07:00:47.000+09:00","headline":"Xamarin.FormsでのFirebase利用が捗る５つのライブラリを作ってみた","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XR0Z0WVhKcGJpNUdiM0p0Yy1PQnAtT0Jya1pwY21WaVlYTmw1WWlwNTVTbzQ0R001bzJYNDRLTDc3eVY0NEdrNDRHdTQ0T3A0NEtrNDRPVzQ0T3A0NE9xNDRLUzVMMmM0NEdqNDRHbTQ0R180NEdmJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPThkMTcxMjFkNmQ0NWE5NjU1MzQzMjZhMWQ2YzYwNzc3\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR1l0YldsNWRRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZmVlMzgxMmZhMGUzZTUwZTFkOTM3MTkzZTc2Yjk1MjQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=594f09b412246a7bee20b40dbbe3092a","mainEntityOfPage":"https://qiita.com/f-miyu/items/1e8c519d58868a923aac","author":{"@type":"Person","address":"","email":null,"identifier":"f-miyu","name":"f-miyu","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars3.githubusercontent.com%2Fu%2F30921389%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=577180113908bb91b5e3130a00cdc1c3","url":"https://qiita.com/f-miyu","description":"","memberOf":[{"@type":"Organization","address":"東京都渋谷区広尾1丁目1番39号 恵比寿プライムスクエアタワー19F","legalName":"アステリア株式会社","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/fb6facb6513b92b6f116e61c2e5c0d9bc2b5f55f/original.jpg?1539673737","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/86cadb9936fa4faf01e75c0df408cc4aa7dab1b9/original.jpg?1554888558","identifier":"asteria","description":"データ連携ソフトのASTERIA Warp、コンテンツ管理システムのHandbook、モバイルアプリ作成サービスPlatio、AI/IoTのエッジウェアGravioなどを開発しています"}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"f-miyu","type":"items","id":"1e8c519d58868a923aac"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"f-miyu","type":"items","id":"1e8c519d58868a923aac"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"f-miyu","type":"items","id":"1e8c519d58868a923aac"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/f-miyu/items/1e8c519d58868a923aac","location":"/f-miyu/items/1e8c519d58868a923aac","scheme":"https","host":"qiita.com","port":null,"pathname":"/f-miyu/items/1e8c519d58868a923aac","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"Wx5e/BXoNPVS5XNmRCojnxxyo9f4mbCW9pkZLS4X+r2z0eIwNhyh5wQjBSCP/mXhSAhSq9LXOQmI1rDptr6lCw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-ab31fa6f-1394-4e8b-9f6a-b384114c58fc"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/f-miyu/items/1e8c519d58868a923aac/likers" class="css-1iupg5d">35</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">20</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/1e8c519d58868a923aac/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/f-miyu/items/1e8c519d58868a923aac/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/f-miyu/items/1e8c519d58868a923aac/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/f-miyu/items/1e8c519d58868a923aac/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/f-miyu/items/1e8c519d58868a923aac.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2018/xamarin" class="it-AdcalRibbon_title">Xamarin<!-- --> Advent Calendar<!-- --> <!-- -->2018</a>Day 5</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/f-miyu"><img class="css-100alwu eyfquo10" src="https://avatars3.githubusercontent.com/u/30921389?v=4" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/f-miyu" class="css-10ougpm">@<!-- -->f-miyu</a><div class="css-1ay9vb9"><span><meta content="2018-12-04T13:30:48Z"/><time dateTime="2018-12-04T22:00:47Z" class="css-m19uds">updated at 2018-12-04</time></span></div></div></div></div></div><h1 class="css-cgzq40">Xamarin.FormsでのFirebase利用が捗る５つのライブラリを作ってみた</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/xamarin" class="css-4czcte">Xamarin</a><a href="/tags/xamarin.forms" class="css-4czcte">Xamarin.Forms</a><a href="/tags/firebase" class="css-4czcte">Firebase</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>この記事は、<a href="https://qiita.com/advent-calendar/2018/xamarin">Xamarin Advent Calendar 2018</a>の５日目です。</p>

<p>Firebaseすごく便利です。データベース、ストレージ、認証などなど、バックエンドで必要な機能が簡単に使えてしまいます。Xamarinでもライブラリが用意されており、利用することが可能です。ただ、そのライブラリというのが、iOS用とAndroid用に分かれており、Xamarin.Formsで使うには、DependencyServiceを使うなどしなければならず、ちょっと面倒でした。そこで、Xamarin.Formsでそのまま使えるようなライブラリを作成しました。</p>

<h1>
<span id="作成したライブラリ" class="fragment"></span><a href="#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA"><i class="fa fa-link"></i></a>作成したライブラリ</h1>

<p>Firebaseの５つの機能のライブラリを作成しました。NuGetで公開済みなのですぐに利用できます。<br>
使い方は、それぞれのGitHubをみてください。（詳しい機能の説明はしていないので、<a href="https://firebase.google.com/docs/" rel="nofollow noopener" target="_blank">公式のドキュメント</a>も参照してください）</p>

<p>NuGet</p>

<ul>
<li><a href="https://www.nuget.org/packages/Plugin.CloudFirestore/" rel="nofollow noopener" target="_blank">Plugin.CloudFirestore</a></li>
<li><a href="https://www.nuget.org/packages/Plugin.FirebaseAuth/" rel="nofollow noopener" target="_blank">Plugin.FirebaseAuth</a></li>
<li><a href="https://www.nuget.org/packages/Plugin.FirebaseStorage/" rel="nofollow noopener" target="_blank">Plugin.FirebaseStorage</a></li>
<li><a href="https://www.nuget.org/packages/Plugin.FirebaseAnalytics/" rel="nofollow noopener" target="_blank">Plugin.FirebaseAnalytics</a></li>
<li><a href="https://www.nuget.org/packages/Plugin.FirebaseCrashlytics/" rel="nofollow noopener" target="_blank">Plugin.FirebaseCrashlytics</a></li>
</ul>

<p>GitHub</p>

<ul>
<li><a href="https://github.com/f-miyu/Plugin.CloudFirestore" rel="nofollow noopener" target="_blank">f-miyu/Plugin.CloudFirestore</a></li>
<li><a href="https://github.com/f-miyu/Plugin.FirebaseAuth" rel="nofollow noopener" target="_blank">f-miyu/Plugin.FirebaseAuth</a></li>
<li><a href="https://github.com/f-miyu/Plugin.FirebaseStorage" rel="nofollow noopener" target="_blank">f-miyu/Plugin.FirebaseStorage</a></li>
<li><a href="https://github.com/f-miyu/Plugin.FirebaseAnalytics" rel="nofollow noopener" target="_blank">f-miyu/Plugin.FirebaseAnalytics</a></li>
<li><a href="https://github.com/f-miyu/Plugin.FirebaseCrashlytics" rel="nofollow noopener" target="_blank">f-miyu/Plugin.FirebaseCrashlytics</a></li>
</ul>

<h2>
<span id="plugincloudfirestore" class="fragment"></span><a href="#plugincloudfirestore"><i class="fa fa-link"></i></a>Plugin.CloudFirestore</h2>

<p><a href="https://firebase.google.com/docs/firestore/" rel="nofollow noopener" target="_blank">Cloud Firestore</a>を利用するためのライブラリです。<br>
データベースから取得した時のデータの型は、当然iOSとAndroidでは異なるので、共通の型にマッピングする機能を備えています。また、リアルタイムでのデータの更新は、Rxが利用できるようにしています。</p>

<h2>
<span id="pluginfirebaseauth" class="fragment"></span><a href="#pluginfirebaseauth"><i class="fa fa-link"></i></a>Plugin.FirebaseAuth</h2>

<p><a href="https://firebase.google.com/docs/auth/" rel="nofollow noopener" target="_blank">Authentication</a>を利用するためのライブラリです。<br>
Plugin.CloudFirestoreやPlugin.FirebaseStorageとは、セットで使うことになります。<br>
また、各プロバイダーへの認証の機能はないので、<a href="https://www.nuget.org/packages/Xamarin.Auth" rel="nofollow noopener" target="_blank">Xamarin.Auht</a>などを使ってください。</p>

<h2>
<span id="pluginfirebasestorage" class="fragment"></span><a href="#pluginfirebasestorage"><i class="fa fa-link"></i></a>Plugin.FirebaseStorage</h2>

<p><a href="https://firebase.google.com/docs/storage/" rel="nofollow noopener" target="_blank">Storage</a>を利用するためのライブラリです。<br>
進捗のモニタリングやキャンセル、一時停止にも対応しています。</p>

<h2>
<span id="pluginfirebaseanalytics" class="fragment"></span><a href="#pluginfirebaseanalytics"><i class="fa fa-link"></i></a>Plugin.FirebaseAnalytics</h2>

<p><a href="https://firebase.google.com/docs/analytics/" rel="nofollow noopener" target="_blank">アナリティクス</a>を利用するためのライブラリです。</p>

<h2>
<span id="pluginfirebasecrashlytics" class="fragment"></span><a href="#pluginfirebasecrashlytics"><i class="fa fa-link"></i></a>Plugin.FirebaseCrashlytics</h2>

<p><a href="https://firebase.google.com/docs/crashlytics" rel="nofollow noopener" target="_blank">Crashlytics</a>を利用するためのライブラリです。<br>
<a href="https://qiita.com/hypermild/items/206345ddb6cb0ad53806" id="reference-b3542cf28ba8bbaf95f3">昨日の記事</a>にも書かれてあるように、通常色々やらないといけないのをこれを入れるだけで大丈夫なようにもしています。</p>

<h1>
<span id="サンプルアプリ" class="fragment"></span><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA"><i class="fa fa-link"></i></a>サンプルアプリ</h1>

<p>これらのライブラリを利用したサンプルアプリも作成しました。画像を投稿して、リストに表示されて、いいねができる、ちょっとしたSNSアプリです。<br>
メールアドレスとGoogleでのログインができるようにしています。<br>
リストは、リアルタイム監視をしているので、誰かが投稿やいいねをすると自動で表示が更新されます。</p>

<p><a href="https://github.com/f-miyu/XamarinFirebaseSample" rel="nofollow noopener" target="_blank">f-miyu/XamarinFirebaseSample</a></p>

<p><a href="https://camo.qiitausercontent.com/4d2ff644196ed96698ac7898150f2c840b1abc15/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f33306266373736322d623032362d383261632d613434612d6466363961363563663664312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F30bf7762-b026-82ac-a44a-df69a65cf6d1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f9c6f5dee095ded66869216b1038bad7" alt="スクリーンショット 2018-12-04 21.30.15.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/30bf7762-b026-82ac-a44a-df69a65cf6d1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F30bf7762-b026-82ac-a44a-df69a65cf6d1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ebd42a033a262fb9b79dc016bf387f1e 1x" loading="lazy"></a> <a href="https://camo.qiitausercontent.com/63f66068e5869f1cf1105c4e8a9cf4cd2263f6a4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63393530633562612d653833352d633664312d333863362d6533613061343133333233352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc950c5ba-e835-c6d1-38c6-e3a0a4133235.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ddb19818f90b8eefad6ab807e5666297" alt="スクリーンショット 2018-12-04 21.32.23.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/c950c5ba-e835-c6d1-38c6-e3a0a4133235.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc950c5ba-e835-c6d1-38c6-e3a0a4133235.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6d9f4022984061feef68aa94d3a651d9 1x" loading="lazy"></a></p>

<h1>
<span id="サンプルアプリを動かすには" class="fragment"></span><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA%E3%82%92%E5%8B%95%E3%81%8B%E3%81%99%E3%81%AB%E3%81%AF"><i class="fa fa-link"></i></a>サンプルアプリを動かすには</h1>

<p>サンプルアプリのGitHubには、<code>GoogleService-Info.plist</code>や<code>google-services.json</code>を含めていないので、動かすには各自でFirebaseの設定を行なってください。<br>
以下で設定の仕方を説明します。</p>

<h2>
<span id="firebaseプロジェクトの作成" class="fragment"></span><a href="#firebase%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>Firebaseプロジェクトの作成</h2>

<p><a href="https://console.firebase.google.com" rel="nofollow noopener" target="_blank">Firebaseのコンソール</a>で、[プロジェクトの追加]をクリックします。<br>
プロジェクトの追加画面で、プロジェクト名を入力し、アナリティクスの地域を日本に設定、同意に<br>
チェックをして、[プロジェクトを作成]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/9f5aa6780590623494b890fb66f576ececd84288/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f33363166663031662d336534622d346232302d373035302d6131653138303135366464622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F361ff01f-3e4b-4b20-7050-a1e180156ddb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2141fa3a07a4a3db5fe6b09518dd7785" alt="スクリーンショット 2018-12-04 1.11.11.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/361ff01f-3e4b-4b20-7050-a1e180156ddb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F361ff01f-3e4b-4b20-7050-a1e180156ddb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5675e9f1de4d75e55c2c1c29728607c1 1x" loading="lazy"></a></p>

<p>トップの画面の、[iOS]ボタンをクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/c4f57022ea30ee47b34a132696dba5fa8825f8ce/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f66306361353232302d366433652d303832312d373265302d3863323836343238393364662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Ff0ca5220-6d3e-0821-72e0-8c28642893df.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=50297614d241ae6a8b36ff27faa46ded" alt="スクリーンショット 2018-11-26 2.17.28.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/f0ca5220-6d3e-0821-72e0-8c28642893df.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Ff0ca5220-6d3e-0821-72e0-8c28642893df.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9d72eade04a6c6a877679d21b31970a7 1x" loading="lazy"></a></p>

<p>iOSのバンドルIDを入力して、[アプリの登録]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/10ec84638e16a0d0f2eec8d2a09d947ea735ede3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f37353562653961372d653162372d613633612d616163652d6661366133643939386133642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F755be9a7-e1b7-a63a-aace-fa6a3d998a3d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=dd067daf9daf0865672a791914dfb36b" alt="スクリーンショット 2018-11-26 2.17.55.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/755be9a7-e1b7-a63a-aace-fa6a3d998a3d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F755be9a7-e1b7-a63a-aace-fa6a3d998a3d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c08e149ff3e3fe48d7e624be731f9f39 1x" loading="lazy"></a></p>

<p>[GoogleService-Info.plistをダウンロード]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/2636a7c35c417609036badc557095970717c0172/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f39326264626333662d323364372d306162652d626438332d3536353137643161333032322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F92bdbc3f-23d7-0abe-bd83-56517d1a3022.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7f109f6312afe03ad42648b0a42f0073" alt="スクリーンショット 2018-11-26 2.18.05.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/92bdbc3f-23d7-0abe-bd83-56517d1a3022.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F92bdbc3f-23d7-0abe-bd83-56517d1a3022.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bda621f559a2dcd27320e95eff431d30 1x" loading="lazy"></a></p>

<p>GoogleService-Info.plistがダウンロードできたら、XamarinFirebaseSample.iOSプロジェクトのルートに追加します。また、ビルドアクションが<code>BundleResource</code>になっていることを確認してください。</p>

<p><a href="https://camo.qiitausercontent.com/3c077d095c44b79ca6081846ca4f6f4b2320d88f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f32643861373562362d366433352d313265322d383835642d3930333238366239383731382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F2d8a75b6-6d35-12e2-885d-903286b98718.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5b7a619f40bccdbb4119fdf17ee67f8d" alt="スクリーンショット 2018-12-04 2.26.21.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/2d8a75b6-6d35-12e2-885d-903286b98718.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F2d8a75b6-6d35-12e2-885d-903286b98718.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=50de42bdd364872ab3ced3fd2fdff753 1x" loading="lazy"></a></p>

<p>次にAndroidの登録を行います。[アプリを追加]をクリックして、Androidを選択します。</p>

<p><a href="https://camo.qiitausercontent.com/60f5ef68716633eee03c5d9e67c48f6b376dee91/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f34363737303433632d343733652d346138652d343233612d6433346534643337666239612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F4677043c-473e-4a8e-423a-d34e4d37fb9a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1cb63ee26cc38c50479d6a2e99b25801" alt="スクリーンショット 2018-11-26 2.19.27.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/4677043c-473e-4a8e-423a-d34e4d37fb9a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F4677043c-473e-4a8e-423a-d34e4d37fb9a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3a1f99e718a196455e8e1160d24e25b6 1x" loading="lazy"></a></p>

<p>Androidのパッケージ名を入力します。また、サンプルアプリでは、Googleログインを行なっているので、SHA-1の入力も必要です。<br>
Xamarin.Androidで使用する、debug.keystoreのSHA-1フィンガープリントを取得するには、<a href="https://docs.microsoft.com/ja-jp/xamarin/android/deploy-test/signing/keystore-signature" rel="nofollow noopener" target="_blank">ここ</a>を参考にしてください。<br>
入力したら、[次へ]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/e772f8c9667ac8422102a3485dfa7a271a3ae18c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63646231636661652d373930362d323138622d393735622d3333626663396566633431332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fcdb1cfae-7906-218b-975b-33bfc9efc413.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=32958e1189bb25e213a22cd4450f6933" alt="スクリーンショット 2018-11-26 2.20.03.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/cdb1cfae-7906-218b-975b-33bfc9efc413.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fcdb1cfae-7906-218b-975b-33bfc9efc413.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=caaaadac1e1690cfbba53b75d84a9137 1x" loading="lazy"></a></p>

<p>[google-services.jsonをダウンロード]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/1a8e234dd1e18675e7505e06c9f464bc61b41850/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f39393137373530362d383262372d656463372d323634342d6361623930306238336533622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F99177506-82b7-edc7-2644-cab900b83e3b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6b5bd877aceda2b752e0d239fcd83544" alt="スクリーンショット 2018-11-26 2.20.10.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/99177506-82b7-edc7-2644-cab900b83e3b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F99177506-82b7-edc7-2644-cab900b83e3b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=eb19455c7cade48f33cabfacbe8d4d78 1x" loading="lazy"></a></p>

<p>google-services.jsonがダウンロードできたら、XamarinFirebaseSample.Androidプロジェクトのルートに追加します。また、ビルドアクションが<code>GoogleServicesJson</code>になっていることを確認してください。</p>

<p><a href="https://camo.qiitausercontent.com/dfb186de539ffa366492e6efc0a3234868062f78/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f64373939653634392d643363392d643561652d646665642d6535616161303635386666342e706e67" target="_blank" rel="nofollow noopener"><img width="1306" alt="スクリーンショット 2018-12-04 2.57.30.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fd799e649-d3c9-d5ae-dfed-e5aaa0658ff4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=657b1293f31c5ec1af18d37fd183373d" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/d799e649-d3c9-d5ae-dfed-e5aaa0658ff4.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fd799e649-d3c9-d5ae-dfed-e5aaa0658ff4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=95c05ab9d781999830075e3a7b4beff0 1x" loading="lazy"></a></p>

<h2>
<span id="cloud-firestoreの設定" class="fragment"></span><a href="#cloud-firestore%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Cloud Firestoreの設定</h2>

<p>[Database]セクションで、[データベースの作成]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/485a5394cc0b2267c0009849bdff8d8b4f2efed3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f38623835636333652d346333622d656364372d383336662d6131373763633165323539642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F8b85cc3e-4c3b-ecd7-836f-a177cc1e259d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7c9f3baeab382f186356761e440e22af" alt="スクリーンショット 2018-11-26 2.21.44.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/8b85cc3e-4c3b-ecd7-836f-a177cc1e259d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F8b85cc3e-4c3b-ecd7-836f-a177cc1e259d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0a2a12144fa13a8f5a9eb9b3ad81e878 1x" loading="lazy"></a> </p>

<p>[有効にする]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/a0786710990632b232abaa40b55c52f961289dad/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63303366356366332d343166362d363665352d333437662d3362323063363134663532332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc03f5cf3-41f6-66e5-347f-3b20c614f523.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e3ee899b00a1e4de490fae12a019cd0c" alt="スクリーンショット 2018-11-26 2.21.48.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/c03f5cf3-41f6-66e5-347f-3b20c614f523.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc03f5cf3-41f6-66e5-347f-3b20c614f523.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=96b1dcdd0635414dafa1f1b9fd78393d 1x" loading="lazy"></a></p>

<h3>
<span id="セキュリティルールの変更" class="fragment"></span><a href="#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%AB%E3%83%BC%E3%83%AB%E3%81%AE%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>セキュリティルールの変更</h3>

<p>認証しなければ、読み込みも書き込みもできないようにします。<br>
[ルール]タブで、以下のように記述して、[公開]をクリックします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if request.auth.uid != null;
    }
  }
}
</code></pre></div></div>

<p><a href="https://camo.qiitausercontent.com/f04b441a4199bd160e2048bd39ce8ec3fa0a1af4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f35373764303137612d646164362d613262612d383234332d3964633832336162396330342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F577d017a-dad6-a2ba-8243-9dc823ab9c04.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d2ab50d1021e83568d0b20522a17d229" alt="スクリーンショット 2018-12-04 19.50.42.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/577d017a-dad6-a2ba-8243-9dc823ab9c04.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F577d017a-dad6-a2ba-8243-9dc823ab9c04.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=061261835d0fb46a2b9e2011bb294941 1x" loading="lazy"></a></p>

<h3>
<span id="複合インデックスの作成" class="fragment"></span><a href="#%E8%A4%87%E5%90%88%E3%82%A4%E3%83%B3%E3%83%87%E3%83%83%E3%82%AF%E3%82%B9%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>複合インデックスの作成</h3>

<p>サンプルアプリでは、自分の投稿を新しい順に取得しているため、複合インデックスの作成が必要です。<br>
[インデックス]タブで、[手動でインデックスを作成]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/f83366407964363b7c265c3e2d11de44935d6be1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f36383161366339652d313366372d656163662d656538662d6136633165623666633336632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F681a6c9e-13f7-eacf-ee8f-a6c1eb6fc36c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0d417af9ba2c80f33f0304535413becb" alt="スクリーンショット 2018-12-04 19.47.19.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/681a6c9e-13f7-eacf-ee8f-a6c1eb6fc36c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F681a6c9e-13f7-eacf-ee8f-a6c1eb6fc36c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=63015ca364d43df554abb2420d001ede 1x" loading="lazy"></a></p>

<p>複合インデックスの作成画面で以下のように設定して、[インデックスの作成]をクリックします。</p>

<p><strong>対象となるコレクション</strong><br>
items</p>

<p><strong>フィールド</strong></p>

<table>
<thead>
<tr>
<th>順番</th>
<th>フィールドのパス</th>
<th>モード</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>OwnerId</td>
<td>Ascending</td>
</tr>
<tr>
<td>2</td>
<td>Timestamp</td>
<td>Descending</td>
</tr>
</tbody>
</table>

<p><a href="https://camo.qiitausercontent.com/6430518e6c93842aad6b5bb84cf363d0a634c68c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62343537653962362d333434342d646139342d306337652d6164343531363537326239612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb457e9b6-3444-da94-0c7e-ad4516572b9a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7893aedbffa6b9079ab20b970ed54d9e" alt="スクリーンショット 2018-12-02 16.06.09.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/b457e9b6-3444-da94-0c7e-ad4516572b9a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb457e9b6-3444-da94-0c7e-ad4516572b9a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6424664834628f5f6dc003291a74b3b1 1x" loading="lazy"></a></p>

<p>今回は、手動で設定しましたが、まだ設定していない時に、複合インデックスが必要なクエリを行なったら、以下のような例外が発生します。そこのメッセージにあるアドレスを叩くことでも設定ができます。</p>

<p><a href="https://camo.qiitausercontent.com/98c8d4c6f554fe628c2cd6135f883974c1c33b29/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f37373032336632322d316538392d343338302d646334382d3631613662356266353038612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F77023f22-1e89-4380-dc48-61a6b5bf508a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=318f0298cd4f1730eb9572eb2d86ed4c" alt="スクリーンショット 2018-12-02 16.00.33.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/77023f22-1e89-4380-dc48-61a6b5bf508a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F77023f22-1e89-4380-dc48-61a6b5bf508a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8554c0a51fbe17a9ea6a0da62fe76291 1x" loading="lazy"></a></p>

<h2>
<span id="authenticationの設定" class="fragment"></span><a href="#authentication%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Authenticationの設定</h2>

<p>[Authentication]セクションで、[ログイン方法]タブを選択します。<br>
[メール/パスワード]を有効にして、[保存]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/1623ef76f76441dd75361d9c1a13b17d276d42be/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63613266616539622d643864352d306165342d616639652d6137626666383163626437312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fca2fae9b-d8d5-0ae4-af9e-a7bff81cbd71.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=88986dd2475022f1bb28db8cde47dbb5" alt="スクリーンショット 2018-12-03 23.26.34.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/ca2fae9b-d8d5-0ae4-af9e-a7bff81cbd71.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fca2fae9b-d8d5-0ae4-af9e-a7bff81cbd71.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c9274afdaeb7d0119faefc754fd3701b 1x" loading="lazy"></a></p>

<p>[Google]を有効にし、メールアドレスを選択して、[保存]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/ede99c089e37edf38e0b998b9f1f00cb360cd4cf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62383130306237332d363834652d623837322d373831612d3533323035396463663163392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb8100b73-684e-b872-781a-532059dcf1c9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7fa09b468da8dac02e236b2b083ab297" alt="スクリーンショット 2018-12-04 0.36.51.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/b8100b73-684e-b872-781a-532059dcf1c9.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb8100b73-684e-b872-781a-532059dcf1c9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a6b54695a7ba2d69061f8864ed3f9995 1x" loading="lazy"></a></p>

<h2>
<span id="storageの設定" class="fragment"></span><a href="#storage%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Storageの設定</h2>

<p>[Storage]セクションで、[スタートガイド]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/627b98d93048f0859e6c23dfcdb96df3ee9f4d37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f35653037633535372d313734622d383135642d666238302d6265306132623363613838622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5e07c557-174b-815d-fb80-be0a2b3ca88b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=dc850c8143f96be31c2d15ee8c178d4e" alt="スクリーンショット 2018-11-30 18.01.14.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/5e07c557-174b-815d-fb80-be0a2b3ca88b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5e07c557-174b-815d-fb80-be0a2b3ca88b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4e4d3ff251e9b6370487ec5eb3f9df83 1x" loading="lazy"></a> </p>

<p>セキュリティルールが表示されるので[OK]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/a9f59378923e79656ef9bf1385bc8fd5105204cd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f36666262316130652d663434322d306339312d616430612d3261373731303530663665352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F6fbb1a0e-f442-0c91-ad0a-2a771050f6e5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=57a0d2d0dac041d535fd0acf15ed8d66" alt="スクリーンショット 2018-11-30 18.01.22.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/6fbb1a0e-f442-0c91-ad0a-2a771050f6e5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F6fbb1a0e-f442-0c91-ad0a-2a771050f6e5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8f92084d3176726ef30182ad7563eb9d 1x" loading="lazy"></a></p>

<h2>
<span id="crashlyticsの設定" class="fragment"></span><a href="#crashlytics%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Crashlyticsの設定</h2>

<p>[Crashlytics]セクションで、[Crashlytics を設定]をクリックします。</p>

<p><a href="https://camo.qiitausercontent.com/424d38afac3192cd27da7f1a8a44af886eb707f2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62656362353163662d323862652d663438372d653334382d3561623161653332346562652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbecb51cf-28be-f487-e348-5ab1ae324ebe.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c446a49546c0d1508232584ba7e7f6b4" alt="スクリーンショット 2018-12-04 22.24.55.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/becb51cf-28be-f487-e348-5ab1ae324ebe.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbecb51cf-28be-f487-e348-5ab1ae324ebe.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7c1654414d0c4cecb041e8fe8c77a8a2 1x" loading="lazy"></a></p>

<p>[このアプリではCrashlyticsを初めて使用します]を選択して、[次へ]をクリックします。<br>
この設定は、iOS、Androidのアプリごとに行う必要があります。</p>

<p><a href="https://camo.qiitausercontent.com/c803e31e05c107ff55940edebbca8d694da560a0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f36353138336662302d396433322d643435612d393936622d6231333133393761643537312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F65183fb0-9d32-d45a-996b-b131397ad571.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3d028a1c754bfb64c4591fdc01ec3f7c" alt="スクリーンショット 2018-12-02 22.13.20.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/65183fb0-9d32-d45a-996b-b131397ad571.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F65183fb0-9d32-d45a-996b-b131397ad571.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=069bd2643a2aa026e166748cb4a8de28 1x" loading="lazy"></a></p>

<h2>
<span id="プログラム側の設定" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E5%81%B4%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>プログラム側の設定</h2>

<h3>
<span id="appconstans" class="fragment"></span><a href="#appconstans"><i class="fa fa-link"></i></a>AppConstans</h3>

<p>XamarinFirebaseSampleプロジェクトの<code>Helpers</code>フォルダの<code>AppConstants.cs</code>を修正します。<br>
ここには、Googleログインで使用するクライアントIDを設定します。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">AppConstants.cs</span></div>
<div class="highlight"><pre><code><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">AppConstans</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">IosGoogleClientId</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">IosReversedGoogleClientId</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">AndroidGoogleClientId</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">AndroidReversedGoogleClientId</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h4>
<span id="iosの設定" class="fragment"></span><a href="#ios%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>iOSの設定</h4>

<p>iOSは、先ほどダウンロードした<code>GoogleService-Info.plist</code>で確認できます。<br>
<code>IosGoogleClientId</code>は、<code>CLIENT_ID</code>キーの値を、<code>IosReversedGoogleClientId</code>には、<code>REVERSED_CLIENT_ID</code>の値を設定します。</p>

<h4>
<span id="androidの設定" class="fragment"></span><a href="#android%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Androidの設定</h4>

<p>Androidは、APIコンソールの<a href="https://console.developers.google.com/apis/credentials" rel="nofollow noopener" target="_blank">認証情報ページ</a>で確認できます。OAuth 2.0 クライアント IDにあるタイプがAndroidであるクライアントIDをコピーして、<code>AndroidGoogleClientId</code>に設定します。<code>AndroidReversedGoogleClientId</code>には、その逆ドメインを設定します。</p>

<p><a href="https://camo.qiitausercontent.com/344d3dc6e0947a753b78fed5893cc2db74c5698d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f35613462623530662d373762312d636135312d643235322d6237636331363539653065322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5a4bb50f-77b1-ca51-d252-b7cc1659e0e2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ca5ee520b3861f712607d6b04082adfa" alt="スクリーンショット 2018-12-04 16.06.40.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/5a4bb50f-77b1-ca51-d252-b7cc1659e0e2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5a4bb50f-77b1-ca51-d252-b7cc1659e0e2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4c7bb0995654de5c854f75ee43f2b507 1x" loading="lazy"></a></p>

<h3>
<span id="iosのurlスキームの設定" class="fragment"></span><a href="#ios%E3%81%AEurl%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%A0%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>iOSのURLスキームの設定</h3>

<p>iOSプロジェクトの<code>info.pist</code>を開き、[詳細設定]画面にします。<br>
[URLの種類を追加]をクリックして、[URL Schenes:]に先ほども利用した<code>GoogleService-Info.plist</code>の<code>REVERSED_CLIENT_ID</code>の値を設定します。</p>

<p><a href="https://camo.qiitausercontent.com/e4a17adc16600fd66b67a7ec9f9150d881d34fab/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62646433333731312d373136622d643739312d383837642d3139623334333662373465382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbdd33711-716b-d791-887d-19b3436b74e8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=85f129cbdc9eef0b1915d7f02a5e76d9" alt="スクリーンショット 2018-12-04 19.02.54.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/236182/bdd33711-716b-d791-887d-19b3436b74e8.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbdd33711-716b-d791-887d-19b3436b74e8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5448bb7991c428566869063a32af0292 1x" loading="lazy"></a></p>

<p>これで全ての設定が完了です。ビルドして動かしてみてください。</p>

<h1>
<span id="解説" class="fragment"></span><a href="#%E8%A7%A3%E8%AA%AC"><i class="fa fa-link"></i></a>解説</h1>

<p>サンプルアプリについて少し解説を行います。</p>

<h2>
<span id="services" class="fragment"></span><a href="#services"><i class="fa fa-link"></i></a>Services</h2>

<p>データの取得やログイン処理などのロジックは、Servicesフォルダ内のクラスで行なっています。ライブラリの使い方は、これらのクラスを見てもらえればいいです。<br>
以下がその一覧です。</p>

<table>
<thead>
<tr>
<th>クラス</th>
<th>機能</th>
<th>利用Firebase</th>
<th>備考</th>
</tr>
</thead>
<tbody>
<tr>
<td>AccountService</td>
<td>アカウントの管理</td>
<td>CloudFirestore, Auth</td>
<td>ユーザーデータの監視も行なっています</td>
</tr>
<tr>
<td>AuthService</td>
<td>認証</td>
<td>なし</td>
<td>Xamarin.Authを利用した認証処理を行なっています</td>
</tr>
<tr>
<td>ContributionService</td>
<td>アイテムの投稿</td>
<td>CloudFirestore</td>
<td>StorageServiceを利用して画像アップロードをしています</td>
</tr>
<tr>
<td>EmailLoginService</td>
<td>メールアドレスでのログイン</td>
<td>なし</td>
<td>AccountServiceを利用してログイン処理を行なっています</td>
</tr>
<tr>
<td>GoogleLoginService</td>
<td>Googleログイン</td>
<td>なし</td>
<td>AccountService、AuthServiceを利用してログイン処理を行なっています</td>
</tr>
<tr>
<td>ItemListService</td>
<td>アイテムリストの取得</td>
<td>CloudFirestore</td>
<td>アイテムデータの監視を行なっています</td>
</tr>
<tr>
<td>ItemService</td>
<td>アイテムデータの取得、更新</td>
<td>CloudFirestore, Analytics</td>
<td>データの取得後、Analyticsでview_itemイベントを送信しています</td>
</tr>
<tr>
<td>SignupService</td>
<td>サインアップ</td>
<td>なし</td>
<td>AccountServiceを利用してサインアップ処理を行なっています</td>
</tr>
<tr>
<td>StorageService</td>
<td>画像のアップロード</td>
<td>Storage</td>
<td>画像をアップロードして、ダウンロードURLの取得を行なっています</td>
</tr>
<tr>
<td>UserItemListService</td>
<td>投稿アイテムリストの取得</td>
<td>CloudFirestore</td>
<td>複合インデックスが必要なクエリを実行しています</td>
</tr>
</tbody>
</table>

<h2>
<span id="アイテムリスト" class="fragment"></span><a href="#%E3%82%A2%E3%82%A4%E3%83%86%E3%83%A0%E3%83%AA%E3%82%B9%E3%83%88"><i class="fa fa-link"></i></a>アイテムリスト</h2>

<p>ホーム画面のアイテムリストは、アイテムの追加や削除を行うと自動で更新されるようになっています。また、最初に投稿アイテムを一気に取得するのではなく、下にスクロールして最後まで表示されると２０件ずつ読み込むようになっています。<br>
それらの処理は、<code>ItemListService</code>の<code>LoadAsync</code>で行なっています。最後のアイテムが表示された時なら、<code>LoadAsync</code>を呼び出し、続きの２０件を取得するようにしています。<br>
実際にリアルタイム監視を行なっているのは以下の部分です。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">ItemListService.cs</span></div>
<div class="highlight"><pre><code><span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="n">_firestore</span><span class="p">.</span><span class="nf">GetCollection</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">CollectionPath</span><span class="p">)</span>
                      <span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Timestamp</span><span class="p">),</span> <span class="k">true</span><span class="p">)</span>
                      <span class="p">.</span><span class="nf">EndAt</span><span class="p">(</span><span class="k">new</span> <span class="kt">long</span><span class="p">[]</span> <span class="p">{</span> <span class="n">_lastTimestamp</span> <span class="p">});</span>

<span class="n">query</span><span class="p">.</span><span class="nf">ObserveAdded</span><span class="p">()</span>
     <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">_items</span><span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="n">d</span><span class="p">.</span><span class="n">Document</span><span class="p">.</span><span class="n">Id</span><span class="p">)</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
     <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">_items</span><span class="p">.</span><span class="nf">Insert</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">NewIndex</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">Document</span><span class="p">.</span><span class="n">ToObject</span><span class="p">&lt;</span><span class="n">Item</span><span class="p">&gt;()))</span>
     <span class="p">.</span><span class="nf">AddTo</span><span class="p">(</span><span class="n">_disposables</span><span class="p">);</span>

<span class="n">query</span><span class="p">.</span><span class="nf">ObserveModified</span><span class="p">()</span>
     <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">d</span><span class="p">.</span><span class="n">Document</span><span class="p">.</span><span class="n">ToObject</span><span class="p">&lt;</span><span class="n">Item</span><span class="p">&gt;())</span>
     <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">item</span> <span class="p">=&gt;</span>
     <span class="p">{</span>
         <span class="kt">var</span> <span class="n">targetItem</span> <span class="p">=</span> <span class="n">_items</span><span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="n">item</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">targetItem</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
         <span class="p">{</span>
             <span class="n">item</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">targetItem</span><span class="p">);</span>
         <span class="p">}</span>
     <span class="p">})</span>
     <span class="p">.</span><span class="nf">AddTo</span><span class="p">(</span><span class="n">_disposables</span><span class="p">);</span>

<span class="n">query</span><span class="p">.</span><span class="nf">ObserveRemoved</span><span class="p">()</span>
     <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">_items</span><span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="n">d</span><span class="p">.</span><span class="n">Document</span><span class="p">.</span><span class="n">Id</span><span class="p">))</span>
     <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">item</span> <span class="p">=&gt;</span> <span class="n">item</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
     <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">item</span> <span class="p">=&gt;</span> <span class="n">_items</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
     <span class="p">.</span><span class="nf">AddTo</span><span class="p">(</span><span class="n">_disposables</span><span class="p">);</span>
</code></pre></div>
</div>

<p><code>ObserveAdded</code>で追加、<code>ObserveModified</code>で変更、<code>ObserveRemoved</code>で削除の監視を行なっています。<br>
アイテムデータには、追加された時間である<code>Timestamp</code>を持っています。<code>_lastTimestamp</code>は、その表示されている最後のアイテムの<code>Timestamp</code>なので、<code>EndAt</code>で最後より新しいアイテムデータを監視していることになります。<br>
ちなみに、<code>Timestamp</code>は<code>long</code>型で、<code>DateTime.Now.Ticks</code>を与えています。時間なら<code>DateTime</code>型でもいいのではないかと思いますが、それだとうまく動かないことがあります。なぜなら、<code>NSDate</code>や<code>Java.Util.Date</code>から、<code>DateTime</code>に変換するときに微妙に誤差が出てしまい、データベース上に持っている値と異なることがあるからです。なので、誤差の出ることがない<code>long</code>型を使うようにしています。</p>

<h2>
<span id="データ監視の解除" class="fragment"></span><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E7%9B%A3%E8%A6%96%E3%81%AE%E8%A7%A3%E9%99%A4"><i class="fa fa-link"></i></a>データ監視の解除</h2>

<p>Prismでは、ページが破棄された時には<code>Destroy</code>が呼ばれるので、監視の解除はこのタイミングで行えばいいです。<br>
ただ、Androidでは、バックボタンでアプリを終了した場合は、<code>Destroy</code>が呼ばれないので、監視をバックグラウンドで続けたままになってしまいます。これはよろしくないので、<code>MainActivity</code>の<code>OnDestroy</code>で解除処理を走らせています。（<code>App</code>クラスの<code>Destroy</code>が解除処理です。）</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">MainActivity.cs</span></div>
<div class="highlight"><pre><code><span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnDestroy</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">base</span><span class="p">.</span><span class="nf">OnDestroy</span><span class="p">();</span>

    <span class="n">App</span><span class="p">.</span><span class="nf">Destroy</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="トランザクション" class="fragment"></span><a href="#%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"><i class="fa fa-link"></i></a>トランザクション</h2>

<p>いいねした時のいいね数の更新は、取得している値をインクリメントしていますが、そのまま普通に更新してしまうと、同時にいいねされた時などにデータの不整合が起きる可能性があります。このような場合に対応するために、Firestoreにはトランザクションの機能があります。<br>
<code>ItemService</code>の<code>LikeAsync</code>で以下のように利用しています。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">ItemService.cs</span></div>
<div class="highlight"><pre><code><span class="kt">var</span> <span class="n">success</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_firestore</span><span class="p">.</span><span class="nf">RunTransactionAsync</span><span class="p">(</span><span class="n">transaction</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">document</span> <span class="p">=</span> <span class="n">_firestore</span><span class="p">.</span><span class="nf">GetCollection</span><span class="p">(</span><span class="n">Models</span><span class="p">.</span><span class="n">Item</span><span class="p">.</span><span class="n">CollectionPath</span><span class="p">)</span>
                             <span class="p">.</span><span class="nf">GetDocument</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Value</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">item</span> <span class="p">=</span> <span class="n">transaction</span><span class="p">.</span><span class="nf">GetDocument</span><span class="p">(</span><span class="n">document</span><span class="p">).</span><span class="n">ToObject</span><span class="p">&lt;</span><span class="n">Item</span><span class="p">&gt;();</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

    <span class="n">item</span><span class="p">.</span><span class="n">LikeCount</span><span class="p">++;</span>
    <span class="n">transaction</span><span class="p">.</span><span class="nf">UpdateData</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">item</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}).</span><span class="nf">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</code></pre></div>
</div>

<h2>
<span id="analyticsのscreen_viewイベント" class="fragment"></span><a href="#analytics%E3%81%AEscreen_view%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88"><i class="fa fa-link"></i></a>Analyticsのscreen_viewイベント</h2>

<p>Analyticsは、画面遷移が発生すると自動的に<code>UIViewController</code>や<code>Activity</code>のクラス名で<code>screen_view</code>イベントを送るのですが、Xamarin.Formsではうまく機能しません。iOSでは、遷移は同じクラスのViewControllerが作られるので、画面の判別がつきません。Androidは、1つのActivityでViewを切り替えているだけなので、イベント自体送られません。仕方ないので、サンプルアプリでは、<code>OnAppearing</code>時に手動でイベントを送るようにしています。（<code>OnNavigatedTo</code>でもいいのですが、最初に表示される画面がうまく設定されなかったため<code>OnAppearing</code>にしました）</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">ViewModelBase.cs</span></div>
<div class="highlight"><pre><code><span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnAppearing</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">typeName</span> <span class="p">=</span> <span class="nf">GetType</span><span class="p">().</span><span class="n">Name</span><span class="p">;</span>
    <span class="n">CrossFirebaseAnalytics</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="nf">SetCurrentScreen</span><span class="p">(</span><span class="n">typeName</span><span class="p">,</span> <span class="n">typeName</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<p>Xamarin　+　Firebaseはいいぞ！</p>

<p>明日は、<a href="/ktz_alias" class="user-mention js-hovercard" title="ktz_alias" data-hovercard-target-type="user" data-hovercard-target-name="ktz_alias">@ktz_alias</a> さんです。よろしくお願いします！</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Ff-miyu%2Fitems%2F1e8c519d58868a923aac&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Ff-miyu%2Fitems%2F1e8c519d58868a923aac&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/f-miyu/items/1e8c519d58868a923aac/likers" class="css-1iupg5d">35</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">20</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/1e8c519d58868a923aac/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/f-miyu/items/1e8c519d58868a923aac/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/f-miyu/items/1e8c519d58868a923aac/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/f-miyu/items/1e8c519d58868a923aac/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/f-miyu/items/1e8c519d58868a923aac.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-ab31fa6f-1394-4e8b-9f6a-b384114c58fc">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-010621ec-0fbb-4c41-83a5-47ddfebe8997"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-010621ec-0fbb-4c41-83a5-47ddfebe8997">{}</script>
      
<div id="LoginModal-react-component-36b220bc-2bd2-4566-951e-2fb5a436a8f1"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-36b220bc-2bd2-4566-951e-2fb5a436a8f1">{}</script>
      
<div id="StockModal-react-component-db528cbd-0a9f-4044-94eb-b77b73bd3f8f"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-db528cbd-0a9f-4044-94eb-b77b73bd3f8f">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;KLSOq19i2GDe3yt5cfPuGoTdo00I34ST3Y92jPWt6PTAezJnfJZNcogZXT+6J6hk0KdSMSKRDQyjwN9IbQS3Qg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eこの記事は、\u003ca href=\"https://qiita.com/advent-calendar/2018/xamarin\"\u003eXamarin Advent Calendar 2018\u003c/a\u003eの５日目です。\u003c/p\u003e\n\n\u003cp\u003eFirebaseすごく便利です。データベース、ストレージ、認証などなど、バックエンドで必要な機能が簡単に使えてしまいます。Xamarinでもライブラリが用意されており、利用することが可能です。ただ、そのライブラリというのが、iOS用とAndroid用に分かれており、Xamarin.Formsで使うには、DependencyServiceを使うなどしなければならず、ちょっと面倒でした。そこで、Xamarin.Formsでそのまま使えるようなライブラリを作成しました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"作成したライブラリ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作成したライブラリ\u003c/h1\u003e\n\n\u003cp\u003eFirebaseの５つの機能のライブラリを作成しました。NuGetで公開済みなのですぐに利用できます。\u003cbr\u003e\n使い方は、それぞれのGitHubをみてください。（詳しい機能の説明はしていないので、\u003ca href=\"https://firebase.google.com/docs/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式のドキュメント\u003c/a\u003eも参照してください）\u003c/p\u003e\n\n\u003cp\u003eNuGet\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.nuget.org/packages/Plugin.CloudFirestore/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePlugin.CloudFirestore\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.nuget.org/packages/Plugin.FirebaseAuth/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePlugin.FirebaseAuth\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.nuget.org/packages/Plugin.FirebaseStorage/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePlugin.FirebaseStorage\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.nuget.org/packages/Plugin.FirebaseAnalytics/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePlugin.FirebaseAnalytics\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.nuget.org/packages/Plugin.FirebaseCrashlytics/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePlugin.FirebaseCrashlytics\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eGitHub\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/f-miyu/Plugin.CloudFirestore\" rel=\"nofollow noopener\" target=\"_blank\"\u003ef-miyu/Plugin.CloudFirestore\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/f-miyu/Plugin.FirebaseAuth\" rel=\"nofollow noopener\" target=\"_blank\"\u003ef-miyu/Plugin.FirebaseAuth\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/f-miyu/Plugin.FirebaseStorage\" rel=\"nofollow noopener\" target=\"_blank\"\u003ef-miyu/Plugin.FirebaseStorage\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/f-miyu/Plugin.FirebaseAnalytics\" rel=\"nofollow noopener\" target=\"_blank\"\u003ef-miyu/Plugin.FirebaseAnalytics\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/f-miyu/Plugin.FirebaseCrashlytics\" rel=\"nofollow noopener\" target=\"_blank\"\u003ef-miyu/Plugin.FirebaseCrashlytics\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"plugincloudfirestore\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#plugincloudfirestore\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePlugin.CloudFirestore\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://firebase.google.com/docs/firestore/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCloud Firestore\u003c/a\u003eを利用するためのライブラリです。\u003cbr\u003e\nデータベースから取得した時のデータの型は、当然iOSとAndroidでは異なるので、共通の型にマッピングする機能を備えています。また、リアルタイムでのデータの更新は、Rxが利用できるようにしています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"pluginfirebaseauth\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#pluginfirebaseauth\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePlugin.FirebaseAuth\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://firebase.google.com/docs/auth/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAuthentication\u003c/a\u003eを利用するためのライブラリです。\u003cbr\u003e\nPlugin.CloudFirestoreやPlugin.FirebaseStorageとは、セットで使うことになります。\u003cbr\u003e\nまた、各プロバイダーへの認証の機能はないので、\u003ca href=\"https://www.nuget.org/packages/Xamarin.Auth\" rel=\"nofollow noopener\" target=\"_blank\"\u003eXamarin.Auht\u003c/a\u003eなどを使ってください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"pluginfirebasestorage\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#pluginfirebasestorage\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePlugin.FirebaseStorage\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://firebase.google.com/docs/storage/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eStorage\u003c/a\u003eを利用するためのライブラリです。\u003cbr\u003e\n進捗のモニタリングやキャンセル、一時停止にも対応しています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"pluginfirebaseanalytics\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#pluginfirebaseanalytics\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePlugin.FirebaseAnalytics\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://firebase.google.com/docs/analytics/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eアナリティクス\u003c/a\u003eを利用するためのライブラリです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"pluginfirebasecrashlytics\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#pluginfirebasecrashlytics\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePlugin.FirebaseCrashlytics\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://firebase.google.com/docs/crashlytics\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCrashlytics\u003c/a\u003eを利用するためのライブラリです。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/hypermild/items/206345ddb6cb0ad53806\" id=\"reference-b3542cf28ba8bbaf95f3\"\u003e昨日の記事\u003c/a\u003eにも書かれてあるように、通常色々やらないといけないのをこれを入れるだけで大丈夫なようにもしています。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"サンプルアプリ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサンプルアプリ\u003c/h1\u003e\n\n\u003cp\u003eこれらのライブラリを利用したサンプルアプリも作成しました。画像を投稿して、リストに表示されて、いいねができる、ちょっとしたSNSアプリです。\u003cbr\u003e\nメールアドレスとGoogleでのログインができるようにしています。\u003cbr\u003e\nリストは、リアルタイム監視をしているので、誰かが投稿やいいねをすると自動で表示が更新されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/f-miyu/XamarinFirebaseSample\" rel=\"nofollow noopener\" target=\"_blank\"\u003ef-miyu/XamarinFirebaseSample\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4d2ff644196ed96698ac7898150f2c840b1abc15/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f33306266373736322d623032362d383261632d613434612d6466363961363563663664312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F30bf7762-b026-82ac-a44a-df69a65cf6d1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f9c6f5dee095ded66869216b1038bad7\" alt=\"スクリーンショット 2018-12-04 21.30.15.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/30bf7762-b026-82ac-a44a-df69a65cf6d1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F30bf7762-b026-82ac-a44a-df69a65cf6d1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ebd42a033a262fb9b79dc016bf387f1e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e \u003ca href=\"https://camo.qiitausercontent.com/63f66068e5869f1cf1105c4e8a9cf4cd2263f6a4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63393530633562612d653833352d633664312d333863362d6533613061343133333233352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc950c5ba-e835-c6d1-38c6-e3a0a4133235.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ddb19818f90b8eefad6ab807e5666297\" alt=\"スクリーンショット 2018-12-04 21.32.23.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/c950c5ba-e835-c6d1-38c6-e3a0a4133235.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc950c5ba-e835-c6d1-38c6-e3a0a4133235.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6d9f4022984061feef68aa94d3a651d9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"サンプルアプリを動かすには\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA%E3%82%92%E5%8B%95%E3%81%8B%E3%81%99%E3%81%AB%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサンプルアプリを動かすには\u003c/h1\u003e\n\n\u003cp\u003eサンプルアプリのGitHubには、\u003ccode\u003eGoogleService-Info.plist\u003c/code\u003eや\u003ccode\u003egoogle-services.json\u003c/code\u003eを含めていないので、動かすには各自でFirebaseの設定を行なってください。\u003cbr\u003e\n以下で設定の仕方を説明します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"firebaseプロジェクトの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#firebase%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eFirebaseプロジェクトの作成\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://console.firebase.google.com\" rel=\"nofollow noopener\" target=\"_blank\"\u003eFirebaseのコンソール\u003c/a\u003eで、[プロジェクトの追加]をクリックします。\u003cbr\u003e\nプロジェクトの追加画面で、プロジェクト名を入力し、アナリティクスの地域を日本に設定、同意に\u003cbr\u003e\nチェックをして、[プロジェクトを作成]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/9f5aa6780590623494b890fb66f576ececd84288/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f33363166663031662d336534622d346232302d373035302d6131653138303135366464622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F361ff01f-3e4b-4b20-7050-a1e180156ddb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2141fa3a07a4a3db5fe6b09518dd7785\" alt=\"スクリーンショット 2018-12-04 1.11.11.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/361ff01f-3e4b-4b20-7050-a1e180156ddb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F361ff01f-3e4b-4b20-7050-a1e180156ddb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5675e9f1de4d75e55c2c1c29728607c1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eトップの画面の、[iOS]ボタンをクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c4f57022ea30ee47b34a132696dba5fa8825f8ce/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f66306361353232302d366433652d303832312d373265302d3863323836343238393364662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Ff0ca5220-6d3e-0821-72e0-8c28642893df.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=50297614d241ae6a8b36ff27faa46ded\" alt=\"スクリーンショット 2018-11-26 2.17.28.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/f0ca5220-6d3e-0821-72e0-8c28642893df.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Ff0ca5220-6d3e-0821-72e0-8c28642893df.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9d72eade04a6c6a877679d21b31970a7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eiOSのバンドルIDを入力して、[アプリの登録]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/10ec84638e16a0d0f2eec8d2a09d947ea735ede3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f37353562653961372d653162372d613633612d616163652d6661366133643939386133642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F755be9a7-e1b7-a63a-aace-fa6a3d998a3d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=dd067daf9daf0865672a791914dfb36b\" alt=\"スクリーンショット 2018-11-26 2.17.55.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/755be9a7-e1b7-a63a-aace-fa6a3d998a3d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F755be9a7-e1b7-a63a-aace-fa6a3d998a3d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c08e149ff3e3fe48d7e624be731f9f39 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[GoogleService-Info.plistをダウンロード]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/2636a7c35c417609036badc557095970717c0172/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f39326264626333662d323364372d306162652d626438332d3536353137643161333032322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F92bdbc3f-23d7-0abe-bd83-56517d1a3022.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7f109f6312afe03ad42648b0a42f0073\" alt=\"スクリーンショット 2018-11-26 2.18.05.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/92bdbc3f-23d7-0abe-bd83-56517d1a3022.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F92bdbc3f-23d7-0abe-bd83-56517d1a3022.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bda621f559a2dcd27320e95eff431d30 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eGoogleService-Info.plistがダウンロードできたら、XamarinFirebaseSample.iOSプロジェクトのルートに追加します。また、ビルドアクションが\u003ccode\u003eBundleResource\u003c/code\u003eになっていることを確認してください。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/3c077d095c44b79ca6081846ca4f6f4b2320d88f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f32643861373562362d366433352d313265322d383835642d3930333238366239383731382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F2d8a75b6-6d35-12e2-885d-903286b98718.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5b7a619f40bccdbb4119fdf17ee67f8d\" alt=\"スクリーンショット 2018-12-04 2.26.21.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/2d8a75b6-6d35-12e2-885d-903286b98718.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F2d8a75b6-6d35-12e2-885d-903286b98718.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=50de42bdd364872ab3ced3fd2fdff753 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にAndroidの登録を行います。[アプリを追加]をクリックして、Androidを選択します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/60f5ef68716633eee03c5d9e67c48f6b376dee91/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f34363737303433632d343733652d346138652d343233612d6433346534643337666239612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F4677043c-473e-4a8e-423a-d34e4d37fb9a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1cb63ee26cc38c50479d6a2e99b25801\" alt=\"スクリーンショット 2018-11-26 2.19.27.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/4677043c-473e-4a8e-423a-d34e4d37fb9a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F4677043c-473e-4a8e-423a-d34e4d37fb9a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3a1f99e718a196455e8e1160d24e25b6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAndroidのパッケージ名を入力します。また、サンプルアプリでは、Googleログインを行なっているので、SHA-1の入力も必要です。\u003cbr\u003e\nXamarin.Androidで使用する、debug.keystoreのSHA-1フィンガープリントを取得するには、\u003ca href=\"https://docs.microsoft.com/ja-jp/xamarin/android/deploy-test/signing/keystore-signature\" rel=\"nofollow noopener\" target=\"_blank\"\u003eここ\u003c/a\u003eを参考にしてください。\u003cbr\u003e\n入力したら、[次へ]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e772f8c9667ac8422102a3485dfa7a271a3ae18c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63646231636661652d373930362d323138622d393735622d3333626663396566633431332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fcdb1cfae-7906-218b-975b-33bfc9efc413.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=32958e1189bb25e213a22cd4450f6933\" alt=\"スクリーンショット 2018-11-26 2.20.03.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/cdb1cfae-7906-218b-975b-33bfc9efc413.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fcdb1cfae-7906-218b-975b-33bfc9efc413.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=caaaadac1e1690cfbba53b75d84a9137 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[google-services.jsonをダウンロード]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1a8e234dd1e18675e7505e06c9f464bc61b41850/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f39393137373530362d383262372d656463372d323634342d6361623930306238336533622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F99177506-82b7-edc7-2644-cab900b83e3b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6b5bd877aceda2b752e0d239fcd83544\" alt=\"スクリーンショット 2018-11-26 2.20.10.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/99177506-82b7-edc7-2644-cab900b83e3b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F99177506-82b7-edc7-2644-cab900b83e3b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=eb19455c7cade48f33cabfacbe8d4d78 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003egoogle-services.jsonがダウンロードできたら、XamarinFirebaseSample.Androidプロジェクトのルートに追加します。また、ビルドアクションが\u003ccode\u003eGoogleServicesJson\u003c/code\u003eになっていることを確認してください。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/dfb186de539ffa366492e6efc0a3234868062f78/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f64373939653634392d643363392d643561652d646665642d6535616161303635386666342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"1306\" alt=\"スクリーンショット 2018-12-04 2.57.30.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fd799e649-d3c9-d5ae-dfed-e5aaa0658ff4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=657b1293f31c5ec1af18d37fd183373d\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/d799e649-d3c9-d5ae-dfed-e5aaa0658ff4.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fd799e649-d3c9-d5ae-dfed-e5aaa0658ff4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=95c05ab9d781999830075e3a7b4beff0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"cloud-firestoreの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#cloud-firestore%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCloud Firestoreの設定\u003c/h2\u003e\n\n\u003cp\u003e[Database]セクションで、[データベースの作成]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/485a5394cc0b2267c0009849bdff8d8b4f2efed3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f38623835636333652d346333622d656364372d383336662d6131373763633165323539642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F8b85cc3e-4c3b-ecd7-836f-a177cc1e259d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7c9f3baeab382f186356761e440e22af\" alt=\"スクリーンショット 2018-11-26 2.21.44.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/8b85cc3e-4c3b-ecd7-836f-a177cc1e259d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F8b85cc3e-4c3b-ecd7-836f-a177cc1e259d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0a2a12144fa13a8f5a9eb9b3ad81e878 1x\" loading=\"lazy\"\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003e[有効にする]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a0786710990632b232abaa40b55c52f961289dad/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63303366356366332d343166362d363665352d333437662d3362323063363134663532332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc03f5cf3-41f6-66e5-347f-3b20c614f523.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e3ee899b00a1e4de490fae12a019cd0c\" alt=\"スクリーンショット 2018-11-26 2.21.48.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/c03f5cf3-41f6-66e5-347f-3b20c614f523.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fc03f5cf3-41f6-66e5-347f-3b20c614f523.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=96b1dcdd0635414dafa1f1b9fd78393d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"セキュリティルールの変更\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%AB%E3%83%BC%E3%83%AB%E3%81%AE%E5%A4%89%E6%9B%B4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eセキュリティルールの変更\u003c/h3\u003e\n\n\u003cp\u003e認証しなければ、読み込みも書き込みもできないようにします。\u003cbr\u003e\n[ルール]タブで、以下のように記述して、[公開]をクリックします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003eservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /{document=**} {\n      allow read, write: if request.auth.uid != null;\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f04b441a4199bd160e2048bd39ce8ec3fa0a1af4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f35373764303137612d646164362d613262612d383234332d3964633832336162396330342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F577d017a-dad6-a2ba-8243-9dc823ab9c04.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d2ab50d1021e83568d0b20522a17d229\" alt=\"スクリーンショット 2018-12-04 19.50.42.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/577d017a-dad6-a2ba-8243-9dc823ab9c04.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F577d017a-dad6-a2ba-8243-9dc823ab9c04.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=061261835d0fb46a2b9e2011bb294941 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"複合インデックスの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A4%87%E5%90%88%E3%82%A4%E3%83%B3%E3%83%87%E3%83%83%E3%82%AF%E3%82%B9%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e複合インデックスの作成\u003c/h3\u003e\n\n\u003cp\u003eサンプルアプリでは、自分の投稿を新しい順に取得しているため、複合インデックスの作成が必要です。\u003cbr\u003e\n[インデックス]タブで、[手動でインデックスを作成]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f83366407964363b7c265c3e2d11de44935d6be1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f36383161366339652d313366372d656163662d656538662d6136633165623666633336632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F681a6c9e-13f7-eacf-ee8f-a6c1eb6fc36c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0d417af9ba2c80f33f0304535413becb\" alt=\"スクリーンショット 2018-12-04 19.47.19.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/681a6c9e-13f7-eacf-ee8f-a6c1eb6fc36c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F681a6c9e-13f7-eacf-ee8f-a6c1eb6fc36c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=63015ca364d43df554abb2420d001ede 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e複合インデックスの作成画面で以下のように設定して、[インデックスの作成]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e対象となるコレクション\u003c/strong\u003e\u003cbr\u003e\nitems\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eフィールド\u003c/strong\u003e\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e順番\u003c/th\u003e\n\u003cth\u003eフィールドのパス\u003c/th\u003e\n\u003cth\u003eモード\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eOwnerId\u003c/td\u003e\n\u003ctd\u003eAscending\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eTimestamp\u003c/td\u003e\n\u003ctd\u003eDescending\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/6430518e6c93842aad6b5bb84cf363d0a634c68c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62343537653962362d333434342d646139342d306337652d6164343531363537326239612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb457e9b6-3444-da94-0c7e-ad4516572b9a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7893aedbffa6b9079ab20b970ed54d9e\" alt=\"スクリーンショット 2018-12-02 16.06.09.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/b457e9b6-3444-da94-0c7e-ad4516572b9a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb457e9b6-3444-da94-0c7e-ad4516572b9a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6424664834628f5f6dc003291a74b3b1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e今回は、手動で設定しましたが、まだ設定していない時に、複合インデックスが必要なクエリを行なったら、以下のような例外が発生します。そこのメッセージにあるアドレスを叩くことでも設定ができます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/98c8d4c6f554fe628c2cd6135f883974c1c33b29/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f37373032336632322d316538392d343338302d646334382d3631613662356266353038612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F77023f22-1e89-4380-dc48-61a6b5bf508a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=318f0298cd4f1730eb9572eb2d86ed4c\" alt=\"スクリーンショット 2018-12-02 16.00.33.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/77023f22-1e89-4380-dc48-61a6b5bf508a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F77023f22-1e89-4380-dc48-61a6b5bf508a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8554c0a51fbe17a9ea6a0da62fe76291 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"authenticationの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#authentication%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAuthenticationの設定\u003c/h2\u003e\n\n\u003cp\u003e[Authentication]セクションで、[ログイン方法]タブを選択します。\u003cbr\u003e\n[メール/パスワード]を有効にして、[保存]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1623ef76f76441dd75361d9c1a13b17d276d42be/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f63613266616539622d643864352d306165342d616639652d6137626666383163626437312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fca2fae9b-d8d5-0ae4-af9e-a7bff81cbd71.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=88986dd2475022f1bb28db8cde47dbb5\" alt=\"スクリーンショット 2018-12-03 23.26.34.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/ca2fae9b-d8d5-0ae4-af9e-a7bff81cbd71.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fca2fae9b-d8d5-0ae4-af9e-a7bff81cbd71.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c9274afdaeb7d0119faefc754fd3701b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[Google]を有効にし、メールアドレスを選択して、[保存]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ede99c089e37edf38e0b998b9f1f00cb360cd4cf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62383130306237332d363834652d623837322d373831612d3533323035396463663163392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb8100b73-684e-b872-781a-532059dcf1c9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7fa09b468da8dac02e236b2b083ab297\" alt=\"スクリーンショット 2018-12-04 0.36.51.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/b8100b73-684e-b872-781a-532059dcf1c9.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fb8100b73-684e-b872-781a-532059dcf1c9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a6b54695a7ba2d69061f8864ed3f9995 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"storageの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#storage%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eStorageの設定\u003c/h2\u003e\n\n\u003cp\u003e[Storage]セクションで、[スタートガイド]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/627b98d93048f0859e6c23dfcdb96df3ee9f4d37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f35653037633535372d313734622d383135642d666238302d6265306132623363613838622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5e07c557-174b-815d-fb80-be0a2b3ca88b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=dc850c8143f96be31c2d15ee8c178d4e\" alt=\"スクリーンショット 2018-11-30 18.01.14.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/5e07c557-174b-815d-fb80-be0a2b3ca88b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5e07c557-174b-815d-fb80-be0a2b3ca88b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4e4d3ff251e9b6370487ec5eb3f9df83 1x\" loading=\"lazy\"\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eセキュリティルールが表示されるので[OK]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a9f59378923e79656ef9bf1385bc8fd5105204cd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f36666262316130652d663434322d306339312d616430612d3261373731303530663665352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F6fbb1a0e-f442-0c91-ad0a-2a771050f6e5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=57a0d2d0dac041d535fd0acf15ed8d66\" alt=\"スクリーンショット 2018-11-30 18.01.22.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/6fbb1a0e-f442-0c91-ad0a-2a771050f6e5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F6fbb1a0e-f442-0c91-ad0a-2a771050f6e5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8f92084d3176726ef30182ad7563eb9d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"crashlyticsの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#crashlytics%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCrashlyticsの設定\u003c/h2\u003e\n\n\u003cp\u003e[Crashlytics]セクションで、[Crashlytics を設定]をクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/424d38afac3192cd27da7f1a8a44af886eb707f2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62656362353163662d323862652d663438372d653334382d3561623161653332346562652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbecb51cf-28be-f487-e348-5ab1ae324ebe.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c446a49546c0d1508232584ba7e7f6b4\" alt=\"スクリーンショット 2018-12-04 22.24.55.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/becb51cf-28be-f487-e348-5ab1ae324ebe.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbecb51cf-28be-f487-e348-5ab1ae324ebe.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7c1654414d0c4cecb041e8fe8c77a8a2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[このアプリではCrashlyticsを初めて使用します]を選択して、[次へ]をクリックします。\u003cbr\u003e\nこの設定は、iOS、Androidのアプリごとに行う必要があります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c803e31e05c107ff55940edebbca8d694da560a0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f36353138336662302d396433322d643435612d393936622d6231333133393761643537312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F65183fb0-9d32-d45a-996b-b131397ad571.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3d028a1c754bfb64c4591fdc01ec3f7c\" alt=\"スクリーンショット 2018-12-02 22.13.20.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/65183fb0-9d32-d45a-996b-b131397ad571.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F65183fb0-9d32-d45a-996b-b131397ad571.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=069bd2643a2aa026e166748cb4a8de28 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"プログラム側の設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E5%81%B4%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプログラム側の設定\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"appconstans\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#appconstans\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAppConstans\u003c/h3\u003e\n\n\u003cp\u003eXamarinFirebaseSampleプロジェクトの\u003ccode\u003eHelpers\u003c/code\u003eフォルダの\u003ccode\u003eAppConstants.cs\u003c/code\u003eを修正します。\u003cbr\u003e\nここには、Googleログインで使用するクライアントIDを設定します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAppConstants.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAppConstans\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eIosGoogleClientId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eIosReversedGoogleClientId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eAndroidGoogleClientId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eAndroidReversedGoogleClientId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"iosの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ios%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eiOSの設定\u003c/h4\u003e\n\n\u003cp\u003eiOSは、先ほどダウンロードした\u003ccode\u003eGoogleService-Info.plist\u003c/code\u003eで確認できます。\u003cbr\u003e\n\u003ccode\u003eIosGoogleClientId\u003c/code\u003eは、\u003ccode\u003eCLIENT_ID\u003c/code\u003eキーの値を、\u003ccode\u003eIosReversedGoogleClientId\u003c/code\u003eには、\u003ccode\u003eREVERSED_CLIENT_ID\u003c/code\u003eの値を設定します。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"androidの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#android%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAndroidの設定\u003c/h4\u003e\n\n\u003cp\u003eAndroidは、APIコンソールの\u003ca href=\"https://console.developers.google.com/apis/credentials\" rel=\"nofollow noopener\" target=\"_blank\"\u003e認証情報ページ\u003c/a\u003eで確認できます。OAuth 2.0 クライアント IDにあるタイプがAndroidであるクライアントIDをコピーして、\u003ccode\u003eAndroidGoogleClientId\u003c/code\u003eに設定します。\u003ccode\u003eAndroidReversedGoogleClientId\u003c/code\u003eには、その逆ドメインを設定します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/344d3dc6e0947a753b78fed5893cc2db74c5698d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f35613462623530662d373762312d636135312d643235322d6237636331363539653065322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5a4bb50f-77b1-ca51-d252-b7cc1659e0e2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ca5ee520b3861f712607d6b04082adfa\" alt=\"スクリーンショット 2018-12-04 16.06.40.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/5a4bb50f-77b1-ca51-d252-b7cc1659e0e2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2F5a4bb50f-77b1-ca51-d252-b7cc1659e0e2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4c7bb0995654de5c854f75ee43f2b507 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"iosのurlスキームの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ios%E3%81%AEurl%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%A0%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eiOSのURLスキームの設定\u003c/h3\u003e\n\n\u003cp\u003eiOSプロジェクトの\u003ccode\u003einfo.pist\u003c/code\u003eを開き、[詳細設定]画面にします。\u003cbr\u003e\n[URLの種類を追加]をクリックして、[URL Schenes:]に先ほども利用した\u003ccode\u003eGoogleService-Info.plist\u003c/code\u003eの\u003ccode\u003eREVERSED_CLIENT_ID\u003c/code\u003eの値を設定します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e4a17adc16600fd66b67a7ec9f9150d881d34fab/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3233363138322f62646433333731312d373136622d643739312d383837642d3139623334333662373465382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbdd33711-716b-d791-887d-19b3436b74e8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=85f129cbdc9eef0b1915d7f02a5e76d9\" alt=\"スクリーンショット 2018-12-04 19.02.54.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/236182/bdd33711-716b-d791-887d-19b3436b74e8.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F236182%2Fbdd33711-716b-d791-887d-19b3436b74e8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5448bb7991c428566869063a32af0292 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれで全ての設定が完了です。ビルドして動かしてみてください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"解説\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h1\u003e\n\n\u003cp\u003eサンプルアプリについて少し解説を行います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"services\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#services\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eServices\u003c/h2\u003e\n\n\u003cp\u003eデータの取得やログイン処理などのロジックは、Servicesフォルダ内のクラスで行なっています。ライブラリの使い方は、これらのクラスを見てもらえればいいです。\u003cbr\u003e\n以下がその一覧です。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eクラス\u003c/th\u003e\n\u003cth\u003e機能\u003c/th\u003e\n\u003cth\u003e利用Firebase\u003c/th\u003e\n\u003cth\u003e備考\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eAccountService\u003c/td\u003e\n\u003ctd\u003eアカウントの管理\u003c/td\u003e\n\u003ctd\u003eCloudFirestore, Auth\u003c/td\u003e\n\u003ctd\u003eユーザーデータの監視も行なっています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAuthService\u003c/td\u003e\n\u003ctd\u003e認証\u003c/td\u003e\n\u003ctd\u003eなし\u003c/td\u003e\n\u003ctd\u003eXamarin.Authを利用した認証処理を行なっています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eContributionService\u003c/td\u003e\n\u003ctd\u003eアイテムの投稿\u003c/td\u003e\n\u003ctd\u003eCloudFirestore\u003c/td\u003e\n\u003ctd\u003eStorageServiceを利用して画像アップロードをしています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eEmailLoginService\u003c/td\u003e\n\u003ctd\u003eメールアドレスでのログイン\u003c/td\u003e\n\u003ctd\u003eなし\u003c/td\u003e\n\u003ctd\u003eAccountServiceを利用してログイン処理を行なっています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGoogleLoginService\u003c/td\u003e\n\u003ctd\u003eGoogleログイン\u003c/td\u003e\n\u003ctd\u003eなし\u003c/td\u003e\n\u003ctd\u003eAccountService、AuthServiceを利用してログイン処理を行なっています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eItemListService\u003c/td\u003e\n\u003ctd\u003eアイテムリストの取得\u003c/td\u003e\n\u003ctd\u003eCloudFirestore\u003c/td\u003e\n\u003ctd\u003eアイテムデータの監視を行なっています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eItemService\u003c/td\u003e\n\u003ctd\u003eアイテムデータの取得、更新\u003c/td\u003e\n\u003ctd\u003eCloudFirestore, Analytics\u003c/td\u003e\n\u003ctd\u003eデータの取得後、Analyticsでview_itemイベントを送信しています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSignupService\u003c/td\u003e\n\u003ctd\u003eサインアップ\u003c/td\u003e\n\u003ctd\u003eなし\u003c/td\u003e\n\u003ctd\u003eAccountServiceを利用してサインアップ処理を行なっています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eStorageService\u003c/td\u003e\n\u003ctd\u003e画像のアップロード\u003c/td\u003e\n\u003ctd\u003eStorage\u003c/td\u003e\n\u003ctd\u003e画像をアップロードして、ダウンロードURLの取得を行なっています\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUserItemListService\u003c/td\u003e\n\u003ctd\u003e投稿アイテムリストの取得\u003c/td\u003e\n\u003ctd\u003eCloudFirestore\u003c/td\u003e\n\u003ctd\u003e複合インデックスが必要なクエリを実行しています\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"アイテムリスト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%82%A4%E3%83%86%E3%83%A0%E3%83%AA%E3%82%B9%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアイテムリスト\u003c/h2\u003e\n\n\u003cp\u003eホーム画面のアイテムリストは、アイテムの追加や削除を行うと自動で更新されるようになっています。また、最初に投稿アイテムを一気に取得するのではなく、下にスクロールして最後まで表示されると２０件ずつ読み込むようになっています。\u003cbr\u003e\nそれらの処理は、\u003ccode\u003eItemListService\u003c/code\u003eの\u003ccode\u003eLoadAsync\u003c/code\u003eで行なっています。最後のアイテムが表示された時なら、\u003ccode\u003eLoadAsync\u003c/code\u003eを呼び出し、続きの２０件を取得するようにしています。\u003cbr\u003e\n実際にリアルタイム監視を行なっているのは以下の部分です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eItemListService.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_firestore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCollectionPath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                      \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOrderBy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enameof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTimestamp\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                      \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEndAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003e_lastTimestamp\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eObserveAdded\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirstOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInsert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNewIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;()))\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_disposables\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eObserveModified\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;())\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n         \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etargetItem\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirstOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n         \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetItem\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n             \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopyTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetItem\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_disposables\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eObserveRemoved\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirstOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRemove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_disposables\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eObserveAdded\u003c/code\u003eで追加、\u003ccode\u003eObserveModified\u003c/code\u003eで変更、\u003ccode\u003eObserveRemoved\u003c/code\u003eで削除の監視を行なっています。\u003cbr\u003e\nアイテムデータには、追加された時間である\u003ccode\u003eTimestamp\u003c/code\u003eを持っています。\u003ccode\u003e_lastTimestamp\u003c/code\u003eは、その表示されている最後のアイテムの\u003ccode\u003eTimestamp\u003c/code\u003eなので、\u003ccode\u003eEndAt\u003c/code\u003eで最後より新しいアイテムデータを監視していることになります。\u003cbr\u003e\nちなみに、\u003ccode\u003eTimestamp\u003c/code\u003eは\u003ccode\u003elong\u003c/code\u003e型で、\u003ccode\u003eDateTime.Now.Ticks\u003c/code\u003eを与えています。時間なら\u003ccode\u003eDateTime\u003c/code\u003e型でもいいのではないかと思いますが、それだとうまく動かないことがあります。なぜなら、\u003ccode\u003eNSDate\u003c/code\u003eや\u003ccode\u003eJava.Util.Date\u003c/code\u003eから、\u003ccode\u003eDateTime\u003c/code\u003eに変換するときに微妙に誤差が出てしまい、データベース上に持っている値と異なることがあるからです。なので、誤差の出ることがない\u003ccode\u003elong\u003c/code\u003e型を使うようにしています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"データ監視の解除\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E7%9B%A3%E8%A6%96%E3%81%AE%E8%A7%A3%E9%99%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデータ監視の解除\u003c/h2\u003e\n\n\u003cp\u003ePrismでは、ページが破棄された時には\u003ccode\u003eDestroy\u003c/code\u003eが呼ばれるので、監視の解除はこのタイミングで行えばいいです。\u003cbr\u003e\nただ、Androidでは、バックボタンでアプリを終了した場合は、\u003ccode\u003eDestroy\u003c/code\u003eが呼ばれないので、監視をバックグラウンドで続けたままになってしまいます。これはよろしくないので、\u003ccode\u003eMainActivity\u003c/code\u003eの\u003ccode\u003eOnDestroy\u003c/code\u003eで解除処理を走らせています。（\u003ccode\u003eApp\u003c/code\u003eクラスの\u003ccode\u003eDestroy\u003c/code\u003eが解除処理です。）\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainActivity.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnDestroy\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ebase\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnDestroy\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDestroy\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"トランザクション\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eトランザクション\u003c/h2\u003e\n\n\u003cp\u003eいいねした時のいいね数の更新は、取得している値をインクリメントしていますが、そのまま普通に更新してしまうと、同時にいいねされた時などにデータの不整合が起きる可能性があります。このような場合に対応するために、Firestoreにはトランザクションの機能があります。\u003cbr\u003e\n\u003ccode\u003eItemService\u003c/code\u003eの\u003ccode\u003eLikeAsync\u003c/code\u003eで以下のように利用しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eItemService.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esuccess\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003e_firestore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunTransactionAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etransaction\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edocument\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_firestore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCollectionPath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etransaction\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eToObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLikeCount\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etransaction\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUpdateData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}).\u003c/span\u003e\u003cspan class=\"nf\"\u003eConfigureAwait\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"analyticsのscreen_viewイベント\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#analytics%E3%81%AEscreen_view%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAnalyticsのscreen_viewイベント\u003c/h2\u003e\n\n\u003cp\u003eAnalyticsは、画面遷移が発生すると自動的に\u003ccode\u003eUIViewController\u003c/code\u003eや\u003ccode\u003eActivity\u003c/code\u003eのクラス名で\u003ccode\u003escreen_view\u003c/code\u003eイベントを送るのですが、Xamarin.Formsではうまく機能しません。iOSでは、遷移は同じクラスのViewControllerが作られるので、画面の判別がつきません。Androidは、1つのActivityでViewを切り替えているだけなので、イベント自体送られません。仕方ないので、サンプルアプリでは、\u003ccode\u003eOnAppearing\u003c/code\u003e時に手動でイベントを送るようにしています。（\u003ccode\u003eOnNavigatedTo\u003c/code\u003eでもいいのですが、最初に表示される画面がうまく設定されなかったため\u003ccode\u003eOnAppearing\u003c/code\u003eにしました）\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eViewModelBase.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evirtual\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnAppearing\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etypeName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eCrossFirebaseAnalytics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCurrentScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etypeName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etypeName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eXamarin　+　Firebaseはいいぞ！\u003c/p\u003e\n\n\u003cp\u003e明日は、\u003ca href=\"/ktz_alias\" class=\"user-mention js-hovercard\" title=\"ktz_alias\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"ktz_alias\"\u003e@ktz_alias\u003c/a\u003e さんです。よろしくお願いします！\u003c/p\u003e\n","createdAt":"2018-12-04T13:30:48Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"PF2RpzFcGdPzo4/+dgQwVBKd4B+/dIMe--bcS5DDS2a7rwx3OK--NSE68ccJK/HhCbjYluNmYg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2018-12-04T22:00:47Z","likesCount":35,"linkUrl":"https://qiita.com/f-miyu/items/1e8c519d58868a923aac","organization":null,"originalId":733044,"stockedCount":20,"title":"Xamarin.FormsでのFirebase利用が捗る５つのライブラリを作ってみた","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"\u003e作成したライブラリ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#plugincloudfirestore\"\u003ePlugin.CloudFirestore\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pluginfirebaseauth\"\u003ePlugin.FirebaseAuth\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pluginfirebasestorage\"\u003ePlugin.FirebaseStorage\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pluginfirebaseanalytics\"\u003ePlugin.FirebaseAnalytics\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pluginfirebasecrashlytics\"\u003ePlugin.FirebaseCrashlytics\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA\"\u003eサンプルアプリ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA%E3%82%92%E5%8B%95%E3%81%8B%E3%81%99%E3%81%AB%E3%81%AF\"\u003eサンプルアプリを動かすには\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#firebase%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003eFirebaseプロジェクトの作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#cloud-firestore%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eCloud Firestoreの設定\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%AB%E3%83%BC%E3%83%AB%E3%81%AE%E5%A4%89%E6%9B%B4\"\u003eセキュリティルールの変更\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A4%87%E5%90%88%E3%82%A4%E3%83%B3%E3%83%87%E3%83%83%E3%82%AF%E3%82%B9%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e複合インデックスの作成\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#authentication%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eAuthenticationの設定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#storage%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eStorageの設定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#crashlytics%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eCrashlyticsの設定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E5%81%B4%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eプログラム側の設定\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#appconstans\"\u003eAppConstans\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#ios%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eiOSの設定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#android%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eAndroidの設定\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ios%E3%81%AEurl%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%A0%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eiOSのURLスキームの設定\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A7%A3%E8%AA%AC\"\u003e解説\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#services\"\u003eServices\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%82%A4%E3%83%86%E3%83%A0%E3%83%AA%E3%82%B9%E3%83%88\"\u003eアイテムリスト\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E7%9B%A3%E8%A6%96%E3%81%AE%E8%A7%A3%E9%99%A4\"\u003eデータ監視の解除\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3\"\u003eトランザクション\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#analytics%E3%81%AEscreen_view%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88\"\u003eAnalyticsのscreen_viewイベント\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":15383,"uuid":"1e8c519d58868a923aac","banReason":null,"adventCalendarItem":{"day":5,"calendar":{"name":"Xamarin","urlName":"xamarin","year":2018,"organization":null}},"author":{"encryptedId":"g+Y/ov0T5sg9JI8tCZ8YN6VtNyMp--hb73p9EnHsIURe31--nFRn40aYORoDdh2hdobUvg==","originalId":236182,"description":"","facebookUrl":null,"githubUrl":"https://github.com/f-miyu","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://avatars3.githubusercontent.com/u/30921389?v=4","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars3.githubusercontent.com%2Fu%2F30921389%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=e3e4abd8778ce741157ab428e941a32b","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars3.githubusercontent.com%2Fu%2F30921389%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=577180113908bb91b5e3130a00cdc1c3","urlName":"f-miyu","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[{"node":{"encryptedId":"Ibo7ipLud74Tf2BwrBCzvZceOudQ5IXtPH8=--TanGOtBKxbX9XxAn--RzLAZ3oJn4upEy0Nhs+fkg==","isBetaReleaseEnabled":false,"isFollowableByViewer":false,"isFollowedByViewer":false,"name":"アステリア株式会社","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/86cadb9936fa4faf01e75c0df408cc4aa7dab1b9/original.jpg?1554888558","urlName":"asteria","description":"データ連携ソフトのASTERIA Warp、コンテンツ管理システムのHandbook、モバイルアプリ作成サービスPlatio、AI/IoTのエッジウェアGravioなどを開発しています","url":"https://asteria.com"}}]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Xamarin","urlName":"xamarin"},{"name":"Xamarin.Forms","urlName":"xamarin.forms"},{"name":"Firebase","urlName":"firebase"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
