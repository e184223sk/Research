<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Unity ML-Agentsでターン制ゲームを作る - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/tetr4lab/items/b02eca793336ed63429f" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="9HZW8dl5qSso0C7Kp4SNi46uiccecR2O4XbKtF/dim+dKjbDjObTWYLnlN2iWlJ+nMG0cx5M0N+hkQ5LnVt4GQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="Unity ML-Agentsでターン制ゲームを作る - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhrZ1RVd3RRV2RsYm5SejQ0R240NEtfNDRPODQ0T3o1WWkyNDRLeTQ0Tzg0NE9nNDRLUzVMMmM0NEtMJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTlmY2Q3MzA4MDBiMjc4MzQ4MDg3NDE0ZWM3YmRjZTRm&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSFJsZEhJMGJHRmkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz00YmVkYjBiMGY5N2E1M2UyYzkwNWU2MmY2NmU1ZTRhMw&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=cd59c99e1a1b8c95dc13f190255e8fe1"><meta property="og:description" content="機械学習を使って、人間対機械で対局可能なリバーシを作りました。




前提


環境


Unity 2019.4.11f1 (LTS)
ML Agents 1.3.0 (Preview)
ML Agents Extension 0..."><meta content="https://qiita.com/tetr4lab/items/b02eca793336ed63429f" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,MachineLearning,強化学習,ML-Agents" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-89c2a018-48b2-43aa-9ce2-b99eef79b22d"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Ftetr4lab%2Fitems%2Fb02eca793336ed63429f">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Ftetr4lab%2Fitems%2Fb02eca793336ed63429f">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-89c2a018-48b2-43aa-9ce2-b99eef79b22d">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-09-07T15:42:10.000+09:00","dateModified":"2020-10-09T00:54:41.000+09:00","headline":"Unity ML-Agentsでターン制ゲームを作る","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhrZ1RVd3RRV2RsYm5SejQ0R240NEtfNDRPODQ0T3o1WWkyNDRLeTQ0Tzg0NE9nNDRLUzVMMmM0NEtMJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTlmY2Q3MzA4MDBiMjc4MzQ4MDg3NDE0ZWM3YmRjZTRm\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSFJsZEhJMGJHRmkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz00YmVkYjBiMGY5N2E1M2UyYzkwNWU2MmY2NmU1ZTRhMw\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=cd59c99e1a1b8c95dc13f190255e8fe1","mainEntityOfPage":"https://qiita.com/tetr4lab/items/b02eca793336ed63429f","author":{"@type":"Person","address":"日本","email":null,"identifier":"tetr4lab","name":"tetr4lab","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F365845%2Ff29fec2e030a0c6a0c459dd302a7da3cbf40f657%2Fx_large.png%3F1603867182?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13395485ff2633fad67944592432eade","url":"https://qiita.com/tetr4lab","description":"自分がネットから受け取ってきたような価値を僅かでもネットに返せたらと思っています。\r\nUnityで、主に1人で作っています。\r\n受託開発もいたします。\r\n業務外のご提案も歓迎いたします。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tetr4lab","type":"items","id":"b02eca793336ed63429f"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tetr4lab","type":"items","id":"b02eca793336ed63429f"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tetr4lab","type":"items","id":"b02eca793336ed63429f"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/tetr4lab/items/b02eca793336ed63429f","location":"/tetr4lab/items/b02eca793336ed63429f","scheme":"https","host":"qiita.com","port":null,"pathname":"/tetr4lab/items/b02eca793336ed63429f","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"m5IfM+YYvgaNg7J/NboZUeZJQOlzqiIHjtlmRdEdvCnyzn8Bs4fEdCe0CGgwZMak9CZ9XXOX71bOPqK6E5tOXw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-c332266e-2bb2-41ce-b1a6-162338891072"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/tetr4lab/items/b02eca793336ed63429f/likers" class="css-1iupg5d">5</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">8</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/b02eca793336ed63429f/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/tetr4lab/items/b02eca793336ed63429f/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/tetr4lab/items/b02eca793336ed63429f/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/tetr4lab/items/b02eca793336ed63429f/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/tetr4lab/items/b02eca793336ed63429f.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/tetr4lab"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/365845/f29fec2e030a0c6a0c459dd302a7da3cbf40f657/x_large.png?1603867182" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/tetr4lab" class="css-10ougpm">@<!-- -->tetr4lab</a><div class="css-1ay9vb9"><span><meta content="2020-09-07T06:42:10Z"/><time dateTime="2020-10-08T15:54:41Z" class="css-m19uds">updated at 2020-10-08</time></span></div></div></div></div></div><h1 class="css-cgzq40">Unity ML-Agentsでターン制ゲームを作る</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/machinelearning" class="css-4czcte">MachineLearning</a><a href="/tags/%e5%bc%b7%e5%8c%96%e5%ad%a6%e7%bf%92" class="css-4czcte">強化学習</a><a href="/tags/ml-agents" class="css-4czcte">ML-Agents</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>機械学習を使って、人間対機械で対局可能なリバーシを作りました。</p>

<p><a href="https://camo.qiitausercontent.com/cbb3dbefedf83d92a5f41278ac41d7ee785fa04c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3336353834352f62373765333861372d353930652d353865632d643332642d6366336436653136353331302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2Fb77e38a7-590e-58ec-d32d-cf3d6e165310.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=18b0e8fd56f1d6218a4f738b7247742f" alt="training_scene.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/365845/b77e38a7-590e-58ec-d32d-cf3d6e165310.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2Fb77e38a7-590e-58ec-d32d-cf3d6e165310.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=78c829be9c03efecca80e1b1b10514d3 1x" loading="lazy"></a></p>

<h1>
<span id="前提" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90"><i class="fa fa-link"></i></a>前提</h1>

<h3>
<span id="環境" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>環境</h3>

<ul>
<li>Unity 2019.4.11f1 (LTS)</li>
<li>ML Agents 1.3.0 (Preview)</li>
<li>ML Agents Extension 0.0.1 (Preview)</li>
<li>Anaconda Python 3.8</li>
<li>Windows 10</li>
</ul>

<h3>
<span id="記事の範囲" class="fragment"></span><a href="#%E8%A8%98%E4%BA%8B%E3%81%AE%E7%AF%84%E5%9B%B2"><i class="fa fa-link"></i></a>記事の範囲</h3>

<ul>
<li>ML-Agentsをターン制ゲームへ応用できることを実証します。

<ul>
<li>具体的には、人間対機械で対局可能なリバーシを作成します。</li>
<li>参考

<ul>
<li>
<a href="https://blogs.unity3d.com/jp/2020/02/28/training-intelligent-adversaries-using-self-play-with-ml-agents/" rel="nofollow noopener" target="_blank">ML-Agents のセルフプレイを使用したインテリジェントな対戦相手のトレーニング</a> (公式 Unity Blog)</li>
</ul>
</li>
</ul>
</li>
<li>リバーシの戦術については、この記事では扱いません。

<ul>
<li>筆者は、今回初めてリバーシのルールを正確に把握しました。</li>
<li>セオリーとして知っているのは四隅や四辺を取ると有利という程度のド素人です。</li>
</ul>
</li>
<li>ML-Agentsの基礎については、この記事では扱いません。

<ul>
<li>下敷きとなる記事 ⇒ <a href="https://qiita.com/tetr4lab/items/cb698b1171ae52430ba9" id="reference-1bdc401a959648c0cdd3">「Unity ML-Agentsを試してみた」</a>
</li>
<li>リソースについても、上の記事を参照してください。</li>
</ul>
</li>
</ul>

<h1>
<span id="アセットの入手" class="fragment"></span><a href="#%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E5%85%A5%E6%89%8B"><i class="fa fa-link"></i></a>アセットの入手</h1>

<ul>
<li>ダウンロード ⇒ <a href="https://github.com/tetr4lab/mla-Reversi/archive/master.zip" rel="nofollow noopener" target="_blank">mla-Reversi.zip (GitHub)</a>

<ul>
<li>下記リポジトリの一括ダウンロードです。</li>
</ul>
</li>
<li>リポジトリ ⇒ <a href="https://github.com/tetr4lab/mla-Reversi" rel="nofollow noopener" target="_blank">mla-Reversi (GitHub)</a>

<ul>
<li>プロジェクトの全てのソースとUnityの設定ファイルやトレーニングの構成ファイルを含みます。</li>
</ul>
</li>
<li>Android App ⇒ <a href="https://play.google.com/store/apps/details?id=jp.nyanta.tetr4lab.aireversi" rel="nofollow noopener" target="_blank">AI-Reversi (Google Play)</a>

<ul>
<li>人間対機械で対局できるようにAndroid向けにビルドしただけのものです。</li>
<li>広告、アナリティクス、必要な権限などはありません。</li>
</ul>
</li>
</ul>

<h1>
<span id="このプロジェクトで扱うリバーシのルール" class="fragment"></span><a href="#%E3%81%93%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%A7%E6%89%B1%E3%81%86%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%81%AE%E3%83%AB%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>このプロジェクトで扱うリバーシのルール</h1>

<ul>
<li>8×8マスの正方形の盤を使用して、黒と白に分かれ石を交互に置いていきます。

<ul>
<li>黒が先手です。</li>
<li>盤中央には、あらかじめ、各色2個(計4個)の石を市松配置で置いておきます。</li>
</ul>
</li>
<li>新たに置かれる石と同色の石に直線上で挟まれた他色の石は色が反転します。

<ul>
<li>縦横斜め方向に複数同時に挟むことができます。</li>
</ul>
</li>
<li>挟んで反転可能な石のあるマスにしか石を置けません。

<ul>
<li>置けるマスがない場合は手番がパスされて相手の手番になります。</li>
</ul>
</li>
<li>両者とも石が置けるマスがなくなったら終局となり、色の多い方が勝者となります。</li>
</ul>

<h1>
<span id="学習環境の設計" class="fragment"></span><a href="#%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E8%A8%AD%E8%A8%88"><i class="fa fa-link"></i></a>学習環境の設計</h1>

<ul>
<li>マスの基礎状態として「空、黒、白」の3値を正規化し、8×8=64マスをリニアに並べて(0~63)観測させます。

<ul>
<li>マスの状態を5値(空、黒、白、黒可、白可)として観測させる方法も考えられます。</li>
</ul>
</li>
<li>離散アクションスペースとして、石を置くマスのリニアインデックス(0~63)を使います。</li>
<li>ルール的に置けないマスをマスクして、行動の無駄を省きます。

<ul>
<li>行動を制限せず、置けないマスを選んだらマイナス報酬を与えて、ルールから学習させる方法も考えられます。</li>
</ul>
</li>
<li>一手ごとに微かな報酬を加え、勝利した場合は最大報酬、敗北した場合は最低報酬に置き換えます。

<ul>
<li>「強化学習の報酬は、結果に対して与える」ものなので、取ったマスの価値や一時的なスコアは考慮しません。</li>
</ul>
</li>
</ul>

<h1>
<span id="アプリの概略設計" class="fragment"></span><a href="#%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E6%A6%82%E7%95%A5%E8%A8%AD%E8%A8%88"><i class="fa fa-link"></i></a>アプリの概略設計</h1>

<h3>
<span id="目的" class="fragment"></span><a href="#%E7%9B%AE%E7%9A%84"><i class="fa fa-link"></i></a>目的</h3>

<ul>
<li>ML-Agentsのターン制ゲームへの応用を検証します。

<ul>
<li>そのため、ユーザを楽しませるための機能は実装しません。(リバーシの対局自体は楽しめます。)</li>
</ul>
</li>
</ul>

<h3>
<span id="クラス構成" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%B9%E6%A7%8B%E6%88%90"><i class="fa fa-link"></i></a>クラス構成</h3>

<ul>
<li>論理層 <code>namespace ReversiLogic</code>

<ul>
<li>論理ゲーム <code>class Reversi</code>

<ul>
<li>論理盤面の制御、ターンの制御、対局の制御</li>
</ul>
</li>
<li>論理盤面 <code>class Board</code>

<ul>
<li>論理マスの制御、マスの状態(空、黒、白、黒可、白可)の判定、局面(黒可、白可、終局)の判定、ルールの制御</li>
</ul>
</li>
<li>論理マス <code>class Square</code>

<ul>
<li>マスの基礎状態(空、黒、白)の制御、石を設置した順序の記録</li>
</ul>
</li>
</ul>
</li>
<li>物理層 <code>namespace ReversiGame</code>

<ul>
<li>ローダー <code>class Loader</code>

<ul>
<li>物理ゲームの構築と制御、モードの制御、コマンドラインの処理</li>
</ul>
</li>
<li>物理ゲーム <code>class Game</code>

<ul>
<li>物理盤面の構築と制御、ゲームの制御、エージェントとの通信</li>
</ul>
</li>
<li>物理盤面 'class BaordObject'

<ul>
<li>物理マスの構築と制御、ステータス表示、オプションUIの制御</li>
</ul>
</li>
<li>物理マス <code>class SquareObject</code>

<ul>
<li>論理マス状態の表示、クリックの受付</li>
</ul>
</li>
<li>確認ダイアログ <code>class Confirm</code>

<ul>
<li>再初期化などの確認UIの制御</li>
</ul>
</li>
<li>リバーシエージェント <code>class ReversiAgent</code>

<ul>
<li>
<code>Unity.MLAgents.Agents</code>のサブクラス</li>
</ul>
</li>
</ul>
</li>
</ul>

<p><a href="https://camo.qiitausercontent.com/0b1410fc28e000542b751570ba6f818da7f07ed6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3336353834352f35366666666663612d643162632d393834622d306436372d6539323636653332613538632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F56ffffca-d1bc-984b-0d67-e9266e32a58c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2b10a5fef78600a457a4c4ca51c36154" alt="mla-Reversi.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/365845/56ffffca-d1bc-984b-0d67-e9266e32a58c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F56ffffca-d1bc-984b-0d67-e9266e32a58c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1a1a8fc7ebb00d96732004823138e9ad 1x" loading="lazy"></a></p>

<h1>
<span id="段階的な実装" class="fragment"></span><a href="#%E6%AE%B5%E9%9A%8E%E7%9A%84%E3%81%AA%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>段階的な実装</h1>

<ol>
<li>論理層を実装して、ログ出力によって動作を確認します。</li>
<li>物理層を実装して、論理層の挙動をゲーム画面で確認可能にします。</li>
<li>物理層を拡張して、人間対人間プレイの挙動を確認可能にします。</li>
<li>エージェントを実装して、機械対機械プレイを可能にします。</li>
<li>学習を実施します。</li>
<li>学習結果を取り込んで、人間対機械プレイを可能にします。</li>
<li>スコアの表示や手番の選択など、人間対機械プレイ用のUIを整備します。</li>
<li>思考の練度を評価し、トレーニングの構成を試行錯誤します。</li>
</ol>

<p>1~7は1日でできましたが、8は際限なくかかります。</p>

<h1>
<span id="実装された仕様" class="fragment"></span><a href="#%E5%AE%9F%E8%A3%85%E3%81%95%E3%82%8C%E3%81%9F%E4%BB%95%E6%A7%98"><i class="fa fa-link"></i></a>実装された仕様</h1>

<h3>
<span id="機能" class="fragment"></span><a href="#%E6%A9%9F%E8%83%BD"><i class="fa fa-link"></i></a>機能</h3>

<ul>
<li>人間対機械(プレイモード)と機械対機械 (トレーニングモード)のみで、相手を選択するUIはありません。

<ul>
<li>起動時にモードを切り替えられます。 (コマンドライン引数)</li>
<li>内部機構的には人間対人間も可能です。 (エージェントのパラメータを双方とも<code>BehaviorType.HeuristicOnly</code>に固定)</li>
</ul>
</li>
<li>プレイモード

<ul>
<li>先手/後手の選択が可能です。 (UIで選択)</li>
<li>次にコマの置けるマスと、コマを置いた順番が表示可能です。 (UIで切り替え)</li>
<li>「待った」が可能です。</li>
</ul>
</li>
<li>トレーニングモード

<ul>
<li>画面を更新しません。 (UIで切り替え)</li>
<li>起動時に使用する盤面数を指定できます。 (コマンドライン引数)</li>
</ul>
</li>
<li>次の手番、最後に置いたコマ、現在のコマ数、累積勝敗数が随時表示されます。</li>
<li>勝敗数が蓄積されます。

<ul>
<li>「黒と白」、「人間と機械」、「チームの別」が独立して記録され、状況に合わせた一つが表示されます。

<ul>
<li>3種全てを確認可能です。(UIで切り替え)</li>
</ul>
</li>
</ul>
</li>
<li>局面や棋譜のセーブはできません。</li>
</ul>

<h3>
<span id="コマンドライン引数" class="fragment"></span><a href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E5%BC%95%E6%95%B0"><i class="fa fa-link"></i></a>コマンドライン引数</h3>

<ul>
<li>
<code>-trainer</code>

<ul>
<li>トレーニングモードで起動します。デフォルトはプレイモードです。</li>
</ul>
</li>
<li>
<code>-player</code>

<ul>
<li>プレイモードで起動します。デフォルトはプレイモードです。</li>
<li>デフォルトを変更しない限り不要です。</li>
</ul>
</li>
<li>
<code>-width &lt;整数&gt;</code>

<ul>
<li>トレーニング時に横に並べる盤面の数です。デフォルトは<code>7</code>です。</li>
</ul>
</li>
<li>
<code>-height &lt;整数&gt;</code>

<ul>
<li>トレーニング時に縦に並べる盤面の数です。デフォルトは<code>7</code>です。</li>
</ul>
</li>
<li>
<code>-change</code>

<ul>
<li>トレーニング時に一局毎の手番の切り替えを行います。デフォルトは切り替えます。</li>
<li>デフォルトを変更しない限り不要です。</li>
</ul>
</li>
<li>
<code>-fix</code>

<ul>
<li>トレーニング時に手番を固定します。デフォルトは切り替えます。</li>
</ul>
</li>
</ul>

<p>なお、エディタでトレーニングする場合のために、<code>TRAINER_TEST</code>シンボルで、コマンドライン引数のシミュレーションが可能です。</p>

<h3>
<span id="思考の評価" class="fragment"></span><a href="#%E6%80%9D%E8%80%83%E3%81%AE%E8%A9%95%E4%BE%A1"><i class="fa fa-link"></i></a>思考の評価</h3>

<ul>
<li>私は、勝てることもありますが、負け越してます。(弱すぎて評価不能)</li>
<li>複数の難易度が選べる無料アプリと対局させたところ、最弱レベルに辛勝する程度でした。(弱い)</li>
</ul>

<h1>
<span id="制御機構概要" class="fragment"></span><a href="#%E5%88%B6%E5%BE%A1%E6%A9%9F%E6%A7%8B%E6%A6%82%E8%A6%81"><i class="fa fa-link"></i></a>制御機構概要</h1>

<h3>
<span id="チーム" class="fragment"></span><a href="#%E3%83%81%E3%83%BC%E3%83%A0"><i class="fa fa-link"></i></a>チーム</h3>

<ul>
<li>対称な二系統の独立した行動決定が必要になるので、エージェントのインスタンスを二つ実装します。

<ul>
<li>
<code>TeamID</code>は、一方を<code>0</code>、他方を<code>1</code>に設定します。</li>
</ul>
</li>
</ul>

<h3>
<span id="先手後手" class="fragment"></span><a href="#%E5%85%88%E6%89%8B%E5%BE%8C%E6%89%8B"><i class="fa fa-link"></i></a>先手、後手</h3>

<ul>
<li>デフォルトで、エージェント<code>0</code>を白(後手)、エージェント<code>1</code>を黒(先手)に割り当てます。</li>
<li>プレイモードでは、人間がプレイする色を担当するエージェントの<code>BehaviorParameters.BehaviorType</code>を<code>HeuristicOnly</code>に、他方を<code>InferenceOnly</code>に設定します。</li>
<li>トレーニングモードでは、<code>BehaviorParameters.BehaviorType</code>は双方とも<code>InferenceOnly</code>になります。

<ul>
<li>先手･後手を交代する場合は、二つのエージェントの担当色を入れ替えます。</li>
</ul>
</li>
<li>両者とも人間(<code>HeuristicOnly</code>)の場合は、ML-Agentsは何もしません。

<ul>
<li>単一のマウスクリックが局面に応じた手番の行動として扱われるため区別は不要です。</li>
</ul>
</li>
</ul>

<h3>
<span id="ターン" class="fragment"></span><a href="#%E3%82%BF%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>ターン</h3>

<ul>
<li>物理ゲームの<code>Update ()</code>で、ターンを回します。

<ul>
<li>「物理ゲーム」コンポーネントは、一種のステートマシンを構成していて、以下は「プレイ中」ステータスの場合の処理です。</li>
<li>前のターンを担ったエージェントが処理を終えて担当から外れる(<code>TurnAgent == null</code>)まで待ちます。</li>
<li>局面をチェックして終局していたら、「プレイ中」ステータスを終えて「終局」へ移行します。</li>
<li>次のターンを担うエージェントを算定して担当者に設定します。

<ul>
<li><code>TurnAgent = IsBlackTurn ? BlackAgent : WhiteAgent;</code></li>
</ul>
</li>
<li>ターンの担当エージェントに行動決定を要求します。

<ul>
<li>要求を受けてエージェント側で観測と行動が順次行われます。(<a href="#%E5%AD%A6%E7%BF%92%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB">学習サイクル</a>)</li>
<li>ターンの全ての処理が終了すると自ら担当を外れます。

<ul>
<li><code>game.TurnAgent = null;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

<h3>
<span id="マスと盤面" class="fragment"></span><a href="#%E3%83%9E%E3%82%B9%E3%81%A8%E7%9B%A4%E9%9D%A2"><i class="fa fa-link"></i></a>マスと盤面</h3>

<ul>
<li>盤面は8×8マスのマトリクスですが、リニアに0~63のインデックスでもアクセスできるようにしています。</li>
<li>個々のマスは、石がない、黒石がある、白石があるという3種の基礎状態があり、石がない場合には、石は置けない、黒石が置ける、白石が置ける、黒石でも白石でも置けるという4種の拡張状態が存在します。</li>
<li>また、盤面全体の状態として、終局、黒石が置ける、白石が置ける、黒石でも白石でも置けるという4種の状態が存在します。</li>
<li>さらに、盤面には、白黒どちらのターンであるかという情報が存在します。</li>
<li>黒のターンで黒石が置けないなら、黒はパスすることになります。</li>
</ul>

<h1>
<span id="エージェントのコードと解説" class="fragment"></span><a href="#%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E8%A7%A3%E8%AA%AC"><i class="fa fa-link"></i></a>エージェントのコードと解説</h1>

<h3>
<span id="学習サイクル" class="fragment"></span><a href="#%E5%AD%A6%E7%BF%92%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB"><i class="fa fa-link"></i></a>学習サイクル</h3>

<ul>
<li>ターンが廻ってきたエージェントにゲーム制御側から決定要求<code>RequestDecision ()</code>が届きます。</li>
<li>エピソード(=対局)が開始されていない場合、エピソードの開始<code>OnEpisodeBegin ()</code>が呼ばれます。</li>
<li>環境の観測<code>CollectObservations ()</code>が呼ばれ、マスの状態がスキャンされます。</li>
<li>行動のマスク<code>CollectDiscreteActionMasks ()</code>が呼ばれ、ルール上選択できない行動がマスクされます。</li>
<li>行動の割り当て<code>OnActionReceived ()</code>が呼ばれ、石を置くかパスします。

<ul>
<li>行動に応じた一時報酬を与えます。</li>
</ul>
</li>
<li>終局するとゲーム制御側から<code>OnEnd ()</code>が呼ばれます。

<ul>
<li>結果に応じた最終報酬を与えます。</li>
<li>エピソードの終結<code>EndEpisode ()</code>を行います。</li>
</ul>
</li>
</ul>

<h3>
<span id="class-reversiagent-リバーシエージェント" class="fragment"></span><a href="#class-reversiagent-%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88"><i class="fa fa-link"></i></a><code>class ReversiAgent</code> リバーシ・エージェント</h3>

<ul>
<li>これは、リバーシの思考を担う<code>Agent</code>のサブクラスです。

<ul>
<li>
<code>Agent</code>は<code>MonoBehaviour</code>のサブクラスです。</li>
</ul>
</li>
<li>一つの物理ゲームに、黒と白を担当する二つの<code>ReversiAgent</code>インスタンスが作られます。</li>
<li>本来は、エージェント自身がゲームの進行を制御するのでしょうが、このプロジェクトでは外部で進行が制御され、エージェントは思考のみを担うようになっています。</li>
</ul>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">ReversiAgent.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Unity.MLAgents</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Unity.MLAgents.Sensors</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Unity.MLAgents.Policies</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ReversiLogic</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ReversiGame</span> <span class="p">{</span>

    <span class="c1">/// &lt;summary&gt;リバーシ・エージェント&lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ReversiAgent</span> <span class="p">:</span> <span class="n">Agent</span> <span class="p">{</span>

        <span class="c1">/// &lt;summary&gt;チーム識別子&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">enum</span> <span class="n">Team</span> <span class="p">{</span>
            <span class="n">Black</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
            <span class="n">White</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;盤面のマス数&lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">Size</span> <span class="p">=</span> <span class="n">ReversiLogic</span><span class="p">.</span><span class="n">Board</span><span class="p">.</span><span class="n">Size</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;物理ゲーム&lt;/summary&gt;</span>
        <span class="k">private</span> <span class="n">Game</span> <span class="n">game</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;論理ゲーム&lt;/summary&gt;</span>
        <span class="k">private</span> <span class="n">Reversi</span> <span class="n">reversi</span> <span class="p">=&gt;</span> <span class="n">game</span><span class="p">.</span><span class="n">Reversi</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;挙動パラメータ&lt;/summary&gt;</span>
        <span class="k">private</span> <span class="n">BehaviorParameters</span> <span class="n">Parameters</span> <span class="p">=&gt;</span> <span class="n">_parameters</span> <span class="p">??</span> <span class="p">(</span><span class="n">_parameters</span> <span class="p">=</span> <span class="n">gameObject</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">BehaviorParameters</span><span class="p">&gt;</span> <span class="p">());</span>
        <span class="k">private</span> <span class="n">BehaviorParameters</span> <span class="n">_parameters</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;チームID&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">TeamId</span> <span class="p">=&gt;</span> <span class="n">Parameters</span><span class="p">.</span><span class="n">TeamId</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;チームカラー&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="n">Team</span> <span class="n">TeamColor</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="c1">/// &lt;summary&gt;黒である&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsBlack</span> <span class="p">=&gt;</span> <span class="n">TeamColor</span> <span class="p">==</span> <span class="n">Team</span><span class="p">.</span><span class="n">Black</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;白である&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsWhite</span> <span class="p">=&gt;</span> <span class="n">TeamColor</span> <span class="p">==</span> <span class="n">Team</span><span class="p">.</span><span class="n">White</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;自分が優勢&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">IWinner</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">TeamColor</span> <span class="p">==</span> <span class="n">Team</span><span class="p">.</span><span class="n">Black</span> <span class="p">&amp;&amp;</span> <span class="n">reversi</span><span class="p">.</span><span class="n">BlackWin</span><span class="p">)</span> <span class="p">||</span> <span class="p">(</span><span class="n">TeamColor</span> <span class="p">==</span> <span class="n">Team</span><span class="p">.</span><span class="n">White</span> <span class="p">&amp;&amp;</span> <span class="n">reversi</span><span class="p">.</span><span class="n">WhiteWin</span><span class="p">);</span>
        <span class="c1">/// &lt;summary&gt;自分が劣勢&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">ILoser</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">TeamColor</span> <span class="p">==</span> <span class="n">Team</span><span class="p">.</span><span class="n">Black</span> <span class="p">&amp;&amp;</span> <span class="n">reversi</span><span class="p">.</span><span class="n">WhiteWin</span><span class="p">)</span> <span class="p">||</span> <span class="p">(</span><span class="n">TeamColor</span> <span class="p">==</span> <span class="n">Team</span><span class="p">.</span><span class="n">White</span> <span class="p">&amp;&amp;</span> <span class="n">reversi</span><span class="p">.</span><span class="n">BlackWin</span><span class="p">);</span>

        <span class="c1">/// &lt;summary&gt;VectorAction Branch 0 Size&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">Passable</span> <span class="p">=&gt;</span> <span class="n">Parameters</span><span class="p">.</span><span class="n">BrainParameters</span><span class="p">.</span><span class="n">VectorActionSize</span> <span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">&gt;</span> <span class="n">Size</span> <span class="p">*</span> <span class="n">Size</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;挙動タイプ&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="n">BehaviorType</span> <span class="n">BehaviorType</span> <span class="p">{</span>
            <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span><span class="p">;</span>
            <span class="k">set</span> <span class="p">=&gt;</span> <span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;人間が操作&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsHuman</span> <span class="p">{</span>
            <span class="k">get</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">==</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">HeuristicOnly</span><span class="p">);</span>
            <span class="k">set</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">reversi</span><span class="p">.</span><span class="n">IsEnd</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">=</span> <span class="k">value</span> <span class="p">?</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">HeuristicOnly</span> <span class="p">:</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">InferenceOnly</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;機械が操作 (推論時のみ)&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsMachine</span> <span class="p">{</span>
            <span class="k">get</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">!=</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">HeuristicOnly</span><span class="p">);</span>
            <span class="k">set</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">reversi</span><span class="p">.</span><span class="n">IsEnd</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">=</span> <span class="k">value</span> <span class="p">?</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">InferenceOnly</span> <span class="p">:</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">HeuristicOnly</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;トレーニング中の可能性が高い&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsTraning</span> <span class="p">=&gt;</span> <span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">==</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">Default</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;チームカラーの入れ替え (チームIDは変更しない)&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">ChangeTeam</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">reversi</span><span class="p">.</span><span class="n">IsEnd</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">TeamColor</span> <span class="p">=</span> <span class="p">(</span><span class="n">TeamColor</span> <span class="p">==</span> <span class="n">Team</span><span class="p">.</span><span class="n">Black</span><span class="p">)</span> <span class="p">?</span> <span class="n">Team</span><span class="p">.</span><span class="n">White</span> <span class="p">:</span> <span class="n">Team</span><span class="p">.</span><span class="n">Black</span><span class="p">;</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;人間と機械の入れ替え&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">ChangeActor</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">reversi</span><span class="p">.</span><span class="n">IsEnd</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">!=</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">Default</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">=</span> <span class="p">(</span><span class="n">Parameters</span><span class="p">.</span><span class="n">BehaviorType</span> <span class="p">==</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">HeuristicOnly</span><span class="p">)</span> <span class="p">?</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">InferenceOnly</span> <span class="p">:</span> <span class="n">BehaviorType</span><span class="p">.</span><span class="n">HeuristicOnly</span><span class="p">;</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;オブジェクト初期化&lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">Awake</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nf">Init</span> <span class="p">();</span>

        <span class="c1">/// &lt;summary&gt;初期化&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Init</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">game</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 一度だけ</span>
                <span class="n">game</span> <span class="p">=</span> <span class="n">GetComponentInParent</span><span class="p">&lt;</span><span class="n">Game</span><span class="p">&gt;</span> <span class="p">();</span>
                <span class="n">TeamColor</span> <span class="p">=</span> <span class="p">(</span><span class="n">Team</span><span class="p">)</span> <span class="n">TeamId</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;エピソードの開始&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnEpisodeBegin</span> <span class="p">()</span> <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span> <span class="p">(</span><span class="s">$"OnEpisodeBegin (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">): step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">game</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="n">GameState</span><span class="p">.</span><span class="n">Play</span><span class="p">)</span> <span class="p">{</span> <span class="n">Debug</span><span class="p">.</span><span class="nf">LogError</span> <span class="p">(</span><span class="s">"Not Reseted"</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;環境の観測&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">CollectObservations</span> <span class="p">(</span><span class="n">VectorSensor</span> <span class="n">sensor</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span> <span class="p">(</span><span class="s">$"CollectObservations (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">): step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">statuses</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">float</span> <span class="p">[</span><span class="n">Size</span> <span class="p">*</span> <span class="n">Size</span><span class="p">];</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">Size</span> <span class="p">*</span> <span class="n">Size</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span>
                <span class="c1">//statuses [i] = (float) reversi [i].Status; // 正規化なし、基本</span>
                <span class="n">statuses</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">reversi</span> <span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Status</span> <span class="p">/</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">SquareStatus</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">;</span> <span class="c1">// 正規化あり、基本</span>
                <span class="c1">//statuses [i] = (float) reversi.SquareStatus (i) / (float) SquareStatus.MaxValue; // 正規化あり、拡張</span>
            <span class="p">}</span>
            <span class="n">sensor</span><span class="p">.</span><span class="nf">AddObservation</span> <span class="p">(</span><span class="n">statuses</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;行動のマスク&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">CollectDiscreteActionMasks</span> <span class="p">(</span><span class="n">DiscreteActionMasker</span> <span class="n">actionMasker</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span> <span class="p">(</span><span class="s">$"CollectDiscreteActionMasks (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">): step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">actionIndices</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">};</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">Size</span> <span class="p">*</span> <span class="n">Size</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span>
                <span class="kt">var</span> <span class="n">status</span> <span class="p">=</span> <span class="n">reversi</span><span class="p">.</span><span class="nf">SquareStatus</span> <span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">IsBlack</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">status</span><span class="p">.</span><span class="nf">BlackEnable</span> <span class="p">())</span> <span class="p">||</span> <span class="p">(</span><span class="n">IsWhite</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">status</span><span class="p">.</span><span class="nf">WhiteEnable</span> <span class="p">()))</span> <span class="p">{</span> <span class="c1">// 自分が置けない場所</span>
                    <span class="n">actionIndices</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">Passable</span> <span class="p">&amp;&amp;</span> <span class="n">reversi</span><span class="p">.</span><span class="n">TurnEnable</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 打てるならパスできない</span>
                <span class="n">actionIndices</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span><span class="n">Size</span> <span class="p">*</span> <span class="n">Size</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">actionMasker</span><span class="p">.</span><span class="nf">SetMask</span> <span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">actionIndices</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// 例外</span>
        <span class="k">public</span> <span class="k">class</span> <span class="nc">AgentMismatchException</span> <span class="p">:</span> <span class="n">Exception</span> <span class="p">{</span> <span class="p">}</span>
        <span class="k">public</span> <span class="k">class</span> <span class="nc">TeamMismatchException</span> <span class="p">:</span> <span class="n">Exception</span> <span class="p">{</span> <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;行動と報酬の割り当て&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnActionReceived</span> <span class="p">(</span><span class="kt">float</span> <span class="p">[]</span> <span class="n">vectorAction</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span> <span class="p">(</span><span class="s">$"OnActionReceived (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">) [</span><span class="p">{</span><span class="n">vectorAction</span> <span class="p">[</span><span class="m">0</span><span class="p">]}</span><span class="s">]: step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">IsMachine</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">var</span> <span class="n">index</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">FloorToInt</span> <span class="p">(</span><span class="n">vectorAction</span> <span class="p">[</span><span class="m">0</span><span class="p">]);</span> <span class="c1">// 整数化</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">==</span> <span class="n">Size</span> <span class="p">*</span> <span class="n">Size</span><span class="p">)</span> <span class="p">{</span> <span class="n">index</span> <span class="p">=</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// パス</span>
                <span class="k">try</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">TurnAgent</span> <span class="p">!=</span> <span class="k">this</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">AgentMismatchException</span> <span class="p">();</span> <span class="c1">// エージェントの不一致</span>
                    <span class="k">if</span> <span class="p">((</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">&amp;&amp;</span> <span class="n">TeamColor</span> <span class="p">!=</span> <span class="n">Team</span><span class="p">.</span><span class="n">Black</span><span class="p">)</span> <span class="p">||</span> <span class="p">(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsWhiteTurn</span> <span class="p">&amp;&amp;</span> <span class="n">TeamColor</span> <span class="p">!=</span> <span class="n">Team</span><span class="p">.</span><span class="n">White</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">TeamMismatchException</span> <span class="p">();</span> <span class="c1">// 手番とチームの不整合</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">reversi</span><span class="p">.</span><span class="nf">Enable</span> <span class="p">(</span><span class="n">index</span><span class="p">))</span> <span class="p">{</span>
                        <span class="n">game</span><span class="p">.</span><span class="nf">Move</span> <span class="p">(</span><span class="n">index</span><span class="p">);</span>
                        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span> <span class="p">(</span><span class="s">$"Moved (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">) [</span><span class="p">{</span><span class="n">index</span><span class="p">}</span><span class="s">]: step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                        <span class="nf">AddReward</span> <span class="p">((</span><span class="n">index</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">?</span> <span class="p">-</span><span class="m">0.0006f</span> <span class="p">:</span> <span class="p">-</span><span class="m">0.0003f</span><span class="p">);</span> <span class="c1">// パス、通常</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="n">Debug</span><span class="p">.</span><span class="nf">LogWarning</span> <span class="p">(</span><span class="s">$"DisableMove (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">) [</span><span class="p">{</span><span class="n">index</span><span class="p">}</span><span class="s">]: step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">\n</span><span class="p">{</span><span class="n">reversi</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                        <span class="nf">AddReward</span> <span class="p">(-</span><span class="m">0.001f</span><span class="p">);</span> <span class="c1">// 置けない</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">AgentMismatchException</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nf">EndEpisode</span> <span class="p">();</span>
                    <span class="n">Debug</span><span class="p">.</span><span class="nf">LogError</span> <span class="p">(</span><span class="s">$"Agent mismatch (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">): Step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, Turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, Status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">\n</span><span class="p">{</span><span class="n">reversi</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">TeamMismatchException</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nf">EndEpisode</span> <span class="p">();</span>
                    <span class="n">Debug</span><span class="p">.</span><span class="nf">LogWarning</span> <span class="p">(</span><span class="s">$"Team mismatch (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">): Step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, Turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, Status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">\n</span><span class="p">{</span><span class="n">reversi</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
                    <span class="n">game</span><span class="p">.</span><span class="n">TurnAgent</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span> <span class="c1">// 要求を抹消</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">Debug</span><span class="p">.</span><span class="nf">LogError</span> <span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">Agent is not Human: step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;終局処理と最終的な報酬の割り当て&lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">OnEnd</span> <span class="p">()</span> <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span> <span class="p">(</span><span class="s">$"AgentOnEnd (</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">, </span><span class="p">{(</span><span class="n">IWinner</span> <span class="p">?</span> <span class="s">"winner"</span> <span class="p">:</span> <span class="n">ILoser</span> <span class="p">?</span> <span class="s">"loser"</span> <span class="p">:</span> <span class="s">"draw"</span><span class="p">)}</span><span class="s">): step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">IsMachine</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">IWinner</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nf">SetReward</span> <span class="p">(</span><span class="m">1.0f</span><span class="p">);</span> <span class="c1">// 勝利報酬</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ILoser</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nf">SetReward</span> <span class="p">(-</span><span class="m">1.0f</span><span class="p">);</span> <span class="c1">// 敗北報酬</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nf">SetReward</span> <span class="p">(</span><span class="m">0f</span><span class="p">);</span> <span class="c1">// 引き分け報酬</span>
                <span class="p">}</span>
                <span class="nf">EndEpisode</span> <span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">Debug</span><span class="p">.</span><span class="nf">LogError</span> <span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">TeamColor</span><span class="p">}</span><span class="s">Agent is not Human: step=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Step</span><span class="p">}</span><span class="s">, turn=</span><span class="p">{(</span><span class="n">reversi</span><span class="p">.</span><span class="n">IsBlackTurn</span> <span class="p">?</span> <span class="s">"Black"</span> <span class="p">:</span> <span class="s">"White"</span><span class="p">)}</span><span class="s">, status=</span><span class="p">{</span><span class="n">reversi</span><span class="p">.</span><span class="n">Score</span><span class="p">.</span><span class="n">Status</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="using-reversilogic-論理ゲーム" class="fragment"></span><a href="#using-reversilogic-%E8%AB%96%E7%90%86%E3%82%B2%E3%83%BC%E3%83%A0"><i class="fa fa-link"></i></a><code>using ReversiLogic;</code> 論理ゲーム</h3>

<ul>
<li>これは、論理ゲームの名前空間です。

<ul>
<li>
<code>class Reversi</code>、<code>class Board</code>、<code>class Square</code>などが含まれます。</li>
<li>ここに含まれるクラスは<code>MonoBehaviour</code>を継承せず、Unityに依存しません。</li>
</ul>
</li>
<li>リバーシのルールや盤面の状態などは、全てこの中にあります。</li>
</ul>

<h3>
<span id="namespace-reversigame-物理ゲーム" class="fragment"></span><a href="#namespace-reversigame-%E7%89%A9%E7%90%86%E3%82%B2%E3%83%BC%E3%83%A0"><i class="fa fa-link"></i></a><code>namespace ReversiGame</code> 物理ゲーム</h3>

<ul>
<li>これは、物理ゲームの名前空間で、画面表示とUIが含まれます。

<ul>
<li>
<code>class Loader</code>、<code>class Game</code>、<code>class Board</code>、<code>class Square</code>などが含まれます。</li>
<li>ここに含まれるクラスは<code>MonoBehaviour</code>を継承したUnityコンポーネントです。</li>
</ul>
</li>
</ul>

<h3>
<span id="enum-teamcolor-チーム識別子" class="fragment"></span><a href="#enum-teamcolor-%E3%83%81%E3%83%BC%E3%83%A0%E8%AD%98%E5%88%A5%E5%AD%90"><i class="fa fa-link"></i></a><code>enum TeamColor</code> チーム識別子</h3>

<ul>
<li>ML-Agentsでは、複数のチームに分かれて対戦や対局が可能なように、エージェントの挙動パラメータに<code>TeamId</code>という整数値があります。</li>
<li>このプロジェクトでは、黒のチームと白のチーム(各ひとつのエージェント)があります。

<ul>
<li>トレーニング時、先手と後手それぞれの担当エージェントの<code>TeamId</code>は固定されています。これは、バックエンド側で担当チームの交代が行われることを前提にしているためです。</li>
</ul>
</li>
<li>これは、<code>TeamId</code>の数値に合わせたシンボルです。</li>
</ul>

<h3>
<span id="bool-passable-パス可能" class="fragment"></span><a href="#bool-passable-%E3%83%91%E3%82%B9%E5%8F%AF%E8%83%BD"><i class="fa fa-link"></i></a><code>bool Passable</code> パス可能</h3>

<ul>
<li>行動が64種の場合は自身でパスができませんが、65種の場合は「パス可能」と判定されます。</li>
<li>
<code>BehaviorParameters.BrainParameters</code>を参照して、<code>ActionSpace0</code>のサイズを確認しています。</li>
<li>パス不能の場合は、外部でパスを制御されます。</li>
</ul>

<h3>
<span id="changeteam--チームカラーの入れ替え-チームidは変更しない" class="fragment"></span><a href="#changeteam--%E3%83%81%E3%83%BC%E3%83%A0%E3%82%AB%E3%83%A9%E3%83%BC%E3%81%AE%E5%85%A5%E3%82%8C%E6%9B%BF%E3%81%88-%E3%83%81%E3%83%BC%E3%83%A0id%E3%81%AF%E5%A4%89%E6%9B%B4%E3%81%97%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a><code>ChangeTeam ()</code> チームカラーの入れ替え (チームIDは変更しない)</h3>

<ul>
<li>これは、先手と後手(黒と白)を交代する仕組みのひとつで、<code>TeamId</code>の担当する色を入れ替えます。

<ul>
<li>「エージェント0 = 白担当、エージェント1 = 黒担当」⇒「エージェント0 = 黒担当、エージェント1 = 白担当」</li>
<li>
<code>TeamId</code>と<code>TeamColor</code>が一致しない状態が生じます。</li>
</ul>
</li>
<li>機械対機械の場合は、一局毎に先手後手を入れ替えています。</li>
</ul>

<h3>
<span id="changeactor--人間と機械の入れ替え" class="fragment"></span><a href="#changeactor--%E4%BA%BA%E9%96%93%E3%81%A8%E6%A9%9F%E6%A2%B0%E3%81%AE%E5%85%A5%E3%82%8C%E6%9B%BF%E3%81%88"><i class="fa fa-link"></i></a><code>ChangeActor ()</code> 人間と機械の入れ替え</h3>

<ul>
<li>これは、人間と機械の担当する色を入れ替える仕組みで、エージェントの挙動タイプを入れ替えます。

<ul>
<li>「エージェント黒 = 人間担当、エージェント白 = 機械担当」⇒「エージェント黒 = 機械担当、エージェント白 = 人間担当」</li>
</ul>
</li>
<li>エージェントの挙動タイプは、人間操作(<code>HeuristicOnly</code>)、機械推論(<code>InferenceOnly</code>)、機械学習(と推論の自動切り替え <code>Default</code>)の別です。</li>
</ul>

<h3>
<span id="init--初期化" class="fragment"></span><a href="#init--%E5%88%9D%E6%9C%9F%E5%8C%96"><i class="fa fa-link"></i></a><code>Init ()</code> 初期化</h3>

<ul>
<li>一度だけ必要な初期化を行います。</li>
<li>外部からの使用前に明示的に呼んでいますが、一応、<code>Awake ()</code>からも呼ばれます。</li>
</ul>

<h3>
<span id="onepisodebegin--エピソードの開始" class="fragment"></span><a href="#onepisodebegin--%E3%82%A8%E3%83%94%E3%82%BD%E3%83%BC%E3%83%89%E3%81%AE%E9%96%8B%E5%A7%8B"><i class="fa fa-link"></i></a><code>OnEpisodeBegin ()</code> エピソードの開始</h3>

<ul>
<li>このプロジェクトでの「エピソード」は「一局」に相当します。</li>
<li>開始していない状態で、行動の決定を要求(<code>RequestDecision ()</code>)されると、最初に呼び出されます。</li>
<li>あるいは、エピソードの終了(<code>EndEpisode ()</code>)を行うと中で呼ばれます。</li>
<li>本来はここでゲームを初期化するのですが、このプロジェクトは外部で初期化するため、チェックを行うのみで何もしていません。</li>
</ul>

<h3>
<span id="collectobservations--環境の観測" class="fragment"></span><a href="#collectobservations--%E7%92%B0%E5%A2%83%E3%81%AE%E8%A6%B3%E6%B8%AC"><i class="fa fa-link"></i></a><code>CollectObservations ()</code> 環境の観測</h3>

<ul>
<li>行動の決定を要求(<code>RequestDecision ()</code>)される毎に呼ばれます。</li>
<li>単純に盤面の8×8マスの石の配置状態を観測させます。</li>
</ul>

<h3>
<span id="collectdiscreteactionmasks--行動のマスク" class="fragment"></span><a href="#collectdiscreteactionmasks--%E8%A1%8C%E5%8B%95%E3%81%AE%E3%83%9E%E3%82%B9%E3%82%AF"><i class="fa fa-link"></i></a><code>CollectDiscreteActionMasks ()</code> 行動のマスク</h3>

<ul>
<li>環境の観測後に呼ばれ、選択不能な行動の選択肢をエージェントに示唆します。</li>
<li>ここでは、ルール上、石を置けないマスをマスクしています。</li>
<li>パス可能の場合は、石が置けるマスが存在する場合にパスをマスクしています。</li>
</ul>

<h3>
<span id="onactionreceived--行動と報酬の割り当て" class="fragment"></span><a href="#onactionreceived--%E8%A1%8C%E5%8B%95%E3%81%A8%E5%A0%B1%E9%85%AC%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6"><i class="fa fa-link"></i></a><code>OnActionReceived ()</code> 行動と報酬の割り当て</h3>

<ul>
<li>決定された行動に基づいて実際に石を打ち、その結果に応じた報酬を出します。</li>
<li>このプロジェクトでは、行動(一手)は単一のスカラー値、中身はマスのインデックス(<code>(int) 0</code>~<code>63</code>)、または、それに加えて「パス」(<code>(int) 64</code>)で表されます。</li>
<li>行動を整数値で生成するために、エージェントの挙動パラメータ<code>VectorAction SpaceType</code>に対して<code>Discrete</code>を指定しています。</li>
<li>処理のほとんどはエラーチェックで、作用としては、決定された行動「石を置く位置(マスのインデックス)」または「パス(<code>-1</code>)」を論理ゲームに渡し、微量の継続報酬を加算するだけです。

<ul>
<li>この継続報酬は、終局に至ると上書きされて捨てられます。</li>
</ul>
</li>
<li>本来は、終局の判定と勝敗に対する報酬の支払い、エピソードの終了などを、ここで処理するのですが、このプロジェクトでは<code>OnEnd ()</code>に分離しています。

<ul>
<li>人間の操作を外部で受け付けて処理している関係で、独立して呼び出せるようにしてあります。</li>
</ul>
</li>
</ul>

<h3>
<span id="onend--終局処理と最終的な報酬の割り当て" class="fragment"></span><a href="#onend--%E7%B5%82%E5%B1%80%E5%87%A6%E7%90%86%E3%81%A8%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%AA%E5%A0%B1%E9%85%AC%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6"><i class="fa fa-link"></i></a><code>OnEnd ()</code> 終局処理と最終的な報酬の割り当て</h3>

<ul>
<li>本来は、<code>OnActionReceived ()</code>の中で行われる処理ですが、人間の操作を外部で受け付けて処理している関係で分離されています。</li>
<li>終局を判定した際に外部から呼び出されます。</li>
<li>ここでの報酬は、それまでの報酬を上書きして、単純に勝てば<code>1</code>、負ければ<code>-1</code>になります。</li>
</ul>

<h3>
<span id="heuristic--人間の入力" class="fragment"></span><a href="#heuristic--%E4%BA%BA%E9%96%93%E3%81%AE%E5%85%A5%E5%8A%9B"><i class="fa fa-link"></i></a><code>Heuristic ()</code> 人間の入力</h3>

<ul>
<li>このプロジェクトでは、このメソッドを実装しません。</li>
<li>人間の操作は、エージェントの外で制御されています。</li>
<li>ML-Agentsに依存して人間の選択が必要な状況になるとエラーが生じます。</li>
</ul>

<h2>
<span id="reversiagentのbehaviorparameters" class="fragment"></span><a href="#reversiagent%E3%81%AEbehaviorparameters"><i class="fa fa-link"></i></a><code>ReversiAgent</code>の<code>BehaviorParameters</code>
</h2>

<p><a href="https://camo.qiitausercontent.com/acc9fbb258650fded2d4c9e665bce8fb506bd5cf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3336353834352f35353261653237382d306265642d343464332d633665302d3065346436326338386636642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F552ae278-0bed-44d3-c6e0-0e4d62c88f6d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=72086a0fa33c67c6f0fe90a23d77f87f" alt="スクリーンショット 2020-09-24 122654.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/365845/552ae278-0bed-44d3-c6e0-0e4d62c88f6d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F552ae278-0bed-44d3-c6e0-0e4d62c88f6d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2eb9a3fa4db5ff182d420bdea478de69 1x" loading="lazy"></a></p>

<h2>
<span id="トレーニングの構成" class="fragment"></span><a href="#%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%AE%E6%A7%8B%E6%88%90"><i class="fa fa-link"></i></a>トレーニングの構成</h2>

<p>次の記事 ⇒ <a href="https://qiita.com/tetr4lab/items/1a2f771bf657e4aaa19e" id="reference-d95184a3d7a5c59ebbdc">Unity ML-Agentsで作ったターン制ゲームを鍛える</a> (Qiita)</p>

<h1>
<span id="課題" class="fragment"></span><a href="#%E8%AA%B2%E9%A1%8C"><i class="fa fa-link"></i></a>課題</h1>

<p>以下のような課題が生じ、対処済み、あるいは、対処中です。</p>

<h3>
<span id="トレーニング時にブレインに接続できない" class="fragment"></span><a href="#%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E6%99%82%E3%81%AB%E3%83%96%E3%83%AC%E3%82%A4%E3%83%B3%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>トレーニング時にブレインに接続できない</h3>

<ul>
<li>Windows版の実行ファイルをビルドしてトレーニングする際に、'Instructions for updating: ~ non-resource variables are not supported in the long term'の後、<code>Connected to Unity environment</code>が出ず、<code>UnityEnvironment worker 0: environment stopping.</code>と出て終わってしまいます。</li>
</ul>

<h4>
<span id="対処" class="fragment"></span><a href="#%E5%AF%BE%E5%87%A6"><i class="fa fa-link"></i></a>対処</h4>

<ul>
<li>ProjectSettings&gt;Playerで、<code>ScriptingBackend</code>をデフォルトの<code>Mono</code>にしておけば接続できるようです。</li>
</ul>

<h3>
<span id="脈略なくonepisodebegin-が呼ばれる" class="fragment"></span><a href="#%E8%84%88%E7%95%A5%E3%81%AA%E3%81%8Fonepisodebegin-%E3%81%8C%E5%91%BC%E3%81%B0%E3%82%8C%E3%82%8B"><i class="fa fa-link"></i></a>脈略なく<code>OnEpisodeBegin ()</code>が呼ばれる</h3>

<ul>
<li>
<a href="#%E5%AD%A6%E7%BF%92%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB">学習サイクル</a>の途中で、ML-Agentsのバックエンド側からの制御で<code>OnEpisodeBegin ()</code>が呼ばれる場合があります。

<ul>
<li>既に<code>RequestDecision ()</code>が行われていると、過去のエピソードに対する<code>OnActionReceived ()</code>が呼ばれます。</li>
<li>盤面の初期化後に、過去の局面に対しての行動要求が届くので、不整合が生じます。</li>
</ul>
</li>
</ul>

<h5>
<span id="対処-1" class="fragment"></span><a href="#%E5%AF%BE%E5%87%A6-1"><i class="fa fa-link"></i></a>対処</h5>

<ul>
<li>
<code>config.yaml</code>の<code>threaded</code>を<code>false</code>にすれば、学習サイクル中の割り込みはなくなります。</li>
</ul>

<h3>
<span id="弱い" class="fragment"></span><a href="#%E5%BC%B1%E3%81%84"><i class="fa fa-link"></i></a>弱い</h3>

<ul>
<li>私が勝てるのだから弱いのは間違いありません。</li>
</ul>

<h5>
<span id="対処-2" class="fragment"></span><a href="#%E5%AF%BE%E5%87%A6-2"><i class="fa fa-link"></i></a>対処</h5>

<ul>
<li>
<code>TensorBoard</code>でモニターしています。</li>
<li>トレーニングの構成を見直しています。

<ul>
<li>次の記事「<a href="https://qiita.com/tetr4lab/items/1a2f771bf657e4aaa19e">Unity ML-Agentsで作ったターン制ゲームを鍛える</a>」</li>
</ul>
</li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Ftetr4lab%2Fitems%2Fb02eca793336ed63429f&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Ftetr4lab%2Fitems%2Fb02eca793336ed63429f&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/tetr4lab/items/b02eca793336ed63429f/likers" class="css-1iupg5d">5</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">8</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/b02eca793336ed63429f/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/tetr4lab/items/b02eca793336ed63429f/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/tetr4lab/items/b02eca793336ed63429f/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/tetr4lab/items/b02eca793336ed63429f/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/tetr4lab/items/b02eca793336ed63429f.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-c332266e-2bb2-41ce-b1a6-162338891072">{"authorAnalyticsTrackingId":"UA-21260747-4","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-6283f1f1-050a-44ba-af22-c49f6202241e"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-6283f1f1-050a-44ba-af22-c49f6202241e">{}</script>
      
<div id="LoginModal-react-component-7f1d9bf5-14cc-4db9-8fca-57c2b7e0be00"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-7f1d9bf5-14cc-4db9-8fca-57c2b7e0be00">{}</script>
      
<div id="StockModal-react-component-af38ba2c-e6d6-4718-a446-c6b28c1c560b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-af38ba2c-e6d6-4718-a446-c6b28c1c560b">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;DhLZGCs9M/zH4rdlStEothMsKL87ZtCsN9s8XzUKpHhnTrkqfqJJjm3VDXJPD/dDAUMVCztbHf13PPig94xWDg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e機械学習を使って、人間対機械で対局可能なリバーシを作りました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/cbb3dbefedf83d92a5f41278ac41d7ee785fa04c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3336353834352f62373765333861372d353930652d353865632d643332642d6366336436653136353331302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2Fb77e38a7-590e-58ec-d32d-cf3d6e165310.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=18b0e8fd56f1d6218a4f738b7247742f\" alt=\"training_scene.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/365845/b77e38a7-590e-58ec-d32d-cf3d6e165310.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2Fb77e38a7-590e-58ec-d32d-cf3d6e165310.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=78c829be9c03efecca80e1b1b10514d3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前提\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e環境\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eUnity 2019.4.11f1 (LTS)\u003c/li\u003e\n\u003cli\u003eML Agents 1.3.0 (Preview)\u003c/li\u003e\n\u003cli\u003eML Agents Extension 0.0.1 (Preview)\u003c/li\u003e\n\u003cli\u003eAnaconda Python 3.8\u003c/li\u003e\n\u003cli\u003eWindows 10\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"記事の範囲\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A8%98%E4%BA%8B%E3%81%AE%E7%AF%84%E5%9B%B2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e記事の範囲\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eML-Agentsをターン制ゲームへ応用できることを実証します。\n\n\u003cul\u003e\n\u003cli\u003e具体的には、人間対機械で対局可能なリバーシを作成します。\u003c/li\u003e\n\u003cli\u003e参考\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://blogs.unity3d.com/jp/2020/02/28/training-intelligent-adversaries-using-self-play-with-ml-agents/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eML-Agents のセルフプレイを使用したインテリジェントな対戦相手のトレーニング\u003c/a\u003e (公式 Unity Blog)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eリバーシの戦術については、この記事では扱いません。\n\n\u003cul\u003e\n\u003cli\u003e筆者は、今回初めてリバーシのルールを正確に把握しました。\u003c/li\u003e\n\u003cli\u003eセオリーとして知っているのは四隅や四辺を取ると有利という程度のド素人です。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eML-Agentsの基礎については、この記事では扱いません。\n\n\u003cul\u003e\n\u003cli\u003e下敷きとなる記事 ⇒ \u003ca href=\"https://qiita.com/tetr4lab/items/cb698b1171ae52430ba9\" id=\"reference-1bdc401a959648c0cdd3\"\u003e「Unity ML-Agentsを試してみた」\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eリソースについても、上の記事を参照してください。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"アセットの入手\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E5%85%A5%E6%89%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアセットの入手\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eダウンロード ⇒ \u003ca href=\"https://github.com/tetr4lab/mla-Reversi/archive/master.zip\" rel=\"nofollow noopener\" target=\"_blank\"\u003emla-Reversi.zip (GitHub)\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e下記リポジトリの一括ダウンロードです。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eリポジトリ ⇒ \u003ca href=\"https://github.com/tetr4lab/mla-Reversi\" rel=\"nofollow noopener\" target=\"_blank\"\u003emla-Reversi (GitHub)\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003eプロジェクトの全てのソースとUnityの設定ファイルやトレーニングの構成ファイルを含みます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eAndroid App ⇒ \u003ca href=\"https://play.google.com/store/apps/details?id=jp.nyanta.tetr4lab.aireversi\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAI-Reversi (Google Play)\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e人間対機械で対局できるようにAndroid向けにビルドしただけのものです。\u003c/li\u003e\n\u003cli\u003e広告、アナリティクス、必要な権限などはありません。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"このプロジェクトで扱うリバーシのルール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%93%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%A7%E6%89%B1%E3%81%86%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%81%AE%E3%83%AB%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eこのプロジェクトで扱うリバーシのルール\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e8×8マスの正方形の盤を使用して、黒と白に分かれ石を交互に置いていきます。\n\n\u003cul\u003e\n\u003cli\u003e黒が先手です。\u003c/li\u003e\n\u003cli\u003e盤中央には、あらかじめ、各色2個(計4個)の石を市松配置で置いておきます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e新たに置かれる石と同色の石に直線上で挟まれた他色の石は色が反転します。\n\n\u003cul\u003e\n\u003cli\u003e縦横斜め方向に複数同時に挟むことができます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e挟んで反転可能な石のあるマスにしか石を置けません。\n\n\u003cul\u003e\n\u003cli\u003e置けるマスがない場合は手番がパスされて相手の手番になります。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e両者とも石が置けるマスがなくなったら終局となり、色の多い方が勝者となります。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"学習環境の設計\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E8%A8%AD%E8%A8%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e学習環境の設計\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eマスの基礎状態として「空、黒、白」の3値を正規化し、8×8=64マスをリニアに並べて(0~63)観測させます。\n\n\u003cul\u003e\n\u003cli\u003eマスの状態を5値(空、黒、白、黒可、白可)として観測させる方法も考えられます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e離散アクションスペースとして、石を置くマスのリニアインデックス(0~63)を使います。\u003c/li\u003e\n\u003cli\u003eルール的に置けないマスをマスクして、行動の無駄を省きます。\n\n\u003cul\u003e\n\u003cli\u003e行動を制限せず、置けないマスを選んだらマイナス報酬を与えて、ルールから学習させる方法も考えられます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e一手ごとに微かな報酬を加え、勝利した場合は最大報酬、敗北した場合は最低報酬に置き換えます。\n\n\u003cul\u003e\n\u003cli\u003e「強化学習の報酬は、結果に対して与える」ものなので、取ったマスの価値や一時的なスコアは考慮しません。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"アプリの概略設計\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E6%A6%82%E7%95%A5%E8%A8%AD%E8%A8%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアプリの概略設計\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"目的\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%9B%AE%E7%9A%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e目的\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eML-Agentsのターン制ゲームへの応用を検証します。\n\n\u003cul\u003e\n\u003cli\u003eそのため、ユーザを楽しませるための機能は実装しません。(リバーシの対局自体は楽しめます。)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"クラス構成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E6%A7%8B%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクラス構成\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e論理層 \u003ccode\u003enamespace ReversiLogic\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e論理ゲーム \u003ccode\u003eclass Reversi\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e論理盤面の制御、ターンの制御、対局の制御\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e論理盤面 \u003ccode\u003eclass Board\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e論理マスの制御、マスの状態(空、黒、白、黒可、白可)の判定、局面(黒可、白可、終局)の判定、ルールの制御\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e論理マス \u003ccode\u003eclass Square\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eマスの基礎状態(空、黒、白)の制御、石を設置した順序の記録\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e物理層 \u003ccode\u003enamespace ReversiGame\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eローダー \u003ccode\u003eclass Loader\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e物理ゲームの構築と制御、モードの制御、コマンドラインの処理\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e物理ゲーム \u003ccode\u003eclass Game\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e物理盤面の構築と制御、ゲームの制御、エージェントとの通信\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e物理盤面 'class BaordObject'\n\n\u003cul\u003e\n\u003cli\u003e物理マスの構築と制御、ステータス表示、オプションUIの制御\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e物理マス \u003ccode\u003eclass SquareObject\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e論理マス状態の表示、クリックの受付\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e確認ダイアログ \u003ccode\u003eclass Confirm\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e再初期化などの確認UIの制御\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eリバーシエージェント \u003ccode\u003eclass ReversiAgent\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eUnity.MLAgents.Agents\u003c/code\u003eのサブクラス\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0b1410fc28e000542b751570ba6f818da7f07ed6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3336353834352f35366666666663612d643162632d393834622d306436372d6539323636653332613538632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F56ffffca-d1bc-984b-0d67-e9266e32a58c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2b10a5fef78600a457a4c4ca51c36154\" alt=\"mla-Reversi.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/365845/56ffffca-d1bc-984b-0d67-e9266e32a58c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F56ffffca-d1bc-984b-0d67-e9266e32a58c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1a1a8fc7ebb00d96732004823138e9ad 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"段階的な実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AE%B5%E9%9A%8E%E7%9A%84%E3%81%AA%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e段階的な実装\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003e論理層を実装して、ログ出力によって動作を確認します。\u003c/li\u003e\n\u003cli\u003e物理層を実装して、論理層の挙動をゲーム画面で確認可能にします。\u003c/li\u003e\n\u003cli\u003e物理層を拡張して、人間対人間プレイの挙動を確認可能にします。\u003c/li\u003e\n\u003cli\u003eエージェントを実装して、機械対機械プレイを可能にします。\u003c/li\u003e\n\u003cli\u003e学習を実施します。\u003c/li\u003e\n\u003cli\u003e学習結果を取り込んで、人間対機械プレイを可能にします。\u003c/li\u003e\n\u003cli\u003eスコアの表示や手番の選択など、人間対機械プレイ用のUIを整備します。\u003c/li\u003e\n\u003cli\u003e思考の練度を評価し、トレーニングの構成を試行錯誤します。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e1~7は1日でできましたが、8は際限なくかかります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"実装された仕様\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A3%85%E3%81%95%E3%82%8C%E3%81%9F%E4%BB%95%E6%A7%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実装された仕様\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"機能\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A9%9F%E8%83%BD\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e機能\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e人間対機械(プレイモード)と機械対機械 (トレーニングモード)のみで、相手を選択するUIはありません。\n\n\u003cul\u003e\n\u003cli\u003e起動時にモードを切り替えられます。 (コマンドライン引数)\u003c/li\u003e\n\u003cli\u003e内部機構的には人間対人間も可能です。 (エージェントのパラメータを双方とも\u003ccode\u003eBehaviorType.HeuristicOnly\u003c/code\u003eに固定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eプレイモード\n\n\u003cul\u003e\n\u003cli\u003e先手/後手の選択が可能です。 (UIで選択)\u003c/li\u003e\n\u003cli\u003e次にコマの置けるマスと、コマを置いた順番が表示可能です。 (UIで切り替え)\u003c/li\u003e\n\u003cli\u003e「待った」が可能です。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eトレーニングモード\n\n\u003cul\u003e\n\u003cli\u003e画面を更新しません。 (UIで切り替え)\u003c/li\u003e\n\u003cli\u003e起動時に使用する盤面数を指定できます。 (コマンドライン引数)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e次の手番、最後に置いたコマ、現在のコマ数、累積勝敗数が随時表示されます。\u003c/li\u003e\n\u003cli\u003e勝敗数が蓄積されます。\n\n\u003cul\u003e\n\u003cli\u003e「黒と白」、「人間と機械」、「チームの別」が独立して記録され、状況に合わせた一つが表示されます。\n\n\u003cul\u003e\n\u003cli\u003e3種全てを確認可能です。(UIで切り替え)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e局面や棋譜のセーブはできません。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"コマンドライン引数\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E5%BC%95%E6%95%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコマンドライン引数\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e-trainer\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eトレーニングモードで起動します。デフォルトはプレイモードです。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-player\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eプレイモードで起動します。デフォルトはプレイモードです。\u003c/li\u003e\n\u003cli\u003eデフォルトを変更しない限り不要です。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-width \u0026lt;整数\u0026gt;\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eトレーニング時に横に並べる盤面の数です。デフォルトは\u003ccode\u003e7\u003c/code\u003eです。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-height \u0026lt;整数\u0026gt;\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eトレーニング時に縦に並べる盤面の数です。デフォルトは\u003ccode\u003e7\u003c/code\u003eです。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-change\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eトレーニング時に一局毎の手番の切り替えを行います。デフォルトは切り替えます。\u003c/li\u003e\n\u003cli\u003eデフォルトを変更しない限り不要です。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-fix\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eトレーニング時に手番を固定します。デフォルトは切り替えます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eなお、エディタでトレーニングする場合のために、\u003ccode\u003eTRAINER_TEST\u003c/code\u003eシンボルで、コマンドライン引数のシミュレーションが可能です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"思考の評価\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%80%9D%E8%80%83%E3%81%AE%E8%A9%95%E4%BE%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e思考の評価\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e私は、勝てることもありますが、負け越してます。(弱すぎて評価不能)\u003c/li\u003e\n\u003cli\u003e複数の難易度が選べる無料アプリと対局させたところ、最弱レベルに辛勝する程度でした。(弱い)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"制御機構概要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%B6%E5%BE%A1%E6%A9%9F%E6%A7%8B%E6%A6%82%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e制御機構概要\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"チーム\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%81%E3%83%BC%E3%83%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eチーム\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e対称な二系統の独立した行動決定が必要になるので、エージェントのインスタンスを二つ実装します。\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eTeamID\u003c/code\u003eは、一方を\u003ccode\u003e0\u003c/code\u003e、他方を\u003ccode\u003e1\u003c/code\u003eに設定します。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"先手後手\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%88%E6%89%8B%E5%BE%8C%E6%89%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e先手、後手\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eデフォルトで、エージェント\u003ccode\u003e0\u003c/code\u003eを白(後手)、エージェント\u003ccode\u003e1\u003c/code\u003eを黒(先手)に割り当てます。\u003c/li\u003e\n\u003cli\u003eプレイモードでは、人間がプレイする色を担当するエージェントの\u003ccode\u003eBehaviorParameters.BehaviorType\u003c/code\u003eを\u003ccode\u003eHeuristicOnly\u003c/code\u003eに、他方を\u003ccode\u003eInferenceOnly\u003c/code\u003eに設定します。\u003c/li\u003e\n\u003cli\u003eトレーニングモードでは、\u003ccode\u003eBehaviorParameters.BehaviorType\u003c/code\u003eは双方とも\u003ccode\u003eInferenceOnly\u003c/code\u003eになります。\n\n\u003cul\u003e\n\u003cli\u003e先手･後手を交代する場合は、二つのエージェントの担当色を入れ替えます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e両者とも人間(\u003ccode\u003eHeuristicOnly\u003c/code\u003e)の場合は、ML-Agentsは何もしません。\n\n\u003cul\u003e\n\u003cli\u003e単一のマウスクリックが局面に応じた手番の行動として扱われるため区別は不要です。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ターン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eターン\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e物理ゲームの\u003ccode\u003eUpdate ()\u003c/code\u003eで、ターンを回します。\n\n\u003cul\u003e\n\u003cli\u003e「物理ゲーム」コンポーネントは、一種のステートマシンを構成していて、以下は「プレイ中」ステータスの場合の処理です。\u003c/li\u003e\n\u003cli\u003e前のターンを担ったエージェントが処理を終えて担当から外れる(\u003ccode\u003eTurnAgent == null\u003c/code\u003e)まで待ちます。\u003c/li\u003e\n\u003cli\u003e局面をチェックして終局していたら、「プレイ中」ステータスを終えて「終局」へ移行します。\u003c/li\u003e\n\u003cli\u003e次のターンを担うエージェントを算定して担当者に設定します。\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eTurnAgent = IsBlackTurn ? BlackAgent : WhiteAgent;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eターンの担当エージェントに行動決定を要求します。\n\n\u003cul\u003e\n\u003cli\u003e要求を受けてエージェント側で観測と行動が順次行われます。(\u003ca href=\"#%E5%AD%A6%E7%BF%92%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB\"\u003e学習サイクル\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eターンの全ての処理が終了すると自ら担当を外れます。\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egame.TurnAgent = null;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"マスと盤面\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%82%B9%E3%81%A8%E7%9B%A4%E9%9D%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマスと盤面\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e盤面は8×8マスのマトリクスですが、リニアに0~63のインデックスでもアクセスできるようにしています。\u003c/li\u003e\n\u003cli\u003e個々のマスは、石がない、黒石がある、白石があるという3種の基礎状態があり、石がない場合には、石は置けない、黒石が置ける、白石が置ける、黒石でも白石でも置けるという4種の拡張状態が存在します。\u003c/li\u003e\n\u003cli\u003eまた、盤面全体の状態として、終局、黒石が置ける、白石が置ける、黒石でも白石でも置けるという4種の状態が存在します。\u003c/li\u003e\n\u003cli\u003eさらに、盤面には、白黒どちらのターンであるかという情報が存在します。\u003c/li\u003e\n\u003cli\u003e黒のターンで黒石が置けないなら、黒はパスすることになります。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"エージェントのコードと解説\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E8%A7%A3%E8%AA%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eエージェントのコードと解説\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"学習サイクル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AD%A6%E7%BF%92%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e学習サイクル\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eターンが廻ってきたエージェントにゲーム制御側から決定要求\u003ccode\u003eRequestDecision ()\u003c/code\u003eが届きます。\u003c/li\u003e\n\u003cli\u003eエピソード(=対局)が開始されていない場合、エピソードの開始\u003ccode\u003eOnEpisodeBegin ()\u003c/code\u003eが呼ばれます。\u003c/li\u003e\n\u003cli\u003e環境の観測\u003ccode\u003eCollectObservations ()\u003c/code\u003eが呼ばれ、マスの状態がスキャンされます。\u003c/li\u003e\n\u003cli\u003e行動のマスク\u003ccode\u003eCollectDiscreteActionMasks ()\u003c/code\u003eが呼ばれ、ルール上選択できない行動がマスクされます。\u003c/li\u003e\n\u003cli\u003e行動の割り当て\u003ccode\u003eOnActionReceived ()\u003c/code\u003eが呼ばれ、石を置くかパスします。\n\n\u003cul\u003e\n\u003cli\u003e行動に応じた一時報酬を与えます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e終局するとゲーム制御側から\u003ccode\u003eOnEnd ()\u003c/code\u003eが呼ばれます。\n\n\u003cul\u003e\n\u003cli\u003e結果に応じた最終報酬を与えます。\u003c/li\u003e\n\u003cli\u003eエピソードの終結\u003ccode\u003eEndEpisode ()\u003c/code\u003eを行います。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"class-reversiagent-リバーシエージェント\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#class-reversiagent-%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eclass ReversiAgent\u003c/code\u003e リバーシ・エージェント\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこれは、リバーシの思考を担う\u003ccode\u003eAgent\u003c/code\u003eのサブクラスです。\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eAgent\u003c/code\u003eは\u003ccode\u003eMonoBehaviour\u003c/code\u003eのサブクラスです。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e一つの物理ゲームに、黒と白を担当する二つの\u003ccode\u003eReversiAgent\u003c/code\u003eインスタンスが作られます。\u003c/li\u003e\n\u003cli\u003e本来は、エージェント自身がゲームの進行を制御するのでしょうが、このプロジェクトでは外部で進行が制御され、エージェントは思考のみを担うようになっています。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eReversiAgent.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnity.MLAgents\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnity.MLAgents.Sensors\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnity.MLAgents.Policies\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eReversiLogic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eReversiGame\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;リバーシ・エージェント\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eReversiAgent\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eAgent\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;チーム識別子\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eenum\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eBlack\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWhite\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;盤面のマス数\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eReversiLogic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBoard\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;物理ゲーム\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eGame\u003c/span\u003e \u003cspan class=\"n\"\u003egame\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;論理ゲーム\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eReversi\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003egame\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReversi\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;挙動パラメータ\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorParameters\u003c/span\u003e \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_parameters\u003c/span\u003e \u003cspan class=\"p\"\u003e??\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_parameters\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egameObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorParameters\u003c/span\u003e \u003cspan class=\"n\"\u003e_parameters\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;チームID\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eTeamId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamId\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;チームカラー\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e \u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;黒である\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIsBlack\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlack\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;白である\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIsWhite\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;自分が優勢\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIWinner\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlack\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlackWin\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhiteWin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;自分が劣勢\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eILoser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlack\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhiteWin\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlackWin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;VectorAction Branch 0 Size\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003ePassable\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBrainParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVectorActionSize\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;挙動タイプ\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eget\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eset\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;人間が操作\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIsHuman\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eget\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeuristicOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eset\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeuristicOnly\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInferenceOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;機械が操作 (推論時のみ)\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIsMachine\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eget\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeuristicOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eset\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInferenceOnly\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeuristicOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;トレーニング中の可能性が高い\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIsTraning\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;チームカラーの入れ替え (チームIDは変更しない)\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eChangeTeam\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlack\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlack\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;人間と機械の入れ替え\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eChangeActor\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeuristicOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInferenceOnly\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eBehaviorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeuristicOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;オブジェクト初期化\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAwake\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eInit\u003c/span\u003e \u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;初期化\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInit\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003egame\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 一度だけ\u003c/span\u003e\n                \u003cspan class=\"n\"\u003egame\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetComponentInParent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eGame\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eTeamId\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;エピソードの開始\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnEpisodeBegin\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"OnEpisodeBegin (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e): step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003egame\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eState\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eGameState\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePlay\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogError\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Not Reseted\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;環境の観測\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCollectObservations\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVectorSensor\u003c/span\u003e \u003cspan class=\"n\"\u003esensor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"CollectObservations (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e): step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003estatuses\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSize\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//statuses [i] = (float) reversi [i].Status; // 正規化なし、基本\u003c/span\u003e\n                \u003cspan class=\"n\"\u003estatuses\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eSquareStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMaxValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 正規化あり、基本\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//statuses [i] = (float) reversi.SquareStatus (i) / (float) SquareStatus.MaxValue; // 正規化あり、拡張\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esensor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddObservation\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estatuses\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;行動のマスク\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCollectDiscreteActionMasks\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDiscreteActionMasker\u003c/span\u003e \u003cspan class=\"n\"\u003eactionMasker\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"CollectDiscreteActionMasks (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e): step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eactionIndices\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003estatus\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSquareStatus\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlack\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eBlackEnable\u003c/span\u003e \u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIsWhite\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhiteEnable\u003c/span\u003e \u003cspan class=\"p\"\u003e()))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 自分が置けない場所\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eactionIndices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePassable\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTurnEnable\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 打てるならパスできない\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eactionIndices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSize\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eactionMasker\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetMask\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eactionIndices\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 例外\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAgentMismatchException\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTeamMismatchException\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;行動と報酬の割り当て\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnActionReceived\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evectorAction\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"OnActionReceived (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e) [\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003evectorAction\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]}\u003c/span\u003e\u003cspan class=\"s\"\u003e]: step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIsMachine\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMathf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFloorToInt\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evectorAction\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 整数化\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c1\"\u003e// パス\u003c/span\u003e\n                \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egame\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTurnAgent\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAgentMismatchException\u003c/span\u003e \u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e// エージェントの不一致\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlack\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsWhiteTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eTeam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTeamMismatchException\u003c/span\u003e \u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 手番とチームの不整合\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEnable\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003egame\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMove\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Moved (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e) [\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e]: step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"nf\"\u003eAddReward\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0006f\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0003f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// パス、通常\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogWarning\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"DisableMove (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e) [\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e]: step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\\n\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"nf\"\u003eAddReward\u003c/span\u003e \u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.001f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 置けない\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAgentMismatchException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nf\"\u003eEndEpisode\u003c/span\u003e \u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogError\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Agent mismatch (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e): Step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, Turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, Status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\\n\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamMismatchException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nf\"\u003eEndEpisode\u003c/span\u003e \u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogWarning\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Team mismatch (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e): Step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, Turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, Status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\\n\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003efinally\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003egame\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTurnAgent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 要求を抹消\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogError\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003eAgent is not Human: step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;終局処理と最終的な報酬の割り当て\u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnEnd\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"AgentOnEnd (\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, \u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003eIWinner\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"winner\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eILoser\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"loser\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"draw\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e): step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIsMachine\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIWinner\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nf\"\u003eSetReward\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 勝利報酬\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eILoser\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nf\"\u003eSetReward\u003c/span\u003e \u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e1.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 敗北報酬\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nf\"\u003eSetReward\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 引き分け報酬\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eEndEpisode\u003c/span\u003e \u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogError\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eTeamColor\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003eAgent is not Human: step=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, turn=\u003c/span\u003e\u003cspan class=\"p\"\u003e{(\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsBlackTurn\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Black\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"White\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s\"\u003e, status=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ereversi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"using-reversilogic-論理ゲーム\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#using-reversilogic-%E8%AB%96%E7%90%86%E3%82%B2%E3%83%BC%E3%83%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eusing ReversiLogic;\u003c/code\u003e 論理ゲーム\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこれは、論理ゲームの名前空間です。\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eclass Reversi\u003c/code\u003e、\u003ccode\u003eclass Board\u003c/code\u003e、\u003ccode\u003eclass Square\u003c/code\u003eなどが含まれます。\u003c/li\u003e\n\u003cli\u003eここに含まれるクラスは\u003ccode\u003eMonoBehaviour\u003c/code\u003eを継承せず、Unityに依存しません。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eリバーシのルールや盤面の状態などは、全てこの中にあります。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"namespace-reversigame-物理ゲーム\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#namespace-reversigame-%E7%89%A9%E7%90%86%E3%82%B2%E3%83%BC%E3%83%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003enamespace ReversiGame\u003c/code\u003e 物理ゲーム\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこれは、物理ゲームの名前空間で、画面表示とUIが含まれます。\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eclass Loader\u003c/code\u003e、\u003ccode\u003eclass Game\u003c/code\u003e、\u003ccode\u003eclass Board\u003c/code\u003e、\u003ccode\u003eclass Square\u003c/code\u003eなどが含まれます。\u003c/li\u003e\n\u003cli\u003eここに含まれるクラスは\u003ccode\u003eMonoBehaviour\u003c/code\u003eを継承したUnityコンポーネントです。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"enum-teamcolor-チーム識別子\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#enum-teamcolor-%E3%83%81%E3%83%BC%E3%83%A0%E8%AD%98%E5%88%A5%E5%AD%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eenum TeamColor\u003c/code\u003e チーム識別子\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eML-Agentsでは、複数のチームに分かれて対戦や対局が可能なように、エージェントの挙動パラメータに\u003ccode\u003eTeamId\u003c/code\u003eという整数値があります。\u003c/li\u003e\n\u003cli\u003eこのプロジェクトでは、黒のチームと白のチーム(各ひとつのエージェント)があります。\n\n\u003cul\u003e\n\u003cli\u003eトレーニング時、先手と後手それぞれの担当エージェントの\u003ccode\u003eTeamId\u003c/code\u003eは固定されています。これは、バックエンド側で担当チームの交代が行われることを前提にしているためです。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eこれは、\u003ccode\u003eTeamId\u003c/code\u003eの数値に合わせたシンボルです。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"bool-passable-パス可能\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#bool-passable-%E3%83%91%E3%82%B9%E5%8F%AF%E8%83%BD\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003ebool Passable\u003c/code\u003e パス可能\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e行動が64種の場合は自身でパスができませんが、65種の場合は「パス可能」と判定されます。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eBehaviorParameters.BrainParameters\u003c/code\u003eを参照して、\u003ccode\u003eActionSpace0\u003c/code\u003eのサイズを確認しています。\u003c/li\u003e\n\u003cli\u003eパス不能の場合は、外部でパスを制御されます。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"changeteam--チームカラーの入れ替え-チームidは変更しない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#changeteam--%E3%83%81%E3%83%BC%E3%83%A0%E3%82%AB%E3%83%A9%E3%83%BC%E3%81%AE%E5%85%A5%E3%82%8C%E6%9B%BF%E3%81%88-%E3%83%81%E3%83%BC%E3%83%A0id%E3%81%AF%E5%A4%89%E6%9B%B4%E3%81%97%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eChangeTeam ()\u003c/code\u003e チームカラーの入れ替え (チームIDは変更しない)\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこれは、先手と後手(黒と白)を交代する仕組みのひとつで、\u003ccode\u003eTeamId\u003c/code\u003eの担当する色を入れ替えます。\n\n\u003cul\u003e\n\u003cli\u003e「エージェント0 = 白担当、エージェント1 = 黒担当」⇒「エージェント0 = 黒担当、エージェント1 = 白担当」\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eTeamId\u003c/code\u003eと\u003ccode\u003eTeamColor\u003c/code\u003eが一致しない状態が生じます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e機械対機械の場合は、一局毎に先手後手を入れ替えています。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"changeactor--人間と機械の入れ替え\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#changeactor--%E4%BA%BA%E9%96%93%E3%81%A8%E6%A9%9F%E6%A2%B0%E3%81%AE%E5%85%A5%E3%82%8C%E6%9B%BF%E3%81%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eChangeActor ()\u003c/code\u003e 人間と機械の入れ替え\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこれは、人間と機械の担当する色を入れ替える仕組みで、エージェントの挙動タイプを入れ替えます。\n\n\u003cul\u003e\n\u003cli\u003e「エージェント黒 = 人間担当、エージェント白 = 機械担当」⇒「エージェント黒 = 機械担当、エージェント白 = 人間担当」\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eエージェントの挙動タイプは、人間操作(\u003ccode\u003eHeuristicOnly\u003c/code\u003e)、機械推論(\u003ccode\u003eInferenceOnly\u003c/code\u003e)、機械学習(と推論の自動切り替え \u003ccode\u003eDefault\u003c/code\u003e)の別です。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"init--初期化\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#init--%E5%88%9D%E6%9C%9F%E5%8C%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eInit ()\u003c/code\u003e 初期化\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e一度だけ必要な初期化を行います。\u003c/li\u003e\n\u003cli\u003e外部からの使用前に明示的に呼んでいますが、一応、\u003ccode\u003eAwake ()\u003c/code\u003eからも呼ばれます。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"onepisodebegin--エピソードの開始\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#onepisodebegin--%E3%82%A8%E3%83%94%E3%82%BD%E3%83%BC%E3%83%89%E3%81%AE%E9%96%8B%E5%A7%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eOnEpisodeBegin ()\u003c/code\u003e エピソードの開始\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこのプロジェクトでの「エピソード」は「一局」に相当します。\u003c/li\u003e\n\u003cli\u003e開始していない状態で、行動の決定を要求(\u003ccode\u003eRequestDecision ()\u003c/code\u003e)されると、最初に呼び出されます。\u003c/li\u003e\n\u003cli\u003eあるいは、エピソードの終了(\u003ccode\u003eEndEpisode ()\u003c/code\u003e)を行うと中で呼ばれます。\u003c/li\u003e\n\u003cli\u003e本来はここでゲームを初期化するのですが、このプロジェクトは外部で初期化するため、チェックを行うのみで何もしていません。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"collectobservations--環境の観測\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#collectobservations--%E7%92%B0%E5%A2%83%E3%81%AE%E8%A6%B3%E6%B8%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eCollectObservations ()\u003c/code\u003e 環境の観測\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e行動の決定を要求(\u003ccode\u003eRequestDecision ()\u003c/code\u003e)される毎に呼ばれます。\u003c/li\u003e\n\u003cli\u003e単純に盤面の8×8マスの石の配置状態を観測させます。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"collectdiscreteactionmasks--行動のマスク\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#collectdiscreteactionmasks--%E8%A1%8C%E5%8B%95%E3%81%AE%E3%83%9E%E3%82%B9%E3%82%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eCollectDiscreteActionMasks ()\u003c/code\u003e 行動のマスク\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e環境の観測後に呼ばれ、選択不能な行動の選択肢をエージェントに示唆します。\u003c/li\u003e\n\u003cli\u003eここでは、ルール上、石を置けないマスをマスクしています。\u003c/li\u003e\n\u003cli\u003eパス可能の場合は、石が置けるマスが存在する場合にパスをマスクしています。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"onactionreceived--行動と報酬の割り当て\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#onactionreceived--%E8%A1%8C%E5%8B%95%E3%81%A8%E5%A0%B1%E9%85%AC%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eOnActionReceived ()\u003c/code\u003e 行動と報酬の割り当て\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e決定された行動に基づいて実際に石を打ち、その結果に応じた報酬を出します。\u003c/li\u003e\n\u003cli\u003eこのプロジェクトでは、行動(一手)は単一のスカラー値、中身はマスのインデックス(\u003ccode\u003e(int) 0\u003c/code\u003e~\u003ccode\u003e63\u003c/code\u003e)、または、それに加えて「パス」(\u003ccode\u003e(int) 64\u003c/code\u003e)で表されます。\u003c/li\u003e\n\u003cli\u003e行動を整数値で生成するために、エージェントの挙動パラメータ\u003ccode\u003eVectorAction SpaceType\u003c/code\u003eに対して\u003ccode\u003eDiscrete\u003c/code\u003eを指定しています。\u003c/li\u003e\n\u003cli\u003e処理のほとんどはエラーチェックで、作用としては、決定された行動「石を置く位置(マスのインデックス)」または「パス(\u003ccode\u003e-1\u003c/code\u003e)」を論理ゲームに渡し、微量の継続報酬を加算するだけです。\n\n\u003cul\u003e\n\u003cli\u003eこの継続報酬は、終局に至ると上書きされて捨てられます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e本来は、終局の判定と勝敗に対する報酬の支払い、エピソードの終了などを、ここで処理するのですが、このプロジェクトでは\u003ccode\u003eOnEnd ()\u003c/code\u003eに分離しています。\n\n\u003cul\u003e\n\u003cli\u003e人間の操作を外部で受け付けて処理している関係で、独立して呼び出せるようにしてあります。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"onend--終局処理と最終的な報酬の割り当て\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#onend--%E7%B5%82%E5%B1%80%E5%87%A6%E7%90%86%E3%81%A8%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%AA%E5%A0%B1%E9%85%AC%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eOnEnd ()\u003c/code\u003e 終局処理と最終的な報酬の割り当て\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e本来は、\u003ccode\u003eOnActionReceived ()\u003c/code\u003eの中で行われる処理ですが、人間の操作を外部で受け付けて処理している関係で分離されています。\u003c/li\u003e\n\u003cli\u003e終局を判定した際に外部から呼び出されます。\u003c/li\u003e\n\u003cli\u003eここでの報酬は、それまでの報酬を上書きして、単純に勝てば\u003ccode\u003e1\u003c/code\u003e、負ければ\u003ccode\u003e-1\u003c/code\u003eになります。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"heuristic--人間の入力\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#heuristic--%E4%BA%BA%E9%96%93%E3%81%AE%E5%85%A5%E5%8A%9B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eHeuristic ()\u003c/code\u003e 人間の入力\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこのプロジェクトでは、このメソッドを実装しません。\u003c/li\u003e\n\u003cli\u003e人間の操作は、エージェントの外で制御されています。\u003c/li\u003e\n\u003cli\u003eML-Agentsに依存して人間の選択が必要な状況になるとエラーが生じます。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"reversiagentのbehaviorparameters\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#reversiagent%E3%81%AEbehaviorparameters\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eReversiAgent\u003c/code\u003eの\u003ccode\u003eBehaviorParameters\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/acc9fbb258650fded2d4c9e665bce8fb506bd5cf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3336353834352f35353261653237382d306265642d343464332d633665302d3065346436326338386636642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F552ae278-0bed-44d3-c6e0-0e4d62c88f6d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=72086a0fa33c67c6f0fe90a23d77f87f\" alt=\"スクリーンショット 2020-09-24 122654.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/365845/552ae278-0bed-44d3-c6e0-0e4d62c88f6d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F365845%2F552ae278-0bed-44d3-c6e0-0e4d62c88f6d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2eb9a3fa4db5ff182d420bdea478de69 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"トレーニングの構成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%AE%E6%A7%8B%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eトレーニングの構成\u003c/h2\u003e\n\n\u003cp\u003e次の記事 ⇒ \u003ca href=\"https://qiita.com/tetr4lab/items/1a2f771bf657e4aaa19e\" id=\"reference-d95184a3d7a5c59ebbdc\"\u003eUnity ML-Agentsで作ったターン制ゲームを鍛える\u003c/a\u003e (Qiita)\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"課題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AA%B2%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e課題\u003c/h1\u003e\n\n\u003cp\u003e以下のような課題が生じ、対処済み、あるいは、対処中です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"トレーニング時にブレインに接続できない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E6%99%82%E3%81%AB%E3%83%96%E3%83%AC%E3%82%A4%E3%83%B3%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eトレーニング時にブレインに接続できない\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows版の実行ファイルをビルドしてトレーニングする際に、'Instructions for updating: ~ non-resource variables are not supported in the long term'の後、\u003ccode\u003eConnected to Unity environment\u003c/code\u003eが出ず、\u003ccode\u003eUnityEnvironment worker 0: environment stopping.\u003c/code\u003eと出て終わってしまいます。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"対処\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AF%BE%E5%87%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e対処\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eProjectSettings\u0026gt;Playerで、\u003ccode\u003eScriptingBackend\u003c/code\u003eをデフォルトの\u003ccode\u003eMono\u003c/code\u003eにしておけば接続できるようです。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"脈略なくonepisodebegin-が呼ばれる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%84%88%E7%95%A5%E3%81%AA%E3%81%8Fonepisodebegin-%E3%81%8C%E5%91%BC%E3%81%B0%E3%82%8C%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e脈略なく\u003ccode\u003eOnEpisodeBegin ()\u003c/code\u003eが呼ばれる\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AD%A6%E7%BF%92%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB\"\u003e学習サイクル\u003c/a\u003eの途中で、ML-Agentsのバックエンド側からの制御で\u003ccode\u003eOnEpisodeBegin ()\u003c/code\u003eが呼ばれる場合があります。\n\n\u003cul\u003e\n\u003cli\u003e既に\u003ccode\u003eRequestDecision ()\u003c/code\u003eが行われていると、過去のエピソードに対する\u003ccode\u003eOnActionReceived ()\u003c/code\u003eが呼ばれます。\u003c/li\u003e\n\u003cli\u003e盤面の初期化後に、過去の局面に対しての行動要求が届くので、不整合が生じます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"対処-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AF%BE%E5%87%A6-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e対処\u003c/h5\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003econfig.yaml\u003c/code\u003eの\u003ccode\u003ethreaded\u003c/code\u003eを\u003ccode\u003efalse\u003c/code\u003eにすれば、学習サイクル中の割り込みはなくなります。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"弱い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BC%B1%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e弱い\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e私が勝てるのだから弱いのは間違いありません。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"対処-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AF%BE%E5%87%A6-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e対処\u003c/h5\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eTensorBoard\u003c/code\u003eでモニターしています。\u003c/li\u003e\n\u003cli\u003eトレーニングの構成を見直しています。\n\n\u003cul\u003e\n\u003cli\u003e次の記事「\u003ca href=\"https://qiita.com/tetr4lab/items/1a2f771bf657e4aaa19e\"\u003eUnity ML-Agentsで作ったターン制ゲームを鍛える\u003c/a\u003e」\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2020-09-07T06:42:10Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"SBxpGuIq4wVFkVC5xTfWg41jG+YconkH7A==--VrLH7gcMnNOnsxEV--tOdmw21ol+yp6j2KqfPzLg==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-10-08T15:54:41Z","likesCount":5,"linkUrl":"https://qiita.com/tetr4lab/items/b02eca793336ed63429f","organization":null,"originalId":1296193,"stockedCount":8,"title":"Unity ML-Agentsでターン制ゲームを作る","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%8F%90\"\u003e前提\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A8%98%E4%BA%8B%E3%81%AE%E7%AF%84%E5%9B%B2\"\u003e記事の範囲\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E5%85%A5%E6%89%8B\"\u003eアセットの入手\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%93%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%A7%E6%89%B1%E3%81%86%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%81%AE%E3%83%AB%E3%83%BC%E3%83%AB\"\u003eこのプロジェクトで扱うリバーシのルール\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E8%A8%AD%E8%A8%88\"\u003e学習環境の設計\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E6%A6%82%E7%95%A5%E8%A8%AD%E8%A8%88\"\u003eアプリの概略設計\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%9B%AE%E7%9A%84\"\u003e目的\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E6%A7%8B%E6%88%90\"\u003eクラス構成\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#%E6%AE%B5%E9%9A%8E%E7%9A%84%E3%81%AA%E5%AE%9F%E8%A3%85\"\u003e段階的な実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A3%85%E3%81%95%E3%82%8C%E3%81%9F%E4%BB%95%E6%A7%98\"\u003e実装された仕様\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A9%9F%E8%83%BD\"\u003e機能\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E5%BC%95%E6%95%B0\"\u003eコマンドライン引数\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%80%9D%E8%80%83%E3%81%AE%E8%A9%95%E4%BE%A1\"\u003e思考の評価\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#%E5%88%B6%E5%BE%A1%E6%A9%9F%E6%A7%8B%E6%A6%82%E8%A6%81\"\u003e制御機構概要\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%81%E3%83%BC%E3%83%A0\"\u003eチーム\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%88%E6%89%8B%E5%BE%8C%E6%89%8B\"\u003e先手、後手\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%83%BC%E3%83%B3\"\u003eターン\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%82%B9%E3%81%A8%E7%9B%A4%E9%9D%A2\"\u003eマスと盤面\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E8%A7%A3%E8%AA%AC\"\u003eエージェントのコードと解説\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AD%A6%E7%BF%92%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB\"\u003e学習サイクル\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#class-reversiagent-%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88\"\u003eclass ReversiAgent リバーシ・エージェント\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#using-reversilogic-%E8%AB%96%E7%90%86%E3%82%B2%E3%83%BC%E3%83%A0\"\u003eusing ReversiLogic; 論理ゲーム\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#namespace-reversigame-%E7%89%A9%E7%90%86%E3%82%B2%E3%83%BC%E3%83%A0\"\u003enamespace ReversiGame 物理ゲーム\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#enum-teamcolor-%E3%83%81%E3%83%BC%E3%83%A0%E8%AD%98%E5%88%A5%E5%AD%90\"\u003eenum TeamColor チーム識別子\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#bool-passable-%E3%83%91%E3%82%B9%E5%8F%AF%E8%83%BD\"\u003ebool Passable パス可能\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#changeteam--%E3%83%81%E3%83%BC%E3%83%A0%E3%82%AB%E3%83%A9%E3%83%BC%E3%81%AE%E5%85%A5%E3%82%8C%E6%9B%BF%E3%81%88-%E3%83%81%E3%83%BC%E3%83%A0id%E3%81%AF%E5%A4%89%E6%9B%B4%E3%81%97%E3%81%AA%E3%81%84\"\u003eChangeTeam () チームカラーの入れ替え (チームIDは変更しない)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#changeactor--%E4%BA%BA%E9%96%93%E3%81%A8%E6%A9%9F%E6%A2%B0%E3%81%AE%E5%85%A5%E3%82%8C%E6%9B%BF%E3%81%88\"\u003eChangeActor () 人間と機械の入れ替え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#init--%E5%88%9D%E6%9C%9F%E5%8C%96\"\u003eInit () 初期化\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#onepisodebegin--%E3%82%A8%E3%83%94%E3%82%BD%E3%83%BC%E3%83%89%E3%81%AE%E9%96%8B%E5%A7%8B\"\u003eOnEpisodeBegin () エピソードの開始\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#collectobservations--%E7%92%B0%E5%A2%83%E3%81%AE%E8%A6%B3%E6%B8%AC\"\u003eCollectObservations () 環境の観測\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#collectdiscreteactionmasks--%E8%A1%8C%E5%8B%95%E3%81%AE%E3%83%9E%E3%82%B9%E3%82%AF\"\u003eCollectDiscreteActionMasks () 行動のマスク\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#onactionreceived--%E8%A1%8C%E5%8B%95%E3%81%A8%E5%A0%B1%E9%85%AC%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6\"\u003eOnActionReceived () 行動と報酬の割り当て\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#onend--%E7%B5%82%E5%B1%80%E5%87%A6%E7%90%86%E3%81%A8%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%AA%E5%A0%B1%E9%85%AC%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6\"\u003eOnEnd () 終局処理と最終的な報酬の割り当て\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#heuristic--%E4%BA%BA%E9%96%93%E3%81%AE%E5%85%A5%E5%8A%9B\"\u003eHeuristic () 人間の入力\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#reversiagent%E3%81%AEbehaviorparameters\"\u003eReversiAgentのBehaviorParameters\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%AE%E6%A7%8B%E6%88%90\"\u003eトレーニングの構成\u003c/a\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#%E8%AA%B2%E9%A1%8C\"\u003e課題\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E6%99%82%E3%81%AB%E3%83%96%E3%83%AC%E3%82%A4%E3%83%B3%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003eトレーニング時にブレインに接続できない\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AF%BE%E5%87%A6\"\u003e対処\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%84%88%E7%95%A5%E3%81%AA%E3%81%8Fonepisodebegin-%E3%81%8C%E5%91%BC%E3%81%B0%E3%82%8C%E3%82%8B\"\u003e脈略なくOnEpisodeBegin ()が呼ばれる\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AF%BE%E5%87%A6-1\"\u003e対処\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BC%B1%E3%81%84\"\u003e弱い\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AF%BE%E5%87%A6-2\"\u003e対処\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\n\n\n\n\n","totalPv":4711,"uuid":"b02eca793336ed63429f","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"vK7fM8O4FTf+1PuI4ZHg7PEB7OON--oOMwugrG58i2j2eM--UsvTvLFhtJSjRTzjZSGbGQ==","originalId":365845,"description":"自分がネットから受け取ってきたような価値を僅かでもネットに返せたらと思っています。\r\nUnityで、主に1人で作っています。\r\n受託開発もいたします。\r\n業務外のご提案も歓迎いたします。","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"tetr4lab.","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/365845/f29fec2e030a0c6a0c459dd302a7da3cbf40f657/x_large.png?1603867182","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F365845%2Ff29fec2e030a0c6a0c459dd302a7da3cbf40f657%2Fx_large.png%3F1603867182?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=1c2c645b2409505723d6f91f541b163a","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F365845%2Ff29fec2e030a0c6a0c459dd302a7da3cbf40f657%2Fx_large.png%3F1603867182?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13395485ff2633fad67944592432eade","urlName":"tetr4lab","websiteUrl":"https://tetr4lab.nyanta.jp/","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"MachineLearning","urlName":"machinelearning"},{"name":"強化学習","urlName":"%e5%bc%b7%e5%8c%96%e5%ad%a6%e7%bf%92"},{"name":"ML-Agents","urlName":"ml-agents"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
