More than 5 years have passed since last update.2016/08/02は予報は雨だったけど､行けそうなので猿倉まで登ってきた｡
EPPlusは､Excelの.xlsxファイルを直接編集できる便利なライブラリなのですが､Excelのファイルを取り扱うとき少し注意すべきことがあったので､備忘録的に｡主に､ExcelRangeBaseをforeachで使用とすると直感的では無い挙動を起こすことがある｡
以下はそのサンプル｡サンプル中の､コメントに有るように､基本的には､値の存在するCellを列挙している形となって､指定された矩形範囲の列挙では無いのでこの点は注意しないとマズいかと思います｡また､ExcelRangeBaseのValueにnullを一括代入した場合､nullが入力されている状態なので､値が存在すると解釈されるようです｡但し､そのような状態でセーブし､再び開いたときは､nullは無視されて再びValueが存在しないコトになって0となるようです｡このようなことから､ExcelRangeBaseを用いてforeachする場合は､値の存在しないセルは無視されるので注意すべきかと｡矩形範囲のすべての列挙なりを行うなら､単一セルのレンジをPivotにして､Offsetで舐めていくか､Cellプロパティに適宜アドレスをぶち込むが良いかと思います｡


