More than 1 year has passed since last update.C# gRPC v1.16.0 で SSL に関する仕様変更が行われ、クライアント資格証明の要求と照合に関する動作を細かく指定できるようになりました。SslClientCertificateRequestType 列挙体を受け取るコンストラクタが追加されました。SslServerCredentials クラスの従来のコンストラクタ（bool を受け取るコンストラクタ）は、true が指定された場合は RequestAndRequireAndVerify と見なし、false が指定された場合は DontRequest と見なすように実装されています。
従来のコンストラクタによる gRPC.Core 内部の挙動に誤りがあり、それを修正するとともに、挙動を制御しているオプション値を引数とするコンストラクタを公開したというのが実際のところのようです。次の証明書ファイルを準備しました。すべて OpenSSL を使って作成した自己証明書です。クライアント資格情報によって認証されているかどうかをサーバーサイドで判定するには、RPC メソッドの引数で渡される ServerCallContext オブジェクトの内容を確認します。
認証されている場合、ServerCallContext.AuthContext.IsPeerAuthenticated プロパティの値が true になり、ServerCallContext.AuthContext.PeerIdentity プロパティに認証情報が格納されます。ルート証明書を照合したかどうかは分からないようです。環境が手元にないため確認していませんが gRPC 1.16.0 では Linux 上での SLL 処理のスループット向上が図られているなど、SSL に対する強化や改善は継続的に行われていくと思われます。


