More than 3 years have passed since last update.※以下、秀丸ファイラーでの話ですがMicrosoftにより標準化されてますので多くのファイラーで使えるはずです
※実はVistaから非推奨になってるので標準のExplorerでは動きません
※この記事は https://www.codeproject.com/Articles/3747/Explorer-column-handler-shell-extension-in-C の解説記事です。オリジナルの記事の方が圧倒的に情報量が多いので深く知りたい人は是非。これ↓を作る方法。
ソースコードはこちら https://github.com/fushihara/windows-shell-extension-column 実行方法環境はWindows10/Visual Studio2017。実行方法はVisualStudioを管理者権限で開く。dllファイルをシステムに登録する必要があるので管理者権限が必要。
その後通常と同じように開始をすると、DLLファイルがコンパイルされ、レジストリに登録までされます。登録時、秀丸ファイラーは常駐プロセス含めて全て終了させる事。以下、コードの要所要所解説Guidは以下の3項目について注目する。875～の値は追加するカラムのクラス MD5ColumnHandlerに対するGUID。その中のGUID_AとGUID_Bというのは、追加するカラムの一つ一つに対するGUID。
例えば、1つのdllファイルで3つのカラムが定義されている場合、準備するGUIDは1+3で4つになります。
MD5ColumnHandlerのGUIDは書き方が決まっているが、GUID_AとGUID_Bは必要な所で参照出来れば書き方はどうでもよい。必要なメソッドは初期化、カラム情報取得、アイテム詳細取得の3つ。どのように1クラスで複数のカラムを定義するかと言うと、以下のようにGetColumnInfoが何回も呼ばれるので必要な数だけS_OKを返す。以下の場合だとカラムは2つ表示されます。また、各カラムには色々なプロパティをセット出来ますが、とりあえずwszTitleをセットしておけばそれらしくなります。上で定義したGUID_AとGUID_Bはここで使います。実際にカラムの内容を表示する処理は以下の通り。二つあるカラムの両方の処理がここに来るので、fmtidのプロパティを見てどっちの処理か分岐させます。ファイルの名前はもちろん、ファイルの属性も取れます。今回は単純にファイル/フォルダのフルパスを表示するだけで。登録されるレジストリレジストリの処理としては、以下の場所にクラスのGUIDで指定した875～の値が記録されています。ContextMenuHandlersとかPropertySheetHandersとか魅力的なキーが他にもあります。875b8b0a-48c3-491a-adf7-4ede573a2b95の詳細はどこにあるかと言うと、こちらになります。
特に新しい情報はありませんが、クラス名が名前空間付きで入っているのでこだわりたい人は書き換えるといいかも。
dllファイルの場所はここに入っていますね。これで秀丸ファイラーに任意のカラムを追加する事が出来ました。秀丸ファイラーに感謝その他参考ページ


