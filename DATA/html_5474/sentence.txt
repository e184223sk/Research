More than 1 year has passed since last update.　arduinoとのUSBシリアルを使った通信で、C#でプログラムを書く機会があったので、概要を記載します。　フォームにSerialPortを配置します。通信条件は目的に応じでプロパティを設定するか、接続をする際に初期化します。
　ボタンクリックで接続するには、次のようにします。　USBシリアルポートを使うときには、接続のたびにCOM番号が変わったりします。
　その時には、コンボボックスにCOMポートを列挙しておいて、接続時にコンボボックスを見に行くようにすると便利ですね。サンプルでは、portComboBoxにポート番号を設定します。設定するタイミングは、フォームが読み込まれるタイミング（Form1_Load)がいいでしょう。　データを送信するのは簡単です。Button2のクリックでtextBox2の内容を送信する例です。textBox2の送信の最後に"\n"を追加しています。これは、相手側に合わせてください。　データ受信イベントを使った方法を説明します。
　SerialPortのDataReceivedイベントをダブルクリックで設定します。　これで改行までの1行を読み込むのですが、受信内容をテキストボックス(複数行)に追加しようとして次のようにすると、受信時に例外が発生します。　これは、データ受信スレッドと、メインスレッドが異なるためです。じぁあどうするかというと、このようにすればよいです。
　応用するなら、Response関数内のelse以下のところにコードを追加すると大概のことができます。　これは簡単！　ところが！閉じるときにハングアップすることがあります。
　これの原因は読込の時に使ったInvoke関数がブロッキングするからです。そこで、次のコードにすると問題ありません。　Invokeではなく、BeginInvokeを使うということです。プロジェクト全体はリンクからダウンロードしてください。
VisualStudio2017でのサンプルプロジェクト


