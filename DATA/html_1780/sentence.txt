More than 1 year has passed since last update.1つのセル内の文字の細かい書式情報(太字、斜体、色、などなど)を取得したい。 
例えば、こんな文字列。
記事が見つからなかったので、公式ドキュメント読んで頑張ってみました。.NET 4.8
NPOI 2.4.1※対象となるファイル形式は、.xlsx のみ。.xls では動作しません。いい感じに取得できました。
ソースはこちらポイントは ICell.RichStringCellValue を IRichTextString から XSSFRichTextString へキャストしてあげることです。IRichTextString のままではExcelの旧フォーマット(.xls)との抽象化のため、用意されたプロパティやメソッドが少なく、取得できる情報がほとんどありません。XSSFRichTextString であれば、細かい書式情報のプロパティが公開されているため出来ることが多くなります。また、各文字ごとの書式は Run と呼ばれる単位で取得します。Run は1つ以上の文字の塊で、何らかの書式が変わった区切りで生成されます。この Run をループで処理しすべての文字の書式を取得します。取得する際には、先ほどと同様に IFont を XSSFFont へキャストしてから行います。サンプルでは、以下の情報を取得します。
それぞれの詳しい説明は 公式ドキュメント を確認してください。下線については以下の種類が取得できるようです。旧形式(.xls)は無事死亡。


