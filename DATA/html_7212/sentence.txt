More than 5 years have passed since last update.ニッチすぎるテーマですが、ニッチだからこそ情報が少なく、欲している人はいるのではないかと思ったのでのせときます。と言ってもやることはシンプルでたった１つです。だけど自分がふと思いついて試しに組み込んでみたら凄く便利でした。しかし、PhantomJSではヘッドレスなので画面は見れません。ChromeDriverを使えば実行中は見れますが、操作が奪われるし、奪い返すと失敗します。最近だとChromeのInspectorを立ち上げると失敗します。Seleniumを使うと実行中の状態をキャプチャーできてpng画像としてエクスポートできます。このキャプチャーを利用します。この時点で何をどうするか分かったと思います。MSTestなどでテストするとテストエクスプローラにテスト結果が出ます。失敗したテストを選択すると、アサーションなどに出力されたエラーが表示されます。このエラーを表示する内容に、先ほどの画面キャプチャーを組み込むことで、テストが失敗したらエラーメッセージから失敗時の画面のキャプチャー画像を見ることができます。コードが見やすいように不要コードは取り除きました。たったこれだけで、失敗したらエラーメッセージだけでなくキャプチャのパスも表示されます。
パスはクリックするだけで画像ビューワーが立ち上がります。
何気なく思いついた方法でしたが、これを組み込んでから失敗時の原因特定がだいぶ楽になりました。以上になります。


