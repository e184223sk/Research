Windows Forms上でウェブページを表示するためのコントロールとしてSystem.Windows.Forms.WebBrowserクラスが標準で用意されています。
しかし、なぜか5ボタンマウスに付いている「戻るボタン」「進むボタン」を押してもページが切り替わりません。
WebBrowserコントロールでマウスの戻る・進むボタンに対応させる方法を紹介します。WebBrowserクラスは、MouseDownイベントによるイベントハンドリングができない。そのためMouseEventArgsのButtonプロパティの値がMouseButtons.XButton1とMouseButtons.XButton2であるかどうかで判定する方法は使えない。その代わりにウィンドウメッセージを捕捉することにする。WebBrowser上でマウスの「戻るボタン」「進むボタン」が押されるとWM_APPCOMMANDメッセージが発生する。そこでWebBrowserクラスを継承し、WndProcメソッドをオーバーライドしてWM_APPCOMMANDメッセージを捕捉することで「戻るボタン」「進むボタン」が押されたことを検知できる。さらに押されたボタンの種類を調べるためにm.LParamからGET_APPCOMMAND_LPARAMメソッドによって押されたボタンの種類を演算して求める。あとは、WebBrowserクラスをWebBrowserExクラスに置き換えてインスタンスを作成すれば、戻る・進むボタンの操作に応じてウェブブラウザ内のページが切り替わる。新しいEdgeに準拠したWebView2では、「戻るボタン」「進むボタン」に対応しているので、最新のWeb標準にも準拠しているWebView2を今後は使うべきだと思います。


