More than 5 years have passed since last update.追加で検証するため､EPPlusのソースコード読んでいたら､おやと思うことがあったので､とりあえずまとめておく｡下記のような操作をしたとする｡コメントでネタバレしてるけど､GetEnumeratorで取得できるEnumeratorが独立していない｡
なので､上記サンプルで､foo及びbarに対する操作の結果が､それぞれに反映されてしまうことになる(つまり､MoveNextの結果が累積している)｡
このような操作をするシナリオはそんなに無いだろうけど､ステートの保持を目的としてEnumeratorを保持して､長い間使い回したりすると､問題が起きるかも知れないのでご注意の程｡じゃあ､回避策はあるのかというと､range変数を使わずに､都度都度sheet.CellsプロパティでRangeを取得すれば回避できる｡こんなケースはまれだろうけど､一般的なGetEnumeratorの戻り値と異なっているので､その点注意しないとマズいかと思って一応まとめてみた｡


