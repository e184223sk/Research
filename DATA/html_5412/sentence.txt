Revitアドイン作成時、レベルや壁（Wall）のFilteredElementCollectorをいっぺんに取得してきたは良いけど、要らないやつを毎回if文で弾くのが面倒だったため、必要なものだけ絞り込む手段が欲しいなあと思いました。
調べて出てきたそれっぽい方法はあまりうまくいかなかったので、上手くいく方法をメモに残します。
そのやり方間違ってるよ、正式なやり方が別にあるよという場合はコメントいただけるとありがたいです。OS: Windows8.1
Revit: 2019.2たとえば、「建物の階」にチェックの入っているレベルを取得したい場合は以下のようにします。
Collector取得時のdocはコマンドの引数ExternalCommandData revitから取得するものです。
Document doc = revit.Application.ActiveUIDocument.Document。ちなみに「高さ」による昇順ソートはこう。FilteredElementCollecterではなくなってしまう。
（実際レベルを使うときはソートしてから使いたいだろうと思うのでついでに併記）降順にしたい場合はascendingをdescendingに変更。もっと他にスマートな書き方がある気がバリバリしています。


