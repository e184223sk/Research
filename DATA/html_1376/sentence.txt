.NetのListViewに大量のデータを表示しようとすると時間が掛かってしまいます。
そこでいくつかある高速化の手段の1つとして、仮想化モードを紹介します。仮想モードではすべてをデータを描画するのではなく、見えているものだけを描画します。
なので、非常に軽量です。軽い対策のものを載せていきます。これは対策なしです。
ただひたすら1行ずつAdd()していく
遅すぎるので、表示する行数は10000にしています。(他は100000です。)
約5.73秒でした。描画を止めておく関数BeginUpdate()とEndUpdate()を導入する
件数は100000件です。
約3.71秒でした。データ追加をAddRange()でまるごとに追加します。
件数は100000件です。
約2.57秒でした。仮想モードを使用することで、できなくなることがあります。
これは選択されている項目がわからなくなるということです。
仮想モードがオンとlistView1.SelectedItemsがアクセスできなるなります。
しかし選択されたインデックスlistView1.SelectedIndicesは利用可能なので、そちらをうまく使いましょう。データの更新, 選択された項目のデータ取得, Insert, Removeです。以下のコードで実装されているので、躓いた際には参考にしてください。


