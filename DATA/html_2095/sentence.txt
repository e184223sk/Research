前回
楽天API　C#　商品検索の一覧取得する(１)前回記事で楽天APIを使って検索結果の一覧をXML形式で取得したのは良いが、XML形式の扱いが初めてなのでいろいろと探した結果Xml.Linqというのが、どうやら使い勝手が良さそうだと分かりご紹介します。単純にString型のデータをXML形式でパース（分解）してくれる便利なメソッドがあったのでそれを使います。XDocumentにしてしまえば、あとはSeleniumやAngleSharpと構文は変わらないので適当に処理を書いてしまえば必要な箇所だけ自由に切り抜きできます。＜mediumImageUrls＞
入れ子構造の処理
上のようにmediumImageUrlsタグは下にimageUrlタグを複数持っています。しかもこれは商品によっては必ず３つあるとは限らない可変の入れ子構造になっています。この点はforeachによって柔軟に取り出します。Element(名前)
今回のXMLの大外のタグは"root"でしたのでXDocumentの先頭はこれを探します。
XElement ROOT = xdoc.Element("root");Elementの引数がstringなので大文字小文字区別して完全に一致しないと検出できないのが
難点です。まぁ一度作ってしまえば問題ないので最初だけですが。検索結果は膨大なデータ量なので分かりにくいですが＜Item＞商品情報＜/Item＞の間が1つの商品に対応しています。サムネの画像ＵＲＬなどもあるのでかなり項目も多いですが人によってほしいデータも違うと思うので最大公約数的にこんなことになっているのでしょう。下のXMLデータは３件分のデータです。商品名
価格
画像ＵＲＬ（１）
画像ＵＲＬ（２）※
画像ＵＲＬ（３）※
（空行）※は商品によっては画像は2枚目以降が無い場合があるので可変です。今回楽天ＡＰＩを使ってデータの抜き取りにチャレンジしてみましたがHttpClientでドはまりした分を取り返すべくスムーズに開発ができました。ソフトを作っていくうちに、「これはお金がもらえる技術なのでは？」と思い始めたのですが誰か金払っても良いよ！って奇特な方いましたらご連絡くださいw

データ量が多すぎて抜粋しかできませんでしたが一瞬で１００ページのデータが入手できるので工夫次第では非常に有益な情報を仕入れれると思います。
次回
AmazonAPIで商品検索


