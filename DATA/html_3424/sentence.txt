More than 1 year has passed since last update.WPFに限らずですが、あらかじめ決められた項目の中からユーザーに1つ選択させるためのコントロールとして、ComboBoxというものが標準で用意されています。「プルダウン」とも呼ばれたりすることがあるやるです。
しかし、選択肢が多くなればなるほど、多数の中から目的の項目を探し出す必要が生じるため、ただのComboBoxは使い勝手が悪くなります。そのようなときにあると便利なものが、入力した文字列と部分一致する項目のみに自動的に絞り込んでくれるComboBoxだったりします。ざっくり纏めると、下記の手順となります。以上。例として、空のWPFプロジェクト（プロジェクト名はTestBenchWPFとする）に作成していきます。プロジェクトを右クリック →「追加」→「新しいフォルダー」で作成します。
フォルダ名は「Controls」とします。
Controlsフォルダを右クリック →「追加」→「ユーザーコントロール」で作成します。
名前は「PartialSearchComboBox」とします。
以下のように実装します。上記手順で作成したPartialSearchComboBoxを実際に使ってみます。
簡単な例として、MainWindow.xamlの上に都道府県のコンボボックスとして設置してみます。これをビルド・実行してComboBox上に任意の文字列を入力すると、部分一致する都道府県のみに絞り込まれるようになることが分かります。例１ 『川』と入力した場合
例２ 『京』と入力した場合
ComboBoxのアイテムとして、上記のComboBoxItemではなくItemsSourceを使用する場合にどのようにすればよいかを記載します。以下のクラスでできたListをItemsSourceに詰め込むものとします。ComboBoxItemを使用していたときと同様に都道府県を一覧に表示する場合、MainWindow.xamlとそのコードビハインドは以下のようになります。MVVMで実装する場合、コードビハインドを使わずに、対応するViewModelから同様の要領でバインドすれば大丈夫です。フィルターの対象をComboBoxItemクラスからPrefectureクラスに変更する必要があります。
独自のクラスをItemsSourceに使用する場合は、同様にその独自のクラスに変更すれば大丈夫です。PrefectureのNameに対してフィルターをかけたいので、PartialSearchComboBoxのコードビハインドを以下のように変更します。以上の手順で、ItemsSourceを使用する場合にも対応することができます。なかなか用途がないとは思いますが、これを応用すると、
「入力された文字列と県庁所在地名が部分一致する都道府県のみをフィルターする」
といったことができます。フィルター部分を以下のように変えることで実現可能です。この状態で部分一致絞り込みを使用すると、以下のような動作になります。
※県庁所在地として「津市」と「大津市」がヒット


