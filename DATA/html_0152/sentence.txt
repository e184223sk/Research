ひょんなことからarduinoスターターキットを頂いた。頂いたお礼も兼ねて、何かしら作ってみようと思った。というわけで前回作ったジョイコンを用いたグーグルストリートビュー操作の検知部分だけ作り変えます。ストリートビューを動かすための基本的な構成は前回の記事↓を参照してください。
リングフィットアドベンチャーの道具でグーグルストリートビューを歩き回る【Unity+GoogleMapsJavaScriptAPI】
以下はほとんど自分用のメモなので、飛ばしていただいて問題ないです。Arduinoをまともに使うのが初めてだったので基礎部分から確認します。以下の記事↓などを参考に、Arduino IDEの導入とポート等の設定を行いました。
Arduinoで開発を始める準備UnityでいうStart()のイメージです。起動時に実行をします。UnityでいうUpdate()のイメージです。setup()の後に繰り返し実行します。引数としてintのピン番号と、INPUTかOUTPUTのどちらかの値の二つを取ります。これを用いてsetup()内から指定したピンが入力用か出力用か決定します。特に、以下のような設定を行うとArduino内臓のLEDの設定になります。これを光らせるには以下の関数を使います。引数としてintのピン番号と、HIGHかLOWのどちらかの値の二つを取ります。これを用いて指定したピンに対してHIGH, LOWの出力を行います。先ほどのLEDはこれで光るようになります。引数としてintのピン番号を指定します。指定されたピンへの入力を読み取ります。シリアルポートへの出力を行います。Serial.println()だと改行付きです。Tilt Ball switchを用います。構造としてはシンプルで、中に入っている金属球が物理的に移動することで接続が繋がったり切れたりするものです。画像はElegooによるマニュアルからの引用です。
2番のピンとGNDに対してセンサーを繋げるだけです。ピン2への入力の有無によってシリアルポートに1か0を出力します。基本的には付属していたサンプルを改変しただけのものです。基本的には前回の記事の構成をそのまま使います。が必要です。前回の記事を参照してください。検知手段が変わったので、前回ジョイコンを用いていた部分だけ書き換えます。参考: 【Unity/Arduino】UnityとArduinoを連携してみた上記の記事に従ってApi Compatibility Levelの設定を変更。また、シリアル通信用にコードを書き替えます。serialPortへの接続と値の取得は参考サイトのコードをそのまま使います。message_として受け取った"0"か"1"の値が切り替わった瞬間にProceed()を動かし、表示したページをSeleniumで操作して前進します。適当なgameobjectを配置して、このコードをつければ完成です。今回の場所は北アルプスです。Arduino（に養生テープで固定したセンサー）を傾けるとシリアルポートへの出力を行い、UnityがUSB接続で受け取り、Seleniumを用いて対象のページを操作。前進していきます。あとはこれをステッパーに取り付ければ、実際に歩きながらストリートビューの世界を進むことができます。現在の構成はあくまで有線での接続なので、実用性は微妙だと思います。無線でなんやかんやするための知識も欲しい。あとはgoogle maps apiの機能を活かせてない(決めた座標から前進するだけ)ので、座標の決定や保存、ルート案内みたいな方向でも改善余地があります。ほとんど前回の流用記事でした。マイコンでの電子工作(?)は経験がありませんでしたが、今回は構成を置き換えるだけで気軽に試せてよかったです。arduinoスターターキットの内容は本当に豪華かつ日本語マニュアルも充実していたので、もっといろいろ試してみたいですね。


