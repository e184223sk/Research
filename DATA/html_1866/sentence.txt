More than 1 year has passed since last update.いろんな分野に目移りしてちょろっと触ってみたくなる悪い癖なんですが
クラウドソーシングの副業を探していたら、Gooogle Calendarに予定を突っ込む／更新する案件があり
なぜかそれきっかけで無性にAPIを呼んでみたくなったので、試してみました。
※ちなみに案件は受けていませんwGoogle Calendar APIを使用してみる #2
Google Calendar APIを使用してみる #3IDE：VisualStudio2019
アプリケーション：コンソールアプリ
フレームワーク：.NET Core 3.1公式に入門がありました。
Get Started with the Calendar APIどうやらAPIを使用するには、認証情報を作成する必要があるようです。
以下3つの方法があるとのことです。
OAuthクライアントIDを用いる方法では、すぐに認証情報が作成できるのですが、「oauth 同意画面」の設定を行わないとプライベートデータへのアクセスが１００回までと制限されるそうで

また、「oauth 同意画面」の設定が手間そうだったので、「サービス アカウント」を用いる方法を試してみたいと思います。以下に入力を行い作成。
出来上がったサービスアカウントのリンクをクリック
キーを作成をクリック
JSONを選択
ここでダウンロードしたJsonの中身の情報を用いてGoogleAPIを呼び出します。Nugetからカレンダー用のDLLをダウンロードしてきます。
次に作成したサービスアカウントに操作させたいカレンダーを公開します。
対象のカレンダーの設定から特定のユーザーとの共有にて追加します。

メールアドレスのところに、サービスアカウントのメールアドレスを入れます。
※ダウンロードしたJSONのclient_emailにもあります。サンプルコードの実装
以下.Netのサンプルが公式にありましたので、そちらを参考にしてみます。
.Net Sampleとりあえずこぴって、環境に依存するところは変更。
また、サービスアカウントで認証する必要があるので以下を参考にして、credentialを作成するところは書き換えた。
Google Calendar API ServiceAccountCredential公開したカレンダーの直近
実行結果
正常に取得できているようです。(昔のイベントは無視で・・・)今回はここまでにします。
次回はカレンダー更新をやってみようと思います。
次回


