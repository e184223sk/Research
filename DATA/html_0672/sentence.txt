WPF, Xamarin.Forms, UWP で開発する人にとっては毎回頭を悩ませる INofityPropertyChanged インターフェースの実装を題材にして C# 9.0 のソース ジェネレーターで遊んでみました。因みに公式のサンプルにも既に INotifyPropertyChanged の実装を自動生成するサンプルはあったりします。Introducing C# Source Generatorsこちらのブログからたどれるサンプル集の中に AutoNotifyGenerator.cs というのがあって、それがサンプルでの INotifyPropertyChanged の実装を生成するソース ジェネレーターです。AutoNotifyGenerator.csこれは本当に基本的な機能しかないので、これを参考にちょっと自分なりのを作ってみました。ジェネレーター自体は所定の NuGet パッケージを参照追加して ISourceGenerator を実装したクラスに Generator 属性つけるくらいなので簡単なのですが、人が記述したソースコードを参照するための roslyn 系の XxxxDeclarationSyntax や IXxxxSymbol あたりの使い方を調べるのが大変です。なかなか情報がない…。愚痴は置いておいて今回試しに作ってみたのは以下のようなコードを書いておくとこんな感じのソースを生成してくれるものです。(厳密には、ちょっと違いますがこんなイメージ）勉強用としては、いい題材だったと思います。ソースコードは GitHub にあげておきました。実際に使えるようにしようと思うと、後は DataAnnotations くらいには対応したいかな？？作ってる過程で岩永さんが、すごい参考になるアナライザーを作ってたということを教えてくれたので、参考にさせてもらいました。多謝！！一応、1回通しで computed property の中身追って参照されてるプロパティを自動判定ってのはできはするというか、 https://t.co/MILha1ATUS では自動判定やってたり。


