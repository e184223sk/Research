More than 1 year has passed since last update.まずは普通に登録してみます。さて。
これだと、ログインしている状態じゃないと動きません。
それでもいいなら、十分です。「いちいち色々な設定を記載して登録するのとか面倒じゃない？」
ということで、一度テンプレートとなるようなXMLを作成してからタスクを登録する方法です。XMLをタスクスケジューラに登録します。
といっても、command部分を以下のようにするだけです。仮に、テンプレートを読み込んで編集したい場合があれば、XMLを読み込んだ後、追加したり変更したりします。サインアウト時にも動くようにしたいので、登録時のユーザをSYSTEMにしてみます。これで実行ユーザがSYSTEM（たぶん、最上位）になる。ただし、ツールを起動したときのアカウントの権限次第ですが、タスクが登録されているかどうかの確認でエラーになります。タスクが登録されているかどうかを判定する必要がないなら、このままでもOKです。色々こねくり回してます。前提として、エクスポートするタスクの設定は、最低でも以下のようにしています。まず、バッチファイルをもう一つ作ります。
保存パスを動的に変更したいなら、バッチファイルを動的に作ります。次に、Processも少し設定をいじります。この方法をとると、ユーザIDとパスワードをユーザに入力させることができます。
とはいえ、逆に管理アカウントのパスワードを知らないとダメだったりするので、他のを使った方が良い場合もあると思います。とりあえず、私がやりたかったことはこれで実現できたということで。


