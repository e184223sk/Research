More than 3 years have passed since last update.Windowsスポットライトは、Windows起動時にきれいな写真を表示する機能。
この写真を取得し起動時にデスクトップの壁紙として貼り付けるプログラムを作ろう。スポットライトの画像は「C:\Users(ユーザ名)\AppData\Local\Packages\Microsoft.Windows.ContentDeliveryManager_cw5n1h2txyewy\LocalState\Assets」に拡張子が消えた状態で置かれる。この中にどういう決まりで画像が追加されているのかは調査中なので、今回は一番サイズの大きい画像を取り出して使う。VisualStudio2015でC#で作る。C#のWindowsFormApplicationのプロジェクトを作る。program.csに書き込むコードは以下。SystemParamertersInfoがミソ。StringBuilderで指定したパスの画像をデスクトップの背景にする。ビルドすると，VisualStudioのプロジェクトの「/Debug/bin」内にexeファイルができる。
これを「C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp」に置く。
これでWindows起動時に実行される。


