<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#+POS for .NETでサーマルプリンター等のPOS機器を制御する - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/Automatic9045/items/64073010955ceb8928be" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="OClnX4BZsaNSVx9Yq5B20uTxJ/q9e+1DSIuyhtso4ZDz5JkVihcrHtruBmmKiLyAMuRxpx3Yh3dmfWbVBov+zg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@atF9045" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#+POS for .NETでサーマルプリンター等のPOS機器を制御する - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReU1yVUU5VElHWnZjaUF1VGtWVTQ0R240NEsxNDRPODQ0T2U0NE9yNDRPWDQ0T3E0NE96NDRLXzQ0Tzg1NjJKNDRHdVVFOVQ1cW1mNVptbzQ0S1M1WWkyNWI2aDQ0R1o0NEtMJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTgzZmZiY2RhYzg4YTljNDdmMzUwMjM3NTg1YmRlMTg0&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRUYxZEc5dFlYUnBZemt3TkRVJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9YTVlOTdhOGIxNDM3N2JkN2NmNTg4Nzk3OWMwYjRkZTk&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=e423166e3c75b8518e0ba9f4aac21fc0"><meta property="og:description" content="これは「C#によるPOSレジ・サーマルプリンター開発入門」と称して連載している記事の1つです。他はこちら

やっとプログラミングに辿り着きました。ここまで長かった……


1. はじめに

この記事では、Microsoft Point..."><meta content="https://qiita.com/Automatic9045/items/64073010955ceb8928be" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,入門,レシート,サーマルプリンタ,POSfor.NET" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-d9248ce2-debf-4511-a008-28ae33bafbeb"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FAutomatic9045%2Fitems%2F64073010955ceb8928be">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FAutomatic9045%2Fitems%2F64073010955ceb8928be">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-d9248ce2-debf-4511-a008-28ae33bafbeb">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-07-31T18:39:20.000+09:00","dateModified":"2021-03-25T21:06:23.000+09:00","headline":"C#+POS for .NETでサーマルプリンター等のPOS機器を制御する","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReU1yVUU5VElHWnZjaUF1VGtWVTQ0R240NEsxNDRPODQ0T2U0NE9yNDRPWDQ0T3E0NE96NDRLXzQ0Tzg1NjJKNDRHdVVFOVQ1cW1mNVptbzQ0S1M1WWkyNWI2aDQ0R1o0NEtMJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTgzZmZiY2RhYzg4YTljNDdmMzUwMjM3NTg1YmRlMTg0\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRUYxZEc5dFlYUnBZemt3TkRVJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9YTVlOTdhOGIxNDM3N2JkN2NmNTg4Nzk3OWMwYjRkZTk\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=e423166e3c75b8518e0ba9f4aac21fc0","mainEntityOfPage":"https://qiita.com/Automatic9045/items/64073010955ceb8928be","author":{"@type":"Person","address":"","email":null,"identifier":"Automatic9045","name":"Automatic9045","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars3.githubusercontent.com%2Fu%2F67314487%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=1fcd88061fba6a95f909edc1358e6d41","url":"https://qiita.com/Automatic9045","description":"メインはC#、他色々。\r\nサーマルプリンター等のPOS系の機器が大好物です。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202105-uzabase/?utm_source=qiita&amp;utm_medium=header-banner">自己組織化されたユーザベースSaaS Product Teamが面白い理由</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202105-uzabase/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Automatic9045","type":"items","id":"64073010955ceb8928be"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"自己組織化されたユーザベースSaaS Product Teamが面白い理由","url":"https://zine.qiita.com/interview/202105-uzabase/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Automatic9045","type":"items","id":"64073010955ceb8928be"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"自己組織化されたユーザベースSaaS Product Teamが面白い理由","url":"https://zine.qiita.com/interview/202105-uzabase/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Automatic9045","type":"items","id":"64073010955ceb8928be"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"自己組織化されたユーザベースSaaS Product Teamが面白い理由","url":"https://zine.qiita.com/interview/202105-uzabase/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/Automatic9045/items/64073010955ceb8928be","location":"/Automatic9045/items/64073010955ceb8928be","scheme":"https","host":"qiita.com","port":null,"pathname":"/Automatic9045/items/64073010955ceb8928be","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"cRRxSag/SqcsfB5EIBvt4B3biHDKb26Rfk70b+NKC3W62Y8DonHQGqTFB3UBAyeyy87eLWrMBKVQuCA8PukUKw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-ee6197c1-34cd-4532-aa96-c383e828f506"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Automatic9045/items/64073010955ceb8928be/likers" class="css-1iupg5d">4</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">3</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/64073010955ceb8928be/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Automatic9045/items/64073010955ceb8928be/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Automatic9045/items/64073010955ceb8928be/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Automatic9045/items/64073010955ceb8928be/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Automatic9045/items/64073010955ceb8928be.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/Automatic9045"><img class="css-100alwu eyfquo10" src="https://avatars3.githubusercontent.com/u/67314487?v=4" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/Automatic9045" class="css-10ougpm">@<!-- -->Automatic9045</a><div class="css-1ay9vb9"><span><meta content="2020-07-31T09:39:20Z"/><time dateTime="2021-03-25T12:06:23Z" class="css-m19uds">updated at 2021-03-25</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#+POS for .NETでサーマルプリンター等のPOS機器を制御する</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e5%85%a5%e9%96%80" class="css-4czcte">入門</a><a href="/tags/%e3%83%ac%e3%82%b7%e3%83%bc%e3%83%88" class="css-4czcte">レシート</a><a href="/tags/%e3%82%b5%e3%83%bc%e3%83%9e%e3%83%ab%e3%83%97%e3%83%aa%e3%83%b3%e3%82%bf" class="css-4czcte">サーマルプリンタ</a><a href="/tags/posfor.net" class="css-4czcte">POSfor.NET</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><strong>これは「C#によるPOSレジ・サーマルプリンター開発入門」と称して連載している記事の1つです。他は<a href="https://qiita.com/Automatic9045/items/0c8d05e1aa6255f7bd1c" id="reference-5b3d6c236d80b91d1c6a">こちら</a></strong></p>

<p>やっとプログラミングに辿り着きました。ここまで長かった……</p>

<h1>
<span id="1-はじめに" class="fragment"></span><a href="#1-%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>1. はじめに</h1>

<p>この記事では、Microsoft Point of Service for .NET（POS for .NET）を用いてPOS機器を制御する方法を説明します。<br>
なお、私に教えてくれるような人など周りにいなかったため、ここに書いてあるのはサンプルやマニュアルの見ながらの完全独学な知識です。「ここ良くないよー」という所があれば教えて下さると泣いて喜びます。</p>

<p>機器を購入する際のポイントやPOS for .NET以外の機器制御方法については、記事の一番上にあるリンクから見ることが出来ます。良ければ参考にして下さい。</p>

<h1>
<span id="2-この記事の対象読者" class="fragment"></span><a href="#2-%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AE%E5%AF%BE%E8%B1%A1%E8%AA%AD%E8%80%85"><i class="fa fa-link"></i></a>2. この記事の対象読者</h1>

<ul>
<li>POS開発に興味があるが、やったことは無くやり方も知らない人</li>
<li>面白そうだったので感熱プリンターを買ってみたものの、動かし方が分からず途方に暮れている人</li>
</ul>

<h1>
<span id="3-pos-for-netって" class="fragment"></span><a href="#3-pos-for-net%E3%81%A3%E3%81%A6"><i class="fa fa-link"></i></a>3. POS for .NETって？</h1>

<p>Microsoftが定めた、POS機器を扱うための共通規格です。機器メーカーにPOS for .NETを通じて動作させるドライバーを作らせることで、使用する機器を入れ替えても今までのコードをそのまま使えるのがポイントです。</p>

<h1>
<span id="4-基礎" class="fragment"></span><a href="#4-%E5%9F%BA%E7%A4%8E"><i class="fa fa-link"></i></a>4. 基礎</h1>

<p>※POS for .NETで機器を制御するには、事前にPOS for .NETとその機器のOPOS（POS for .NET）対応ドライバーをPCにインストールする必要があります。</p>

<h2>
<span id="機器を動作させ終了するまでの流れ" class="fragment"></span><a href="#%E6%A9%9F%E5%99%A8%E3%82%92%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E7%B5%82%E4%BA%86%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E3%81%AE%E6%B5%81%E3%82%8C"><i class="fa fa-link"></i></a>機器を動作させ、終了するまでの流れ</h2>

<ol>
<li>
<code>Open()</code>する</li>
<li>
<code>Claim()</code>する</li>
<li>
<code>DeviceEnabled</code>を<code>true</code>に</li>
<li>印刷とか表示とか</li>
<li>
<code>DeviceEnabled</code>を<code>false</code>に</li>
<li>
<code>Release()</code>する</li>
<li>
<code>Close()</code>する</li>
</ol>

<p>このあたりの流れは、POS for .NETのSDKに入っているサンプルアプリケーション（Microsoft Point Of Service\SDK\Samples\Sample Application\TestApp.exe）が非常に分かりやすいです。<br>
<a href="https://camo.qiitausercontent.com/b699238ef59c58ab8cc63275ef0af91a5ed6284c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f65326639306663312d366462362d396365392d633432382d3062383266633661363766642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2f90fc1-6db6-9ce9-c428-0b82fc6a67fd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=cc99a9b92d6df5d67231b84a391baa5e" alt="初期状態" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/e2f90fc1-6db6-9ce9-c428-0b82fc6a67fd.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2f90fc1-6db6-9ce9-c428-0b82fc6a67fd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=831b1d746c6628ad52edf943c0dacf1d 1x" loading="lazy"></a></p>

<p>左のメニューから制御したい機器を選択します。ここではEPSON OPOS ADK同梱のSetupPOSで事前に登録しておいたEPSON DM-D30を使用します。なお、このサンプルアプリケーション内で使える機器のシミュレーターも準備されているので、機器を持っていなくても使い勝手を試してみることが出来ます。<br>
<a href="https://camo.qiitausercontent.com/775838740d62ce7769058fb411e3210cdd835499/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f37626232356263382d353162652d346266302d346136302d3930393736373438353164312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F7bb25bc8-51be-4bf0-4a60-9097674851d1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f53eb99ddccd5ea6d62703f629a1e4ef" alt="LineDisplayを選択" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/7bb25bc8-51be-4bf0-4a60-9097674851d1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F7bb25bc8-51be-4bf0-4a60-9097674851d1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2dc3846ea26a06c97698003b17db1b2c 1x" loading="lazy"></a></p>

<p>Openボタン→Claimボタン→DeviceEnabledチェックボックスの順に押します。これで機器が使用可能が状態になりました。<br>
<a href="https://camo.qiitausercontent.com/7ef67b3ed08c088b10ac2c38bf85dc7ab08c2435/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f65323639376565622d646437352d613266382d613062632d3034366430613564623631322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2697eeb-dd75-a2f8-a0bc-046d0a5db612.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b72edaa26b83ae2e7874142f9be13b79" alt="機器が使用可能な状態になりました" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/e2697eeb-dd75-a2f8-a0bc-046d0a5db612.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2697eeb-dd75-a2f8-a0bc-046d0a5db612.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=01a40e7d7e8133eea74c3d52ca28e6ad 1x" loading="lazy"></a></p>

<p>ここでは無難に「Hello, POS for .NET!」とでも表示することにします。「Hello, POS for .NET!」と入力し、Display Textボタンを押します。<br>
問題が無ければ、これで無事表示されたはずです。<br>
<a href="https://camo.qiitausercontent.com/d3f9de0be76d017a5edde35bccd864efe0068cc8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f62306165313766642d376534332d643631372d633362622d6535666162646237356533662e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fb0ae17fd-7e43-d617-c3bb-e5fabdb75e3f.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5b515c715d353c8f19bc4ea7015c59b7" alt="無事表示されました" title="無事表示されました" width="600" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/b0ae17fd-7e43-d617-c3bb-e5fabdb75e3f.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fb0ae17fd-7e43-d617-c3bb-e5fabdb75e3f.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=71d07c1070b31ee9d8cede4752eb7444 1x" loading="lazy"></a></p>

<p>終了するときは、DeviceEnabledチェックボックス→Releaseボタン→Closeボタンの順に押します。<br>
<a href="https://camo.qiitausercontent.com/bb380c0f2130f9085eea0066536af53143ec058b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f30396538653631302d303263342d653362312d356330392d6539303931333731303633642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F09e8e610-02c4-e3b1-5c09-e9091371063d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=167658b92ec027e0e45df750c5c43dc2" alt="c.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/09e8e610-02c4-e3b1-5c09-e9091371063d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F09e8e610-02c4-e3b1-5c09-e9091371063d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=456593620ff7067f4d06706f9d763aab 1x" loading="lazy"></a></p>

<p>OPOSの正式名称は「OLE for Retail POS」、要するにPOS for .NETのラップ元はOLEです。なので、<font color="red"><strong>この終了処理を怠ると、オブジェクトが解放されずプロセスに残り続けます。また、プロセスが残るせいで、他のアプリケーションがOPOSのサービスを利用できなくなります。</strong></font>終了処理はちゃんとやりましょう。</p>

<h1>
<span id="5-実際にコードを書いてみる" class="fragment"></span><a href="#5-%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>5. 実際にコードを書いてみる</h1>

<p>前項でボタンやチェックボックスを操作していたところをコードに落とし込むのみで、基本形が完成します。</p>

<p>以下のサンプルコードを使う場合は<code>Microsoft.PointOfService</code>名前空間をusingして下さい。</p>

<h2>
<span id="カスタマーディスプレイの場合" class="fragment"></span><a href="#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%83%BC%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>カスタマーディスプレイの場合</h2>

<h3>
<span id="前準備" class="fragment"></span><a href="#%E5%89%8D%E6%BA%96%E5%82%99"><i class="fa fa-link"></i></a>前準備</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">PosExplorer</span> <span class="n">posExplorer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PosExplorer</span><span class="p">();</span>
<span class="n">DeviceInfo</span> <span class="n">deviceInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
<span class="n">deviceInfo</span> <span class="p">=</span> <span class="n">PosExplorer</span><span class="p">.</span><span class="nf">GetDevice</span><span class="p">(</span><span class="n">DeviceType</span><span class="p">.</span><span class="n">LineDisplay</span><span class="p">,</span> <span class="s">"MyLineDisplay"</span><span class="p">);</span> <span class="c1">// 論理デバイス名が「MyLineDisplay」のカスタマーディスプレイを見つける</span>
<span class="n">LineDisplay</span> <span class="n">lineDisplay</span> <span class="p">=</span> <span class="p">(</span><span class="n">LineDisplay</span><span class="p">)</span><span class="n">PosExplorer</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">deviceInfo</span><span class="p">);</span> <span class="c1">// DeviceInfoからカスタマーディスプレイのインスタンスを作成</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">Claim</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span> <span class="c1">// 1000ミリ秒でタイムアウトし、Claimに失敗する</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">DeviceEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

<span class="n">lineDisplay</span><span class="p">.</span><span class="n">CharacterSet</span> <span class="p">=</span> <span class="m">932</span><span class="p">;</span> <span class="c1">// カスタマーディスプレイで表示させる言語に日本語を設定</span>
</code></pre></div></div>

<h3>
<span id="実際に動作させる部分のコード" class="fragment"></span><a href="#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E3%82%8B%E9%83%A8%E5%88%86%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>実際に動作させる部分のコード</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">lineDisplay</span><span class="p">.</span><span class="nf">DisplayText</span><span class="p">(</span><span class="s">"Hello, POS for .NET!"</span><span class="p">,</span> <span class="n">DisplayTextMode</span><span class="p">.</span><span class="n">Normal</span><span class="p">);</span> <span class="c1">// カスタマーディスプレイに「Hello, POS for .NET!」と表示</span>
</code></pre></div></div>

<h3>
<span id="後始末" class="fragment"></span><a href="#%E5%BE%8C%E5%A7%8B%E6%9C%AB"><i class="fa fa-link"></i></a>後始末</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">lineDisplay</span><span class="p">.</span><span class="n">DeviceEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">Release</span><span class="p">();</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
</code></pre></div></div>

<p>どう書くのか知ってさえいれば簡単ですね。</p>

<h2>
<span id="カスタマーディスプレイで一部のみスクロール表示させる" class="fragment"></span><a href="#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%83%BC%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4%E3%81%A7%E4%B8%80%E9%83%A8%E3%81%AE%E3%81%BF%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E8%A1%A8%E7%A4%BA%E3%81%95%E3%81%9B%E3%82%8B"><i class="fa fa-link"></i></a>カスタマーディスプレイで一部のみスクロール表示させる</h2>

<p>ちなみにカスタマーディスプレイの場合は、ウィンドウを作成して1行目に「いらっしゃいませ」を固定表示し、2行目にお知らせをスクロール表示する、といったことも出来ます。最適化できているかは怪しいですが、以下のように書きます。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// LineDisplay.CreateWindow(viewportRow, viewportColumn, viewportHeight, viewportWidth, windowHeight, windowWidth);</span>

<span class="c1">// ウィンドウ（ID=0）</span>
<span class="c1">// ウィンドウのIDは作った順につけられていきます</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">CreateWindow</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">21</span><span class="p">);</span> <span class="c1">// ウィンドウを作成</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeFormat</span> <span class="p">=</span> <span class="n">DisplayMarqueeFormat</span><span class="p">.</span><span class="n">Place</span><span class="p">;</span> <span class="c1">// 固定表示に設定</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeType</span> <span class="p">=</span> <span class="n">DisplayMarqueeType</span><span class="p">.</span><span class="n">Init</span><span class="p">;</span> <span class="c1">// 初期化処理中フラグを立てる</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">DisplayText</span><span class="p">(</span><span class="s">"いらっしゃいませ"</span><span class="p">,</span> <span class="n">DisplayTextMode</span><span class="p">.</span><span class="n">Normal</span><span class="p">);</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeType</span> <span class="p">=</span> <span class="n">DisplayMarqueeType</span><span class="p">.</span><span class="n">None</span><span class="p">;</span> <span class="c1">// スクロール無しで表示</span>

<span class="c1">// ウィンドウ（ID=1）</span>
<span class="kt">string</span> <span class="n">scrollingMessage</span> <span class="p">=</span> <span class="s">"ご利用ありがとうございます。只今の時間帯、お惣菜がなんと９割引！是非お買い求め下さい！！"</span><span class="p">;</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">CreateWindow</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">20</span> <span class="p">+</span> <span class="m">2</span> <span class="p">*</span> <span class="n">scrollingMessage</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span> <span class="c1">// ウィンドウを作成。全角は2文字としてカウント</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeFormat</span> <span class="p">=</span> <span class="n">DisplayMarqueeFormat</span><span class="p">.</span><span class="n">Walk</span><span class="p">;</span> <span class="c1">// スクロール表示に設定</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeType</span> <span class="p">=</span> <span class="n">DisplayMarqueeType</span><span class="p">.</span><span class="n">Init</span><span class="p">;</span> <span class="c1">// 初期化処理中フラグを立てる</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeRepeatWait</span> <span class="p">=</span> <span class="m">1000</span><span class="p">;</span> <span class="c1">// スクロールし切ってからまた現れるまでのミリ秒数</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeUnitWait</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span> <span class="c1">// 半角1文字分スクロールするのにかかるミリ秒数</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="nf">DisplayText</span><span class="p">(</span><span class="n">scrollingMessage</span><span class="p">,</span> <span class="n">DisplayTextMode</span><span class="p">.</span><span class="n">Normal</span><span class="p">);</span>
<span class="n">lineDisplay</span><span class="p">.</span><span class="n">MarqueeType</span> <span class="p">=</span> <span class="n">DisplayMarqueeType</span><span class="p">.</span><span class="n">Left</span><span class="p">;</span> <span class="c1">// 左方向にスクロール</span>
</code></pre></div></div>

<h2>
<span id="サーマルプリンターの場合" class="fragment"></span><a href="#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>サーマルプリンターの場合</h2>

<p>カスタマディスプレイ以外でも、前準備と後始末の書き方はほぼ同じです。</p>

<h3>
<span id="前準備-1" class="fragment"></span><a href="#%E5%89%8D%E6%BA%96%E5%82%99-1"><i class="fa fa-link"></i></a>前準備</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">PosExplorer</span> <span class="n">posExplorer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PosExplorer</span><span class="p">();</span>
<span class="n">DeviceInfo</span> <span class="n">deviceInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
<span class="n">deviceInfo</span> <span class="p">=</span> <span class="n">PosExplorer</span><span class="p">.</span><span class="nf">GetDevice</span><span class="p">(</span><span class="n">DeviceType</span><span class="p">.</span><span class="n">PosPrinter</span><span class="p">,</span> <span class="s">"MyPosPrinter"</span><span class="p">);</span> <span class="c1">// 論理デバイス名が「MyPosPrinter」のサーマルプリンターを見つける</span>
<span class="n">PosPrinter</span> <span class="n">posPrinter</span> <span class="p">=</span> <span class="p">(</span><span class="n">PosPrinter</span><span class="p">)</span><span class="n">PosExplorer</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">deviceInfo</span><span class="p">);</span> <span class="c1">// DeviceInfoからサーマルプリンターのインスタンスを作成</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">Claim</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span> <span class="c1">// 1000ミリ秒でタイムアウトし、Claimに失敗する</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="n">DeviceEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</code></pre></div></div>

<h3>
<span id="後始末-1" class="fragment"></span><a href="#%E5%BE%8C%E5%A7%8B%E6%9C%AB-1"><i class="fa fa-link"></i></a>後始末</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">posPrinter</span><span class="p">.</span><span class="n">DeviceEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">Release</span><span class="p">();</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
</code></pre></div></div>

<h2>
<span id="サーマルプリンターで印刷する基礎" class="fragment"></span><a href="#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A7%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B%E5%9F%BA%E7%A4%8E"><i class="fa fa-link"></i></a>サーマルプリンターで印刷する基礎</h2>

<p>カスタマーディスプレイと異なり、印刷に関しては難解です。<br>
まずは基本的なコードです。「Hello, POS for .NET!」と印刷し、紙をカットします。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintNormal</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="s">"Hello, POS for .NET!"</span><span class="p">);</span> <span class="c1">// サーマルプリンターで「Hello, POS for .NET!」と印刷</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintNormal</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="s">"\u001b|100fP"</span><span class="p">);</span> <span class="c1">// ESC|100fP：カッター位置までフィードし、フルカット。100を1～99に変えるとパーシャルカット（1点残しカット）、fPをPに変えるとフィードせずカットのみ行う</span>
</code></pre></div></div>

<p>印字以外の特殊な操作を行うには、エスケープシーケンスを<code>PrintNormal</code>メソッドから送信します。このエスケープシーケンスはESC/POSコマンドとは異なったものです。リファレンスは<a href="https://jpn.nec.com/printer/label/download/user/printer/pdf/MC320S2DC_OPOS_APG.pdf#%5B%7B%22num%22%3A387%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C84%2C728%2C0%5D" rel="nofollow noopener" target="_blank">こちら</a>からどうぞ。<br>
紙をカットするための<code>CutPaper</code>メソッドもあるのですが、EPSON OPOS ADK同梱のサンプルではコマンドを送信する方法で記述されていたので、恐らくこちらの方が良いのでしょう。</p>

<h2>
<span id="サーマルプリンターで画像を印刷する" class="fragment"></span><a href="#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A7%E7%94%BB%E5%83%8F%E3%82%92%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>サーマルプリンターで画像を印刷する</h2>

<p>画像を印刷する方法は3通りあります。</p>

<ul>
<li>プリンターの記憶領域に事前に画像を保存しておき、それを印刷する（<code>SetBitmap</code>メソッド+<code>ESC|B</code>）</li>
<li>画像ファイルのパスを指定して印刷する（<code>PrintBitmap</code>メソッド）</li>
<li>画像をコードで生成して印刷する（<code>PrintMemoryBitmap</code>メソッド）</li>
</ul>

<p><font color="red"><strong>画像の印刷には罠が2つ仕掛けられています。</strong></font>これについては<a href="https://qiita.com/Automatic9045/items/6ff588da95e94aa708c4" id="reference-59fb7b91349c23b72401">別の記事</a>でまとめたので、良ければそちらも参照して下さい。</p>

<h3>
<span id="プリンターの記憶領域に事前に画像を保存しておきそれを印刷する" class="fragment"></span><a href="#%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E8%A8%98%E6%86%B6%E9%A0%98%E5%9F%9F%E3%81%AB%E4%BA%8B%E5%89%8D%E3%81%AB%E7%94%BB%E5%83%8F%E3%82%92%E4%BF%9D%E5%AD%98%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8D%E3%81%9D%E3%82%8C%E3%82%92%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>プリンターの記憶領域に事前に画像を保存しておき、それを印刷する</h3>

<p>店のロゴを毎回レシートの先頭に印刷する場合、決まった割引の案内を末尾に印刷する場合などは、毎回PCから画像のデータを送信すると時間がかかってしまうため、あらかじめプリンターの記憶領域に画像を保存しておくという手法をとります。</p>

<p>※文字列を組み合わせてロゴを作成する<code>SetLogo</code>メソッドもありますが、ここでは割愛します。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// 前準備で以下のコードを実行</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="n">RecLetterQuality</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// 画像を劣化させずに印刷</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="n">MapMode</span> <span class="p">=</span> <span class="n">MapMode</span><span class="p">.</span><span class="n">Dots</span><span class="p">;</span> <span class="c1">// 単位をドットに設定（省略可）</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">SetBitmap</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="s">"discount.bmp"</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapAsIs</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapCenter</span><span class="p">);</span> <span class="c1">// discount.bmpを拡大縮小せず、センタリングして印刷するよう、ID1として保存</span>
<span class="c1">// ここまで</span>

<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintNormal</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="s">"\u001b|1B"</span><span class="p">);</span> <span class="c1">// ID1で保存されていた画像を印刷</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintNormal</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="s">"\u001b|99fP"</span><span class="p">);</span> <span class="c1">// カッター位置までフィードし、パーシャルカット</span>
</code></pre></div></div>

<h3>
<span id="画像ファイルのパスを指定して印刷する" class="fragment"></span><a href="#%E7%94%BB%E5%83%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%91%E3%82%B9%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%A6%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>画像ファイルのパスを指定して印刷する</h3>

<p>画像をプリンターの記憶領域に事前に保存せず、その都度読み込んでプリンターに送信する方法です。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// 前準備で以下のコードを実行</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="n">RecLetterQuality</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// 画像を劣化させずに印刷</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="n">MapMode</span> <span class="p">=</span> <span class="n">MapMode</span><span class="p">.</span><span class="n">Dots</span><span class="p">;</span> <span class="c1">// 単位をドットに設定（省略可）</span>
<span class="c1">// ここまで</span>

<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintBitmap</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="s">"bitmap.bmp"</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapAsIs</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapLeft</span><span class="p">);</span> <span class="c1">// bitmap.bmpを拡大縮小せず、左寄せして印刷</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintNormal</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="s">"\u001b|99fP"</span><span class="p">);</span> <span class="c1">// カッター位置までフィードし、パーシャルカット</span>
</code></pre></div></div>

<h3>
<span id="画像をコードで生成して印刷する" class="fragment"></span><a href="#%E7%94%BB%E5%83%8F%E3%82%92%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E7%94%9F%E6%88%90%E3%81%97%E3%81%A6%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>画像をコードで生成して印刷する</h3>

<p><code>System.Drawing.Bitmap</code>のインスタンスを渡して印刷する方法です。<br>
この方法で使用する<code>PrintMemoryBitmap</code>メソッドなのですが、<font color="red"><strong>渡すBitmapでGraphicsのインスタンスが作成されている場合、エラーが起こるという謎仕様となっています。</strong></font></p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="cm">/*
using System.Drawing;
using System.Drawing.Imaging;
using Microsoft.PointOfService;
*/</span>

<span class="n">Bitmap</span> <span class="n">baseBmp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Bitmap</span><span class="p">(</span><span class="m">200</span><span class="p">,</span> <span class="m">150</span><span class="p">,</span> <span class="n">PixelFormat</span><span class="p">.</span><span class="n">Format24bppRgb</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="n">Graphics</span> <span class="n">g</span> <span class="p">=</span> <span class="n">Graphics</span><span class="p">.</span><span class="nf">FromImage</span><span class="p">(</span><span class="n">baseBmp</span><span class="p">))</span> <span class="c1">// 透明なBitmapの全体に赤いバツ印を描く</span>
<span class="p">{</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">DrawLine</span><span class="p">(</span><span class="n">Pens</span><span class="p">.</span><span class="n">Red</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">bitmap</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">bitmap</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">DrawLine</span><span class="p">(</span><span class="n">Pens</span><span class="p">.</span><span class="n">Red</span><span class="p">,</span> <span class="n">bitmap</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">bitmap</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// これはダメ</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintMemoryBitmap</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="n">baseBmp</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapAsIs</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapRight</span><span class="p">);</span> <span class="c1">// Graphicsに汚染されたBitmapを渡すとエラーになる</span>

<span class="c1">// これもダメ</span>
<span class="n">Bitmap</span> <span class="n">newBmp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Bitmap</span><span class="p">(</span><span class="n">baseBmp</span><span class="p">);</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintMemoryBitmap</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="n">newBmp</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapAsIs</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapRight</span><span class="p">);</span> <span class="c1">// Bitmapを複製しても汚染は除去できない模様</span>
</code></pre></div></div>

<p>Graphicsを使えないとなるとこのメソッドの魅力がほぼ0になってしまうんですが……<br>
私はゴリ押しでなんとかやりました。詳しくは<a href="https://qiita.com/Automatic9045/items/6ff588da95e94aa708c4">こちら</a>へ。<br>
ここにはコードのみ載せておきます。</p>

<p><details><summary>コードを見たい方は展開して下さい</summary><div>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// 32bitアルファチャンネル付bmpを24bitに変換</span>
<span class="c1">// EPSON製のプリンターではアルファチャンネルが無視されて真っ黒になるため、アルファチャンネル無しに変換する必要がある</span>
<span class="n">BitmapData</span> <span class="n">bmpData</span> <span class="p">=</span> <span class="n">baseBmp</span><span class="p">.</span><span class="nf">LockBits</span><span class="p">(</span><span class="k">new</span> <span class="nf">Rectangle</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">baseBmp</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">baseBmp</span><span class="p">.</span><span class="n">Height</span><span class="p">),</span> <span class="n">ImageLockMode</span><span class="p">.</span><span class="n">ReadOnly</span><span class="p">,</span> <span class="n">PixelFormat</span><span class="p">.</span><span class="n">Format32bppArgb</span><span class="p">);</span>

<span class="kt">byte</span><span class="p">[]</span> <span class="n">basePixels</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="n">bmpData</span><span class="p">.</span><span class="n">Stride</span> <span class="p">*</span> <span class="n">bmpData</span><span class="p">.</span><span class="n">Height</span><span class="p">];</span>
<span class="n">Marshal</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">bmpData</span><span class="p">.</span><span class="n">Scan0</span><span class="p">,</span> <span class="n">basePixels</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">basePixels</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">stride</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="nf">Ceiling</span><span class="p">(</span><span class="m">3.0</span> <span class="p">*</span> <span class="n">bmpData</span><span class="p">.</span><span class="n">Width</span> <span class="p">/</span> <span class="m">4</span><span class="p">)</span> <span class="p">*</span> <span class="m">4</span><span class="p">;</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">pixels</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">14</span> <span class="p">+</span> <span class="m">40</span> <span class="p">+</span> <span class="n">stride</span> <span class="p">*</span> <span class="n">bmpData</span><span class="p">.</span><span class="n">Height</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">y</span> <span class="p">&lt;</span> <span class="n">bmpData</span><span class="p">.</span><span class="n">Height</span><span class="p">;</span> <span class="n">y</span><span class="p">++)</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="n">bmpData</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> <span class="n">x</span><span class="p">++)</span>
  <span class="p">{</span>
    <span class="kt">int</span> <span class="n">basePos</span> <span class="p">=</span> <span class="m">4</span> <span class="p">*</span> <span class="n">x</span> <span class="p">+</span> <span class="n">bmpData</span><span class="p">.</span><span class="n">Stride</span> <span class="p">*</span> <span class="n">y</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">pos</span> <span class="p">=</span> <span class="m">14</span> <span class="p">+</span> <span class="m">40</span> <span class="p">+</span> <span class="m">3</span> <span class="p">*</span> <span class="n">x</span> <span class="p">+</span> <span class="n">stride</span> <span class="p">*</span> <span class="p">(</span><span class="n">bmpData</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="n">y</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>

    <span class="n">pixels</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="m">255</span> <span class="p">+</span> <span class="p">(</span><span class="n">basePixels</span><span class="p">[</span><span class="n">basePos</span><span class="p">]</span> <span class="p">-</span> <span class="m">255</span><span class="p">)</span> <span class="p">*</span> <span class="n">basePixels</span><span class="p">[</span><span class="n">basePos</span> <span class="p">+</span> <span class="m">3</span><span class="p">]</span> <span class="p">/</span> <span class="m">255</span><span class="p">);</span>
    <span class="n">pixels</span><span class="p">[</span><span class="n">pos</span> <span class="p">+</span> <span class="m">1</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="m">255</span> <span class="p">+</span> <span class="p">(</span><span class="n">basePixels</span><span class="p">[</span><span class="n">basePos</span> <span class="p">+</span> <span class="m">1</span><span class="p">]</span> <span class="p">-</span> <span class="m">255</span><span class="p">)</span> <span class="p">*</span> <span class="n">basePixels</span><span class="p">[</span><span class="n">basePos</span> <span class="p">+</span> <span class="m">3</span><span class="p">]</span> <span class="p">/</span> <span class="m">255</span><span class="p">);</span>
    <span class="n">pixels</span><span class="p">[</span><span class="n">pos</span> <span class="p">+</span> <span class="m">2</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="m">255</span> <span class="p">+</span> <span class="p">(</span><span class="n">basePixels</span><span class="p">[</span><span class="n">basePos</span> <span class="p">+</span> <span class="m">2</span><span class="p">]</span> <span class="p">-</span> <span class="m">255</span><span class="p">)</span> <span class="p">*</span> <span class="n">basePixels</span><span class="p">[</span><span class="n">basePos</span> <span class="p">+</span> <span class="m">3</span><span class="p">]</span> <span class="p">/</span> <span class="m">255</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// bmpファイルのヘッダーバイナリを自作</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">bfSize</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">pixels</span><span class="p">.</span><span class="nf">GetLength</span><span class="p">(</span><span class="m">0</span><span class="p">));</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">biWidth</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">bmpData</span><span class="p">.</span><span class="n">Width</span><span class="p">);</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">biHeight</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">bmpData</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">biSizeImage</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">pixels</span><span class="p">.</span><span class="nf">GetLength</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">-</span> <span class="m">14</span> <span class="p">-</span> <span class="m">40</span><span class="p">);</span>

<span class="kt">byte</span><span class="p">[]</span> <span class="n">header</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">14</span> <span class="p">+</span> <span class="m">40</span><span class="p">]</span>
<span class="p">{</span>
  <span class="m">0x42</span><span class="p">,</span> <span class="m">0x4d</span><span class="p">,</span> <span class="c1">// bfType</span>
  <span class="n">bfSize</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">bfSize</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">bfSize</span><span class="p">[</span><span class="m">2</span><span class="p">],</span> <span class="n">bfSize</span><span class="p">[</span><span class="m">3</span><span class="p">],</span> <span class="c1">// bfSize</span>
  <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// bfReserved1</span>
  <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// bfReserved2</span>
  <span class="m">0x01</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// bfOffBits</span>

  <span class="m">0x28</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biSize</span>
  <span class="n">biWidth</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">biWidth</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">biWidth</span><span class="p">[</span><span class="m">2</span><span class="p">],</span> <span class="n">biWidth</span><span class="p">[</span><span class="m">3</span><span class="p">],</span> <span class="c1">// biWidth</span>
  <span class="n">biHeight</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">biHeight</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">biHeight</span><span class="p">[</span><span class="m">2</span><span class="p">],</span> <span class="n">biHeight</span><span class="p">[</span><span class="m">3</span><span class="p">],</span> <span class="c1">// biHeight</span>
  <span class="m">0x01</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biPlanes</span>
  <span class="m">0x18</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biBitCount</span>
  <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biCompression</span>
  <span class="n">biSizeImage</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">biSizeImage</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="n">biSizeImage</span><span class="p">[</span><span class="m">2</span><span class="p">],</span> <span class="n">biSizeImage</span><span class="p">[</span><span class="m">3</span><span class="p">],</span> <span class="c1">// biSizeImage</span>
  <span class="m">0xc4</span><span class="p">,</span> <span class="m">0x0e</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biXPixPerMeter</span>
  <span class="m">0xc4</span><span class="p">,</span> <span class="m">0x0e</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biYPixPerMeter</span>
  <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biCirUsed</span>
  <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="m">0x00</span><span class="p">,</span> <span class="c1">// biCirImportant</span>
<span class="p">};</span>


<span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">pixels</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">14</span> <span class="p">+</span> <span class="m">40</span><span class="p">);</span> <span class="c1">// ヘッダーとビットマップデータをくっつける</span>
<span class="n">Bitmap</span> <span class="n">newBmp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Bitmap</span><span class="p">(</span><span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">pixels</span><span class="p">));</span> <span class="c1">// Graphicsに汚染されていないBitmapの出来上がり</span>
<span class="n">posPrinter</span><span class="p">.</span><span class="nf">PrintMemoryBitmap</span><span class="p">(</span><span class="n">PrinterStation</span><span class="p">.</span><span class="n">Receipt</span><span class="p">,</span> <span class="n">newBmp</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapAsIs</span><span class="p">,</span> <span class="n">PosPrinter</span><span class="p">.</span><span class="n">PrinterBitmapRight</span><span class="p">);</span> <span class="c1">// これでOK</span>
</code></pre></div></div>

<p></p>
</div></details></p>

<p>もっと良い方法をご存知の方がいらっしゃれば教えて下さいm(_ _)m</p>

<h2>
<span id="キャッシュドロアの場合" class="fragment"></span><a href="#%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%83%89%E3%83%AD%E3%82%A2%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>キャッシュドロアの場合</h2>

<p>サーマルプリンターの場合とは打って変わってとても簡単なので、コードのみ載せておきます。</p>

<h3>
<span id="前準備-2" class="fragment"></span><a href="#%E5%89%8D%E6%BA%96%E5%82%99-2"><i class="fa fa-link"></i></a>前準備</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">PosExplorer</span> <span class="n">posExplorer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PosExplorer</span><span class="p">();</span>
<span class="n">DeviceInfo</span> <span class="n">deviceInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
<span class="n">deviceInfo</span> <span class="p">=</span> <span class="n">PosExplorer</span><span class="p">.</span><span class="nf">GetDevice</span><span class="p">(</span><span class="n">DeviceType</span><span class="p">.</span><span class="n">CashDrawer</span><span class="p">,</span> <span class="s">"MyCashDrawer"</span><span class="p">);</span>
<span class="n">CashDrawer</span> <span class="n">cashDrawer</span> <span class="p">=</span> <span class="p">(</span><span class="n">CashDrawer</span><span class="p">)</span><span class="n">PosExplorer</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">deviceInfo</span><span class="p">);</span>
<span class="n">cashDrawer</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
<span class="n">cashDrawer</span><span class="p">.</span><span class="nf">Claim</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span>
<span class="n">cashDrawer</span><span class="p">.</span><span class="n">DeviceEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</code></pre></div></div>

<h3>
<span id="実際に動作させる部分のコード-1" class="fragment"></span><a href="#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E3%82%8B%E9%83%A8%E5%88%86%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89-1"><i class="fa fa-link"></i></a>実際に動作させる部分のコード</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">cashDrawer</span><span class="p">.</span><span class="nf">OpenDrawer</span><span class="p">();</span> <span class="c1">// キャッシュドロアを開く</span>
</code></pre></div></div>

<h3>
<span id="後始末-2" class="fragment"></span><a href="#%E5%BE%8C%E5%A7%8B%E6%9C%AB-2"><i class="fa fa-link"></i></a>後始末</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">cashDrawer</span><span class="p">.</span><span class="n">DeviceEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="n">cashDrawer</span><span class="p">.</span><span class="nf">Release</span><span class="p">();</span>
<span class="n">cashDrawer</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
</code></pre></div></div>

<h2>
<span id="注意" class="fragment"></span><a href="#%E6%B3%A8%E6%84%8F"><i class="fa fa-link"></i></a>注意</h2>

<ul>
<li>PosExplorerのインスタンスを複数個作成しようとすると例外を吐きます。</li>
<li>POS for .NETを2個以上のアプリケーションから同時に呼び出すことは出来ません。</li>
</ul>

<h1>
<span id="6-終わりに" class="fragment"></span><a href="#6-%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>6. 終わりに</h1>

<p>この記事以外にもPOS開発関連の記事を投稿しています。もし良ければ<a href="https://qiita.com/Automatic9045/items/0c8d05e1aa6255f7bd1c">こちら</a>からどうぞ。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FAutomatic9045%2Fitems%2F64073010955ceb8928be&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FAutomatic9045%2Fitems%2F64073010955ceb8928be&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Automatic9045/items/64073010955ceb8928be/likers" class="css-1iupg5d">4</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">3</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/64073010955ceb8928be/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Automatic9045/items/64073010955ceb8928be/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Automatic9045/items/64073010955ceb8928be/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Automatic9045/items/64073010955ceb8928be/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Automatic9045/items/64073010955ceb8928be.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-ee6197c1-34cd-4532-aa96-c383e828f506">{"authorAnalyticsTrackingId":"UA-173968596-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-ba75e67a-2198-4799-93cd-f7772866be1a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-ba75e67a-2198-4799-93cd-f7772866be1a">{}</script>
      
<div id="LoginModal-react-component-5860d3bb-776c-44fc-bbe3-5d90530616db"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-5860d3bb-776c-44fc-bbe3-5d90530616db">{}</script>
      
<div id="StockModal-react-component-fec475b3-966d-4588-b4b4-87718bfcaec8"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-fec475b3-966d-4588-b4b4-87718bfcaec8">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;wL1P7HlaKLN1j8V+rjkvNBX+OjMZ+zUWiLBH8iiz79QLcLGmcxSyDv023E+PIeVmw+tsbrlYXyKmRpOh9RDwig==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003cstrong\u003eこれは「C#によるPOSレジ・サーマルプリンター開発入門」と称して連載している記事の1つです。他は\u003ca href=\"https://qiita.com/Automatic9045/items/0c8d05e1aa6255f7bd1c\" id=\"reference-5b3d6c236d80b91d1c6a\"\u003eこちら\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eやっとプログラミングに辿り着きました。ここまで長かった……\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"1-はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1-%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1. はじめに\u003c/h1\u003e\n\n\u003cp\u003eこの記事では、Microsoft Point of Service for .NET（POS for .NET）を用いてPOS機器を制御する方法を説明します。\u003cbr\u003e\nなお、私に教えてくれるような人など周りにいなかったため、ここに書いてあるのはサンプルやマニュアルの見ながらの完全独学な知識です。「ここ良くないよー」という所があれば教えて下さると泣いて喜びます。\u003c/p\u003e\n\n\u003cp\u003e機器を購入する際のポイントやPOS for .NET以外の機器制御方法については、記事の一番上にあるリンクから見ることが出来ます。良ければ参考にして下さい。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"2-この記事の対象読者\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2-%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AE%E5%AF%BE%E8%B1%A1%E8%AA%AD%E8%80%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2. この記事の対象読者\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003ePOS開発に興味があるが、やったことは無くやり方も知らない人\u003c/li\u003e\n\u003cli\u003e面白そうだったので感熱プリンターを買ってみたものの、動かし方が分からず途方に暮れている人\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"3-pos-for-netって\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3-pos-for-net%E3%81%A3%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3. POS for .NETって？\u003c/h1\u003e\n\n\u003cp\u003eMicrosoftが定めた、POS機器を扱うための共通規格です。機器メーカーにPOS for .NETを通じて動作させるドライバーを作らせることで、使用する機器を入れ替えても今までのコードをそのまま使えるのがポイントです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"4-基礎\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#4-%E5%9F%BA%E7%A4%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e4. 基礎\u003c/h1\u003e\n\n\u003cp\u003e※POS for .NETで機器を制御するには、事前にPOS for .NETとその機器のOPOS（POS for .NET）対応ドライバーをPCにインストールする必要があります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"機器を動作させ終了するまでの流れ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A9%9F%E5%99%A8%E3%82%92%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E7%B5%82%E4%BA%86%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E3%81%AE%E6%B5%81%E3%82%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e機器を動作させ、終了するまでの流れ\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003eOpen()\u003c/code\u003eする\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eClaim()\u003c/code\u003eする\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eDeviceEnabled\u003c/code\u003eを\u003ccode\u003etrue\u003c/code\u003eに\u003c/li\u003e\n\u003cli\u003e印刷とか表示とか\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eDeviceEnabled\u003c/code\u003eを\u003ccode\u003efalse\u003c/code\u003eに\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eRelease()\u003c/code\u003eする\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eClose()\u003c/code\u003eする\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eこのあたりの流れは、POS for .NETのSDKに入っているサンプルアプリケーション（Microsoft Point Of Service\\SDK\\Samples\\Sample Application\\TestApp.exe）が非常に分かりやすいです。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/b699238ef59c58ab8cc63275ef0af91a5ed6284c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f65326639306663312d366462362d396365392d633432382d3062383266633661363766642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2f90fc1-6db6-9ce9-c428-0b82fc6a67fd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=cc99a9b92d6df5d67231b84a391baa5e\" alt=\"初期状態\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/e2f90fc1-6db6-9ce9-c428-0b82fc6a67fd.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2f90fc1-6db6-9ce9-c428-0b82fc6a67fd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=831b1d746c6628ad52edf943c0dacf1d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e左のメニューから制御したい機器を選択します。ここではEPSON OPOS ADK同梱のSetupPOSで事前に登録しておいたEPSON DM-D30を使用します。なお、このサンプルアプリケーション内で使える機器のシミュレーターも準備されているので、機器を持っていなくても使い勝手を試してみることが出来ます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/775838740d62ce7769058fb411e3210cdd835499/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f37626232356263382d353162652d346266302d346136302d3930393736373438353164312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F7bb25bc8-51be-4bf0-4a60-9097674851d1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f53eb99ddccd5ea6d62703f629a1e4ef\" alt=\"LineDisplayを選択\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/7bb25bc8-51be-4bf0-4a60-9097674851d1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F7bb25bc8-51be-4bf0-4a60-9097674851d1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2dc3846ea26a06c97698003b17db1b2c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOpenボタン→Claimボタン→DeviceEnabledチェックボックスの順に押します。これで機器が使用可能が状態になりました。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/7ef67b3ed08c088b10ac2c38bf85dc7ab08c2435/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f65323639376565622d646437352d613266382d613062632d3034366430613564623631322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2697eeb-dd75-a2f8-a0bc-046d0a5db612.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b72edaa26b83ae2e7874142f9be13b79\" alt=\"機器が使用可能な状態になりました\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/e2697eeb-dd75-a2f8-a0bc-046d0a5db612.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fe2697eeb-dd75-a2f8-a0bc-046d0a5db612.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=01a40e7d7e8133eea74c3d52ca28e6ad 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここでは無難に「Hello, POS for .NET!」とでも表示することにします。「Hello, POS for .NET!」と入力し、Display Textボタンを押します。\u003cbr\u003e\n問題が無ければ、これで無事表示されたはずです。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d3f9de0be76d017a5edde35bccd864efe0068cc8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f62306165313766642d376534332d643631372d633362622d6535666162646237356533662e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fb0ae17fd-7e43-d617-c3bb-e5fabdb75e3f.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5b515c715d353c8f19bc4ea7015c59b7\" alt=\"無事表示されました\" title=\"無事表示されました\" width=\"600\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/b0ae17fd-7e43-d617-c3bb-e5fabdb75e3f.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2Fb0ae17fd-7e43-d617-c3bb-e5fabdb75e3f.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=71d07c1070b31ee9d8cede4752eb7444 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e終了するときは、DeviceEnabledチェックボックス→Releaseボタン→Closeボタンの順に押します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/bb380c0f2130f9085eea0066536af53143ec058b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3637373330322f30396538653631302d303263342d653362312d356330392d6539303931333731303633642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F09e8e610-02c4-e3b1-5c09-e9091371063d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=167658b92ec027e0e45df750c5c43dc2\" alt=\"c.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/677302/09e8e610-02c4-e3b1-5c09-e9091371063d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F677302%2F09e8e610-02c4-e3b1-5c09-e9091371063d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=456593620ff7067f4d06706f9d763aab 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOPOSの正式名称は「OLE for Retail POS」、要するにPOS for .NETのラップ元はOLEです。なので、\u003cfont color=\"red\"\u003e\u003cstrong\u003eこの終了処理を怠ると、オブジェクトが解放されずプロセスに残り続けます。また、プロセスが残るせいで、他のアプリケーションがOPOSのサービスを利用できなくなります。\u003c/strong\u003e\u003c/font\u003e終了処理はちゃんとやりましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"5-実際にコードを書いてみる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#5-%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e5. 実際にコードを書いてみる\u003c/h1\u003e\n\n\u003cp\u003e前項でボタンやチェックボックスを操作していたところをコードに落とし込むのみで、基本形が完成します。\u003c/p\u003e\n\n\u003cp\u003e以下のサンプルコードを使う場合は\u003ccode\u003eMicrosoft.PointOfService\u003c/code\u003e名前空間をusingして下さい。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"カスタマーディスプレイの場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%83%BC%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eカスタマーディスプレイの場合\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"前準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前準備\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e \u003cspan class=\"n\"\u003eposExplorer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDeviceInfo\u003c/span\u003e \u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDevice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"MyLineDisplay\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 論理デバイス名が「MyLineDisplay」のカスタマーディスプレイを見つける\u003c/span\u003e\n\u003cspan class=\"n\"\u003eLineDisplay\u003c/span\u003e \u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// DeviceInfoからカスタマーディスプレイのインスタンスを作成\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClaim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1000ミリ秒でタイムアウトし、Claimに失敗する\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceEnabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacterSet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e932\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// カスタマーディスプレイで表示させる言語に日本語を設定\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"実際に動作させる部分のコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E3%82%8B%E9%83%A8%E5%88%86%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実際に動作させる部分のコード\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDisplayText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Hello, POS for .NET!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayTextMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// カスタマーディスプレイに「Hello, POS for .NET!」と表示\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"後始末\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BE%8C%E5%A7%8B%E6%9C%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e後始末\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceEnabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRelease\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eどう書くのか知ってさえいれば簡単ですね。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"カスタマーディスプレイで一部のみスクロール表示させる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%83%BC%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4%E3%81%A7%E4%B8%80%E9%83%A8%E3%81%AE%E3%81%BF%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E8%A1%A8%E7%A4%BA%E3%81%95%E3%81%9B%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eカスタマーディスプレイで一部のみスクロール表示させる\u003c/h2\u003e\n\n\u003cp\u003eちなみにカスタマーディスプレイの場合は、ウィンドウを作成して1行目に「いらっしゃいませ」を固定表示し、2行目にお知らせをスクロール表示する、といったことも出来ます。最適化できているかは怪しいですが、以下のように書きます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// LineDisplay.CreateWindow(viewportRow, viewportColumn, viewportHeight, viewportWidth, windowHeight, windowWidth);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// ウィンドウ（ID=0）\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ウィンドウのIDは作った順につけられていきます\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e21\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ウィンドウを作成\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeFormat\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayMarqueeFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePlace\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 固定表示に設定\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayMarqueeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 初期化処理中フラグを立てる\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDisplayText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"いらっしゃいませ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayTextMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayMarqueeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// スクロール無しで表示\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// ウィンドウ（ID=1）\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003escrollingMessage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ご利用ありがとうございます。只今の時間帯、お惣菜がなんと９割引！是非お買い求め下さい！！\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e20\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003escrollingMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ウィンドウを作成。全角は2文字としてカウント\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeFormat\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayMarqueeFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWalk\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// スクロール表示に設定\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayMarqueeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 初期化処理中フラグを立てる\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeRepeatWait\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// スクロールし切ってからまた現れるまでのミリ秒数\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeUnitWait\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 半角1文字分スクロールするのにかかるミリ秒数\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDisplayText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003escrollingMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayTextMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003elineDisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarqueeType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayMarqueeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLeft\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 左方向にスクロール\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サーマルプリンターの場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサーマルプリンターの場合\u003c/h2\u003e\n\n\u003cp\u003eカスタマディスプレイ以外でも、前準備と後始末の書き方はほぼ同じです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"前準備-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前準備\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e \u003cspan class=\"n\"\u003eposExplorer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDeviceInfo\u003c/span\u003e \u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDevice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"MyPosPrinter\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 論理デバイス名が「MyPosPrinter」のサーマルプリンターを見つける\u003c/span\u003e\n\u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e \u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// DeviceInfoからサーマルプリンターのインスタンスを作成\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClaim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1000ミリ秒でタイムアウトし、Claimに失敗する\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceEnabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"後始末-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BE%8C%E5%A7%8B%E6%9C%AB-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e後始末\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceEnabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRelease\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サーマルプリンターで印刷する基礎\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A7%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B%E5%9F%BA%E7%A4%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサーマルプリンターで印刷する基礎\u003c/h2\u003e\n\n\u003cp\u003eカスタマーディスプレイと異なり、印刷に関しては難解です。\u003cbr\u003e\nまずは基本的なコードです。「Hello, POS for .NET!」と印刷し、紙をカットします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Hello, POS for .NET!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// サーマルプリンターで「Hello, POS for .NET!」と印刷\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\u001b|100fP\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ESC|100fP：カッター位置までフィードし、フルカット。100を1～99に変えるとパーシャルカット（1点残しカット）、fPをPに変えるとフィードせずカットのみ行う\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e印字以外の特殊な操作を行うには、エスケープシーケンスを\u003ccode\u003ePrintNormal\u003c/code\u003eメソッドから送信します。このエスケープシーケンスはESC/POSコマンドとは異なったものです。リファレンスは\u003ca href=\"https://jpn.nec.com/printer/label/download/user/printer/pdf/MC320S2DC_OPOS_APG.pdf#%5B%7B%22num%22%3A387%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C84%2C728%2C0%5D\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eからどうぞ。\u003cbr\u003e\n紙をカットするための\u003ccode\u003eCutPaper\u003c/code\u003eメソッドもあるのですが、EPSON OPOS ADK同梱のサンプルではコマンドを送信する方法で記述されていたので、恐らくこちらの方が良いのでしょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サーマルプリンターで画像を印刷する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A7%E7%94%BB%E5%83%8F%E3%82%92%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサーマルプリンターで画像を印刷する\u003c/h2\u003e\n\n\u003cp\u003e画像を印刷する方法は3通りあります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eプリンターの記憶領域に事前に画像を保存しておき、それを印刷する（\u003ccode\u003eSetBitmap\u003c/code\u003eメソッド+\u003ccode\u003eESC|B\u003c/code\u003e）\u003c/li\u003e\n\u003cli\u003e画像ファイルのパスを指定して印刷する（\u003ccode\u003ePrintBitmap\u003c/code\u003eメソッド）\u003c/li\u003e\n\u003cli\u003e画像をコードで生成して印刷する（\u003ccode\u003ePrintMemoryBitmap\u003c/code\u003eメソッド）\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cfont color=\"red\"\u003e\u003cstrong\u003e画像の印刷には罠が2つ仕掛けられています。\u003c/strong\u003e\u003c/font\u003eこれについては\u003ca href=\"https://qiita.com/Automatic9045/items/6ff588da95e94aa708c4\" id=\"reference-59fb7b91349c23b72401\"\u003e別の記事\u003c/a\u003eでまとめたので、良ければそちらも参照して下さい。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"プリンターの記憶領域に事前に画像を保存しておきそれを印刷する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E8%A8%98%E6%86%B6%E9%A0%98%E5%9F%9F%E3%81%AB%E4%BA%8B%E5%89%8D%E3%81%AB%E7%94%BB%E5%83%8F%E3%82%92%E4%BF%9D%E5%AD%98%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8D%E3%81%9D%E3%82%8C%E3%82%92%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプリンターの記憶領域に事前に画像を保存しておき、それを印刷する\u003c/h3\u003e\n\n\u003cp\u003e店のロゴを毎回レシートの先頭に印刷する場合、決まった割引の案内を末尾に印刷する場合などは、毎回PCから画像のデータを送信すると時間がかかってしまうため、あらかじめプリンターの記憶領域に画像を保存しておくという手法をとります。\u003c/p\u003e\n\n\u003cp\u003e※文字列を組み合わせてロゴを作成する\u003ccode\u003eSetLogo\u003c/code\u003eメソッドもありますが、ここでは割愛します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 前準備で以下のコードを実行\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRecLetterQuality\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 画像を劣化させずに印刷\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMapMode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMapMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDots\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 単位をドットに設定（省略可）\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"discount.bmp\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapAsIs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapCenter\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// discount.bmpを拡大縮小せず、センタリングして印刷するよう、ID1として保存\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ここまで\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\u001b|1B\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ID1で保存されていた画像を印刷\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\u001b|99fP\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// カッター位置までフィードし、パーシャルカット\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"画像ファイルのパスを指定して印刷する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%94%BB%E5%83%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%91%E3%82%B9%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%A6%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e画像ファイルのパスを指定して印刷する\u003c/h3\u003e\n\n\u003cp\u003e画像をプリンターの記憶領域に事前に保存せず、その都度読み込んでプリンターに送信する方法です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 前準備で以下のコードを実行\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRecLetterQuality\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 画像を劣化させずに印刷\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMapMode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMapMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDots\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 単位をドットに設定（省略可）\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ここまで\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"bitmap.bmp\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapAsIs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapLeft\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bitmap.bmpを拡大縮小せず、左寄せして印刷\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\u001b|99fP\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// カッター位置までフィードし、パーシャルカット\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"画像をコードで生成して印刷する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%94%BB%E5%83%8F%E3%82%92%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E7%94%9F%E6%88%90%E3%81%97%E3%81%A6%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e画像をコードで生成して印刷する\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eSystem.Drawing.Bitmap\u003c/code\u003eのインスタンスを渡して印刷する方法です。\u003cbr\u003e\nこの方法で使用する\u003ccode\u003ePrintMemoryBitmap\u003c/code\u003eメソッドなのですが、\u003cfont color=\"red\"\u003e\u003cstrong\u003e渡すBitmapでGraphicsのインスタンスが作成されている場合、エラーが起こるという謎仕様となっています。\u003c/strong\u003e\u003c/font\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cm\"\u003e/*\nusing System.Drawing;\nusing System.Drawing.Imaging;\nusing Microsoft.PointOfService;\n*/\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eBitmap\u003c/span\u003e \u003cspan class=\"n\"\u003ebaseBmp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e150\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePixelFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat24bppRgb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGraphics\u003c/span\u003e \u003cspan class=\"n\"\u003eg\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGraphics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromImage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebaseBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 透明なBitmapの全体に赤いバツ印を描く\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDrawLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDrawLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// これはダメ\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintMemoryBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebaseBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapAsIs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapRight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Graphicsに汚染されたBitmapを渡すとエラーになる\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// これもダメ\u003c/span\u003e\n\u003cspan class=\"n\"\u003eBitmap\u003c/span\u003e \u003cspan class=\"n\"\u003enewBmp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebaseBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintMemoryBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enewBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapAsIs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapRight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Bitmapを複製しても汚染は除去できない模様\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eGraphicsを使えないとなるとこのメソッドの魅力がほぼ0になってしまうんですが……\u003cbr\u003e\n私はゴリ押しでなんとかやりました。詳しくは\u003ca href=\"https://qiita.com/Automatic9045/items/6ff588da95e94aa708c4\"\u003eこちら\u003c/a\u003eへ。\u003cbr\u003e\nここにはコードのみ載せておきます。\u003c/p\u003e\n\n\u003cp\u003e\u003cdetails\u003e\u003csummary\u003eコードを見たい方は展開して下さい\u003c/summary\u003e\u003cdiv\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 32bitアルファチャンネル付bmpを24bitに変換\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// EPSON製のプリンターではアルファチャンネルが無視されて真っ黒になるため、アルファチャンネル無しに変換する必要がある\u003c/span\u003e\n\u003cspan class=\"n\"\u003eBitmapData\u003c/span\u003e \u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebaseBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLockBits\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRectangle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebaseBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebaseBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eImageLockMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReadOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePixelFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat32bppArgb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStride\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScan0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003estride\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCeiling\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e3.0\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003epixels\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e14\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e40\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003estride\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStride\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003epos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e14\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e40\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003estride\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003epixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003epos\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"m\"\u003e255\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePos\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePos\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003epos\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"m\"\u003e255\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePos\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePos\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003epos\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"m\"\u003e255\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePos\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePixels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePos\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// bmpファイルのヘッダーバイナリを自作\u003c/span\u003e\n\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebfSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epixels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebiWidth\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebiHeight\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebmpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebiSizeImage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epixels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e14\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e40\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eheader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e14\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e40\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x42\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x4d\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bfType\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebfSize\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebfSize\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebfSize\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebfSize\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bfSize\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bfReserved1\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bfReserved2\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x01\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bfOffBits\u003c/span\u003e\n\n  \u003cspan class=\"m\"\u003e0x28\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biSize\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebiWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biWidth\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebiHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biHeight\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x01\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biPlanes\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x18\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biBitCount\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biCompression\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebiSizeImage\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiSizeImage\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiSizeImage\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ebiSizeImage\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biSizeImage\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0xc4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x0e\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biXPixPerMeter\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0xc4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x0e\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biYPixPerMeter\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biCirUsed\u003c/span\u003e\n  \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// biCirImportant\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\n\u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epixels\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e14\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e40\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ヘッダーとビットマップデータをくっつける\u003c/span\u003e\n\u003cspan class=\"n\"\u003eBitmap\u003c/span\u003e \u003cspan class=\"n\"\u003enewBmp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMemoryStream\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epixels\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Graphicsに汚染されていないBitmapの出来上がり\u003c/span\u003e\n\u003cspan class=\"n\"\u003eposPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintMemoryBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterStation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceipt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enewBmp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapAsIs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePosPrinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrinterBitmapRight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// これでOK\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/details\u003e\u003c/p\u003e\n\n\u003cp\u003eもっと良い方法をご存知の方がいらっしゃれば教えて下さいm(_ _)m\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"キャッシュドロアの場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%83%89%E3%83%AD%E3%82%A2%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eキャッシュドロアの場合\u003c/h2\u003e\n\n\u003cp\u003eサーマルプリンターの場合とは打って変わってとても簡単なので、コードのみ載せておきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"前準備-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前準備\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e \u003cspan class=\"n\"\u003eposExplorer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDeviceInfo\u003c/span\u003e \u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDevice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"MyCashDrawer\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003eCashDrawer\u003c/span\u003e \u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ePosExplorer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edeviceInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClaim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceEnabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"実際に動作させる部分のコード-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E3%82%8B%E9%83%A8%E5%88%86%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実際に動作させる部分のコード\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpenDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e// キャッシュドロアを開く\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"後始末-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BE%8C%E5%A7%8B%E6%9C%AB-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e後始末\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeviceEnabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRelease\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecashDrawer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"注意\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B3%A8%E6%84%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e注意\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003ePosExplorerのインスタンスを複数個作成しようとすると例外を吐きます。\u003c/li\u003e\n\u003cli\u003ePOS for .NETを2個以上のアプリケーションから同時に呼び出すことは出来ません。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"6-終わりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#6-%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e6. 終わりに\u003c/h1\u003e\n\n\u003cp\u003eこの記事以外にもPOS開発関連の記事を投稿しています。もし良ければ\u003ca href=\"https://qiita.com/Automatic9045/items/0c8d05e1aa6255f7bd1c\"\u003eこちら\u003c/a\u003eからどうぞ。\u003c/p\u003e\n","createdAt":"2020-07-31T09:39:20Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"tH0QBCoj8Xal5Hd9JGFt5W9P9hCcBERejw==--HOXgweLoPG/i+RMq--YFhyKcl2LiQuZhBYaj5FGA==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2021-03-25T12:06:23Z","likesCount":4,"linkUrl":"https://qiita.com/Automatic9045/items/64073010955ceb8928be","organization":null,"originalId":1274207,"stockedCount":3,"title":"C#+POS for .NETでサーマルプリンター等のPOS機器を制御する","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1-%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e1. はじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2-%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AE%E5%AF%BE%E8%B1%A1%E8%AA%AD%E8%80%85\"\u003e2. この記事の対象読者\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#3-pos-for-net%E3%81%A3%E3%81%A6\"\u003e3. POS for .NETって？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#4-%E5%9F%BA%E7%A4%8E\"\u003e4. 基礎\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A9%9F%E5%99%A8%E3%82%92%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E7%B5%82%E4%BA%86%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E3%81%AE%E6%B5%81%E3%82%8C\"\u003e機器を動作させ、終了するまでの流れ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#5-%E5%AE%9F%E9%9A%9B%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e5. 実際にコードを書いてみる\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%83%BC%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eカスタマーディスプレイの場合\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99\"\u003e前準備\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E3%82%8B%E9%83%A8%E5%88%86%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89\"\u003e実際に動作させる部分のコード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BE%8C%E5%A7%8B%E6%9C%AB\"\u003e後始末\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%83%BC%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4%E3%81%A7%E4%B8%80%E9%83%A8%E3%81%AE%E3%81%BF%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E8%A1%A8%E7%A4%BA%E3%81%95%E3%81%9B%E3%82%8B\"\u003eカスタマーディスプレイで一部のみスクロール表示させる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eサーマルプリンターの場合\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99-1\"\u003e前準備\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BE%8C%E5%A7%8B%E6%9C%AB-1\"\u003e後始末\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A7%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B%E5%9F%BA%E7%A4%8E\"\u003eサーマルプリンターで印刷する基礎\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A7%E7%94%BB%E5%83%8F%E3%82%92%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003eサーマルプリンターで画像を印刷する\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E8%A8%98%E6%86%B6%E9%A0%98%E5%9F%9F%E3%81%AB%E4%BA%8B%E5%89%8D%E3%81%AB%E7%94%BB%E5%83%8F%E3%82%92%E4%BF%9D%E5%AD%98%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8D%E3%81%9D%E3%82%8C%E3%82%92%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003eプリンターの記憶領域に事前に画像を保存しておき、それを印刷する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%94%BB%E5%83%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%91%E3%82%B9%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%A6%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003e画像ファイルのパスを指定して印刷する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%94%BB%E5%83%8F%E3%82%92%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E7%94%9F%E6%88%90%E3%81%97%E3%81%A6%E5%8D%B0%E5%88%B7%E3%81%99%E3%82%8B\"\u003e画像をコードで生成して印刷する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%83%89%E3%83%AD%E3%82%A2%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eキャッシュドロアの場合\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99-2\"\u003e前準備\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E4%BD%9C%E3%81%95%E3%81%9B%E3%82%8B%E9%83%A8%E5%88%86%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89-1\"\u003e実際に動作させる部分のコード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BE%8C%E5%A7%8B%E6%9C%AB-2\"\u003e後始末\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B3%A8%E6%84%8F\"\u003e注意\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#6-%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e6. 終わりに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":2124,"uuid":"64073010955ceb8928be","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"bakJ0PtQ7hVXTT/4H7dRsCgtxZoO--qX/CNSvr0a+jr5WU--c6FtAD8Dg1YAdxRbVHf1sw==","originalId":677302,"description":"メインはC#、他色々。\r\nサーマルプリンター等のPOS系の機器が大好物です。","facebookUrl":null,"githubUrl":"https://github.com/Automatic9045","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://avatars3.githubusercontent.com/u/67314487?v=4","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars3.githubusercontent.com%2Fu%2F67314487%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=abcaf6856e96b990d3330706d7f940f6","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars3.githubusercontent.com%2Fu%2F67314487%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=1fcd88061fba6a95f909edc1358e6d41","urlName":"Automatic9045","websiteUrl":"https://automatic9045.github.io","twitterUrl":"https://twitter.com/atF9045","twitterUrlName":"atF9045","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"入門","urlName":"%e5%85%a5%e9%96%80"},{"name":"レシート","urlName":"%e3%83%ac%e3%82%b7%e3%83%bc%e3%83%88"},{"name":"サーマルプリンタ","urlName":"%e3%82%b5%e3%83%bc%e3%83%9e%e3%83%ab%e3%83%97%e3%83%aa%e3%83%b3%e3%82%bf"},{"name":"POSfor.NET","urlName":"posfor.net"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
