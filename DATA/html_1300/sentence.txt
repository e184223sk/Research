前回（【C#】DataTable でのLINQの使い方（２））に引き続き、C#のDataTableクラスでLINQを使ったコードを簡単にまとめた内容を記載します。DataTable で重複している行を削除
※重複行を削除は使う場合は少ないかと、DBから取得する場合は重複行を削除しているかと思うので。簡単な説明全項目の値が重複している行を削除する場合は「Distinct」を利用する事で削除されます。
※サンプルでは「差異無」の行のみが削除されています。項目別で値が重複している行を削除する場合は「GroupBy」を利用する事で削除されます。
また、削除される行は２行目以降になります。
※サンプルでは「No」が重複している「差異無」「差異有」の行が削除されています。出力結果重複する行を削除した結果
No:1,Name:太郎,Age:10,Address:東京
No:3,Name:三郎,Age:30,Address:大阪
No:1,Name:四郎,Age:10,Address:東京
No:2,Name:次郎,Age:20,Address:名古屋指定項目の重複行を削除した結果
No:1,Name:太郎,Age:10,Address:東京
No:3,Name:三郎,Age:30,Address:大阪
No:2,Name:次郎,Age:20,Address:名古屋２つのテーブルで重複していない行の取得、又は重複している行の取得簡単な説明重複していない行を取得する場合は「Except」を利用する事で取得できます。
サンプルでは、「member」テーブルで「member2」テーブルのレコードと重複していない行を取得しています。重複している行を取得する場合は「Intersect」を利用する事で取得できます。
サンプルでは、「member」テーブルと「member2」テーブルのレコードと重複している行を取得しています。今回の方法では項目別の重複には対象できません。やり方については別項目で書くと思います。出力結果「member」テーブルのみに存在する行を取得した結果
No:1,Name:四郎,Age:10,Address:東京
No:3,Name:三郎,Age:30,Address:大阪両テーブルに存在する行を取得した結果
No:1,Name:太郎,Age:10,Address:東京
No:2,Name:次郎,Age:20,Address:名古屋前回に続きLINQについて書いてみました。
記事を書いている時に思ったのですが、LINQで取得した結果は元のデータとは別の領域に保存されている思うのですが、大量データを処理する場合に領域不足が起きないのか気になりました。
機会が有ればそのあたりも調べてみたいと思います。


