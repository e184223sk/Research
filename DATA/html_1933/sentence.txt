More than 1 year has passed since last update.やえがしさんのTwitterで
画面に映った色を取得してるのを見かけたので、
どうやればいいか調べてみました。
(ちょっとご本人にヒントももらいました。ありがとうございます)空間に落ちている色をパレットみたいに使ってコーディネートできたらいいなーと思ったので作ってみた！ #withARハッカソン #空間 pic.twitter.com/tOluFOVHfqこんな感じで触った色が球体に反映されています。
今回はスマホの外部カメラの映像ではありませんが、
ARCoreなどのカメラをシーンに置けば
スマホの画面の映像から色を抽出できます。もうほぼ答えですが、下記リンクを参考にしました。【参考リンク】：Unityで、クリックしたピクセルの色を取得したいリンク先にもありますが、描画処理が終わってからピクセルを取得する必要があるので、
WaitForEndOfFrameでそのフレームの最後に取得するようにしてます。色が変化したことを検知するために
ReactivePropertyを利用しています。検知の監視側はこんな感じです。SkipLatestValueOnSubscribeは発行された最初の値を無視できるやつです。ObserveEveryValueChangedやReactivePropertyを利用した際、
Subscribe(実行したい関数を登録)した時点で初期値が発行されてしまうようで、
始まっていきなりSubscribe内の登録した処理が走ってしまっていました。例として下記のようなコードでObserveEveryValueChangedで
Color型の変数を監視した場合、
Start関数内で初期値が発行されてしまい、
まだ色が変化してないにもかかわらず"Color Change"が表示されました。SkipLatestValueOnSubscribeは
ReactivePropertyのオペレータとして用意されているので、
ObserveEveryValueChangedではなく、
Color型の変数をReactivePropertyに変えて利用しました。【参考リンク】：Unityにおけるコルーチンの省メモリと高速化について、或いはUniRx 5.3.0でのその反映今回はInputがタッチなのでオレオレInputを定義してます。タッチ系は毎回書くのが面倒なので、一回作って使い回すか
EventSystemを利用するのがセオリーっぽいです。
(もっと楽なのあったら教えてください)やっと100記事書きました。
中身が微妙なので「だからなんやねん」って感じですが、
継続力だけは自分で自分を評価します。逆に言うと私のレベルで継続できなくなったらオワリなので
これからもノンストップ牛歩で頑張ります。


