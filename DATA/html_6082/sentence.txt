More than 3 years have passed since last update.WPFアプリケーションでアドバンスソフトウェア社のVB-Reportを使って帳票のプレビュー画面を表示するというのが今回の目的です。アドバンスソフトウェア社のVB-Reportは、Microsoft Excelで帳票をデザインする帳票ツールです。
使い慣れたExcelでそのまま帳票設計ができるので、専用のデザイナを使用しなくてもデザインが作れる分かなり効率的に帳票が作成作業が行えます。
「VB」とついていますが、VB.NETだけでなくC#でも使用できます。
さまざまな開発で使用できます。※オープンソースではなく、有料のコンポーネントになっています。VB-Report8の製品情報はこちら体験版のダウンロードはこちら以下は、簡単なサンプルですが非常に楽に帳票出力が可能です。※「Prism Template Pack」のインストールは、以前の記事を参考にしてください。
 PrismとUnityを使うWPFプロジェクトテンプレートを使ってみる普通に上のコードのようにMVVMでドキュメントをバインディングしようとするとDependencyPropertyがDocumentにないのでエラーが発生します。これでは、MVVMのアプリケーションなのにViewModel.csではなく、xaml.csに直接書かなければとなってしまいますが、解決方法はあります。
 DependencyPropertyを作ってしまえばよいのです。
 なんだか難しそうに感じますが、実は簡単なようです。以下の説明からその手順になります。処理の内容としては、MVVMパターンで行うならば、VB-Reportの場合は、DependancyPropertyを作成したユーザーコントロールを介してバインディングを行うことで解決します。
Prismを使ったソリューションの場合にViewModelに固執するわけではありませんが、むやみやたらとコードビハインドで記述しないで済む方法があるということです。2017/09/04
アドヴァンスソフトウェア社から連絡があり、CellReport のオブジェクトによる 2回目の帳票生成を
行う場合は、1回目の帳票ドキュメントがビューアコントロールに紐付けられて
いるため、予め viewerControl.Clear メソッドを呼び出して頂く必要がございます。という連絡がありましたので、ボタンコマンドにコマンドパラメータでElementNameを渡して、動作するように修正しました。ただ、以下のような修正でもよいかもしれません。


