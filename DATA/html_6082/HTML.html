<!DOCTYPE html><html><head><meta charset="utf-8" /><title>[WPF][XAML]VB-ReportのWPF 用ビューアコントロールを使ってみる - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/HAGITAKO/items/59bc13e53088b9ebcc88" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="n0X4gARx3vzeHSJG41yZ5O0SQQI9NALBRENu0MP/6Oe2A4VWPGaGuwP2/iUAw+RiE7Thswk7Rdh8mnNK8pyWZQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@HAGITAKO" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="[WPF][XAML]VB-ReportのWPF 用ビューアコントロールを使ってみる - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XMWRRUmwxYldFRk5URjFXUWkxU1pYQnZjblRqZ2E1WFVFWWc1NVNvNDRPVDQ0T2w0NE84NDRLaTQ0S3o0NE96NDRPSTQ0T3Q0NE84NDRPcjQ0S1M1TDJfNDRHajQ0R200NEdfNDRLTCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0xZGU4OTEyNTkyMWVjYWNiN2EyOTAzMzA5MjNjNjQwOQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRWhCUjBsVVFVdFAmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz0wZTY3NjhkN2I3ZGIyNWY1ZTlhOGE4Y2UwN2MxYTAwOQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=bf6b3ff63356e7ca0f28d84cc3cc646b"><meta property="og:description" content="

VB-ReportのWPF 用ビューアコントロールを使ってみる


開発環境


Visual Studio 2017 (C#)
Visual Studioの拡張機能の「Prism Template Pack」


Prism.C..."><meta content="https://qiita.com/HAGITAKO/items/59bc13e53088b9ebcc88" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,WPF,Xaml,MVVM,PRISM" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-f610ada2-b905-49bb-93fe-b66a9921b6a4"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FHAGITAKO%2Fitems%2F59bc13e53088b9ebcc88">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FHAGITAKO%2Fitems%2F59bc13e53088b9ebcc88">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-f610ada2-b905-49bb-93fe-b66a9921b6a4">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-08-31T11:32:41.000+09:00","dateModified":"2017-09-04T11:55:52.000+09:00","headline":"[WPF][XAML]VB-ReportのWPF 用ビューアコントロールを使ってみる","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XMWRRUmwxYldFRk5URjFXUWkxU1pYQnZjblRqZ2E1WFVFWWc1NVNvNDRPVDQ0T2w0NE84NDRLaTQ0S3o0NE96NDRPSTQ0T3Q0NE84NDRPcjQ0S1M1TDJfNDRHajQ0R200NEdfNDRLTCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0xZGU4OTEyNTkyMWVjYWNiN2EyOTAzMzA5MjNjNjQwOQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRWhCUjBsVVFVdFAmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz0wZTY3NjhkN2I3ZGIyNWY1ZTlhOGE4Y2UwN2MxYTAwOQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=bf6b3ff63356e7ca0f28d84cc3cc646b","mainEntityOfPage":"https://qiita.com/HAGITAKO/items/59bc13e53088b9ebcc88","author":{"@type":"Person","address":"Yokohama, Japan","email":null,"identifier":"HAGITAKO","name":"HAGITAKO","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2Fprofile-images%2F1494260215?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=516f368de7ec48c4c3b7b4b416a8f375","url":"https://qiita.com/HAGITAKO","description":"社内SEとして１7年くらい\r\n最近では、管理職のため仕事での使用頻度は少なくなってきてます。\r\n社内新規案件のプロトタイプが主なコードを触るくらい。\r\n\r\nWPF大好きです。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"HAGITAKO","type":"items","id":"59bc13e53088b9ebcc88"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"HAGITAKO","type":"items","id":"59bc13e53088b9ebcc88"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"HAGITAKO","type":"items","id":"59bc13e53088b9ebcc88"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/HAGITAKO/items/59bc13e53088b9ebcc88","location":"/HAGITAKO/items/59bc13e53088b9ebcc88","scheme":"https","host":"qiita.com","port":null,"pathname":"/HAGITAKO/items/59bc13e53088b9ebcc88","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"LwmBBrI7HDu3y0XkJZdSh6X83zaHvI+B5z5pGH+cXkcGT/zQiixEfGogmYfGCC8BW1p/h7OzyJjf53SCTv8gxQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-3eb88490-e911-4cee-bfe0-22af9c9db3fc"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/likers" class="css-1iupg5d">5</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">8</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/59bc13e53088b9ebcc88/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/HAGITAKO/items/59bc13e53088b9ebcc88.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/HAGITAKO"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/90597/profile-images/1494260215" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/HAGITAKO" class="css-10ougpm">@<!-- -->HAGITAKO</a><div class="css-1ay9vb9"><span><meta content="2017-08-31T02:32:41Z"/><time dateTime="2017-09-04T02:55:52Z" class="css-m19uds">updated at 2017-09-04</time></span></div></div></div></div></div><h1 class="css-cgzq40">[WPF][XAML]VB-ReportのWPF 用ビューアコントロールを使ってみる</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/wpf" class="css-4czcte">WPF</a><a href="/tags/xaml" class="css-4czcte">Xaml</a><a href="/tags/mvvm" class="css-4czcte">MVVM</a><a href="/tags/prism" class="css-4czcte">PRISM</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="vb-reportのwpf-用ビューアコントロールを使ってみる" class="fragment"></span><a href="#vb-report%E3%81%AEwpf-%E7%94%A8%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>VB-ReportのWPF 用ビューアコントロールを使ってみる</h1>

<h2>
<span id="開発環境" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>開発環境</h2>

<ul>
<li>Visual Studio 2017 (C#)</li>
<li>Visual Studioの拡張機能の「Prism Template Pack」

<ul>
<li>Prism.Core 6.3.0</li>
<li>Prism.Unity 6.3.0</li>
<li>Prism.Wpf 6.3.0</li>
<li>CommonServiceLocator 1.3.0</li>
<li>Unity 4.0.1</li>
</ul>
</li>
<li>VB-Report 8.0</li>
</ul>

<h2>
<span id="初めに" class="fragment"></span><a href="#%E5%88%9D%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>初めに</h2>

<p>WPFアプリケーションでアドバンスソフトウェア社のVB-Reportを使って帳票のプレビュー画面を表示するというのが今回の目的です。</p>

<h2>
<span id="vb-reportについて" class="fragment"></span><a href="#vb-report%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>VB-Reportについて</h2>

<p>アドバンスソフトウェア社のVB-Reportは、Microsoft Excelで帳票をデザインする帳票ツールです。<br>
使い慣れたExcelでそのまま帳票設計ができるので、専用のデザイナを使用しなくてもデザインが作れる分かなり効率的に帳票が作成作業が行えます。<br>
「VB」とついていますが、VB.NETだけでなくC#でも使用できます。<br>
さまざまな開発で使用できます。</p>

<ul>
<li>WindowsForm用ビューアコントロール</li>
<li>Web用ビューアコントロール</li>
<li>WPF 用ビューアコントロール</li>
<li>ブラウザ用 ActiveX ビューアコントロール</li>
<li>Windows ストアアプリ用ビューアコントロール</li>
</ul>

<p>※オープンソースではなく、有料のコンポーネントになっています。</p>

<p><a href="http://www.adv.co.jp/product/product_vb-report8.htm" rel="nofollow noopener" target="_blank">VB-Report8の製品情報はこちら</a></p>

<p><a href="http://www.adv.co.jp/download/download.htm" rel="nofollow noopener" target="_blank">体験版のダウンロードはこちら</a></p>

<h3>
<span id="コードのサンプル" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB"><i class="fa fa-link"></i></a>コードのサンプル</h3>

<p>以下は、簡単なサンプルですが非常に楽に帳票出力が可能です。</p>

<div class="code-frame" data-lang="vbnet">
<div class="code-lang"><span class="bold">VB.NET</span></div>
<div class="highlight"><pre class="with-code"><code>' ①-2帳票ドキュメントの作成を開始します。
CellReport1.Report.Start()
' ①-3帳票の作成を開始します。
CellReport1.Report.File()
' ②-1デザインシートを指定します。
CellReport1.Page.Start("Sheet1", "1")
' ②-2セルに値を設定します。
CellReport1.Cell("A1").Value = "VB-Reportのサンプル";
' ②-3ページ処理を終了します。
CellReport1.Page.End()
' ③-1帳票ドキュメント作成を終了します。
CellReport1.Report.End()
' ③-2作成した帳票ドキュメントをビューアに設定します。
ViewerControl1.Document = CellReport1.Document
</code></pre></div>
</div>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">C#</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">// ①-1デザインファイル名を指定します。</span>
<span class="n">cellReport1</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="s">@"C:\Book1.xlsx"</span><span class="p">;</span>
<span class="c1">// ①-2帳票ドキュメントの作成を開始します。</span>
<span class="n">cellReport1</span><span class="p">.</span><span class="n">Report</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
<span class="c1">// ①-3帳票の作成を開始します。</span>
<span class="n">cellReport1</span><span class="p">.</span><span class="n">Report</span><span class="p">.</span><span class="nf">File</span><span class="p">();</span>
<span class="c1">// ②-1デザインシートを指定します。</span>
<span class="n">cellReport1</span><span class="p">.</span><span class="n">Page</span><span class="p">.</span><span class="nf">Start</span><span class="p">(</span><span class="s">"Sheet1"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">);</span>
<span class="c1">// ②-2セルに値を設定します。</span>
<span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"A1"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"VB-Reportのサンプル"</span><span class="p">;</span>
<span class="c1">// ②-3ページ処理を終了します。</span>
<span class="n">cellReport1</span><span class="p">.</span><span class="n">Page</span><span class="p">.</span><span class="nf">End</span><span class="p">();</span>
<span class="c1">// ③-1帳票ドキュメント作成を終了します。</span>
<span class="n">cellReport1</span><span class="p">.</span><span class="n">Report</span><span class="p">.</span><span class="nf">End</span><span class="p">();</span>
<span class="c1">// ③-2作成した帳票ドキュメントをビューアに設定します。</span>
<span class="n">viewerControl1</span><span class="p">.</span><span class="n">Document</span> <span class="p">=</span> <span class="n">cellReport1</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</code></pre></div>
</div>

<h2>
<span id="説明省略部分" class="fragment"></span><a href="#%E8%AA%AC%E6%98%8E%E7%9C%81%E7%95%A5%E9%83%A8%E5%88%86"><i class="fa fa-link"></i></a>説明省略部分</h2>

<ul>
<li>「Prism Template Pack」のインストール</li>
<li>「Prism Template Pack」のプロジェクト作成</li>
<li> 「VB-Report」のインストール</li>
<li> 「Prism + Unity」アプリケーションの作り方</li>
</ul>

<p>※「Prism Template Pack」のインストールは、以前の記事を参考にしてください。<br>
<a href="http://qiita.com/HAGITAKO/items/adedbb6c70d2763543f2" id="reference-e78fc6951884425a0411"> PrismとUnityを使うWPFプロジェクトテンプレートを使ってみる</a></p>

<h2>
<span id="wpf用ビューアを配置するとバインディングができない" class="fragment"></span><a href="#wpf%E7%94%A8%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B%E3%81%A8%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>WPF用ビューアを配置するとバインディングができない。</h2>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">MainUcView.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;UserControl</span>
             <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
             <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
             <span class="na">xmlns:prism=</span><span class="s">"http://prismlibrary.com/"</span>             
             <span class="na">xmlns:vbr=</span><span class="s">"clr-namespace:AdvanceSoftware.VBReport8.WPF;assembly=VBReport8.WPF.Viewer"</span> <span class="na">x:Class=</span><span class="s">"VbReportSampleApp.Views.MainUcView"</span>             
             <span class="na">prism:ViewModelLocator.AutoWireViewModel=</span><span class="s">"True"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Grid&gt;</span>
        <span class="nt">&lt;vbr:ViewerControl</span> <span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span> <span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span> <span class="na">Document=</span><span class="s">"{Binding DocumentReport}"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/UserControl&gt;</span>
</code></pre></div>
</div>

<p>普通に上のコードのようにMVVMでドキュメントをバインディングしようとするとDependencyPropertyがDocumentにないのでエラーが発生します。</p>

<p><a href="https://camo.qiitausercontent.com/9b69778b296cced38847fe2ad1715ecacf6393b1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f39303539372f39363963666137632d303864302d613131662d633839632d6262313665633330363437322e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2F969cfa7c-08d0-a11f-c89c-bb16ec306472.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=19fe2a8c713fd11f06c2576842bc86bb" alt="WS000000213.JPG" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/90597/969cfa7c-08d0-a11f-c89c-bb16ec306472.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2F969cfa7c-08d0-a11f-c89c-bb16ec306472.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8257b4d4ca2c10bde420cd0a7668debd 1x" loading="lazy"></a></p>

<p>これでは、MVVMのアプリケーションなのにViewModel.csではなく、xaml.csに直接書かなければとなってしまいますが、解決方法はあります。<br>
 DependencyPropertyを作ってしまえばよいのです。<br>
 なんだか難しそうに感じますが、実は簡単なようです。</p>

<ol>
<li>ViewerControlを使用したコントロールを自作する。</li>
<li>自作したViewControlで作ったバインディング先を介してドキュメントを渡す。</li>
</ol>

<p>以下の説明からその手順になります。</p>

<h2>
<span id="作成手順" class="fragment"></span><a href="#%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86"><i class="fa fa-link"></i></a>作成手順</h2>

<h3>
<span id="viewercontrolexxamlの作成" class="fragment"></span><a href="#viewercontrolexxaml%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>「ViewerControlEx.xaml」の作成</h3>

<ul>
<li>Viewsフォルダを右クリック &gt; 追加 &gt; 新しい項目</li>
<li>WPF &gt; ユーザーコントロール(WPF)を選択</li>
<li>コントロール名は、「ViewerControlEx」</li>
<li>XAMLにViewControlを配置する</li>
</ul>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">ViewerControlEx.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;UserControl</span> <span class="na">x:Class=</span><span class="s">"VbReportSampleApp.Views.ViewerControlEx"</span>
             <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
             <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
             <span class="na">xmlns:mc=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span> 
             <span class="na">xmlns:d=</span><span class="s">"http://schemas.microsoft.com/expression/blend/2008"</span> 
             <span class="na">xmlns:vbr=</span><span class="s">"clr-namespace:AdvanceSoftware.VBReport8.WPF;assembly=VBReport8.WPF.Viewer"</span>
             <span class="na">xmlns:local=</span><span class="s">"clr-namespace:VbReportSampleApp.Views"</span>
             <span class="na">mc:Ignorable=</span><span class="s">"d"</span> 
             <span class="na">d:DesignHeight=</span><span class="s">"600"</span> <span class="na">d:DesignWidth=</span><span class="s">"600"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;vbr:ViewerControl</span> <span class="na">x:Name=</span><span class="s">"viewer"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/UserControl&gt;</span>
</code></pre></div>
</div>

<h3>
<span id="viewercontrolexxamlcsの作成" class="fragment"></span><a href="#viewercontrolexxamlcs%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>「ViewerControlEx.xaml.cs」の作成</h3>

<ul>
<li>xaml.csにDocumentPropertyを作成する</li>
</ul>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">ViewerControlEx.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">AdvanceSoftware.VBReport8</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Controls</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">VbReportSampleApp.Views</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// ViewerControlEx.xaml の相互作用ロジック</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">ViewerControlEx</span> <span class="p">:</span> <span class="n">UserControl</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">ViewerControlEx</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">Document</span> <span class="n">Document</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="n">Document</span><span class="p">)</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">DocumentProperty</span><span class="p">);</span> <span class="p">}</span>
            <span class="k">set</span> <span class="p">{</span> <span class="nf">SetValue</span><span class="p">(</span><span class="n">DocumentProperty</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// Using a DependencyProperty as the backing store for Document.  This enables animation, styling, binding, etc...</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">DependencyProperty</span> <span class="n">DocumentProperty</span> <span class="p">=</span>
            <span class="n">DependencyProperty</span><span class="p">.</span><span class="nf">Register</span><span class="p">(</span><span class="s">"Document"</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Document</span><span class="p">),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">ViewerControlEx</span><span class="p">),</span> <span class="k">new</span> <span class="nf">PropertyMetadata</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">new</span> <span class="nf">PropertyChangedCallback</span><span class="p">(</span><span class="n">OnDocumentChanged</span><span class="p">)));</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">OnDocumentChanged</span><span class="p">(</span><span class="n">DependencyObject</span> <span class="n">d</span><span class="p">,</span> <span class="n">DependencyPropertyChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">ctrl</span> <span class="p">=</span> <span class="n">d</span> <span class="k">as</span> <span class="n">ViewerControlEx</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ctrl</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

            <span class="n">ctrl</span><span class="p">.</span><span class="n">viewer</span><span class="p">.</span><span class="n">Document</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">NewValue</span> <span class="k">as</span> <span class="n">Document</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>処理の内容としては、</p>

<ul>
<li>DocumentPropertyというDependancyPropertyを作成し、変更されるとOnDocumentChangedが呼びます。</li>
<li>ViewerControlのDocumentプロパティを差し替えています</li>
</ul>

<h3>
<span id="自作のvb-reportのビューアviewercontrolexを配置する" class="fragment"></span><a href="#%E8%87%AA%E4%BD%9C%E3%81%AEvb-report%E3%81%AE%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2viewercontrolex%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>自作のVB-Reportのビューア(ViewerControlEx)を配置する</h3>

<ul>
<li>ここでは、メインの画面に配置していますが、あとは自由です。</li>
<li>Report作成ボタンを押すとプレビューが出るようしました。</li>
</ul>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">MainUcView.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;UserControl</span>
             <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
             <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
             <span class="na">xmlns:prism=</span><span class="s">"http://prismlibrary.com/"</span>             
             <span class="na">xmlns:vbr=</span><span class="s">"clr-namespace:AdvanceSoftware.VBReport8.WPF;assembly=VBReport8.WPF.Viewer"</span> <span class="na">x:Class=</span><span class="s">"VbReportSampleApp.Views.MainUcView"</span>
             <span class="na">xmlns:vw=</span><span class="s">"clr-namespace:VbReportSampleApp.Views"</span>
             <span class="na">prism:ViewModelLocator.AutoWireViewModel=</span><span class="s">"True"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Grid&gt;</span>
        <span class="nt">&lt;Grid.RowDefinitions&gt;</span>
            <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"60"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"*"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Grid.RowDefinitions&gt;</span>
        <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span> <span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">"Report作成"</span> <span class="na">Command=</span><span class="s">"{Binding CreateReportCommand}"</span>  <span class="na">CommandParameter=</span><span class="s">"{Binding ElementName=viewerControlEx}"</span> <span class="na">Width=</span><span class="s">"200"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/StackPanel&gt;</span>
        <span class="nt">&lt;vw:ViewerControlEx</span> <span class="na">x:Name=</span><span class="s">"viewerControlEx"</span> <span class="na">Grid.Row=</span><span class="s">"1"</span> <span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span> <span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span> <span class="na">Document=</span><span class="s">"{Binding DocumentReport}"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/UserControl&gt;</span>
</code></pre></div>
</div>

<ul>
<li>自作のVB-Reportのビューア(ViewerControlEx)を介することでDocumentにBindingしてもエラーにならなくなります。</li>
</ul>

<h3>
<span id="自作のvb-reportのビューアviewercontrolexを配置した画面のviewmodelの作成" class="fragment"></span><a href="#%E8%87%AA%E4%BD%9C%E3%81%AEvb-report%E3%81%AE%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2viewercontrolex%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2%E3%81%AEviewmodel%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>自作のVB-Reportのビューア(ViewerControlEx)を配置した画面のViewModelの作成</h3>

<ul>
<li>今回は、メインの画面に配置</li>
<li>※ 帳票の作成には、アドバンスソフトウェア社のサンプルのファイルをそのまま使用しています。</li>
</ul>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">MainUcViewModel.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">AdvanceSoftware.VBReport8</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Prism.Commands</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Prism.Mvvm</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Xml</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">VbReportSampleApp.ViewModels</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">MainUcViewModel</span> <span class="p">:</span> <span class="n">BindableBase</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">MainUcViewModel</span><span class="p">()</span>
        <span class="p">{</span>

        <span class="p">}</span>

<span class="k">private</span> <span class="n">DelegateCommand</span><span class="p">&lt;</span><span class="n">ViewerControlEx</span><span class="p">&gt;</span> <span class="n">createReportCommand</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">DelegateCommand</span><span class="p">&lt;</span><span class="n">ViewerControlEx</span><span class="p">&gt;</span> <span class="n">CreateReportCommand</span> <span class="p">=&gt;</span>
            <span class="n">createReportCommand</span> <span class="p">??</span> <span class="p">(</span><span class="n">createReportCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DelegateCommand</span><span class="p">&lt;</span><span class="n">ViewerControlEx</span><span class="p">&gt;(</span><span class="n">CreateDocumentExecute</span><span class="p">));</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">CreateDocumentExecute</span><span class="p">(</span><span class="n">ViewerControlEx</span> <span class="n">viewerControlEx</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">viewerControlEx</span><span class="p">.</span><span class="n">viewer</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">DocumentReport</span> <span class="p">=</span> <span class="nf">CreateDocument</span><span class="p">();</span>    
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">Document</span> <span class="nf">CreateDocument</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">XmlDocument</span> <span class="n">doc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">XmlDocument</span><span class="p">();</span>
            <span class="n">XmlNodeList</span> <span class="n">list</span><span class="p">;</span>

            <span class="kt">string</span> <span class="n">userID</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">designFilePath</span> <span class="p">=</span> <span class="s">@"見積書.xls"</span><span class="p">;</span>
            <span class="n">cellReport1</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="n">designFilePath</span><span class="p">;</span>
            <span class="n">cellReport1</span><span class="p">.</span><span class="n">Report</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
            <span class="n">cellReport1</span><span class="p">.</span><span class="n">Report</span><span class="p">.</span><span class="nf">File</span><span class="p">();</span>

            <span class="c1">// 請求リストを読み込みます。</span>
            <span class="n">doc</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">@"見積書リスト.xml"</span><span class="p">);</span>
            <span class="n">list</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="nf">SelectNodes</span><span class="p">(</span><span class="s">"/見積書リスト/顧客"</span><span class="p">);</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="n">XmlNode</span> <span class="n">node</span> <span class="k">in</span> <span class="n">list</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">int</span> <span class="n">totalSeikyu</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="n">userID</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"@id"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>

                <span class="n">cellReport1</span><span class="p">.</span><span class="n">Page</span><span class="p">.</span><span class="nf">Start</span><span class="p">(</span><span class="s">"見積書"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">);</span>
                <span class="c1">// 日付</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Date"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
                <span class="c1">// 見積有効日</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**EndDate"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">ToOADate</span><span class="p">()</span> <span class="p">+</span> <span class="m">7</span><span class="p">;</span>
                <span class="c1">// 見積書番号</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Mitsumori"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./見積書番号"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="c1">// 会社名</span>
                <span class="kt">string</span> <span class="n">officename</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./会社名"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">officename</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**OfficeName"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./会社名"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="c1">// 部署名</span>
                <span class="kt">string</span> <span class="n">sectionname</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./部署名"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sectionname</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**SectionName"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./部署名"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="c1">// お客様名</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**UserName"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./お客様名"</span><span class="p">).</span><span class="n">InnerText</span> <span class="p">+</span> <span class="s">" 様"</span><span class="p">;</span>
                <span class="c1">// 郵便番号</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Post"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"〒"</span> <span class="p">+</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./郵便番号"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="c1">// 住所県</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Address1"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./住所県"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="c1">// 住所その他</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Address2"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./住所その他"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                <span class="c1">// 商品一覧</span>
                <span class="kt">int</span> <span class="n">y</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="n">XmlNode</span> <span class="n">shyouhinNode</span> <span class="p">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./商品明細"</span><span class="p">);</span>
                <span class="n">XmlNodeList</span> <span class="n">list2</span> <span class="p">=</span> <span class="n">shyouhinNode</span><span class="p">.</span><span class="nf">SelectNodes</span><span class="p">(</span><span class="s">"./商品"</span><span class="p">);</span>

                <span class="c1">// 一括割引対象品と除外品を判断するためのフラグ("1"→"0"に変更した時点で割引額の表示)</span>
                <span class="kt">string</span> <span class="n">discount</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
                <span class="kt">string</span> <span class="n">discountPrev</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>

                <span class="k">foreach</span> <span class="p">(</span><span class="n">XmlNode</span> <span class="n">node2</span> <span class="k">in</span> <span class="n">list2</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">discount</span> <span class="p">=</span> <span class="n">node2</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./一括割引"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                    <span class="c1">// 一括割引対象品でなくなった時点で、割引額を求める</span>
                    <span class="c1">// 全て割引除外品の場合、計算を行わない</span>
                    <span class="k">if</span> <span class="p">((</span><span class="n">discount</span> <span class="p">==</span> <span class="s">"0"</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="p">(</span><span class="n">discountPrev</span> <span class="p">==</span> <span class="s">"1"</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="c1">// 合計額(税抜き)が、100万未満の場合、一括割引を行わない。</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">totalSeikyu</span> <span class="p">&gt;=</span> <span class="m">1000000</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Shouhin"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"（一括割引）"</span><span class="p">;</span>
                            <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Shouhin"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Attr</span><span class="p">.</span><span class="n">FontColor2</span> <span class="p">=</span> <span class="n">AdvanceSoftware</span><span class="p">.</span><span class="n">VBReport8</span><span class="p">.</span><span class="n">xlColor</span><span class="p">.</span><span class="n">Red</span><span class="p">;</span>
                            <span class="kt">int</span> <span class="n">discountGaku</span> <span class="p">=</span> <span class="n">totalSeikyu</span> <span class="p">*</span> <span class="p">-</span><span class="m">2</span> <span class="p">/</span> <span class="m">10</span><span class="p">;</span>
                            <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Kingaku"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">discountGaku</span><span class="p">;</span>
                            <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Kingaku"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Attr</span><span class="p">.</span><span class="n">FontColor2</span> <span class="p">=</span> <span class="n">AdvanceSoftware</span><span class="p">.</span><span class="n">VBReport8</span><span class="p">.</span><span class="n">xlColor</span><span class="p">.</span><span class="n">Red</span><span class="p">;</span>
                            <span class="n">totalSeikyu</span> <span class="p">+=</span> <span class="n">discountGaku</span><span class="p">;</span>
                            <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Biko"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"上記合計金額より２０％ＯＦＦ"</span><span class="p">;</span>
                            <span class="n">y</span> <span class="p">+=</span> <span class="m">2</span><span class="p">;</span>
                            <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Shouhin"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"（以下、割引除外品）"</span><span class="p">;</span>
                            <span class="n">y</span><span class="p">++;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="c1">// 商品名</span>
                    <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Shouhin"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node2</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./商品名"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                    <span class="c1">// 数量</span>
                    <span class="kt">int</span> <span class="n">unitNumber</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">node2</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./数量"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">);</span>
                    <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Suuryou"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">unitNumber</span><span class="p">;</span>
                    <span class="c1">// 単価</span>
                    <span class="kt">int</span> <span class="n">unitPrice</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">node2</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./単価"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">);</span>
                    <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Tanka"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">unitPrice</span><span class="p">;</span>
                    <span class="c1">// 金額</span>
                    <span class="kt">int</span> <span class="n">totalPrice</span> <span class="p">=</span> <span class="n">unitNumber</span> <span class="p">*</span> <span class="n">unitPrice</span><span class="p">;</span>
                    <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Kingaku"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">totalPrice</span><span class="p">;</span>
                    <span class="n">totalSeikyu</span> <span class="p">+=</span> <span class="n">totalPrice</span><span class="p">;</span>
                    <span class="c1">// 備考</span>
                    <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Biko"</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">node2</span><span class="p">.</span><span class="nf">SelectSingleNode</span><span class="p">(</span><span class="s">"./備考"</span><span class="p">).</span><span class="n">InnerText</span><span class="p">;</span>
                    <span class="n">y</span><span class="p">++;</span>
                    <span class="n">discountPrev</span> <span class="p">=</span> <span class="n">discount</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="c1">// 税抜</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Zeinuki"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">totalSeikyu</span><span class="p">;</span>

                <span class="c1">// 消費税</span>
                <span class="kt">int</span> <span class="n">tax</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">totalSeikyu</span> <span class="p">*</span> <span class="m">0.05</span><span class="p">);</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Zei"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">tax</span><span class="p">;</span>

                <span class="c1">// 税込</span>
                <span class="n">cellReport1</span><span class="p">.</span><span class="nf">Cell</span><span class="p">(</span><span class="s">"**Zeikomi"</span><span class="p">).</span><span class="n">Value</span> <span class="p">=</span> <span class="n">totalSeikyu</span> <span class="p">+</span> <span class="n">tax</span><span class="p">;</span>

                <span class="n">cellReport1</span><span class="p">.</span><span class="n">Page</span><span class="p">.</span><span class="nf">End</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">cellReport1</span><span class="p">.</span><span class="n">Report</span><span class="p">.</span><span class="nf">End</span><span class="p">();</span>
            <span class="k">return</span> <span class="n">cellReport1</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="n">Document</span> <span class="n">documentReport</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">Document</span> <span class="n">DocumentReport</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">documentReport</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="nf">SetProperty</span><span class="p">(</span><span class="k">ref</span> <span class="n">documentReport</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="n">CellReport</span> <span class="n">cellReport1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CellReport</span><span class="p">();</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="実行結果" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C"><i class="fa fa-link"></i></a>実行結果</h2>

<p><a href="https://camo.qiitausercontent.com/ffec1c069d80801f9440901878241b862844ffab/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f39303539372f66343363623534642d333438622d376130662d386233342d6566303362373438656364652e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2Ff43cb54d-348b-7a0f-8b34-ef03b748ecde.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=19d79b2b0dab4b50cd03c0f715dcab04" alt="VB-Reportgif.gif" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/90597/f43cb54d-348b-7a0f-8b34-ef03b748ecde.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2Ff43cb54d-348b-7a0f-8b34-ef03b748ecde.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=48a616087b7f94903e50c4fda11bd036 1x" loading="lazy"></a></p>

<h2>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h2>

<p>MVVMパターンで行うならば、VB-Reportの場合は、DependancyPropertyを作成したユーザーコントロールを介してバインディングを行うことで解決します。<br>
Prismを使ったソリューションの場合にViewModelに固執するわけではありませんが、むやみやたらとコードビハインドで記述しないで済む方法があるということです。</p>

<h2>
<span id="追加補足" class="fragment"></span><a href="#%E8%BF%BD%E5%8A%A0%E8%A3%9C%E8%B6%B3"><i class="fa fa-link"></i></a>追加補足</h2>

<p>2017/09/04<br>
アドヴァンスソフトウェア社から連絡があり、</p>

<blockquote>
<p>CellReport のオブジェクトによる 2回目の帳票生成を<br>
行う場合は、1回目の帳票ドキュメントがビューアコントロールに紐付けられて<br>
いるため、予め viewerControl.Clear メソッドを呼び出して頂く必要がございます。</p>
</blockquote>

<p>という連絡がありましたので、ボタンコマンドにコマンドパラメータでElementNameを渡して、動作するように修正しました。</p>

<p>ただ、以下のような修正でもよいかもしれません。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">ViewerControlEx.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">OnDocumentChanged</span><span class="p">(</span><span class="n">DependencyObject</span> <span class="n">d</span><span class="p">,</span> <span class="n">DependencyPropertyChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">ctrl</span> <span class="p">=</span> <span class="n">d</span> <span class="k">as</span> <span class="n">ViewerControlEx</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ctrl</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="n">ctrl</span><span class="p">.</span><span class="n">viewer</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span> <span class="cm">/* ドキュメントのクリア */</span>
    <span class="n">ctrl</span><span class="p">.</span><span class="n">viewer</span><span class="p">.</span><span class="n">Document</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">NewValue</span> <span class="k">as</span> <span class="n">Document</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>

<ul>
<li>単純にプレビューを行いたのであれば、ドキュメント変更イベントにctrl.viewer.Clear();というのを追記すれば、ドキュメントの変更都度クリアされるので、あえてElementNameをコマンドパラメータを渡すより良いかもしれません。</li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FHAGITAKO%2Fitems%2F59bc13e53088b9ebcc88&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FHAGITAKO%2Fitems%2F59bc13e53088b9ebcc88&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/likers" class="css-1iupg5d">5</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">8</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/59bc13e53088b9ebcc88/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/HAGITAKO/items/59bc13e53088b9ebcc88/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/HAGITAKO/items/59bc13e53088b9ebcc88.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-3eb88490-e911-4cee-bfe0-22af9c9db3fc">{"authorAnalyticsTrackingId":"UA-117940392-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-fd7070ca-9d9a-4a4f-a8f9-0b922b1970ef"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-fd7070ca-9d9a-4a4f-a8f9-0b922b1970ef">{}</script>
      
<div id="LoginModal-react-component-4da9f693-9161-4a4f-b78a-3c632402d639"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-4da9f693-9161-4a4f-b78a-3c632402d639">{}</script>
      
<div id="StockModal-react-component-5b283a7e-453b-4284-8d8b-d397404c9219"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-5b283a7e-453b-4284-8d8b-d397404c9219">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;Lu1qlp/6Fj93nxzXuhCL2oqox9Djyb/Ha/VC7NtsoOYHqxdAp+1OeKp0wLRZj/ZcdA5nYdfG+N5TLF926g/eZA==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"vb-reportのwpf-用ビューアコントロールを使ってみる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#vb-report%E3%81%AEwpf-%E7%94%A8%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eVB-ReportのWPF 用ビューアコントロールを使ってみる\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"開発環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e開発環境\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eVisual Studio 2017 (C#)\u003c/li\u003e\n\u003cli\u003eVisual Studioの拡張機能の「Prism Template Pack」\n\n\u003cul\u003e\n\u003cli\u003ePrism.Core 6.3.0\u003c/li\u003e\n\u003cli\u003ePrism.Unity 6.3.0\u003c/li\u003e\n\u003cli\u003ePrism.Wpf 6.3.0\u003c/li\u003e\n\u003cli\u003eCommonServiceLocator 1.3.0\u003c/li\u003e\n\u003cli\u003eUnity 4.0.1\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eVB-Report 8.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"初めに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%9D%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e初めに\u003c/h2\u003e\n\n\u003cp\u003eWPFアプリケーションでアドバンスソフトウェア社のVB-Reportを使って帳票のプレビュー画面を表示するというのが今回の目的です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"vb-reportについて\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#vb-report%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eVB-Reportについて\u003c/h2\u003e\n\n\u003cp\u003eアドバンスソフトウェア社のVB-Reportは、Microsoft Excelで帳票をデザインする帳票ツールです。\u003cbr\u003e\n使い慣れたExcelでそのまま帳票設計ができるので、専用のデザイナを使用しなくてもデザインが作れる分かなり効率的に帳票が作成作業が行えます。\u003cbr\u003e\n「VB」とついていますが、VB.NETだけでなくC#でも使用できます。\u003cbr\u003e\nさまざまな開発で使用できます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindowsForm用ビューアコントロール\u003c/li\u003e\n\u003cli\u003eWeb用ビューアコントロール\u003c/li\u003e\n\u003cli\u003eWPF 用ビューアコントロール\u003c/li\u003e\n\u003cli\u003eブラウザ用 ActiveX ビューアコントロール\u003c/li\u003e\n\u003cli\u003eWindows ストアアプリ用ビューアコントロール\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e※オープンソースではなく、有料のコンポーネントになっています。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.adv.co.jp/product/product_vb-report8.htm\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVB-Report8の製品情報はこちら\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.adv.co.jp/download/download.htm\" rel=\"nofollow noopener\" target=\"_blank\"\u003e体験版のダウンロードはこちら\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"コードのサンプル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコードのサンプル\u003c/h3\u003e\n\n\u003cp\u003e以下は、簡単なサンプルですが非常に楽に帳票出力が可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vbnet\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB.NET\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e' ①-2帳票ドキュメントの作成を開始します。\nCellReport1.Report.Start()\n' ①-3帳票の作成を開始します。\nCellReport1.Report.File()\n' ②-1デザインシートを指定します。\nCellReport1.Page.Start(\"Sheet1\", \"1\")\n' ②-2セルに値を設定します。\nCellReport1.Cell(\"A1\").Value = \"VB-Reportのサンプル\";\n' ②-3ページ処理を終了します。\nCellReport1.Page.End()\n' ③-1帳票ドキュメント作成を終了します。\nCellReport1.Report.End()\n' ③-2作成した帳票ドキュメントをビューアに設定します。\nViewerControl1.Document = CellReport1.Document\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eC#\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// ①-1デザインファイル名を指定します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"C:\\Book1.xlsx\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ①-2帳票ドキュメントの作成を開始します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ①-3帳票の作成を開始します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ②-1デザインシートを指定します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Sheet1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ②-2セルに値を設定します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"A1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"VB-Reportのサンプル\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ②-3ページ処理を終了します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ③-1帳票ドキュメント作成を終了します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ③-2作成した帳票ドキュメントをビューアに設定します。\u003c/span\u003e\n\u003cspan class=\"n\"\u003eviewerControl1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"説明省略部分\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AA%AC%E6%98%8E%E7%9C%81%E7%95%A5%E9%83%A8%E5%88%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e説明省略部分\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e「Prism Template Pack」のインストール\u003c/li\u003e\n\u003cli\u003e「Prism Template Pack」のプロジェクト作成\u003c/li\u003e\n\u003cli\u003e 「VB-Report」のインストール\u003c/li\u003e\n\u003cli\u003e 「Prism + Unity」アプリケーションの作り方\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e※「Prism Template Pack」のインストールは、以前の記事を参考にしてください。\u003cbr\u003e\n\u003ca href=\"http://qiita.com/HAGITAKO/items/adedbb6c70d2763543f2\" id=\"reference-e78fc6951884425a0411\"\u003e PrismとUnityを使うWPFプロジェクトテンプレートを使ってみる\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"wpf用ビューアを配置するとバインディングができない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#wpf%E7%94%A8%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B%E3%81%A8%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWPF用ビューアを配置するとバインディングができない。\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainUcView.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;UserControl\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:x=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:prism=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://prismlibrary.com/\"\u003c/span\u003e             \n             \u003cspan class=\"na\"\u003exmlns:vbr=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:AdvanceSoftware.VBReport8.WPF;assembly=VBReport8.WPF.Viewer\"\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Class=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"VbReportSampleApp.Views.MainUcView\"\u003c/span\u003e             \n             \u003cspan class=\"na\"\u003eprism:ViewModelLocator.AutoWireViewModel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"True\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;Grid\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;vbr:ViewerControl\u003c/span\u003e \u003cspan class=\"na\"\u003eHorizontalAlignment=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Stretch\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVerticalAlignment=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Stretch\"\u003c/span\u003e \u003cspan class=\"na\"\u003eDocument=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding DocumentReport}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/Grid\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/UserControl\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e普通に上のコードのようにMVVMでドキュメントをバインディングしようとするとDependencyPropertyがDocumentにないのでエラーが発生します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/9b69778b296cced38847fe2ad1715ecacf6393b1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f39303539372f39363963666137632d303864302d613131662d633839632d6262313665633330363437322e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2F969cfa7c-08d0-a11f-c89c-bb16ec306472.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=19fe2a8c713fd11f06c2576842bc86bb\" alt=\"WS000000213.JPG\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/90597/969cfa7c-08d0-a11f-c89c-bb16ec306472.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2F969cfa7c-08d0-a11f-c89c-bb16ec306472.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8257b4d4ca2c10bde420cd0a7668debd 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれでは、MVVMのアプリケーションなのにViewModel.csではなく、xaml.csに直接書かなければとなってしまいますが、解決方法はあります。\u003cbr\u003e\n DependencyPropertyを作ってしまえばよいのです。\u003cbr\u003e\n なんだか難しそうに感じますが、実は簡単なようです。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eViewerControlを使用したコントロールを自作する。\u003c/li\u003e\n\u003cli\u003e自作したViewControlで作ったバインディング先を介してドキュメントを渡す。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e以下の説明からその手順になります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"作成手順\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作成手順\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"viewercontrolexxamlの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#viewercontrolexxaml%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e「ViewerControlEx.xaml」の作成\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eViewsフォルダを右クリック \u0026gt; 追加 \u0026gt; 新しい項目\u003c/li\u003e\n\u003cli\u003eWPF \u0026gt; ユーザーコントロール(WPF)を選択\u003c/li\u003e\n\u003cli\u003eコントロール名は、「ViewerControlEx」\u003c/li\u003e\n\u003cli\u003eXAMLにViewControlを配置する\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eViewerControlEx.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;UserControl\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Class=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"VbReportSampleApp.Views.ViewerControlEx\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:x=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:mc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\u003c/span\u003e \n             \u003cspan class=\"na\"\u003exmlns:d=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/expression/blend/2008\"\u003c/span\u003e \n             \u003cspan class=\"na\"\u003exmlns:vbr=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:AdvanceSoftware.VBReport8.WPF;assembly=VBReport8.WPF.Viewer\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:local=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:VbReportSampleApp.Views\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003emc:Ignorable=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e \n             \u003cspan class=\"na\"\u003ed:DesignHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"600\"\u003c/span\u003e \u003cspan class=\"na\"\u003ed:DesignWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"600\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;vbr:ViewerControl\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"viewer\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/UserControl\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"viewercontrolexxamlcsの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#viewercontrolexxamlcs%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e「ViewerControlEx.xaml.cs」の作成\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003examl.csにDocumentPropertyを作成する\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eViewerControlEx.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eAdvanceSoftware.VBReport8\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Windows\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Windows.Controls\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eVbReportSampleApp.Views\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// ViewerControlEx.xaml の相互作用ロジック\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eViewerControlEx\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUserControl\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eViewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eget\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDocumentProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eset\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDocumentProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Using a DependencyProperty as the backing store for Document.  This enables animation, styling, binding, etc...\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyProperty\u003c/span\u003e \u003cspan class=\"n\"\u003eDocumentProperty\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDependencyProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRegister\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Document\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etypeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"k\"\u003etypeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eViewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePropertyMetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePropertyChangedCallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eOnDocumentChanged\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnDocumentChanged\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyPropertyChangedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ectrl\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eViewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectrl\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003ectrl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eviewer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNewValue\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e処理の内容としては、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eDocumentPropertyというDependancyPropertyを作成し、変更されるとOnDocumentChangedが呼びます。\u003c/li\u003e\n\u003cli\u003eViewerControlのDocumentプロパティを差し替えています\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"自作のvb-reportのビューアviewercontrolexを配置する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%87%AA%E4%BD%9C%E3%81%AEvb-report%E3%81%AE%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2viewercontrolex%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e自作のVB-Reportのビューア(ViewerControlEx)を配置する\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eここでは、メインの画面に配置していますが、あとは自由です。\u003c/li\u003e\n\u003cli\u003eReport作成ボタンを押すとプレビューが出るようしました。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainUcView.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;UserControl\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:x=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:prism=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://prismlibrary.com/\"\u003c/span\u003e             \n             \u003cspan class=\"na\"\u003exmlns:vbr=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:AdvanceSoftware.VBReport8.WPF;assembly=VBReport8.WPF.Viewer\"\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Class=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"VbReportSampleApp.Views.MainUcView\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003exmlns:vw=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:VbReportSampleApp.Views\"\u003c/span\u003e\n             \u003cspan class=\"na\"\u003eprism:ViewModelLocator.AutoWireViewModel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"True\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;Grid\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;Grid.RowDefinitions\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;RowDefinition\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"60\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;RowDefinition\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"*\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/Grid.RowDefinitions\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;StackPanel\u003c/span\u003e \u003cspan class=\"na\"\u003eOrientation=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Horizontal\"\u003c/span\u003e \u003cspan class=\"na\"\u003eMargin=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"10\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Report作成\"\u003c/span\u003e \u003cspan class=\"na\"\u003eCommand=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding CreateReportCommand}\"\u003c/span\u003e  \u003cspan class=\"na\"\u003eCommandParameter=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding ElementName=viewerControlEx}\"\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"200\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/StackPanel\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;vw:ViewerControlEx\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"viewerControlEx\"\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.Row=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e \u003cspan class=\"na\"\u003eHorizontalAlignment=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Stretch\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVerticalAlignment=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Stretch\"\u003c/span\u003e \u003cspan class=\"na\"\u003eDocument=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding DocumentReport}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/Grid\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/UserControl\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003e自作のVB-Reportのビューア(ViewerControlEx)を介することでDocumentにBindingしてもエラーにならなくなります。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"自作のvb-reportのビューアviewercontrolexを配置した画面のviewmodelの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%87%AA%E4%BD%9C%E3%81%AEvb-report%E3%81%AE%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2viewercontrolex%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2%E3%81%AEviewmodel%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e自作のVB-Reportのビューア(ViewerControlEx)を配置した画面のViewModelの作成\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e今回は、メインの画面に配置\u003c/li\u003e\n\u003cli\u003e※ 帳票の作成には、アドバンスソフトウェア社のサンプルのファイルをそのまま使用しています。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainUcViewModel.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eAdvanceSoftware.VBReport8\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003ePrism.Commands\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003ePrism.Mvvm\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Xml\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eVbReportSampleApp.ViewModels\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMainUcViewModel\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eBindableBase\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainUcViewModel\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eDelegateCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eViewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ecreateReportCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDelegateCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eViewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateReportCommand\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecreateReportCommand\u003c/span\u003e \u003cspan class=\"p\"\u003e??\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecreateReportCommand\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDelegateCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eViewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eCreateDocumentExecute\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateDocumentExecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eViewerControlEx\u003c/span\u003e \u003cspan class=\"n\"\u003eviewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eviewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eviewer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDocumentReport\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e    \n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eXmlDocument\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eXmlDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eXmlNodeList\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserID\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003edesignFilePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"見積書.xls\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edesignFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 請求リストを読み込みます。\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e@\"見積書リスト.xml\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003elist\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectNodes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"/見積書リスト/顧客\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eXmlNode\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003euserID\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"@id\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"見積書\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 日付\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Date\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 見積有効日\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**EndDate\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003edouble\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToOADate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 見積書番号\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Mitsumori\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./見積書番号\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 会社名\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eofficename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./会社名\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eofficename\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**OfficeName\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./会社名\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 部署名\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esectionname\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./部署名\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionname\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**SectionName\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./部署名\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// お客様名\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**UserName\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./お客様名\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" 様\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 郵便番号\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Post\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"〒\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./郵便番号\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 住所県\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Address1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./住所県\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 住所その他\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Address2\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./住所その他\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 商品一覧\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eXmlNode\u003c/span\u003e \u003cspan class=\"n\"\u003eshyouhinNode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./商品明細\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eXmlNodeList\u003c/span\u003e \u003cspan class=\"n\"\u003elist2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eshyouhinNode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectNodes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./商品\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 一括割引対象品と除外品を判断するためのフラグ(\"1\"→\"0\"に変更した時点で割引額の表示)\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ediscount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ediscountPrev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eXmlNode\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003elist2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ediscount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./一括割引\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 一括割引対象品でなくなった時点で、割引額を求める\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 全て割引除外品の場合、計算を行わない\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ediscount\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ediscountPrev\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"c1\"\u003e// 合計額(税抜き)が、100万未満の場合、一括割引を行わない。\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"m\"\u003e1000000\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Shouhin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"（一括割引）\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Shouhin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eAttr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFontColor2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAdvanceSoftware\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVBReport8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003exlColor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ediscountGaku\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Kingaku\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ediscountGaku\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Kingaku\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eAttr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFontColor2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAdvanceSoftware\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVBReport8\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003exlColor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003ediscountGaku\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Biko\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"上記合計金額より２０％ＯＦＦ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Shouhin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"（以下、割引除外品）\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 商品名\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Shouhin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./商品名\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 数量\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eunitNumber\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./数量\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Suuryou\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eunitNumber\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 単価\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eunitPrice\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./単価\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Tanka\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eunitPrice\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 金額\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003etotalPrice\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eunitNumber\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eunitPrice\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Kingaku\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etotalPrice\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003etotalPrice\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 備考\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Biko\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectSingleNode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"./備考\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eInnerText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ediscountPrev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ediscount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 税抜\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Zeinuki\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 消費税\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003etax\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e0.05\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Zei\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etax\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 税込\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"**Zeikomi\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etotalSeikyu\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etax\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003edocumentReport\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003eDocumentReport\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eget\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edocumentReport\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eset\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eSetProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003edocumentReport\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eCellReport\u003c/span\u003e \u003cspan class=\"n\"\u003ecellReport1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCellReport\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"実行結果\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行結果\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ffec1c069d80801f9440901878241b862844ffab/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f39303539372f66343363623534642d333438622d376130662d386233342d6566303362373438656364652e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2Ff43cb54d-348b-7a0f-8b34-ef03b748ecde.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=19d79b2b0dab4b50cd03c0f715dcab04\" alt=\"VB-Reportgif.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/90597/f43cb54d-348b-7a0f-8b34-ef03b748ecde.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2Ff43cb54d-348b-7a0f-8b34-ef03b748ecde.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=48a616087b7f94903e50c4fda11bd036 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eMVVMパターンで行うならば、VB-Reportの場合は、DependancyPropertyを作成したユーザーコントロールを介してバインディングを行うことで解決します。\u003cbr\u003e\nPrismを使ったソリューションの場合にViewModelに固執するわけではありませんが、むやみやたらとコードビハインドで記述しないで済む方法があるということです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"追加補足\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E5%8A%A0%E8%A3%9C%E8%B6%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e追加補足\u003c/h2\u003e\n\n\u003cp\u003e2017/09/04\u003cbr\u003e\nアドヴァンスソフトウェア社から連絡があり、\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eCellReport のオブジェクトによる 2回目の帳票生成を\u003cbr\u003e\n行う場合は、1回目の帳票ドキュメントがビューアコントロールに紐付けられて\u003cbr\u003e\nいるため、予め viewerControl.Clear メソッドを呼び出して頂く必要がございます。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eという連絡がありましたので、ボタンコマンドにコマンドパラメータでElementNameを渡して、動作するように修正しました。\u003c/p\u003e\n\n\u003cp\u003eただ、以下のような修正でもよいかもしれません。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eViewerControlEx.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnDocumentChanged\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyPropertyChangedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ectrl\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eViewerControlEx\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectrl\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ectrl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eviewer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* ドキュメントのクリア */\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ectrl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eviewer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNewValue\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003e単純にプレビューを行いたのであれば、ドキュメント変更イベントにctrl.viewer.Clear();というのを追記すれば、ドキュメントの変更都度クリアされるので、あえてElementNameをコマンドパラメータを渡すより良いかもしれません。\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2017-08-31T02:32:41Z","elapsedYearsFromLastModifiedAt":4,"encryptedId":"DLR1FnFULLRDf4nqXNHWwTtMXwNF2n+o--1PYD0Gs7esPn6SPi--ZJKaEqs0UQl/KOWlH+fGbQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2017-09-04T02:55:52Z","likesCount":5,"linkUrl":"https://qiita.com/HAGITAKO/items/59bc13e53088b9ebcc88","organization":null,"originalId":519992,"stockedCount":8,"title":"[WPF][XAML]VB-ReportのWPF 用ビューアコントロールを使ってみる","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#vb-report%E3%81%AEwpf-%E7%94%A8%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B\"\u003eVB-ReportのWPF 用ビューアコントロールを使ってみる\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83\"\u003e開発環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%9D%E3%82%81%E3%81%AB\"\u003e初めに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#vb-report%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003eVB-Reportについて\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB\"\u003eコードのサンプル\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AA%AC%E6%98%8E%E7%9C%81%E7%95%A5%E9%83%A8%E5%88%86\"\u003e説明省略部分\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#wpf%E7%94%A8%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B%E3%81%A8%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003eWPF用ビューアを配置するとバインディングができない。\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86\"\u003e作成手順\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#viewercontrolexxaml%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e「ViewerControlEx.xaml」の作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#viewercontrolexxamlcs%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e「ViewerControlEx.xaml.cs」の作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%87%AA%E4%BD%9C%E3%81%AEvb-report%E3%81%AE%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2viewercontrolex%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B\"\u003e自作のVB-Reportのビューア(ViewerControlEx)を配置する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%87%AA%E4%BD%9C%E3%81%AEvb-report%E3%81%AE%E3%83%93%E3%83%A5%E3%83%BC%E3%82%A2viewercontrolex%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2%E3%81%AEviewmodel%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e自作のVB-Reportのビューア(ViewerControlEx)を配置した画面のViewModelの作成\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\"\u003e実行結果\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%BF%BD%E5%8A%A0%E8%A3%9C%E8%B6%B3\"\u003e追加補足\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":5589,"uuid":"59bc13e53088b9ebcc88","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"dNp3QSwfdBV2TC02Ym0gk/hKLMY=--5bBC0YiGjeJm3ntX--TY/msL4EpDua1R3azr1vDA==","originalId":90597,"description":"社内SEとして１7年くらい\r\n最近では、管理職のため仕事での使用頻度は少なくなってきてます。\r\n社内新規案件のプロトタイプが主なコードを触るくらい。\r\n\r\nWPF大好きです。","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":"https://www.linkedin.com/in/kotaro-hagita-0b146a129","name":"Ko Hagita","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/90597/profile-images/1494260215","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2Fprofile-images%2F1494260215?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=ba3207a6744aafbd07a4fb345f0da5f5","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F90597%2Fprofile-images%2F1494260215?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=516f368de7ec48c4c3b7b4b416a8f375","urlName":"HAGITAKO","websiteUrl":"https://tsukui-hd.co.jp/","twitterUrl":"https://twitter.com/HAGITAKO","twitterUrlName":"HAGITAKO","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"WPF","urlName":"wpf"},{"name":"Xaml","urlName":"xaml"},{"name":"MVVM","urlName":"mvvm"},{"name":"PRISM","urlName":"prism"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
