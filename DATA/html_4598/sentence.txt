More than 1 year has passed since last update.Oracle に接続する場合、対象PCに Oracle クライアントをインストールする必要があるアプリケーションがありまして、リプレース作業に伴い「ODP.NET Managed Driver」に切り替えてOracle クライアントのインストールする手順を省きたいと思っています。
「ODP.NET Managed Driver」は、.NET 4以降のアプリケーションから使用できます。ちなみに Java の場合、「Oracle Thin JDBC Driver」を使えば Oracle クライアントを介せずに直接 Oracle に接続することができます。ようやっと Java と同じことが出来るわけですね。Windows 10 Home
Visual Studio 2017 Communicate
Oracle Database 11g Express Edition (Oracle Database XE)
Oracle.ManagedDataAccess Ver 4.122.18.3記事を書く上で自宅PCの環境となります。NuGetのソリューションのパッケージ管理で「ODP」で検索して、「Oracle.ManagedDataAccess」をインストールします。※2018/09/22現在のバージョンは、v18.3.0参照に Oracle.ManagedDataAccess が追加されます。
また、App.config に自動的に設定が追加されます。アプリから接続文字列で指定したデータソースの実体を解決するには、次のいずれかが必要になる。一番シンプルに、接続文字列のDataSourceに「ホストIPアドレス/SID」をセットする。接続文字列のDataSourceに、Descriptorの内容をセットする。
注意として、Descriptorの内容についてすべてのキーワードがサポートされてはおらず、一般的に使用される一部のキーワードのみサポートとなっています。
ODP.NET Managed Driver(管理対象ドライバ)についての私的まとめapp.configのdataSource要素にtnsnames.oraの内容を指定します。接続文字列のDataSourceにdataSourceのエイリアス名をセットします。app.configのsettings要素にtnsnames.oraの置き場所を指定します。
ORACLE_HOMEの場所は、コマンドプロンプト上で下記を実行すると表示されます。
※KEY_xe のところは、KEY_(SID名) となります。ちなみに環境変数に「%ORACLE_HOME%」をセットしたが、変なエラーになったので環境変数はやめました。WindowsはレジストリからORACLE_HOMEを取得しているので何か影響が出てしまうのかな。tnsnames.ora ファイル接続文字列のDataSourceにネットサービス名(TNS名)を指定します。exeファイルの直下にtnsnames.oraファイルを置きます。接続文字列のDataSourceにネットサービス名(TNS名)を指定します。サーバー上で動かすツール用です。WindowsではORACLE_HOMEの場所はレジストリに記述されています。レジストリからORACLE_HOMEの値を取得してtnsname.oraファイルの場所を見つけ、Descriptorの内容を接続文字列のDataSourceに指定します。レジストリを取得する際には注意が必要です。AnyCPUにしていても「32ビットを優先」にチェックが付いていると、32ビットのレジストリを取得してしまうので、チェックを外す必要があります。
VisualStudioプロジェクトプロパティの「32ビットの優先」チェックボックス
dic変数にはネットサービス名をキーにDescriptorの内容がセットされるので、dataSourceに指定します。もう2018年9月です、Windows 10は.NET Framework 4.6が標準に搭載されています。
Windows 7の延長サポート終了日は2020年1月14日となります。古い環境はリプレースしていきましょうよ。


