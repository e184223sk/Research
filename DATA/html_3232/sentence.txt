More than 1 year has passed since last update.Windows標準のスクリーンキャプチャーツールは、ピクセル単位での領域選択ができない。
いろいろなツールは良いものばかりだけど自分には機能が使いこなせない。
古いツールでは Aero の有効なウィンドウのキャプチャが綺麗にできない。
それならということで、.NET でスクリーンキャプチャーツールを作ってみました。GitHubにあります。
https://github.com/kerobot/GamenShot.gitできるだけ Win API を利用しないようにしましたが、少々利用しています。
かなり久しぶりにハンドルとか利用したので、実装は怪しいです。
ご利用は自由ですが自己責任でお願いします。例えばこんな感じ。Bitmap オブジェクトは呼び出し元で using ステートメントを使ってます。
Graphics オブジェクトも using ステートメントを使えるか…。GitHub の Releases の Assets にあります。
https://github.com/kerobot/GamenShot/releasesバージョンはまだ0.1としています。
.NET Framework 4.7.2がインストールされていない環境では、実行時にエラーとなります。こちらの情報をフックの実装に利用させて頂きました。
C#にてマウスとキーボードを操りし者画像保存時の減色（画像サイズ縮小）
Word とか Excel に画像を貼り付けるときにできるだけ画像のサイズを小さくしたい。画像保存時の画像フォーマット増加
画像処理系の実装は楽しいので、いろいろなフォーマットを試してみたい。キーボードショートカットの任意設定　など
複雑にしすぎない程度の設定機能の追加やカーソルを表示してキャプチャの ON/OFF とか。* ラバーバンドの描画を XOR 演算でやろうとしたけど、どうしても描画色が反転しない。
    SetROP2 で描画モードに R2_NOT とか指定して、前回の描画を今回の描画で上書きしたのに線が消えなかった。
    XOR 演算を利用した描画が定石だと思っていたけど、環境の問題かしら？* Win32API ではなく、ControlPaint.DrawReversibleFrame を使ってもうまく描画できない。
    そもそもの使い方が間違っているのかも、あらためて挑戦してみたい。2019/06/14更新2019/06/19追記


