More than 1 year has passed since last update.Visual StudioでAlexaスキルのコーディングを行ってAWS Lambdaにデプロイし、それを実際に動かすところまではこちらの記事に書きました。
そこではLaunchRequestかそうでないか（IntentRequestか）でAlexaの応答を変更するだけの至極単純なスキルにしていました。今回はもう少し作り込んで、IntentRequestだった場合にそれが何のインテントなのかによって更に応答を変化させるようにしてみましょう。まずはAlexa開発者コンソールに移動し、前回作った「 MyFirstCSharpSkill」の対話モデルにインテントを追加します。
Alexaに「挨拶して」と話しかけたら「こんにちは」と挨拶を返してくれるようにしてみましょう。
「挨拶して」に対して発行されるインテントを「GreetingIntent」として追加します。名前をつけてカスタムインテントを作成します。
そして、以下のように申し訳程度のサンプル発話を登録します。
ユーザーからこれらの発話があった場合にGreetingIntentが発行されます。
対話モデルに変更を加えたので、ビルドします。
これで、「サンプル呼び出しで挨拶して」と言うとGreetingIntentがAWS Lambdaに送られます。Visual Studioで前回作ったMyFirstCSharpSkill_Lambdaプロジェクトを開きます。コードが泥臭いのはとりあえず目をつむってください。
より良い書き方はいずれ。さて、以下が変更を加えたFunctionHandlerメソッドです。
どこが変更、というか追加されたかというと中盤あたりの「インテント名で場合分け」というコメントのあたりからです。
IntentRequestオブジェクトを取得して、そこからインテント名を取得し、それに従って処理を場合分けしています。試してみましょう。
SampleIntentとGreetingIntentをそれぞれ呼び出してみると、以下のように対応した応答が帰ってくるのがわかります。
これで、より複雑な対話をアレクサと楽しむことができるようになりました。


