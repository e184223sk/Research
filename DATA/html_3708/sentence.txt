More than 1 year has passed since last update.ユーザーにフォルダパスを選択してもらうためのダイアログボックスとして、WinFormsのコモンダイアログクラスには、FolderBrowserDialog クラスが用意されていますが、パスを手入力できなかったりと結構不便です。
Microsoft Office の Application.FileDialog オブジェクトを使うと、ファイル選択ダイアログボックスに近い、割とリッチなUIでフォルダ選択ができます。どうやら後者は Windows Vista 以降に用意された IFileOpenDialog インターフェイスをインプリメントした FileOpenDialog COMオブジェクトを利用したもののようです。
これを利用するには、"Windows API Code Pack" を利用する（有志が作成した NuGet パッケージあり）方法もありますが、exeモジュール単体に機能を同梱させることなどを想定して（NuGetパッケージは.dllで取り込まれる）、C#のコードで記述してみます。※OpenFileDialogとは異なります。つづりが微妙に違うので注意FolderSelectDialog と命名してあります。詳細は、後日気が向いたときに...FolderSelectDialog クラスのインスタンスを生成し、ShowDialog メソッドを呼び出すとダイアログボックスが表示されます。そして、ユーザーの応答結果がほかの一般的なコモンダイアログクラスのように DialogResult の値で返され、DialogResult.OK が返された場合は、Path プロパティに選択されたフォルダのパスが入ります。


