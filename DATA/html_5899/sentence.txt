More than 3 years have passed since last update.お仕事で外部アプリケーションが出力するログを監視し、ある条件なら警告画面を前面に表示させる要望がありました。
前面ならTopMostにして最前面にすればいいと思ったのですが、指定のダイアログ画面や指定のボタンまたはラベルが表示されている場合には前面を解除したいということになり、タイマーで外部アプリケーションの表示状態を監視して前面表示を解除するようにする予定です。休日に検証がてら外部アプリケーションの画面上すべてのタイトル(キャプション)を取得するクラスを作ってみました。外部アプリケーションはアンマネージドで作成されているので、Win32 APIを使用して取得しています。【2017/12/08】
namespaceは削除しました。
タブコントロール内の全てのページを取得してしまっていたため、isAllの引数を追加しました。isAll=falseなら、タブコントロール内で選択ページのみ取得となります。(IsWindowVisibleで判断)Windowsクラスには、クラス名とタイトルとウィンドウハンドルを格納しています。WindowsListプロパティに、フォームごとに項目が格納されるようになっています。メモ帳(notepad)で、置換ダイアログ画面を表示している場合
WindowsListには2つリストが作成され、その中に全ての項目が格納されます。
メモ帳(notepad)の置換ダイアログ画面を表示した際に、「キャンセル」ボタンがあるかチェックしています。コード改変や配布は自由です。
このツールによる義務／責任を何ら負いません。アンマネージドのダイアログ画面のクラス名は、#32770になるんですが、マネージド(.NETアプリケーション)のクラス名は普通です。このクラスは、ご自由に改変して使ってください。


