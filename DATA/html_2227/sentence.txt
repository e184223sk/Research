インストールレス・ライブラリレスでいける音声入力処理を作ってみた。※終了処理は作ってません。2020.09.13更新：高速フーリエ変換を追加実装してみた。
※コード書きっぱなし・・未検証です・・マーシャリングがつらすぎた。「ここ」見つけられなかったら多分動くところまで行けてない。WinMMを使う場合、下記の問題
・32bitアプリとしてしかつかえなさそう。
・バッファが枯渇するとアプリごと落ちる現象が発生した（自分のアプリのバグかもですが）。
が出たので、
DirectX(←使うにはインストールが必要そう)なりWASAPIを勉強したほうがよいかもしれない。
ほかの手段は下記が参考になりそう。
http://mikeo410.minim.ne.jp/cms/~programingaudiorecordingWinMMのAPI関連の構造体が64bitを考慮していないようなので、32bitアプリとしてコンパイルする必要があります。
32bit指定はcsc /platform:x86 ファイル名.csでコンパイルすればよいです。※高速フーリエ変換を追加実装した際にComplex型を使用する変更を加えたので、下記でコンパイルする必要があります。
csc /platform:x86 /r:C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.Numerics.dll ファイル名.csWindows10 64bit環境で下記警告がでましたが、動作しました。
（ご利用は自己責任で・・）コマンドラインから実行する場合は、chcp 65001でUTF-8を表示できるようにしておいてください。WinMM関連の定義値はmmsystem.hでググると何かしら見つかるはず。


