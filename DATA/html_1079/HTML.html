<!DOCTYPE html><html><head><meta charset="utf-8" /><title>特許技術者の憂鬱・明細書の段落番号付与 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/kenichiro_ayaki/items/73e4c19f9020d06b6076" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="C56J7FR+/IsNVW1T0ALKNqsLO8Rkxoc23rW1tx9wM0A2vLF5QWlCe9CBwuiVAJ4sLWVDBGpaYpEA7BwC/7j3cg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="特許技術者の憂鬱・明細書の段落番号付与 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01NG01NktpeDVvcUE2S0dUNklDRjQ0R3U1b2FDNmF5eDQ0Tzc1cGlPNTdTdzVwdTQ0NEd1NXE2MTZKQzk1NVdxNVktMzVMdVk1TGlPJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWNkMTEyMGU1ZmE1OGViZTFjMWY3ODc3Y2EyODRlNjkw&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RsYm1samFHbHliMTloZVdGcmFRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZGNiMmU1ZmM3YmYxNDBhM2RiMGY0Y2M0ZmEwMWE1MmU&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=04aa904696f31ee87d8a47e653af77bd"><meta property="og:description" content="

ユースケース

或るブラック特許事務所の午後。

ワイ「あー、今日もワード、明日もワードで明細書書きや。コロナ禍いうても出社してるんや。」
ワイ「かといってテレワークやと画面の反応が遅くてストレスやしなあ。」
ブラック所長「今日が..."><meta content="https://qiita.com/kenichiro_ayaki/items/73e4c19f9020d06b6076" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,office,Word,VSTO,アドイン" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-b781c897-6a47-4a7c-bf36-bbb8199fdf7a"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fkenichiro_ayaki%2Fitems%2F73e4c19f9020d06b6076">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fkenichiro_ayaki%2Fitems%2F73e4c19f9020d06b6076">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-b781c897-6a47-4a7c-bf36-bbb8199fdf7a">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-07-11T13:38:05.000+09:00","dateModified":"2020-07-15T18:17:53.000+09:00","headline":"特許技術者の憂鬱・明細書の段落番号付与","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01NG01NktpeDVvcUE2S0dUNklDRjQ0R3U1b2FDNmF5eDQ0Tzc1cGlPNTdTdzVwdTQ0NEd1NXE2MTZKQzk1NVdxNVktMzVMdVk1TGlPJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWNkMTEyMGU1ZmE1OGViZTFjMWY3ODc3Y2EyODRlNjkw\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RsYm1samFHbHliMTloZVdGcmFRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZGNiMmU1ZmM3YmYxNDBhM2RiMGY0Y2M0ZmEwMWE1MmU\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=04aa904696f31ee87d8a47e653af77bd","mainEntityOfPage":"https://qiita.com/kenichiro_ayaki/items/73e4c19f9020d06b6076","author":{"@type":"Person","address":"日本国、埼玉県","email":null,"identifier":"kenichiro_ayaki","name":"kenichiro_ayaki","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F266273%2Fprofile-images%2F1553914112?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=427784b5ab45d3de6a5b5f2e6cc64d7b","url":"https://qiita.com/kenichiro_ayaki","description":"第１種情報処理技術者\r\n電気通信主任技術者\r\n弁理士","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kenichiro_ayaki","type":"items","id":"73e4c19f9020d06b6076"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kenichiro_ayaki","type":"items","id":"73e4c19f9020d06b6076"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kenichiro_ayaki","type":"items","id":"73e4c19f9020d06b6076"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/kenichiro_ayaki/items/73e4c19f9020d06b6076","location":"/kenichiro_ayaki/items/73e4c19f9020d06b6076","scheme":"https","host":"qiita.com","port":null,"pathname":"/kenichiro_ayaki/items/73e4c19f9020d06b6076","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"/ANUHyHO6pNK67DD//K9qulJ16BNlrXESZPSqoykpj3BIWyKNNlUY5c/H3i68OmwbyevYEMKUGOXynsfbGxiDw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-e5a25f0f-1462-4b8c-b76a-3d3909b9140a"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/likers" class="css-1iupg5d">3</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">1</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/73e4c19f9020d06b6076/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/kenichiro_ayaki"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/266273/profile-images/1553914112" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/kenichiro_ayaki" class="css-10ougpm">@<!-- -->kenichiro_ayaki</a><div class="css-1ay9vb9"><span><meta content="2020-07-11T04:38:05Z"/><time dateTime="2020-07-15T09:17:53Z" class="css-m19uds">updated at 2020-07-15</time></span></div></div></div></div></div><h1 class="css-cgzq40">特許技術者の憂鬱・明細書の段落番号付与</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/office" class="css-4czcte">office</a><a href="/tags/word" class="css-4czcte">Word</a><a href="/tags/vsto" class="css-4czcte">VSTO</a><a href="/tags/%e3%82%a2%e3%83%89%e3%82%a4%e3%83%b3" class="css-4czcte">アドイン</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="ユースケース" class="fragment"></span><a href="#%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9"><i class="fa fa-link"></i></a>ユースケース</h1>

<p>或るブラック特許事務所の午後。</p>

<p>ワイ「あー、今日もワード、明日もワードで明細書書きや。コロナ禍いうても出社してるんや。」<br>
ワイ「かといってテレワークやと画面の反応が遅くてストレスやしなあ。」<br>
ブラック所長「今日が納品締切日の、Ａ社さんへの特許明細書できたか？」<br>
ワイ「はい、できました！」</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">ワイ君の明細書原稿</span></div>
<div class="highlight"><pre class="with-code"><code>【書類名】明細書
【発明の名称】物質エネルギ変換装置
【技術分野】
　【０００１】
　本発明は、物質をエネルギに変換する物質エネルギ変換装置である。
【背景技術】
　【０００２】
　従来、エネルギを得るには、化学反応または核反応を用いる必要があり、効率が悪かっ
た。
　【０００３】
　非特許文献１には、反物質が物質と合わさって厖大なエネルギを発することが記載され
ている。
【先行技術文献】
　【０００４】
　【非特許文献】
　【０００５】
　　【非特許文献１】ダン・ブラウン、"天使と悪魔”、２０００年初版
【発明の概要】
【発明が解決しようとする課題】
　【０００６】
　非特許文献１では、反物質を生成する必要があった。反物質の生成には、この反物質が
物質と合わさってエネルギを生成する以上のエネルギが必要であった。
　【０００６】
　そこで、本発明は、物質をそのままエネルギに変換することを課題とする。
【課題を解決するための手段】
　【０００７】
　本発明の物質エネルギ変換装置は、水素を入力する水素入力手段と、当該水素を吸収す
る希土類金属結晶部と、当該希土類金属結晶部の所定の結晶方向に磁場を与える磁場形成
部とを有する。
【発明の効果】
　【０００８】
　本発明によれば、高い効率で物質をエネルギーに変換することができる。
【図面の簡単な説明】
　【０００９】
　【図１】本実施形態の物質エネルギ変換装置の構成図である。
　【図２】物質エネルギ変換装置の動作を説明する図である。
【発明を実施するための形態】
　【００１０】
　図１は、本実施形態の物質エネルギ変換装置１の構成図である。
　【００１０】
　物質エネルギ変換装置１は、水素入力部１１と、希土類金属結晶１２と、磁場形成部１
３と、これらを包み込む中性子遮蔽部１４とを備える。この物質エネルギ変換装置１は、
水素原子を直接にエネルギに変換するものである。
　【００１１】
　水素入力部１１は、・・・・・・・・・・・・・・・・・・・・・・・・である。
　【００１２】
　希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・・・であり、水
素入力部１１から入力された水素を吸収して・・・・・・・・・・・・・・・・・・・・・
・・・する。この希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・
・することにより、・・・・・・・・・する。
　【００１３】
　磁場形成部１３は、・・・・・・・・・・・・・・・・・であり、希土類金属結晶の１１
１方向の磁場を形成して、・・・・・・・・・、・・・・・・・・・・・・・・・・・・・
する。これにより、希土類金属結晶１２に吸収されている水素原子は、・・・・・・・・・
・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・する。
　【００１４】
　中性子遮蔽部１４は、水素原子のエネルギ化に伴い、希土類金属結晶１２から出射される
中性子線を遮蔽する。この中性子遮蔽部１４は、例えば・・・・・・・・・・・・・・・・
・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・
・・・であり、・・・・・・・・・する。
　図２は、物質エネルギ変換装置の動作を説明する図である。
　【００１５】
　水素は、水素入力部１１によって高圧（例えば、１０万メガパスカル）に圧縮されて、希
土類金属結晶１２が位置する炉内に導かれる。希土類金属結晶１２の水素吸収能力により、
水素は、希土類金属結晶１２に吸収される。そして、磁場形成部１３は、・・・・・・・・
・・・・・・・・・・・・・。これにより、希土類金属結晶１２からエネルギが放出され、
中性子線が出射される。
　【００１６】
　物質エネルギ変換装置１が変換するエネルギEは、以下の式（１）によって示される。
但し、Mは水素の質量である。Cは光速である。
　【数１】
    E=MC^2・・・（１）
　よって、本実施形態の物質エネルギ変換装置１によれば、反物質を生成することなく、
物質を直接的にエネルギに変換することができる。
【符号の説明】
　【００１７】
１　物質エネルギ変換装置
１１　水素入力部
１２　希土類金属結晶
１３　磁場形成部
１４　中性子遮蔽部
</code></pre></div>
</div>

<p>ブラック所長「なんやこれは、段落番号がデタラメやないか！」<br>
ブラック所長「なんで【先行技術文献】の直後に段落番号【０００４】を入れてるんや！　段落番号を入れてもええ項目と、段落番号を入れてはいかん項目を覚えや。」<br>
ブラック所長「ほんで、数式【数１】と文章との区切りには段落番号を入れんとな。」<br>
ブラック所長「【００１０】の次にまた【００１０】があるぞ、連番で記載な！」<br>
ブラック所長「図１の説明のあたりは段落番号を入れすぎ！　改行があるからいうて、１行ごとに機械的に入れたらあかん。クライアント企業から水増しやゆうてクレームくるぞ。」<br>
ブラック所長「ここ、『図２は、物質エネルギ変換装置の動作を説明する図である。』ゆうて、違う図面のことを書き始めとるから、こういうところに段落番号を入れんとあかんのやが、なんでここに入っとらんのや。この次に段落番号【００１５】が入っとるけど、ここは意味としての区切りやないやろ。」</p>

<p>ワイ「は、はい（白目）」<br>
ブラック所長「段落番号の振り方がええ加減やと、クライアント企業に、中身もその程度の品質だって思われるぞ！」<br>
ブラック所長「納品時に厳しくチェックされるし注意せなあかん！」<br>
ワイ「はい（白目）」<br>
ブラック所長「ほな、ワシはとりあえず帰るぞ。」<br>
・・・<br>
ワイ「あー、ブラック所長はとっとと帰ってしもうたか。なんや最近の所長は、どうでもいい重箱の隅つつきばっかやなあ。まあええわ、こんな重箱の隅なところは、プログラムで生成したるぞ。」</p>

<p>ワイ「段落番号を連番にするだけやったら、WORDのフィールドコードでもええんやがな。段落番号を入れてはいけない項目だとか、段落番号を入れなきゃいけない項目だとか、覚えるのも面倒だし。意味の区切りとかもあるしな。」</p>

<h1>
<span id="特許明細書の書式調査" class="fragment"></span><a href="#%E7%89%B9%E8%A8%B1%E6%98%8E%E7%B4%B0%E6%9B%B8%E3%81%AE%E6%9B%B8%E5%BC%8F%E8%AA%BF%E6%9F%BB"><i class="fa fa-link"></i></a>特許明細書の書式調査</h1>

<p>ワイ　「特許明細書の書式について書かれた文献を見つけたで。根拠条文は、特許法施行規則第２４条の様式第29やな。」</p>

<p><qiita-embed-ogp src="https://www.jpo.go.jp/system/laws/rule/guideline/document/syutugan_tetuzuki/02_03.pdf"></qiita-embed-ogp></p>

<blockquote>
<p>「18 明細書（配列表は除く。）には、原則として、発明の詳細な説明の段落、図面の簡単な説明の図の説明若しくは符号の説明又は配列表フリーテキストの繰り返し記載の前に、それぞれ「【」及び「】」を付した４桁のアラビア数字で「【０００１】」、「【０００２】」のように連続した段落番号を付す。</p>
</blockquote>

<p>ワイ　「つまり、段落番号は４桁の連番ということやな。」</p>

<blockquote>
<p>この場合において、「【技術分野】」、「【背景技術】」、「【特許文献】」、「【非特許文献】」、「【発明の概要】」、「【発明が解決しようとする課題】」、「【課題を解決するための手段】」、「【発明の効果】」、「【図面の簡単な説明】」、「【発明を実施するための形態】」、「【実施例】」、「【産業上の利用可能性】」、「【符号の説明】」、「【受託番号】」又は「【配列表フリーテキスト】」の見出しの次に段落番号を付し、これらの見出しの前に段落番号を付してはならない。</p>
</blockquote>

<p>ワイ　「【先行技術文献】は、ここに挙げた中にないのに段落番号を付けたからあかんかったのな。」</p>

<blockquote>
<p>また、「【特許文献１】」、「【非特許文献１】」、「【化１】」、「【数１】」、「【表１】」、「【図１】」のような番号の次に段落番号を付してはならない。」</p>
</blockquote>

<p>ワイ　「他に段落番号を付けたらあかんのは、「【書類名】」、「【発明の名称】」、「【発明の概要】」やな。」</p>

<h1>
<span id="従来技術調査" class="fragment"></span><a href="#%E5%BE%93%E6%9D%A5%E6%8A%80%E8%A1%93%E8%AA%BF%E6%9F%BB"><i class="fa fa-link"></i></a>従来技術調査</h1>

<p>ワイ　「vectorとかで段落番号の自動付与や振り直し機能を持つものは色々あるなあ、DANRAKU, 特許明細書の段落番号自動置換マクロ, 特許出願支援プログラム 段落振り版, 明細書再付番マクロ・・・」<br>
ワイ　「ユーザインタフェースは参考になるな、段落番号を自動付与する機能、段落番号を連番に振り直す機能、段落番号を削除する機能があればええんやな。」<br>
ワイ　「でも、どのソフトウエアも、ブラック所長の好みにあいそうな段落番号の振り方じゃないなあ・・・。」</p>

<table>
<thead>
<tr>
<th style="text-align: left">名称</th>
<th style="text-align: left">概要</th>
<th style="text-align: left">作者</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><a href="https://www.vector.co.jp/soft/winnt/business/se508771.html?_ga=2.208341205.656111451.1593267346-1579654811.1591502522" rel="nofollow noopener" target="_blank">DANRAKU</a></td>
<td style="text-align: left">【段落番号】の自動付与・振り直しなどを1クリックで行うためのアドイン 英文明細書の形式にも対応</td>
<td style="text-align: left">Clockahead</td>
</tr>
<tr>
<td style="text-align: left"><a href="https://www.vector.co.jp/soft/win95/business/se299105.html?_ga=2.53095663.656111451.1593267346-1579654811.1591502522" rel="nofollow noopener" target="_blank">特許明細書の段落番号自動置換マクロ(Word用)</a></td>
<td style="text-align: left">明細書中の段落番号を自動的に振り直す(新旧様式対応)</td>
<td style="text-align: left">岡田稔</td>
</tr>
<tr>
<td style="text-align: left"><a href="https://www.vector.co.jp/soft/win95/business/se484499.html?_ga=2.246539459.656111451.1593267346-1579654811.1591502522" rel="nofollow noopener" target="_blank">特許出願支援プログラム 段落振り版</a></td>
<td style="text-align: left">特許明細書のWordファイルに対して新規段落振り・段落振り直しを行う</td>
<td style="text-align: left">ソフト研究会（ライフラボ株式会社）</td>
</tr>
<tr>
<td style="text-align: left"><a href="https://www.vector.co.jp/soft/winnt/business/se434178.html" rel="nofollow noopener" target="_blank">特許明細書の段落番号等を操作するマクロ</a></td>
<td style="text-align: left">番号付与や再付与をするマクロ 【化】【数】【表】や【化1-1】等、HTMLファイルにも再付与が可能</td>
<td style="text-align: left">えの</td>
</tr>
<tr>
<td style="text-align: left"><a href="https://www.vector.co.jp/soft/win95/business/se377703.html?_ga=2.231894815.1469615736.1593342817-1960651967.1586016428" rel="nofollow noopener" target="_blank">明細書再付番マクロ(MS-Word)</a></td>
<td style="text-align: left">特許明細書の各種項番を振り直す</td>
<td style="text-align: left">(有)DJソフト</td>
</tr>
</tbody>
</table>

<h2>
<span id="仕様" class="fragment"></span><a href="#%E4%BB%95%E6%A7%98"><i class="fa fa-link"></i></a>仕様</h2>

<p>ワイ　「Visual Studio 2019でWORD VSTO (Visual Studio Tools for Office)アドインとして開発しよ。」<br>
同僚Ｘ「おお、ワイ君はなんかまた作り始めたなあ。」<br>
ワイ　「ええ、段落番号の入力を自動化するんですよ。」<br>
同僚Ｘ「ちゃんとできたら皆にも公開な。」<br>
ワイ　「は、はい。・・・（公開を考えて、VBAじゃなくVSTOで作成して良かった・・・）」</p>

<h2>
<span id="セットアップ" class="fragment"></span><a href="#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>セットアップ</h2>

<p>ワイ　「はい、エクスさん使ってみてください。」<br>
同僚Ｘ「おお、ちゃんとセットアップもあるなあ。」<br>
ワイ　「・・・（Visual Studioの発行メニューをクリックしただけやけどな。）」<br>
同僚Ｘ「なんやエラーが出てインストールできないぞ。」<br>
<a href="https://camo.qiitausercontent.com/fd674d72f4b3e52de2f16d8d2cd9057863f056f4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f38626466636532382d373936322d636237352d666163372d3864316336353135376132652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8bdfce28-7962-cb75-fac7-8d1c65157a2e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=611733fb1c992b96dbde809200a5c089" alt="01SmartScreen.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/8bdfce28-7962-cb75-fac7-8d1c65157a2e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8bdfce28-7962-cb75-fac7-8d1c65157a2e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b239a10464499a20d467b18706d4d38d 1x" loading="lazy"></a><br>
ワイ　「これは、詳細情報をクリックしてください。」</p>

<p><a href="https://camo.qiitausercontent.com/54edad526c5716882f6cec0710cd752df70ddd48/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f38623730353431652d613132332d613239392d333664372d3665343839373834363562342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8b70541e-a123-a299-36d7-6e48978465b4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=99df7b446e7aa8ecf073eed26fa6b948" alt="02SmartScreen.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/8b70541e-a123-a299-36d7-6e48978465b4.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8b70541e-a123-a299-36d7-6e48978465b4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=13e04df06dd9caa205ca73f2f3ea926d 1x" loading="lazy"></a><br>
ワイ　「この実行ボタンをクリックします。」<br>
<a href="https://camo.qiitausercontent.com/40bc1318208a9943acc7b02ff029f44d68e2ffdc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f39656361343333362d353466302d616236372d366331312d3739616231643133646630382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F9eca4336-54f0-ab67-6c11-79ab1d13df08.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d4840cf7973fffe78cc65393d7180aaa" alt="03vstoerror.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/9eca4336-54f0-ab67-6c11-79ab1d13df08.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F9eca4336-54f0-ab67-6c11-79ab1d13df08.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=eb2c951fdba3874bd7460af239b3fca6 1x" loading="lazy"></a></p>

<p>同僚Ｘ「なんやエラーが出てインストールできないぞ。」<br>
ワイ　「おかしいなあ」<br>
・・・<br>
ワイ　「わかりましたよ。インターネットからダウンロードしたファイルには、『ゾーン識別子』が付いてるんですけど、このせいです。対策しますから待ってください。」</p>

<p>VSTOを用いて作成したアドインの配布方法<br>
<a href="https://wiki.clockahead.com/index.php?Coding%2FMSOffice%2FVSTO%2F%C7%DB%C9%DB%A4%CE%CA%FD%CB%A1" class="autolink" rel="nofollow noopener" target="_blank">https://wiki.clockahead.com/index.php?Coding%2FMSOffice%2FVSTO%2F%C7%DB%C9%DB%A4%CE%CA%FD%CB%A1</a></p>

<p>VSTOにおいてSecurityExceptionによってファイルがインストールできないとき<br>
<a href="http://artfulplace.hatenablog.com/entry/2014/05/26/154251" class="autolink" rel="nofollow noopener" target="_blank">http://artfulplace.hatenablog.com/entry/2014/05/26/154251</a></p>

<h2>
<span id="セットアップ再び" class="fragment"></span><a href="#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E5%86%8D%E3%81%B3"><i class="fa fa-link"></i></a>セットアップ再び</h2>

<p>ワイ　「はい、エクスさん使ってみてください。」<br>
同僚Ｘ「Install.batをクリックするんやな。」</p>

<p><a href="https://camo.qiitausercontent.com/df9c62f826300b6ffa008c2121868dbd80ebe294/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f39363430353932342d663038612d336235342d326231662d6461366162346634666461662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F96405924-f08a-3b54-2b1f-da6ab4f4fdaf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a8422d5ee1b788d60d2c463f81f651c9" alt="03vsto.install.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/96405924-f08a-3b54-2b1f-da6ab4f4fdaf.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F96405924-f08a-3b54-2b1f-da6ab4f4fdaf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5e6c2092db21c1d25dc65645d4377336 1x" loading="lazy"></a></p>

<p>同僚Ｘ「セットアップは無事終わり。そしたら、WordにAppLintとかいうリボンができるんだな。」</p>

<p>ワイ　「これが段落追加ボタンです。ボタンを押すと段落が自動で付きますよ。」<br>
<a href="https://camo.qiitausercontent.com/d9b1b156dd54c7b48bbfd3b6c6c209a924cfc159/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f37353131356638652d323637372d306261632d393762652d3963633335306662333261642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F75115f8e-2677-0bac-97be-9cc350fb32ad.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d0e56d5ee7f065bcbcc5810ea967d87a" alt="add1.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/75115f8e-2677-0bac-97be-9cc350fb32ad.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F75115f8e-2677-0bac-97be-9cc350fb32ad.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e5757912816e9cd37a922534b28f06ff 1x" loading="lazy"></a></p>

<p>ワイ　「これが段落振り直しボタンです。ボタンを押すと、既存の段落を追番に振り直します。」<br>
<a href="https://camo.qiitausercontent.com/cb29b80daef95edd5f5c0f549400cece9256f2e6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f33343537663737372d323132662d613938622d323664382d3437303763383864346432612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F3457f777-212f-a98b-26d8-4707c88d4d2a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=03b8bd3a421cb5d6aadae02ea7baffc7" alt="renum1.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/3457f777-212f-a98b-26d8-4707c88d4d2a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F3457f777-212f-a98b-26d8-4707c88d4d2a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d22da4d3238973e6ff654b5744a31972 1x" loading="lazy"></a></p>

<p>ワイ　「これが段落削除ボタンです。最初はまっさらにした方がいいときもあります。」<br>
<a href="https://camo.qiitausercontent.com/b431978dd7d46c126ac1eae241d22ac0921de342/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f37303365663238302d313938642d346461612d326464632d3334376261343239636138362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F703ef280-198d-4daa-2ddc-347ba429ca86.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f783f9e2aeb4be0d50ae13c245e6dfbe" alt="del1.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/703ef280-198d-4daa-2ddc-347ba429ca86.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F703ef280-198d-4daa-2ddc-347ba429ca86.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=36fa046087d31c14d2f35836a101c37b 1x" loading="lazy"></a></p>

<p>同僚Ｘ「クライアントさんから帰ってきたチェック済原稿を開いて、段落番号追加ボタンをクリック、と。」<br>
<a href="https://camo.qiitausercontent.com/06c5cee142e672e08b633c5826dc78cffc1dfb37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f30663030626331642d393432342d383461362d343564342d6130346432373933316137342e706e67" target="_blank" rel="nofollow noopener"><img width="616" alt="変更履歴on.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F0f00bc1d-9424-84a6-45d4-a04d27931a74.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=fa3931ca7f66c09ee6d33458f7b1f7ff" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/0f00bc1d-9424-84a6-45d4-a04d27931a74.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F0f00bc1d-9424-84a6-45d4-a04d27931a74.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c5169f09c3c9c7cb5181c23ba7817695 1x" loading="lazy"></a></p>

<p>同僚Ｘ「おい、校閲の変更履歴が記録されまくって、グダグダになってしまっているぞ。」<br>
ワイ　「ええっ、エクスさん、ワード文書の変更履歴の記録はオフにしていただかないと。」<br>
同僚Ｘ「なんとかならんかなあ、他人から回されてきたワード原稿とかだと、変更履歴の記録がオンされているか否かなんて、<br>
　　　　ワードの校閲リボンから、「変更履歴の記録」をクリックせんとわからんしなあ。」<br>
ワイ　「そ、そうですねえ。」<br>
同僚Ｘ「それに、これっていつ始まって、いつ終わったかもわからんなあ。中断もできんし。」<br>
ワイ　「短時間やからええと思ってましたが、気になるもんですねえ。」<br>
同僚Ｘ「ほら、画面上に横棒が表示されて、それが１００％になったときに終わるやつをつけてや。<br>
　　　　途中で止めるためのボタンもつけてな。」<br>
ワイ　「は、はい。・・・（ブログレスバーとキャンセルボタンのことだな、）」</p>

<p>同僚Ｘ「僕の持っている明細書原稿を全部掛けてみようか。」<br>
　　　　・・・<br>
同僚Ｘ「ワイ君、なんか、この明細書原稿、ぜんぜん段落番号の削除が効かないけど。」<br>
ワイ　「あ、あれっ変ですねえ。」<br>
<a href="https://camo.qiitausercontent.com/d074d0358420587f59f70890dac209839b0c1dcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f61303036316633622d393064382d666235352d623636652d3033323263633436623362642e706e67" target="_blank" rel="nofollow noopener"><img width="614" alt="改行.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa0061f3b-90d8-fb55-b66e-0322cc46b3bd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6866741cba60fa6ffd0b4e450f0fe11a" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/a0061f3b-90d8-fb55-b66e-0322cc46b3bd.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa0061f3b-90d8-fb55-b66e-0322cc46b3bd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c743df215c3e300827bd851d2cfe1b21 1x" loading="lazy"></a></p>

<p>ワイ　「この明細書原稿の改行マーク、なんかおかしくないですか。」</p>

<p>　　　　・・・・</p>

<p>ワイ　「エクスさん、わかりましたよ。この明細書原稿って、Enterじゃなくて、Shift+Enterで行の区切りが入力されているんですよ。」<br>
同僚Ｘ「ふーん、なんか知らんけど、どういう風に入力してもちゃんと段落番号を付けるようにしてな。」<br>
ワイ　「・・・（Enterで入力されるのが ^pで、Shift+Enterで入力されるのが ^l か、全部 ^pに置換するか・・・）」</p>

<h2>
<span id="改良版" class="fragment"></span><a href="#%E6%94%B9%E8%89%AF%E7%89%88"><i class="fa fa-link"></i></a>改良版</h2>

<p>ワイ　「はい、エクスさん、改良しましたので使ってみてください。」<br>
同僚Ｘ「このあいだのクライアントさんのチェック済原稿を掛けてみよう。<br>
　　　　ちゃんと、「校閲の変更履歴の記録をオフしてください。」で出るなあ。」<br>
ワイ　「はい、校閲の変更履歴の記録かオンのときには、処理せずに警告するようにしたんですよ。」<br>
同僚Ｘ「校閲の変更記録をオフして、段落番号振直ボタンをクリック、と。<br>
　　　　進捗を示す棒グラフと、キャンセルボタンも表示されたなあ。」<br>
ワイ　「はい」</p>

<p>同僚Ｘ「ぜんぜん段落番号を振ってくれなかった明細書原稿もチェック、と。<br>
　　　　おお、こんどはちゃんと段落番号を付けてくれるなあ。」<br>
ワイ　「はい。対応しました。<br>
　　　　（こっそりと ^l を ^p に書き換えるのでＯＫだったか。）</p>

<p>ブラック所長「おお、ワイ君やないか。ほう、段落番号を入れてくれるWORDアドインか。」<br>
ワイ　「は、はい。」<br>
ブラック所長「なかなかええ感じに振られてるなあ。<br>
　　　　　　　このあいだ苦言を呈させてもろた原稿を掛けてみよっか。」<br>
ワイ　「はい」</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">ワイ君の明細書原稿</span></div>
<div class="highlight"><pre class="with-code"><code>【書類名】明細書
【発明の名称】物質エネルギ変換装置
【技術分野】
　【０００１】
　本発明は、物質をエネルギに変換する物質エネルギ変換装置である。
【背景技術】
　【０００２】
　従来、エネルギを得るには、化学反応または核反応を用いる必要があり、効率が悪かっ
た。
　非特許文献１には、反物質が物質と合わさって厖大なエネルギを発することが記載され
ている。
【先行技術文献】
　【非特許文献】
　【０００３】
　　【非特許文献１】ダン・ブラウン、"天使と悪魔”、２０００年初版
【発明の概要】
【発明が解決しようとする課題】
　【０００４】
　非特許文献１では、反物質を生成する必要があった。反物質の生成には、この反物質が
物質と合わさってエネルギを生成する以上のエネルギが必要であった。
　そこで、本発明は、物質をそのままエネルギに変換することを課題とする。
【課題を解決するための手段】
　【０００５】
　本発明の物質エネルギ変換装置は、水素を入力する水素入力手段と、当該水素を吸収す
る希土類金属結晶部と、当該希土類金属結晶部の所定の結晶方向に磁場を与える磁場形成
部とを有する。
【発明の効果】
　【０００６】
　本発明によれば、高い効率で物質をエネルギーに変換することができる。
【図面の簡単な説明】
　【０００７】
　【図１】本実施形態の物質エネルギ変換装置の構成図である。
　【図２】物質エネルギ変換装置の動作を説明する図である。
【発明を実施するための形態】
　【０００８】
　図１は、本実施形態の物質エネルギ変換装置１の構成図である。
　物質エネルギ変換装置１は、水素入力部１１と、希土類金属結晶１２と、磁場形成部１
３と、これらを包み込む中性子遮蔽部１４とを備える。この物質エネルギ変換装置１は、
水素原子を直接にエネルギに変換するものである。
　【０００９】
　水素入力部１１は、・・・・・・・・・・・・・・・・・・・・・・・・である。
　希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・・・であり、水
素入力部１１から入力された水素を吸収して・・・・・・・・・・・・・・・・・・・・・
・・・する。この希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・
・することにより、・・・・・・・・・する。
　【００１０】
　磁場形成部１３は、・・・・・・・・・・・・・・・・・であり、希土類金属結晶の１１
１方向の磁場を形成して、・・・・・・・・・、・・・・・・・・・・・・・・・・・・・
する。これにより、希土類金属結晶１２に吸収されている水素原子は、・・・・・・・・・
・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・する。
　【００１１】
　中性子遮蔽部１４は、水素原子のエネルギ化に伴い、希土類金属結晶１２から出射される
中性子線を遮蔽する。この中性子遮蔽部１４は、例えば・・・・・・・・・・・・・・・・
・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・
・・・であり、・・・・・・・・・する。
　【００１２】
　図２は、物質エネルギ変換装置の動作を説明する図である。
　水素は、水素入力部１１によって高圧（例えば、１０万メガパスカル）に圧縮されて、希
土類金属結晶１２が位置する炉内に導かれる。希土類金属結晶１２の水素吸収能力により、
水素は、希土類金属結晶１２に吸収される。そして、磁場形成部１３は、・・・・・・・・
・・・・・・・・・・・・・。これにより、希土類金属結晶１２からエネルギが放出され、
中性子線が出射される。
　【００１３】
　物質エネルギ変換装置１が変換するエネルギEは、以下の式（１）によって示される。
但し、Mは水素の質量である。Cは光速である。
　【数１】
    E=MC^2・・・（１）

　【００１４】
　よって、本実施形態の物質エネルギ変換装置１によれば、反物質を生成することなく、
物質を直接的にエネルギに変換することができる。
【符号の説明】
　【００１５】
１　物質エネルギ変換装置
１１　水素入力部
１２　希土類金属結晶
１３　磁場形成部
１４　中性子遮蔽部
</code></pre></div>
</div>

<p>ブラック所長「「【先行技術文献】」の次には段落番号を入れてないな。」<br>
ワイ　「段落番号を入れていい項目と入れてはならない項目は、ちゃんと区別してます。」</p>

<p>ブラック所長「程よい感じで段落番号が入ってるな。」<br>
ワイ　　「はい。１行４０文字で書いたとき、およそ３～５行で１つの段落番号が入るようにしたんです。」</p>

<p>ブラック所長「【数１】と数式の次にも入ってるな。」<br>
ワイ　「ワードの数式・画像・表をちゃんと判定してます。」<br>
　　　　（・・・テキストで数式を書かれたらアウトやけどな。）</p>

<p>ブラック所長「実施形態の『図１は、・・。』、『図２は、・・。』の直前に段落番号が入ってるな。」<br>
ワイ　「はい、『図（番号）は、・・・。』を検知して、その直前に段落番号を入れるようにしてます。」</p>

<p>ブラック所長「これなら段落番号は大丈夫や。さて、次は中身の問題やが・・・。」<br>
ワイ　ギクッ・・・　　</p>

<p>（次回に続く・・・かもしれない。）</p>

<p>※ワイ記法(C)無職やめ太郎さん</p>

<h1>
<span id="仕様説明" class="fragment"></span><a href="#%E4%BB%95%E6%A7%98%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>仕様説明</h1>

<p>これは、フリーソフト「段落ジェネレータ」の紹介記事です。</p>

<p>GitHub のURLはこちらです。Visual Studio 2019 でコンパイルしてください。<br>
<a href="https://github.com/k-ayaki/danrakuG01" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/k-ayaki/danrakuG01</a></p>

<p>OSDN のURLはこちらです。インストーラがアップロードされています。<br>
<a href="https://osdn.net/projects/danrakug/" class="autolink" rel="nofollow noopener" target="_blank">https://osdn.net/projects/danrakug/</a></p>

<h1>
<span id="コードとプロジェクトの説明" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>コードとプロジェクトの説明</h1>

<p>WORD のVSTOアドインについて書かれている文献は少ないので、この記事が少しでも開発の助けになればとおもいます。試しに、amazon で "VSTO" と入力して書籍を検索してみてください。"VBA"の書籍と比べて、その少なさに愕然とします。</p>

<p>　なお、VSTO(Visual Studio Tools for Office)とは、オフィスソリューションの一つであり、OfficeアプリケーションのアドインをC#やVB.netで記述できます。VBA(Visual Basic for Application)と比べると、Visual Studioが必須である点が、やや面倒くさいです。また、VSTOのアドインは、Officeのバージョンによっては互換性が問題になる場合があります。しかし、Officeのアドインを作成して公開し、かつ、そのソースコードを秘匿したい場合には、VSTOを選択肢とすることが必要とおもいます。</p>

<h2>
<span id="参考文献" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><i class="fa fa-link"></i></a>参考文献</h2>

<p>オフィスソリューション開発の概要 (VSTO)<br>
<a href="https://docs.microsoft.com/ja-jp/visualstudio/vsto/office-solutions-development-overview-vsto?view=vs-2019" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/visualstudio/vsto/office-solutions-development-overview-vsto?view=vs-2019</a></p>

<h2>
<span id="guiの説明" class="fragment"></span><a href="#gui%E3%81%AE%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>GUIの説明</h2>

<p>GUIは、WORDのリボンインタフェースとして実装いたしました。</p>

<p>リボン全体の属性は以下です。<br>
<a href="https://camo.qiitausercontent.com/cd39c4e72cf8672669752b0ffd734d8db2737c28/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f63373833333534652d623664642d303463342d643530332d6634346232383461306338332e706e67" target="_blank" rel="nofollow noopener"><img width="764" alt="2020-06-28.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fc783354e-b6dd-04c4-d503-f44b284a0c83.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=61629ae08907a178beae32cf5d82cb46" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/c783354e-b6dd-04c4-d503-f44b284a0c83.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fc783354e-b6dd-04c4-d503-f44b284a0c83.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bca0f024fd8b081ff655c1d99f50abdf 1x" loading="lazy"></a></p>

<p>ボタンのグループの名前には「段落生成」と名付けました。<br>
<a href="https://camo.qiitausercontent.com/5b1584930f050760a8b54c0322ff305b45530d8d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f61333361333739332d623730342d643438382d643366322d6462386234633335646537652e706e67" target="_blank" rel="nofollow noopener"><img width="767" alt="2020-06-28 (4).png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa33a3793-b704-d488-d3f2-db8b4c35de7e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=543935b49569429d82625cf0d63db63c" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/a33a3793-b704-d488-d3f2-db8b4c35de7e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa33a3793-b704-d488-d3f2-db8b4c35de7e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fe381db176a7868ddf1c87b994fc4e04 1x" loading="lazy"></a></p>

<p>　段落付与ボタンは、縦横64ピクセルのアイコンを付けました。“【０００１】”の段落番号を黒文字で入れています。なお、自前でアイコンを生成する代わりに、Officeに組み込まれているアイコンを使うこともできます。<br>
　この段落付与ボタンをクリックしたとき、Ribbon1.cs の AddDanraku_Click関数が呼び出されます。<br>
　これにより、段落が付与されたのち、段落番号が追番に振り直されます。</p>

<p><a href="https://camo.qiitausercontent.com/df223a3b9bcf1c04c59063cd58749436711349bf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f33326566316634652d643933612d616635632d363732312d3566613735333031633565642e706e67" target="_blank" rel="nofollow noopener"><img width="767" alt="2020-06-28 (1).png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F32ef1f4e-d93a-af5c-6721-5fa75301c5ed.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=26d0bb5e2e660b8a1f9665a79b938711" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/32ef1f4e-d93a-af5c-6721-5fa75301c5ed.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F32ef1f4e-d93a-af5c-6721-5fa75301c5ed.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=04f28674532e33557c03aa1da191be5d 1x" loading="lazy"></a></p>

<p>　段落の振直ボタンは、縦横64ピクセルのアイコンを付けました。“【０００１】”と”【０００２】”の段落番号がオーバーラップするよう青文字で入れています。振直ボタンをクリックしたとき、Ribbon1.cs の  RenumDanraku_Click関数が呼び出されます。<br>
　これにより、段落番号が追番に振り直されます。</p>

<p><a href="https://camo.qiitausercontent.com/589f7bec819e0ebc84b32404e7694b341503fc09/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f65323737366335612d303835622d653865362d633931612d3161396438353965616461612e706e67" target="_blank" rel="nofollow noopener"><img width="767" alt="2020-06-28 (2).png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fe2776c5a-085b-e8e6-c91a-1a9d859eadaa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=17bf6dd28618fdbbce19f87c53d44501" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/e2776c5a-085b-e8e6-c91a-1a9d859eadaa.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fe2776c5a-085b-e8e6-c91a-1a9d859eadaa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=52d9ee26388ad66974cca853ce6061c3 1x" loading="lazy"></a></p>

<p>　段落の削除ボタンは、縦横64ピクセルのアイコンを付けました。“【０００１】”と取消線とを赤で入れています。削除ボタンをクリックしたとき、Ribbon1.cs の  DelDanraku_Click関数が呼び出されます。<br>
　これにより、段落が削除されます。</p>

<p><a href="https://camo.qiitausercontent.com/0a8f37b9600abf8f24d83fc16ef367d16fa5403a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f35323638616535632d626239372d656263662d626230312d6538393132643034363966312e706e67" target="_blank" rel="nofollow noopener"><img width="767" alt="2020-06-28 (3).png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F5268ae5c-bb97-ebcf-bb01-e8912d0469f1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=915d49ec69e1decc601e41d0ea5df38b" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/5268ae5c-bb97-ebcf-bb01-e8912d0469f1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F5268ae5c-bb97-ebcf-bb01-e8912d0469f1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f53327d93fc803095f8c5fdf607724a1 1x" loading="lazy"></a><br>
　</p>

<h1>
<span id="コード説明" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>コード説明</h1>

<h2>
<span id="段落の削除" class="fragment"></span><a href="#%E6%AE%B5%E8%90%BD%E3%81%AE%E5%89%8A%E9%99%A4"><i class="fa fa-link"></i></a>段落の削除</h2>

<p>　一番簡単な段落削除から説明します。</p>

<p>　最初に、WORDの校閲の変更履歴の記録がオンになっているか否かを判定します。変更履歴の記録がオンになっているときにアドインが文書を書き換えると、その書き換えが変更履歴として記録されてしまいます。よっで、これを防ぐために、変更履歴の記録がオンになっているときには、処理を実行せずに終了します。<br>
　doc.TrackRevisionsがtrue のとき、変更履歴の記録がオンです。このときには、メッセージボックスを表示したのち、処理を終了します。</p>

<p>　次に、文書の垂直タブを改行に変換します。WORDのパラグラフは、文章の改行で区切られています。<br>
　WORDの文章が垂直タブで区切られていると、そこは文章の切れ目であり、かつ、文章が改行されているかのように見えますが、垂直タブの前後は同一のパラグラフです。<br>
　よって、本アドインでは文章の垂直タブを改行に変換して、文章の切れ目とパラグラフの区切りを一致させています。</p>

<p>　そして、プログレスパーの表示用ダイアログと、プログレスバーのワーカースレッドを起動します。なお ProgressDialog クラスは、プログレスバーの表示用ダイアログが終了すると、その結果に応じて、キャンセル、エラー、成功の何れかに分岐します。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">DelDanraku_Click（段落削除ボタンのクリック）</span></div>
<div class="highlight"><pre class="with-code"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">DelDanraku_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RibbonControlEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">danrakuG01</span><span class="p">.</span><span class="n">Globals</span><span class="p">.</span><span class="n">ThisAddIn</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveDocument</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">myPatDoc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">patDoc</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">TrackRevisions</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"変更履歴の記録をオフしてくたさい"</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">myPatDoc</span><span class="p">.</span><span class="err">垂直タブを改行に</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
            <span class="n">ProgressDialog</span> <span class="n">pd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ProgressDialog</span><span class="p">(</span><span class="s">"段落の削除"</span><span class="p">,</span>
                <span class="k">new</span> <span class="nf">DoWorkEventHandler</span><span class="p">(</span><span class="n">ProgressDialog_Del_DoWork</span><span class="p">),</span>
                <span class="m">16</span><span class="p">);</span>
            <span class="c1">//進行状況ダイアログを表示する</span>
            <span class="n">DialogResult</span> <span class="n">result</span> <span class="p">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">ShowDialog</span><span class="p">();</span>
            <span class="c1">//結果を取得する</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"キャンセルされました"</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Abort</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//エラー情報を取得する</span>
                <span class="n">Exception</span> <span class="n">ex</span> <span class="p">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Error</span><span class="p">;</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"エラー: "</span> <span class="p">+</span> <span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//結果を取得する</span>
                <span class="kt">int</span> <span class="n">stopTime</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pd</span><span class="p">.</span><span class="n">Result</span><span class="p">;</span>
                <span class="c1">//MessageBox.Show("成功しました: " + stopTime.ToString());</span>
            <span class="p">}</span>
            <span class="c1">//後始末</span>
            <span class="n">pd</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="垂直タブを改行に" class="fragment"></span><a href="#%E5%9E%82%E7%9B%B4%E3%82%BF%E3%83%96%E3%82%92%E6%94%B9%E8%A1%8C%E3%81%AB"><i class="fa fa-link"></i></a>垂直タブを改行に</h2>

<p>　垂直タブを改行に変換するコードは、マイクロソフトのVSTOのサンプルコードとほぼ同一です。</p>

<p>　プログラムによって文書内のテキストを検索および置換する<br>
<a href="https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-search-for-and-replace-text-in-documents?view=vs-2019" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-search-for-and-replace-text-in-documents?view=vs-2019</a></p>

<p>プログラムによって検索後に選択を復元する<br>
<a href="https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-restore-selections-after-searches?view=vs-2019" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-restore-selections-after-searches?view=vs-2019</a></p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">垂直タブを改行に</span></div>
<div class="highlight"><pre class="with-code"><code>        <span class="c1">// プログラムによって文書内のテキストを検索および置換する</span>
        <span class="c1">// https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-search-for-and-replace-text-in-documents?view=vs-2019</span>
        <span class="c1">// プログラムによって検索後に選択を復元する</span>
        <span class="c1">//https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-restore-selections-after-searches?view=vs-2019</span>
        <span class="k">public</span> <span class="k">void</span> <span class="err">垂直タブを改行に</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">object</span> <span class="n">missing</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

            <span class="n">Range</span> <span class="n">rangeSave</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Selection</span><span class="p">.</span><span class="n">Range</span><span class="p">;</span>
            <span class="n">doc</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Selection</span><span class="p">.</span><span class="nf">WholeStory</span><span class="p">();</span>
            <span class="n">Find</span> <span class="n">findObject</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Selection</span><span class="p">.</span><span class="n">Find</span><span class="p">;</span>
            <span class="n">findObject</span><span class="p">.</span><span class="nf">ClearFormatting</span><span class="p">();</span>
            <span class="n">findObject</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"^l"</span><span class="p">;</span>
            <span class="n">findObject</span><span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="nf">ClearFormatting</span><span class="p">();</span>
            <span class="n">findObject</span><span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"^p"</span><span class="p">;</span>
            <span class="n">findObject</span><span class="p">.</span><span class="n">MatchFuzzy</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="n">findObject</span><span class="p">.</span><span class="n">Forward</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="kt">object</span> <span class="n">findtext</span> <span class="p">=</span> <span class="s">"^l"</span><span class="p">;</span>
            <span class="kt">object</span> <span class="n">replacetext</span> <span class="p">=</span> <span class="s">"^p"</span><span class="p">;</span>
            <span class="kt">object</span> <span class="n">replaceAll</span> <span class="p">=</span> <span class="n">WdReplace</span><span class="p">.</span><span class="n">wdReplaceAll</span><span class="p">;</span>
            <span class="n">findObject</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="k">ref</span> <span class="n">findtext</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span>
                <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">replacetext</span><span class="p">,</span>
                <span class="k">ref</span> <span class="n">replaceAll</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">,</span> <span class="k">ref</span> <span class="n">missing</span><span class="p">);</span>
            <span class="n">rangeSave</span><span class="p">.</span><span class="nf">Select</span><span class="p">();</span>
         <span class="p">}</span>
</code></pre></div>
</div>

<p>　段落削除に係るプログレスバーのワーカースレッドです。<br>
　このスレッド内では、WORDの文書のうち、書類名の範囲が“明細書”であるものを検索します。<br>
　すなわち、“【書類名】明細書”が記載されたパラグラフから、次の“【書類名】”が記載されたパラグラフまたは文書の末尾までの範囲を取得します。<br>
　そして、段落番号が記載されているパラグラフを順次検索すると、そのパラグラフを削除します。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">ProgressDialog_Del_DoWork（段落削除のプログレスバーのワーカースレッド）</span></div>
<div class="highlight"><pre class="with-code"><code>        <span class="c1">// 段落の削除</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">ProgressDialog_Del_DoWork</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">DoWorkEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">BackgroundWorker</span> <span class="n">bw</span> <span class="p">=</span> <span class="p">(</span><span class="n">BackgroundWorker</span><span class="p">)</span><span class="n">sender</span><span class="p">;</span>

            <span class="c1">//パラメータを取得する</span>
            <span class="kt">int</span> <span class="n">stopTime</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">Argument</span><span class="p">;</span>

            <span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">danrakuG01</span><span class="p">.</span><span class="n">Globals</span><span class="p">.</span><span class="n">ThisAddIn</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveDocument</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">myPatDoc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">patDoc</span><span class="p">();</span>
            <span class="n">Range</span> <span class="n">rng</span> <span class="p">=</span> <span class="n">myPatDoc</span><span class="p">.</span><span class="err">書類名の範囲</span><span class="p">(</span><span class="s">"明細書"</span><span class="p">,</span> <span class="n">doc</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">rng</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"明細書が記載されていません。"</span><span class="p">,</span> <span class="s">"警告"</span><span class="p">);</span>
                <span class="n">e</span><span class="p">.</span><span class="n">Result</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kt">long</span> <span class="n">endpos</span> <span class="p">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">End</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">counter</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="n">rng</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="n">MatchWildcards</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

            <span class="kt">int</span> <span class="n">lastTick</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">TickCount</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">currTick</span><span class="p">;</span>
            <span class="n">bw</span><span class="p">.</span><span class="nf">ReportProgress</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">"% 終了しました"</span><span class="p">);</span>

            <span class="k">while</span> <span class="p">(</span><span class="n">rng</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="s">"【[０-９]@】"</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">counter</span><span class="p">++;</span>

                <span class="n">rng</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
                <span class="n">rng</span><span class="p">.</span><span class="nf">SetRange</span><span class="p">(</span><span class="n">rng</span><span class="p">.</span><span class="n">End</span><span class="p">,</span> <span class="n">rng</span><span class="p">.</span><span class="n">End</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">myPatDoc</span><span class="p">.</span><span class="err">パラグラフが空白か判定</span><span class="p">(</span><span class="n">rng</span><span class="p">.</span><span class="n">Paragraphs</span><span class="p">[</span><span class="m">1</span><span class="p">]))</span>
                <span class="p">{</span>
                    <span class="n">rng</span><span class="p">.</span><span class="n">Paragraphs</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">Range</span><span class="p">.</span><span class="nf">Delete</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="c1">//キャンセルされたか調べる</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bw</span><span class="p">.</span><span class="n">CancellationPending</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">//キャンセルされたとき</span>
                    <span class="n">e</span><span class="p">.</span><span class="n">Cancel</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">currTick</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">TickCount</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">currTick</span> <span class="p">-</span> <span class="n">lastTick</span> <span class="p">&gt;</span> <span class="m">1000</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">//指定された時間待機する</span>
                    <span class="c1">//System.Threading.Thread.Sleep(stopTime);</span>

                    <span class="c1">//ProgressChangedイベントハンドラを呼び出し、</span>
                    <span class="c1">//コントロールの表示を変更する</span>
                    <span class="n">i</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">rng</span><span class="p">.</span><span class="n">End</span> <span class="p">*</span> <span class="m">100</span> <span class="p">/</span> <span class="n">endpos</span><span class="p">);</span>
                    <span class="n">bw</span><span class="p">.</span><span class="nf">ReportProgress</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">"% 終了しました"</span><span class="p">);</span>
                    <span class="n">lastTick</span> <span class="p">=</span> <span class="n">currTick</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">i</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>
            <span class="n">bw</span><span class="p">.</span><span class="nf">ReportProgress</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">"% 終了しました"</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">500</span><span class="p">);</span>
            <span class="c1">//結果を設定する</span>
            <span class="n">e</span><span class="p">.</span><span class="n">Result</span> <span class="p">=</span> <span class="n">counter</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<p>　プログレスダイアログは、ProgressDialog.cs に記載された ProgressDialogクラスによって表示されます。このクラスは、BackgroundWorkerクラスを使用しており、以下のサンプルコードを参考にしています。</p>

<p>参考文献：<br>
BackgroundWorkerクラスを使用して進行状況ダイアログを作成する<br>
<a href="https://dobon.net/vb/dotnet/programing/progressdialogbw.html" class="autolink" rel="nofollow noopener" target="_blank">https://dobon.net/vb/dotnet/programing/progressdialogbw.html</a></p>

<p>　“書類名の範囲”メソッドは、docname で記載された名前に一致する書類名の範囲を返すものです。<br>
　こういう風に、メソッド名を日本語で書くと嫌がる方がおられますが、自分としては日本人ならば可読性が上がるからよいとおもって書いています。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">書類名の範囲</span></div>
<div class="highlight"><pre class="with-code"><code>        <span class="k">public</span> <span class="n">Range</span> <span class="err">書類名の範囲</span><span class="p">(</span>
            <span class="kt">string</span> <span class="n">docname</span><span class="p">,</span>
            <span class="n">Document</span> <span class="n">doc</span><span class="p">,</span>
            <span class="kt">long</span> <span class="n">spos</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
            <span class="kt">long</span> <span class="n">epos</span> <span class="p">=</span> <span class="p">-</span><span class="m">1</span>
            <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Range</span> <span class="n">rng</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">epos</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">epos</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">End</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">rng</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="err">書類名の範囲を選択</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="k">ref</span> <span class="n">rng</span><span class="p">,</span> <span class="n">spos</span><span class="p">,</span> <span class="n">epos</span><span class="p">)</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rng</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kt">string</span> <span class="n">para1</span> <span class="p">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">Paragraphs</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">Range</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">para1</span><span class="p">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="n">docname</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="err">領域始端のトリム</span><span class="p">(</span><span class="k">ref</span> <span class="n">rng</span><span class="p">);</span>
                    <span class="err">領域終端のトリム</span><span class="p">(</span><span class="k">ref</span> <span class="n">rng</span><span class="p">);</span>
                    <span class="err">領域拡張</span><span class="p">(</span><span class="k">ref</span> <span class="n">rng</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">spos</span> <span class="p">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">End</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">rng</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<p>　書類名の範囲を選択メソッドは、“【書類名】・・・・” から次の “【書類名】・・・・” までを選択するものです。<br>
　領域始端のトリムメソッドとは、始端から空白・改行などを取り去るものです。これにより領域の始端を調整します。<br>
　領域終端のトリムメソッドとは、終端から空白・改行などを取り去るものです。これにより領域の終端を調整します。<br>
　領域拡張メソッドは、トリムした始端・終端を、WORD文書のパラグラフ単位で拡張します。</p>

<h2>
<span id="段落の生成" class="fragment"></span><a href="#%E6%AE%B5%E8%90%BD%E3%81%AE%E7%94%9F%E6%88%90"><i class="fa fa-link"></i></a>段落の生成</h2>

<p>段落の生成を説明します。</p>

<p>　最初に、WORDの校閲の変更履歴の記録がオンになっているか否かを判定します。変更履歴の記録がオンになっているときにアドインが文書を書き換えると、その書き換えが変更履歴として記録されてしまいます。よっで、これを防ぐために、変更履歴の記録がオンになっているときには、処理を実行せずに終了します。<br>
　doc.TrackRevisionsがtrue のとき、変更履歴の記録がオンです。このときには、メッセージボックスを表示したのち、処理を終了します。<br>
　次に、文書の垂直タブを改行に変換します。</p>

<p>　そして、段落生成のプログレスパーの表示用ダイアログと、段落生成のプログレスバーのワーカースレッドを起動します。<br>
　プログレスバーの表示用ダイアログが終了すると、その結果に応じて、キャンセル、エラー、成功の何れかに分岐します。</p>

<p>　次に、段落番号の振り直しのプログレスパーの表示用ダイアログと、段落番号の振り直しのプログレスバーのワーカースレッドを起動します。<br>
　これは、既に段落番号が付与されているとき、新たに段落番号を追加すると、段落番号の振り直しが必要になるためです。<br>
　プログレスバーの表示用ダイアログが終了すると、その結果に応じて、キャンセル、エラー、成功の何れかに分岐します。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">AddDanraku_Click（段落生成ボタンのクリック）</span></div>
<div class="highlight"><pre class="with-code"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">AddDanraku_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RibbonControlEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">danrakuG01</span><span class="p">.</span><span class="n">Globals</span><span class="p">.</span><span class="n">ThisAddIn</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveDocument</span><span class="p">;</span>

            <span class="kt">var</span> <span class="n">myPatDoc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">patDoc</span><span class="p">();</span>
            <span class="c1">//myPatDoc.G_段落番号付与(doc);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">TrackRevisions</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"変更履歴の記録をオフしてくたさい"</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">myPatDoc</span><span class="p">.</span><span class="err">垂直タブを改行に</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
            <span class="c1">//ProgressDialogオブジェクトを作成する</span>
            <span class="n">ProgressDialog</span> <span class="n">pd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ProgressDialog</span><span class="p">(</span><span class="s">"段落番号の付与"</span><span class="p">,</span>
                <span class="k">new</span> <span class="nf">DoWorkEventHandler</span><span class="p">(</span><span class="n">ProgressDialog_Add_DoWork</span><span class="p">),</span>
                <span class="m">16</span><span class="p">);</span>
            <span class="c1">//進行状況ダイアログを表示する</span>
            <span class="n">DialogResult</span> <span class="n">result</span> <span class="p">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">ShowDialog</span><span class="p">();</span>
            <span class="c1">//結果を取得する</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"キャンセルされました"</span><span class="p">);</span>
                <span class="c1">//後始末</span>
                <span class="n">pd</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Abort</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//エラー情報を取得する</span>
                <span class="n">Exception</span> <span class="n">ex</span> <span class="p">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Error</span><span class="p">;</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"エラー: "</span> <span class="p">+</span> <span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
                <span class="c1">//後始末</span>
                <span class="n">pd</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//結果を取得する</span>
                <span class="kt">int</span> <span class="n">stopTime</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pd</span><span class="p">.</span><span class="n">Result</span><span class="p">;</span>
                <span class="c1">//MessageBox.Show("成功しました: " + stopTime.ToString());</span>
            <span class="p">}</span>
            <span class="c1">//後始末</span>
            <span class="n">pd</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>

            <span class="c1">//ProgressDialogオブジェクトを作成する</span>
            <span class="n">pd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ProgressDialog</span><span class="p">(</span><span class="s">"段落番号の振り直し"</span><span class="p">,</span>
                <span class="k">new</span> <span class="nf">DoWorkEventHandler</span><span class="p">(</span><span class="n">ProgressDialog_Renum_DoWork</span><span class="p">),</span>
                <span class="m">16</span><span class="p">);</span>
            <span class="c1">//進行状況ダイアログを表示する</span>
            <span class="n">result</span> <span class="p">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">ShowDialog</span><span class="p">();</span>
            <span class="c1">//結果を取得する</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"キャンセルされました"</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Abort</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//エラー情報を取得する</span>
                <span class="n">Exception</span> <span class="n">ex</span> <span class="p">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Error</span><span class="p">;</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"エラー: "</span> <span class="p">+</span> <span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//結果を取得する</span>
                <span class="kt">int</span> <span class="n">stopTime</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pd</span><span class="p">.</span><span class="n">Result</span><span class="p">;</span>
                <span class="c1">//MessageBox.Show("成功しました: " + stopTime.ToString());</span>
            <span class="p">}</span>
            <span class="c1">//後始末</span>
            <span class="n">pd</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<p>　段落生成に係るプログレスバーのワーカースレッドでは、WORDの文書のうち、書類名の範囲が“明細書”であるものを検索します。すなわち、“【書類名】明細書”が記載されたパラグラフから、次の“【書類名】”が記載されたパラグラフの直前のパラグラフまたは文書の末尾までの範囲を取得します。<br>
　そして、範囲内のパラグラフを順次検索すると、そのパラグラフの直後または直前が段落番号の生成対象であるか否かを判定します。段落番号の生成対象であると判定したならば、そのパラグラフの直後または直前に、段落番号が記載されたパラグラフを挿入します。</p>

<p>　“項目の判定”メソッドとは、現在のパラグラフに隅付括弧【】があるか否かを判定するものです。<br>
　そして、“パラグラフが段落番号付与対象項目か判定”メソッドがtrueならば、この直後に段落番号のパラグラフを挿入します。そして、現在のパラグラフが”【符号の説明】”ならば、処理を終了します。<br>
　<br>
 次に、”パラグラフが数化表項目か判定”メソッドにより、現在のパラグラフが数式、化学式、表の項目であるか否かを判定します。現在のパラグラフが数式、化学式、表の項目ならば、直前に文章が記載されているか否かを判定し、その直前に段落番号が記載されたパラグラフを挿入します。</p>

<p>　次に、”パラグラフが段落番号付与非対象項目か判定”メソッドがtrueであり、かつ“パラグラフが不正な段落番号か判定”メソッドがtrueならば、不正な段落番号が付与されたパラグラフとして、このパラグラフを削除します。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">ProgressDialog_Add_DoWork（段落生成のプログレスバーのワーカースレッドの要部）</span></div>
<div class="highlight"><pre class="with-code"><code>            <span class="kt">int</span> <span class="n">counter</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">lastTick</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">TickCount</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">currTick</span><span class="p">;</span>
            <span class="n">bw</span><span class="p">.</span><span class="nf">ReportProgress</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">"% 終了しました"</span><span class="p">);</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="n">Paragraph</span> <span class="n">paraCurr</span> <span class="k">in</span> <span class="n">rng</span><span class="p">.</span><span class="n">Paragraphs</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">tmpdebug</span> <span class="p">=</span> <span class="n">paraCurr</span><span class="p">.</span><span class="n">Range</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">myPatDoc</span><span class="p">.</span><span class="err">項目の判定</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">myPatDoc</span><span class="p">.</span><span class="err">パラグラフが段落番号付与対象項目か判定</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">Range</span> <span class="n">rng2</span> <span class="p">=</span> <span class="n">myPatDoc</span><span class="p">.</span><span class="err">直後への段落番号の挿入</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">paraCurr</span><span class="p">.</span><span class="n">Range</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="s">"【符号の説明】"</span><span class="p">)</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">break</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">myPatDoc</span><span class="p">.</span><span class="err">パラグラフが数化表項目か判定</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">Paragraph</span> <span class="n">paraPrev</span> <span class="p">=</span> <span class="n">myPatDoc</span><span class="p">.</span><span class="err">テキスト記載パラグラフ取得</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">myPatDoc</span><span class="p">.</span><span class="err">パラグラフが数化表項目か判定</span><span class="p">(</span><span class="n">paraPrev</span><span class="p">))</span>
                        <span class="p">{</span>
                            <span class="n">myPatDoc</span><span class="p">.</span><span class="err">直前への段落番号挿入</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="n">paraPrev</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">myPatDoc</span><span class="p">.</span><span class="err">パラグラフが段落番号付与非対象項目か判定</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">myPatDoc</span><span class="p">.</span><span class="err">パラグラフが不正な段落番号か判定</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">))</span>
                        <span class="p">{</span>
                            <span class="n">paraCurr</span><span class="p">.</span><span class="n">Range</span><span class="p">.</span><span class="nf">Delete</span><span class="p">();</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">else</span>
                    <span class="p">{</span>
                        <span class="n">Range</span> <span class="n">rng2</span> <span class="p">=</span> <span class="n">myPatDoc</span><span class="p">.</span><span class="err">直後への段落番号の挿入</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">myPatDoc</span><span class="p">.</span><span class="err">段落番号付与判定</span><span class="p">(</span><span class="n">paraCurr</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="n">counter</span><span class="p">++;</span>
                <span class="c1">//キャンセルされたか調べる</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bw</span><span class="p">.</span><span class="n">CancellationPending</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">//キャンセルされたとき</span>
                    <span class="n">e</span><span class="p">.</span><span class="n">Cancel</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="c1">//指定された時間待機する</span>
                <span class="c1">//System.Threading.Thread.Sleep(stopTime);</span>

                <span class="n">currTick</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">TickCount</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currTick</span> <span class="p">-</span> <span class="n">lastTick</span> <span class="p">&gt;</span> <span class="m">1000</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">//ProgressChangedイベントハンドラを呼び出し、</span>
                    <span class="c1">//コントロールの表示を変更する</span>
                    <span class="n">i</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">paraCurr</span><span class="p">.</span><span class="n">Range</span><span class="p">.</span><span class="n">End</span> <span class="p">*</span> <span class="m">100</span> <span class="p">/</span> <span class="n">rng</span><span class="p">.</span><span class="n">End</span><span class="p">);</span>
                    <span class="n">bw</span><span class="p">.</span><span class="nf">ReportProgress</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">"% 終了しました"</span><span class="p">);</span>
                    <span class="n">lastTick</span> <span class="p">=</span> <span class="n">currTick</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="段落の振り直し" class="fragment"></span><a href="#%E6%AE%B5%E8%90%BD%E3%81%AE%E6%8C%AF%E3%82%8A%E7%9B%B4%E3%81%97"><i class="fa fa-link"></i></a>段落の振り直し</h2>

<p>段落の振り直しは、追番として記載されていない段落番号を、追番に振り直すものです。具体的には、WORDの検索機能で、段落番号のパターンに当て嵌まる文字列を順次検索して、これを追番の段落番号の文字列で書き換えています。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">ProgressDialog_Renum_DoWork（段落の振り直しのプログレスバーのワーカースレッド）</span></div>
<div class="highlight"><pre class="with-code"><code>            <span class="n">rng</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="n">MatchWildcards</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">rng</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="s">"【[０-９]@】"</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">counter</span><span class="p">++;</span>
                <span class="n">rng</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">myPatDoc</span><span class="p">.</span><span class="err">段落番号文字列の生成</span><span class="p">(</span><span class="n">counter</span><span class="p">);</span>
                <span class="n">rng</span><span class="p">.</span><span class="nf">SetRange</span><span class="p">(</span><span class="n">rng</span><span class="p">.</span><span class="n">End</span><span class="p">,</span> <span class="n">rng</span><span class="p">.</span><span class="n">End</span><span class="p">);</span>

                <span class="c1">//キャンセルされたか調べる</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bw</span><span class="p">.</span><span class="n">CancellationPending</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">//キャンセルされたとき</span>
                    <span class="n">e</span><span class="p">.</span><span class="n">Cancel</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="c1">//指定された時間待機する</span>
                <span class="c1">//System.Threading.Thread.Sleep(16);</span>

                <span class="n">currTick</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">TickCount</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currTick</span> <span class="p">-</span> <span class="n">lastTick</span> <span class="p">&gt;</span> <span class="m">1000</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">//ProgressChangedイベントハンドラを呼び出し、</span>
                    <span class="c1">//コントロールの表示を変更する</span>
                    <span class="n">i</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">rng</span><span class="p">.</span><span class="n">End</span> <span class="p">*</span> <span class="m">100</span> <span class="p">/</span> <span class="n">endpos</span><span class="p">);</span>
                    <span class="n">bw</span><span class="p">.</span><span class="nf">ReportProgress</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">"% 終了しました"</span><span class="p">);</span>
                    <span class="n">lastTick</span> <span class="p">=</span> <span class="n">currTick</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="インストーラ" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%A9"><i class="fa fa-link"></i></a>インストーラ</h2>

<p>　最近のVSTOで特筆すべきは、インストーラの作成の簡単さだとおもいます。VisualStudio2019のビルドメニューから「・・・の発行」をクリックするだけですから。<br>
　なお、CDやUSBメモリからインストールする従来のインストーラに限られず、FTPサーバにアップロードすることも可能だそうですが、未検証です。</p>

<p>　出来上がったセットアップファイルをインターネットに置くと、ダウンロードの際にゾーン識別子が付きます。vstoのsetup.exeは、*.vstoと *.dll.manifest にゾーン識別子が着いているとエラー終了します。よって、install.bat によりゾーン識別子を削除して、setup.exeを起動させます。</p>

<div class="code-frame" data-lang="powershell">
<div class="code-lang"><span class="bold">install.bat</span></div>
<div class="highlight"><pre class="with-code"><code><span class="n">echo</span><span class="w"> </span><span class="o">.</span><span class="err">&gt;</span><span class="nx">danrakuG01.vsto:Zone.identifier</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="o">.</span><span class="err">&gt;</span><span class="s2">".\Application Files\danrakuG01_1_0_0_4\danrakuG01.dll.manifest:Zone.identifier"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="o">.</span><span class="err">&gt;</span><span class="s2">".\Application Files\danrakuG01_1_0_0_4\danrakuG01.vsto:Zone.identifier"</span><span class="w">
</span><span class="n">setup.exe</span><span class="w">
</span></code></pre></div>
</div>

<p>参考文献：<br>
チュートリアル: Word 用の最初の VSTO アドインの作成します。<br>
<a href="https://docs.microsoft.com/ja-jp/visualstudio/vsto/walkthrough-creating-your-first-vsto-add-in-for-word?view=vs-2019" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/visualstudio/vsto/walkthrough-creating-your-first-vsto-add-in-for-word?view=vs-2019</a><br>
【ワレコの講座】VS2017でEXCEL VSTOアドイン作成 – リボン編（1/10）<br>
<a href="https://www.wareko.jp/blog/creating-excel-vsto-addin-with-vs2017-ribbon-edition-1of10" class="autolink" rel="nofollow noopener" target="_blank">https://www.wareko.jp/blog/creating-excel-vsto-addin-with-vs2017-ribbon-edition-1of10</a><br>
【ワレコの講座】EXCEL VSTOアドインで選択セル情報取得（2/10）<br>
<a href="https://www.wareko.jp/blog/acquire-selected-cell-information-with-excel-vsto-add-in-2of10" class="autolink" rel="nofollow noopener" target="_blank">https://www.wareko.jp/blog/acquire-selected-cell-information-with-excel-vsto-add-in-2of10</a><br>
【ワレコの講座】EXCEL VSTOアドインを他のPCに配布する（3/10）<br>
<a href="https://www.wareko.jp/blog/publish-excel-vsto-add-in-to-another-pc-3of10" class="autolink" rel="nofollow noopener" target="_blank">https://www.wareko.jp/blog/publish-excel-vsto-add-in-to-another-pc-3of10</a><br>
ダウンロードしたファイルの「ブロック解除」をコマンドで<br>
<a href="https://qiita.com/gentaro/items/3beb65a8f2f89089a042" class="autolink" id="reference-3ba18b81b7e61e31beda">https://qiita.com/gentaro/items/3beb65a8f2f89089a042</a></p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fkenichiro_ayaki%2Fitems%2F73e4c19f9020d06b6076&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fkenichiro_ayaki%2Fitems%2F73e4c19f9020d06b6076&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/likers" class="css-1iupg5d">3</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">1</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/73e4c19f9020d06b6076/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kenichiro_ayaki/items/73e4c19f9020d06b6076.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-e5a25f0f-1462-4b8c-b76a-3d3909b9140a">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-a6f62dfe-9e4a-4494-b946-1d235267d974"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-a6f62dfe-9e4a-4494-b946-1d235267d974">{}</script>
      
<div id="LoginModal-react-component-fc724643-106d-4e70-825c-22ff9965a4d8"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-fc724643-106d-4e70-825c-22ff9965a4d8">{}</script>
      
<div id="StockModal-react-component-6da6456d-15d0-4fb3-85ae-2150e16c2700"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-6da6456d-15d0-4fb3-85ae-2150e16c2700">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;B0g1Dh5ZCxb4JSntFbUWjJrUBmnK6thCeuZH1Q3NnXw6ag2bC0615iXxhlZQt0KWHLp+qcR2PeWkv+5g7QVZTg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"ユースケース\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eユースケース\u003c/h1\u003e\n\n\u003cp\u003e或るブラック特許事務所の午後。\u003c/p\u003e\n\n\u003cp\u003eワイ「あー、今日もワード、明日もワードで明細書書きや。コロナ禍いうても出社してるんや。」\u003cbr\u003e\nワイ「かといってテレワークやと画面の反応が遅くてストレスやしなあ。」\u003cbr\u003e\nブラック所長「今日が納品締切日の、Ａ社さんへの特許明細書できたか？」\u003cbr\u003e\nワイ「はい、できました！」\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eワイ君の明細書原稿\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e【書類名】明細書\n【発明の名称】物質エネルギ変換装置\n【技術分野】\n　【０００１】\n　本発明は、物質をエネルギに変換する物質エネルギ変換装置である。\n【背景技術】\n　【０００２】\n　従来、エネルギを得るには、化学反応または核反応を用いる必要があり、効率が悪かっ\nた。\n　【０００３】\n　非特許文献１には、反物質が物質と合わさって厖大なエネルギを発することが記載され\nている。\n【先行技術文献】\n　【０００４】\n　【非特許文献】\n　【０００５】\n　　【非特許文献１】ダン・ブラウン、\"天使と悪魔”、２０００年初版\n【発明の概要】\n【発明が解決しようとする課題】\n　【０００６】\n　非特許文献１では、反物質を生成する必要があった。反物質の生成には、この反物質が\n物質と合わさってエネルギを生成する以上のエネルギが必要であった。\n　【０００６】\n　そこで、本発明は、物質をそのままエネルギに変換することを課題とする。\n【課題を解決するための手段】\n　【０００７】\n　本発明の物質エネルギ変換装置は、水素を入力する水素入力手段と、当該水素を吸収す\nる希土類金属結晶部と、当該希土類金属結晶部の所定の結晶方向に磁場を与える磁場形成\n部とを有する。\n【発明の効果】\n　【０００８】\n　本発明によれば、高い効率で物質をエネルギーに変換することができる。\n【図面の簡単な説明】\n　【０００９】\n　【図１】本実施形態の物質エネルギ変換装置の構成図である。\n　【図２】物質エネルギ変換装置の動作を説明する図である。\n【発明を実施するための形態】\n　【００１０】\n　図１は、本実施形態の物質エネルギ変換装置１の構成図である。\n　【００１０】\n　物質エネルギ変換装置１は、水素入力部１１と、希土類金属結晶１２と、磁場形成部１\n３と、これらを包み込む中性子遮蔽部１４とを備える。この物質エネルギ変換装置１は、\n水素原子を直接にエネルギに変換するものである。\n　【００１１】\n　水素入力部１１は、・・・・・・・・・・・・・・・・・・・・・・・・である。\n　【００１２】\n　希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・・・であり、水\n素入力部１１から入力された水素を吸収して・・・・・・・・・・・・・・・・・・・・・\n・・・する。この希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・\n・することにより、・・・・・・・・・する。\n　【００１３】\n　磁場形成部１３は、・・・・・・・・・・・・・・・・・であり、希土類金属結晶の１１\n１方向の磁場を形成して、・・・・・・・・・、・・・・・・・・・・・・・・・・・・・\nする。これにより、希土類金属結晶１２に吸収されている水素原子は、・・・・・・・・・\n・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・する。\n　【００１４】\n　中性子遮蔽部１４は、水素原子のエネルギ化に伴い、希土類金属結晶１２から出射される\n中性子線を遮蔽する。この中性子遮蔽部１４は、例えば・・・・・・・・・・・・・・・・\n・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・\n・・・であり、・・・・・・・・・する。\n　図２は、物質エネルギ変換装置の動作を説明する図である。\n　【００１５】\n　水素は、水素入力部１１によって高圧（例えば、１０万メガパスカル）に圧縮されて、希\n土類金属結晶１２が位置する炉内に導かれる。希土類金属結晶１２の水素吸収能力により、\n水素は、希土類金属結晶１２に吸収される。そして、磁場形成部１３は、・・・・・・・・\n・・・・・・・・・・・・・。これにより、希土類金属結晶１２からエネルギが放出され、\n中性子線が出射される。\n　【００１６】\n　物質エネルギ変換装置１が変換するエネルギEは、以下の式（１）によって示される。\n但し、Mは水素の質量である。Cは光速である。\n　【数１】\n    E=MC^2・・・（１）\n　よって、本実施形態の物質エネルギ変換装置１によれば、反物質を生成することなく、\n物質を直接的にエネルギに変換することができる。\n【符号の説明】\n　【００１７】\n１　物質エネルギ変換装置\n１１　水素入力部\n１２　希土類金属結晶\n１３　磁場形成部\n１４　中性子遮蔽部\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eブラック所長「なんやこれは、段落番号がデタラメやないか！」\u003cbr\u003e\nブラック所長「なんで【先行技術文献】の直後に段落番号【０００４】を入れてるんや！　段落番号を入れてもええ項目と、段落番号を入れてはいかん項目を覚えや。」\u003cbr\u003e\nブラック所長「ほんで、数式【数１】と文章との区切りには段落番号を入れんとな。」\u003cbr\u003e\nブラック所長「【００１０】の次にまた【００１０】があるぞ、連番で記載な！」\u003cbr\u003e\nブラック所長「図１の説明のあたりは段落番号を入れすぎ！　改行があるからいうて、１行ごとに機械的に入れたらあかん。クライアント企業から水増しやゆうてクレームくるぞ。」\u003cbr\u003e\nブラック所長「ここ、『図２は、物質エネルギ変換装置の動作を説明する図である。』ゆうて、違う図面のことを書き始めとるから、こういうところに段落番号を入れんとあかんのやが、なんでここに入っとらんのや。この次に段落番号【００１５】が入っとるけど、ここは意味としての区切りやないやろ。」\u003c/p\u003e\n\n\u003cp\u003eワイ「は、はい（白目）」\u003cbr\u003e\nブラック所長「段落番号の振り方がええ加減やと、クライアント企業に、中身もその程度の品質だって思われるぞ！」\u003cbr\u003e\nブラック所長「納品時に厳しくチェックされるし注意せなあかん！」\u003cbr\u003e\nワイ「はい（白目）」\u003cbr\u003e\nブラック所長「ほな、ワシはとりあえず帰るぞ。」\u003cbr\u003e\n・・・\u003cbr\u003e\nワイ「あー、ブラック所長はとっとと帰ってしもうたか。なんや最近の所長は、どうでもいい重箱の隅つつきばっかやなあ。まあええわ、こんな重箱の隅なところは、プログラムで生成したるぞ。」\u003c/p\u003e\n\n\u003cp\u003eワイ「段落番号を連番にするだけやったら、WORDのフィールドコードでもええんやがな。段落番号を入れてはいけない項目だとか、段落番号を入れなきゃいけない項目だとか、覚えるのも面倒だし。意味の区切りとかもあるしな。」\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"特許明細書の書式調査\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%89%B9%E8%A8%B1%E6%98%8E%E7%B4%B0%E6%9B%B8%E3%81%AE%E6%9B%B8%E5%BC%8F%E8%AA%BF%E6%9F%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e特許明細書の書式調査\u003c/h1\u003e\n\n\u003cp\u003eワイ　「特許明細書の書式について書かれた文献を見つけたで。根拠条文は、特許法施行規則第２４条の様式第29やな。」\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://www.jpo.go.jp/system/laws/rule/guideline/document/syutugan_tetuzuki/02_03.pdf\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e「18 明細書（配列表は除く。）には、原則として、発明の詳細な説明の段落、図面の簡単な説明の図の説明若しくは符号の説明又は配列表フリーテキストの繰り返し記載の前に、それぞれ「【」及び「】」を付した４桁のアラビア数字で「【０００１】」、「【０００２】」のように連続した段落番号を付す。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eワイ　「つまり、段落番号は４桁の連番ということやな。」\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eこの場合において、「【技術分野】」、「【背景技術】」、「【特許文献】」、「【非特許文献】」、「【発明の概要】」、「【発明が解決しようとする課題】」、「【課題を解決するための手段】」、「【発明の効果】」、「【図面の簡単な説明】」、「【発明を実施するための形態】」、「【実施例】」、「【産業上の利用可能性】」、「【符号の説明】」、「【受託番号】」又は「【配列表フリーテキスト】」の見出しの次に段落番号を付し、これらの見出しの前に段落番号を付してはならない。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eワイ　「【先行技術文献】は、ここに挙げた中にないのに段落番号を付けたからあかんかったのな。」\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eまた、「【特許文献１】」、「【非特許文献１】」、「【化１】」、「【数１】」、「【表１】」、「【図１】」のような番号の次に段落番号を付してはならない。」\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eワイ　「他に段落番号を付けたらあかんのは、「【書類名】」、「【発明の名称】」、「【発明の概要】」やな。」\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"従来技術調査\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BE%93%E6%9D%A5%E6%8A%80%E8%A1%93%E8%AA%BF%E6%9F%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e従来技術調査\u003c/h1\u003e\n\n\u003cp\u003eワイ　「vectorとかで段落番号の自動付与や振り直し機能を持つものは色々あるなあ、DANRAKU, 特許明細書の段落番号自動置換マクロ, 特許出願支援プログラム 段落振り版, 明細書再付番マクロ・・・」\u003cbr\u003e\nワイ　「ユーザインタフェースは参考になるな、段落番号を自動付与する機能、段落番号を連番に振り直す機能、段落番号を削除する機能があればええんやな。」\u003cbr\u003e\nワイ　「でも、どのソフトウエアも、ブラック所長の好みにあいそうな段落番号の振り方じゃないなあ・・・。」\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e名称\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e概要\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e作者\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://www.vector.co.jp/soft/winnt/business/se508771.html?_ga=2.208341205.656111451.1593267346-1579654811.1591502522\" rel=\"nofollow noopener\" target=\"_blank\"\u003eDANRAKU\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e【段落番号】の自動付与・振り直しなどを1クリックで行うためのアドイン 英文明細書の形式にも対応\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eClockahead\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://www.vector.co.jp/soft/win95/business/se299105.html?_ga=2.53095663.656111451.1593267346-1579654811.1591502522\" rel=\"nofollow noopener\" target=\"_blank\"\u003e特許明細書の段落番号自動置換マクロ(Word用)\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e明細書中の段落番号を自動的に振り直す(新旧様式対応)\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e岡田稔\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://www.vector.co.jp/soft/win95/business/se484499.html?_ga=2.246539459.656111451.1593267346-1579654811.1591502522\" rel=\"nofollow noopener\" target=\"_blank\"\u003e特許出願支援プログラム 段落振り版\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e特許明細書のWordファイルに対して新規段落振り・段落振り直しを行う\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eソフト研究会（ライフラボ株式会社）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://www.vector.co.jp/soft/winnt/business/se434178.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e特許明細書の段落番号等を操作するマクロ\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e番号付与や再付与をするマクロ 【化】【数】【表】や【化1-1】等、HTMLファイルにも再付与が可能\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eえの\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://www.vector.co.jp/soft/win95/business/se377703.html?_ga=2.231894815.1469615736.1593342817-1960651967.1586016428\" rel=\"nofollow noopener\" target=\"_blank\"\u003e明細書再付番マクロ(MS-Word)\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e特許明細書の各種項番を振り直す\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e(有)DJソフト\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"仕様\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BB%95%E6%A7%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e仕様\u003c/h2\u003e\n\n\u003cp\u003eワイ　「Visual Studio 2019でWORD VSTO (Visual Studio Tools for Office)アドインとして開発しよ。」\u003cbr\u003e\n同僚Ｘ「おお、ワイ君はなんかまた作り始めたなあ。」\u003cbr\u003e\nワイ　「ええ、段落番号の入力を自動化するんですよ。」\u003cbr\u003e\n同僚Ｘ「ちゃんとできたら皆にも公開な。」\u003cbr\u003e\nワイ　「は、はい。・・・（公開を考えて、VBAじゃなくVSTOで作成して良かった・・・）」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"セットアップ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eセットアップ\u003c/h2\u003e\n\n\u003cp\u003eワイ　「はい、エクスさん使ってみてください。」\u003cbr\u003e\n同僚Ｘ「おお、ちゃんとセットアップもあるなあ。」\u003cbr\u003e\nワイ　「・・・（Visual Studioの発行メニューをクリックしただけやけどな。）」\u003cbr\u003e\n同僚Ｘ「なんやエラーが出てインストールできないぞ。」\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/fd674d72f4b3e52de2f16d8d2cd9057863f056f4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f38626466636532382d373936322d636237352d666163372d3864316336353135376132652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8bdfce28-7962-cb75-fac7-8d1c65157a2e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=611733fb1c992b96dbde809200a5c089\" alt=\"01SmartScreen.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/8bdfce28-7962-cb75-fac7-8d1c65157a2e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8bdfce28-7962-cb75-fac7-8d1c65157a2e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b239a10464499a20d467b18706d4d38d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nワイ　「これは、詳細情報をクリックしてください。」\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/54edad526c5716882f6cec0710cd752df70ddd48/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f38623730353431652d613132332d613239392d333664372d3665343839373834363562342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8b70541e-a123-a299-36d7-6e48978465b4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=99df7b446e7aa8ecf073eed26fa6b948\" alt=\"02SmartScreen.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/8b70541e-a123-a299-36d7-6e48978465b4.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F8b70541e-a123-a299-36d7-6e48978465b4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=13e04df06dd9caa205ca73f2f3ea926d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nワイ　「この実行ボタンをクリックします。」\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/40bc1318208a9943acc7b02ff029f44d68e2ffdc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f39656361343333362d353466302d616236372d366331312d3739616231643133646630382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F9eca4336-54f0-ab67-6c11-79ab1d13df08.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d4840cf7973fffe78cc65393d7180aaa\" alt=\"03vstoerror.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/9eca4336-54f0-ab67-6c11-79ab1d13df08.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F9eca4336-54f0-ab67-6c11-79ab1d13df08.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=eb2c951fdba3874bd7460af239b3fca6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e同僚Ｘ「なんやエラーが出てインストールできないぞ。」\u003cbr\u003e\nワイ　「おかしいなあ」\u003cbr\u003e\n・・・\u003cbr\u003e\nワイ　「わかりましたよ。インターネットからダウンロードしたファイルには、『ゾーン識別子』が付いてるんですけど、このせいです。対策しますから待ってください。」\u003c/p\u003e\n\n\u003cp\u003eVSTOを用いて作成したアドインの配布方法\u003cbr\u003e\n\u003ca href=\"https://wiki.clockahead.com/index.php?Coding%2FMSOffice%2FVSTO%2F%C7%DB%C9%DB%A4%CE%CA%FD%CB%A1\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://wiki.clockahead.com/index.php?Coding%2FMSOffice%2FVSTO%2F%C7%DB%C9%DB%A4%CE%CA%FD%CB%A1\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVSTOにおいてSecurityExceptionによってファイルがインストールできないとき\u003cbr\u003e\n\u003ca href=\"http://artfulplace.hatenablog.com/entry/2014/05/26/154251\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://artfulplace.hatenablog.com/entry/2014/05/26/154251\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"セットアップ再び\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E5%86%8D%E3%81%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eセットアップ再び\u003c/h2\u003e\n\n\u003cp\u003eワイ　「はい、エクスさん使ってみてください。」\u003cbr\u003e\n同僚Ｘ「Install.batをクリックするんやな。」\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/df9c62f826300b6ffa008c2121868dbd80ebe294/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f39363430353932342d663038612d336235342d326231662d6461366162346634666461662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F96405924-f08a-3b54-2b1f-da6ab4f4fdaf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a8422d5ee1b788d60d2c463f81f651c9\" alt=\"03vsto.install.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/96405924-f08a-3b54-2b1f-da6ab4f4fdaf.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F96405924-f08a-3b54-2b1f-da6ab4f4fdaf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5e6c2092db21c1d25dc65645d4377336 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e同僚Ｘ「セットアップは無事終わり。そしたら、WordにAppLintとかいうリボンができるんだな。」\u003c/p\u003e\n\n\u003cp\u003eワイ　「これが段落追加ボタンです。ボタンを押すと段落が自動で付きますよ。」\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d9b1b156dd54c7b48bbfd3b6c6c209a924cfc159/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f37353131356638652d323637372d306261632d393762652d3963633335306662333261642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F75115f8e-2677-0bac-97be-9cc350fb32ad.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d0e56d5ee7f065bcbcc5810ea967d87a\" alt=\"add1.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/75115f8e-2677-0bac-97be-9cc350fb32ad.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F75115f8e-2677-0bac-97be-9cc350fb32ad.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e5757912816e9cd37a922534b28f06ff 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eワイ　「これが段落振り直しボタンです。ボタンを押すと、既存の段落を追番に振り直します。」\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/cb29b80daef95edd5f5c0f549400cece9256f2e6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f33343537663737372d323132662d613938622d323664382d3437303763383864346432612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F3457f777-212f-a98b-26d8-4707c88d4d2a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=03b8bd3a421cb5d6aadae02ea7baffc7\" alt=\"renum1.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/3457f777-212f-a98b-26d8-4707c88d4d2a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F3457f777-212f-a98b-26d8-4707c88d4d2a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d22da4d3238973e6ff654b5744a31972 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eワイ　「これが段落削除ボタンです。最初はまっさらにした方がいいときもあります。」\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/b431978dd7d46c126ac1eae241d22ac0921de342/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f37303365663238302d313938642d346461612d326464632d3334376261343239636138362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F703ef280-198d-4daa-2ddc-347ba429ca86.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f783f9e2aeb4be0d50ae13c245e6dfbe\" alt=\"del1.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/703ef280-198d-4daa-2ddc-347ba429ca86.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F703ef280-198d-4daa-2ddc-347ba429ca86.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=36fa046087d31c14d2f35836a101c37b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e同僚Ｘ「クライアントさんから帰ってきたチェック済原稿を開いて、段落番号追加ボタンをクリック、と。」\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/06c5cee142e672e08b633c5826dc78cffc1dfb37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f30663030626331642d393432342d383461362d343564342d6130346432373933316137342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"616\" alt=\"変更履歴on.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F0f00bc1d-9424-84a6-45d4-a04d27931a74.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=fa3931ca7f66c09ee6d33458f7b1f7ff\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/0f00bc1d-9424-84a6-45d4-a04d27931a74.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F0f00bc1d-9424-84a6-45d4-a04d27931a74.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c5169f09c3c9c7cb5181c23ba7817695 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e同僚Ｘ「おい、校閲の変更履歴が記録されまくって、グダグダになってしまっているぞ。」\u003cbr\u003e\nワイ　「ええっ、エクスさん、ワード文書の変更履歴の記録はオフにしていただかないと。」\u003cbr\u003e\n同僚Ｘ「なんとかならんかなあ、他人から回されてきたワード原稿とかだと、変更履歴の記録がオンされているか否かなんて、\u003cbr\u003e\n　　　　ワードの校閲リボンから、「変更履歴の記録」をクリックせんとわからんしなあ。」\u003cbr\u003e\nワイ　「そ、そうですねえ。」\u003cbr\u003e\n同僚Ｘ「それに、これっていつ始まって、いつ終わったかもわからんなあ。中断もできんし。」\u003cbr\u003e\nワイ　「短時間やからええと思ってましたが、気になるもんですねえ。」\u003cbr\u003e\n同僚Ｘ「ほら、画面上に横棒が表示されて、それが１００％になったときに終わるやつをつけてや。\u003cbr\u003e\n　　　　途中で止めるためのボタンもつけてな。」\u003cbr\u003e\nワイ　「は、はい。・・・（ブログレスバーとキャンセルボタンのことだな、）」\u003c/p\u003e\n\n\u003cp\u003e同僚Ｘ「僕の持っている明細書原稿を全部掛けてみようか。」\u003cbr\u003e\n　　　　・・・\u003cbr\u003e\n同僚Ｘ「ワイ君、なんか、この明細書原稿、ぜんぜん段落番号の削除が効かないけど。」\u003cbr\u003e\nワイ　「あ、あれっ変ですねえ。」\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d074d0358420587f59f70890dac209839b0c1dcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f61303036316633622d393064382d666235352d623636652d3033323263633436623362642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"614\" alt=\"改行.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa0061f3b-90d8-fb55-b66e-0322cc46b3bd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6866741cba60fa6ffd0b4e450f0fe11a\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/a0061f3b-90d8-fb55-b66e-0322cc46b3bd.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa0061f3b-90d8-fb55-b66e-0322cc46b3bd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c743df215c3e300827bd851d2cfe1b21 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eワイ　「この明細書原稿の改行マーク、なんかおかしくないですか。」\u003c/p\u003e\n\n\u003cp\u003e　　　　・・・・\u003c/p\u003e\n\n\u003cp\u003eワイ　「エクスさん、わかりましたよ。この明細書原稿って、Enterじゃなくて、Shift+Enterで行の区切りが入力されているんですよ。」\u003cbr\u003e\n同僚Ｘ「ふーん、なんか知らんけど、どういう風に入力してもちゃんと段落番号を付けるようにしてな。」\u003cbr\u003e\nワイ　「・・・（Enterで入力されるのが ^pで、Shift+Enterで入力されるのが ^l か、全部 ^pに置換するか・・・）」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"改良版\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%94%B9%E8%89%AF%E7%89%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e改良版\u003c/h2\u003e\n\n\u003cp\u003eワイ　「はい、エクスさん、改良しましたので使ってみてください。」\u003cbr\u003e\n同僚Ｘ「このあいだのクライアントさんのチェック済原稿を掛けてみよう。\u003cbr\u003e\n　　　　ちゃんと、「校閲の変更履歴の記録をオフしてください。」で出るなあ。」\u003cbr\u003e\nワイ　「はい、校閲の変更履歴の記録かオンのときには、処理せずに警告するようにしたんですよ。」\u003cbr\u003e\n同僚Ｘ「校閲の変更記録をオフして、段落番号振直ボタンをクリック、と。\u003cbr\u003e\n　　　　進捗を示す棒グラフと、キャンセルボタンも表示されたなあ。」\u003cbr\u003e\nワイ　「はい」\u003c/p\u003e\n\n\u003cp\u003e同僚Ｘ「ぜんぜん段落番号を振ってくれなかった明細書原稿もチェック、と。\u003cbr\u003e\n　　　　おお、こんどはちゃんと段落番号を付けてくれるなあ。」\u003cbr\u003e\nワイ　「はい。対応しました。\u003cbr\u003e\n　　　　（こっそりと ^l を ^p に書き換えるのでＯＫだったか。）\u003c/p\u003e\n\n\u003cp\u003eブラック所長「おお、ワイ君やないか。ほう、段落番号を入れてくれるWORDアドインか。」\u003cbr\u003e\nワイ　「は、はい。」\u003cbr\u003e\nブラック所長「なかなかええ感じに振られてるなあ。\u003cbr\u003e\n　　　　　　　このあいだ苦言を呈させてもろた原稿を掛けてみよっか。」\u003cbr\u003e\nワイ　「はい」\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eワイ君の明細書原稿\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e【書類名】明細書\n【発明の名称】物質エネルギ変換装置\n【技術分野】\n　【０００１】\n　本発明は、物質をエネルギに変換する物質エネルギ変換装置である。\n【背景技術】\n　【０００２】\n　従来、エネルギを得るには、化学反応または核反応を用いる必要があり、効率が悪かっ\nた。\n　非特許文献１には、反物質が物質と合わさって厖大なエネルギを発することが記載され\nている。\n【先行技術文献】\n　【非特許文献】\n　【０００３】\n　　【非特許文献１】ダン・ブラウン、\"天使と悪魔”、２０００年初版\n【発明の概要】\n【発明が解決しようとする課題】\n　【０００４】\n　非特許文献１では、反物質を生成する必要があった。反物質の生成には、この反物質が\n物質と合わさってエネルギを生成する以上のエネルギが必要であった。\n　そこで、本発明は、物質をそのままエネルギに変換することを課題とする。\n【課題を解決するための手段】\n　【０００５】\n　本発明の物質エネルギ変換装置は、水素を入力する水素入力手段と、当該水素を吸収す\nる希土類金属結晶部と、当該希土類金属結晶部の所定の結晶方向に磁場を与える磁場形成\n部とを有する。\n【発明の効果】\n　【０００６】\n　本発明によれば、高い効率で物質をエネルギーに変換することができる。\n【図面の簡単な説明】\n　【０００７】\n　【図１】本実施形態の物質エネルギ変換装置の構成図である。\n　【図２】物質エネルギ変換装置の動作を説明する図である。\n【発明を実施するための形態】\n　【０００８】\n　図１は、本実施形態の物質エネルギ変換装置１の構成図である。\n　物質エネルギ変換装置１は、水素入力部１１と、希土類金属結晶１２と、磁場形成部１\n３と、これらを包み込む中性子遮蔽部１４とを備える。この物質エネルギ変換装置１は、\n水素原子を直接にエネルギに変換するものである。\n　【０００９】\n　水素入力部１１は、・・・・・・・・・・・・・・・・・・・・・・・・である。\n　希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・・・であり、水\n素入力部１１から入力された水素を吸収して・・・・・・・・・・・・・・・・・・・・・\n・・・する。この希土類金属結晶１２は、・・・・・・・・・・・・・・・・・・・・・・\n・することにより、・・・・・・・・・する。\n　【００１０】\n　磁場形成部１３は、・・・・・・・・・・・・・・・・・であり、希土類金属結晶の１１\n１方向の磁場を形成して、・・・・・・・・・、・・・・・・・・・・・・・・・・・・・\nする。これにより、希土類金属結晶１２に吸収されている水素原子は、・・・・・・・・・\n・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・する。\n　【００１１】\n　中性子遮蔽部１４は、水素原子のエネルギ化に伴い、希土類金属結晶１２から出射される\n中性子線を遮蔽する。この中性子遮蔽部１４は、例えば・・・・・・・・・・・・・・・・\n・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・\n・・・であり、・・・・・・・・・する。\n　【００１２】\n　図２は、物質エネルギ変換装置の動作を説明する図である。\n　水素は、水素入力部１１によって高圧（例えば、１０万メガパスカル）に圧縮されて、希\n土類金属結晶１２が位置する炉内に導かれる。希土類金属結晶１２の水素吸収能力により、\n水素は、希土類金属結晶１２に吸収される。そして、磁場形成部１３は、・・・・・・・・\n・・・・・・・・・・・・・。これにより、希土類金属結晶１２からエネルギが放出され、\n中性子線が出射される。\n　【００１３】\n　物質エネルギ変換装置１が変換するエネルギEは、以下の式（１）によって示される。\n但し、Mは水素の質量である。Cは光速である。\n　【数１】\n    E=MC^2・・・（１）\n\n　【００１４】\n　よって、本実施形態の物質エネルギ変換装置１によれば、反物質を生成することなく、\n物質を直接的にエネルギに変換することができる。\n【符号の説明】\n　【００１５】\n１　物質エネルギ変換装置\n１１　水素入力部\n１２　希土類金属結晶\n１３　磁場形成部\n１４　中性子遮蔽部\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eブラック所長「「【先行技術文献】」の次には段落番号を入れてないな。」\u003cbr\u003e\nワイ　「段落番号を入れていい項目と入れてはならない項目は、ちゃんと区別してます。」\u003c/p\u003e\n\n\u003cp\u003eブラック所長「程よい感じで段落番号が入ってるな。」\u003cbr\u003e\nワイ　　「はい。１行４０文字で書いたとき、およそ３～５行で１つの段落番号が入るようにしたんです。」\u003c/p\u003e\n\n\u003cp\u003eブラック所長「【数１】と数式の次にも入ってるな。」\u003cbr\u003e\nワイ　「ワードの数式・画像・表をちゃんと判定してます。」\u003cbr\u003e\n　　　　（・・・テキストで数式を書かれたらアウトやけどな。）\u003c/p\u003e\n\n\u003cp\u003eブラック所長「実施形態の『図１は、・・。』、『図２は、・・。』の直前に段落番号が入ってるな。」\u003cbr\u003e\nワイ　「はい、『図（番号）は、・・・。』を検知して、その直前に段落番号を入れるようにしてます。」\u003c/p\u003e\n\n\u003cp\u003eブラック所長「これなら段落番号は大丈夫や。さて、次は中身の問題やが・・・。」\u003cbr\u003e\nワイ　ギクッ・・・　　\u003c/p\u003e\n\n\u003cp\u003e（次回に続く・・・かもしれない。）\u003c/p\u003e\n\n\u003cp\u003e※ワイ記法(C)無職やめ太郎さん\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"仕様説明\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BB%95%E6%A7%98%E8%AA%AC%E6%98%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e仕様説明\u003c/h1\u003e\n\n\u003cp\u003eこれは、フリーソフト「段落ジェネレータ」の紹介記事です。\u003c/p\u003e\n\n\u003cp\u003eGitHub のURLはこちらです。Visual Studio 2019 でコンパイルしてください。\u003cbr\u003e\n\u003ca href=\"https://github.com/k-ayaki/danrakuG01\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/k-ayaki/danrakuG01\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOSDN のURLはこちらです。インストーラがアップロードされています。\u003cbr\u003e\n\u003ca href=\"https://osdn.net/projects/danrakug/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://osdn.net/projects/danrakug/\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コードとプロジェクトの説明\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E8%AA%AC%E6%98%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコードとプロジェクトの説明\u003c/h1\u003e\n\n\u003cp\u003eWORD のVSTOアドインについて書かれている文献は少ないので、この記事が少しでも開発の助けになればとおもいます。試しに、amazon で \"VSTO\" と入力して書籍を検索してみてください。\"VBA\"の書籍と比べて、その少なさに愕然とします。\u003c/p\u003e\n\n\u003cp\u003e　なお、VSTO(Visual Studio Tools for Office)とは、オフィスソリューションの一つであり、OfficeアプリケーションのアドインをC#やVB.netで記述できます。VBA(Visual Basic for Application)と比べると、Visual Studioが必須である点が、やや面倒くさいです。また、VSTOのアドインは、Officeのバージョンによっては互換性が問題になる場合があります。しかし、Officeのアドインを作成して公開し、かつ、そのソースコードを秘匿したい場合には、VSTOを選択肢とすることが必要とおもいます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考文献\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考文献\u003c/h2\u003e\n\n\u003cp\u003eオフィスソリューション開発の概要 (VSTO)\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/visualstudio/vsto/office-solutions-development-overview-vsto?view=vs-2019\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/visualstudio/vsto/office-solutions-development-overview-vsto?view=vs-2019\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"guiの説明\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#gui%E3%81%AE%E8%AA%AC%E6%98%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eGUIの説明\u003c/h2\u003e\n\n\u003cp\u003eGUIは、WORDのリボンインタフェースとして実装いたしました。\u003c/p\u003e\n\n\u003cp\u003eリボン全体の属性は以下です。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/cd39c4e72cf8672669752b0ffd734d8db2737c28/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f63373833333534652d623664642d303463342d643530332d6634346232383461306338332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"764\" alt=\"2020-06-28.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fc783354e-b6dd-04c4-d503-f44b284a0c83.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=61629ae08907a178beae32cf5d82cb46\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/c783354e-b6dd-04c4-d503-f44b284a0c83.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fc783354e-b6dd-04c4-d503-f44b284a0c83.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bca0f024fd8b081ff655c1d99f50abdf 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eボタンのグループの名前には「段落生成」と名付けました。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/5b1584930f050760a8b54c0322ff305b45530d8d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f61333361333739332d623730342d643438382d643366322d6462386234633335646537652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"767\" alt=\"2020-06-28 (4).png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa33a3793-b704-d488-d3f2-db8b4c35de7e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=543935b49569429d82625cf0d63db63c\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/a33a3793-b704-d488-d3f2-db8b4c35de7e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fa33a3793-b704-d488-d3f2-db8b4c35de7e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fe381db176a7868ddf1c87b994fc4e04 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　段落付与ボタンは、縦横64ピクセルのアイコンを付けました。“【０００１】”の段落番号を黒文字で入れています。なお、自前でアイコンを生成する代わりに、Officeに組み込まれているアイコンを使うこともできます。\u003cbr\u003e\n　この段落付与ボタンをクリックしたとき、Ribbon1.cs の AddDanraku_Click関数が呼び出されます。\u003cbr\u003e\n　これにより、段落が付与されたのち、段落番号が追番に振り直されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/df223a3b9bcf1c04c59063cd58749436711349bf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f33326566316634652d643933612d616635632d363732312d3566613735333031633565642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"767\" alt=\"2020-06-28 (1).png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F32ef1f4e-d93a-af5c-6721-5fa75301c5ed.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=26d0bb5e2e660b8a1f9665a79b938711\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/32ef1f4e-d93a-af5c-6721-5fa75301c5ed.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F32ef1f4e-d93a-af5c-6721-5fa75301c5ed.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=04f28674532e33557c03aa1da191be5d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　段落の振直ボタンは、縦横64ピクセルのアイコンを付けました。“【０００１】”と”【０００２】”の段落番号がオーバーラップするよう青文字で入れています。振直ボタンをクリックしたとき、Ribbon1.cs の  RenumDanraku_Click関数が呼び出されます。\u003cbr\u003e\n　これにより、段落番号が追番に振り直されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/589f7bec819e0ebc84b32404e7694b341503fc09/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f65323737366335612d303835622d653865362d633931612d3161396438353965616461612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"767\" alt=\"2020-06-28 (2).png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fe2776c5a-085b-e8e6-c91a-1a9d859eadaa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=17bf6dd28618fdbbce19f87c53d44501\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/e2776c5a-085b-e8e6-c91a-1a9d859eadaa.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2Fe2776c5a-085b-e8e6-c91a-1a9d859eadaa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=52d9ee26388ad66974cca853ce6061c3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　段落の削除ボタンは、縦横64ピクセルのアイコンを付けました。“【０００１】”と取消線とを赤で入れています。削除ボタンをクリックしたとき、Ribbon1.cs の  DelDanraku_Click関数が呼び出されます。\u003cbr\u003e\n　これにより、段落が削除されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0a8f37b9600abf8f24d83fc16ef367d16fa5403a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3236363237332f35323638616535632d626239372d656263662d626230312d6538393132643034363966312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"767\" alt=\"2020-06-28 (3).png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F5268ae5c-bb97-ebcf-bb01-e8912d0469f1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=915d49ec69e1decc601e41d0ea5df38b\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/266273/5268ae5c-bb97-ebcf-bb01-e8912d0469f1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F266273%2F5268ae5c-bb97-ebcf-bb01-e8912d0469f1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f53327d93fc803095f8c5fdf607724a1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n　\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コード説明\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E8%AA%AC%E6%98%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコード説明\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"段落の削除\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AE%B5%E8%90%BD%E3%81%AE%E5%89%8A%E9%99%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e段落の削除\u003c/h2\u003e\n\n\u003cp\u003e　一番簡単な段落削除から説明します。\u003c/p\u003e\n\n\u003cp\u003e　最初に、WORDの校閲の変更履歴の記録がオンになっているか否かを判定します。変更履歴の記録がオンになっているときにアドインが文書を書き換えると、その書き換えが変更履歴として記録されてしまいます。よっで、これを防ぐために、変更履歴の記録がオンになっているときには、処理を実行せずに終了します。\u003cbr\u003e\n　doc.TrackRevisionsがtrue のとき、変更履歴の記録がオンです。このときには、メッセージボックスを表示したのち、処理を終了します。\u003c/p\u003e\n\n\u003cp\u003e　次に、文書の垂直タブを改行に変換します。WORDのパラグラフは、文章の改行で区切られています。\u003cbr\u003e\n　WORDの文章が垂直タブで区切られていると、そこは文章の切れ目であり、かつ、文章が改行されているかのように見えますが、垂直タブの前後は同一のパラグラフです。\u003cbr\u003e\n　よって、本アドインでは文章の垂直タブを改行に変換して、文章の切れ目とパラグラフの区切りを一致させています。\u003c/p\u003e\n\n\u003cp\u003e　そして、プログレスパーの表示用ダイアログと、プログレスバーのワーカースレッドを起動します。なお ProgressDialog クラスは、プログレスバーの表示用ダイアログが終了すると、その結果に応じて、キャンセル、エラー、成功の何れかに分岐します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eDelDanraku_Click（段落削除ボタンのクリック）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDelDanraku_Click\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRibbonControlEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edanrakuG01\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGlobals\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThisAddIn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActiveDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003epatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTrackRevisions\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eForms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"変更履歴の記録をオフしてくたさい\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e垂直タブを改行に\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eProgressDialog\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eProgressDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"段落の削除\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoWorkEventHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProgressDialog_Del_DoWork\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"m\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//進行状況ダイアログを表示する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShowDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//結果を取得する\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancel\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"キャンセルされました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAbort\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//エラー情報を取得する\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"エラー: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//結果を取得する\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003estopTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//MessageBox.Show(\"成功しました: \" + stopTime.ToString());\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//後始末\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"垂直タブを改行に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9E%82%E7%9B%B4%E3%82%BF%E3%83%96%E3%82%92%E6%94%B9%E8%A1%8C%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e垂直タブを改行に\u003c/h2\u003e\n\n\u003cp\u003e　垂直タブを改行に変換するコードは、マイクロソフトのVSTOのサンプルコードとほぼ同一です。\u003c/p\u003e\n\n\u003cp\u003e　プログラムによって文書内のテキストを検索および置換する\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-search-for-and-replace-text-in-documents?view=vs-2019\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-search-for-and-replace-text-in-documents?view=vs-2019\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eプログラムによって検索後に選択を復元する\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-restore-selections-after-searches?view=vs-2019\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-restore-selections-after-searches?view=vs-2019\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e垂直タブを改行に\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e// プログラムによって文書内のテキストを検索および置換する\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-search-for-and-replace-text-in-documents?view=vs-2019\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// プログラムによって検索後に選択を復元する\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//https://docs.microsoft.com/ja-jp/visualstudio/vsto/how-to-programmatically-restore-selections-after-searches?view=vs-2019\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"err\"\u003e垂直タブを改行に\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003erangeSave\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSelection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSelection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWholeStory\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFind\u003c/span\u003e \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSelection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFind\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearFormatting\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^l\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReplacement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearFormatting\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReplacement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^p\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatchFuzzy\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eForward\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003efindtext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^l\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ereplacetext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^p\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ereplaceAll\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eWdReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewdReplaceAll\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efindObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003efindtext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003ereplacetext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003ereplaceAll\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003emissing\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erangeSave\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e　段落削除に係るプログレスバーのワーカースレッドです。\u003cbr\u003e\n　このスレッド内では、WORDの文書のうち、書類名の範囲が“明細書”であるものを検索します。\u003cbr\u003e\n　すなわち、“【書類名】明細書”が記載されたパラグラフから、次の“【書類名】”が記載されたパラグラフまたは文書の末尾までの範囲を取得します。\u003cbr\u003e\n　そして、段落番号が記載されているパラグラフを順次検索すると、そのパラグラフを削除します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eProgressDialog_Del_DoWork（段落削除のプログレスバーのワーカースレッド）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e// 段落の削除\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eProgressDialog_Del_DoWork\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDoWorkEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eBackgroundWorker\u003c/span\u003e \u003cspan class=\"n\"\u003ebw\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBackgroundWorker\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//パラメータを取得する\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003estopTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eArgument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edanrakuG01\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGlobals\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThisAddIn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActiveDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003epatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e書類名の範囲\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"明細書\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eForms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"明細書が記載されていません。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"警告\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"n\"\u003eendpos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecounter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFind\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatchWildcards\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTickCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReportProgress\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"% 終了しました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFind\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"【[０-９]@】\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eパラグラフが空白か判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParagraphs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]))\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParagraphs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//キャンセルされたか調べる\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancellationPending\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//キャンセルされたとき\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTickCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//指定された時間待機する\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//System.Threading.Thread.Sleep(stopTime);\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e//ProgressChangedイベントハンドラを呼び出し、\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//コントロールの表示を変更する\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eendpos\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReportProgress\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"% 終了しました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReportProgress\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"% 終了しました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e500\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//結果を設定する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e　プログレスダイアログは、ProgressDialog.cs に記載された ProgressDialogクラスによって表示されます。このクラスは、BackgroundWorkerクラスを使用しており、以下のサンプルコードを参考にしています。\u003c/p\u003e\n\n\u003cp\u003e参考文献：\u003cbr\u003e\nBackgroundWorkerクラスを使用して進行状況ダイアログを作成する\u003cbr\u003e\n\u003ca href=\"https://dobon.net/vb/dotnet/programing/progressdialogbw.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://dobon.net/vb/dotnet/programing/progressdialogbw.html\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　“書類名の範囲”メソッドは、docname で記載された名前に一致する書類名の範囲を返すものです。\u003cbr\u003e\n　こういう風に、メソッド名を日本語で書くと嫌がる方がおられますが、自分としては日本人ならば可読性が上がるからよいとおもって書いています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e書類名の範囲\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"err\"\u003e書類名の範囲\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003edocname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"n\"\u003espos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"n\"\u003eepos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eepos\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eepos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erng\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e書類名の範囲を選択\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003espos\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eepos\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epara1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParagraphs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epara1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edocname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"err\"\u003e領域始端のトリム\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"err\"\u003e領域終端のトリム\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"err\"\u003e領域拡張\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003espos\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e　書類名の範囲を選択メソッドは、“【書類名】・・・・” から次の “【書類名】・・・・” までを選択するものです。\u003cbr\u003e\n　領域始端のトリムメソッドとは、始端から空白・改行などを取り去るものです。これにより領域の始端を調整します。\u003cbr\u003e\n　領域終端のトリムメソッドとは、終端から空白・改行などを取り去るものです。これにより領域の終端を調整します。\u003cbr\u003e\n　領域拡張メソッドは、トリムした始端・終端を、WORD文書のパラグラフ単位で拡張します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"段落の生成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AE%B5%E8%90%BD%E3%81%AE%E7%94%9F%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e段落の生成\u003c/h2\u003e\n\n\u003cp\u003e段落の生成を説明します。\u003c/p\u003e\n\n\u003cp\u003e　最初に、WORDの校閲の変更履歴の記録がオンになっているか否かを判定します。変更履歴の記録がオンになっているときにアドインが文書を書き換えると、その書き換えが変更履歴として記録されてしまいます。よっで、これを防ぐために、変更履歴の記録がオンになっているときには、処理を実行せずに終了します。\u003cbr\u003e\n　doc.TrackRevisionsがtrue のとき、変更履歴の記録がオンです。このときには、メッセージボックスを表示したのち、処理を終了します。\u003cbr\u003e\n　次に、文書の垂直タブを改行に変換します。\u003c/p\u003e\n\n\u003cp\u003e　そして、段落生成のプログレスパーの表示用ダイアログと、段落生成のプログレスバーのワーカースレッドを起動します。\u003cbr\u003e\n　プログレスバーの表示用ダイアログが終了すると、その結果に応じて、キャンセル、エラー、成功の何れかに分岐します。\u003c/p\u003e\n\n\u003cp\u003e　次に、段落番号の振り直しのプログレスパーの表示用ダイアログと、段落番号の振り直しのプログレスバーのワーカースレッドを起動します。\u003cbr\u003e\n　これは、既に段落番号が付与されているとき、新たに段落番号を追加すると、段落番号の振り直しが必要になるためです。\u003cbr\u003e\n　プログレスバーの表示用ダイアログが終了すると、その結果に応じて、キャンセル、エラー、成功の何れかに分岐します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAddDanraku_Click（段落生成ボタンのクリック）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddDanraku_Click\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRibbonControlEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDocument\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edanrakuG01\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGlobals\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThisAddIn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActiveDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003epatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//myPatDoc.G_段落番号付与(doc);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTrackRevisions\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eForms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"変更履歴の記録をオフしてくたさい\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e垂直タブを改行に\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//ProgressDialogオブジェクトを作成する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eProgressDialog\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eProgressDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"段落番号の付与\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoWorkEventHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProgressDialog_Add_DoWork\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"m\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//進行状況ダイアログを表示する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShowDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//結果を取得する\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancel\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"キャンセルされました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//後始末\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAbort\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//エラー情報を取得する\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"エラー: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//後始末\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//結果を取得する\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003estopTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//MessageBox.Show(\"成功しました: \" + stopTime.ToString());\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//後始末\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//ProgressDialogオブジェクトを作成する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epd\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eProgressDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"段落番号の振り直し\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoWorkEventHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProgressDialog_Renum_DoWork\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"m\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//進行状況ダイアログを表示する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShowDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//結果を取得する\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancel\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"キャンセルされました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAbort\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//エラー情報を取得する\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"エラー: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eDialogResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//結果を取得する\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003estopTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//MessageBox.Show(\"成功しました: \" + stopTime.ToString());\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//後始末\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e　段落生成に係るプログレスバーのワーカースレッドでは、WORDの文書のうち、書類名の範囲が“明細書”であるものを検索します。すなわち、“【書類名】明細書”が記載されたパラグラフから、次の“【書類名】”が記載されたパラグラフの直前のパラグラフまたは文書の末尾までの範囲を取得します。\u003cbr\u003e\n　そして、範囲内のパラグラフを順次検索すると、そのパラグラフの直後または直前が段落番号の生成対象であるか否かを判定します。段落番号の生成対象であると判定したならば、そのパラグラフの直後または直前に、段落番号が記載されたパラグラフを挿入します。\u003c/p\u003e\n\n\u003cp\u003e　“項目の判定”メソッドとは、現在のパラグラフに隅付括弧【】があるか否かを判定するものです。\u003cbr\u003e\n　そして、“パラグラフが段落番号付与対象項目か判定”メソッドがtrueならば、この直後に段落番号のパラグラフを挿入します。そして、現在のパラグラフが”【符号の説明】”ならば、処理を終了します。\u003cbr\u003e\n　\u003cbr\u003e\n 次に、”パラグラフが数化表項目か判定”メソッドにより、現在のパラグラフが数式、化学式、表の項目であるか否かを判定します。現在のパラグラフが数式、化学式、表の項目ならば、直前に文章が記載されているか否かを判定し、その直前に段落番号が記載されたパラグラフを挿入します。\u003c/p\u003e\n\n\u003cp\u003e　次に、”パラグラフが段落番号付与非対象項目か判定”メソッドがtrueであり、かつ“パラグラフが不正な段落番号か判定”メソッドがtrueならば、不正な段落番号が付与されたパラグラフとして、このパラグラフを削除します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eProgressDialog_Add_DoWork（段落生成のプログレスバーのワーカースレッドの要部）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecounter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTickCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReportProgress\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"% 終了しました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eParagraph\u003c/span\u003e \u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParagraphs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etmpdebug\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e項目の判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eパラグラフが段落番号付与対象項目か判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003erng2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e直後への段落番号の挿入\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"【符号の説明】\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eパラグラフが数化表項目か判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eParagraph\u003c/span\u003e \u003cspan class=\"n\"\u003eparaPrev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eテキスト記載パラグラフ取得\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eパラグラフが数化表項目か判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaPrev\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e直前への段落番号挿入\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eparaPrev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eパラグラフが段落番号付与非対象項目か判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eパラグラフが不正な段落番号か判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003erng2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e直後への段落番号の挿入\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e段落番号付与判定\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//キャンセルされたか調べる\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancellationPending\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//キャンセルされたとき\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//指定された時間待機する\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//System.Threading.Thread.Sleep(stopTime);\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTickCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//ProgressChangedイベントハンドラを呼び出し、\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//コントロールの表示を変更する\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003eparaCurr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReportProgress\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"% 終了しました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"段落の振り直し\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AE%B5%E8%90%BD%E3%81%AE%E6%8C%AF%E3%82%8A%E7%9B%B4%E3%81%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e段落の振り直し\u003c/h2\u003e\n\n\u003cp\u003e段落の振り直しは、追番として記載されていない段落番号を、追番に振り直すものです。具体的には、WORDの検索機能で、段落番号のパターンに当て嵌まる文字列を順次検索して、これを追番の段落番号の文字列で書き換えています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eProgressDialog_Renum_DoWork（段落の振り直しのプログレスバーのワーカースレッド）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e            \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFind\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatchWildcards\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFind\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"【[０-９]@】\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emyPatDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e段落番号文字列の生成\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e//キャンセルされたか調べる\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancellationPending\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//キャンセルされたとき\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//指定された時間待機する\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//System.Threading.Thread.Sleep(16);\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTickCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//ProgressChangedイベントハンドラを呼び出し、\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//コントロールの表示を変更する\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003erng\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnd\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eendpos\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ebw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReportProgress\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"% 終了しました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003elastTick\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrTick\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"インストーラ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%A9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eインストーラ\u003c/h2\u003e\n\n\u003cp\u003e　最近のVSTOで特筆すべきは、インストーラの作成の簡単さだとおもいます。VisualStudio2019のビルドメニューから「・・・の発行」をクリックするだけですから。\u003cbr\u003e\n　なお、CDやUSBメモリからインストールする従来のインストーラに限られず、FTPサーバにアップロードすることも可能だそうですが、未検証です。\u003c/p\u003e\n\n\u003cp\u003e　出来上がったセットアップファイルをインターネットに置くと、ダウンロードの際にゾーン識別子が付きます。vstoのsetup.exeは、*.vstoと *.dll.manifest にゾーン識別子が着いているとエラー終了します。よって、install.bat によりゾーン識別子を削除して、setup.exeを起動させます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"powershell\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003einstall.bat\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eecho\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003edanrakuG01.vsto:Zone.identifier\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eecho\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\".\\Application Files\\danrakuG01_1_0_0_4\\danrakuG01.dll.manifest:Zone.identifier\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eecho\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\".\\Application Files\\danrakuG01_1_0_0_4\\danrakuG01.vsto:Zone.identifier\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003esetup.exe\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e参考文献：\u003cbr\u003e\nチュートリアル: Word 用の最初の VSTO アドインの作成します。\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/visualstudio/vsto/walkthrough-creating-your-first-vsto-add-in-for-word?view=vs-2019\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/visualstudio/vsto/walkthrough-creating-your-first-vsto-add-in-for-word?view=vs-2019\u003c/a\u003e\u003cbr\u003e\n【ワレコの講座】VS2017でEXCEL VSTOアドイン作成 – リボン編（1/10）\u003cbr\u003e\n\u003ca href=\"https://www.wareko.jp/blog/creating-excel-vsto-addin-with-vs2017-ribbon-edition-1of10\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.wareko.jp/blog/creating-excel-vsto-addin-with-vs2017-ribbon-edition-1of10\u003c/a\u003e\u003cbr\u003e\n【ワレコの講座】EXCEL VSTOアドインで選択セル情報取得（2/10）\u003cbr\u003e\n\u003ca href=\"https://www.wareko.jp/blog/acquire-selected-cell-information-with-excel-vsto-add-in-2of10\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.wareko.jp/blog/acquire-selected-cell-information-with-excel-vsto-add-in-2of10\u003c/a\u003e\u003cbr\u003e\n【ワレコの講座】EXCEL VSTOアドインを他のPCに配布する（3/10）\u003cbr\u003e\n\u003ca href=\"https://www.wareko.jp/blog/publish-excel-vsto-add-in-to-another-pc-3of10\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.wareko.jp/blog/publish-excel-vsto-add-in-to-another-pc-3of10\u003c/a\u003e\u003cbr\u003e\nダウンロードしたファイルの「ブロック解除」をコマンドで\u003cbr\u003e\n\u003ca href=\"https://qiita.com/gentaro/items/3beb65a8f2f89089a042\" class=\"autolink\" id=\"reference-3ba18b81b7e61e31beda\"\u003ehttps://qiita.com/gentaro/items/3beb65a8f2f89089a042\u003c/a\u003e\u003c/p\u003e\n","createdAt":"2020-07-11T04:38:05Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"IBe6/2F7rgBrlKwhwq8UCGYXKswPmxuXOg==--Twq7fIRUsi9z7soP--nIkxQ2ti5cQ/77xkHsCVFg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-07-15T09:17:53Z","likesCount":3,"linkUrl":"https://qiita.com/kenichiro_ayaki/items/73e4c19f9020d06b6076","organization":null,"originalId":1262202,"stockedCount":1,"title":"特許技術者の憂鬱・明細書の段落番号付与","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9\"\u003eユースケース\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%89%B9%E8%A8%B1%E6%98%8E%E7%B4%B0%E6%9B%B8%E3%81%AE%E6%9B%B8%E5%BC%8F%E8%AA%BF%E6%9F%BB\"\u003e特許明細書の書式調査\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BE%93%E6%9D%A5%E6%8A%80%E8%A1%93%E8%AA%BF%E6%9F%BB\"\u003e従来技術調査\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BB%95%E6%A7%98\"\u003e仕様\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\"\u003eセットアップ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E5%86%8D%E3%81%B3\"\u003eセットアップ再び\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%94%B9%E8%89%AF%E7%89%88\"\u003e改良版\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BB%95%E6%A7%98%E8%AA%AC%E6%98%8E\"\u003e仕様説明\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E8%AA%AC%E6%98%8E\"\u003eコードとプロジェクトの説明\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e参考文献\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#gui%E3%81%AE%E8%AA%AC%E6%98%8E\"\u003eGUIの説明\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E8%AA%AC%E6%98%8E\"\u003eコード説明\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AE%B5%E8%90%BD%E3%81%AE%E5%89%8A%E9%99%A4\"\u003e段落の削除\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9E%82%E7%9B%B4%E3%82%BF%E3%83%96%E3%82%92%E6%94%B9%E8%A1%8C%E3%81%AB\"\u003e垂直タブを改行に\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AE%B5%E8%90%BD%E3%81%AE%E7%94%9F%E6%88%90\"\u003e段落の生成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AE%B5%E8%90%BD%E3%81%AE%E6%8C%AF%E3%82%8A%E7%9B%B4%E3%81%97\"\u003e段落の振り直し\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%A9\"\u003eインストーラ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":2533,"uuid":"73e4c19f9020d06b6076","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"F6+nj/X9d48WbLhetBs4WpDd7eZS--pPYQaNZrrcmDhPQ7--1WIwgoG+7sgWyeb/mVd0zA==","originalId":266273,"description":"第１種情報処理技術者\r\n電気通信主任技術者\r\n弁理士","facebookUrl":null,"githubUrl":"https://github.com/k-ayaki","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":"https://www.linkedin.com/in/ken-ichiro-ayaki-965b2a8a/","name":"綾木 健一郎","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/266273/profile-images/1553914112","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F266273%2Fprofile-images%2F1553914112?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=f0321ea9d48cc16dd273b6d27944b070","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F266273%2Fprofile-images%2F1553914112?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=427784b5ab45d3de6a5b5f2e6cc64d7b","urlName":"kenichiro_ayaki","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"office","urlName":"office"},{"name":"Word","urlName":"word"},{"name":"VSTO","urlName":"vsto"},{"name":"アドイン","urlName":"%e3%82%a2%e3%83%89%e3%82%a4%e3%83%b3"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
