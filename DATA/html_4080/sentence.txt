More than 1 year has passed since last update.コマンドを読み込んで処理を実行するプログラムを作っていたのですが、コマンドを読んで処理を分岐する部分をswitch～caseで実装したところ、分岐が多すぎてVisualStudioでコードメトリクスを算出したときにサイクロマティック複雑度が50を超えてしまいました。
コマンド分岐部分なので無視してもよかったのですが、あまり美しくないのでもう少し良い方策がないか悩んだ結果、コードチェック上はサイクロマティック複雑度を上げずに書けたので、その方法を記載します。
（※あくまでコードチェックツール上のサイクロマティック複雑度を減らせるというだけで、実際的な意味では分岐は減っていないです。）まず、もとのコードは下記のような状態とします。これに対して、コマンドごとに呼び出されるメソッドのデリゲートを作成してディクショナリに格納し、switchのかわりにディクショナリのキーを使って呼び出します。DTOを作成して、すべての分岐先のメソッドの引数と戻り値を一本化します。そうするとあら不思議、switch分岐がないのでサイクロマティック複雑度があがらなくなりました。
実際にデバッグするときにどちらのほうがわかり易いかと言われると素直にswitchで分岐してあったほうがいいような気もするので微妙なところです。


