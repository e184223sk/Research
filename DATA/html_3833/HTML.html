<!DOCTYPE html><html><head><meta charset="utf-8" /><title>拡張メソッドの意義とは？ - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/wolfmagnate/items/84ba30fb9970e01b1d2d" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="2OCNqfdm9biQj+Nu5TbbbqjooNqAu07TF6ya8zddmvDZXFREm3qoE/bqspTnINRI7IioOUMKbKsVMZ/HU7cgnw==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="拡張メソッドの意義とは？ - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01b3VoNWJ5MTQ0T2g0NEs5NDRPRDQ0T0o0NEd1NW9TUDU3NnA0NEdvNDRHdjc3eWYmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9MzcyMTRiYTlhZjAxN2I1MjZhYTM3ZWYxMGQwMTQ4MTg&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGR2YkdadFlXZHVZWFJsJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9YmUxNGM5ZDQxYzQ2YTY0ZmNlNDBjN2ZhMWQ4NTdkNmM&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=f7bebf0fe9c3e679156831aff7fbbb78"><meta property="og:description" content="

初めに

C#の拡張メソッドの存在意義が文法だけでは分かりにくいと感じ、調査を行いました。


前提条件


C#の文法はなんとなく把握している
拡張メソッドの存在は知っている



対処したい状況

端的に言うと「本来メソッドが..."><meta content="https://qiita.com/wolfmagnate/items/84ba30fb9970e01b1d2d" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,拡張メソッド" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-5904faea-9853-4cf9-a4bd-8e7af0213422"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fwolfmagnate%2Fitems%2F84ba30fb9970e01b1d2d">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fwolfmagnate%2Fitems%2F84ba30fb9970e01b1d2d">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-5904faea-9853-4cf9-a4bd-8e7af0213422">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2021-04-29T19:42:24.000+09:00","dateModified":"2021-04-30T09:42:00.000+09:00","headline":"拡張メソッドの意義とは？","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01b3VoNWJ5MTQ0T2g0NEs5NDRPRDQ0T0o0NEd1NW9TUDU3NnA0NEdvNDRHdjc3eWYmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9MzcyMTRiYTlhZjAxN2I1MjZhYTM3ZWYxMGQwMTQ4MTg\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGR2YkdadFlXZHVZWFJsJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9YmUxNGM5ZDQxYzQ2YTY0ZmNlNDBjN2ZhMWQ4NTdkNmM\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=f7bebf0fe9c3e679156831aff7fbbb78","mainEntityOfPage":"https://qiita.com/wolfmagnate/items/84ba30fb9970e01b1d2d","author":{"@type":"Person","address":"","email":null,"identifier":"wolfmagnate","name":"wolfmagnate","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F1412657%2Fb86b047218e8eb5ce571eca486a5287129fa372d%2Fx_large.png%3F1619693305?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=22c18e84755a0574722fcce4006a5472","url":"https://qiita.com/wolfmagnate","description":"C#が好きな情報系大学生\r\n進捗を出したい","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"wolfmagnate","type":"items","id":"84ba30fb9970e01b1d2d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"wolfmagnate","type":"items","id":"84ba30fb9970e01b1d2d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"wolfmagnate","type":"items","id":"84ba30fb9970e01b1d2d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/wolfmagnate/items/84ba30fb9970e01b1d2d","location":"/wolfmagnate/items/84ba30fb9970e01b1d2d","scheme":"https","host":"qiita.com","port":null,"pathname":"/wolfmagnate/items/84ba30fb9970e01b1d2d","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"kJpJfyrKiSbO9dSdcQgvve2XVJVS/VZ1XhOOYCOtUdeRJpCSRtbUjaiQhWdzHiCbqfdcdpFMdA1cjotUR0fruA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-9cd47709-3c1b-415c-9cb7-249f4bad24a4"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/likers" class="css-1iupg5d">2</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">1</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/84ba30fb9970e01b1d2d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/wolfmagnate"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/1412657/b86b047218e8eb5ce571eca486a5287129fa372d/x_large.png?1619693305" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/wolfmagnate" class="css-10ougpm">@<!-- -->wolfmagnate</a><div class="css-1ay9vb9"><span><meta content="2021-04-29T10:42:24Z"/><time dateTime="2021-04-30T00:42:00Z" class="css-m19uds">updated at 2021-04-30</time></span></div></div></div></div></div><h1 class="css-cgzq40">拡張メソッドの意義とは？</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e6%8b%a1%e5%bc%b5%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89" class="css-4czcte">拡張メソッド</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="初めに" class="fragment"></span><a href="#%E5%88%9D%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>初めに</h1>

<p>C#の拡張メソッドの存在意義が文法だけでは分かりにくいと感じ、調査を行いました。</p>

<h1>
<span id="前提条件" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><i class="fa fa-link"></i></a>前提条件</h1>

<ul>
<li>C#の文法はなんとなく把握している</li>
<li>拡張メソッドの存在は知っている</li>
</ul>

<h1>
<span id="対処したい状況" class="fragment"></span><a href="#%E5%AF%BE%E5%87%A6%E3%81%97%E3%81%9F%E3%81%84%E7%8A%B6%E6%B3%81"><i class="fa fa-link"></i></a>対処したい状況</h1>

<p><strong>端的に言うと「本来メソッドが追加できないようなクラス・インターフェイスなどにメソッドを追加したい」状況です</strong></p>

<p>「特定のデータに関連するコードが重複してしまうので、解決したい」という状況はよくあると思います。通常、特定の重複部分をメソッドへの抽出して、新しいクラスを定義することで解決ができます。<br>
しかし、コードの変更・追加ができない場合もあります。具体例をいくつか挙げます。</p>

<ul>
<li><p>サードパーティー製のコード<br>
素晴らしい機能を提供してくれるライブラリでも、自分の欲しい機能を持つメソッドだけが、不運にも提供されていないことがまれによくあります。</p></li>
<li><p>列挙型<br>
そもそもメソッドが持てません</p></li>
<li><p>インターフェイス<br>
そもそも実装を追加することができません<br>
なお、ここで想定しているのは、インターフェイスを実装するクラスの内部実装ではなく、インターフェイスに対する利用者側のコードの重複です。基本的には、インターフェイスの内部実装はクラスごとに異なります。<br>
(※<a href="https://docs.microsoft.com/ja-jp/dotnet/csharp/whats-new/tutorials/default-interface-methods-versions" rel="nofollow noopener" target="_blank">C#8.0からはインターフェイスもデフォルト実装を持てます</a>が、新しめの機能であることもあり、例えばUnityでは、<a href="https://docs.unity3d.com/ja/2020.1/Manual/CSharpCompiler.html" rel="nofollow noopener" target="_blank">Unity2020.1以前では使えない</a>など、完全な普及にはもうしばらくかかりそうです。)</p></li>
</ul>

<p>​ これらに対していつも同じような処理をしている場合には、オブジェクト指向的な解決が難しくなります。以下では、サードパーティー製のクラス<code>ThirdPartyClass</code>に、とある機能<code>DoSomething()</code>を追加したくなったという設定で、その解決策を考えます。</p>

<h1>
<span id="考えられる解決策" class="fragment"></span><a href="#%E8%80%83%E3%81%88%E3%82%89%E3%82%8C%E3%82%8B%E8%A7%A3%E6%B1%BA%E7%AD%96"><i class="fa fa-link"></i></a>考えられる解決策</h1>

<h2>
<span id="コピペ" class="fragment"></span><a href="#%E3%82%B3%E3%83%94%E3%83%9A"><i class="fa fa-link"></i></a>コピペ</h2>

<p>重複したコードを生み出す手間を省くことはできますが、重複自体をなくすことはできません。いろいろな場所で言われることですが、コピペはやめましょう。</p>

<h2>
<span id="ソースを書き換える" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E6%9B%B8%E3%81%8D%E6%8F%9B%E3%81%88%E3%82%8B"><i class="fa fa-link"></i></a>ソースを書き換える</h2>

<p>サードパーティー製のコードに独自で変更を入れるのは、不可能ではないとしても、かなり辛いことになります。そのライブラリがバージョンアップするたびに自分で書いたコードの保守も必要になるからです。また、string型に対する処理など、クラス自体の動作に変更を加えられない場合もあります。</p>

<h2>
<span id="メソッドの導入" class="fragment"></span><a href="#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E5%B0%8E%E5%85%A5"><i class="fa fa-link"></i></a>メソッドの導入</h2>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">(</span><span class="n">ThirdpartyClass</span> <span class="n">x</span><span class="p">){</span>
  <span class="err">​</span>   <span class="c1">// 直接メソッドを追加できない何らかの処理を行う</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>以上のようなコードを重複が発生しているクラスに書くことで重複を削除できます。</p>

<p>この方法だと、コードの見通しが悪くなってしまいます。</p>

<p>なぜなら、この処理が書かれているのは、<code>DoSomething()</code>で処理するデータとは別のデータに関するメソッドを集めたクラスであり、単に内部的に重複したサードパーティー製のクラスへの処理を書くには、論理的に自然な場所とは言い難いからです。</p>

<p>この問題は、別のクラスに静的メソッドを追加することで緩和できます。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ThirdPartyHealper</span><span class="p">{</span>
      <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">(</span><span class="n">ThirdpartyClass</span> <span class="n">x</span><span class="p">){</span>
         <span class="c1">// 直接メソッドを追加できない何らかの処理を行う</span>
    <span class="err">​</span>  <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<h2>
<span id="継承による拡張" class="fragment"></span><a href="#%E7%B6%99%E6%89%BF%E3%81%AB%E3%82%88%E3%82%8B%E6%8B%A1%E5%BC%B5"><i class="fa fa-link"></i></a>継承による拡張</h2>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="k">public</span> <span class="k">class</span> <span class="nc">MyClass</span> <span class="p">:</span> <span class="n">ThirdpartyClass</span><span class="p">{</span>
  <span class="err">​</span>   <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">(){</span>
  <span class="err">​</span>       <span class="c1">// 直接メソッドを追加できない何らかの処理を行う</span>
  <span class="err">​</span>   <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>問題となっているクラスを継承し、欲しい機能をメソッドとして追加することで、オブジェクト指向的に自然に機能を拡張することができます。<br>
  この方法をとる場合、既存のコードのすべてのサードパーティー製のクラス名を探して継承したものに置き換えなければならず、多少の面倒を伴います。重複が発生している部分以外に、newしている部分全てで新しいクラスのインスタンスを生成しなければならないからです。</p>

<h2>
<span id="ラッパークラスの作成" class="fragment"></span><a href="#%E3%83%A9%E3%83%83%E3%83%91%E3%83%BC%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>ラッパークラスの作成</h2>

<p>問題となっているクラスをprivateフィールドとして持ち、欲しい機能を実装したラッパーを作成することで、処理が書かれている場所を論理的に正しくできます。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="k">class</span> <span class="nc">ThirdPartyWrapper</span><span class="p">{</span>
  <span class="err">​</span>   <span class="k">private</span> <span class="n">ThirdPartyClass</span> <span class="n">wrappingObject</span><span class="p">;</span>
  <span class="err">​</span>   <span class="k">public</span> <span class="nf">ThirdPartyWrapper</span><span class="p">(</span><span class="n">ThirdPartyClass</span> <span class="n">x</span><span class="p">){</span>
  <span class="err">​</span>       <span class="n">wrappingObject</span> <span class="p">=</span> <span class="n">x</span><span class="p">;</span>
  <span class="err">​</span>   <span class="p">}</span>

  <span class="err">​</span>   <span class="c1">// 加えてThirdPartyClassの持っているすべてのpublicなフィールド・メソッドに関する同名の委譲メソッドを記述</span>

  <span class="err">​</span>   <span class="k">public</span> <span class="k">void</span> <span class="nf">ThirdPartyClassMethod</span><span class="p">(){</span>
  <span class="err">​</span>       <span class="n">wrappingObject</span><span class="p">.</span><span class="nf">ThirdPartyClassMethod</span><span class="p">();</span>
  <span class="err">​</span>   <span class="p">}</span>

  <span class="err">​</span>   <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">(){</span>
  <span class="err">​</span>       <span class="c1">// 直接メソッドを追加できない何らかの処理を行う</span>
  <span class="err">​</span>   <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>この方法では、継承によって解決した場合に比べてnewしているすべての場所を探す必要はありません。しかし、元クラスで公開されているメソッドとフィールドすべてについて、委譲するメソッドとプロパティを生成しなければならず非常に面倒です。</p>

<p>また、既存のコードをラッパーを使うように変更する必要が生まれます。</p>

<h1>
<span id="拡張メソッドの文法" class="fragment"></span><a href="#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E6%96%87%E6%B3%95"><i class="fa fa-link"></i></a>拡張メソッドの文法</h1>

<p>基本的な文法をコードで説明します。今回の記事の趣旨から外れるので詳しい説明は省きます。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// 拡張メソッドは静的クラスで宣言しなければならない</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ExtensionMethodClass</span><span class="p">{</span>
    <span class="c1">// 静的メソッドの第一引数の型の前にthisをつけると拡張メソッドになる</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ExtensionMethod</span><span class="p">(</span><span class="k">this</span> <span class="kt">int</span> <span class="n">number</span><span class="p">){</span>
    <span class="p">}</span> 

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">UseExtensionMethod</span><span class="p">(){</span>
        <span class="c1">// 次の2つの呼び出しは同じ意味になる</span>
        <span class="nf">ExtensionMethod</span><span class="p">(</span><span class="m">5</span><span class="p">);</span>
        <span class="c1">// あたかもインスタンスメソッドかのように呼び出せる</span>
        <span class="m">5.</span><span class="nf">ExtensionMethod</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h1>
<span id="拡張メソッドによる解決" class="fragment"></span><a href="#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AB%E3%82%88%E3%82%8B%E8%A7%A3%E6%B1%BA"><i class="fa fa-link"></i></a>拡張メソッドによる解決</h1>

<p>拡張メソッドは、あたかもインスタンスメソッドであるかのように静的メソッドを呼び出すことができる機能です。<br>
したがって、すでに紹介した静的メソッドによる解決を適用した後、それを拡張メソッドに書き換えるだけ解決できます。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ThirdPartyHealper</span><span class="p">{</span>
  <span class="err">​</span>   <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">(</span><span class="k">this</span> <span class="n">ThirdpartyClass</span> <span class="n">x</span><span class="p">){</span>
  <span class="err">​</span>       <span class="c1">// 直接メソッドを追加できない何らかの処理を行う</span>
  <span class="err">​</span>   <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<h1>
<span id="拡張メソッドによる解決の利点" class="fragment"></span><a href="#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AB%E3%82%88%E3%82%8B%E8%A7%A3%E6%B1%BA%E3%81%AE%E5%88%A9%E7%82%B9"><i class="fa fa-link"></i></a>拡張メソッドによる解決の利点</h1>

<h2>
<span id="既存のコードに影響がない" class="fragment"></span><a href="#%E6%97%A2%E5%AD%98%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E5%BD%B1%E9%9F%BF%E3%81%8C%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>既存のコードに影響がない</h2>

<p>ラッパーによる解決や継承による解決は自分の今まで書いたコードに変更を加えてしまいます。<br>
  対して拡張メソッドは、既存のコードに変更を加えずとも、重複が発生している部分だけを改善すれば十分です。</p>

<h2>
<span id="拡張が簡単" class="fragment"></span><a href="#%E6%8B%A1%E5%BC%B5%E3%81%8C%E7%B0%A1%E5%8D%98"><i class="fa fa-link"></i></a>拡張が簡単</h2>

<p>ラッパーによる解決はラッパー自体の作成による手間が多く、書くのが面倒ですが、拡張メソッドの場合は本質的なロジック以外のコードは最小限に抑えられています。</p>

<h2>
<span id="メソッドチェーンが可能になる" class="fragment"></span><a href="#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%83%81%E3%82%A7%E3%83%BC%E3%83%B3%E3%81%8C%E5%8F%AF%E8%83%BD%E3%81%AB%E3%81%AA%E3%82%8B"><i class="fa fa-link"></i></a>メソッドチェーンが可能になる</h2>

<p>これは拡張メソッドが静的メソッドによる解決よりも優れている点です。C#において拡張メソッドが使われている代表的な存在であるLINQでは、以下のようなメソッドチェーンが書けるように定義されており、処理の流れが分かりやすくなります。<code>Sum()</code>や<code>Select()</code>は、「<code>IEnumerable</code>インターフェースに対していつも同様の処理をしていることが多いのに、インターフェースにコードが書けない」という、まさに今回の記事の課題を解決するものになります。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="n">intArray</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="m">2</span> <span class="p">*</span> <span class="n">x</span> <span class="p">+</span> <span class="m">5</span><span class="p">).</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">).</span><span class="nf">Sum</span><span class="p">();</span>
</code></pre></div></div>

<p>これを静的メソッドで行うと以下のようになり、かっこの対応が非常に読みにくいです。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="nf">Sum</span><span class="p">(</span><span class="nf">Where</span><span class="p">(</span><span class="nf">Select</span><span class="p">(</span><span class="n">intArray</span><span class="p">,</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="m">2</span> <span class="p">*</span> <span class="n">x</span> <span class="p">+</span> <span class="m">5</span><span class="p">),</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">));</span>
</code></pre></div></div>

<h2>
<span id="利用者は静的クラスのことを気にせずにコードを書ける" class="fragment"></span><a href="#%E5%88%A9%E7%94%A8%E8%80%85%E3%81%AF%E9%9D%99%E7%9A%84%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E3%81%93%E3%81%A8%E3%82%92%E6%B0%97%E3%81%AB%E3%81%9B%E3%81%9A%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%91%E3%82%8B"><i class="fa fa-link"></i></a>利用者は静的クラスのことを気にせずにコードを書ける</h2>

<p>利用者からすると、静的メソッドによる解決をした場合、どうしても<code>ThirdPartyHealper</code>などといった本来知らなくていいクラスにアクセスしなければなりません。しかし、拡張メソッドを使えば、(<code>using</code>などの必要はあるにせよ、ロジックを書く段階では)拡張メソッドがどこで定義されているかわからなくとも特定の機能を使うことができます。</p>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<p>拡張メソッドは、その名前の通り、「本来プログラマが変更することが難しいクラスに、あたかもインスタンスメソッドを追加したような拡張をする」機能だと言えます。</p>

<h2>
<span id="蛇足可読性の向上" class="fragment"></span><a href="#%E8%9B%87%E8%B6%B3%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A"><i class="fa fa-link"></i></a>蛇足：可読性の向上</h2>

<p>これは今回の趣旨である、重複するコードの排除からは外れるかもしれませんが、単純なfor文に対して拡張メソッドを適用することで、以下のようなコードも書くことができ、可読性の向上に貢献します。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code>  <span class="m">5.</span><span class="nf">Times</span><span class="p">(()=&gt;{</span>
  <span class="err">​</span>   <span class="c1">// 5回繰り返したい処理を書く</span>
  <span class="p">});</span>

  <span class="m">1.U</span><span class="nf">pto</span><span class="p">(</span><span class="m">3</span><span class="p">,(</span><span class="n">i</span><span class="p">)=&gt;{</span>
  <span class="err">​</span>   <span class="c1">// ループを3回おこない、ループごとにiに1から3が代入される</span>
  <span class="p">});</span>
</code></pre></div></div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fwolfmagnate%2Fitems%2F84ba30fb9970e01b1d2d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fwolfmagnate%2Fitems%2F84ba30fb9970e01b1d2d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/likers" class="css-1iupg5d">2</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">1</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/84ba30fb9970e01b1d2d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/wolfmagnate/items/84ba30fb9970e01b1d2d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-9cd47709-3c1b-415c-9cb7-249f4bad24a4">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-9ab6de8b-02f9-4d5e-9f33-5e5c0620da46"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-9ab6de8b-02f9-4d5e-9f33-5e5c0620da46">{}</script>
      
<div id="LoginModal-react-component-37aedcd7-febc-4ce1-aca0-068d472e815f"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-37aedcd7-febc-4ce1-aca0-068d472e815f">{}</script>
      
<div id="StockModal-react-component-78ee08a4-d8c9-4350-82d7-6537671688ce"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-78ee08a4-d8c9-4350-82d7-6537671688ce">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;ZlYTYlzrph5Sjhm8LphZPg68Yp2kCe9Sh5S23Q4oqYdn6sqPMPf7tTTrSEYsjlYYStxqfme4zSqFCbPpasIT6A==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"初めに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%9D%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e初めに\u003c/h1\u003e\n\n\u003cp\u003eC#の拡張メソッドの存在意義が文法だけでは分かりにくいと感じ、調査を行いました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前提条件\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提条件\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eC#の文法はなんとなく把握している\u003c/li\u003e\n\u003cli\u003e拡張メソッドの存在は知っている\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"対処したい状況\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AF%BE%E5%87%A6%E3%81%97%E3%81%9F%E3%81%84%E7%8A%B6%E6%B3%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e対処したい状況\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003e端的に言うと「本来メソッドが追加できないようなクラス・インターフェイスなどにメソッドを追加したい」状況です\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e「特定のデータに関連するコードが重複してしまうので、解決したい」という状況はよくあると思います。通常、特定の重複部分をメソッドへの抽出して、新しいクラスを定義することで解決ができます。\u003cbr\u003e\nしかし、コードの変更・追加ができない場合もあります。具体例をいくつか挙げます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eサードパーティー製のコード\u003cbr\u003e\n素晴らしい機能を提供してくれるライブラリでも、自分の欲しい機能を持つメソッドだけが、不運にも提供されていないことがまれによくあります。\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e列挙型\u003cbr\u003e\nそもそもメソッドが持てません\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eインターフェイス\u003cbr\u003e\nそもそも実装を追加することができません\u003cbr\u003e\nなお、ここで想定しているのは、インターフェイスを実装するクラスの内部実装ではなく、インターフェイスに対する利用者側のコードの重複です。基本的には、インターフェイスの内部実装はクラスごとに異なります。\u003cbr\u003e\n(※\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/csharp/whats-new/tutorials/default-interface-methods-versions\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC#8.0からはインターフェイスもデフォルト実装を持てます\u003c/a\u003eが、新しめの機能であることもあり、例えばUnityでは、\u003ca href=\"https://docs.unity3d.com/ja/2020.1/Manual/CSharpCompiler.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnity2020.1以前では使えない\u003c/a\u003eなど、完全な普及にはもうしばらくかかりそうです。)\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e​ これらに対していつも同じような処理をしている場合には、オブジェクト指向的な解決が難しくなります。以下では、サードパーティー製のクラス\u003ccode\u003eThirdPartyClass\u003c/code\u003eに、とある機能\u003ccode\u003eDoSomething()\u003c/code\u003eを追加したくなったという設定で、その解決策を考えます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"考えられる解決策\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%80%83%E3%81%88%E3%82%89%E3%82%8C%E3%82%8B%E8%A7%A3%E6%B1%BA%E7%AD%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e考えられる解決策\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コピペ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%94%E3%83%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコピペ\u003c/h2\u003e\n\n\u003cp\u003e重複したコードを生み出す手間を省くことはできますが、重複自体をなくすことはできません。いろいろな場所で言われることですが、コピペはやめましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ソースを書き換える\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E6%9B%B8%E3%81%8D%E6%8F%9B%E3%81%88%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースを書き換える\u003c/h2\u003e\n\n\u003cp\u003eサードパーティー製のコードに独自で変更を入れるのは、不可能ではないとしても、かなり辛いことになります。そのライブラリがバージョンアップするたびに自分で書いたコードの保守も必要になるからです。また、string型に対する処理など、クラス自体の動作に変更を加えられない場合もあります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"メソッドの導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメソッドの導入\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eThirdpartyClass\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"c1\"\u003e// 直接メソッドを追加できない何らかの処理を行う\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e以上のようなコードを重複が発生しているクラスに書くことで重複を削除できます。\u003c/p\u003e\n\n\u003cp\u003eこの方法だと、コードの見通しが悪くなってしまいます。\u003c/p\u003e\n\n\u003cp\u003eなぜなら、この処理が書かれているのは、\u003ccode\u003eDoSomething()\u003c/code\u003eで処理するデータとは別のデータに関するメソッドを集めたクラスであり、単に内部的に重複したサードパーティー製のクラスへの処理を書くには、論理的に自然な場所とは言い難いからです。\u003c/p\u003e\n\n\u003cp\u003eこの問題は、別のクラスに静的メソッドを追加することで緩和できます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eThirdPartyHealper\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eThirdpartyClass\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e// 直接メソッドを追加できない何らかの処理を行う\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e​\u003c/span\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"継承による拡張\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B6%99%E6%89%BF%E3%81%AB%E3%82%88%E3%82%8B%E6%8B%A1%E5%BC%B5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e継承による拡張\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyClass\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThirdpartyClass\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e       \u003cspan class=\"c1\"\u003e// 直接メソッドを追加できない何らかの処理を行う\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e問題となっているクラスを継承し、欲しい機能をメソッドとして追加することで、オブジェクト指向的に自然に機能を拡張することができます。\u003cbr\u003e\n  この方法をとる場合、既存のコードのすべてのサードパーティー製のクラス名を探して継承したものに置き換えなければならず、多少の面倒を伴います。重複が発生している部分以外に、newしている部分全てで新しいクラスのインスタンスを生成しなければならないからです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ラッパークラスの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A9%E3%83%83%E3%83%91%E3%83%BC%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eラッパークラスの作成\u003c/h2\u003e\n\n\u003cp\u003e問題となっているクラスをprivateフィールドとして持ち、欲しい機能を実装したラッパーを作成することで、処理が書かれている場所を論理的に正しくできます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eThirdPartyWrapper\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eThirdPartyClass\u003c/span\u003e \u003cspan class=\"n\"\u003ewrappingObject\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eThirdPartyWrapper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eThirdPartyClass\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e       \u003cspan class=\"n\"\u003ewrappingObject\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"c1\"\u003e// 加えてThirdPartyClassの持っているすべてのpublicなフィールド・メソッドに関する同名の委譲メソッドを記述\u003c/span\u003e\n\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eThirdPartyClassMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e       \u003cspan class=\"n\"\u003ewrappingObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eThirdPartyClassMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e       \u003cspan class=\"c1\"\u003e// 直接メソッドを追加できない何らかの処理を行う\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこの方法では、継承によって解決した場合に比べてnewしているすべての場所を探す必要はありません。しかし、元クラスで公開されているメソッドとフィールドすべてについて、委譲するメソッドとプロパティを生成しなければならず非常に面倒です。\u003c/p\u003e\n\n\u003cp\u003eまた、既存のコードをラッパーを使うように変更する必要が生まれます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"拡張メソッドの文法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E6%96%87%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e拡張メソッドの文法\u003c/h1\u003e\n\n\u003cp\u003e基本的な文法をコードで説明します。今回の記事の趣旨から外れるので詳しい説明は省きます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 拡張メソッドは静的クラスで宣言しなければならない\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExtensionMethodClass\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 静的メソッドの第一引数の型の前にthisをつけると拡張メソッドになる\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eExtensionMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enumber\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eUseExtensionMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 次の2つの呼び出しは同じ意味になる\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eExtensionMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// あたかもインスタンスメソッドかのように呼び出せる\u003c/span\u003e\n        \u003cspan class=\"m\"\u003e5.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExtensionMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"拡張メソッドによる解決\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AB%E3%82%88%E3%82%8B%E8%A7%A3%E6%B1%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e拡張メソッドによる解決\u003c/h1\u003e\n\n\u003cp\u003e拡張メソッドは、あたかもインスタンスメソッドであるかのように静的メソッドを呼び出すことができる機能です。\u003cbr\u003e\nしたがって、すでに紹介した静的メソッドによる解決を適用した後、それを拡張メソッドに書き換えるだけ解決できます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eThirdPartyHealper\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"n\"\u003eThirdpartyClass\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e       \u003cspan class=\"c1\"\u003e// 直接メソッドを追加できない何らかの処理を行う\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"拡張メソッドによる解決の利点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AB%E3%82%88%E3%82%8B%E8%A7%A3%E6%B1%BA%E3%81%AE%E5%88%A9%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e拡張メソッドによる解決の利点\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"既存のコードに影響がない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%97%A2%E5%AD%98%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E5%BD%B1%E9%9F%BF%E3%81%8C%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e既存のコードに影響がない\u003c/h2\u003e\n\n\u003cp\u003eラッパーによる解決や継承による解決は自分の今まで書いたコードに変更を加えてしまいます。\u003cbr\u003e\n  対して拡張メソッドは、既存のコードに変更を加えずとも、重複が発生している部分だけを改善すれば十分です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"拡張が簡単\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%81%8C%E7%B0%A1%E5%8D%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e拡張が簡単\u003c/h2\u003e\n\n\u003cp\u003eラッパーによる解決はラッパー自体の作成による手間が多く、書くのが面倒ですが、拡張メソッドの場合は本質的なロジック以外のコードは最小限に抑えられています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"メソッドチェーンが可能になる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%83%81%E3%82%A7%E3%83%BC%E3%83%B3%E3%81%8C%E5%8F%AF%E8%83%BD%E3%81%AB%E3%81%AA%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメソッドチェーンが可能になる\u003c/h2\u003e\n\n\u003cp\u003eこれは拡張メソッドが静的メソッドによる解決よりも優れている点です。C#において拡張メソッドが使われている代表的な存在であるLINQでは、以下のようなメソッドチェーンが書けるように定義されており、処理の流れが分かりやすくなります。\u003ccode\u003eSum()\u003c/code\u003eや\u003ccode\u003eSelect()\u003c/code\u003eは、「\u003ccode\u003eIEnumerable\u003c/code\u003eインターフェースに対していつも同様の処理をしていることが多いのに、インターフェースにコードが書けない」という、まさに今回の記事の課題を解決するものになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"n\"\u003eintArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSum\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれを静的メソッドで行うと以下のようになり、かっこの対応が非常に読みにくいです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"nf\"\u003eSum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eintArray\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"利用者は静的クラスのことを気にせずにコードを書ける\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%A9%E7%94%A8%E8%80%85%E3%81%AF%E9%9D%99%E7%9A%84%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E3%81%93%E3%81%A8%E3%82%92%E6%B0%97%E3%81%AB%E3%81%9B%E3%81%9A%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%91%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e利用者は静的クラスのことを気にせずにコードを書ける\u003c/h2\u003e\n\n\u003cp\u003e利用者からすると、静的メソッドによる解決をした場合、どうしても\u003ccode\u003eThirdPartyHealper\u003c/code\u003eなどといった本来知らなくていいクラスにアクセスしなければなりません。しかし、拡張メソッドを使えば、(\u003ccode\u003eusing\u003c/code\u003eなどの必要はあるにせよ、ロジックを書く段階では)拡張メソッドがどこで定義されているかわからなくとも特定の機能を使うことができます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003e拡張メソッドは、その名前の通り、「本来プログラマが変更することが難しいクラスに、あたかもインスタンスメソッドを追加したような拡張をする」機能だと言えます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"蛇足可読性の向上\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%9B%87%E8%B6%B3%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e蛇足：可読性の向上\u003c/h2\u003e\n\n\u003cp\u003eこれは今回の趣旨である、重複するコードの排除からは外れるかもしれませんが、単純なfor文に対して拡張メソッドを適用することで、以下のようなコードも書くことができ、可読性の向上に貢献します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"m\"\u003e5.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTimes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()=\u0026gt;{\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"c1\"\u003e// 5回繰り返したい処理を書く\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n  \u003cspan class=\"m\"\u003e1.U\u003c/span\u003e\u003cspan class=\"nf\"\u003epto\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)=\u0026gt;{\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e​\u003c/span\u003e   \u003cspan class=\"c1\"\u003e// ループを3回おこない、ループごとにiに1から3が代入される\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n","createdAt":"2021-04-29T10:42:24Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"2ZfWlMJJsV/Qgbrx9YTVHMhcr8gV09M+vA==--BZn3IBbXNx0T5hKw--82rN4oEHNPTx+SHPOMp6BQ==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2021-04-30T00:42:00Z","likesCount":2,"linkUrl":"https://qiita.com/wolfmagnate/items/84ba30fb9970e01b1d2d","organization":null,"originalId":1427928,"stockedCount":1,"title":"拡張メソッドの意義とは？","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%9D%E3%82%81%E3%81%AB\"\u003e初めに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\"\u003e前提条件\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AF%BE%E5%87%A6%E3%81%97%E3%81%9F%E3%81%84%E7%8A%B6%E6%B3%81\"\u003e対処したい状況\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%80%83%E3%81%88%E3%82%89%E3%82%8C%E3%82%8B%E8%A7%A3%E6%B1%BA%E7%AD%96\"\u003e考えられる解決策\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%94%E3%83%9A\"\u003eコピペ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E6%9B%B8%E3%81%8D%E6%8F%9B%E3%81%88%E3%82%8B\"\u003eソースを書き換える\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003eメソッドの導入\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B6%99%E6%89%BF%E3%81%AB%E3%82%88%E3%82%8B%E6%8B%A1%E5%BC%B5\"\u003e継承による拡張\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A9%E3%83%83%E3%83%91%E3%83%BC%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E4%BD%9C%E6%88%90\"\u003eラッパークラスの作成\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E6%96%87%E6%B3%95\"\u003e拡張メソッドの文法\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AB%E3%82%88%E3%82%8B%E8%A7%A3%E6%B1%BA\"\u003e拡張メソッドによる解決\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AB%E3%82%88%E3%82%8B%E8%A7%A3%E6%B1%BA%E3%81%AE%E5%88%A9%E7%82%B9\"\u003e拡張メソッドによる解決の利点\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%97%A2%E5%AD%98%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E5%BD%B1%E9%9F%BF%E3%81%8C%E3%81%AA%E3%81%84\"\u003e既存のコードに影響がない\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%81%8C%E7%B0%A1%E5%8D%98\"\u003e拡張が簡単\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%83%81%E3%82%A7%E3%83%BC%E3%83%B3%E3%81%8C%E5%8F%AF%E8%83%BD%E3%81%AB%E3%81%AA%E3%82%8B\"\u003eメソッドチェーンが可能になる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%A9%E7%94%A8%E8%80%85%E3%81%AF%E9%9D%99%E7%9A%84%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E3%81%93%E3%81%A8%E3%82%92%E6%B0%97%E3%81%AB%E3%81%9B%E3%81%9A%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%91%E3%82%8B\"\u003e利用者は静的クラスのことを気にせずにコードを書ける\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%9B%87%E8%B6%B3%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003e蛇足：可読性の向上\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":536,"uuid":"84ba30fb9970e01b1d2d","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"Gn3Sdlu+xMJYxQ1cTVe/FuHYDmumHQ==--NColOJZ2Orlu8431--tT+kNiOixRX8FKNxUP4qpQ==","originalId":1412657,"description":"C#が好きな情報系大学生\r\n進捗を出したい","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":false,"linkedinUrl":null,"name":"ゼミ 進捗","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/1412657/b86b047218e8eb5ce571eca486a5287129fa372d/x_large.png?1619693305","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F1412657%2Fb86b047218e8eb5ce571eca486a5287129fa372d%2Fx_large.png%3F1619693305?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=82e6f26e696a27ece813775abcd2f289","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F1412657%2Fb86b047218e8eb5ce571eca486a5287129fa372d%2Fx_large.png%3F1619693305?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=22c18e84755a0574722fcce4006a5472","urlName":"wolfmagnate","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"拡張メソッド","urlName":"%e6%8b%a1%e5%bc%b5%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
