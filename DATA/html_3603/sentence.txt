More than 1 year has passed since last update.System.Xml.Linq.XDocument クラスの内容をプロパティグリッドに表示する。
　↑ この XML を ↓ このように表示
XML の階層構造をプロパティグリッドにそのまま表示するように、カスタム型コンバーターを作成してみる。System.Windows.Forms.PropertyGrid コントロールを使うとクラスのインスタンスを簡単に表示・編集できる。表示内容は属性指定でカスタマイズ可能で、主な属性は下記⇒ 型コンバーターを自作することでプロパティグリッドに表示する内容をカスタマイズできる。XML は System.Xml.Linq.XDocument クラスで扱うこととする。XML 要素と属性の名前などを取得する用に、XObject の拡張メソッドを用意しておく。System.ComponentModel.TypeConverter から派生したクラスを作成することで、プロパティグリッドに表示する項目を自由に指定できる。TypeConverter クラスを継承して XmlConverter クラスを作成する。SimplePropertyDescriptor クラスを継承して内部クラスを作成する。
このクラスが、プロパティグリッドの１項目に相当XmlPropertyDescriptor のインスタンスを作成するメソッドを実装する。プロパティグリッドへの表示項目を列挙するメソッドをオーバーライドする。TypeConverterAttribute 属性で、使用するコンバーターを指定する。


