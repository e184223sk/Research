More than 1 year has passed since last update.配列の要素を一つずつ処理するときにindexも欲しくなること、ありませんか？従来であればこのような配列に対して、のようにfor文を使用するか、のように匿名クラスを使う方法がありました。前者はちょっとめんどくさいですし、後者は匿名クラスを使うのでアロケーションが気になります。C# 7.0から使える値タプル(ValueTuple)と分解(Deconstruction)を使用すれば以下のようになります。まるで別言語のような書き方ですがとてもシンプルになりました
余分な変数を作ってしまわないのもいい感じです注意点として、パフォーマンスを追い求めるなら最初のfor文を使用する方法が一番良いです。
これは配列の範囲チェックやそもそもSelectを行った時点でクラスがアロケートされてしまうからです。
配列の場合は匿名クラスを使うよりかは幾分ましですし、もともと添字でアクセスできないようなIEnumerableに対してはなかなかいい方法なんじゃないかと思います。


