<!DOCTYPE html><html><head><meta charset="utf-8" /><title>引数の型を何でも List にしちゃう奴にそろそろ一言いっておくか - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/lobin-z0x50/items/248db6d0629c7abe47dd" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="qO4/OIYiupDVxNdOhE3z65NIqF7dzdUaald1DtL/Fi2H7hgIwVq7sz0hDrn4BnaHduLnLrQmIEW3eEBUgRBvwQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="引数の型を何でも List にしちゃう奴にそろそろ一言いっておくか - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01YnlWNXBXdzQ0R3U1WjZMNDRLUzVMMlY0NEduNDRLQ0lFeHBjM1FnNDRHcjQ0R1g0NEdoNDRLRDQ0R0c1YVcwNDRHcjQ0R2Q0NEtONDRHZDQ0S041TGlBNktpQTQ0R0U0NEdqNDRHbTQ0R0s0NEdQNDRHTCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz01ZWQyY2I3NTI3OTU4NjMyZmQzZDgzMGYwNGY3MGE0Yg&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3h2WW1sdUxYb3dlRFV3JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZDA5YzgwM2I4YjJmNDEwYjFjODMzOWRhZjlkNmVmOTc&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=6d3294871508f8978dfa6834c4c09098"><meta property="og:description" content="この記事は C# その２ Advent Calendar 2018 の第一日の記事である。


はじめに

この記事では、主にエンタープライズアプリケーション（SI、企業向けの業務システムやパッケージ製品）の開発に於いて、新規開発では..."><meta content="https://qiita.com/lobin-z0x50/items/248db6d0629c7abe47dd" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,.NET,リスト,メソッド,シグネチャ" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-2cebcd4b-7b0c-463d-912a-d62f6f524bcf"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Flobin-z0x50%2Fitems%2F248db6d0629c7abe47dd">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Flobin-z0x50%2Fitems%2F248db6d0629c7abe47dd">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-2cebcd4b-7b0c-463d-912a-d62f6f524bcf">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-11-30T21:19:12.000+09:00","dateModified":"2020-09-18T15:05:43.000+09:00","headline":"引数の型を何でも List にしちゃう奴にそろそろ一言いっておくか","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01YnlWNXBXdzQ0R3U1WjZMNDRLUzVMMlY0NEduNDRLQ0lFeHBjM1FnNDRHcjQ0R1g0NEdoNDRLRDQ0R0c1YVcwNDRHcjQ0R2Q0NEtONDRHZDQ0S041TGlBNktpQTQ0R0U0NEdqNDRHbTQ0R0s0NEdQNDRHTCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz01ZWQyY2I3NTI3OTU4NjMyZmQzZDgzMGYwNGY3MGE0Yg\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3h2WW1sdUxYb3dlRFV3JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZDA5YzgwM2I4YjJmNDEwYjFjODMzOWRhZjlkNmVmOTc\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=6d3294871508f8978dfa6834c4c09098","mainEntityOfPage":"https://qiita.com/lobin-z0x50/items/248db6d0629c7abe47dd","author":{"@type":"Person","address":"兵庫県明石市","email":"lobin.z0x50@gmail.com","identifier":"lobin-z0x50","name":"lobin-z0x50","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F11419109%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=855c34f5fdd094abe9b5241d0799cde7","url":"https://qiita.com/lobin-z0x50","description":"株式会社ネオジニア 代表取締役、ITアーキテクト。\r\n大阪府岸和田市出身。\r\n組み込み開発から業務システム、スマホアプリ、Webまで幅広く開発プロジェクトに従事し、2012年に独立。\r\n従来型のSI開発に限界を感じ、変更に強いソフトウェアを日々研究し、SI業界の改革を夢見ている。\r\nいろんな言語を使うが、メインは Ruby と C#。","memberOf":[{"@type":"Organization","address":"大阪市浪速区元町1-9-9 津和九ビル7F","legalName":"株式会社ネオジニア","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/16459a59510f0e07fd263bcf4865d0ec31859b81/original.jpg?1596812707","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/90bb8133c41e36c124364b7566b728fc85e44e2f/original.jpg?1596812707","identifier":"neogenia","description":"大阪のシステム開発会社です！"}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"lobin-z0x50","type":"items","id":"248db6d0629c7abe47dd"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"lobin-z0x50","type":"items","id":"248db6d0629c7abe47dd"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"lobin-z0x50","type":"items","id":"248db6d0629c7abe47dd"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/lobin-z0x50/items/248db6d0629c7abe47dd","location":"/lobin-z0x50/items/248db6d0629c7abe47dd","scheme":"https","host":"qiita.com","port":null,"pathname":"/lobin-z0x50/items/248db6d0629c7abe47dd","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"bwUcgw+SpS2mBF2yXGtbeL7sWBJ2flvx7rBwr4fYL1NABTuzSOqkDk7hhEUgIN4UW0YXYh+Vrq4zn0X11DdWvw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-8bf35a71-d29c-421b-853d-a304f6c3632a"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/likers" class="css-1iupg5d">724</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">639</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/248db6d0629c7abe47dd/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/lobin-z0x50/items/248db6d0629c7abe47dd.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2018/c-sharp-2" class="it-AdcalRibbon_title">C# その2 <!-- --> Advent Calendar<!-- --> <!-- -->2018</a>Day 1</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/lobin-z0x50"><img class="css-100alwu eyfquo10" src="https://avatars0.githubusercontent.com/u/11419109?v=4" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/lobin-z0x50" class="css-10ougpm">@<!-- -->lobin-z0x50</a><div class="css-1ay9vb9"><span><meta content="2018-11-30T12:19:12Z"/><time dateTime="2020-09-18T06:05:43Z" class="css-m19uds">updated at 2020-09-18</time></span></div></div></div></div></div><h1 class="css-cgzq40">引数の型を何でも List にしちゃう奴にそろそろ一言いっておくか</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/.net" class="css-4czcte">.NET</a><a href="/tags/%e3%83%aa%e3%82%b9%e3%83%88" class="css-4czcte">リスト</a><a href="/tags/%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89" class="css-4czcte">メソッド</a><a href="/tags/%e3%82%b7%e3%82%b0%e3%83%8d%e3%83%81%e3%83%a3" class="css-4czcte">シグネチャ</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>この記事は <a href="https://qiita.com/advent-calendar/2018/c-sharp-2">C# その２ Advent Calendar 2018</a> の第一日の記事である。</p>

<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>この記事では、主にエンタープライズアプリケーション（SI、企業向けの業務システムやパッケージ製品）の開発に於いて、新規開発ではなく修正や拡張を行うようなシーンを想定して、無駄な工数をなるべく削減すべく自分なりに考えて実践しているベストプラクティスを書いている。</p>

<p>新規開発の場合でも、将来の拡張や修正が見込まれるはずなので、考慮すべき事は同じだ。</p>

<p>競技プログラミングや、組み込み開発の場合でも基本的な考え方は適用可能だが、メモリ効率やパフォーマンスを考慮する必要もあるので、あえて配列を使ったり、逸脱するようなケースもあるだろう。</p>

<p>対象とする読者層は、C#プログラミング歴1年以上、SIer やユーザー企業に所属（もしくは常駐）し、特に複数人チームでの開発に携わる若手プログラマ、初級から中級へのステップアップ中の人、といったところ。要は、俗に言う"IT土方"。</p>

<p>対象としている .NET のバージョンは 4.5 以降である。もちろん .NET Core も対象だ。</p>

<p>さて、前置きはこの辺にして、さっそく始めよう。</p>

<h2>
<span id="例示" class="fragment"></span><a href="#%E4%BE%8B%E7%A4%BA"><i class="fa fa-link"></i></a>例示</h2>

<h3>
<span id="その１" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%EF%BC%91"><i class="fa fa-link"></i></a>その１</h3>

<p>まず最初に、このコードを見てくれ。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="nf">RemoveUnnecessary</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">entities</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;();</span>
    <span class="c1">// 省略(500行ぐらいある)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>何もおかしいところはなさそうだと思うだろう。</p>

<p>だがこういう一見何事もなさそうなところに、実は問題があることを伝えたい。</p>

<p>ハッキリ言って、このメソッドの宣言はダメだ。</p>

<p>これだけを見て、このメソッドが一体どんな挙動をするのか想像がつくだろうか？</p>

<p>メソッドの名前によると、何やら不要な物を削除してくれそうな事は想像できるが、問題は、 <strong>引数で渡したリストが直接変更されるのか、それとも変更されないのか</strong> どうか完全には分からないことだ。</p>

<p>メソッドコメントが書いてあればそれを読めばいいのだが、このようなコードが散見されるコードベース（ソースコードの基盤のこと）では、往々にして役に立たないコメントであるか、またはコメントが無いケースも少なくない。</p>

<p>なので、結局メソッドの実装コードを読まないといけない。<br>
それでまた余計な時間がかかる。</p>

<p>アカン。効率悪すぎ。</p>

<p>ならば、こうならどうか。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="nf">RemoveUnnecessary</span><span class="p">(</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">entities</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;();</span>
    <span class="c1">// 省略(500行ぐらいある)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>引数の型が <code>IReadOnlyCollection&lt;Entity&gt;</code> に変わっている。</p>

<p>「IReadonlyCollection って初めて聞いたな」って人もいるかもしれない。<br>
そういう人は、この機会にぜひ覚えて欲しい。<br>
要は、リードオンリーなコレクションってことだ（.NET 4.5 から導入された）。</p>

<p>ここからわかる事は、<strong>引数にリストを渡した場合でも、メソッド内で変更（<code>Add</code>, <code>Remove</code>）される事はない</strong>、って事だ。それ以上でもそれ以下でもないが、それが僕らプログラマにはとても大きな手がかりになる。</p>

<p>メソッドの実装を読むまでもなく、安心してリストを渡せるわけだ。</p>

<p>このように、<strong>引数の意味</strong>を考えて欲しい。</p>

<p>では次に、こういうのはどうか？</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="k">void</span> <span class="nf">RemoveUnnecessary</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">items</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;();</span>
    <span class="c1">// 省略(500行ぐらいある)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>この場合は戻り値がないので、引数で渡したリストが変更されそうなことは明らかだ。</p>

<p>どちらの実装がよいかという議論ももちろん重要なんだが、ここではそれは置いといて、注目すべきは <strong>メソッドシグネチャ（引数と戻り値の型定義のこと）を見るだけで、そのメソッドがどの様な振る舞いをするのか分かる</strong> ようにプログラムを書け、ということだ。</p>

<p>実はこういう事がとっても大切なんだ。</p>

<p>プログラムなんて、動けば何でもいいってわけじゃない。<br>
ソフトウェアは、ハードウェアと違って簡単に修正できるのがいいところであり、OSにしてもスマホアプリにしても日々新しいバージョンがリリースされ、アップデートされ続けていっている。</p>

<p><strong>プログラムは修正しやすいように書くべき</strong>なんだ。</p>

<p>メソッドの実装を読まないと分からないような書き方は悪だ。極悪だ。我々の貴重な工数を浪費し、残業時間を増大させ、体力と精神力を消耗してしまって、その果てに幸福が待っているはずなど皆無なのである。</p>

<h3>
<span id="その２" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%EF%BC%92"><i class="fa fa-link"></i></a>その２</h3>

<p>話を元に戻そう。次はプロパティについての型の例を見てみよう。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="k">class</span> <span class="nc">MyQueryResult</span> <span class="p">{</span>
    <span class="c1">// クエリ結果</span>
    <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">Items</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// コンストラクタ</span>
    <span class="k">public</span> <span class="nf">MyQueryResult</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// 省略</span>
    <span class="p">}</span>

    <span class="c1">// 他にもメソッドがいっぱいある</span>

<span class="p">}</span>
</code></pre></div></div>

<p>さて、この <code>MyQueryResult</code> クラスも恐ろしい実装になっている。</p>

<p>何が恐ろしいのか、考えてみてほしい。</p>

<p><code>Items</code> の型が <code>List&lt;T&gt;</code> なので当然 <code>Add</code> したり <code>Remove</code> したり出来てしまう。そんなことをすると、クエリーの結果が改ざんされてしまうことになり、そのようなことが起こることを予期していない他の開発者のコードでバグ（というか予期しない動作）が多発するだろう。</p>

<p>いくら、コーディングルールや、チーム内の暗黙知として、「Itemsを変更するな」といった取り決めがあったとしても、実際に変更可能な実装になっている限り、不安は付きまとう。</p>

<p>人間はミスをする。</p>

<p><code>Items</code> を取得して、ローカル変数に代入したり色んなメソッドに引き渡したりしているうちに、どこかでうっかり変更してしまっていることだって十分考えられる。</p>

<p>故意ではなく、無意識のうちに変更してしまうのである。<br>
対処するには、そういった取り決めを決めるよりも、そもそも変更することが出来ないような実装にしてしまうべきだ。</p>

<p>こんな感じだ。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="k">class</span> <span class="nc">MyQueryResult</span> <span class="p">{</span>
    <span class="c1">// クエリ結果</span>
    <span class="k">public</span> <span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">Items</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>   <span class="c1">// 変更不可</span>

    <span class="c1">// コンストラクタ</span>
    <span class="k">public</span> <span class="nf">MyQueryResult</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// 省略</span>
    <span class="p">}</span>

    <span class="c1">// 他にもメソッドがいっぱいある</span>

<span class="p">}</span>
</code></pre></div></div>

<p><code>Items</code> の型が <code>IReadOnlyList&lt;Entity&gt;</code> に変わっている。<br>
これも先ほどの <code>IReadOnlyCollection</code> の仲間で、リードオンリーなリストってわけだ。</p>

<p>これで、<code>Items</code> に対して外部から変更（<code>Add</code>、<code>Remove</code>など）を行う事は出来なくなる。<br>
とんでもない安心感である。</p>

<p>面倒なルールも必要ない。</p>

<p>ところで、勘の良い人は気づいたかもしれないが、コンストラクタの型も <code>IReadOnlyList&lt;Entity&gt;</code> に変えてしまっても良いかも知れない。<br>
理由は先述の通りだ。</p>

<p>こういうセンスを磨いていってほしい。</p>

<h3>
<span id="その３" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%EF%BC%93"><i class="fa fa-link"></i></a>その３</h3>

<p>次にもう少し複雑な例を見てみよう。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="nf">MergeAndUnique</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">source1</span><span class="p">,</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">source2</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 省略(3000行ぐらいある)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>さて、このメソッドはどういう挙動をしそうだろうか。</p>

<p>名前が Merge and Unique なので、<code>source1</code> と <code>source2</code> を混ぜ合わせ、重複排除する、と言ったところか。しかしながらあくまで推測でしかない。</p>

<p>ここまで来たら何が問題なのかわかると思うが、すなわち、 <code>source1</code> と <code>source2</code> が変更されない保証が無い。<br>
もしかしたら <code>source1</code> と <code>source2</code> に対しても重複排除を行うのかもしれない。</p>

<p>では、こうならどうか。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">List</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="nf">MergeAndUnique</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">source1</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Entity</span><span class="p">&gt;</span> <span class="n">source2</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 省略(3000行ぐらいある)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>引数の型が <code>IEnumerable&lt;Entity&gt;</code> に変わっている。</p>

<p>この型は知っている人がほとんどだと思うが、ざっくり言うと <code>foreach</code> で繰り返しをするためのイテレータを表す型だ。<br>
もちろん <code>Add</code> や <code>Remove</code> をすることはできない。</p>

<p>これで、引数に渡したリストが変更されることはない事が保証されるようになった。</p>

<p>それだけでなく、ちょっとハイレベルな見方をするならば、遅延評価を受け入れ可能ということが推察できるのだ（後述）。</p>

<h2>
<span id="チーム開発を行う上で大事なこと" class="fragment"></span><a href="#%E3%83%81%E3%83%BC%E3%83%A0%E9%96%8B%E7%99%BA%E3%82%92%E8%A1%8C%E3%81%86%E4%B8%8A%E3%81%A7%E5%A4%A7%E4%BA%8B%E3%81%AA%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>チーム開発を行う上で大事なこと</h2>

<p>ここまで、メソッド引数や戻り値を何でも <code>List</code> で定義した場合の問題点を見てきた。</p>

<p>個人で開発するだけなら、こう言ったことはそこまで気にしなくても、大きな問題にならない（もちろんホントは気にして欲しい）。</p>

<p>なぜなら、適当に引数の型を定義して作っていっても、内部実装を分かっているので「予期しない動き」というものが無い。</p>

<p>問題になるのは、チーム開発など、複数人で一つのソフトウェアを開発していく時だ。</p>

<p>一人の時と違うのは、メソッドの内部実装を知らない（しかも自分とはスキルレベルや考え方が違う）赤の他人が、そのメソッドを呼び出したり、また逆に赤の他人が書いたコードを、自分のコードから呼び出したりするわけだ。</p>

<p>そこに認識の齟齬が生じる。<br>
こんな具合に。</p>

<blockquote>
<p>「このメソッド、どーゆー仕様なの？」<br>
「どうって、見たまんまですよ」<br>
「えっと、引数はどう渡せばよい？」<br>
「え？ リストをそのまま渡してくれれば大丈夫ですけど」<br>
「だから、渡したリストは変更されるの？ されないの？」<br>
「あ、変更されませんよ」<br>
「おけ、わかった。ありがとう」</p>
</blockquote>

<p>こういった、コミュニケーションロスが発生する。</p>

<p>それでも、コミュニケーションが行われるだけまだましだ。<br>
それもなく、それぞれの開発者がそれぞれの思い込みで相互に連携するプログラムを書いていくと、</p>

<blockquote>
<p>「このプロパティに要素を追加したら動かなくなったんだけど、バグじゃない？」<br>
「いや、そこに要素を追加しちゃダメですよ」<br>
「え？ まじ？ なんで？ List なのに？」<br>
「...」</p>
</blockquote>

<p>といったことや、</p>

<blockquote>
<p>「そろそろ結合試験しよーか」<br>
「はい、大丈夫と思います」<br>
「どれ、、、ん？ ダメか、、、デバッグしてみるか。。。えっと、ここか。あれ？ このメソッド、引数で渡したリストが変更されるんじゃなかったの？」<br>
「いや、違いますよ」<br>
「なんやて！？ アカンやん、、、直してよ」<br>
「え？ 無理ですよ、いまさら。。。」</p>
</blockquote>

<p>といったことが起こる。</p>

<p>そんな経験ないって？<br>
ない人は、国内でも稀な非常に優秀な開発チームに所属している可能性が高い。<br>
特定の企業やチームを批判するつもりはないが、一般的な大手SIerやソフトハウスなら、こんなこと日常茶飯事だ。</p>

<p>まったくもって、非効率すぎる。<br>
まさに、日本中でこんな事ばっかり起こってるんだ。<br>
そりゃー Google や Amazon, Apple や Microsoft に勝てないわけだ。</p>

<p>こういった認識の齟齬が起こる原因は、引数の型がどうこうという問題以外にも、ネーミングの問題や設計工程での詰めの甘さなど、様々であるが、メソッドシグネチャについて言及する者は少ない。</p>

<p>ここで、僕が言いたいことは<br>
<strong>メソッドシグネチャだけで振る舞いがわかるように書け！</strong><br>
ということだ。</p>

<p>せっかく静的型付け言語を使っているのだから、この強力な型システムを使わない手はない！</p>

<p>何でもかんでも List で書いてしまうことは、動的型付けなスクリプト言語と変わらない！</p>

<p>特に C# （というか .NET Framework）にここまで細分化されたコレクションの型があるのは、特筆すべき点である。<br>
余談になるが、Javaにも変更操作を禁止するための <code>java.util.Collections.unmodifiableList()</code> があるが、戻り値が専用の型でなく普通の <code>List</code> なので、メソッドシグネチャだけを見て読み取り専用かどうかを明示的に表すことが出来ない。</p>

<p><strong>チーム開発でこそ、C# の優位性を最大限に利用するべきだ。</strong></p>

<h2>
<span id="コレクション型の種類" class="fragment"></span><a href="#%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%9E%8B%E3%81%AE%E7%A8%AE%E9%A1%9E"><i class="fa fa-link"></i></a>コレクション型の種類</h2>

<p>では実際に型について考える前に、まずはどのようなコレクションの型の種類があって、それぞれどのような特徴があるのかをざっくり見ていこう。</p>

<h3>
<span id="コレクション型の継承関係図" class="fragment"></span><a href="#%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%9E%8B%E3%81%AE%E7%B6%99%E6%89%BF%E9%96%A2%E4%BF%82%E5%9B%B3"><i class="fa fa-link"></i></a>コレクション型の継承関係図</h3>

<p>基本的なものはこんな感じ。実際の継承関係はもっと沢山あるが、ここでは使い分けをイメージするために簡略化してある。</p>

<p><a href="https://camo.qiitausercontent.com/1fca15853ed5655379363213b0ea3b42a336156e/687474703a2f2f64726976652e676f6f676c652e636f6d2f75633f6578706f72743d766965772669643d3176344f686b5162635261544246467435554b36337a79564b51394b317037764d" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/http%3A%2F%2Fdrive.google.com%2Fuc%3Fexport%3Dview%26id%3D1v4OhkQbcRaTBFFt5UK63zyVKQ9K1p7vM?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1e0cc1035f024eedae00616e5c9d3025" alt="C#コレクション型の継承関係図" data-canonical-src="http://drive.google.com/uc?export=view&amp;id=1v4OhkQbcRaTBFFt5UK63zyVKQ9K1p7vM" srcset="https://qiita-user-contents.imgix.net/http%3A%2F%2Fdrive.google.com%2Fuc%3Fexport%3Dview%26id%3D1v4OhkQbcRaTBFFt5UK63zyVKQ9K1p7vM?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=97f61653fe256ea1638f6a3dc7df239f 1x" loading="lazy"></a></p>

<p>注：ReadOnly 系が利用可能なのは .NET 4.5 以降 <sup id="fnref1"><a href="#fn1" title="IReadOnlyXxx 系が導入されたのは .NET 4.5 で、System.Collections.Generic 名前空間で利用できる。.NET 4 では、System.Collection.ObjectModel 名前空間にある ReadOnlyCollection だけしか利用できない。">1</a></sup></p>

<h3>
<span id="それぞれの型の特徴" class="fragment"></span><a href="#%E3%81%9D%E3%82%8C%E3%81%9E%E3%82%8C%E3%81%AE%E5%9E%8B%E3%81%AE%E7%89%B9%E5%BE%B4"><i class="fa fa-link"></i></a>それぞれの型の特徴</h3>

<h4>
<span id="ienumerable-は-遅延評価" class="fragment"></span><a href="#ienumerable-%E3%81%AF-%E9%81%85%E5%BB%B6%E8%A9%95%E4%BE%A1"><i class="fa fa-link"></i></a>IEnumerable は 遅延評価</h4>

<p><code>IEnumerable&lt;T&gt;</code> はすべてのコレクション型の最上位に位置する、単純に列挙可能な（<code>foreach</code> で回すことが可能な）型を表す。</p>

<p>メソッド内で1回だけ <code>foreach</code> したり、1つの LINQ 式で完結してしまう場合は、引数の型を <code>IEnumerable&lt;T&gt;</code> にすれば十分である。</p>

<p>ただ、<code>IEnumerable&lt;T&gt;</code> を使うときは遅延評価に留意すること。<br>
やろうと思えば <code>ICollection&lt;T&gt;</code> などでも遅延評価を実装することは出来るが、<code>IEnumerable&lt;T&gt;</code> の場合は言語仕様により遅延評価（<code>yield return</code> 構文など）がサポートされているため、暗黙的に遅延評価を考慮すべき型であると認識すべきだ。</p>

<p>メソッド引数として <code>List&lt;T&gt;</code> を書きたくなったら、まず <code>IEnumerable&lt;T&gt;</code> 型に出来ないか検討すべきだ。<br>
検討するには、 <code>IEnumerable&lt;T&gt;</code> を引数の型に採用すべきでないケースを知っておく必要がある。以下のようなケースだ。</p>

<ul>
<li>メソッド内で <code>Count()</code> で要素数を取得している → 要素数を知りたいのなら、最初から要素数が確定している <code>IReadOnlyCollection</code> にすべき</li>
<li>メソッド内で foreach を２回以上行っている → ループの度にイテレータが再評価されるため、無駄が多い。思わぬ副作用が起こる可能性もある。 <code>IReadOnlyCollection</code> を使うべき</li>
<li>
<code>ToArray()</code> や <code>ToList()</code> などで結局内部で配列やリストにして使っている → 配列やリストが本当に必要なら素直に引数の型をそれにして、<code>IEnumerable</code> から 配列やリストへの変換が必要なら呼び出し元で変換してもらうべき</li>
</ul>

<h4>
<span id="icollection-と-ilist-の違い" class="fragment"></span><a href="#icollection-%E3%81%A8-ilist-%E3%81%AE%E9%81%95%E3%81%84"><i class="fa fa-link"></i></a>ICollection と IList の違い</h4>

<p><code>ICollection&lt;T&gt;</code> は要素の集合を表し、要素数は確定しているが順序関係を持たない。<br>
イメージとしては、バケツに要素がガバーっと入っていて、<code>foreach</code> で取り出すときにどの順番で取り出されるか不定、みたいな感じ。</p>

<p><code>IList&lt;T&gt;</code> はすなわち可変長配列。順序を維持した集合であり、<code>Insert()</code> メソッドで位置を指定して要素追加したりできる。<br>
イメージとしては、列車のように要素同士が連結されていて、<code>foreach</code> で取り出すと必ず順序通りに取り出される、みたいな感じ。</p>

<h4>
<span id="ilist-と-list-の違い" class="fragment"></span><a href="#ilist-%E3%81%A8-list-%E3%81%AE%E9%81%95%E3%81%84"><i class="fa fa-link"></i></a>IList と List の違い</h4>

<p><code>IList&lt;T&gt;</code> は、<code>List&lt;T&gt;</code> と同等の操作を備えたインターフェースと思いきや、実はリストの便利なメソッドは全く定義されていない。</p>

<p><code>IList&lt;T&gt;</code> で定義されているメソッドは非常にシンプルで、インデクサと <code>IndexOf()</code> <code>Insert()</code> <code>RemoveAt()</code> の３つだけだ。</p>

<p>したがって、<code>List&lt;T&gt;</code> で定義されている <code>Sort()</code> や <code>Reverse()</code> などの順序を変更するような便利メソッドは <code>IList&lt;T&gt;</code> では使えない。<br>
これらのメソッドを利用したい場合は、素直に引数を <code>List&lt;T&gt;</code> にして、変更されることを明示的にすべきだ。</p>

<p>同様に <code>Contains()</code> や <code>FindXxx()</code> などの探索系メソッドも使えないが、これらはコレクションの追加削除をするものではないので、引数の型は ReadOnly 系にしておいて、 内部で <code>ToList()</code> して便利メソッドを使う、というような配慮ができれば シメたものだ。</p>

<p>勿論 <code>List</code> は <code>IList</code> を実装している。<br>
引数の型として <code>List</code> ではなく <code>IList</code> を使うことは、間口を広げることにつながる。<code>List</code> だと、渡せるのは <code>List</code> かそれを継承したサブクラスだけになるが、<code>IList</code> だとそれを実装したあらゆる型を受け付けることが出来る。</p>

<p>戻り値としては、例えばメソッド内部でリストを生成して返すような処理になっているのなら、素直に <code>List&lt;T&gt;</code> を返せばよいだろう。<code>IList&lt;T&gt;</code> に限らず、戻り値を インターフェース型にするようなシーンは限定的だ（後述）。</p>

<h4>
<span id="ireadonlycollection-と-readonlycollection-の違い" class="fragment"></span><a href="#ireadonlycollection-%E3%81%A8-readonlycollection-%E3%81%AE%E9%81%95%E3%81%84"><i class="fa fa-link"></i></a>IReadOnlyCollection と ReadOnlyCollection の違い</h4>

<p>名前から察するに、読み取り専用のコレクションと、それを表すインタフェース、と思いきや、全然違う役割を持っている。</p>

<p>まず、名前空間が違う。<br>
<code>System.Collections.Generic.IReadOnlyCollection&lt;T&gt;</code> と、<br>
<code>System.Collections.ObjectModel.ReadOnlyCollection&lt;T&gt;</code> だ。</p>

<p><code>ReadOnlyCollection&lt;T&gt;</code> の方は、実質 <code>ReadOnlyList</code> であると理解すればオッケーだ（<code>ReadOnlyList</code> というクラスは存在しない）。<sup id="fnref2"><a href="#fn2" title="System.Collections.ObjectModel.Collection&lt;T&gt; という独自コレクションを作る際のベースになるような便利クラスがあり（IList&lt;T&gt; も実装している）、それのリードオンリー版、という位置づけになっている。">2</a></sup></p>

<p><code>List&lt;T&gt;#AsReadOnly()</code> メソッドで生成することができ、元となったコレクションのコピーを保持しているわけでなく、ラッパーとして機能する。<br>
とーぜん、元のリストの変更が反映される。</p>

<p>実際のコーディングで、型として <code>ReadOnlyCollection&lt;T&gt;</code> を書くことはほぼないだろう。</p>

<p>継承関係図を見てもわかる通り、<code>ReadOnlyCollection&lt;T&gt;</code> は <code>IList&lt;T&gt;</code> を実装しており、 <code>Add</code> や <code>Remove</code> といった要素の追加削除のメソッドが定義されているが、それらのメソッドを呼び出した時点で例外が発生する、という仕様になっている。単純な一次元配列も実は同様だ。<br>
なので、実質 <code>ReadOnlyList</code> であると捉える方が、この図のように整理して理解しやすい。</p>

<p>対して、<code>IReadOnlyCollection&lt;T&gt;</code> には、要素の追加削除のメソッドが定義されておらず、<code>IEnumerable</code> + <code>Count</code> プロパティ、といった最小限の構成。</p>

<p>もう一方の <code>IReadOnlyList&lt;T&gt;</code> は <code>IReadOnlyCollection&lt;T&gt;</code> + インデクサ。まさに固定長の一次元配列と同じようなイメージだ。事実、<code>IReadOnlyCollection&lt;T&gt;</code> 型の引数には 配列を渡すことが出来る。とても理にかなっている！</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="c1">// このメソッドに渡せる型には、どんなものがある？ List&lt;int&gt;？</span>
<span class="k">void</span> <span class="nf">Func</span><span class="p">(</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">arg</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

<span class="c1">// 呼び出し元</span>
<span class="kt">var</span> <span class="n">array</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[]</span> <span class="p">{</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span> <span class="p">};</span>
<span class="nf">Func</span><span class="p">(</span><span class="n">array</span><span class="p">);</span>  <span class="c1">// 実は配列も渡せるんやで！</span>
</code></pre></div></div>

<p>したがってメソッド引数として使う際には <code>ReadOnlyCollection</code> ではなく、 <code>IReadOnlyCollection&lt;T&gt;</code> か <code>IReadOnlyList&lt;T&gt;</code> を使うべきである。</p>

<h2>
<span id="どの型をつかうべきか" class="fragment"></span><a href="#%E3%81%A9%E3%81%AE%E5%9E%8B%E3%82%92%E3%81%A4%E3%81%8B%E3%81%86%E3%81%B9%E3%81%8D%E3%81%8B"><i class="fa fa-link"></i></a>どの型をつかうべきか</h2>

<p>それぞれの型の役割がわかったところで、実際にメソッド引数や戻り値としてどの型を使えば良いのか考えてみよう。</p>

<p>なに、難しくはない。判断基準はいたってシンプルだ。</p>

<h3>
<span id="メソッド引数の型" class="fragment"></span><a href="#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E5%BC%95%E6%95%B0%E3%81%AE%E5%9E%8B"><i class="fa fa-link"></i></a>メソッド引数の型</h3>

<p>メソッド引数は、可能な限り最大に間口を広げるべき。<br>
つまり、<strong>出来る限り上位のインターフェース</strong>（継承関係図で上の方にあるもの）で受ける。</p>

<ul>
<li>要素の追加削除をしないなら <code>List&lt;T&gt;</code> よりも <code>IReadOnlyList&lt;T&gt;</code>、順序関係がど－でもいいなら <code>IReadonlyCollection&lt;T&gt;</code>、要素数未確定でおっけーなら <code>IEnumerable&lt;T&gt;</code> を使う。</li>
<li>要素の追加削除をするなら基本 <code>List&lt;T&gt;</code> になるが、<code>IList&lt;T&gt;</code> や <code>ICollection&lt;T&gt;</code> でも受けられないか考えてみる。</li>
</ul>

<p>基本的には、<code>IReadonlyCollection&lt;T&gt;</code> で書ける場合が多い。まずこの型で置き換えできないか検討すればよいだろう。</p>

<h3>
<span id="メソッド戻り値の型" class="fragment"></span><a href="#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%AE%E5%9E%8B"><i class="fa fa-link"></i></a>メソッド戻り値の型</h3>

<p>戻り値は引数の逆で、<strong>出来る限り下位のインターフェース</strong>（継承関係図で下の方にあるもの）を返すようにする。</p>

<p>メソッド内部でリストを生成して返すのなら、素直に <code>List&lt;T&gt;</code> を戻り値にすればよい。無理に <code>IEnumerable&lt;T&gt;</code> にする必要はない（ただし設計上の理由によりそうする場合もある）。</p>

<p>理由は簡単で、より具体的なインタフェースで返す方が、呼び出し元での利便性が高まるからである。<br>
例えば以下のようなケース。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Reorder</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">list</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>
  <span class="c1">// 省略</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 呼び出し元はこうなっている</span>
<span class="kt">var</span> <span class="n">newList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="nf">Reorder</span><span class="p">(</span><span class="n">list</span><span class="p">));</span>  <span class="c1">// いちいち新しく List を作っている</span>
<span class="n">newList</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="err">…</span><span class="p">);</span>  <span class="c1">// じゃないと要素を追加できない</span>
</code></pre></div></div>

<p>もし <code>Reorder()</code> の戻り値が <code>List&lt;T&gt;</code> なら、それをそのまま使うことができる。もちろん、元のコードのまま <code>new List()</code> で新しく作ってもちゃんと動くので、互換性が失われることもなく、利便性だけが高まる。</p>

<p>すなわち、</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Reorder</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">list</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>
  <span class="c1">// 省略</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 呼び出し元はこう書ける</span>
<span class="kt">var</span> <span class="n">newList</span> <span class="p">=</span> <span class="nf">Reorder</span><span class="p">(</span><span class="n">list</span><span class="p">);</span>  <span class="c1">// 新しく List を作る必要がなくなった</span>
<span class="n">newList</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="err">…</span><span class="p">);</span>
</code></pre></div></div>

<p>とできる。<br>
些細な違いかもしれないが、いちいち新しいリストを生成しなくても済むので、メモリ効率もよくなる。<br>
しかしながら、将来的に <code>List&lt;T&gt;</code> を返さないようになるかもしれない場合や、外部設計の時点で戻り値の型が厳密に <code>IEnumerble&lt;T&gt;</code> だと決まっているような場合はその限りではない。</p>

<h4>
<span id="参考ジェネリックの共変性" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%85%B1%E5%A4%89%E6%80%A7"><i class="fa fa-link"></i></a>(参考)ジェネリックの共変性</h4>

<p>少し脱線して、やや難しい内容になるが、<code>List&lt;T&gt;</code>の <code>T</code> を上位の型に暗黙変換したい時には、<code>IReadOnlyList&lt;T&gt;</code> を使うと変換できる（ジェネリックの共変性という）。以下のようなケースだ。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="nf">Func1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// コンパイルエラー。 Func1().Add(0) というように違う型を追加出来るため、おかしくなる</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
<span class="p">}</span>

<span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="nf">Func2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// これはオッケー。戻り値は ReadOnly なので、Add() されることはない</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>また、LINQ 式の結果をそのまま返したいとか、遅延評価を行う場合は <code>IEnumerable&lt;T&gt;</code> を戻り値にせざるを得ないのは言うまでもないだろう。</p>

<h3>
<span id="プロパティの型" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AE%E5%9E%8B"><i class="fa fa-link"></i></a>プロパティの型</h3>

<p>プロパティは、基本的にはオブジェクト内のデータをそのまま（あるいは薄いラップ処理をして）返すような作りになっているべきだ。</p>

<p>しかしながら内部データが <code>List&lt;T&gt;</code> の場合、それをそのまま返すと外部から <code>Add</code> <code>Remove</code> 出来てしまうので、それをして欲しくない場合には考慮が必要となる。</p>

<p>例えば先の <code>MyQueryResult</code> の例を少し掘り下げると、次のような実装が考えられる。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="k">class</span> <span class="nc">MyQueryResult</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">_items</span><span class="p">;</span>                 <span class="c1">// 内部用</span>
    <span class="k">public</span> <span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Items</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>  <span class="c1">// 外部公開用</span>

    <span class="c1">// コンストラクタ</span>
    <span class="k">public</span> <span class="nf">QueryResult</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">items</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_items</span> <span class="p">=</span> <span class="n">items</span><span class="p">;</span>                <span class="c1">// 内部用にはそのまま List で保持</span>
        <span class="k">this</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="n">items</span><span class="p">?.</span><span class="nf">AsReadOnly</span><span class="p">();</span>   <span class="c1">// 外部公開用には変更不可にラップ</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>メソッドの戻り値の場合とはまた違った観点で型を検討する必要があるのだ。</p>

<h3>
<span id="配列は" class="fragment"></span><a href="#%E9%85%8D%E5%88%97%E3%81%AF"><i class="fa fa-link"></i></a>配列は？</h3>

<p>エンタープライズ向けアプリケーションでは、メソッドの引数に配列を使うシーンは実はあまりない。<br>
<code>IReadOnlyList&lt;T&gt;</code> を使えば完全互換になるからだ。</p>

<p>パフォーマンスとか気にする場合は、配列を使うこともあるだろうが、基本みんな、富豪プログラミングだし。<sup id="fnref3"><a href="#fn3" title="富豪プログラミングとは、処理の効率やメモリの節約などを気にせず、リソースをじゃんじゃん使いまくるプログラミングアプローチのこと。最近はこの言葉もあまり聞かなくなったな。">3</a></sup></p>

<p>唯一の出番は、可変長引数を使うときぐらいかもしれない。</p>

<h3>
<span id="タプルは" class="fragment"></span><a href="#%E3%82%BF%E3%83%97%E3%83%AB%E3%81%AF"><i class="fa fa-link"></i></a>タプルは？</h3>

<p>C# 7.0 からタプル型を引数や戻り値に直接利用できるようになった。</p>

<p>タプルは、他の型を包含する役割を持っているだけなので、基本的な型の使い分けの考え方は変わらない。</p>

<p>ところで、SIの開発現場でタプルを実際に利用しているところはまだ少ないと思われる。とゆーか見たことがない。<br>
ので今回は詳細な考察を省略する。利用シーンがもっと広がってノウハウが貯まってきたら考察してみたい。</p>

<h3>
<span id="参考immutableコレクション不変コレクション" class="fragment"></span><a href="#%E5%8F%82%E8%80%83immutable%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E4%B8%8D%E5%A4%89%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"><i class="fa fa-link"></i></a>(参考)Immutableコレクション（不変コレクション）</h3>

<p>もし Nuget パッケージが使えるなら、<code>System.Collections.Immutable</code> という強力なコレクションライブラリがある。</p>

<p>Immutable（イミュータブル：不変という意味）なので、変更できないコレクションクラスということだ。</p>

<p>馴染みのある <code>String</code> クラスがまさにイミュータブルだ。一度生成したら中身を書き換えることは出来ない。 <code>+</code> 演算子などで文字列結合を行うと、新しいインスタンスが作られて結合結果が得られる。<br>
こんな感じのコレクション版ってイメージだ。</p>

<p>イミュータブルにすることによってコレクションが変更されなくなるため、バグの少ない、非常に安定したプログラムが書けるが、自分の中でまだノウハウが十分でないため、ここでは紹介までにとどめるが、機会があれば是非使ってみて欲しい。</p>

<h2>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h2>

<p>ずいぶん長くなったが、ここで述べたのは個人的な経験に基づくベストプラクティスであり、絶対的な正論というわけではない。</p>

<p>世の中には、コレクションのための型を使い分けず、<code>List</code> に統一した方が分かりやすいとする考え方ももちろんある（実際にそういう開発チームを幾つか見てきた）。</p>

<p>それはそれで否定はしない。</p>

<p>しかしながら僕に言わせれば、それは初心者向けに分かりやすい、という捉え方であり、「分かりやすい」の観点が違うわけだ。そういった考え方では、ソフトウェアの規模が大きくなればなるほど、ツラくなる。</p>

<p>もしかすると .NET 4.5 で <code>IReadOnly</code> 系が導入されたことを知らないだけかもしれない。</p>

<p>また .NET 4 以前から続くコーディング規約で決められているとかなら、末端のエンジニアにはどうしようもないだろうが、可能性があるなら断固として正しい使い分けをするべくチーム内で啓蒙活動をするべきだ。</p>

<p>もしあなたが職業プログラマで、チームでの開発を行っており、.NET 4.5 以降をターゲットとしいて、先述のようなコレクションクラスの使い分けを意識していないならば、今すぐ使い分けを始めるべきだ。<br>
無駄なコードリーディングが減るし、バグの発生数も減るはず（少なくとも増えることはない）なので、将来にわたって削減できる工数は計り知れない。</p>

<p>上司やチームメンバーが使い分けを許容しない、または理解できない、または古いやり方を変更することを恐れているならば、さらにその上位者に進言してでも取り組むべきである。というかそのような開発現場はもっと根本的なところに課題を抱えていそうだが。<br>
それでも変わらないようであれば、残念ながらそんな仕事に価値はないと思う。<br>
国会で最低賃金がどうのこうのと議論されている現状を踏まえると、淘汰されるべき生産効率の低い仕事なのかもしれない。</p>

<p>僕もそのような残念な環境で多くの仕事をやってきたので、よく分かる。</p>

<p>後に続く者達には、少しでも明るい未来を創っていきたい。</p>

<p>最後の方は何だか愚痴っぽくなってしまったが、そういった想いをいつも胸に抱え、この国のSI業界の行く末を憂いている。<br>
なお、前向きなコメント、編集リクエストは大歓迎だ。</p>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p><code>IReadOnlyXxx</code> 系が導入されたのは .NET 4.5 で、<code>System.Collections.Generic</code> 名前空間で利用できる。.NET 4 では、<code>System.Collection.ObjectModel</code> 名前空間にある <code>ReadOnlyCollection</code> だけしか利用できない。 <a href="#fnref1">↩</a></p>
</li>

<li id="fn2">
<p><code>System.Collections.ObjectModel.Collection&lt;T&gt;</code> という独自コレクションを作る際のベースになるような便利クラスがあり（<code>IList&lt;T&gt;</code> も実装している）、それのリードオンリー版、という位置づけになっている。 <a href="#fnref2">↩</a></p>
</li>

<li id="fn3">
<p>富豪プログラミングとは、処理の効率やメモリの節約などを気にせず、リソースをじゃんじゃん使いまくるプログラミングアプローチのこと。最近はこの言葉もあまり聞かなくなったな。 <a href="#fnref3">↩</a></p>
</li>

</ol>
</div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Flobin-z0x50%2Fitems%2F248db6d0629c7abe47dd&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Flobin-z0x50%2Fitems%2F248db6d0629c7abe47dd&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/likers" class="css-1iupg5d">724</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">639</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/248db6d0629c7abe47dd/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/lobin-z0x50/items/248db6d0629c7abe47dd/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/lobin-z0x50/items/248db6d0629c7abe47dd.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-8bf35a71-d29c-421b-853d-a304f6c3632a">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-078e421e-c4c6-4d6f-a7fd-d550376f3cdc"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-078e421e-c4c6-4d6f-a7fd-d550376f3cdc">{}</script>
      
<div id="LoginModal-react-component-ba61a35a-e8ee-408f-a643-40063f9bc580"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-ba61a35a-e8ee-408f-a643-40063f9bc580">{}</script>
      
<div id="StockModal-react-component-ecc1b72f-fd4c-4b9d-8c84-daa62d349a0c"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-ecc1b72f-fd4c-4b9d-8c84-daa62d349a0c">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;yRpmKnpVpGDJzEl/8eoGnfMRwM5OsBg5QIBpSwSHkCfmGkEaPS2lQyEpkIiNoYPxFruPvidb7Wadr1wRV2jpyw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eこの記事は \u003ca href=\"https://qiita.com/advent-calendar/2018/c-sharp-2\"\u003eC# その２ Advent Calendar 2018\u003c/a\u003e の第一日の記事である。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eこの記事では、主にエンタープライズアプリケーション（SI、企業向けの業務システムやパッケージ製品）の開発に於いて、新規開発ではなく修正や拡張を行うようなシーンを想定して、無駄な工数をなるべく削減すべく自分なりに考えて実践しているベストプラクティスを書いている。\u003c/p\u003e\n\n\u003cp\u003e新規開発の場合でも、将来の拡張や修正が見込まれるはずなので、考慮すべき事は同じだ。\u003c/p\u003e\n\n\u003cp\u003e競技プログラミングや、組み込み開発の場合でも基本的な考え方は適用可能だが、メモリ効率やパフォーマンスを考慮する必要もあるので、あえて配列を使ったり、逸脱するようなケースもあるだろう。\u003c/p\u003e\n\n\u003cp\u003e対象とする読者層は、C#プログラミング歴1年以上、SIer やユーザー企業に所属（もしくは常駐）し、特に複数人チームでの開発に携わる若手プログラマ、初級から中級へのステップアップ中の人、といったところ。要は、俗に言う\"IT土方\"。\u003c/p\u003e\n\n\u003cp\u003e対象としている .NET のバージョンは 4.5 以降である。もちろん .NET Core も対象だ。\u003c/p\u003e\n\n\u003cp\u003eさて、前置きはこの辺にして、さっそく始めよう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"例示\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%8B%E7%A4%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e例示\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"その１\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%91\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその１\u003c/h3\u003e\n\n\u003cp\u003eまず最初に、このコードを見てくれ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eRemoveUnnecessary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eentities\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 省略(500行ぐらいある)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e何もおかしいところはなさそうだと思うだろう。\u003c/p\u003e\n\n\u003cp\u003eだがこういう一見何事もなさそうなところに、実は問題があることを伝えたい。\u003c/p\u003e\n\n\u003cp\u003eハッキリ言って、このメソッドの宣言はダメだ。\u003c/p\u003e\n\n\u003cp\u003eこれだけを見て、このメソッドが一体どんな挙動をするのか想像がつくだろうか？\u003c/p\u003e\n\n\u003cp\u003eメソッドの名前によると、何やら不要な物を削除してくれそうな事は想像できるが、問題は、 \u003cstrong\u003e引数で渡したリストが直接変更されるのか、それとも変更されないのか\u003c/strong\u003e どうか完全には分からないことだ。\u003c/p\u003e\n\n\u003cp\u003eメソッドコメントが書いてあればそれを読めばいいのだが、このようなコードが散見されるコードベース（ソースコードの基盤のこと）では、往々にして役に立たないコメントであるか、またはコメントが無いケースも少なくない。\u003c/p\u003e\n\n\u003cp\u003eなので、結局メソッドの実装コードを読まないといけない。\u003cbr\u003e\nそれでまた余計な時間がかかる。\u003c/p\u003e\n\n\u003cp\u003eアカン。効率悪すぎ。\u003c/p\u003e\n\n\u003cp\u003eならば、こうならどうか。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eRemoveUnnecessary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIReadOnlyCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eentities\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 省略(500行ぐらいある)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e引数の型が \u003ccode\u003eIReadOnlyCollection\u0026lt;Entity\u0026gt;\u003c/code\u003e に変わっている。\u003c/p\u003e\n\n\u003cp\u003e「IReadonlyCollection って初めて聞いたな」って人もいるかもしれない。\u003cbr\u003e\nそういう人は、この機会にぜひ覚えて欲しい。\u003cbr\u003e\n要は、リードオンリーなコレクションってことだ（.NET 4.5 から導入された）。\u003c/p\u003e\n\n\u003cp\u003eここからわかる事は、\u003cstrong\u003e引数にリストを渡した場合でも、メソッド内で変更（\u003ccode\u003eAdd\u003c/code\u003e, \u003ccode\u003eRemove\u003c/code\u003e）される事はない\u003c/strong\u003e、って事だ。それ以上でもそれ以下でもないが、それが僕らプログラマにはとても大きな手がかりになる。\u003c/p\u003e\n\n\u003cp\u003eメソッドの実装を読むまでもなく、安心してリストを渡せるわけだ。\u003c/p\u003e\n\n\u003cp\u003eこのように、\u003cstrong\u003e引数の意味\u003c/strong\u003eを考えて欲しい。\u003c/p\u003e\n\n\u003cp\u003eでは次に、こういうのはどうか？\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRemoveUnnecessary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 省略(500行ぐらいある)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこの場合は戻り値がないので、引数で渡したリストが変更されそうなことは明らかだ。\u003c/p\u003e\n\n\u003cp\u003eどちらの実装がよいかという議論ももちろん重要なんだが、ここではそれは置いといて、注目すべきは \u003cstrong\u003eメソッドシグネチャ（引数と戻り値の型定義のこと）を見るだけで、そのメソッドがどの様な振る舞いをするのか分かる\u003c/strong\u003e ようにプログラムを書け、ということだ。\u003c/p\u003e\n\n\u003cp\u003e実はこういう事がとっても大切なんだ。\u003c/p\u003e\n\n\u003cp\u003eプログラムなんて、動けば何でもいいってわけじゃない。\u003cbr\u003e\nソフトウェアは、ハードウェアと違って簡単に修正できるのがいいところであり、OSにしてもスマホアプリにしても日々新しいバージョンがリリースされ、アップデートされ続けていっている。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eプログラムは修正しやすいように書くべき\u003c/strong\u003eなんだ。\u003c/p\u003e\n\n\u003cp\u003eメソッドの実装を読まないと分からないような書き方は悪だ。極悪だ。我々の貴重な工数を浪費し、残業時間を増大させ、体力と精神力を消耗してしまって、その果てに幸福が待っているはずなど皆無なのである。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"その２\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその２\u003c/h3\u003e\n\n\u003cp\u003e話を元に戻そう。次はプロパティについての型の例を見てみよう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyQueryResult\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// クエリ結果\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eItems\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// コンストラクタ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMyQueryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 省略\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 他にもメソッドがいっぱいある\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eさて、この \u003ccode\u003eMyQueryResult\u003c/code\u003e クラスも恐ろしい実装になっている。\u003c/p\u003e\n\n\u003cp\u003e何が恐ろしいのか、考えてみてほしい。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eItems\u003c/code\u003e の型が \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e なので当然 \u003ccode\u003eAdd\u003c/code\u003e したり \u003ccode\u003eRemove\u003c/code\u003e したり出来てしまう。そんなことをすると、クエリーの結果が改ざんされてしまうことになり、そのようなことが起こることを予期していない他の開発者のコードでバグ（というか予期しない動作）が多発するだろう。\u003c/p\u003e\n\n\u003cp\u003eいくら、コーディングルールや、チーム内の暗黙知として、「Itemsを変更するな」といった取り決めがあったとしても、実際に変更可能な実装になっている限り、不安は付きまとう。\u003c/p\u003e\n\n\u003cp\u003e人間はミスをする。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eItems\u003c/code\u003e を取得して、ローカル変数に代入したり色んなメソッドに引き渡したりしているうちに、どこかでうっかり変更してしまっていることだって十分考えられる。\u003c/p\u003e\n\n\u003cp\u003e故意ではなく、無意識のうちに変更してしまうのである。\u003cbr\u003e\n対処するには、そういった取り決めを決めるよりも、そもそも変更することが出来ないような実装にしてしまうべきだ。\u003c/p\u003e\n\n\u003cp\u003eこんな感じだ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyQueryResult\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// クエリ結果\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIReadOnlyList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eItems\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e   \u003cspan class=\"c1\"\u003e// 変更不可\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// コンストラクタ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMyQueryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 省略\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 他にもメソッドがいっぱいある\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eItems\u003c/code\u003e の型が \u003ccode\u003eIReadOnlyList\u0026lt;Entity\u0026gt;\u003c/code\u003e に変わっている。\u003cbr\u003e\nこれも先ほどの \u003ccode\u003eIReadOnlyCollection\u003c/code\u003e の仲間で、リードオンリーなリストってわけだ。\u003c/p\u003e\n\n\u003cp\u003eこれで、\u003ccode\u003eItems\u003c/code\u003e に対して外部から変更（\u003ccode\u003eAdd\u003c/code\u003e、\u003ccode\u003eRemove\u003c/code\u003eなど）を行う事は出来なくなる。\u003cbr\u003e\nとんでもない安心感である。\u003c/p\u003e\n\n\u003cp\u003e面倒なルールも必要ない。\u003c/p\u003e\n\n\u003cp\u003eところで、勘の良い人は気づいたかもしれないが、コンストラクタの型も \u003ccode\u003eIReadOnlyList\u0026lt;Entity\u0026gt;\u003c/code\u003e に変えてしまっても良いかも知れない。\u003cbr\u003e\n理由は先述の通りだ。\u003c/p\u003e\n\n\u003cp\u003eこういうセンスを磨いていってほしい。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"その３\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその３\u003c/h3\u003e\n\n\u003cp\u003e次にもう少し複雑な例を見てみよう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eMergeAndUnique\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esource1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esource2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 省略(3000行ぐらいある)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eさて、このメソッドはどういう挙動をしそうだろうか。\u003c/p\u003e\n\n\u003cp\u003e名前が Merge and Unique なので、\u003ccode\u003esource1\u003c/code\u003e と \u003ccode\u003esource2\u003c/code\u003e を混ぜ合わせ、重複排除する、と言ったところか。しかしながらあくまで推測でしかない。\u003c/p\u003e\n\n\u003cp\u003eここまで来たら何が問題なのかわかると思うが、すなわち、 \u003ccode\u003esource1\u003c/code\u003e と \u003ccode\u003esource2\u003c/code\u003e が変更されない保証が無い。\u003cbr\u003e\nもしかしたら \u003ccode\u003esource1\u003c/code\u003e と \u003ccode\u003esource2\u003c/code\u003e に対しても重複排除を行うのかもしれない。\u003c/p\u003e\n\n\u003cp\u003eでは、こうならどうか。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eMergeAndUnique\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esource1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esource2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 省略(3000行ぐらいある)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e引数の型が \u003ccode\u003eIEnumerable\u0026lt;Entity\u0026gt;\u003c/code\u003e に変わっている。\u003c/p\u003e\n\n\u003cp\u003eこの型は知っている人がほとんどだと思うが、ざっくり言うと \u003ccode\u003eforeach\u003c/code\u003e で繰り返しをするためのイテレータを表す型だ。\u003cbr\u003e\nもちろん \u003ccode\u003eAdd\u003c/code\u003e や \u003ccode\u003eRemove\u003c/code\u003e をすることはできない。\u003c/p\u003e\n\n\u003cp\u003eこれで、引数に渡したリストが変更されることはない事が保証されるようになった。\u003c/p\u003e\n\n\u003cp\u003eそれだけでなく、ちょっとハイレベルな見方をするならば、遅延評価を受け入れ可能ということが推察できるのだ（後述）。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"チーム開発を行う上で大事なこと\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%81%E3%83%BC%E3%83%A0%E9%96%8B%E7%99%BA%E3%82%92%E8%A1%8C%E3%81%86%E4%B8%8A%E3%81%A7%E5%A4%A7%E4%BA%8B%E3%81%AA%E3%81%93%E3%81%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eチーム開発を行う上で大事なこと\u003c/h2\u003e\n\n\u003cp\u003eここまで、メソッド引数や戻り値を何でも \u003ccode\u003eList\u003c/code\u003e で定義した場合の問題点を見てきた。\u003c/p\u003e\n\n\u003cp\u003e個人で開発するだけなら、こう言ったことはそこまで気にしなくても、大きな問題にならない（もちろんホントは気にして欲しい）。\u003c/p\u003e\n\n\u003cp\u003eなぜなら、適当に引数の型を定義して作っていっても、内部実装を分かっているので「予期しない動き」というものが無い。\u003c/p\u003e\n\n\u003cp\u003e問題になるのは、チーム開発など、複数人で一つのソフトウェアを開発していく時だ。\u003c/p\u003e\n\n\u003cp\u003e一人の時と違うのは、メソッドの内部実装を知らない（しかも自分とはスキルレベルや考え方が違う）赤の他人が、そのメソッドを呼び出したり、また逆に赤の他人が書いたコードを、自分のコードから呼び出したりするわけだ。\u003c/p\u003e\n\n\u003cp\u003eそこに認識の齟齬が生じる。\u003cbr\u003e\nこんな具合に。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e「このメソッド、どーゆー仕様なの？」\u003cbr\u003e\n「どうって、見たまんまですよ」\u003cbr\u003e\n「えっと、引数はどう渡せばよい？」\u003cbr\u003e\n「え？ リストをそのまま渡してくれれば大丈夫ですけど」\u003cbr\u003e\n「だから、渡したリストは変更されるの？ されないの？」\u003cbr\u003e\n「あ、変更されませんよ」\u003cbr\u003e\n「おけ、わかった。ありがとう」\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eこういった、コミュニケーションロスが発生する。\u003c/p\u003e\n\n\u003cp\u003eそれでも、コミュニケーションが行われるだけまだましだ。\u003cbr\u003e\nそれもなく、それぞれの開発者がそれぞれの思い込みで相互に連携するプログラムを書いていくと、\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e「このプロパティに要素を追加したら動かなくなったんだけど、バグじゃない？」\u003cbr\u003e\n「いや、そこに要素を追加しちゃダメですよ」\u003cbr\u003e\n「え？ まじ？ なんで？ List なのに？」\u003cbr\u003e\n「...」\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eといったことや、\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e「そろそろ結合試験しよーか」\u003cbr\u003e\n「はい、大丈夫と思います」\u003cbr\u003e\n「どれ、、、ん？ ダメか、、、デバッグしてみるか。。。えっと、ここか。あれ？ このメソッド、引数で渡したリストが変更されるんじゃなかったの？」\u003cbr\u003e\n「いや、違いますよ」\u003cbr\u003e\n「なんやて！？ アカンやん、、、直してよ」\u003cbr\u003e\n「え？ 無理ですよ、いまさら。。。」\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eといったことが起こる。\u003c/p\u003e\n\n\u003cp\u003eそんな経験ないって？\u003cbr\u003e\nない人は、国内でも稀な非常に優秀な開発チームに所属している可能性が高い。\u003cbr\u003e\n特定の企業やチームを批判するつもりはないが、一般的な大手SIerやソフトハウスなら、こんなこと日常茶飯事だ。\u003c/p\u003e\n\n\u003cp\u003eまったくもって、非効率すぎる。\u003cbr\u003e\nまさに、日本中でこんな事ばっかり起こってるんだ。\u003cbr\u003e\nそりゃー Google や Amazon, Apple や Microsoft に勝てないわけだ。\u003c/p\u003e\n\n\u003cp\u003eこういった認識の齟齬が起こる原因は、引数の型がどうこうという問題以外にも、ネーミングの問題や設計工程での詰めの甘さなど、様々であるが、メソッドシグネチャについて言及する者は少ない。\u003c/p\u003e\n\n\u003cp\u003eここで、僕が言いたいことは\u003cbr\u003e\n\u003cstrong\u003eメソッドシグネチャだけで振る舞いがわかるように書け！\u003c/strong\u003e\u003cbr\u003e\nということだ。\u003c/p\u003e\n\n\u003cp\u003eせっかく静的型付け言語を使っているのだから、この強力な型システムを使わない手はない！\u003c/p\u003e\n\n\u003cp\u003e何でもかんでも List で書いてしまうことは、動的型付けなスクリプト言語と変わらない！\u003c/p\u003e\n\n\u003cp\u003e特に C# （というか .NET Framework）にここまで細分化されたコレクションの型があるのは、特筆すべき点である。\u003cbr\u003e\n余談になるが、Javaにも変更操作を禁止するための \u003ccode\u003ejava.util.Collections.unmodifiableList()\u003c/code\u003e があるが、戻り値が専用の型でなく普通の \u003ccode\u003eList\u003c/code\u003e なので、メソッドシグネチャだけを見て読み取り専用かどうかを明示的に表すことが出来ない。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eチーム開発でこそ、C# の優位性を最大限に利用するべきだ。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コレクション型の種類\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%9E%8B%E3%81%AE%E7%A8%AE%E9%A1%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコレクション型の種類\u003c/h2\u003e\n\n\u003cp\u003eでは実際に型について考える前に、まずはどのようなコレクションの型の種類があって、それぞれどのような特徴があるのかをざっくり見ていこう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"コレクション型の継承関係図\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%9E%8B%E3%81%AE%E7%B6%99%E6%89%BF%E9%96%A2%E4%BF%82%E5%9B%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコレクション型の継承関係図\u003c/h3\u003e\n\n\u003cp\u003e基本的なものはこんな感じ。実際の継承関係はもっと沢山あるが、ここでは使い分けをイメージするために簡略化してある。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1fca15853ed5655379363213b0ea3b42a336156e/687474703a2f2f64726976652e676f6f676c652e636f6d2f75633f6578706f72743d766965772669643d3176344f686b5162635261544246467435554b36337a79564b51394b317037764d\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/http%3A%2F%2Fdrive.google.com%2Fuc%3Fexport%3Dview%26id%3D1v4OhkQbcRaTBFFt5UK63zyVKQ9K1p7vM?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1e0cc1035f024eedae00616e5c9d3025\" alt=\"C#コレクション型の継承関係図\" data-canonical-src=\"http://drive.google.com/uc?export=view\u0026amp;id=1v4OhkQbcRaTBFFt5UK63zyVKQ9K1p7vM\" srcset=\"https://qiita-user-contents.imgix.net/http%3A%2F%2Fdrive.google.com%2Fuc%3Fexport%3Dview%26id%3D1v4OhkQbcRaTBFFt5UK63zyVKQ9K1p7vM?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=97f61653fe256ea1638f6a3dc7df239f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e注：ReadOnly 系が利用可能なのは .NET 4.5 以降 \u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" title=\"IReadOnlyXxx 系が導入されたのは .NET 4.5 で、System.Collections.Generic 名前空間で利用できる。.NET 4 では、System.Collection.ObjectModel 名前空間にある ReadOnlyCollection だけしか利用できない。\"\u003e1\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"それぞれの型の特徴\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%82%8C%E3%81%9E%E3%82%8C%E3%81%AE%E5%9E%8B%E3%81%AE%E7%89%B9%E5%BE%B4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eそれぞれの型の特徴\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ienumerable-は-遅延評価\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ienumerable-%E3%81%AF-%E9%81%85%E5%BB%B6%E8%A9%95%E4%BE%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eIEnumerable は 遅延評価\u003c/h4\u003e\n\n\u003cp\u003e\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e はすべてのコレクション型の最上位に位置する、単純に列挙可能な（\u003ccode\u003eforeach\u003c/code\u003e で回すことが可能な）型を表す。\u003c/p\u003e\n\n\u003cp\u003eメソッド内で1回だけ \u003ccode\u003eforeach\u003c/code\u003e したり、1つの LINQ 式で完結してしまう場合は、引数の型を \u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e にすれば十分である。\u003c/p\u003e\n\n\u003cp\u003eただ、\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e を使うときは遅延評価に留意すること。\u003cbr\u003e\nやろうと思えば \u003ccode\u003eICollection\u0026lt;T\u0026gt;\u003c/code\u003e などでも遅延評価を実装することは出来るが、\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e の場合は言語仕様により遅延評価（\u003ccode\u003eyield return\u003c/code\u003e 構文など）がサポートされているため、暗黙的に遅延評価を考慮すべき型であると認識すべきだ。\u003c/p\u003e\n\n\u003cp\u003eメソッド引数として \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e を書きたくなったら、まず \u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e 型に出来ないか検討すべきだ。\u003cbr\u003e\n検討するには、 \u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e を引数の型に採用すべきでないケースを知っておく必要がある。以下のようなケースだ。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eメソッド内で \u003ccode\u003eCount()\u003c/code\u003e で要素数を取得している → 要素数を知りたいのなら、最初から要素数が確定している \u003ccode\u003eIReadOnlyCollection\u003c/code\u003e にすべき\u003c/li\u003e\n\u003cli\u003eメソッド内で foreach を２回以上行っている → ループの度にイテレータが再評価されるため、無駄が多い。思わぬ副作用が起こる可能性もある。 \u003ccode\u003eIReadOnlyCollection\u003c/code\u003e を使うべき\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eToArray()\u003c/code\u003e や \u003ccode\u003eToList()\u003c/code\u003e などで結局内部で配列やリストにして使っている → 配列やリストが本当に必要なら素直に引数の型をそれにして、\u003ccode\u003eIEnumerable\u003c/code\u003e から 配列やリストへの変換が必要なら呼び出し元で変換してもらうべき\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"icollection-と-ilist-の違い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#icollection-%E3%81%A8-ilist-%E3%81%AE%E9%81%95%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eICollection と IList の違い\u003c/h4\u003e\n\n\u003cp\u003e\u003ccode\u003eICollection\u0026lt;T\u0026gt;\u003c/code\u003e は要素の集合を表し、要素数は確定しているが順序関係を持たない。\u003cbr\u003e\nイメージとしては、バケツに要素がガバーっと入っていて、\u003ccode\u003eforeach\u003c/code\u003e で取り出すときにどの順番で取り出されるか不定、みたいな感じ。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e はすなわち可変長配列。順序を維持した集合であり、\u003ccode\u003eInsert()\u003c/code\u003e メソッドで位置を指定して要素追加したりできる。\u003cbr\u003e\nイメージとしては、列車のように要素同士が連結されていて、\u003ccode\u003eforeach\u003c/code\u003e で取り出すと必ず順序通りに取り出される、みたいな感じ。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ilist-と-list-の違い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ilist-%E3%81%A8-list-%E3%81%AE%E9%81%95%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eIList と List の違い\u003c/h4\u003e\n\n\u003cp\u003e\u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e は、\u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e と同等の操作を備えたインターフェースと思いきや、実はリストの便利なメソッドは全く定義されていない。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e で定義されているメソッドは非常にシンプルで、インデクサと \u003ccode\u003eIndexOf()\u003c/code\u003e \u003ccode\u003eInsert()\u003c/code\u003e \u003ccode\u003eRemoveAt()\u003c/code\u003e の３つだけだ。\u003c/p\u003e\n\n\u003cp\u003eしたがって、\u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e で定義されている \u003ccode\u003eSort()\u003c/code\u003e や \u003ccode\u003eReverse()\u003c/code\u003e などの順序を変更するような便利メソッドは \u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e では使えない。\u003cbr\u003e\nこれらのメソッドを利用したい場合は、素直に引数を \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e にして、変更されることを明示的にすべきだ。\u003c/p\u003e\n\n\u003cp\u003e同様に \u003ccode\u003eContains()\u003c/code\u003e や \u003ccode\u003eFindXxx()\u003c/code\u003e などの探索系メソッドも使えないが、これらはコレクションの追加削除をするものではないので、引数の型は ReadOnly 系にしておいて、 内部で \u003ccode\u003eToList()\u003c/code\u003e して便利メソッドを使う、というような配慮ができれば シメたものだ。\u003c/p\u003e\n\n\u003cp\u003e勿論 \u003ccode\u003eList\u003c/code\u003e は \u003ccode\u003eIList\u003c/code\u003e を実装している。\u003cbr\u003e\n引数の型として \u003ccode\u003eList\u003c/code\u003e ではなく \u003ccode\u003eIList\u003c/code\u003e を使うことは、間口を広げることにつながる。\u003ccode\u003eList\u003c/code\u003e だと、渡せるのは \u003ccode\u003eList\u003c/code\u003e かそれを継承したサブクラスだけになるが、\u003ccode\u003eIList\u003c/code\u003e だとそれを実装したあらゆる型を受け付けることが出来る。\u003c/p\u003e\n\n\u003cp\u003e戻り値としては、例えばメソッド内部でリストを生成して返すような処理になっているのなら、素直に \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e を返せばよいだろう。\u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e に限らず、戻り値を インターフェース型にするようなシーンは限定的だ（後述）。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ireadonlycollection-と-readonlycollection-の違い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ireadonlycollection-%E3%81%A8-readonlycollection-%E3%81%AE%E9%81%95%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eIReadOnlyCollection と ReadOnlyCollection の違い\u003c/h4\u003e\n\n\u003cp\u003e名前から察するに、読み取り専用のコレクションと、それを表すインタフェース、と思いきや、全然違う役割を持っている。\u003c/p\u003e\n\n\u003cp\u003eまず、名前空間が違う。\u003cbr\u003e\n\u003ccode\u003eSystem.Collections.Generic.IReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e と、\u003cbr\u003e\n\u003ccode\u003eSystem.Collections.ObjectModel.ReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e だ。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e の方は、実質 \u003ccode\u003eReadOnlyList\u003c/code\u003e であると理解すればオッケーだ（\u003ccode\u003eReadOnlyList\u003c/code\u003e というクラスは存在しない）。\u003csup id=\"fnref2\"\u003e\u003ca href=\"#fn2\" title=\"System.Collections.ObjectModel.Collection\u0026lt;T\u0026gt; という独自コレクションを作る際のベースになるような便利クラスがあり（IList\u0026lt;T\u0026gt; も実装している）、それのリードオンリー版、という位置づけになっている。\"\u003e2\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eList\u0026lt;T\u0026gt;#AsReadOnly()\u003c/code\u003e メソッドで生成することができ、元となったコレクションのコピーを保持しているわけでなく、ラッパーとして機能する。\u003cbr\u003e\nとーぜん、元のリストの変更が反映される。\u003c/p\u003e\n\n\u003cp\u003e実際のコーディングで、型として \u003ccode\u003eReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e を書くことはほぼないだろう。\u003c/p\u003e\n\n\u003cp\u003e継承関係図を見てもわかる通り、\u003ccode\u003eReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e は \u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e を実装しており、 \u003ccode\u003eAdd\u003c/code\u003e や \u003ccode\u003eRemove\u003c/code\u003e といった要素の追加削除のメソッドが定義されているが、それらのメソッドを呼び出した時点で例外が発生する、という仕様になっている。単純な一次元配列も実は同様だ。\u003cbr\u003e\nなので、実質 \u003ccode\u003eReadOnlyList\u003c/code\u003e であると捉える方が、この図のように整理して理解しやすい。\u003c/p\u003e\n\n\u003cp\u003e対して、\u003ccode\u003eIReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e には、要素の追加削除のメソッドが定義されておらず、\u003ccode\u003eIEnumerable\u003c/code\u003e + \u003ccode\u003eCount\u003c/code\u003e プロパティ、といった最小限の構成。\u003c/p\u003e\n\n\u003cp\u003eもう一方の \u003ccode\u003eIReadOnlyList\u0026lt;T\u0026gt;\u003c/code\u003e は \u003ccode\u003eIReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e + インデクサ。まさに固定長の一次元配列と同じようなイメージだ。事実、\u003ccode\u003eIReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e 型の引数には 配列を渡すことが出来る。とても理にかなっている！\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// このメソッドに渡せる型には、どんなものがある？ List\u0026lt;int\u0026gt;？\u003c/span\u003e\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIReadOnlyCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003earg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// 呼び出し元\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"nf\"\u003eFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 実は配列も渡せるんやで！\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eしたがってメソッド引数として使う際には \u003ccode\u003eReadOnlyCollection\u003c/code\u003e ではなく、 \u003ccode\u003eIReadOnlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e か \u003ccode\u003eIReadOnlyList\u0026lt;T\u0026gt;\u003c/code\u003e を使うべきである。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"どの型をつかうべきか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%81%AE%E5%9E%8B%E3%82%92%E3%81%A4%E3%81%8B%E3%81%86%E3%81%B9%E3%81%8D%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどの型をつかうべきか\u003c/h2\u003e\n\n\u003cp\u003eそれぞれの型の役割がわかったところで、実際にメソッド引数や戻り値としてどの型を使えば良いのか考えてみよう。\u003c/p\u003e\n\n\u003cp\u003eなに、難しくはない。判断基準はいたってシンプルだ。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メソッド引数の型\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E5%BC%95%E6%95%B0%E3%81%AE%E5%9E%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメソッド引数の型\u003c/h3\u003e\n\n\u003cp\u003eメソッド引数は、可能な限り最大に間口を広げるべき。\u003cbr\u003e\nつまり、\u003cstrong\u003e出来る限り上位のインターフェース\u003c/strong\u003e（継承関係図で上の方にあるもの）で受ける。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e要素の追加削除をしないなら \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e よりも \u003ccode\u003eIReadOnlyList\u0026lt;T\u0026gt;\u003c/code\u003e、順序関係がど－でもいいなら \u003ccode\u003eIReadonlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e、要素数未確定でおっけーなら \u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e を使う。\u003c/li\u003e\n\u003cli\u003e要素の追加削除をするなら基本 \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e になるが、\u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e や \u003ccode\u003eICollection\u0026lt;T\u0026gt;\u003c/code\u003e でも受けられないか考えてみる。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e基本的には、\u003ccode\u003eIReadonlyCollection\u0026lt;T\u0026gt;\u003c/code\u003e で書ける場合が多い。まずこの型で置き換えできないか検討すればよいだろう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メソッド戻り値の型\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%AE%E5%9E%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメソッド戻り値の型\u003c/h3\u003e\n\n\u003cp\u003e戻り値は引数の逆で、\u003cstrong\u003e出来る限り下位のインターフェース\u003c/strong\u003e（継承関係図で下の方にあるもの）を返すようにする。\u003c/p\u003e\n\n\u003cp\u003eメソッド内部でリストを生成して返すのなら、素直に \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e を戻り値にすればよい。無理に \u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e にする必要はない（ただし設計上の理由によりそうする場合もある）。\u003c/p\u003e\n\n\u003cp\u003e理由は簡単で、より具体的なインタフェースで返す方が、呼び出し元での利便性が高まるからである。\u003cbr\u003e\n例えば以下のようなケース。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eReorder\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eIReadOnlyCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 省略\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// 呼び出し元はこうなっている\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enewList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"nf\"\u003eReorder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// いちいち新しく List を作っている\u003c/span\u003e\n\u003cspan class=\"n\"\u003enewList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e…\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// じゃないと要素を追加できない\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eもし \u003ccode\u003eReorder()\u003c/code\u003e の戻り値が \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e なら、それをそのまま使うことができる。もちろん、元のコードのまま \u003ccode\u003enew List()\u003c/code\u003e で新しく作ってもちゃんと動くので、互換性が失われることもなく、利便性だけが高まる。\u003c/p\u003e\n\n\u003cp\u003eすなわち、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eReorder\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eIReadOnlyCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 省略\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// 呼び出し元はこう書ける\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enewList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReorder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 新しく List を作る必要がなくなった\u003c/span\u003e\n\u003cspan class=\"n\"\u003enewList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e…\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eとできる。\u003cbr\u003e\n些細な違いかもしれないが、いちいち新しいリストを生成しなくても済むので、メモリ効率もよくなる。\u003cbr\u003e\nしかしながら、将来的に \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e を返さないようになるかもしれない場合や、外部設計の時点で戻り値の型が厳密に \u003ccode\u003eIEnumerble\u0026lt;T\u0026gt;\u003c/code\u003e だと決まっているような場合はその限りではない。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"参考ジェネリックの共変性\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%85%B1%E5%A4%89%E6%80%A7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e(参考)ジェネリックの共変性\u003c/h4\u003e\n\n\u003cp\u003e少し脱線して、やや難しい内容になるが、\u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003eの \u003ccode\u003eT\u003c/code\u003e を上位の型に暗黙変換したい時には、\u003ccode\u003eIReadOnlyList\u0026lt;T\u0026gt;\u003c/code\u003e を使うと変換できる（ジェネリックの共変性という）。以下のようなケースだ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eFunc1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// コンパイルエラー。 Func1().Add(0) というように違う型を追加出来るため、おかしくなる\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eIReadOnlyList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eFunc2\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// これはオッケー。戻り値は ReadOnly なので、Add() されることはない\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまた、LINQ 式の結果をそのまま返したいとか、遅延評価を行う場合は \u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003e を戻り値にせざるを得ないのは言うまでもないだろう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"プロパティの型\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AE%E5%9E%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロパティの型\u003c/h3\u003e\n\n\u003cp\u003eプロパティは、基本的にはオブジェクト内のデータをそのまま（あるいは薄いラップ処理をして）返すような作りになっているべきだ。\u003c/p\u003e\n\n\u003cp\u003eしかしながら内部データが \u003ccode\u003eList\u0026lt;T\u0026gt;\u003c/code\u003e の場合、それをそのまま返すと外部から \u003ccode\u003eAdd\u003c/code\u003e \u003ccode\u003eRemove\u003c/code\u003e 出来てしまうので、それをして欲しくない場合には考慮が必要となる。\u003c/p\u003e\n\n\u003cp\u003e例えば先の \u003ccode\u003eMyQueryResult\u003c/code\u003e の例を少し掘り下げると、次のような実装が考えられる。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyQueryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_items\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e                 \u003cspan class=\"c1\"\u003e// 内部用\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIReadOnlyList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eItems\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 外部公開用\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// コンストラクタ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eQueryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_items\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e                \u003cspan class=\"c1\"\u003e// 内部用にはそのまま List で保持\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAsReadOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e   \u003cspan class=\"c1\"\u003e// 外部公開用には変更不可にラップ\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eメソッドの戻り値の場合とはまた違った観点で型を検討する必要があるのだ。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"配列は\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%85%8D%E5%88%97%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e配列は？\u003c/h3\u003e\n\n\u003cp\u003eエンタープライズ向けアプリケーションでは、メソッドの引数に配列を使うシーンは実はあまりない。\u003cbr\u003e\n\u003ccode\u003eIReadOnlyList\u0026lt;T\u0026gt;\u003c/code\u003e を使えば完全互換になるからだ。\u003c/p\u003e\n\n\u003cp\u003eパフォーマンスとか気にする場合は、配列を使うこともあるだろうが、基本みんな、富豪プログラミングだし。\u003csup id=\"fnref3\"\u003e\u003ca href=\"#fn3\" title=\"富豪プログラミングとは、処理の効率やメモリの節約などを気にせず、リソースをじゃんじゃん使いまくるプログラミングアプローチのこと。最近はこの言葉もあまり聞かなくなったな。\"\u003e3\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003cp\u003e唯一の出番は、可変長引数を使うときぐらいかもしれない。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"タプルは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%83%97%E3%83%AB%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタプルは？\u003c/h3\u003e\n\n\u003cp\u003eC# 7.0 からタプル型を引数や戻り値に直接利用できるようになった。\u003c/p\u003e\n\n\u003cp\u003eタプルは、他の型を包含する役割を持っているだけなので、基本的な型の使い分けの考え方は変わらない。\u003c/p\u003e\n\n\u003cp\u003eところで、SIの開発現場でタプルを実際に利用しているところはまだ少ないと思われる。とゆーか見たことがない。\u003cbr\u003e\nので今回は詳細な考察を省略する。利用シーンがもっと広がってノウハウが貯まってきたら考察してみたい。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"参考immutableコレクション不変コレクション\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83immutable%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E4%B8%8D%E5%A4%89%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e(参考)Immutableコレクション（不変コレクション）\u003c/h3\u003e\n\n\u003cp\u003eもし Nuget パッケージが使えるなら、\u003ccode\u003eSystem.Collections.Immutable\u003c/code\u003e という強力なコレクションライブラリがある。\u003c/p\u003e\n\n\u003cp\u003eImmutable（イミュータブル：不変という意味）なので、変更できないコレクションクラスということだ。\u003c/p\u003e\n\n\u003cp\u003e馴染みのある \u003ccode\u003eString\u003c/code\u003e クラスがまさにイミュータブルだ。一度生成したら中身を書き換えることは出来ない。 \u003ccode\u003e+\u003c/code\u003e 演算子などで文字列結合を行うと、新しいインスタンスが作られて結合結果が得られる。\u003cbr\u003e\nこんな感じのコレクション版ってイメージだ。\u003c/p\u003e\n\n\u003cp\u003eイミュータブルにすることによってコレクションが変更されなくなるため、バグの少ない、非常に安定したプログラムが書けるが、自分の中でまだノウハウが十分でないため、ここでは紹介までにとどめるが、機会があれば是非使ってみて欲しい。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eずいぶん長くなったが、ここで述べたのは個人的な経験に基づくベストプラクティスであり、絶対的な正論というわけではない。\u003c/p\u003e\n\n\u003cp\u003e世の中には、コレクションのための型を使い分けず、\u003ccode\u003eList\u003c/code\u003e に統一した方が分かりやすいとする考え方ももちろんある（実際にそういう開発チームを幾つか見てきた）。\u003c/p\u003e\n\n\u003cp\u003eそれはそれで否定はしない。\u003c/p\u003e\n\n\u003cp\u003eしかしながら僕に言わせれば、それは初心者向けに分かりやすい、という捉え方であり、「分かりやすい」の観点が違うわけだ。そういった考え方では、ソフトウェアの規模が大きくなればなるほど、ツラくなる。\u003c/p\u003e\n\n\u003cp\u003eもしかすると .NET 4.5 で \u003ccode\u003eIReadOnly\u003c/code\u003e 系が導入されたことを知らないだけかもしれない。\u003c/p\u003e\n\n\u003cp\u003eまた .NET 4 以前から続くコーディング規約で決められているとかなら、末端のエンジニアにはどうしようもないだろうが、可能性があるなら断固として正しい使い分けをするべくチーム内で啓蒙活動をするべきだ。\u003c/p\u003e\n\n\u003cp\u003eもしあなたが職業プログラマで、チームでの開発を行っており、.NET 4.5 以降をターゲットとしいて、先述のようなコレクションクラスの使い分けを意識していないならば、今すぐ使い分けを始めるべきだ。\u003cbr\u003e\n無駄なコードリーディングが減るし、バグの発生数も減るはず（少なくとも増えることはない）なので、将来にわたって削減できる工数は計り知れない。\u003c/p\u003e\n\n\u003cp\u003e上司やチームメンバーが使い分けを許容しない、または理解できない、または古いやり方を変更することを恐れているならば、さらにその上位者に進言してでも取り組むべきである。というかそのような開発現場はもっと根本的なところに課題を抱えていそうだが。\u003cbr\u003e\nそれでも変わらないようであれば、残念ながらそんな仕事に価値はないと思う。\u003cbr\u003e\n国会で最低賃金がどうのこうのと議論されている現状を踏まえると、淘汰されるべき生産効率の低い仕事なのかもしれない。\u003c/p\u003e\n\n\u003cp\u003e僕もそのような残念な環境で多くの仕事をやってきたので、よく分かる。\u003c/p\u003e\n\n\u003cp\u003e後に続く者達には、少しでも明るい未来を創っていきたい。\u003c/p\u003e\n\n\u003cp\u003e最後の方は何だか愚痴っぽくなってしまったが、そういった想いをいつも胸に抱え、この国のSI業界の行く末を憂いている。\u003cbr\u003e\nなお、前向きなコメント、編集リクエストは大歓迎だ。\u003c/p\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003e\u003ccode\u003eIReadOnlyXxx\u003c/code\u003e 系が導入されたのは .NET 4.5 で、\u003ccode\u003eSystem.Collections.Generic\u003c/code\u003e 名前空間で利用できる。.NET 4 では、\u003ccode\u003eSystem.Collection.ObjectModel\u003c/code\u003e 名前空間にある \u003ccode\u003eReadOnlyCollection\u003c/code\u003e だけしか利用できない。 \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn2\"\u003e\n\u003cp\u003e\u003ccode\u003eSystem.Collections.ObjectModel.Collection\u0026lt;T\u0026gt;\u003c/code\u003e という独自コレクションを作る際のベースになるような便利クラスがあり（\u003ccode\u003eIList\u0026lt;T\u0026gt;\u003c/code\u003e も実装している）、それのリードオンリー版、という位置づけになっている。 \u003ca href=\"#fnref2\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn3\"\u003e\n\u003cp\u003e富豪プログラミングとは、処理の効率やメモリの節約などを気にせず、リソースをじゃんじゃん使いまくるプログラミングアプローチのこと。最近はこの言葉もあまり聞かなくなったな。 \u003ca href=\"#fnref3\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","createdAt":"2018-11-30T12:19:12Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"IeTX6lpXsu84kzONVLli6jPvc97Qkwm3--wB4Ig3jyJiG+aXkP--PuIUhMkXZktnd5RJJSUong==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-09-18T06:05:43Z","likesCount":724,"linkUrl":"https://qiita.com/lobin-z0x50/items/248db6d0629c7abe47dd","organization":null,"originalId":730048,"stockedCount":639,"title":"引数の型を何でも List にしちゃう奴にそろそろ一言いっておくか","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BE%8B%E7%A4%BA\"\u003e例示\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%91\"\u003eその１\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%92\"\u003eその２\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%93\"\u003eその３\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%81%E3%83%BC%E3%83%A0%E9%96%8B%E7%99%BA%E3%82%92%E8%A1%8C%E3%81%86%E4%B8%8A%E3%81%A7%E5%A4%A7%E4%BA%8B%E3%81%AA%E3%81%93%E3%81%A8\"\u003eチーム開発を行う上で大事なこと\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%9E%8B%E3%81%AE%E7%A8%AE%E9%A1%9E\"\u003eコレクション型の種類\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%9E%8B%E3%81%AE%E7%B6%99%E6%89%BF%E9%96%A2%E4%BF%82%E5%9B%B3\"\u003eコレクション型の継承関係図\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%82%8C%E3%81%9E%E3%82%8C%E3%81%AE%E5%9E%8B%E3%81%AE%E7%89%B9%E5%BE%B4\"\u003eそれぞれの型の特徴\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#ienumerable-%E3%81%AF-%E9%81%85%E5%BB%B6%E8%A9%95%E4%BE%A1\"\u003eIEnumerable は 遅延評価\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#icollection-%E3%81%A8-ilist-%E3%81%AE%E9%81%95%E3%81%84\"\u003eICollection と IList の違い\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ilist-%E3%81%A8-list-%E3%81%AE%E9%81%95%E3%81%84\"\u003eIList と List の違い\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ireadonlycollection-%E3%81%A8-readonlycollection-%E3%81%AE%E9%81%95%E3%81%84\"\u003eIReadOnlyCollection と ReadOnlyCollection の違い\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%81%AE%E5%9E%8B%E3%82%92%E3%81%A4%E3%81%8B%E3%81%86%E3%81%B9%E3%81%8D%E3%81%8B\"\u003eどの型をつかうべきか\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E5%BC%95%E6%95%B0%E3%81%AE%E5%9E%8B\"\u003eメソッド引数の型\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%AE%E5%9E%8B\"\u003eメソッド戻り値の型\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%85%B1%E5%A4%89%E6%80%A7\"\u003e(参考)ジェネリックの共変性\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AE%E5%9E%8B\"\u003eプロパティの型\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%85%8D%E5%88%97%E3%81%AF\"\u003e配列は？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%83%97%E3%83%AB%E3%81%AF\"\u003eタプルは？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83immutable%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E4%B8%8D%E5%A4%89%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3\"\u003e(参考)Immutableコレクション（不変コレクション）\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":144685,"uuid":"248db6d0629c7abe47dd","banReason":null,"adventCalendarItem":{"day":1,"calendar":{"name":"C# その2 ","urlName":"c-sharp-2","year":2018,"organization":null}},"author":{"encryptedId":"yzaZL9+YV7WAzlI6SgcOfEeCn6QC--SqHc+nrkZLLVVCeV--9s4QAQMsibkraWmo491NVQ==","originalId":205835,"description":"株式会社ネオジニア 代表取締役、ITアーキテクト。\r\n大阪府岸和田市出身。\r\n組み込み開発から業務システム、スマホアプリ、Webまで幅広く開発プロジェクトに従事し、2012年に独立。\r\n従来型のSI開発に限界を感じ、変更に強いソフトウェアを日々研究し、SI業界の改革を夢見ている。\r\nいろんな言語を使うが、メインは Ruby と C#。","facebookUrl":null,"githubUrl":"https://github.com/lobin-z0x50","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"Wataru Maeda","profileImageUrl":"https://avatars0.githubusercontent.com/u/11419109?v=4","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F11419109%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=39bb1e7bf936693cf88e0ce7fb7df741","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F11419109%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=855c34f5fdd094abe9b5241d0799cde7","urlName":"lobin-z0x50","websiteUrl":"http://architect-wat.hatenablog.jp/","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[{"node":{"encryptedId":"C2A9BFRG81cMpoltePtOvcAUrdT/gNrySQkW--pnLrtWR/iLhcGaws--7x11pYo8HBU1353kSwQcZA==","isBetaReleaseEnabled":false,"isFollowableByViewer":false,"isFollowedByViewer":false,"name":"株式会社ネオジニア","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/90bb8133c41e36c124364b7566b728fc85e44e2f/original.jpg?1596812707","urlName":"neogenia","description":"大阪のシステム開発会社です！","url":"https://www.neogenia.co.jp/"}}]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":".NET","urlName":".net"},{"name":"リスト","urlName":"%e3%83%aa%e3%82%b9%e3%83%88"},{"name":"メソッド","urlName":"%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89"},{"name":"シグネチャ","urlName":"%e3%82%b7%e3%82%b0%e3%83%8d%e3%83%81%e3%83%a3"}],"followingLikers":{"edges":[]},"comments":{"totalCount":13}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
