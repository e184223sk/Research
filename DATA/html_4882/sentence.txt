More than 3 years have passed since last update.与えられた N個の整数(集合A)と 整数 X があった時に、集合Aから任意の数の整数を選び、その数の和（部分和）が、X に等しくなるようにするという問題です。問:  [3, 7, 8, 12, 13, 18] の部分和が 27 になる部分集合を求めよ。
答:  存在する。[7, 8, 12]動的計画法(Dynamic Programming)という方法で、部分和問題(Subset Sum Problem)を解いています。動的計画法というのは、決まったアルゴリズムがあるわけではありません。という手法を言います。なお、この部分和問題(Subset Sum Problem)を解く手順は、以下の通りです。という処理になります。いくつかのWebサイトをみると bool型の配列を（target+1要素分）用意し、その数になる場合には true を入れることにより、解が存在するかどうかが分かるようにしていますが、ここでは、int型の配列を用意し、最後に加えた値を入れるようにしています。こうすることで、どの組み合わせで結果が得られたかが後から分かるようになります。4の処理の意味を簡単に説明します。i + m &lt;= targetの判断は、部分和(i+m)がtarget以下であるということです。p[i+m] != -1 が成り立つということは、部分和がi+mとなるものがすでに見つかっていることを示しています。p[i+m] に m を代入するということは、i+mの部分和が存在するということを示します。例えば、i = 3, m = 1の時には、p[4] = 1となります。これは、部分和4となる部分集合が存在し、その一つの要素は 1 であることを意味しています。例えば、3,7,1,2 の集合から 和が 9 になる解を求める場合を考えます。初期状態は以下の通り。初期値の -1 は、ここでは空白で表しています。配列のインデックスが部分和を表しています。与えられた数は 9 なので、部分和が 9以下の場合を調べようといことです。先に示した処理をすると、配列は、以下のように変化していきます。要素が-1でないインデックスは、0です。p[0+3]を見ると-1ですので、p[0+3]にmの値3を入れいます。要素が-1でない一番大きいインデックスは3です。しかし、3+7 &lt;= 9 ではないので、次のインデックスを見つけます。0が見つかります。なので、p[0+7]にmの値7を入れいます。要素が-1でない一番大きいインデックスは7です。しかし、7+1 &lt;= 9 なので、p[7+1]にmの値1を入れいます。
次の要素が-1でないインデックスは3ですから、p[3+1]にmの値1を入れます。さらに同様にして、p[0+1]にmの値1を入れます。どうようにして、p[7+1], p[4+2], p[3+2], p[0+2] に、mの値2を入れます。これだけだと分かりにくいので、ちょっと補足をします。最初の要素 3 に対して処理をした後の配列の内容はとなっています。p[3] に 3が入っていますが、これは、3（要素の値）を加えると 3（インデックスの値）になったという意味で、部分和が 3 になる部分集合は [3] であるということです。配列の最終的な状態は、となります。この配列には、-1 の要素がありませんので、[3,7,1,2]という集合からは、部分和 X に対して、1 &lt;= X &lt;= 9 のすべてに対して、部分集合が存在することを示しています。例えば、p[6] には2が入っていますが、これは、ある値に 2 を足すと 6 になること示しています。つまり、6 = 4 + 2 となることを示しています。そこで、部分和 4 を表す p[4] を見ると、値が 1なので、1 を足して 4 になったことが分かります。つまり、4 = 3 + 1 です。そこでさらに、部分和 3 を示す p[3] を見ると、p[3] は、 3 なので、3 = 0 + 3 となり、部分和が 3 となる部分集合は、[3] ということです。これらのことから、6 = 3 + 1 + 2 となることが分かるわけです。よって、部分和が 6 となる部分集合は [3, 1, 2]です。なお、例で示した問題では、部分和 9 が求めるターゲットなので、同様に p[9]からたどっていけば、7 + 2 で 9 が求まることが分かります。これから分かるように、ターゲットである p[target] が -1 から別の値に変化したら、解が求まったことになりますから、処理をここでストップしています。C#のコードを以下に示します。この記事は、Gushwell's C# Programming Pageで公開したものをに加筆・修正したものです。


