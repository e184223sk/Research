More than 1 year has passed since last update.この記事はSansan Advent Calendar 2018の12日目の記事です。
実は昨日までいろいろあって執筆したのは実は今日の昼です。マジで反省します。Azure の ARM Templete みたいにリソースの定義とその中で使えるBulit inの関数みたいなものが
プロジェクトで必要になりそうだったので、人知れず調べていました。（結果的にいらなくなったけど）Spracheというスペル書けるけど読めないライブラリがあることを知って使ってみたけど、下記の理由でどハマってしまいました…。同じ悩みを抱えちゃってるかもしれない人向けに記事書いてみることにしました。GitHubのリポジトリ以下のような文字列を関数としてパースすることを考えます。
"Coalesce(Concat($.data.property ,b) ,Concat(c ,d))"肝はコード中でも↓のParser定義部分なのですが、実は一番わかりにくいっていう（関数型言語のパラダイムでできている）
なので、コード内にコメントを入れつつ解説しますこれを理解できればサンプルの計算機が一体何をしているかわかるようになる…はずです。Parserを書くことなんてそうそうない気がしますが
「ある決まりを持って構造的に記述されたテキスト」なんかを処理するときにはとても有効です。
XMLやJSONであれば吐いて捨てるほどParserはありますが、ちょっとニッチなものや、
自社のシステムにしかないようなものだと自作するしかありません。
そんな時に便利…かもしれません。


