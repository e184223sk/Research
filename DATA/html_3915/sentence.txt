More than 1 year has passed since last update.ナンプレは、Number Placeの略で、9×9の正方形の枠内に、以下の規則にしたがって1〜9までの数字を入れていくパズルです。このパズルを解くのにいわゆるバックトラック法といわれる手法で解を求めています。その中心となるクラスが、Solverクラスです。コードは、この記事の後半で掲載しています。「マスに数字を置けるか?」とか「マスに数字を置く」などの操作は、すべてBoardクラスが担当していますので、Solverクラスは、とてもシンプルです。ちなみに、バックトラック法としてはかなりオーソドックスなコードだと思います。特に高速化のための工夫などはしていません。それでも、そこそこの速度は出ています。最後に示したテストデータの場合は、ほぼ待ち時間なく解が求まります。マスの空きが少ないブロック、行、列から攻めていくようにすれば、もう少し速度が上がると思いますが、そのコードを書くのが面倒なので手抜きしてます。なお、すべての解を求めるようにしています。なので、解がものすごく多いデータを与えると、いつまでたっても終わらない可能性があります。もし、一つだけ解を求めたい場合は、Mainメソッドで、のようにすれば、OKです。データはファイルから読み取るようになっています。以下、すべてのソースコードです。(GitHubでも公開しています)データを読み込み、SolverクラスのSolveメソッドを呼び出し解（複数）を求めて、その結果を表示しています。空いている箇所に条件にあう数字があれば、その数字を置く、という処理を再帰的に繰り返しています。条件に合う数字がない場合には、その手は失敗なので、逆戻りして、別の数字を置くようにしています。空いている場所はどこかとか、指定した数字が置けるかといった処理は、Boardクラスが担当しています。位置を示すクラスです。9×9の正方形を表すクラスで、この正方形に関わる様々なメソッドを定義しています。以下の示すデータを与えて、解いてみました。データの0は空いていることを示しています。
ここでは、あえて、複数の解を持つ問題を解かせてみました。２つの解が求まりました。


