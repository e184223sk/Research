WPFで開発をしている時に、コントロールによってタブでフォーカスが移らないようにIsTabStopをFalseにすることがあります。
ところが、ComboBoxでIsTabStopをFalseにしても、IsEditableをTrueにしてしまうと、タブで移動してしまうという現象が発生します。
開発当時、まだWPFを勉強し始めたころは、もうチンプンカンプンで、何が起きているのかわかりませんでした。
とりあえず慌ててググッて、対策を・・・ということをしてきましたが、今なら落ちついて(笑)考察できるようになったので、原因と対策を書き留めておこうと思います。ComboBoxでIsTabStopを設定した場合、当然ComboBox自体にこのプロパティがセットされるのですが、どうやらIsEditable=Trueにすると、ComboBox内のPART_EditableTextBoxが使用されるみたいです。
この時問題なのが、ComboBoxのControlTemplateで、MicrosoftのComboBox のスタイルとテンプレートをみるとこうなっています。なんと、IsTabStopの項目がないです。
だから、IsEditable=Trueにすると、IsTabStopはもう関係なしということで、何をしても必ずタブが移ってしまいます。一つ目の対策としては、Window.Resourcesとか、App.xamlでリソースを設定して、ControlTemplateを書きますでも、これだととにかく長いリソースを書かないといけないのでめんどいです。
以前、他にもいじりたいところがあったので、ComboBoxExというカスタムコントロールを作って、そこでGeneric.xamlにリソースを書いて利用しました。
だけど、本当に面倒でした。また新規に開発するときに・・・と思うと嫌です(~_~;)二つ目の対策としては、コードビハインドに書いてしまうという方法です。
Window_Loadedに以下のようなコードを書きます。これで、ComboBoxのIsTabStopと連携して、タブで移動してこなくなります。最後に、ビヘイビアを作るという方法です。
コードビハインドと同じようなコードでBehaviorを作りますでこれをコントロールに当てはめるだいたいこんな感じでうまくいきました。
何か他にも方法をご存じの方がいましたら、教えていただけるとありがたいです。


