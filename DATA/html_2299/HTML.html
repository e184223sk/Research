<!DOCTYPE html><html><head><meta charset="utf-8" /><title>[C#] 自動UIテストで遊ぼう：生まれ変わったエッヂのはるかさんがクリスマスイブの予定を読み上げる（WinAppDriver でできること／できないこと） - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/CodeOne/items/6a7e75fc82f94b332f14" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="FKxWYcHvgQBurF++fbP6SQeayYL3VO0hrQSmvf2EQkumrBpI09NDtRznayOvEored4/AfKYMMNqLb9SESNtIdg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="[C#] 自動UIテストで遊ぼう：生まれ変わったエッヂのはるかさんがクリスマスイブの予定を読み上げる（WinAppDriver でできること／できないこと） - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XME1qWFNEb2g2cmxpNVZWU2VPRGh1T0N1ZU9EaU9PQnAtbUJpdU9Cdk9PQmh1LThtdWVVbi1PQnZ1T0NqT1draWVPQ2otT0JvLU9Cbi1PQ3FPT0RnLU9EZ3VPQnJ1T0JyLU9DaS1PQmktT0JsZU9Day1PQmpPT0NyLU9EcXVPQ3VlT0RudU9DdWVPQ3BPT0RsdU9CcnVTNmlPV3VtdU9Da3VpcXJlT0J2LVM0aXVPQmt1T0NpLS04aUZkcGJrRndjRVJ5YVhabGNpRGpnYWZpZ0tZJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWQ4YzNlMWZjYTEzODI4NGJjYmUxMGIzMTk0NWU1ZTdj&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRU52WkdWUGJtVSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTBhMTM0ZWM5MWU5MTE5NDZiZTQ5OWZjYWQyNmFmZTEx&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=2e3550a9737117ad3d3ac4d5328b959e"><meta property="og:description" content="祝！ Chromium 版 Microsoft Edge 正式リリース（ベータ版向けから書き換えました）


自動UIテストの世界へようこそ

単体テストの自動化はかなり浸透しましたが、UIテストの自動化は、特にクライアント Wind..."><meta content="https://qiita.com/CodeOne/items/6a7e75fc82f94b332f14" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,edge,自動化,appium,WinAppDriver" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-452eace3-c0ce-4dd4-af09-a92a941ca999"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FCodeOne%2Fitems%2F6a7e75fc82f94b332f14">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FCodeOne%2Fitems%2F6a7e75fc82f94b332f14">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-452eace3-c0ce-4dd4-af09-a92a941ca999">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-12-06T23:57:22.000+09:00","dateModified":"2020-03-08T00:26:36.000+09:00","headline":"[C#] 自動UIテストで遊ぼう：生まれ変わったエッヂのはるかさんがクリスマスイブの予定を読み上げる（WinAppDriver でできること／できないこと）","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XME1qWFNEb2g2cmxpNVZWU2VPRGh1T0N1ZU9EaU9PQnAtbUJpdU9Cdk9PQmh1LThtdWVVbi1PQnZ1T0NqT1draWVPQ2otT0JvLU9Cbi1PQ3FPT0RnLU9EZ3VPQnJ1T0JyLU9DaS1PQmktT0JsZU9Day1PQmpPT0NyLU9EcXVPQ3VlT0RudU9DdWVPQ3BPT0RsdU9CcnVTNmlPV3VtdU9Da3VpcXJlT0J2LVM0aXVPQmt1T0NpLS04aUZkcGJrRndjRVJ5YVhabGNpRGpnYWZpZ0tZJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWQ4YzNlMWZjYTEzODI4NGJjYmUxMGIzMTk0NWU1ZTdj\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRU52WkdWUGJtVSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTBhMTM0ZWM5MWU5MTE5NDZiZTQ5OWZjYWQyNmFmZTEx\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=2e3550a9737117ad3d3ac4d5328b959e","mainEntityOfPage":"https://qiita.com/CodeOne/items/6a7e75fc82f94b332f14","author":{"@type":"Person","address":"","email":"public@codeone.jp","identifier":"CodeOne","name":"CodeOne","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F335669%2Fprofile-images%2F1546497723?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d065bb7eb81ec93789852af0e352faa5","url":"https://qiita.com/CodeOne","description":"【品質と生産性にこだわるシステム開発】 .NET（C#/VB.NET）リモート開発支援。即日・15分から頼める常駐しないエンジニア。確かな技術で開発チームを手堅くサポートします。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"CodeOne","type":"items","id":"6a7e75fc82f94b332f14"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"CodeOne","type":"items","id":"6a7e75fc82f94b332f14"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"CodeOne","type":"items","id":"6a7e75fc82f94b332f14"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/CodeOne/items/6a7e75fc82f94b332f14","location":"/CodeOne/items/6a7e75fc82f94b332f14","scheme":"https","host":"qiita.com","port":null,"pathname":"/CodeOne/items/6a7e75fc82f94b332f14","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"MUPrz91DRPZcgJ7HvxVBbI14X/aooapxjcs5SFeRZhuDQ6fmz3+GQy7LqlpttDH7/W1WCPn5d4qroEtx4s5sJg==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-d8c1bdff-a54d-41d8-81ec-34327ff34e69"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/CodeOne/items/6a7e75fc82f94b332f14/likers" class="css-1iupg5d">6</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">3</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6a7e75fc82f94b332f14/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/CodeOne/items/6a7e75fc82f94b332f14/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/CodeOne/items/6a7e75fc82f94b332f14/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/CodeOne/items/6a7e75fc82f94b332f14/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/CodeOne/items/6a7e75fc82f94b332f14.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2019/c-sharp" class="it-AdcalRibbon_title">C#<!-- --> Advent Calendar<!-- --> <!-- -->2019</a>Day 7</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/CodeOne"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/335669/profile-images/1546497723" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/CodeOne" class="css-10ougpm">@<!-- -->CodeOne</a><div class="css-1ay9vb9"><span><meta content="2019-12-06T14:57:22Z"/><time dateTime="2020-03-07T15:26:36Z" class="css-m19uds">updated at 2020-03-07</time></span></div></div></div></div></div><h1 class="css-cgzq40">[C#] 自動UIテストで遊ぼう：生まれ変わったエッヂのはるかさんがクリスマスイブの予定を読み上げる（WinAppDriver でできること／できないこと）</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/edge" class="css-4czcte">edge</a><a href="/tags/%e8%87%aa%e5%8b%95%e5%8c%96" class="css-4czcte">自動化</a><a href="/tags/appium" class="css-4czcte">appium</a><a href="/tags/winappdriver" class="css-4czcte">WinAppDriver</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><font color="red">祝！ Chromium 版 Microsoft Edge 正式リリース（ベータ版向けから書き換えました）</font></p>

<h1>
<span id="自動uiテストの世界へようこそ" class="fragment"></span><a href="#%E8%87%AA%E5%8B%95ui%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E4%B8%96%E7%95%8C%E3%81%B8%E3%82%88%E3%81%86%E3%81%93%E3%81%9D"><i class="fa fa-link"></i></a>自動UIテストの世界へようこそ</h1>

<p>単体テストの自動化はかなり浸透しましたが、UIテストの自動化は、特にクライアント Windows アプリケーションにおいて、まだあまり活用されていないようです。<br>
<strong>プログラム変更のたび、リリースのたびに繰り返されるリグレッションテストで工数削減の威力を発揮</strong>しますので、今まで触れる機会のなかった方も、楽しみながら導入を検討してみてはいかがでしょうか。</p>

<p><a href="https://github.com/microsoft/WinAppDriver" rel="nofollow noopener" target="_blank">WinAppDriver（Windows Application Driver）</a>は、Microsoft で開発されている Windows アプリケーション（UWP／Windows フォーム／WPF／Win32）のUIテスト自動化のためのサービスです。<br>
ここでは C# から、一般的には Selenium で扱うブラウザを操作することで、<strong>WinAppDriver の限界に挑戦し、できること／できないことを明らかに</strong>しようと思います。</p>

<h1>
<span id="この記事で得られる知見" class="fragment"></span><a href="#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%A7%E5%BE%97%E3%82%89%E3%82%8C%E3%82%8B%E7%9F%A5%E8%A6%8B"><i class="fa fa-link"></i></a>この記事で得られる知見</h1>

<h2>
<span id="appium--winappdriver-での-windows-アプリケーション操作" class="fragment"></span><a href="#appium--winappdriver-%E3%81%A7%E3%81%AE-windows-%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E6%93%8D%E4%BD%9C"><i class="fa fa-link"></i></a>Appium + WinAppDriver での Windows アプリケーション操作</h2>

<ul>
<li>Selenium などから Web アプリケーションを操作する際はDOMベースで扱うところ、WinAppDriver の場合は「<a href="https://docs.microsoft.com/ja-jp/dotnet/framework/ui-automation/ui-automation-overview" rel="nofollow noopener" target="_blank">UIオートメーション</a>」を通して提供された情報だけで操作します。諸事情から（例を後述します）WinAppDriver でブラウザを扱う場合、どのように対処すればいいかがわかります。</li>
<li>難題に対処する過程で生まれた副産物として、通常の Windows アプリケーション操作でも役に立ちそうな手法やアイデアが含まれています。WinAppDriver 自体癖がありますので、困ったとき、ハマったときに見渡してみると、何かヒントが得られるかもしれません。</li>
</ul>

<h3>
<span id="注意" class="fragment"></span><a href="#%E6%B3%A8%E6%84%8F"><i class="fa fa-link"></i></a>注意</h3>

<p>この記事で扱っているのは、WinAppDriver の本来的な守備範囲からは少し外れる Web アプリケーションです。<br>
Windows アプリケーションの操作はこれほどたいへんではありませんので、初めて興味を持った方は「こんなにたいへんなら」と逃げ出さないでください。<br>
特にUI要素の特定など、ここでできないからといって C# や VB.NET で開発した Windows アプリケーションで同様のことが実現できないわけではありません。</p>

<h2>
<span id="chromium-ベースの新-microsoft-edge" class="fragment"></span><a href="#chromium-%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E6%96%B0-microsoft-edge"><i class="fa fa-link"></i></a>Chromium ベースの新 Microsoft Edge</h2>

<ul>
<li>UIオートメーションによる操作</li>
<li>音声読み上げの新しくなった点</li>
</ul>

<h1>
<span id="前提となる知見" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E3%81%A8%E3%81%AA%E3%82%8B%E7%9F%A5%E8%A6%8B"><i class="fa fa-link"></i></a>前提となる知見</h1>

<h2>
<span id="appium--winappdriver-でのブラウザ操作" class="fragment"></span><a href="#appium--winappdriver-%E3%81%A7%E3%81%AE%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E6%93%8D%E4%BD%9C"><i class="fa fa-link"></i></a>Appium + WinAppDriver でのブラウザ操作</h2>

<ul>
<li>Inspect や WinAppDriver UI Recorder で AutomationId を見つけても <code>By.Id</code> や <code>By.XPath</code> の属性指定で見つけられません。</li>
<li>すべての DOM 要素が <code>WindowsElement</code> として提供されるわけではありません。サンプル的にHTMLと照合してみた限りでは、以下のように対応していました。</li>
</ul>

<table>
<thead>
<tr>
<th>DOM 要素</th>
<th>WindowsElement 要素</th>
</tr>
</thead>
<tbody>
<tr>
<td>div（子要素あり）</td>
<td>TagName: <a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.windows.automation.controltype.group" rel="nofollow noopener" target="_blank">Group</a>
</td>
</tr>
<tr>
<td>div（テキストコンテンツ）</td>
<td>TagName: <a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.windows.automation.controltype.text" rel="nofollow noopener" target="_blank">Text</a>
</td>
</tr>
<tr>
<td>span</td>
<td>取得できない</td>
</tr>
</tbody>
</table>

<ul>
<li>その他いろいろ。Selenium の世界では当たり前にできる操作も、WinAppDriver では<a href="https://qiita.com/CodeOne/items/11656ace7021cd45ad98" id="reference-5e3d088ba622477121aa">苦労したり</a>できなかったりします。</li>
</ul>

<h1>
<span id="シナリオ" class="fragment"></span><a href="#%E3%82%B7%E3%83%8A%E3%83%AA%E3%82%AA"><i class="fa fa-link"></i></a>シナリオ</h1>

<ol>
<li>Google カレンダーにログインします。</li>
<li>10年前の12月24日のページを開きます。</li>
<li>年月を読み上げます。</li>
<li>当日（イブと言いつつ午前中から）に登録された全イベントのダイアログを順に開き、タイトルを読み上げていきます。</li>
<li>「2.」から「4.」を今年まで繰り返します。</li>
</ol>

<h1>
<span id="開発環境" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>開発環境</h1>

<h3>
<span id="開発プラットフォーム" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E3%83%97%E3%83%A9%E3%83%83%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0"><i class="fa fa-link"></i></a>開発プラットフォーム</h3>

<ul>
<li>.NET Core 3.0 - 3.1 または .NET Framework 4.5.2 以降</li>
<li>MSTest（Visual Studio 付属）</li>
</ul>

<p>※.NET 以外に Java や Python でも同様のことが実現できると思います。</p>

<h3>
<span id="開発言語" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E8%A8%80%E8%AA%9E"><i class="fa fa-link"></i></a>開発言語</h3>

<p>C#</p>

<h3>
<span id="依存ライブラリ" class="fragment"></span><a href="#%E4%BE%9D%E5%AD%98%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA"><i class="fa fa-link"></i></a>依存ライブラリ</h3>

<ul>
<li>Install-Package Appium.WebDriver -Version 4.1.1（以下を含む）

<ul>
<li>Selenium.WebDriver -Version 3.141.0</li>
<li>Selenium.Support -Version 3.141.0</li>
</ul>
</li>
</ul>

<h1>
<span id="実行環境" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>実行環境</h1>

<h3>
<span id="os" class="fragment"></span><a href="#os"><i class="fa fa-link"></i></a>OS</h3>

<p>Windows 10（言語設定：日本語）</p>

<h3>
<span id="microsoft-edgechromium-エンジン" class="fragment"></span><a href="#microsoft-edgechromium-%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3"><i class="fa fa-link"></i></a><a href="https://www.microsoftedgeinsider.com/ja-jp/download/" rel="nofollow noopener" target="_blank">Microsoft Edge（Chromium エンジン）</a>
</h3>

<p>動作確認バージョン：v79.0.309.65 (公式ビルド)<br>
※当初ベータ版でしたが、正式リリースに伴い、コードを書き替えました。</p>

<ul>
<li>読み上げの音声に「Microsoft Haruka Online - Japanese (Japan)」を選択する（<a href="https://blogs.windows.com/msedgedev/2019/08/14/cloud-powered-voices-microsoft-edge-chromium/" rel="nofollow noopener" target="_blank">参考</a>）。</li>
<li>ほかの Edge ウィンドウは閉じておく（理由は後述します）。</li>
</ul>

<h4>
<span id="なぜ-edgeしかも-chromium-エンジンの" class="fragment"></span><a href="#%E3%81%AA%E3%81%9C-edge%E3%81%97%E3%81%8B%E3%82%82-chromium-%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E3%81%AE"><i class="fa fa-link"></i></a>なぜ Edge？　しかも Chromium エンジンの</h4>

<p>年明け（2020年）1月15日に、Chromium エンジンを搭載した新しい Microsoft Edge<sup id="fnref1"><a href="#fn1" title="これまでの EdgeHTML 版 Edge は UWP アプリケーションでしたが、Chromium 版 Edge は Win32 アプリケーションとして開発されています。">1</a></sup> の<a href="https://blogs.windows.com/msedgedev/2019/11/04/edge-chromium-release-candidate-get-ready/#22j2x2j3Et7s2osK.97" rel="nofollow noopener" target="_blank">安定版がリリース</a>されます（→ました）。</p>

<p>Edge にはもともと標準で読み上げ機能がありましたが、新しい Edge では選択部分のみを読み上げることができるようになりました。<br>
Microsoft Azure のAIプラットフォーム Cognitive Services が提供するクラウドベースの「深層ニューラルネットワークによって強化された音声」も新たに追加されたということです（<a href="https://blogs.windows.com/msedgedev/2019/08/14/cloud-powered-voices-microsoft-edge-chromium/" rel="nofollow noopener" target="_blank">Microsoft Edge Blog</a>）。</p>

<h3>
<span id="winappdriver-windows-application-driver-v11" class="fragment"></span><a href="#winappdriver-windows-application-driver-v11"><i class="fa fa-link"></i></a><a href="https://github.com/microsoft/WinAppDriver" rel="nofollow noopener" target="_blank">WinAppDriver (Windows Application Driver)</a> v1.1</h3>

<ul>
<li>Windows の「開発者モード」を有効にしたうえで、管理者権限で起動しておく。</li>
</ul>

<h4>
<span id="なぜ-selenium-webdriver-でなく-winappdriver" class="fragment"></span><a href="#%E3%81%AA%E3%81%9C-selenium-webdriver-%E3%81%A7%E3%81%AA%E3%81%8F-winappdriver"><i class="fa fa-link"></i></a>なぜ Selenium WebDriver でなく WinAppDriver？</h4>

<ul>
<li>Edge の音声読み上げが実行できる。

<ul>
<li>Selenium では "element not interactable" となってしまう。</li>
</ul>
</li>
<li>Edge 通常（非オートメーション）起動時のユーザープロファイル（保存パスワードなど）をそのまま使用できる。

<ul>
<li>Selenium から EdgeDriver で起動すると、Chromium エンジンの Edge はオートメーションモードで動作し<sup id="fnref2"><a href="#fn2" title="Chrome 同様、情報バーに「自動テスト ソフトウェアによって制御されています」と表示されますので、Chromium の仕様と考えられます。">2</a></sup>、既定で一時的なプロファイルが使用される。</li>
</ul>
</li>
<li>バージョンごとに対応する WebDriver を用意（確認してダウンロード、手動配置）する必要がない。</li>
</ul>

<h3>
<span id="google-カレンダー" class="fragment"></span><a href="#google-%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"><i class="fa fa-link"></i></a>Google カレンダー</h3>

<ul>
<li>Chromium エンジンの Edge で自動ログインできる状態にしておく。</li>
<li>左サイトのメインメニューは閉じておく。</li>
<li>「通知の表示」ダイアログが出たら閉じておく。</li>
</ul>

<h1>
<span id="テストコード" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>テストコード</h1>

<p>では、コードを見ていきましょう。</p>

<p>最初に主たるテストメソッドです。<br>
詳細はここから呼ばれるメソッドごとに解説していきますので、目次だと思ってください。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">テストメソッド</span></div>
<div class="highlight"><pre class="with-code"><code><span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">ReadAloudChristmasEveEventsInDecade</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Edge 用の WindowsDriver</span>
    <span class="kt">var</span> <span class="n">driver</span> <span class="p">=</span> <span class="nf">CreateWindowsDriver</span><span class="p">();</span>

    <span class="c1">// 過去10年間 + 今年</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">int</span> <span class="n">year</span> <span class="k">in</span> <span class="n">Enumerable</span><span class="p">.</span><span class="nf">Range</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Today</span><span class="p">.</span><span class="n">Year</span> <span class="p">-</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span> <span class="p">+</span> <span class="m">1</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">eveDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>

        <span class="c1">// Google カレンダーで該当年12月24日のページを開く</span>
        <span class="nf">Navigate</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="s">$"https://calendar.google.com/calendar/r/day/</span><span class="p">{</span><span class="n">eveDate</span><span class="p">:</span><span class="n">yyyy</span><span class="p">/</span><span class="n">M</span><span class="p">/</span><span class="n">d</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>

        <span class="c1">// ヘッダの年月を読み上げる</span>
        <span class="kt">var</span> <span class="n">yearMonthElement</span> <span class="p">=</span> <span class="nf">WaitUntilElementToBe</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">By</span><span class="p">.</span><span class="nf">Name</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">eveDate</span><span class="p">:</span><span class="n">yyyy</span><span class="sc">'年'</span> <span class="n">M</span><span class="sc">'月'</span><span class="p">}</span><span class="s">"</span><span class="p">),</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>
        <span class="nf">ReadAloudUnselectableText</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">yearMonthElement</span><span class="p">,</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">5.5</span><span class="p">));</span>

        <span class="c1">// 全イベント（予定／リマインダー）</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">eventButton</span> <span class="k">in</span> <span class="nf">FindEventButtons</span><span class="p">(</span><span class="n">driver</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="c1">// イベントのタイトルを読み上げる</span>
            <span class="nf">ReadAloudEventTitle</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">eventButton</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Edge を閉じる</span>
    <span class="n">driver</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>流れはシナリオのとおりです。</p>

<p><code>driver</code> の <code>Dispose</code> で Edge ウィンドウが閉じられます。<br>
<code>using</code> で囲っていないのは、エラーが発生したとき開いたままにして原因を追うためです。</p>

<h2>
<span id="edge-用の-windowsdriver-を作成する" class="fragment"></span><a href="#edge-%E7%94%A8%E3%81%AE-windowsdriver-%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Edge 用の WindowsDriver を作成する</h2>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="nf">CreateWindowsDriver</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">remoteAddress</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"http://127.0.0.1:4723"</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">options</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AppiumOptions</span><span class="p">();</span>

    <span class="c1">// Chromium 版 Edge のEXEパス</span>
    <span class="n">options</span><span class="p">.</span><span class="nf">AddAdditionalCapability</span><span class="p">(</span><span class="s">"app"</span><span class="p">,</span> <span class="s">@"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;(</span><span class="n">remoteAddress</span><span class="p">,</span> <span class="n">options</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>WinAppDriver はローカル実行です。<br>
<code>AddAdditionalCapability</code> の <code>"app"</code> には、Chromium 版 Edge のインストールディレクトリ内にある msedge.exe を指定します。</p>

<h2>
<span id="ページ遷移する" class="fragment"></span><a href="#%E3%83%9A%E3%83%BC%E3%82%B8%E9%81%B7%E7%A7%BB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ページ遷移する</h2>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Navigate</span><span class="p">(</span><span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="n">driver</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">addressEditBox</span> <span class="p">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="nf">Name</span><span class="p">(</span><span class="s">"アドレスと検索バー"</span><span class="p">));</span>
    <span class="n">addressEditBox</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
    <span class="n">addressEditBox</span><span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

    <span class="c1">// 入力候補を消して検索実行</span>
    <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">1</span><span class="p">));</span>
    <span class="n">addressEditBox</span><span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Delete</span> <span class="p">+</span> <span class="n">Keys</span><span class="p">.</span><span class="n">Enter</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>指定したアドレスのページに遷移します。<br>
Selenium のように <code>Url</code> プロパティ設定一発とはいきません。<br>
アドレス欄を取得して <code>SendKeys</code> で入力していくわけですが、アドレス + Enter を渡すだけでは入力候補が適用されてしまうことがあります。<br>
これを防ぐために、<strong>[Delete] キーで入力候補を消してから Enter</strong> しています。</p>

<p>何かを契機にアドレス欄の入力が全角になってしまうことがありました。<br>
そうなると実行前にIMEモードを半角にしておいても、アドレス入力時に全角に切り替わってしまいます。<br>
発生時、ほかの Edge ウィンドウを開いており、ほかの Edge ウィンドウを閉じて再試行すると解消しました。<br>
たまたまかもしれませんが、<strong>ほかの Edge ウィンドウは閉じておく</strong>ことにします。</p>

<h2>
<span id="該当する要素が出現するまで待機する" class="fragment"></span><a href="#%E8%A9%B2%E5%BD%93%E3%81%99%E3%82%8B%E8%A6%81%E7%B4%A0%E3%81%8C%E5%87%BA%E7%8F%BE%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E5%BE%85%E6%A9%9F%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>該当する要素が出現するまで待機する</h2>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">単一要素が現れるまで待機</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="n">WindowsElement</span> <span class="nf">WaitUntilElementToBe</span><span class="p">(</span>
    <span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="n">driver</span><span class="p">,</span> <span class="n">By</span> <span class="n">elementBy</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">timeout</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nf">WaitUntilElementsToBe</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">elementBy</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="k">false</span><span class="p">).</span><span class="nf">First</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">要素群が現れるまで待機</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="n">ReadOnlyCollection</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="nf">WaitUntilElementsToBe</span><span class="p">(</span>
    <span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="n">driver</span><span class="p">,</span> <span class="n">By</span> <span class="n">elementsBy</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">timeout</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">allowEmpty</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ReadOnlyCollection</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="n">elements</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">try</span>
    <span class="p">{</span>
        <span class="k">new</span> <span class="nf">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">Until</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="n">elements</span> <span class="p">=</span> <span class="p">((</span><span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;)</span><span class="n">d</span><span class="p">).</span><span class="nf">FindElements</span><span class="p">(</span><span class="n">elementsBy</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">elements</span><span class="p">.</span><span class="nf">Any</span><span class="p">();</span>
            <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">WebDriverTimeoutException</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">allowEmpty</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">elements</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">throw</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">elements</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>単なる <code>FindElement</code> / <code>FindElements</code> メソッドでは、存在するはずなのに見つからないことがあります。<br>
<code>SeleniumExtras.WaitHelpers.ExpectedConditions</code> の <code>ElementToBeClickable</code> でも見つからないことがありました。<br>
そこでこのような<strong>タイムアウト付きの待機メソッド</strong>を実装して呼び出したところ、見つからない問題が発生しなくなりました。<br>
ここは汎用的に使えると思います。</p>

<h2>
<span id="年月を読み上げる" class="fragment"></span><a href="#%E5%B9%B4%E6%9C%88%E3%82%92%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B"><i class="fa fa-link"></i></a>年月を読み上げる</h2>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ReadAloudUnselectableText</span><span class="p">(</span>
    <span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="n">driver</span><span class="p">,</span> <span class="n">WindowsElement</span> <span class="n">element</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">readingTime</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">new</span> <span class="nf">Actions</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span>
        <span class="c1">// 要素のコンテキストメニューを開き</span>
        <span class="p">.</span><span class="nf">ContextClick</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="c1">// 音声読み上げのショートカットキー "U" を送る</span>
        <span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="s">"U"</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">Perform</span><span class="p">();</span>

    <span class="c1">// 指定時間待って</span>
    <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">readingTime</span><span class="p">);</span>

    <span class="c1">// 読み上げを打ち切る</span>
    <span class="n">element</span><span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Escape</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>各年の初めに年月を読み上げますが、ヘッダの年月はテキスト選択できません。<br>
<strong>テキスト選択できないと「選択部分を音声で読み上げる」機能を実行できません。</strong><br>
コンテキストメニューに出てくるのは「音声で読み上げる」で、クリックするとその位置から読み上げが始まります。</p>

<p>対象要素が終わると次の要素を読み上げていきますので、<strong>時間を指定して [Escape] キーで強制的に打ち切ります</strong>。<br>
年月の場合、その次の要素の「日」（「にち」と読まれる）まで入ってしまうことがありますが、制限事項としてご容赦ください。</p>

<h2>
<span id="全イベントのボタン要素を取得する" class="fragment"></span><a href="#%E5%85%A8%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E8%A6%81%E7%B4%A0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>全イベントのボタン要素を取得する</h2>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="n">WindowsElement</span><span class="p">[]</span> <span class="nf">FindEventButtons</span><span class="p">(</span><span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="n">driver</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">grid</span> <span class="p">=</span> <span class="nf">WaitUntilElementToBe</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">"//*/DataGrid"</span><span class="p">),</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>
    <span class="kt">var</span> <span class="n">eventButtons</span> <span class="p">=</span> <span class="n">grid</span><span class="p">.</span><span class="nf">FindElements</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">"//*/Button"</span><span class="p">)).</span><span class="n">Cast</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;().</span><span class="nf">ToArray</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(!</span><span class="n">eventButtons</span><span class="p">.</span><span class="nf">Any</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="c1">// その年何もイベントがなかった</span>
        <span class="k">return</span> <span class="n">eventButtons</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 列ヘッダを取得</span>
    <span class="kt">var</span> <span class="n">headerElement</span> <span class="p">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">"//*/DataGrid/DataItem"</span><span class="p">));</span>

    <span class="c1">// Tab キーで先頭イベントに遷移できるよう、直前の要素（該当日の数字）にフォーカスを移す</span>
    <span class="kt">var</span> <span class="n">dayElement</span> <span class="p">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">"//*/DataGrid/DataItem/DataItem/Group[starts-with(@Name, \"12月 24日\")]"</span><span class="p">));</span>
    <span class="k">new</span> <span class="nf">Actions</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span>
        <span class="c1">// コンテキストメニューを開き</span>
        <span class="p">.</span><span class="nf">ContextClick</span><span class="p">(</span><span class="n">dayElement</span><span class="p">)</span>
        <span class="c1">// Escape キーでコンテキストメニュー解除</span>
        <span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Escape</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">Perform</span><span class="p">();</span>

    <span class="k">return</span> <span class="n">eventButtons</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>該当日のイベント（予定／リマインダー）ボタン要素をすべて取得</strong>します。<br>
祝日カレンダーを入れている場合、その予定も含まれます。</p>

<p>イベントボタン群が見つかったら、<strong>先頭イベントボタンの直前のタブ移動要素にフォーカス</strong>を移しておきます。<br>
これは少し説明が必要です。</p>

<p><strong>任意の部分だけ読み上げるには、テキストとして選択できなくてはいけません。</strong><br>
カレンダー上のタイトルはテキストとして選択できず、標準のコンテキストメニューも表示されませんので、イベントダイアログを開く必要があります。</p>

<p>登録されたイベント群のダイアログを表示するには、上から順にクリックしていけばいいわけですが、そう簡単にはいきません。<br>
隠れている要素も取得はできるのですが、<strong>隠れたままではクリックできない</strong>。<br>
ならばと <code>MoveToElement</code> しても隠れたまま。<br>
Google カレンダーの「日」ビューページでは、カレンダーの <code>div</code> 要素にスクロールがついています。<br>
そして、WinAppDriver 経由でこれをうまく操れそうにない。<br>
<a href="https://github.com/Microsoft/WinAppDriver/issues/485" rel="nofollow noopener" target="_blank">マウスホイールはサポートされていない</a>し、ドキュメント全体のスクロールではないので PageUp / PageDown も効きません。</p>

<p>なんとか方法はないかと手動で画面をいじっていると、<strong>[Tab] キーでイベントボタンを順に巡れる</strong>ことがわかりました。<br>
しかしどうやって先頭のボタンに移動するか。<br>
先頭のボタンから [Shift] + [Tab] で一つ戻ると左上の日を表す「24」にフォーカスが当たります。<br>
HTMLを調べると <code>div</code> 要素でした。<br>
ということは Group 要素として取れるはずです。<br>
WinAppDriverUiRecorder で調べると、XPath が <code>"/Group[@Name=\"12月 24日 (火曜日)\"]"</code> のようになっていました。<br>
曜日を取り除いて前方一致にすることでどの年にも対応できます。</p>

<h2>
<span id="イベントのタイトルを読み上げる" class="fragment"></span><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%82%92%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B"><i class="fa fa-link"></i></a>イベントのタイトルを読み上げる</h2>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ReadAloudEventTitle</span><span class="p">(</span><span class="n">WindowsDriver</span><span class="p">&lt;</span><span class="n">WindowsElement</span><span class="p">&gt;</span> <span class="n">driver</span><span class="p">,</span> <span class="n">WindowsElement</span> <span class="n">eventButton</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Tab キーで対象のイベントボタンに移動</span>
    <span class="k">new</span> <span class="nf">Actions</span><span class="p">(</span><span class="n">driver</span><span class="p">).</span><span class="nf">SendKeys</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Tab</span><span class="p">).</span><span class="nf">Perform</span><span class="p">();</span>

    <span class="c1">// 【例】18:00～24:00、残業&amp;amp;奇跡、仕事の予定、承諾済み、場所: 会社、2019年 12月 24日</span>
    <span class="kt">string</span> <span class="n">eventText</span> <span class="p">=</span> <span class="n">eventButton</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">eventText</span><span class="p">);</span>

    <span class="c1">// イベントダイアログを開く</span>
    <span class="n">eventButton</span><span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Enter</span><span class="p">);</span>

    <span class="c1">// タイトル文字列</span>
    <span class="kt">string</span> <span class="n">title</span> <span class="p">=</span> <span class="n">WebUtility</span><span class="p">.</span><span class="nf">HtmlDecode</span><span class="p">(</span><span class="n">eventButton</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="nf">Split</span><span class="p">(</span><span class="sc">'、'</span><span class="p">)[</span><span class="m">1</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">title</span> <span class="p">==</span> <span class="s">"タイトルなし"</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// タイトルなしは括弧をつける</span>
        <span class="n">title</span> <span class="p">=</span> <span class="s">$"（</span><span class="p">{</span><span class="n">title</span><span class="p">}</span><span class="s">）"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">title</span> <span class="p">=</span> <span class="n">Regex</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s">"^リマインダー: "</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>

    <span class="c1">// タイトル要素を見つける</span>
    <span class="n">WindowsElement</span> <span class="n">dialog</span><span class="p">;</span>
    <span class="n">By</span> <span class="n">titleElementBy</span><span class="p">;</span>
    <span class="n">WindowsElement</span> <span class="n">titleElement</span><span class="p">;</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="n">dialog</span> <span class="p">=</span> <span class="nf">WaitUntilElementToBe</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">$"//*/Pane[@Name=\"</span><span class="p">{</span><span class="n">title</span><span class="p">}</span><span class="s">\"]"</span><span class="p">),</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>
        <span class="n">titleElementBy</span> <span class="p">=</span> <span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">$"//*/Group/Text[@Name=\"</span><span class="p">{</span><span class="n">title</span><span class="p">}</span><span class="s">\"]"</span><span class="p">);</span>
        <span class="n">titleElement</span> <span class="p">=</span> <span class="p">(</span><span class="n">WindowsElement</span><span class="p">)</span><span class="n">dialog</span><span class="p">.</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">titleElementBy</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">WebDriverException</span> <span class="n">ex</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Fail</span><span class="p">(</span><span class="s">$"「</span><span class="p">{</span><span class="n">eventText</span><span class="p">}</span><span class="s">」のタイトル要素を見つけることができませんでした。"</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// タイトルの読み上げ</span>
    <span class="k">new</span> <span class="nf">Actions</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span>
        <span class="c1">// ダイアログ内をクリックしてアクティブにする</span>
        <span class="p">.</span><span class="nf">Click</span><span class="p">(</span><span class="n">titleElement</span><span class="p">)</span>
        <span class="c1">// タイトル欄の左上端まで移動</span>
        <span class="p">.</span><span class="nf">MoveToElement</span><span class="p">(</span><span class="n">whenElement</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="p">-</span><span class="m">50</span><span class="p">)</span>
        <span class="c1">// ドラッグを開始し</span>
        <span class="p">.</span><span class="nf">ClickAndHold</span><span class="p">()</span>
        <span class="c1">// タイトル欄の右端で</span>
        <span class="p">.</span><span class="nf">MoveByOffset</span><span class="p">(</span><span class="n">titleElement</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Width</span> <span class="p">+</span> <span class="m">10</span><span class="p">,</span> <span class="n">titleElement</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="m">20</span><span class="p">)</span>
        <span class="c1">// ドロップして</span>
        <span class="p">.</span><span class="nf">Release</span><span class="p">()</span>
        <span class="c1">// コンテキストメニューを開き</span>
        <span class="p">.</span><span class="nf">ContextClick</span><span class="p">()</span>
        <span class="c1">// 音声読み上げのショートカットキー "U" を送る</span>
        <span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="s">"U"</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">Perform</span><span class="p">();</span>

    <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">1</span><span class="p">));</span>

    <span class="c1">// 読み上げ終了待機</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="c1">// 「選択部分を音声で読み上げる」の終了を待つ</span>
        <span class="kt">var</span> <span class="n">readAloudBy</span> <span class="p">=</span> <span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">"//*/Document[@Name=\"音声で読み上げる\"]"</span><span class="p">);</span>
        <span class="k">new</span> <span class="nf">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">10</span><span class="p">))</span>
            <span class="p">.</span><span class="nf">Until</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="n">d</span><span class="p">.</span><span class="nf">FindElements</span><span class="p">(</span><span class="n">readAloudBy</span><span class="p">).</span><span class="nf">Any</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">WebDriverTimeoutException</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 「ここから音声で読み上げる」になっていた場合、強制的に打ち切る</span>
        <span class="kt">var</span> <span class="n">readAloudCloseButton</span> <span class="p">=</span> <span class="n">driver</span><span class="p">.</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="nf">XPath</span><span class="p">(</span><span class="s">"//*/ToolBar[@Name=\"音声で読み上げる\"]/Group/Group/Button[@Name=\"閉じる\"]"</span><span class="p">));</span>
        <span class="n">readAloudCloseButton</span><span class="p">.</span><span class="nf">Click</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// タイトル要素を再取得</span>
    <span class="n">titleElement</span> <span class="p">=</span> <span class="p">(</span><span class="n">WindowsElement</span><span class="p">)</span><span class="n">dialog</span><span class="p">.</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">titleElementBy</span><span class="p">);</span>

    <span class="c1">// 以降のショートカットを効かせるためにフォーカスを戻す</span>
    <span class="n">titleElement</span><span class="p">.</span><span class="nf">Click</span><span class="p">();</span>

    <span class="c1">// イベントダイアログを閉じる</span>
    <span class="n">titleElement</span><span class="p">.</span><span class="nf">SendKeys</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Escape</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>いよいよ本丸です。<br>
少し長いですが、一つ一つ解説していきます。</p>

<h3>
<span id="tab-キーで対象のイベントボタンに移動" class="fragment"></span><a href="#tab-%E3%82%AD%E3%83%BC%E3%81%A7%E5%AF%BE%E8%B1%A1%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AB%E7%A7%BB%E5%8B%95"><i class="fa fa-link"></i></a>[Tab] キーで対象のイベントボタンに移動</h3>

<p>[Tab] キーでイベントを巡るのは上で解説したとおりです。<br>
このメソッドはイベントごとに呼ばれますので、まず対象イベントボタンにフォーカスを移動して可視状態にします。</p>

<h3>
<span id="イベントダイアログを開く" class="fragment"></span><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0%E3%82%92%E9%96%8B%E3%81%8F"><i class="fa fa-link"></i></a>イベントダイアログを開く</h3>

<p>フォーカスが移ってアクティブな可視状態になったら、[Enter] キーでイベントダイアログを開きます。<br>
<code>Click</code> メソッドでは開かないことがあり、<code>WebDriverWait</code> で <code>ElementToBeClickable</code> 待機しても再発しましたので、クリック方式は見送りました。</p>

<h3>
<span id="タイトル要素を見つける" class="fragment"></span><a href="#%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E8%A6%81%E7%B4%A0%E3%82%92%E8%A6%8B%E3%81%A4%E3%81%91%E3%82%8B"><i class="fa fa-link"></i></a>タイトル要素を見つける</h3>

<p>イベントダイアログを開いたらタイトル要素を見つけます。</p>

<p>イベントボタンの <code>Text</code> プロパティには、<code>"18:00～24:00、残業&amp;amp;奇跡、仕事の予定、承諾済み、場所: 会社、2019年 12月 24日"</code> のような読点区切りの文字列が収められています。<br>
2番目の要素がタイトルです。<br>
例の &amp;amp; のようにHTMLエンコードされた状態で取得されますので、デコードします。<br>
さらにリマインダーは <code>"リマインダー: テストリマインダー"</code> のような書式ですので、キャプション部分を取り除きます。<br>
これでタイトルテキストになります。<br>
これを <code>By.XPath($"//*/Group/Text[@Name=\"{title}\"]")</code> のように渡し、ダイアログ要素からの相対でタイトル要素が取得できます。</p>

<h3>
<span id="タイトルの読み上げ" class="fragment"></span><a href="#%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%81%AE%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92"><i class="fa fa-link"></i></a>タイトルの読み上げ</h3>

<p>タイトルを選択して読み上げます。</p>

<h4>
<span id="テキスト選択" class="fragment"></span><a href="#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E9%81%B8%E6%8A%9E"><i class="fa fa-link"></i></a>テキスト選択</h4>

<p>まず、これが一筋縄ではいきませんでした。</p>

<p>タイトルは1文字、1単語から2行の折り返しまであります。<br>
3行以上の場合も2行で打ち切られ、省略記号（三点リーダー）付きで表示されます。</p>

<p>最初に思いついたのは<strong>トリプルクリック</strong>です。<br>
手動操作で試したところ、折り返される場合もうまく全選択できました。<br>
さらにいいことには、隠れていてマウスドラッグでは選択できなかった3行目以降までが選択され、読み上げの対象となりました。<br>
ただし、その状態でコンテキストメニューを開いて「選択部分を音声で読み上げる」を実行すると通知設定まで読まれてしまいます。<br>
改行まで選択されているためでしょう。<br>
[Ctrl] + [Shift] + [←] キーで改行を取り除くと、タイトルのみが読み上げられるようになりました。</p>

<p>このままめでたしとは行きません。<br>
<strong>トリプルクリック…できません</strong>。<br>
<code>IsActionExecutor</code> が <code>true</code> の Driver であれば <code>PointerInputDevice.CreatePointerDown</code>, <code>CreatePointerDown</code> の組み合わせで実現できそうですが、<code>WindowsDriver&lt;WindowsElement&gt;</code> + WinAppDriver ではサポートされておらず、<code>Click</code> や <code>DoubleClick</code> の組合せでも実現できませんでした。<br>
残念ですが、諦めましょう。</p>

<p>素直に<strong>タイトルテキストをドラッグ&amp;ドロップで選択</strong>することにします。<br>
起点はタイトル要素の左上端です。<br>
<code>Actions.MoveToElement</code> は要素のみの指定だとその要素の中央に移動しますが、オフセットを指定する場合は左上端が起点となります。<br>
ドラッグ&amp;ドロップは <strong><code>ClickAndHold</code> → <code>MoveByOffset</code> → <code>Release</code></strong> です。<br>
<code>Release</code> した後には <code>MoveByOffset</code> で選択領域内に移動しておくとより丁寧ですが、なくても動作しますので省きました。</p>

<p>タイトルが3行あると日時まで選択されてしまいますが、制限事項とさせていただきます。</p>

<h4>
<span id="読み上げと終了待機" class="fragment"></span><a href="#%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%81%A8%E7%B5%82%E4%BA%86%E5%BE%85%E6%A9%9F"><i class="fa fa-link"></i></a>読み上げと終了待機</h4>

<p>テキストを選択したら、<strong>コンテキストメニューから読み上げを実行</strong>します。<br>
読み上げ指示は年月と同じですが、今度は選択部分のみの読み上げですので、終了待機の方法が変わります。<br>
選択部分のみ読み上げる場合、<strong>終わると読み上げツールバーは自動的に閉じられますので、これを検出することで読み終えたと判断</strong>できそうです。</p>

<p>初めに <code>SeleniumExtras.WaitHelpers.ExpectedConditions.InvisibilityOfElementLocated</code> を試してみましたが、要素自体が消えるとエラーになってしまうようで、ここには使えませんでした。<br>
それでは <code>WebDriverWait</code> で <code>FindElements</code> が要素を返さなくなるまで待機することにしましょう。</p>

<p>ここもすんなりとは通してくれません。<br>
「旅行」の読み上げが止まらず、日時、時刻と突き進んでしまいます。<br>
よく見ると、<strong>コンテキストメニューが「選択部分を音声で読み上げる」でなく「ここから音声で読み上げる」に</strong>なっています。<br>
確かな基準は不明ですが、<strong>2文字以内の単語</strong>や「マススパー」「クリスマスイブ」のような<strong>日本語として一つになった単語、「12345678」のような数字のみで発生</strong>します。<br>
これは手動操作でも同じでした。<br>
であれば仕方ありません。<br>
<strong><code>WebDriverWait</code> に設定したタイムアウトを経過すると <code>WebDriverTimeoutException</code> が発生しますので、捕捉して強制的に打ち切る</strong>ことにしましょう。<br>
そのうちきちんと「選択部分を音声で読み上げる」になるよう、 Edge で修正されるかもしれませんが、それまでは制限事項です。</p>

<h3>
<span id="イベントダイアログを閉じる" class="fragment"></span><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0%E3%82%92%E9%96%89%E3%81%98%E3%82%8B"><i class="fa fa-link"></i></a>イベントダイアログを閉じる</h3>

<p>読み上げ後、そのままだとダイアログに対してショートカットが効きません。<br>
<strong>タイトル要素をクリックしてフォーカスを戻してから、[Escape] キー</strong>でイベントダイアログを閉じます。<br>
タイトル要素は上ですでに取得していますが、読み上げ後には再取得が必要です。</p>

<h1>
<span id="制限事項" class="fragment"></span><a href="#%E5%88%B6%E9%99%90%E4%BA%8B%E9%A0%85"><i class="fa fa-link"></i></a>制限事項</h1>

<ul>
<li>思いつく限りのイベントの登録パターンに対応しましたが、対応できていないパターンもあるかもしれません。</li>
<li>特定の環境でしかテストはしていません。うまくいかないときは引数、プロパティの数値など調整してみてください。</li>
<li>その他本文内に記載しています。</li>
</ul>

<h1>
<span id="感想" class="fragment"></span><a href="#%E6%84%9F%E6%83%B3"><i class="fa fa-link"></i></a>感想</h1>

<p>ベータ版ではすんなり行かないことが多く、試行錯誤の連続でしたが、正式リリース版ではそうした問題がかなり解消されていました。</p>

<p>今回のような特別な要件がない限り、Web アプリケーションは Selenium で扱った方がいいですが、</p>

<ul>
<li>WinAppDriver でも頑張ればある程度はできる</li>
<li>それでもできないこともある</li>
</ul>

<p>を示すことができていれば、ひとまず挑戦してよかったと思います。</p>

<p>音声に関しては、新しく追加された「Haruka Online」は「Haruka」よりは確かに機械っぽさが薄れた気はするものの、英語のたとえば「Jessa Online」の流暢さと比べるとぎこちなさは否めません。<br>
まだまだ改良の余地がありそうです。<br>
選択した部分だけ読み上げられるようになったのはいいですね。<br>
ちなみにこの記事も公開前、おかしなところがないかチェックするため、Haruka Online さんに読み上げてもらいました<sup id="fnref3"><a href="#fn3" title="コード部分を日本語で読み上げると凄いことになってちょっと面白いですね。英語に切り替えるとそれっぽく聞こえますが、飛ばしましょう。次の章の先頭文字を選択すると、そこから続行してくれます。">3</a></sup>。<br>
もう少し自然になればプレゼンとかでも使えそうです。</p>

<p>やりがいはありました。<br>
まだいろいろ遊べそうではあります。（またいつか、苦労を忘れた頃に）</p>

<hr>

<p>Qiita に書くようになって初めての Advent Calendar に参加してみました。<br>
クリスマスにちなんだ記事にしましたが、もっと C# っぽいことを書くべきだったかもしれません…ご寛容を。</p>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p>これまでの EdgeHTML 版 Edge は UWP アプリケーションでしたが、Chromium 版 Edge は Win32 アプリケーションとして開発されています。 <a href="#fnref1">↩</a></p>
</li>

<li id="fn2">
<p>Chrome 同様、情報バーに「自動テスト ソフトウェアによって制御されています」と表示されますので、Chromium の仕様と考えられます。 <a href="#fnref2">↩</a></p>
</li>

<li id="fn3">
<p>コード部分を日本語で読み上げると凄いことになってちょっと面白いですね。英語に切り替えるとそれっぽく聞こえますが、飛ばしましょう。次の章の先頭文字を選択すると、そこから続行してくれます。 <a href="#fnref3">↩</a></p>
</li>

</ol>
</div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FCodeOne%2Fitems%2F6a7e75fc82f94b332f14&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FCodeOne%2Fitems%2F6a7e75fc82f94b332f14&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/CodeOne/items/6a7e75fc82f94b332f14/likers" class="css-1iupg5d">6</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">3</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6a7e75fc82f94b332f14/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/CodeOne/items/6a7e75fc82f94b332f14/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/CodeOne/items/6a7e75fc82f94b332f14/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/CodeOne/items/6a7e75fc82f94b332f14/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/CodeOne/items/6a7e75fc82f94b332f14.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-d8c1bdff-a54d-41d8-81ec-34327ff34e69">{"authorAnalyticsTrackingId":"UA-131645275-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-f7eeb8e3-d30c-433e-ab5e-584357a9f664"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-f7eeb8e3-d30c-433e-ab5e-584357a9f664">{}</script>
      
<div id="LoginModal-react-component-05b2ffb3-1d65-4351-b038-924a492d9713"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-05b2ffb3-1d65-4351-b038-924a492d9713">{}</script>
      
<div id="StockModal-react-component-19bcb766-fb24-4bd2-bd49-6983d0391282"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-19bcb766-fb24-4bd2-bd49-6983d0391282">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;Wak/xXyEYrhZP55ofwavyV74164dT2K1nbQh9LIPD8XrqXPsbrigDSt0qvWtp99eLu3eUEwXv06731PNB1AF+A==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003cfont color=\"red\"\u003e祝！ Chromium 版 Microsoft Edge 正式リリース（ベータ版向けから書き換えました）\u003c/font\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"自動uiテストの世界へようこそ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%87%AA%E5%8B%95ui%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E4%B8%96%E7%95%8C%E3%81%B8%E3%82%88%E3%81%86%E3%81%93%E3%81%9D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e自動UIテストの世界へようこそ\u003c/h1\u003e\n\n\u003cp\u003e単体テストの自動化はかなり浸透しましたが、UIテストの自動化は、特にクライアント Windows アプリケーションにおいて、まだあまり活用されていないようです。\u003cbr\u003e\n\u003cstrong\u003eプログラム変更のたび、リリースのたびに繰り返されるリグレッションテストで工数削減の威力を発揮\u003c/strong\u003eしますので、今まで触れる機会のなかった方も、楽しみながら導入を検討してみてはいかがでしょうか。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/microsoft/WinAppDriver\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWinAppDriver（Windows Application Driver）\u003c/a\u003eは、Microsoft で開発されている Windows アプリケーション（UWP／Windows フォーム／WPF／Win32）のUIテスト自動化のためのサービスです。\u003cbr\u003e\nここでは C# から、一般的には Selenium で扱うブラウザを操作することで、\u003cstrong\u003eWinAppDriver の限界に挑戦し、できること／できないことを明らかに\u003c/strong\u003eしようと思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"この記事で得られる知見\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%A7%E5%BE%97%E3%82%89%E3%82%8C%E3%82%8B%E7%9F%A5%E8%A6%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eこの記事で得られる知見\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"appium--winappdriver-での-windows-アプリケーション操作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#appium--winappdriver-%E3%81%A7%E3%81%AE-windows-%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E6%93%8D%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAppium + WinAppDriver での Windows アプリケーション操作\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eSelenium などから Web アプリケーションを操作する際はDOMベースで扱うところ、WinAppDriver の場合は「\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/framework/ui-automation/ui-automation-overview\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUIオートメーション\u003c/a\u003e」を通して提供された情報だけで操作します。諸事情から（例を後述します）WinAppDriver でブラウザを扱う場合、どのように対処すればいいかがわかります。\u003c/li\u003e\n\u003cli\u003e難題に対処する過程で生まれた副産物として、通常の Windows アプリケーション操作でも役に立ちそうな手法やアイデアが含まれています。WinAppDriver 自体癖がありますので、困ったとき、ハマったときに見渡してみると、何かヒントが得られるかもしれません。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"注意\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B3%A8%E6%84%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e注意\u003c/h3\u003e\n\n\u003cp\u003eこの記事で扱っているのは、WinAppDriver の本来的な守備範囲からは少し外れる Web アプリケーションです。\u003cbr\u003e\nWindows アプリケーションの操作はこれほどたいへんではありませんので、初めて興味を持った方は「こんなにたいへんなら」と逃げ出さないでください。\u003cbr\u003e\n特にUI要素の特定など、ここでできないからといって C# や VB.NET で開発した Windows アプリケーションで同様のことが実現できないわけではありません。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"chromium-ベースの新-microsoft-edge\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#chromium-%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E6%96%B0-microsoft-edge\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eChromium ベースの新 Microsoft Edge\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eUIオートメーションによる操作\u003c/li\u003e\n\u003cli\u003e音声読み上げの新しくなった点\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前提となる知見\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90%E3%81%A8%E3%81%AA%E3%82%8B%E7%9F%A5%E8%A6%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提となる知見\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"appium--winappdriver-でのブラウザ操作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#appium--winappdriver-%E3%81%A7%E3%81%AE%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E6%93%8D%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAppium + WinAppDriver でのブラウザ操作\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eInspect や WinAppDriver UI Recorder で AutomationId を見つけても \u003ccode\u003eBy.Id\u003c/code\u003e や \u003ccode\u003eBy.XPath\u003c/code\u003e の属性指定で見つけられません。\u003c/li\u003e\n\u003cli\u003eすべての DOM 要素が \u003ccode\u003eWindowsElement\u003c/code\u003e として提供されるわけではありません。サンプル的にHTMLと照合してみた限りでは、以下のように対応していました。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eDOM 要素\u003c/th\u003e\n\u003cth\u003eWindowsElement 要素\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ediv（子要素あり）\u003c/td\u003e\n\u003ctd\u003eTagName: \u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/api/system.windows.automation.controltype.group\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGroup\u003c/a\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ediv（テキストコンテンツ）\u003c/td\u003e\n\u003ctd\u003eTagName: \u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/api/system.windows.automation.controltype.text\" rel=\"nofollow noopener\" target=\"_blank\"\u003eText\u003c/a\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003espan\u003c/td\u003e\n\u003ctd\u003e取得できない\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cul\u003e\n\u003cli\u003eその他いろいろ。Selenium の世界では当たり前にできる操作も、WinAppDriver では\u003ca href=\"https://qiita.com/CodeOne/items/11656ace7021cd45ad98\" id=\"reference-5e3d088ba622477121aa\"\u003e苦労したり\u003c/a\u003eできなかったりします。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"シナリオ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B7%E3%83%8A%E3%83%AA%E3%82%AA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eシナリオ\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eGoogle カレンダーにログインします。\u003c/li\u003e\n\u003cli\u003e10年前の12月24日のページを開きます。\u003c/li\u003e\n\u003cli\u003e年月を読み上げます。\u003c/li\u003e\n\u003cli\u003e当日（イブと言いつつ午前中から）に登録された全イベントのダイアログを順に開き、タイトルを読み上げていきます。\u003c/li\u003e\n\u003cli\u003e「2.」から「4.」を今年まで繰り返します。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"開発環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e開発環境\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"開発プラットフォーム\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%8B%E7%99%BA%E3%83%97%E3%83%A9%E3%83%83%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e開発プラットフォーム\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e.NET Core 3.0 - 3.1 または .NET Framework 4.5.2 以降\u003c/li\u003e\n\u003cli\u003eMSTest（Visual Studio 付属）\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e※.NET 以外に Java や Python でも同様のことが実現できると思います。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"開発言語\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%8B%E7%99%BA%E8%A8%80%E8%AA%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e開発言語\u003c/h3\u003e\n\n\u003cp\u003eC#\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"依存ライブラリ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%9D%E5%AD%98%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e依存ライブラリ\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eInstall-Package Appium.WebDriver -Version 4.1.1（以下を含む）\n\n\u003cul\u003e\n\u003cli\u003eSelenium.WebDriver -Version 3.141.0\u003c/li\u003e\n\u003cli\u003eSelenium.Support -Version 3.141.0\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"実行環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行環境\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"os\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#os\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eOS\u003c/h3\u003e\n\n\u003cp\u003eWindows 10（言語設定：日本語）\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"microsoft-edgechromium-エンジン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#microsoft-edgechromium-%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://www.microsoftedgeinsider.com/ja-jp/download/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMicrosoft Edge（Chromium エンジン）\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e動作確認バージョン：v79.0.309.65 (公式ビルド)\u003cbr\u003e\n※当初ベータ版でしたが、正式リリースに伴い、コードを書き替えました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e読み上げの音声に「Microsoft Haruka Online - Japanese (Japan)」を選択する（\u003ca href=\"https://blogs.windows.com/msedgedev/2019/08/14/cloud-powered-voices-microsoft-edge-chromium/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e参考\u003c/a\u003e）。\u003c/li\u003e\n\u003cli\u003eほかの Edge ウィンドウは閉じておく（理由は後述します）。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"なぜ-edgeしかも-chromium-エンジンの\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AA%E3%81%9C-edge%E3%81%97%E3%81%8B%E3%82%82-chromium-%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E3%81%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eなぜ Edge？　しかも Chromium エンジンの\u003c/h4\u003e\n\n\u003cp\u003e年明け（2020年）1月15日に、Chromium エンジンを搭載した新しい Microsoft Edge\u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" title=\"これまでの EdgeHTML 版 Edge は UWP アプリケーションでしたが、Chromium 版 Edge は Win32 アプリケーションとして開発されています。\"\u003e1\u003c/a\u003e\u003c/sup\u003e の\u003ca href=\"https://blogs.windows.com/msedgedev/2019/11/04/edge-chromium-release-candidate-get-ready/#22j2x2j3Et7s2osK.97\" rel=\"nofollow noopener\" target=\"_blank\"\u003e安定版がリリース\u003c/a\u003eされます（→ました）。\u003c/p\u003e\n\n\u003cp\u003eEdge にはもともと標準で読み上げ機能がありましたが、新しい Edge では選択部分のみを読み上げることができるようになりました。\u003cbr\u003e\nMicrosoft Azure のAIプラットフォーム Cognitive Services が提供するクラウドベースの「深層ニューラルネットワークによって強化された音声」も新たに追加されたということです（\u003ca href=\"https://blogs.windows.com/msedgedev/2019/08/14/cloud-powered-voices-microsoft-edge-chromium/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMicrosoft Edge Blog\u003c/a\u003e）。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"winappdriver-windows-application-driver-v11\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#winappdriver-windows-application-driver-v11\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://github.com/microsoft/WinAppDriver\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWinAppDriver (Windows Application Driver)\u003c/a\u003e v1.1\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows の「開発者モード」を有効にしたうえで、管理者権限で起動しておく。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"なぜ-selenium-webdriver-でなく-winappdriver\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AA%E3%81%9C-selenium-webdriver-%E3%81%A7%E3%81%AA%E3%81%8F-winappdriver\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eなぜ Selenium WebDriver でなく WinAppDriver？\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eEdge の音声読み上げが実行できる。\n\n\u003cul\u003e\n\u003cli\u003eSelenium では \"element not interactable\" となってしまう。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eEdge 通常（非オートメーション）起動時のユーザープロファイル（保存パスワードなど）をそのまま使用できる。\n\n\u003cul\u003e\n\u003cli\u003eSelenium から EdgeDriver で起動すると、Chromium エンジンの Edge はオートメーションモードで動作し\u003csup id=\"fnref2\"\u003e\u003ca href=\"#fn2\" title=\"Chrome 同様、情報バーに「自動テスト ソフトウェアによって制御されています」と表示されますので、Chromium の仕様と考えられます。\"\u003e2\u003c/a\u003e\u003c/sup\u003e、既定で一時的なプロファイルが使用される。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eバージョンごとに対応する WebDriver を用意（確認してダウンロード、手動配置）する必要がない。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"google-カレンダー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#google-%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eGoogle カレンダー\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eChromium エンジンの Edge で自動ログインできる状態にしておく。\u003c/li\u003e\n\u003cli\u003e左サイトのメインメニューは閉じておく。\u003c/li\u003e\n\u003cli\u003e「通知の表示」ダイアログが出たら閉じておく。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"テストコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテストコード\u003c/h1\u003e\n\n\u003cp\u003eでは、コードを見ていきましょう。\u003c/p\u003e\n\n\u003cp\u003e最初に主たるテストメソッドです。\u003cbr\u003e\n詳細はここから呼ばれるメソッドごとに解説していきますので、目次だと思ってください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eテストメソッド\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadAloudChristmasEveEventsInDecade\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Edge 用の WindowsDriver\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 過去10年間 + 今年\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eyear\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToday\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eYear\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeveDate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eyear\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e24\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Google カレンダーで該当年12月24日のページを開く\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eNavigate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"https://calendar.google.com/calendar/r/day/\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eeveDate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eyyyy\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eM\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ヘッダの年月を読み上げる\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eyearMonthElement\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eWaitUntilElementToBe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eeveDate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eyyyy\u003c/span\u003e\u003cspan class=\"sc\"\u003e'年'\u003c/span\u003e \u003cspan class=\"n\"\u003eM\u003c/span\u003e\u003cspan class=\"sc\"\u003e'月'\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eReadAloudUnselectableText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eyearMonthElement\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e5.5\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 全イベント（予定／リマインダー）\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeventButton\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"nf\"\u003eFindEventButtons\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// イベントのタイトルを読み上げる\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eReadAloudEventTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eeventButton\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Edge を閉じる\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e流れはシナリオのとおりです。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003edriver\u003c/code\u003e の \u003ccode\u003eDispose\u003c/code\u003e で Edge ウィンドウが閉じられます。\u003cbr\u003e\n\u003ccode\u003eusing\u003c/code\u003e で囲っていないのは、エラーが発生したとき開いたままにして原因を追うためです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"edge-用の-windowsdriver-を作成する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#edge-%E7%94%A8%E3%81%AE-windowsdriver-%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEdge 用の WindowsDriver を作成する\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eremoteAddress\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eUri\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://127.0.0.1:4723\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAppiumOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Chromium 版 Edge のEXEパス\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddAdditionalCapability\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"app\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eremoteAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eWinAppDriver はローカル実行です。\u003cbr\u003e\n\u003ccode\u003eAddAdditionalCapability\u003c/code\u003e の \u003ccode\u003e\"app\"\u003c/code\u003e には、Chromium 版 Edge のインストールディレクトリ内にある msedge.exe を指定します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ページ遷移する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9A%E3%83%BC%E3%82%B8%E9%81%B7%E7%A7%BB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eページ遷移する\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eNavigate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eaddressEditBox\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アドレスと検索バー\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eaddressEditBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eaddressEditBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 入力候補を消して検索実行\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eaddressEditBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDelete\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnter\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e指定したアドレスのページに遷移します。\u003cbr\u003e\nSelenium のように \u003ccode\u003eUrl\u003c/code\u003e プロパティ設定一発とはいきません。\u003cbr\u003e\nアドレス欄を取得して \u003ccode\u003eSendKeys\u003c/code\u003e で入力していくわけですが、アドレス + Enter を渡すだけでは入力候補が適用されてしまうことがあります。\u003cbr\u003e\nこれを防ぐために、\u003cstrong\u003e[Delete] キーで入力候補を消してから Enter\u003c/strong\u003e しています。\u003c/p\u003e\n\n\u003cp\u003e何かを契機にアドレス欄の入力が全角になってしまうことがありました。\u003cbr\u003e\nそうなると実行前にIMEモードを半角にしておいても、アドレス入力時に全角に切り替わってしまいます。\u003cbr\u003e\n発生時、ほかの Edge ウィンドウを開いており、ほかの Edge ウィンドウを閉じて再試行すると解消しました。\u003cbr\u003e\nたまたまかもしれませんが、\u003cstrong\u003eほかの Edge ウィンドウは閉じておく\u003c/strong\u003eことにします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"該当する要素が出現するまで待機する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A9%B2%E5%BD%93%E3%81%99%E3%82%8B%E8%A6%81%E7%B4%A0%E3%81%8C%E5%87%BA%E7%8F%BE%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E5%BE%85%E6%A9%9F%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e該当する要素が出現するまで待機する\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e単一要素が現れるまで待機\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e \u003cspan class=\"nf\"\u003eWaitUntilElementToBe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBy\u003c/span\u003e \u003cspan class=\"n\"\u003eelementBy\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003etimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eWaitUntilElementsToBe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eelementBy\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e要素群が現れるまで待機\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eReadOnlyCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eWaitUntilElementsToBe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBy\u003c/span\u003e \u003cspan class=\"n\"\u003eelementsBy\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003etimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eallowEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eReadOnlyCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eelements\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWebDriverWait\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUntil\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eelements\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;)\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElements\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelementsBy\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eelements\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWebDriverTimeoutException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eallowEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eelements\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eelements\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e単なる \u003ccode\u003eFindElement\u003c/code\u003e / \u003ccode\u003eFindElements\u003c/code\u003e メソッドでは、存在するはずなのに見つからないことがあります。\u003cbr\u003e\n\u003ccode\u003eSeleniumExtras.WaitHelpers.ExpectedConditions\u003c/code\u003e の \u003ccode\u003eElementToBeClickable\u003c/code\u003e でも見つからないことがありました。\u003cbr\u003e\nそこでこのような\u003cstrong\u003eタイムアウト付きの待機メソッド\u003c/strong\u003eを実装して呼び出したところ、見つからない問題が発生しなくなりました。\u003cbr\u003e\nここは汎用的に使えると思います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"年月を読み上げる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%B9%B4%E6%9C%88%E3%82%92%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e年月を読み上げる\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadAloudUnselectableText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e \u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003ereadingTime\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 要素のコンテキストメニューを開き\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContextClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 音声読み上げのショートカットキー \"U\" を送る\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"U\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePerform\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 指定時間待って\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereadingTime\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 読み上げを打ち切る\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEscape\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e各年の初めに年月を読み上げますが、ヘッダの年月はテキスト選択できません。\u003cbr\u003e\n\u003cstrong\u003eテキスト選択できないと「選択部分を音声で読み上げる」機能を実行できません。\u003c/strong\u003e\u003cbr\u003e\nコンテキストメニューに出てくるのは「音声で読み上げる」で、クリックするとその位置から読み上げが始まります。\u003c/p\u003e\n\n\u003cp\u003e対象要素が終わると次の要素を読み上げていきますので、\u003cstrong\u003e時間を指定して [Escape] キーで強制的に打ち切ります\u003c/strong\u003e。\u003cbr\u003e\n年月の場合、その次の要素の「日」（「にち」と読まれる）まで入ってしまうことがありますが、制限事項としてご容赦ください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"全イベントのボタン要素を取得する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%A8%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E8%A6%81%E7%B4%A0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e全イベントのボタン要素を取得する\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003eFindEventButtons\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003egrid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eWaitUntilElementToBe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"//*/DataGrid\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeventButtons\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElements\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"//*/Button\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"n\"\u003eCast\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eeventButtons\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// その年何もイベントがなかった\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eeventButtons\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 列ヘッダを取得\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eheaderElement\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"//*/DataGrid/DataItem\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Tab キーで先頭イベントに遷移できるよう、直前の要素（該当日の数字）にフォーカスを移す\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edayElement\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"//*/DataGrid/DataItem/DataItem/Group[starts-with(@Name, \\\"12月 24日\\\")]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// コンテキストメニューを開き\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContextClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edayElement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Escape キーでコンテキストメニュー解除\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEscape\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePerform\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eeventButtons\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003e該当日のイベント（予定／リマインダー）ボタン要素をすべて取得\u003c/strong\u003eします。\u003cbr\u003e\n祝日カレンダーを入れている場合、その予定も含まれます。\u003c/p\u003e\n\n\u003cp\u003eイベントボタン群が見つかったら、\u003cstrong\u003e先頭イベントボタンの直前のタブ移動要素にフォーカス\u003c/strong\u003eを移しておきます。\u003cbr\u003e\nこれは少し説明が必要です。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e任意の部分だけ読み上げるには、テキストとして選択できなくてはいけません。\u003c/strong\u003e\u003cbr\u003e\nカレンダー上のタイトルはテキストとして選択できず、標準のコンテキストメニューも表示されませんので、イベントダイアログを開く必要があります。\u003c/p\u003e\n\n\u003cp\u003e登録されたイベント群のダイアログを表示するには、上から順にクリックしていけばいいわけですが、そう簡単にはいきません。\u003cbr\u003e\n隠れている要素も取得はできるのですが、\u003cstrong\u003e隠れたままではクリックできない\u003c/strong\u003e。\u003cbr\u003e\nならばと \u003ccode\u003eMoveToElement\u003c/code\u003e しても隠れたまま。\u003cbr\u003e\nGoogle カレンダーの「日」ビューページでは、カレンダーの \u003ccode\u003ediv\u003c/code\u003e 要素にスクロールがついています。\u003cbr\u003e\nそして、WinAppDriver 経由でこれをうまく操れそうにない。\u003cbr\u003e\n\u003ca href=\"https://github.com/Microsoft/WinAppDriver/issues/485\" rel=\"nofollow noopener\" target=\"_blank\"\u003eマウスホイールはサポートされていない\u003c/a\u003eし、ドキュメント全体のスクロールではないので PageUp / PageDown も効きません。\u003c/p\u003e\n\n\u003cp\u003eなんとか方法はないかと手動で画面をいじっていると、\u003cstrong\u003e[Tab] キーでイベントボタンを順に巡れる\u003c/strong\u003eことがわかりました。\u003cbr\u003e\nしかしどうやって先頭のボタンに移動するか。\u003cbr\u003e\n先頭のボタンから [Shift] + [Tab] で一つ戻ると左上の日を表す「24」にフォーカスが当たります。\u003cbr\u003e\nHTMLを調べると \u003ccode\u003ediv\u003c/code\u003e 要素でした。\u003cbr\u003e\nということは Group 要素として取れるはずです。\u003cbr\u003e\nWinAppDriverUiRecorder で調べると、XPath が \u003ccode\u003e\"/Group[@Name=\\\"12月 24日 (火曜日)\\\"]\"\u003c/code\u003e のようになっていました。\u003cbr\u003e\n曜日を取り除いて前方一致にすることでどの年にも対応できます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"イベントのタイトルを読み上げる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%82%92%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eイベントのタイトルを読み上げる\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadAloudEventTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsDriver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e \u003cspan class=\"n\"\u003eeventButton\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Tab キーで対象のイベントボタンに移動\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTab\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ePerform\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 【例】18:00～24:00、残業\u0026amp;amp;奇跡、仕事の予定、承諾済み、場所: 会社、2019年 12月 24日\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eeventText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eeventButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eeventText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// イベントダイアログを開く\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eeventButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnter\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// タイトル文字列\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etitle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eWebUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eHtmlDecode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eeventButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sc\"\u003e'、'\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"タイトルなし\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// タイトルなしは括弧をつける\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etitle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"（\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e）\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etitle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^リマインダー: \"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// タイトル要素を見つける\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e \u003cspan class=\"n\"\u003edialog\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eBy\u003c/span\u003e \u003cspan class=\"n\"\u003etitleElementBy\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e \u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edialog\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eWaitUntilElementToBe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"//*/Pane[@Name=\\\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\\\"]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etitleElementBy\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"//*/Group/Text[@Name=\\\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\\\"]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003edialog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitleElementBy\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWebDriverException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFail\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"「\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eeventText\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e」のタイトル要素を見つけることができませんでした。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// タイトルの読み上げ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ダイアログ内をクリックしてアクティブにする\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// タイトル欄の左上端まで移動\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMoveToElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewhenElement\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ドラッグを開始し\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClickAndHold\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// タイトル欄の右端で\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMoveByOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ドロップして\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRelease\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// コンテキストメニューを開き\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContextClick\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 音声読み上げのショートカットキー \"U\" を送る\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"U\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePerform\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 読み上げ終了待機\u003c/span\u003e\n    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 「選択部分を音声で読み上げる」の終了を待つ\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ereadAloudBy\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"//*/Document[@Name=\\\"音声で読み上げる\\\"]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWebDriverWait\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUntil\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElements\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereadAloudBy\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWebDriverTimeoutException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 「ここから音声で読み上げる」になっていた場合、強制的に打ち切る\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ereadAloudCloseButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eXPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"//*/ToolBar[@Name=\\\"音声で読み上げる\\\"]/Group/Group/Button[@Name=\\\"閉じる\\\"]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ereadAloudCloseButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// タイトル要素を再取得\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowsElement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003edialog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitleElementBy\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 以降のショートカットを効かせるためにフォーカスを戻す\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// イベントダイアログを閉じる\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etitleElement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEscape\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eいよいよ本丸です。\u003cbr\u003e\n少し長いですが、一つ一つ解説していきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"tab-キーで対象のイベントボタンに移動\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tab-%E3%82%AD%E3%83%BC%E3%81%A7%E5%AF%BE%E8%B1%A1%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AB%E7%A7%BB%E5%8B%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[Tab] キーで対象のイベントボタンに移動\u003c/h3\u003e\n\n\u003cp\u003e[Tab] キーでイベントを巡るのは上で解説したとおりです。\u003cbr\u003e\nこのメソッドはイベントごとに呼ばれますので、まず対象イベントボタンにフォーカスを移動して可視状態にします。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"イベントダイアログを開く\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0%E3%82%92%E9%96%8B%E3%81%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eイベントダイアログを開く\u003c/h3\u003e\n\n\u003cp\u003eフォーカスが移ってアクティブな可視状態になったら、[Enter] キーでイベントダイアログを開きます。\u003cbr\u003e\n\u003ccode\u003eClick\u003c/code\u003e メソッドでは開かないことがあり、\u003ccode\u003eWebDriverWait\u003c/code\u003e で \u003ccode\u003eElementToBeClickable\u003c/code\u003e 待機しても再発しましたので、クリック方式は見送りました。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"タイトル要素を見つける\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E8%A6%81%E7%B4%A0%E3%82%92%E8%A6%8B%E3%81%A4%E3%81%91%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタイトル要素を見つける\u003c/h3\u003e\n\n\u003cp\u003eイベントダイアログを開いたらタイトル要素を見つけます。\u003c/p\u003e\n\n\u003cp\u003eイベントボタンの \u003ccode\u003eText\u003c/code\u003e プロパティには、\u003ccode\u003e\"18:00～24:00、残業\u0026amp;amp;奇跡、仕事の予定、承諾済み、場所: 会社、2019年 12月 24日\"\u003c/code\u003e のような読点区切りの文字列が収められています。\u003cbr\u003e\n2番目の要素がタイトルです。\u003cbr\u003e\n例の \u0026amp;amp; のようにHTMLエンコードされた状態で取得されますので、デコードします。\u003cbr\u003e\nさらにリマインダーは \u003ccode\u003e\"リマインダー: テストリマインダー\"\u003c/code\u003e のような書式ですので、キャプション部分を取り除きます。\u003cbr\u003e\nこれでタイトルテキストになります。\u003cbr\u003e\nこれを \u003ccode\u003eBy.XPath($\"//*/Group/Text[@Name=\\\"{title}\\\"]\")\u003c/code\u003e のように渡し、ダイアログ要素からの相対でタイトル要素が取得できます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"タイトルの読み上げ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%81%AE%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタイトルの読み上げ\u003c/h3\u003e\n\n\u003cp\u003eタイトルを選択して読み上げます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"テキスト選択\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E9%81%B8%E6%8A%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテキスト選択\u003c/h4\u003e\n\n\u003cp\u003eまず、これが一筋縄ではいきませんでした。\u003c/p\u003e\n\n\u003cp\u003eタイトルは1文字、1単語から2行の折り返しまであります。\u003cbr\u003e\n3行以上の場合も2行で打ち切られ、省略記号（三点リーダー）付きで表示されます。\u003c/p\u003e\n\n\u003cp\u003e最初に思いついたのは\u003cstrong\u003eトリプルクリック\u003c/strong\u003eです。\u003cbr\u003e\n手動操作で試したところ、折り返される場合もうまく全選択できました。\u003cbr\u003e\nさらにいいことには、隠れていてマウスドラッグでは選択できなかった3行目以降までが選択され、読み上げの対象となりました。\u003cbr\u003e\nただし、その状態でコンテキストメニューを開いて「選択部分を音声で読み上げる」を実行すると通知設定まで読まれてしまいます。\u003cbr\u003e\n改行まで選択されているためでしょう。\u003cbr\u003e\n[Ctrl] + [Shift] + [←] キーで改行を取り除くと、タイトルのみが読み上げられるようになりました。\u003c/p\u003e\n\n\u003cp\u003eこのままめでたしとは行きません。\u003cbr\u003e\n\u003cstrong\u003eトリプルクリック…できません\u003c/strong\u003e。\u003cbr\u003e\n\u003ccode\u003eIsActionExecutor\u003c/code\u003e が \u003ccode\u003etrue\u003c/code\u003e の Driver であれば \u003ccode\u003ePointerInputDevice.CreatePointerDown\u003c/code\u003e, \u003ccode\u003eCreatePointerDown\u003c/code\u003e の組み合わせで実現できそうですが、\u003ccode\u003eWindowsDriver\u0026lt;WindowsElement\u0026gt;\u003c/code\u003e + WinAppDriver ではサポートされておらず、\u003ccode\u003eClick\u003c/code\u003e や \u003ccode\u003eDoubleClick\u003c/code\u003e の組合せでも実現できませんでした。\u003cbr\u003e\n残念ですが、諦めましょう。\u003c/p\u003e\n\n\u003cp\u003e素直に\u003cstrong\u003eタイトルテキストをドラッグ\u0026amp;ドロップで選択\u003c/strong\u003eすることにします。\u003cbr\u003e\n起点はタイトル要素の左上端です。\u003cbr\u003e\n\u003ccode\u003eActions.MoveToElement\u003c/code\u003e は要素のみの指定だとその要素の中央に移動しますが、オフセットを指定する場合は左上端が起点となります。\u003cbr\u003e\nドラッグ\u0026amp;ドロップは \u003cstrong\u003e\u003ccode\u003eClickAndHold\u003c/code\u003e → \u003ccode\u003eMoveByOffset\u003c/code\u003e → \u003ccode\u003eRelease\u003c/code\u003e\u003c/strong\u003e です。\u003cbr\u003e\n\u003ccode\u003eRelease\u003c/code\u003e した後には \u003ccode\u003eMoveByOffset\u003c/code\u003e で選択領域内に移動しておくとより丁寧ですが、なくても動作しますので省きました。\u003c/p\u003e\n\n\u003cp\u003eタイトルが3行あると日時まで選択されてしまいますが、制限事項とさせていただきます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"読み上げと終了待機\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%81%A8%E7%B5%82%E4%BA%86%E5%BE%85%E6%A9%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e読み上げと終了待機\u003c/h4\u003e\n\n\u003cp\u003eテキストを選択したら、\u003cstrong\u003eコンテキストメニューから読み上げを実行\u003c/strong\u003eします。\u003cbr\u003e\n読み上げ指示は年月と同じですが、今度は選択部分のみの読み上げですので、終了待機の方法が変わります。\u003cbr\u003e\n選択部分のみ読み上げる場合、\u003cstrong\u003e終わると読み上げツールバーは自動的に閉じられますので、これを検出することで読み終えたと判断\u003c/strong\u003eできそうです。\u003c/p\u003e\n\n\u003cp\u003e初めに \u003ccode\u003eSeleniumExtras.WaitHelpers.ExpectedConditions.InvisibilityOfElementLocated\u003c/code\u003e を試してみましたが、要素自体が消えるとエラーになってしまうようで、ここには使えませんでした。\u003cbr\u003e\nそれでは \u003ccode\u003eWebDriverWait\u003c/code\u003e で \u003ccode\u003eFindElements\u003c/code\u003e が要素を返さなくなるまで待機することにしましょう。\u003c/p\u003e\n\n\u003cp\u003eここもすんなりとは通してくれません。\u003cbr\u003e\n「旅行」の読み上げが止まらず、日時、時刻と突き進んでしまいます。\u003cbr\u003e\nよく見ると、\u003cstrong\u003eコンテキストメニューが「選択部分を音声で読み上げる」でなく「ここから音声で読み上げる」に\u003c/strong\u003eなっています。\u003cbr\u003e\n確かな基準は不明ですが、\u003cstrong\u003e2文字以内の単語\u003c/strong\u003eや「マススパー」「クリスマスイブ」のような\u003cstrong\u003e日本語として一つになった単語、「12345678」のような数字のみで発生\u003c/strong\u003eします。\u003cbr\u003e\nこれは手動操作でも同じでした。\u003cbr\u003e\nであれば仕方ありません。\u003cbr\u003e\n\u003cstrong\u003e\u003ccode\u003eWebDriverWait\u003c/code\u003e に設定したタイムアウトを経過すると \u003ccode\u003eWebDriverTimeoutException\u003c/code\u003e が発生しますので、捕捉して強制的に打ち切る\u003c/strong\u003eことにしましょう。\u003cbr\u003e\nそのうちきちんと「選択部分を音声で読み上げる」になるよう、 Edge で修正されるかもしれませんが、それまでは制限事項です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"イベントダイアログを閉じる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0%E3%82%92%E9%96%89%E3%81%98%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eイベントダイアログを閉じる\u003c/h3\u003e\n\n\u003cp\u003e読み上げ後、そのままだとダイアログに対してショートカットが効きません。\u003cbr\u003e\n\u003cstrong\u003eタイトル要素をクリックしてフォーカスを戻してから、[Escape] キー\u003c/strong\u003eでイベントダイアログを閉じます。\u003cbr\u003e\nタイトル要素は上ですでに取得していますが、読み上げ後には再取得が必要です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"制限事項\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%B6%E9%99%90%E4%BA%8B%E9%A0%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e制限事項\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e思いつく限りのイベントの登録パターンに対応しましたが、対応できていないパターンもあるかもしれません。\u003c/li\u003e\n\u003cli\u003e特定の環境でしかテストはしていません。うまくいかないときは引数、プロパティの数値など調整してみてください。\u003c/li\u003e\n\u003cli\u003eその他本文内に記載しています。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"感想\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%84%9F%E6%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e感想\u003c/h1\u003e\n\n\u003cp\u003eベータ版ではすんなり行かないことが多く、試行錯誤の連続でしたが、正式リリース版ではそうした問題がかなり解消されていました。\u003c/p\u003e\n\n\u003cp\u003e今回のような特別な要件がない限り、Web アプリケーションは Selenium で扱った方がいいですが、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eWinAppDriver でも頑張ればある程度はできる\u003c/li\u003e\n\u003cli\u003eそれでもできないこともある\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eを示すことができていれば、ひとまず挑戦してよかったと思います。\u003c/p\u003e\n\n\u003cp\u003e音声に関しては、新しく追加された「Haruka Online」は「Haruka」よりは確かに機械っぽさが薄れた気はするものの、英語のたとえば「Jessa Online」の流暢さと比べるとぎこちなさは否めません。\u003cbr\u003e\nまだまだ改良の余地がありそうです。\u003cbr\u003e\n選択した部分だけ読み上げられるようになったのはいいですね。\u003cbr\u003e\nちなみにこの記事も公開前、おかしなところがないかチェックするため、Haruka Online さんに読み上げてもらいました\u003csup id=\"fnref3\"\u003e\u003ca href=\"#fn3\" title=\"コード部分を日本語で読み上げると凄いことになってちょっと面白いですね。英語に切り替えるとそれっぽく聞こえますが、飛ばしましょう。次の章の先頭文字を選択すると、そこから続行してくれます。\"\u003e3\u003c/a\u003e\u003c/sup\u003e。\u003cbr\u003e\nもう少し自然になればプレゼンとかでも使えそうです。\u003c/p\u003e\n\n\u003cp\u003eやりがいはありました。\u003cbr\u003e\nまだいろいろ遊べそうではあります。（またいつか、苦労を忘れた頃に）\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eQiita に書くようになって初めての Advent Calendar に参加してみました。\u003cbr\u003e\nクリスマスにちなんだ記事にしましたが、もっと C# っぽいことを書くべきだったかもしれません…ご寛容を。\u003c/p\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003eこれまでの EdgeHTML 版 Edge は UWP アプリケーションでしたが、Chromium 版 Edge は Win32 アプリケーションとして開発されています。 \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn2\"\u003e\n\u003cp\u003eChrome 同様、情報バーに「自動テスト ソフトウェアによって制御されています」と表示されますので、Chromium の仕様と考えられます。 \u003ca href=\"#fnref2\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn3\"\u003e\n\u003cp\u003eコード部分を日本語で読み上げると凄いことになってちょっと面白いですね。英語に切り替えるとそれっぽく聞こえますが、飛ばしましょう。次の章の先頭文字を選択すると、そこから続行してくれます。 \u003ca href=\"#fnref3\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","createdAt":"2019-12-06T14:57:22Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"L+iP76HvDLnzneOcWccsmttd0a0hSyEBRQ==--BOzZSA9l6JVS42Ie--Lo6+YwlBSdXMu9RG04FR6A==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-03-07T15:26:36Z","likesCount":6,"linkUrl":"https://qiita.com/CodeOne/items/6a7e75fc82f94b332f14","organization":null,"originalId":1101432,"stockedCount":3,"title":"[C#] 自動UIテストで遊ぼう：生まれ変わったエッヂのはるかさんがクリスマスイブの予定を読み上げる（WinAppDriver でできること／できないこと）","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%87%AA%E5%8B%95ui%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E4%B8%96%E7%95%8C%E3%81%B8%E3%82%88%E3%81%86%E3%81%93%E3%81%9D\"\u003e自動UIテストの世界へようこそ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%A7%E5%BE%97%E3%82%89%E3%82%8C%E3%82%8B%E7%9F%A5%E8%A6%8B\"\u003eこの記事で得られる知見\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#appium--winappdriver-%E3%81%A7%E3%81%AE-windows-%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E6%93%8D%E4%BD%9C\"\u003eAppium + WinAppDriver での Windows アプリケーション操作\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B3%A8%E6%84%8F\"\u003e注意\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#chromium-%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E6%96%B0-microsoft-edge\"\u003eChromium ベースの新 Microsoft Edge\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%8F%90%E3%81%A8%E3%81%AA%E3%82%8B%E7%9F%A5%E8%A6%8B\"\u003e前提となる知見\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#appium--winappdriver-%E3%81%A7%E3%81%AE%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E6%93%8D%E4%BD%9C\"\u003eAppium + WinAppDriver でのブラウザ操作\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B7%E3%83%8A%E3%83%AA%E3%82%AA\"\u003eシナリオ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83\"\u003e開発環境\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%8B%E7%99%BA%E3%83%97%E3%83%A9%E3%83%83%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0\"\u003e開発プラットフォーム\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%8B%E7%99%BA%E8%A8%80%E8%AA%9E\"\u003e開発言語\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BE%9D%E5%AD%98%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"\u003e依存ライブラリ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83\"\u003e実行環境\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#os\"\u003eOS\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#microsoft-edgechromium-%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3\"\u003eMicrosoft Edge（Chromium エンジン）\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AA%E3%81%9C-edge%E3%81%97%E3%81%8B%E3%82%82-chromium-%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E3%81%AE\"\u003eなぜ Edge？　しかも Chromium エンジンの\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#winappdriver-windows-application-driver-v11\"\u003eWinAppDriver (Windows Application Driver) v1.1\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AA%E3%81%9C-selenium-webdriver-%E3%81%A7%E3%81%AA%E3%81%8F-winappdriver\"\u003eなぜ Selenium WebDriver でなく WinAppDriver？\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#google-%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC\"\u003eGoogle カレンダー\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89\"\u003eテストコード\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#edge-%E7%94%A8%E3%81%AE-windowsdriver-%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"\u003eEdge 用の WindowsDriver を作成する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9A%E3%83%BC%E3%82%B8%E9%81%B7%E7%A7%BB%E3%81%99%E3%82%8B\"\u003eページ遷移する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A9%B2%E5%BD%93%E3%81%99%E3%82%8B%E8%A6%81%E7%B4%A0%E3%81%8C%E5%87%BA%E7%8F%BE%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7%E5%BE%85%E6%A9%9F%E3%81%99%E3%82%8B\"\u003e該当する要素が出現するまで待機する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%B9%B4%E6%9C%88%E3%82%92%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B\"\u003e年月を読み上げる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%A8%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E8%A6%81%E7%B4%A0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\"\u003e全イベントのボタン要素を取得する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%82%92%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B\"\u003eイベントのタイトルを読み上げる\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#tab-%E3%82%AD%E3%83%BC%E3%81%A7%E5%AF%BE%E8%B1%A1%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AB%E7%A7%BB%E5%8B%95\"\u003e[Tab] キーで対象のイベントボタンに移動\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0%E3%82%92%E9%96%8B%E3%81%8F\"\u003eイベントダイアログを開く\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E8%A6%81%E7%B4%A0%E3%82%92%E8%A6%8B%E3%81%A4%E3%81%91%E3%82%8B\"\u003eタイトル要素を見つける\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%81%AE%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92\"\u003eタイトルの読み上げ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E9%81%B8%E6%8A%9E\"\u003eテキスト選択\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%81%A8%E7%B5%82%E4%BA%86%E5%BE%85%E6%A9%9F\"\u003e読み上げと終了待機\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0%E3%82%92%E9%96%89%E3%81%98%E3%82%8B\"\u003eイベントダイアログを閉じる\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%B6%E9%99%90%E4%BA%8B%E9%A0%85\"\u003e制限事項\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%84%9F%E6%83%B3\"\u003e感想\u003c/a\u003e\n\u003c/li\u003e\n\n","totalPv":4104,"uuid":"6a7e75fc82f94b332f14","banReason":null,"adventCalendarItem":{"day":7,"calendar":{"name":"C#","urlName":"c-sharp","year":2019,"organization":null}},"author":{"encryptedId":"QfnA9bAh8tnSCYhI3e35vTwB0FAD--GzYtUIBk6mSVCjE5--t6U8NcZ1DrqLj69cj6Z1VQ==","originalId":335669,"description":"【品質と生産性にこだわるシステム開発】 .NET（C#/VB.NET）リモート開発支援。即日・15分から頼める常駐しないエンジニア。確かな技術で開発チームを手堅くサポートします。","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"株式会社 コードワン","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/335669/profile-images/1546497723","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F335669%2Fprofile-images%2F1546497723?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=59e834e4f828b3b0e41c02fc0819ee57","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F335669%2Fprofile-images%2F1546497723?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d065bb7eb81ec93789852af0e352faa5","urlName":"CodeOne","websiteUrl":"https://codeone.jp/","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"edge","urlName":"edge"},{"name":"自動化","urlName":"%e8%87%aa%e5%8b%95%e5%8c%96"},{"name":"appium","urlName":"appium"},{"name":"WinAppDriver","urlName":"winappdriver"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
