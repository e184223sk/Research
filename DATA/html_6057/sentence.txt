More than 1 year has passed since last update.この記事は、IEnumerable&lt;T&gt;の実装を理解を深めるために書いたものです。.NET Frameworkには、File.ReadLinesというメソッドが用意されているのですが、入力がファイルに限定されています。しかし、今回作成する簡易catコマンドは、標準入力もサポートしたいので利用できません。ということで、IEnumerable&lt;T&gt;を実装したEnumerableTextReaderクラスを作成しました。TextReaderオブジェクトから行を順に列挙するクラスです。汎用性を持たせるために、テキスト形式のStreamも扱えるようにします。以下、EnumerableTextReaderクラスのソースコードです。このクラスは、IEnumerable&lt;T&gt;インターフェースを実装していますので、テキストファイルに対して、LINQの拡張メソッドが利用できるようになります。とは言っても、簡易catコマンドではLINQのメソッドは利用してないですが...TextReaderを受け取るコンストラクタを用意していますので、Console.Inを渡せば、標準入力からも行単位で入力データを列挙することができます。上記のEnumerableTextReaderクラスを使って、簡易catコマンドを書いてみました。このプログラムは、標準入力からデータを読み込み、標準出力に書きだすだけの簡単なものです。使い方は以下のような感じ。これで、sample.txtの内容を、sample2.txtに複写することができます。以下のようなcatコマンド名だけの場合、キーボードから入力した行をそのままコンソール画面に表示します。この場合は、Ctrl+Zで入力を終了させます。以下、EnumerableTextReaderクラスを利用した簡易catコマンドのソースコードです。このコード、.NET Core 2.0でも動作確認しています。ソースは、GitHubで公開しています。この記事は、Gushwell's C# Programming Pageで公開したものを加筆・修正したものです。


