<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#のみを使って、今ソーシャルゲームアプリを作るとしたら - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/yoship1639/items/c54f6942d847f8374377" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="3uc1TYZG7SlnRdNRuu1MT5i397s6kDQA5EjVrieyczVfmFPtzBsZytSnnb/bSu7tKY4xQ1FSSZmZw3YX6IGymA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@yoship1639" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#のみを使って、今ソーシャルゲームアプリを作るとしたら - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amdiX2pncExrdmJfamdhUGpnYWJqZ0lIa3U0cmpncjNqZzd6amdyZmpnNlBqZzZ2amdyTGpnN3pqZzZEamdxTGpnNWZqZzZyamdwTGt2WnpqZ292amdhampnWmZqZ1pfamdvayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1jNDJkNjI4ZGMyY2Y1ZTJmYTIzZmYwZjEwMmEwNDNmZg&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGx2YzJocGNERTJNemsmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1mZjIzNDk4ZWU2OGQ2ZWJjMDdhYThjOTBjYTYwODY0MQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=ed7cb615d27c31f984ac7db3f4f7befa"><meta property="og:description" content="

はじめに

現在進行形でC#のみを使って個人でソシャゲ作りを試しているyoship1639です。
本記事はQiita夏祭り2020「〇〇（言語）のみを使って、今△△（アプリ）を作るとしたら」のテーマに沿った内容となっています。

..."><meta content="https://qiita.com/yoship1639/items/c54f6942d847f8374377" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="AWS,C#,Unity,MagicOnion,Qiita夏祭り2020_パソナテック" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-18104274-3c08-4cbd-a99d-596c8cfe99fd"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fyoship1639%2Fitems%2Fc54f6942d847f8374377">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fyoship1639%2Fitems%2Fc54f6942d847f8374377">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-18104274-3c08-4cbd-a99d-596c8cfe99fd">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/aws","name":"AWS"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-06-29T08:10:08.000+09:00","dateModified":"2020-06-30T09:05:23.000+09:00","headline":"C#のみを使って、今ソーシャルゲームアプリを作るとしたら","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amdiX2pncExrdmJfamdhUGpnYWJqZ0lIa3U0cmpncjNqZzd6amdyZmpnNlBqZzZ2amdyTGpnN3pqZzZEamdxTGpnNWZqZzZyamdwTGt2WnpqZ292amdhampnWmZqZ1pfamdvayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1jNDJkNjI4ZGMyY2Y1ZTJmYTIzZmYwZjEwMmEwNDNmZg\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGx2YzJocGNERTJNemsmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1mZjIzNDk4ZWU2OGQ2ZWJjMDdhYThjOTBjYTYwODY0MQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=ed7cb615d27c31f984ac7db3f4f7befa","mainEntityOfPage":"https://qiita.com/yoship1639/items/c54f6942d847f8374377","author":{"@type":"Person","address":"","email":"yoship1639@gmail.com","identifier":"yoship1639","name":"yoship1639","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fprofile-images%2F1594732889?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=716c2b13f79841ad7658dcce03a19ac2","url":"https://qiita.com/yoship1639","description":"ゲームエンジニア。C#er。バックエンドも触る。ゲーム、ゲームエンジン、仮想通貨等を自作していました。フロントエンドから物理ベースシェーダまで幅広く対応可能。理解しやすく正しい記事を記述することを心がけます。","memberOf":[{"@type":"Organization","address":"オンライン@Slack","legalName":"Unityゲーム開発者ギルド","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/5e3ba3bb442371003e6b5d4618ef627b9b478357/original.jpg?1570216541","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/f7eb993765ddcdb2c5e6890556c43ea3de8fbfb7/original.jpg?1570215690","identifier":"unity-game-dev-guild","description":"趣味・仕事問わずUnityでゲームを作っている開発者のみで構成されるオンラインコミュニティです。Unityでゲームを開発・運用するにあたって必要なあらゆる知見を共有することを目的とします。"}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yoship1639","type":"items","id":"c54f6942d847f8374377"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yoship1639","type":"items","id":"c54f6942d847f8374377"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yoship1639","type":"items","id":"c54f6942d847f8374377"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/yoship1639/items/c54f6942d847f8374377","location":"/yoship1639/items/c54f6942d847f8374377","scheme":"https","host":"qiita.com","port":null,"pathname":"/yoship1639/items/c54f6942d847f8374377","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"GdlAdp9oRRpjRV0JIkXNpR7JUr+NStm0cyDHdq00HamYpibW1TWx+dCnE+dD4m8Hr/CUR+aIpC0Oq2TPYgfcBA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-4cb82762-6225-498f-a991-4b08b1fc9c76"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yoship1639/items/c54f6942d847f8374377/likers" class="css-1iupg5d">327</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">342</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/c54f6942d847f8374377/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yoship1639/items/c54f6942d847f8374377/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yoship1639/items/c54f6942d847f8374377/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yoship1639/items/c54f6942d847f8374377/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yoship1639/items/c54f6942d847f8374377.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/yoship1639"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/profile-images/1594732889" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/yoship1639" class="css-10ougpm">@<!-- -->yoship1639</a><div class="css-1ay9vb9"><span><meta content="2020-06-28T23:10:08Z"/><time dateTime="2020-06-30T00:05:23Z" class="css-m19uds">updated at 2020-06-30</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#のみを使って、今ソーシャルゲームアプリを作るとしたら</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/aws" class="css-4czcte">AWS</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/magiconion" class="css-4czcte">MagicOnion</a><a href="/tags/qiita%e5%a4%8f%e7%a5%ad%e3%82%8a2020_%e3%83%91%e3%82%bd%e3%83%8a%e3%83%86%e3%83%83%e3%82%af" class="css-4czcte">Qiita夏祭り2020_パソナテック</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>現在進行形でC#のみを使って個人でソシャゲ作りを試しているyoship1639です。<br>
本記事はQiita夏祭り2020「<a href="https://qiita.com/official-events/5d181aadf5db26b73d33">〇〇（言語）のみを使って、今△△（アプリ）を作るとしたら</a>」のテーマに沿った内容となっています。</p>

<p>近年のソーシャルゲーム界隈は多様化が進んでクライアントサイドだけではなくサーバーサイドもあらゆる言語やフレームワークが試みられていますが、クライアントもサーバーも統一の言語で構成されているのはほとんどないかと思われます。言語にはその言語の得意分野があると思うので。</p>

<p>しかし、今まさに私が開発中の環境が好きな言語で開発しやすいという理由でクライアントもサーバーもC#で構成した作りになっているので、どのような構成でどうすれば最低限のソシャゲの基盤が作れるかを、解説が長くなり過ぎないようにまとめることが出来ればと思います。</p>

<p>三部構成で、クライアント実装、サーバー実装、AWS EC2へのデプロイまで解説できればと思っています。<br>
Let's、C#のみでソシャゲを作ろう！</p>

<h1>
<span id="ソシャゲの概要" class="fragment"></span><a href="#%E3%82%BD%E3%82%B7%E3%83%A3%E3%82%B2%E3%81%AE%E6%A6%82%E8%A6%81"><i class="fa fa-link"></i></a>ソシャゲの概要</h1>

<p>内容に入る前に、ソシャゲがどの様な流れで動作するのかを軽く説明します。</p>

<p>ソシャゲは基本的にクライアント(スマホ端末)とサーバーとのやり取りで動いています。サーバーが動いていないとクライアントは基本動作しません。これはクライアント側で不正にデータの書き換えをされると運営が困るからです。</p>

<p>サーバー側は大体以下の様なAPI機能を備えています。</p>

<ul>
<li>アプリバージョン判定</li>
<li>マスターデータ・アセットバンドル更新判定</li>
<li>ログイン (セッション管理)</li>
<li>アカウント作成</li>
<li>クエスト開始・終了</li>
<li>ガチャ</li>
<li>etc...</li>
</ul>

<p>挙げたらきりがないくらいにはサーバーにはやらなければならない仕事があります。それだけクライアントとサーバーは適所で通信しています。こうすることで、例えばクライアントのデータが紛失したとしてもサーバーから復元することが出来ますし、クライアント側で不正があったらサーバー側で検知してBANすることもできますし、ユーザーのアプリ上での動向から問い合わせにも対応することができるようになりますし、課金周りのレシート検証もサーバー側で正確に行えるので、課金したのに石が反映されないみたいな場面でも補填対応することが出来るようになります。基本ユーザにとっても運営にとってもメリットしかないです。</p>

<p>近年バックエンドはBaas(PlayFab、Firebase、GameSparks、GS2など)が鎬を削っており態々バックエンドを自前で準備しなくてもBaasを使うという手段がありますが、ドキュメントが英語のみだったり痒いところに手が届かなかったりと一長一短なので、どうしてもサーバーサイドを触りたくないという訳ではないのであれば個人的にはまだ自前で準備したほうが良いかな感はあります。</p>

<p>ソシャゲの動作の最初の流れとしては以下の様になります。</p>

<ol>
<li>アプリバージョンを検証</li>
<li>ログイン (ログインできなかったらアカウント作成)</li>
<li>更新データ確認 (アセバン、マスターデータ)</li>
<li>以降アプリによって色々</li>
</ol>

<p>今回は最低限の基盤だけ考えるので、2番の「<strong>アカウント作成</strong>」と「<strong>ログイン</strong>」機能を作りたいと思います。</p>

<h1>
<span id="構成の全体像" class="fragment"></span><a href="#%E6%A7%8B%E6%88%90%E3%81%AE%E5%85%A8%E4%BD%93%E5%83%8F"><i class="fa fa-link"></i></a>構成の全体像</h1>

<p>今回作るサンプルは、C#のみで構成するソシャゲの最低限の基盤で以下の構成となっています。</p>

<p>クライアント：C#(<a href="https://unity.com/ja" rel="nofollow noopener" target="_blank">Unity2019.X</a>)<br>
サーバー：C#(<a href="https://docs.microsoft.com/ja-jp/dotnet/core/" rel="nofollow noopener" target="_blank">.NetCore3.1</a>)<br>
デプロイ：<a href="https://aws.amazon.com/jp/ec2/" rel="nofollow noopener" target="_blank">AWS EC2</a>(<a href="https://aws.amazon.com/jp/amazon-linux-2/" rel="nofollow noopener" target="_blank">Amazon Linux 2</a>)<br>
サーバー &lt;--&gt; クライアント：<a href="https://github.com/Cysharp/MagicOnion" rel="nofollow noopener" target="_blank">MagicOnion</a>(HTTP/2, gRPC)</p>

<p><a href="https://camo.qiitausercontent.com/49ded3134212d0abba6554a5be9af5eba6684e01/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f33303765323433372d616233352d326337322d373630342d3764383039643362336164382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F307e2437-ab35-2c72-7604-7d809d3b3ad8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9b3b1da1a426d9aafeaeb0384999290f" alt="構成図.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/307e2437-ab35-2c72-7604-7d809d3b3ad8.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F307e2437-ab35-2c72-7604-7d809d3b3ad8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d1cba526be0c58071966ae16faf90aec 1x" loading="lazy"></a></p>

<p>クライアントは皆大好きUnity、サーバーはプラットフォーム関係なく動かせる.NetCore、デプロイはEC2、クライアントとサーバーのやり取りは巷で噂のMagicOnion(gRPCのC#ラッパー+α)です。最低限の構成であれば全部無料で準備できます。</p>

<p>本来であれば、DB用意したり、直じゃなくDockerコンテナでデプロイとかすべきですが、本記事から内容が逸れそうなので簡単な構成にしています。</p>

<p>まずは、クライアントサイドから作ってみます。</p>

<h1>
<span id="クライアントサイド" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%82%B5%E3%82%A4%E3%83%89"><i class="fa fa-link"></i></a>クライアントサイド</h1>

<p>クライアントサイドはエンジンとしてUnity2019.Xを使います。言語は当然C#です。</p>

<p>実装手順としては以下の通りとなります。</p>

<p>① MagicOnion, MessagePack, grpc をUnityにインポートする<br>
② Serviceを定義<br>
③ NetworkManagerを実装<br>
④ ログインテストコードを実装</p>

<h2>
<span id="-magiconion-messagepack-grpc-をunityにインポートする" class="fragment"></span><a href="#-magiconion-messagepack-grpc-%E3%82%92unity%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>① MagicOnion, MessagePack, grpc をUnityにインポートする</h2>

<p>まず、MagicOnion、MessagePack、grpcをUnityにインポートします。サーバーと通信するのに必要なものです。<br>
これらを簡単に説明すると、</p>

<ul>
<li>MagicOnion: リアルタイム/API通信フレームワーク。gRPCをC#で使いやすいようにラップしたイメージ。</li>
<li>MessagePack: 高効率のバイナリ形式のシリアライズフォーマット。JSONよりすごいやつ。MagicOnionに必要。</li>
<li>grpc: googleが作ったRPCフレームワーク。MagicOnionの中身はこれ。</li>
</ul>

<p>となっています。</p>

<p>なんでMagicOnionを使うかというと、以下のメリットがあるからです。</p>

<ul>
<li>HTTP/2の恩恵を受け、かつ通信データが高効率で圧縮されるため通信が早い。</li>
<li>インターフェースベースの通信が実現されるのでデータフォーマットを考えなくていい。</li>
<li>エンドポイントやAPIスキーマを考えなくていい。</li>
<li>APIだけでなくリアルタイム通信としても使える。</li>
</ul>

<p>使うには十分すぎるメリットではないかと思います。MagicOnionの詳細は解説しないので、各自調べていただければと思います。</p>

<p>まず、MagicOnionをインポートします。<br>
<a href="https://github.com/Cysharp/MagicOnion/releases" rel="nofollow noopener" target="_blank">https://github.com/Cysharp/MagicOnion/releases</a></p>

<p>こちらのリリースページにある「<strong>MagicOnion.Client.Unity.unitypackage</strong>」をダウンロードしUnityにインポートしてください。色々足りないと怒られますが気にせず次へいきます。</p>

<p>次に、MessagePackをインポートします。<br>
<a href="https://github.com/neuecc/MessagePack-CSharp/releases" rel="nofollow noopener" target="_blank">https://github.com/neuecc/MessagePack-CSharp/releases</a></p>

<p>こちらのリリースページにある「<strong>MessagePack.Unity.XXXXX.unitypackage</strong>」をダウンロードしUnityにD&amp;Dしてください。最新のリリースで問題なく動作するはずです。</p>

<p>この時、Pluginsフォルダ内のdllが既に取り込まれているよと警告されるので、Pluginsフォルダのチェックを外してインポートしてください。</p>

<p><a href="https://camo.qiitausercontent.com/d814fddcbde663a7a24d14f36cf61e7d87f82c85/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f33353130323161372d303966642d306339652d646132622d3935303763383632323634362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F351021a7-09fd-0c9e-da2b-9507c8622646.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9d0b5709372af9456ca71367b738eb4f" alt="qiita2020_001.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/351021a7-09fd-0c9e-da2b-9507c8622646.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F351021a7-09fd-0c9e-da2b-9507c8622646.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fb88271ac2a920bd948c616b17bcb3ef 1x" loading="lazy"></a></p>

<p>最後に、grpcをインポートします。<br>
<a href="https://packages.grpc.io/" rel="nofollow noopener" target="_blank">https://packages.grpc.io/</a></p>

<p>こちらのページの最新のコミットのBuild IDをクリックし、C#欄にある「<strong>grpc_unity_package.XXXXX-dev.zip</strong>」をダウンロード、解凍します。<br>
解凍すると「Plugins」フォルダがあるはずなので、Pluginsフォルダの中身をUnityのAssets/Pluginsフォルダに入れてインポートします。</p>

<p><a href="https://camo.qiitausercontent.com/efc5e87b01363400d48bafa79f7b4214e0ed4965/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f37343066383934312d653337392d333839622d353930392d6535663533326432656136632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F740f8941-e379-389b-5909-e5f532d2ea6c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=729e15f834bd88daf05fbe5af7588109" alt="qiita2020_002.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/740f8941-e379-389b-5909-e5f532d2ea6c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F740f8941-e379-389b-5909-e5f532d2ea6c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f8452de7dd5e2c898dc751eaee10c022 1x" loading="lazy"></a></p>

<p>それでもまだ怒られると思うので、エラーを解決していきます。</p>

<ul>
<li>System.Buffersが被っているので、どちらかを削除</li>
<li>System.Memoryが被っているので、どちらかを削除</li>
<li>System.Runtime.CompilerServices.Unsafeが被っているので、どちらかを削除</li>
<li>unsafeコードが許可されていないぞ☆って怒られるのでunsafeコードを許可</li>
</ul>

<p>これでエラーは出なくなるはずです。</p>

<h2>
<span id="-serviceを定義" class="fragment"></span><a href="#-service%E3%82%92%E5%AE%9A%E7%BE%A9"><i class="fa fa-link"></i></a>② Serviceを定義</h2>

<p>諸々インポートが完了したらServiceを定義します。ServiceとはWebAPIと同様のものと考えていただければと思います。<br>
ソーシャルゲームは基本的に特定の動作ごとにサーバーにAPIを投げてそのレスポンスを基にクライアントを動かします。</p>

<p>本来、API定義を考える場合「https://〇〇〇〇/create_account」みたいなエンドポイントやらスキーマやらを考えなくてはいけませんが、MagicOnionの場合はインターフェース定義自体がそれに当たります。これメチャクチャ便利です。</p>

<p>アカウント作成とログインの機能は、以下の様に定義できます。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">IAccountService.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">MagicOnion</span><span class="p">;</span>

<span class="c1">// アカウント周りのサービスを定義するインターフェース</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IAccountService</span> <span class="p">:</span> <span class="n">IService</span><span class="p">&lt;</span><span class="n">IAccountService</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="c1">// アカウント作成</span>
    <span class="n">UnaryResult</span><span class="p">&lt;(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">)&gt;</span> <span class="nf">CreateAccount</span><span class="p">();</span>

    <span class="c1">// ログイン</span>
    <span class="n">UnaryResult</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">Login</span><span class="p">(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>CreateAccountはサーバー側で作成されたユーザIDとパスワードを返し、Loginは引数にユーザIDとパスワードを入力するとログイン中であるセッション情報(string)を返します。</p>

<p>クライアントはIAccountServiceだけを知っていればいいので、IAccountServiceの実態はサーバー側で実装します。</p>

<h2>
<span id="-networkmanagerを実装" class="fragment"></span><a href="#-networkmanager%E3%82%92%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>③ NetworkManagerを実装</h2>

<p>Serviceの定義が終わったら実際にサーバーと通信する処理を担当するNetworkManagerを実装します。<br>
クライアントはこのNetworkManagerを使ってサーバーとのやり取りをします。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">NetworkManager.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Grpc.Core</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MagicOnion.Client</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">NetworkManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="kt">string</span> <span class="n">applicationHost</span> <span class="p">=</span> <span class="s">"localhost"</span><span class="p">;</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="kt">int</span> <span class="n">applicationPort</span> <span class="p">=</span> <span class="m">12345</span><span class="p">;</span>

    <span class="k">private</span> <span class="n">IAccountService</span> <span class="n">accountService</span><span class="p">;</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">session</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">channel</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Channel</span><span class="p">(</span><span class="n">applicationHost</span><span class="p">,</span> <span class="n">applicationPort</span><span class="p">,</span> <span class="n">ChannelCredentials</span><span class="p">.</span><span class="n">Insecure</span><span class="p">);</span>
        <span class="n">accountService</span> <span class="p">=</span> <span class="n">MagicOnionClient</span><span class="p">.</span><span class="n">Create</span><span class="p">&lt;</span><span class="n">IAccountService</span><span class="p">&gt;(</span><span class="n">channel</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// アカウント作成</span>
    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">)&gt;</span> <span class="nf">CreateAccount</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">try</span>
        <span class="p">{</span>
            <span class="c1">// サーバーにアカウント作成を要求、レスポンスは作成されたユーザIDとパスワード</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">accountService</span><span class="p">.</span><span class="nf">CreateAccount</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="k">return</span> <span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// ログイン</span>
    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="nf">Login</span><span class="p">(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">try</span>
        <span class="p">{</span>
            <span class="c1">// ユーザIDとパスワードをサーバーに投げてログイン、レスポンスはセッション情報</span>
            <span class="n">session</span> <span class="p">=</span> <span class="k">await</span> <span class="n">accountService</span><span class="p">.</span><span class="nf">Login</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">session</span> <span class="p">!=</span> <span class="k">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="n">session</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>applicationHostは<code>localhost</code>にしてありますが、後でデプロイ先のエンドポイントに切り替えます。<br>
セキュリティの関係からsslにすべきですが、今回は割愛です。</p>

<h2>
<span id="-ログインテストコードを実装" class="fragment"></span><a href="#-%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>④ ログインテストコードを実装</h2>

<p>実際にログインのテストコードを記述してみます。<br>
処理内容はとても単純で、まずローカルに保存してあるユーザー情報(ユーザーID、パスワード)を読み込みます。ユーザー情報そのものがなかったらアカウントを作成し作成されたユーザー情報を保存します。次に、ユーザー情報を元にログインし、通った時と通らなかった時で処理を分けるという形です。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">LoginTest.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MessagePack</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>

<span class="p">[</span><span class="n">MessagePackObject</span><span class="p">]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">UserData</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nf">Key</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">userId</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">Key</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">password</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">LoginTest</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">async</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ネットワークマネージャ取得</span>
        <span class="kt">var</span> <span class="n">network</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">NetworkManager</span><span class="p">&gt;();</span>

        <span class="c1">// 保存してあるユーザーデータ情報を読み込み</span>
        <span class="n">UserData</span> <span class="n">userData</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="k">try</span>
        <span class="p">{</span>
            <span class="n">userData</span> <span class="p">=</span> <span class="n">MessagePackSerializer</span><span class="p">.</span><span class="n">Deserialize</span><span class="p">&lt;</span><span class="n">UserData</span><span class="p">&gt;(</span><span class="n">File</span><span class="p">.</span><span class="nf">ReadAllBytes</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">persistentDataPath</span> <span class="p">+</span> <span class="s">"/userData.dat"</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{</span> <span class="p">}</span>

        <span class="c1">// ユーザーデータが存在しなかったらアカウント作成</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">userData</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"アカウント作成開始"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="k">await</span> <span class="n">network</span><span class="p">.</span><span class="nf">CreateAccount</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">userId</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="n">res</span><span class="p">.</span><span class="n">password</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// TODO: アカウント作成失敗時の処理</span>
                <span class="n">Debug</span><span class="p">.</span><span class="nf">LogWarning</span><span class="p">(</span><span class="s">"アカウント作成失敗。。。"</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">userData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">UserData</span><span class="p">();</span>
            <span class="n">userData</span><span class="p">.</span><span class="n">userId</span> <span class="p">=</span> <span class="n">res</span><span class="p">.</span><span class="n">userId</span><span class="p">;</span>
            <span class="n">userData</span><span class="p">.</span><span class="n">password</span> <span class="p">=</span> <span class="n">res</span><span class="p">.</span><span class="n">password</span><span class="p">;</span>

            <span class="c1">// ユーザー情報保存(※本来は暗号化等する事！)</span>
            <span class="kt">var</span> <span class="n">data</span> <span class="p">=</span> <span class="n">MessagePackSerializer</span><span class="p">.</span><span class="nf">Serialize</span><span class="p">(</span><span class="n">userData</span><span class="p">);</span>
            <span class="n">File</span><span class="p">.</span><span class="nf">WriteAllBytes</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">persistentDataPath</span> <span class="p">+</span> <span class="s">"/userData.dat"</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"アカウント作成成功"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// ログイン</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"ログイン中..."</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">loginResult</span> <span class="p">=</span> <span class="k">await</span> <span class="n">network</span><span class="p">.</span><span class="nf">Login</span><span class="p">(</span><span class="n">userData</span><span class="p">.</span><span class="n">userId</span><span class="p">,</span> <span class="n">userData</span><span class="p">.</span><span class="n">password</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(!</span><span class="n">loginResult</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// TODO: ログイン失敗時の処理</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">LogWarning</span><span class="p">(</span><span class="s">"ログイン失敗。。。"</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// TODO: ログインが通った後の処理</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"ログイン成功！"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>本来ならばもっと厳密にログイン処理を行うべきですが、今回はテストなので超単純に作っています。<br>
ここを通ればログインに成功したことになるので、後はクライアント側は煮るなり焼くなりするだけです。</p>

<p>次に、サーバーサイドの実装に移ります。</p>

<h1>
<span id="サーバーサイド" class="fragment"></span><a href="#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%82%B5%E3%82%A4%E3%83%89"><i class="fa fa-link"></i></a>サーバーサイド</h1>

<p>サーバーサイドはフレームワークとして.NetCore3.1を使います。言語は当然C#です。<br>
.NetFrameworkを使ってしまうとデプロイ周りで苦労することになるので、サーバーサイドC#は.NetCoreを使ってください。</p>

<p>サーバーの実装手順としては以下の様になります。</p>

<p>① プロジェクトの準備、MagicOnionのインストール<br>
② Mainプログラムの記述<br>
③ AccountServiceの実装<br>
④ ローカル環境で動作確認</p>

<h2>
<span id="-プロジェクトの準備magiconionのインストール" class="fragment"></span><a href="#-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E6%BA%96%E5%82%99magiconion%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>① プロジェクトの準備、MagicOnionのインストール</h2>

<p>まず、プロジェクトを作成します。プロジェクトは「コンソール アプリ(.NET Core)」を選択してください。プロジェクト名は何でもいいです。私はとりあえず「Qiita2020TestServer」にしました。<br>
<a href="https://camo.qiitausercontent.com/e7d2221e5d5912df27f2a7140377a576faa9edc0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f38343431346631622d303433652d626232622d396534382d3937386633333430356565642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F84414f1b-043e-bb2b-9e48-978f33405eed.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b7f11d238dc89f50c8406dbc46651fc7" alt="qiita2020_003.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/84414f1b-043e-bb2b-9e48-978f33405eed.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F84414f1b-043e-bb2b-9e48-978f33405eed.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f757b368c2dcbe0b1e3bcf76c903c121 1x" loading="lazy"></a></p>

<p>プロジェクトの作成が終わったら、クライアントとの通信に必要なコンポーネントをNuget経由でインストールします。<br>
プロジェクトのコンテキストメニューの「Nuget パッケージの管理(N)...」から<code>MagicOnion.Hosting</code>をインストールします。バージョンは最新の安定板で大丈夫です。<br>
<a href="https://camo.qiitausercontent.com/ddadec4e4a9fa43186530c735cf8733a5bc1e14d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f33326536663330392d366566392d636635392d653233612d3762336236636333363434642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F32e6f309-6ef9-cf59-e23a-7b3b6cc3644d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=95d18ba0e78c49bdeb1eab5a124eacf2" alt="qiita2020_004.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/32e6f309-6ef9-cf59-e23a-7b3b6cc3644d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F32e6f309-6ef9-cf59-e23a-7b3b6cc3644d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a965d5e782e5d07c5231aabe55abb2e4 1x" loading="lazy"></a></p>

<p>一応、Unityで使われている型をサーバーでも扱えるように<code>MessagePack.UnityShims</code>もインストールしておきます。<br>
<a href="https://camo.qiitausercontent.com/3c4aa427fb8c37e3d3d7b02715d98f4bfaa789fb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36356634343965362d356431392d346239362d343936332d3033653134393562316530372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F65f449e6-5d19-4b96-4963-03e1495b1e07.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=12b2ee6062c6ffd10b405aec88fc8744" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/65f449e6-5d19-4b96-4963-03e1495b1e07.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F65f449e6-5d19-4b96-4963-03e1495b1e07.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=03ab4c0ef3738179d944c9262cc4626e 1x" loading="lazy"></a></p>

<p>これでサーバーサイドに必要なコンポーネントがインストールできました。</p>

<h2>
<span id="-mainプログラムの記述" class="fragment"></span><a href="#-main%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E8%A8%98%E8%BF%B0"><i class="fa fa-link"></i></a>② Mainプログラムの記述</h2>

<p>サーバーを起動するMainプログラムを記述します。<br>
やっていることはとても単純で、ログ出力先をコンソールに指定し、ホストとポートを指定して起動しているだけです。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Program.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">Grpc.Core</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MagicOnion.Hosting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MagicOnion.Server</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Extensions.Hosting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Qiita2020TestServer</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// コンソールにログ出力するように設定</span>
            <span class="n">GrpcEnvironment</span><span class="p">.</span><span class="nf">SetLogger</span><span class="p">(</span><span class="k">new</span> <span class="n">Grpc</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">Logging</span><span class="p">.</span><span class="nf">ConsoleLogger</span><span class="p">());</span>

            <span class="c1">// MagicOnionを使ってホスト作成、起動</span>
            <span class="k">await</span> <span class="n">MagicOnionHost</span><span class="p">.</span><span class="nf">CreateDefaultBuilder</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">UseMagicOnion</span><span class="p">(</span>
                    <span class="k">new</span> <span class="nf">MagicOnionOptions</span><span class="p">(</span><span class="n">isReturnExceptionStackTraceInErrorDetail</span><span class="p">:</span> <span class="k">true</span><span class="p">),</span>
                    <span class="k">new</span> <span class="nf">ServerPort</span><span class="p">(</span><span class="s">"0.0.0.0"</span><span class="p">,</span> <span class="m">12345</span><span class="p">,</span> <span class="n">ServerCredentials</span><span class="p">.</span><span class="n">Insecure</span><span class="p">))</span>
                <span class="p">.</span><span class="nf">RunConsoleAsync</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>一応これだけでもサーバーを起動することはできます。デバッグ実行すると以下の様な画面が出るはずです。<br>
<a href="https://camo.qiitausercontent.com/f0a79597a17cd921bb8297b40362bd3a5bce6a12/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36333536666637302d323835342d353130352d376634312d6561373465346636316533342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6356ff70-2854-5105-7f41-ea74e4f61e34.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=93f5ae193c817f9d316639a9c13e36c3" alt="qiita2020_006.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/6356ff70-2854-5105-7f41-ea74e4f61e34.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6356ff70-2854-5105-7f41-ea74e4f61e34.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cfd31241b00811bb16dfd52889b38a52 1x" loading="lazy"></a></p>

<p>これだけでは何の機能もない張りぼてサーバーなので、クライアント側で実装した「アカウント作成」と「ログイン」機能を実装していきます。</p>

<h2>
<span id="-accountserviceの実装" class="fragment"></span><a href="#-accountservice%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>③ AccountServiceの実装</h2>

<p>サーバー側のアカウント作成とログイン機能の実装をします。<br>
クライアントで定義したIAccountService.csが必要なので、予め丸々コピーしておいてください。（本来は、submodule等用いてソースコードの共有をすることをお勧めします。）</p>

<p>アカウント作成は、ランダムなハッシュ値を用います。ユーザーIDは20桁、パスワードは12桁にしておきます。ログインは作成されたユーザーIDとパスワードを検証し、一致したら以降のAPIを呼び出すことが出来るセッションを返します。セッションも一先ずランダムな20桁のハッシュ値を返します。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">AccountService.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">MagicOnion</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MagicOnion.Server</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Qiita2020TestServer</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">AccountService</span> <span class="p">:</span> <span class="n">ServiceBase</span><span class="p">&lt;</span><span class="n">IAccountService</span><span class="p">&gt;,</span> <span class="n">IAccountService</span>
    <span class="p">{</span>
        <span class="c1">// セッション情報管理（本来はRedis等用いる事！）</span>
        <span class="k">private</span> <span class="k">static</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="p">(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">expireAt</span><span class="p">)&gt;</span> <span class="n">sessions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="p">(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">expireAt</span><span class="p">)&gt;();</span>

        <span class="k">private</span> <span class="k">static</span> <span class="kt">object</span> <span class="n">lockObject</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">();</span>

        <span class="c1">// アカウント作成</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">UnaryResult</span><span class="p">&lt;(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">)&gt;</span> <span class="nf">CreateAccount</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"CreateAccount Request"</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">userId</span> <span class="p">=</span> <span class="nf">GenerateHash</span><span class="p">(</span><span class="m">20</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="nf">GenerateHash</span><span class="p">(</span><span class="m">12</span><span class="p">);</span>

            <span class="c1">// アカウント情報を仮でファイルに保存(本来はDBに入れる事！)</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="s">"accounts"</span><span class="p">))</span> <span class="n">Directory</span><span class="p">.</span><span class="nf">CreateDirectory</span><span class="p">(</span><span class="s">"accounts"</span><span class="p">);</span>
                <span class="n">File</span><span class="p">.</span><span class="nf">WriteAllText</span><span class="p">(</span><span class="s">"accounts/"</span> <span class="p">+</span> <span class="n">userId</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Logger</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">"CreateAccount Error"</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">$"CreateAccount UserId:</span><span class="p">{</span><span class="n">userId</span><span class="p">}</span><span class="s">, Password:</span><span class="p">{</span><span class="n">password</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>

            <span class="k">return</span> <span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// ログイン</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">UnaryResult</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">Login</span><span class="p">(</span><span class="kt">string</span> <span class="n">userId</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"Login Request"</span><span class="p">);</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="c1">// アカウントがない</span>
                <span class="k">if</span> <span class="p">(!</span><span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="s">"accounts/"</span> <span class="p">+</span> <span class="n">userId</span><span class="p">))</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span>

                <span class="c1">// パスワードが一致しない</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span><span class="s">"accounts/"</span> <span class="p">+</span> <span class="n">userId</span><span class="p">)</span> <span class="p">!=</span> <span class="n">password</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Logger</span><span class="p">.</span><span class="nf">Warning</span><span class="p">(</span><span class="s">"Login failed: "</span> <span class="p">+</span> <span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">password</span><span class="p">));</span>
                    <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
                <span class="p">};</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Logger</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">"Login Error"</span><span class="p">);</span>
                <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// セッション情報作成</span>
            <span class="kt">var</span> <span class="n">session</span> <span class="p">=</span> <span class="nf">GenerateHash</span><span class="p">(</span><span class="m">20</span><span class="p">);</span>

            <span class="k">lock</span> <span class="p">(</span><span class="n">lockObject</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// 一先ず1日有効なセッションを保存</span>
                <span class="n">sessions</span><span class="p">[</span><span class="n">session</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="nf">AddDays</span><span class="p">(</span><span class="m">1</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"【"</span> <span class="p">+</span> <span class="n">userId</span> <span class="p">+</span> <span class="s">"】Login succeeded!"</span><span class="p">);</span>
            <span class="c1">// セッションを返す</span>
            <span class="k">return</span> <span class="n">session</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// 指定の長さのランダムハッシュ値を取得</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GenerateHash</span><span class="p">(</span><span class="kt">int</span> <span class="n">length</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nf">Sha256</span><span class="p">(</span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">().</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"N"</span><span class="p">)).</span><span class="nf">Substring</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">length</span><span class="p">).</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">// Sha256ハッシュ</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Sha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">str</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">input</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">sha</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SHA256CryptoServiceProvider</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">sha256</span> <span class="p">=</span> <span class="n">sha</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">sha256</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0:X2}"</span><span class="p">,</span> <span class="n">sha256</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
</div>

<p>これで、アカウント作成とログイン機能を備えたサーバープログラムが整いました。</p>

<h2>
<span id="-ローカル環境で動作確認" class="fragment"></span><a href="#-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E7%92%B0%E5%A2%83%E3%81%A7%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>④ ローカル環境で動作確認</h2>

<p>ここまでで、ローカル環境で動作確認をすることが出来るようになったので、確認してみます。<br>
サーバーをデバッグ実行してローカルサーバーを立ち上げ、クライアントをデバッグ実行します。<br>
問題がなければクライアントは以下の様に表示されるはずです。<br>
<a href="https://camo.qiitausercontent.com/8775797bf24683a05909750c5b1abac6a6a183bd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36313465616563332d353738362d336533332d313938392d3139316537663834653739372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F614eaec3-5786-3e33-1989-191e7f84e797.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9046203e923a3716438ec2516706cb69" alt="qiita2020_007.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/614eaec3-5786-3e33-1989-191e7f84e797.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F614eaec3-5786-3e33-1989-191e7f84e797.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4cffadf7961d3dde6ade075329018bbc 1x" loading="lazy"></a><br>
サーバー側は以下の様に表示されます。<br>
<a href="https://camo.qiitausercontent.com/abdef55af5e6fb0635fdee2e9480ae3dd7decde4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f65376166333333302d633331332d613066652d353665392d6266613535633437336466362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe7af3330-c313-a0fe-56e9-bfa55c473df6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3a2512b585dad2f392c61a07ccebb703" alt="qiita2020_008.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/e7af3330-c313-a0fe-56e9-bfa55c473df6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe7af3330-c313-a0fe-56e9-bfa55c473df6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ed16d6be70f82da56f1b7b350a85e9c7 1x" loading="lazy"></a><br>
ローカルで問題なく動作できていることが確認できました。<br>
最後に、実際にクラウド上にデプロイして確認してみたいと思います。</p>

<h1>
<span id="デプロイ" class="fragment"></span><a href="#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4"><i class="fa fa-link"></i></a>デプロイ</h1>

<p>ローカル環境で問題なく動作させることが確認できれば、本来はデプロイまでは頑張らなくてもいいですが、せっかくなのでEC2へのデプロイまでやってみたいと思います。CI/CDやDockerコンテナでもよかったのですが解説が逸れそうなので直デプロイします。</p>

<p>手順としては、以下の様になります。<br>
① awsでEC2インスタンスを用意、起動する<br>
② ターミナルでEC2インスタンスにログイン<br>
③ .NetCore3.1をインストール<br>
④ サーバープロジェクトを配置、実行<br>
⑤ クライアント動作確認</p>

<h2>
<span id="-awsでec2インスタンスを用意起動する" class="fragment"></span><a href="#-aws%E3%81%A7ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%82%92%E7%94%A8%E6%84%8F%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>① awsでEC2インスタンスを用意、起動する</h2>

<p>最初にAWSコンソールにサインインします。アカウントを持ってない人は作ってください。<br>
<a href="https://camo.qiitausercontent.com/81281cd6dfd6225dd4c8af324a0401e551a2719b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63303933316162342d646236392d316134652d393530382d3439313464663763336536612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc0931ab4-db69-1a4e-9508-4914df7c3e6a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ea0fb41f76ba6efad0c814085145002c" alt="qiita2020_010.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/c0931ab4-db69-1a4e-9508-4914df7c3e6a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc0931ab4-db69-1a4e-9508-4914df7c3e6a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e0bba12a33bf6d47f6607dd7c0da8514 1x" loading="lazy"></a></p>

<p>サインインしたらEC2を選択します。EC2は仮想サーバーみたいなものだと思ってください。<br>
<a href="https://camo.qiitausercontent.com/172d8b2753fd1ff2b92f87d93ea05f740844b9d8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39323462303939652d333333352d636139632d393838332d3739646264383039303661622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F924b099e-3335-ca9c-9883-79dbd80906ab.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=160812408d753c52279e27e6b66b040e" alt="qiita2020_009.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/924b099e-3335-ca9c-9883-79dbd80906ab.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F924b099e-3335-ca9c-9883-79dbd80906ab.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ad5e3eb5882c29821aec5e0637687000 1x" loading="lazy"></a></p>

<p>左側の「キーペア」を選択します。<br>
<a href="https://camo.qiitausercontent.com/d497d734de6973c744baaff0afd57d9a52c3f59f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f31633533316635392d396636662d386439392d333566622d6538643730663838626639372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1c531f59-9f6f-8d99-35fb-e8d70f88bf97.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d9fb05119f0dd99ad0a4094e4dcd569d" alt="qiita2020_020.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/1c531f59-9f6f-8d99-35fb-e8d70f88bf97.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1c531f59-9f6f-8d99-35fb-e8d70f88bf97.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=65c0bc2932d9bd193115acefab5c9d0d 1x" loading="lazy"></a></p>

<p>右上の「キーペアを作成」をクリックします。<br>
<a href="https://camo.qiitausercontent.com/56900b617c4f51fcbd04fd60d618c52fe7b95bb5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f32383234373735372d373634362d366231362d613561612d3465653365646239373139622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F28247757-7646-6b16-a5aa-4ee3edb9719b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=40ce35ff6e74a4bd91e42c270d119360" alt="qiita2020_021.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/28247757-7646-6b16-a5aa-4ee3edb9719b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F28247757-7646-6b16-a5aa-4ee3edb9719b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7cc6dd5dd729f632a8ad609a518332e1 1x" loading="lazy"></a></p>

<p>名前を「Qiita2020TestServer」(名前は何でもいいです)にして、「キーペアを作成」をクリックします。<br>
<a href="https://camo.qiitausercontent.com/87b9189220158c7433acd1157857dade44321ff8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63663132383965342d376238652d323133652d396263362d3038373437396561653034662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf1289e4-7b8e-213e-9bc6-087479eae04f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5880f9e2dbb0e53ed17379c956538ae5" alt="qiita2020_022.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/cf1289e4-7b8e-213e-9bc6-087479eae04f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf1289e4-7b8e-213e-9bc6-087479eae04f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=dc84130be12310662b294398e93c55b8 1x" loading="lazy"></a></p>

<p>キーペアが作成されppkファイルがダウンロードされます。<br>
このキーは後で作るインスタンスへのログインに必要なので、大切に保管しましょう。</p>

<p>次に、左側の「インスタンス」を選択します。<br>
<a href="https://camo.qiitausercontent.com/a9b55c41033bee231f01d94b2bf3d8b12758355f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f34656161653363372d353437622d303939382d306333612d3035366434623333306261392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F4eaae3c7-547b-0998-0c3a-056d4b330ba9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ed79f3eabd2ebb61744eb856c171b8a8" alt="qiita2020_011.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/4eaae3c7-547b-0998-0c3a-056d4b330ba9.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F4eaae3c7-547b-0998-0c3a-056d4b330ba9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=42b0d9a700da049a322df445acc741ca 1x" loading="lazy"></a></p>

<p>「インスタンスの作成」をクリックします。<br>
<a href="https://camo.qiitausercontent.com/d858f8e8e02dec6ae995493e502a281f9a2539f8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f61626531643161382d623536322d643630392d643561622d6161636466366237636337302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fabe1d1a8-b562-d609-d5ab-aacdf6b7cc70.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0b03faa9247d9070055e87ec792e600b" alt="qiita2020_012.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/abe1d1a8-b562-d609-d5ab-aacdf6b7cc70.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fabe1d1a8-b562-d609-d5ab-aacdf6b7cc70.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=600360009c34a9693a6ba3872b53315c 1x" loading="lazy"></a></p>

<p>何のインスタンスを作るか聞かれるので、「Amazon Linux 2 AMI」を選択してください。<br>
<a href="https://camo.qiitausercontent.com/85d83fd5c4891bd4b51bbc39fb56f33665ed7a4b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f31353138666235392d613930332d616633312d646535612d3136663065663965663039662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1518fb59-a903-af31-de5a-16f0ef9ef09f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0f74ab9105acc3de806faf96e24187b2" alt="qiita2020_013.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/1518fb59-a903-af31-de5a-16f0ef9ef09f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1518fb59-a903-af31-de5a-16f0ef9ef09f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5c0de003a8367d9da44c393b9a0eba36 1x" loading="lazy"></a></p>

<p>どのスペックの仮想マシンを立ち上げるか聞かれるので、無料で使える「t2.micro」を選択し、「次のステップ：インスタンスの詳細と設定」をクリック。<br>
<a href="https://camo.qiitausercontent.com/a36caf836d2ba935b60e3cdae0269156e98df19a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f65343433653434612d373934662d616230362d616331392d3135323837376537343362312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe443e44a-794f-ab06-ac19-152877e743b1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=415796aaba0673cea1d64444916fbb0f" alt="qiita2020_014.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/e443e44a-794f-ab06-ac19-152877e743b1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe443e44a-794f-ab06-ac19-152877e743b1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a6ac1ffdf63ca57c0ba0911522a32bcd 1x" loading="lazy"></a></p>

<p>いろんな設定項目がありますが、ここでは「自動割り当てパブリックIP」を「有効」にします。<br>
有効にしたら「次のステップ：ストレージの追加」へ。<br>
<a href="https://camo.qiitausercontent.com/95b48fded7184eff5605e44f183a4d7abb0cfe74/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39373061323664352d636337652d646564382d636236642d3831663362346530366561642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F970a26d5-cc7e-ded8-cb6d-81f3b4e06ead.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6b4ad83365b201226f5686ffd448d00c" alt="qiita2020_015.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/970a26d5-cc7e-ded8-cb6d-81f3b4e06ead.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F970a26d5-cc7e-ded8-cb6d-81f3b4e06ead.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=65b6b5cbff218d428a1bc7d22e39b73a 1x" loading="lazy"></a></p>

<p>ストレージは30GBまで無料らしいので一先ず30GBに設定し「次のステップ：タグの追加」へ。<br>
<a href="https://camo.qiitausercontent.com/31d3675d6ac8a5a1f6e08a4a77acdb9a0d549fcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f35383139386338352d613666312d666165322d303161652d3362303031316535386336622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F58198c85-a6f1-fae2-01ae-3b0011e58c6b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1787a21617557c16e71d77ea4ca2156e" alt="qiita2020_016.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/58198c85-a6f1-fae2-01ae-3b0011e58c6b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F58198c85-a6f1-fae2-01ae-3b0011e58c6b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5d8fd17e25687ddbe09447c01e7b2087 1x" loading="lazy"></a></p>

<p>タグの追加を押し、キーに「Name」、値に「Qiita2020TestServer」と入力します。（値はわかれば何でもいいです）<br>
入力したら「次のステップ：セキュリティグループの設定」へ。<br>
<a href="https://camo.qiitausercontent.com/55ef5b25987cab6210fbc44753ff4257bff22a4c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f32343339623264342d363565312d633837632d653761652d6131356466333738396465312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F2439b2d4-65e1-c87c-e7ae-a15df3789de1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9721995630beff469d0b9e405bbb3357" alt="qiita2020_017.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/2439b2d4-65e1-c87c-e7ae-a15df3789de1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F2439b2d4-65e1-c87c-e7ae-a15df3789de1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bbbb62499d1d866caa77c7b6dc069c73 1x" loading="lazy"></a></p>

<p>「ルールの追加」を押し、以下の様に入力し12345ポートを解放します。<br>
分かりやすいように説明も入れておきましょう。(※画像は日本語ですが、日本語の説明ではインスタンスが作成できなかったので、英語で入力してください！)<br>
入力したら「確認と作成」をクリック。<br>
<a href="https://camo.qiitausercontent.com/dea78e8f328c0e8578c187f9921e64c70ceda05e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f34336632386536372d303834352d386264612d363164312d6634633964366666336362362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F43f28e67-0845-8bda-61d1-f4c9d6ff3cb6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=23e2bd792b7a10fdb8ae30a87ff47c72" alt="qiita2020_018.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/43f28e67-0845-8bda-61d1-f4c9d6ff3cb6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F43f28e67-0845-8bda-61d1-f4c9d6ff3cb6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f8cda13770c19b198a5e84ac5f35956d 1x" loading="lazy"></a></p>

<p>確認画面で「すべてのIPからインスタンスにアクセスできるよ、いいの？」と警告されますが気にせず「起動」を押します。<br>
<a href="https://camo.qiitausercontent.com/7eaae782dbfcddc9806fd44b6b78c78b13b4033a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63663061393964322d643230312d643630322d613162362d3235313931323164393930372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf0a99d2-d201-d602-a1b6-2519121d9907.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8ddb16b6fa924d4ea24f075fa6a274df" alt="qiita2020_019.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/cf0a99d2-d201-d602-a1b6-2519121d9907.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf0a99d2-d201-d602-a1b6-2519121d9907.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=39c301062c6e974d2c16c4b54b7537a4 1x" loading="lazy"></a></p>

<p>インスタンスに安全に接続するためのキーペアを選びます。先ほど作成した「Qiita2020TestServer」キーペアを選んで、「インスタンスの作成」をクリックします。<br>
<a href="https://camo.qiitausercontent.com/d25b7c79167db76c5f80635b8f3b5d6ebb632c37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39353266623331362d666163312d656131332d666365662d3466633738353462363335312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F952fb316-fac1-ea13-fcef-4fc7854b6351.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=47bf2f4074e792c0a3b87d5c03e2ac8b" alt="qiita2020_024.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/952fb316-fac1-ea13-fcef-4fc7854b6351.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F952fb316-fac1-ea13-fcef-4fc7854b6351.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a5247d9148a41c9663f7895b4501b0e0 1x" loading="lazy"></a></p>

<p>インスタンス作成中の画面が表示されるので、右下の「インスタンスの表示」をクリックしてください。<br>
すると、作成されたインスタンス一覧が表示されます。問題がなければインスタンスはそのまま起動します。<br>
<a href="https://camo.qiitausercontent.com/4aab736dcb635f7a0a2fc5500db84a1b58c8f6df/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f31616335363636372d313531372d356537352d623864372d3137376162356361323630372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1ac56667-1517-5e75-b8d7-177ab5ca2607.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b33ba848e174e340cd2966692185a3bd" alt="qiita2020_026.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/1ac56667-1517-5e75-b8d7-177ab5ca2607.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1ac56667-1517-5e75-b8d7-177ab5ca2607.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=98be92743c7e14668adc59612c209b37 1x" loading="lazy"></a></p>

<p>これで、インスタンスの準備は整いました。<br>
作成したインスタンスの「IPv4パブリックIP」はターミナル接続先なので控えておいてください。</p>

<h2>
<span id="-ターミナルでec2インスタンスにログイン" class="fragment"></span><a href="#-%E3%82%BF%E3%83%BC%E3%83%9F%E3%83%8A%E3%83%AB%E3%81%A7ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AB%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3"><i class="fa fa-link"></i></a>② ターミナルでEC2インスタンスにログイン</h2>

<p>EC2インスタンスにログインします。<br>
ターミナルソフトは何でもいいですが、私は「TeraTerm」を使って解説します。</p>

<p>TeraTermを起動したらホストに先ほど作成したインスタンスのパブリックIPを入力してOKをクリック。<br>
<a href="https://camo.qiitausercontent.com/f82f7668a2dc15a7b54efcfac6b1c71ba41a3602/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f35333961653262322d636133302d313634312d643939392d3130623966356338376130392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F539ae2b2-ca30-1641-d999-10b9f5c87a09.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a3f1405fc357988924f5a9150decd43e" alt="qiita2020_033.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/539ae2b2-ca30-1641-d999-10b9f5c87a09.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F539ae2b2-ca30-1641-d999-10b9f5c87a09.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=da8eff7c4894d815cdd5e3a43dfa4a9c 1x" loading="lazy"></a></p>

<p>SSH認証が必要なので、ユーザ名に「ec2-user」、認証方式には最初の方に作成したキーペアの秘密鍵「Qiira2020TestServer.ppk」を指定します。<br>
<a href="https://camo.qiitausercontent.com/95e3bcbb1727e846c6f462ece5ce3f082939bd21/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63336663623432302d363332662d303335342d353037392d6339646365653132383965332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc3fcb420-632f-0354-5079-c9dcee1289e3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7bbbb32d051c3017f69e37c81c3b5df0" alt="qiita2020_034.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/c3fcb420-632f-0354-5079-c9dcee1289e3.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc3fcb420-632f-0354-5079-c9dcee1289e3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=51387f1792635650d6b365f2dcf89ed1 1x" loading="lazy"></a></p>

<p>問題なくSSH接続できたら以下の様に表示されます。ここからはいつものターミナルです。<br>
<a href="https://camo.qiitausercontent.com/3731778a0702e5a52c78368a1980bae2036481af/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36306432323365332d306632362d343363382d623338662d3934363935643530616634662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F60d223e3-0f26-43c8-b38f-94695d50af4f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=fb1e567a6baf32ab4d783fc3025b5d13" alt="qiita2020_035.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/60d223e3-0f26-43c8-b38f-94695d50af4f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F60d223e3-0f26-43c8-b38f-94695d50af4f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=54a5af8f5c715fb645247682096a98e2 1x" loading="lazy"></a></p>

<h2>
<span id="-netcore31をインストール" class="fragment"></span><a href="#-netcore31%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>③ .NetCore3.1をインストール</h2>

<p>必要なパッケージをインストールします。今回は.NetCoreを動かすためのランタイム「.NetCoreRuntime」をインストールすればOKです。</p>

<p>まずはパッケージ更新<br>
<code>$ sudo yum update</code></p>

<p>Microsoftパッケージリポジトリを追加。<br>
<code>$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</code></p>

<p>.NetCore3.1SDKインストール<br>
<code>$ sudo yum install dotnet-sdk-3.1</code></p>

<p>.NetCore3.1ランタイムインストール<br>
<code>$ sudo yum install dotnet-runtime-3.1</code></p>

<p>これでEC2上で.NetCore3.1プロジェクトが実行できるようになりました。</p>

<h2>
<span id="-サーバープロジェクトを配置実行" class="fragment"></span><a href="#-%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E9%85%8D%E7%BD%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>④ サーバープロジェクトを配置、実行</h2>

<p>サーバープロジェクトを配置します。配置方法は何でもいいですが個人的にはgitを使うのが一番楽です(余力のある方はGithubActions等を使ったCI/CDをお勧めします。)。サーバープロジェクトをgithubでリモート管理し、git cloneでそのまま配置します。こうすると何が良いかというと、サーバープロジェクトの更新が入った時にgit pullするだけで更新できます。<br>
ただ今回はプロジェクトをgithubに配置しないので、おとなしくsftpで配置します。sftpの解説はしません。各自良い感じにサーバープロジェクトを根こそぎ持ってきてください。</p>

<p>配置場所は<code>ec2-user</code>フォルダ内に「Qiita2020TestServer」を作ります。<br>
<code>$ mkdir Qiita2020TestServer</code><br>
この中にプロジェクトを配置します。</p>

<p>配置したら、Qiita2020TestServer.csprojがあるフォルダまで移動します。<br>
.Netはcsprojをそのまま<code>dotnet run</code>で実行することが出来るので、実行してみます。</p>

<p><code>$ dotnet run</code></p>

<p>これで以下の様にEC2上でサーバーが立ち上がりました。<br>
直に立ち上げるとSSHを終了した段階でサーバープログラムが止まってしまうので<code>screen</code>を使うと色々捗ります。<br>
<a href="https://camo.qiitausercontent.com/e6ab468946b62e5f6b6f125c8ec60d85054183b1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39373133636132642d396331322d333531632d343536642d6132306666666236313038302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F9713ca2d-9c12-351c-456d-a20fffb61080.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=cad99ef57c55c086a1676e1fd9ce64c5" alt="qiita2020_036.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/9713ca2d-9c12-351c-456d-a20fffb61080.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F9713ca2d-9c12-351c-456d-a20fffb61080.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c0e3e76e0323742e2c34cce6e3de11d2 1x" loading="lazy"></a></p>

<p>最後にクライアントからEC2上にアクセスできるか確認します。</p>

<h2>
<span id="-クライアント動作確認" class="fragment"></span><a href="#-%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>⑤ クライアント動作確認</h2>

<p>クライアントのapplicationHostが<code>localhost</code>のままなので、NetworkManagerのこの部分をEC2インスタンスのパブリックIPに置き換えてください。<br>
<a href="https://camo.qiitausercontent.com/0cc946f4b297ed43e65cc63a51b6ea83f1dea1f4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36373837616337302d323035302d663465392d626433392d6462646564313934653833632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6787ac70-2050-f4e9-bd39-dbded194e83c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7c8d517166926cce5e1b9ec68b7bc592" alt="qiita2020_037.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/6787ac70-2050-f4e9-bd39-dbded194e83c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6787ac70-2050-f4e9-bd39-dbded194e83c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=74ac4a5bdb2e722bb0cb79fe7c67b157 1x" loading="lazy"></a></p>

<p>置き換えて、クライアントをデバッグ実行します。そして、以下の表示が出たらEC2との接続に成功です！<br>
<a href="https://camo.qiitausercontent.com/e85cb3d71c751c88c56748cc20d127e8f535847f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f38313061373337372d663136652d613235342d643764622d3831313336306663613364382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F810a7377-f16e-a254-d7db-811360fca3d8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e469cca1d87f319d035cdc9ad305af49" alt="qiita2020_007.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/810a7377-f16e-a254-d7db-811360fca3d8.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F810a7377-f16e-a254-d7db-811360fca3d8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=535d627ab41ca8cdb8a0aba595265683 1x" loading="lazy"></a></p>

<p>これで、C#のみで作ったソシャゲの最低限の基盤ができました。<br>
ここからマスターデータやアセバン管理、クエスト処理やガチャ処理等を生やしていけば、C#のみで作るソシャゲの出来上がりです。お疲れまでした。</p>

<h1>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p>いかがでしょうか、意外と簡単にソシャゲの最低限の基盤を作ることができたのではないかと思います。もちろん本物はこれだけじゃ済まないボリュームですが、基礎を捉えるのは大きな前進になるのではないかと思います。</p>

<p>今回は省きまくりましたが、<strong>セキュリティだけはしっかり設定してください</strong>。ソシャゲはユーザの大事な情報を管理するので、ガバガバ設定では当然許されません。最低でも、ユーザーデータの暗号化、SSL、サーバー監視はしっかりするように！</p>

<p>皆様はもちろんC#信者だと思うので、その熱意をUnityだけではなくそのままサーバーサイドにも向けてみてはいかがでしょうか。私もまだまだサーバーサイドは勉強中なので偉そうなことは言えませんが、クライアントサイドとはまた別の面白さがあるので、やりがいはいっぱいあるかと思います。</p>

<p>頑張れば、一人でもソシャゲが作れる時代です。</p>

<p>最後まで読んでいただき、ありがとうございました。</p>

<h1>
<span id="参考資料" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99"><i class="fa fa-link"></i></a>参考資料</h1>

<ul>
<li><a href="https://docs.microsoft.com/ja-jp/dotnet/core/install/linux-centos" rel="nofollow noopener" target="_blank">CentOS に .NET Core SDK または .NET Core ランタイムをインストールする</a></li>
<li><a href="https://www.slideshare.net/torisoup/magiconion-174973732" rel="nofollow noopener" target="_blank">MagicOnion入門</a></li>
<li><a href="https://qiita.com/_y_minami/items/c7899fdf1db505c06ba2" id="reference-765e5ead9629bb6e19bc">Unity+.NET Core+MagicOnionの環境構築ハンズオン</a></li>
<li><a href="https://github.com/Cysharp/MagicOnion" rel="nofollow noopener" target="_blank">MagicOnion - github</a></li>
<li><a href="https://github.com/neuecc/MessagePack-CSharp" rel="nofollow noopener" target="_blank">MessagePack-CSharp - github</a></li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fyoship1639%2Fitems%2Fc54f6942d847f8374377&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fyoship1639%2Fitems%2Fc54f6942d847f8374377&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yoship1639/items/c54f6942d847f8374377/likers" class="css-1iupg5d">327</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">342</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/c54f6942d847f8374377/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yoship1639/items/c54f6942d847f8374377/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yoship1639/items/c54f6942d847f8374377/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yoship1639/items/c54f6942d847f8374377/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yoship1639/items/c54f6942d847f8374377.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-4cb82762-6225-498f-a991-4b08b1fc9c76">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-819fecda-0f2a-4989-b32f-5cb87faec715"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-819fecda-0f2a-4989-b32f-5cb87faec715">{}</script>
      
<div id="LoginModal-react-component-56d424eb-b4f0-4cf9-95ef-45e400627b08"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-56d424eb-b4f0-4cf9-95ef-45e400627b08">{}</script>
      
<div id="StockModal-react-component-b9f0da71-f7d1-4653-8607-67e5191766ad"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-b9f0da71-f7d1-4653-8607-67e5191766ad">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;1j0tOIQyrGVm0rLs15VPfPs6q+NGkytU3upok57ZxBtXQkuYzm9YhtUw/AK2Mu3eSgNtGy1RVs2jYcsqUeoFtg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e現在進行形でC#のみを使って個人でソシャゲ作りを試しているyoship1639です。\u003cbr\u003e\n本記事はQiita夏祭り2020「\u003ca href=\"https://qiita.com/official-events/5d181aadf5db26b73d33\"\u003e〇〇（言語）のみを使って、今△△（アプリ）を作るとしたら\u003c/a\u003e」のテーマに沿った内容となっています。\u003c/p\u003e\n\n\u003cp\u003e近年のソーシャルゲーム界隈は多様化が進んでクライアントサイドだけではなくサーバーサイドもあらゆる言語やフレームワークが試みられていますが、クライアントもサーバーも統一の言語で構成されているのはほとんどないかと思われます。言語にはその言語の得意分野があると思うので。\u003c/p\u003e\n\n\u003cp\u003eしかし、今まさに私が開発中の環境が好きな言語で開発しやすいという理由でクライアントもサーバーもC#で構成した作りになっているので、どのような構成でどうすれば最低限のソシャゲの基盤が作れるかを、解説が長くなり過ぎないようにまとめることが出来ればと思います。\u003c/p\u003e\n\n\u003cp\u003e三部構成で、クライアント実装、サーバー実装、AWS EC2へのデプロイまで解説できればと思っています。\u003cbr\u003e\nLet's、C#のみでソシャゲを作ろう！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ソシャゲの概要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%82%B7%E3%83%A3%E3%82%B2%E3%81%AE%E6%A6%82%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソシャゲの概要\u003c/h1\u003e\n\n\u003cp\u003e内容に入る前に、ソシャゲがどの様な流れで動作するのかを軽く説明します。\u003c/p\u003e\n\n\u003cp\u003eソシャゲは基本的にクライアント(スマホ端末)とサーバーとのやり取りで動いています。サーバーが動いていないとクライアントは基本動作しません。これはクライアント側で不正にデータの書き換えをされると運営が困るからです。\u003c/p\u003e\n\n\u003cp\u003eサーバー側は大体以下の様なAPI機能を備えています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eアプリバージョン判定\u003c/li\u003e\n\u003cli\u003eマスターデータ・アセットバンドル更新判定\u003c/li\u003e\n\u003cli\u003eログイン (セッション管理)\u003c/li\u003e\n\u003cli\u003eアカウント作成\u003c/li\u003e\n\u003cli\u003eクエスト開始・終了\u003c/li\u003e\n\u003cli\u003eガチャ\u003c/li\u003e\n\u003cli\u003eetc...\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e挙げたらきりがないくらいにはサーバーにはやらなければならない仕事があります。それだけクライアントとサーバーは適所で通信しています。こうすることで、例えばクライアントのデータが紛失したとしてもサーバーから復元することが出来ますし、クライアント側で不正があったらサーバー側で検知してBANすることもできますし、ユーザーのアプリ上での動向から問い合わせにも対応することができるようになりますし、課金周りのレシート検証もサーバー側で正確に行えるので、課金したのに石が反映されないみたいな場面でも補填対応することが出来るようになります。基本ユーザにとっても運営にとってもメリットしかないです。\u003c/p\u003e\n\n\u003cp\u003e近年バックエンドはBaas(PlayFab、Firebase、GameSparks、GS2など)が鎬を削っており態々バックエンドを自前で準備しなくてもBaasを使うという手段がありますが、ドキュメントが英語のみだったり痒いところに手が届かなかったりと一長一短なので、どうしてもサーバーサイドを触りたくないという訳ではないのであれば個人的にはまだ自前で準備したほうが良いかな感はあります。\u003c/p\u003e\n\n\u003cp\u003eソシャゲの動作の最初の流れとしては以下の様になります。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eアプリバージョンを検証\u003c/li\u003e\n\u003cli\u003eログイン (ログインできなかったらアカウント作成)\u003c/li\u003e\n\u003cli\u003e更新データ確認 (アセバン、マスターデータ)\u003c/li\u003e\n\u003cli\u003e以降アプリによって色々\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e今回は最低限の基盤だけ考えるので、2番の「\u003cstrong\u003eアカウント作成\u003c/strong\u003e」と「\u003cstrong\u003eログイン\u003c/strong\u003e」機能を作りたいと思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"構成の全体像\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A7%8B%E6%88%90%E3%81%AE%E5%85%A8%E4%BD%93%E5%83%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e構成の全体像\u003c/h1\u003e\n\n\u003cp\u003e今回作るサンプルは、C#のみで構成するソシャゲの最低限の基盤で以下の構成となっています。\u003c/p\u003e\n\n\u003cp\u003eクライアント：C#(\u003ca href=\"https://unity.com/ja\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnity2019.X\u003c/a\u003e)\u003cbr\u003e\nサーバー：C#(\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/core/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NetCore3.1\u003c/a\u003e)\u003cbr\u003e\nデプロイ：\u003ca href=\"https://aws.amazon.com/jp/ec2/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAWS EC2\u003c/a\u003e(\u003ca href=\"https://aws.amazon.com/jp/amazon-linux-2/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAmazon Linux 2\u003c/a\u003e)\u003cbr\u003e\nサーバー \u0026lt;--\u0026gt; クライアント：\u003ca href=\"https://github.com/Cysharp/MagicOnion\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMagicOnion\u003c/a\u003e(HTTP/2, gRPC)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/49ded3134212d0abba6554a5be9af5eba6684e01/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f33303765323433372d616233352d326337322d373630342d3764383039643362336164382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F307e2437-ab35-2c72-7604-7d809d3b3ad8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9b3b1da1a426d9aafeaeb0384999290f\" alt=\"構成図.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/307e2437-ab35-2c72-7604-7d809d3b3ad8.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F307e2437-ab35-2c72-7604-7d809d3b3ad8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d1cba526be0c58071966ae16faf90aec 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eクライアントは皆大好きUnity、サーバーはプラットフォーム関係なく動かせる.NetCore、デプロイはEC2、クライアントとサーバーのやり取りは巷で噂のMagicOnion(gRPCのC#ラッパー+α)です。最低限の構成であれば全部無料で準備できます。\u003c/p\u003e\n\n\u003cp\u003e本来であれば、DB用意したり、直じゃなくDockerコンテナでデプロイとかすべきですが、本記事から内容が逸れそうなので簡単な構成にしています。\u003c/p\u003e\n\n\u003cp\u003eまずは、クライアントサイドから作ってみます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"クライアントサイド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%82%B5%E3%82%A4%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクライアントサイド\u003c/h1\u003e\n\n\u003cp\u003eクライアントサイドはエンジンとしてUnity2019.Xを使います。言語は当然C#です。\u003c/p\u003e\n\n\u003cp\u003e実装手順としては以下の通りとなります。\u003c/p\u003e\n\n\u003cp\u003e① MagicOnion, MessagePack, grpc をUnityにインポートする\u003cbr\u003e\n② Serviceを定義\u003cbr\u003e\n③ NetworkManagerを実装\u003cbr\u003e\n④ ログインテストコードを実装\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-magiconion-messagepack-grpc-をunityにインポートする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-magiconion-messagepack-grpc-%E3%82%92unity%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e① MagicOnion, MessagePack, grpc をUnityにインポートする\u003c/h2\u003e\n\n\u003cp\u003eまず、MagicOnion、MessagePack、grpcをUnityにインポートします。サーバーと通信するのに必要なものです。\u003cbr\u003e\nこれらを簡単に説明すると、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eMagicOnion: リアルタイム/API通信フレームワーク。gRPCをC#で使いやすいようにラップしたイメージ。\u003c/li\u003e\n\u003cli\u003eMessagePack: 高効率のバイナリ形式のシリアライズフォーマット。JSONよりすごいやつ。MagicOnionに必要。\u003c/li\u003e\n\u003cli\u003egrpc: googleが作ったRPCフレームワーク。MagicOnionの中身はこれ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eとなっています。\u003c/p\u003e\n\n\u003cp\u003eなんでMagicOnionを使うかというと、以下のメリットがあるからです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eHTTP/2の恩恵を受け、かつ通信データが高効率で圧縮されるため通信が早い。\u003c/li\u003e\n\u003cli\u003eインターフェースベースの通信が実現されるのでデータフォーマットを考えなくていい。\u003c/li\u003e\n\u003cli\u003eエンドポイントやAPIスキーマを考えなくていい。\u003c/li\u003e\n\u003cli\u003eAPIだけでなくリアルタイム通信としても使える。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e使うには十分すぎるメリットではないかと思います。MagicOnionの詳細は解説しないので、各自調べていただければと思います。\u003c/p\u003e\n\n\u003cp\u003eまず、MagicOnionをインポートします。\u003cbr\u003e\n\u003ca href=\"https://github.com/Cysharp/MagicOnion/releases\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/Cysharp/MagicOnion/releases\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこちらのリリースページにある「\u003cstrong\u003eMagicOnion.Client.Unity.unitypackage\u003c/strong\u003e」をダウンロードしUnityにインポートしてください。色々足りないと怒られますが気にせず次へいきます。\u003c/p\u003e\n\n\u003cp\u003e次に、MessagePackをインポートします。\u003cbr\u003e\n\u003ca href=\"https://github.com/neuecc/MessagePack-CSharp/releases\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/neuecc/MessagePack-CSharp/releases\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこちらのリリースページにある「\u003cstrong\u003eMessagePack.Unity.XXXXX.unitypackage\u003c/strong\u003e」をダウンロードしUnityにD\u0026amp;Dしてください。最新のリリースで問題なく動作するはずです。\u003c/p\u003e\n\n\u003cp\u003eこの時、Pluginsフォルダ内のdllが既に取り込まれているよと警告されるので、Pluginsフォルダのチェックを外してインポートしてください。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d814fddcbde663a7a24d14f36cf61e7d87f82c85/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f33353130323161372d303966642d306339652d646132622d3935303763383632323634362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F351021a7-09fd-0c9e-da2b-9507c8622646.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9d0b5709372af9456ca71367b738eb4f\" alt=\"qiita2020_001.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/351021a7-09fd-0c9e-da2b-9507c8622646.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F351021a7-09fd-0c9e-da2b-9507c8622646.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fb88271ac2a920bd948c616b17bcb3ef 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e最後に、grpcをインポートします。\u003cbr\u003e\n\u003ca href=\"https://packages.grpc.io/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://packages.grpc.io/\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこちらのページの最新のコミットのBuild IDをクリックし、C#欄にある「\u003cstrong\u003egrpc_unity_package.XXXXX-dev.zip\u003c/strong\u003e」をダウンロード、解凍します。\u003cbr\u003e\n解凍すると「Plugins」フォルダがあるはずなので、Pluginsフォルダの中身をUnityのAssets/Pluginsフォルダに入れてインポートします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/efc5e87b01363400d48bafa79f7b4214e0ed4965/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f37343066383934312d653337392d333839622d353930392d6535663533326432656136632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F740f8941-e379-389b-5909-e5f532d2ea6c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=729e15f834bd88daf05fbe5af7588109\" alt=\"qiita2020_002.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/740f8941-e379-389b-5909-e5f532d2ea6c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F740f8941-e379-389b-5909-e5f532d2ea6c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f8452de7dd5e2c898dc751eaee10c022 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそれでもまだ怒られると思うので、エラーを解決していきます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSystem.Buffersが被っているので、どちらかを削除\u003c/li\u003e\n\u003cli\u003eSystem.Memoryが被っているので、どちらかを削除\u003c/li\u003e\n\u003cli\u003eSystem.Runtime.CompilerServices.Unsafeが被っているので、どちらかを削除\u003c/li\u003e\n\u003cli\u003eunsafeコードが許可されていないぞ☆って怒られるのでunsafeコードを許可\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eこれでエラーは出なくなるはずです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-serviceを定義\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-service%E3%82%92%E5%AE%9A%E7%BE%A9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e② Serviceを定義\u003c/h2\u003e\n\n\u003cp\u003e諸々インポートが完了したらServiceを定義します。ServiceとはWebAPIと同様のものと考えていただければと思います。\u003cbr\u003e\nソーシャルゲームは基本的に特定の動作ごとにサーバーにAPIを投げてそのレスポンスを基にクライアントを動かします。\u003c/p\u003e\n\n\u003cp\u003e本来、API定義を考える場合「https://〇〇〇〇/create_account」みたいなエンドポイントやらスキーマやらを考えなくてはいけませんが、MagicOnionの場合はインターフェース定義自体がそれに当たります。これメチャクチャ便利です。\u003c/p\u003e\n\n\u003cp\u003eアカウント作成とログインの機能は、以下の様に定義できます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eIAccountService.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMagicOnion\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// アカウント周りのサービスを定義するインターフェース\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIAccountService\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIService\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIAccountService\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// アカウント作成\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnaryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateAccount\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// ログイン\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnaryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eLogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eCreateAccountはサーバー側で作成されたユーザIDとパスワードを返し、Loginは引数にユーザIDとパスワードを入力するとログイン中であるセッション情報(string)を返します。\u003c/p\u003e\n\n\u003cp\u003eクライアントはIAccountServiceだけを知っていればいいので、IAccountServiceの実態はサーバー側で実装します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-networkmanagerを実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-networkmanager%E3%82%92%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e③ NetworkManagerを実装\u003c/h2\u003e\n\n\u003cp\u003eServiceの定義が終わったら実際にサーバーと通信する処理を担当するNetworkManagerを実装します。\u003cbr\u003e\nクライアントはこのNetworkManagerを使ってサーバーとのやり取りをします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eNetworkManager.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Threading.Tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eGrpc.Core\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMagicOnion.Client\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eNetworkManager\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializeField\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eapplicationHost\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"localhost\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializeField\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eapplicationPort\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e12345\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIAccountService\u003c/span\u003e \u003cspan class=\"n\"\u003eaccountService\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003echannel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eChannel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eapplicationHost\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eapplicationPort\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eChannelCredentials\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInsecure\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eaccountService\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMagicOnionClient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIAccountService\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003echannel\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// アカウント作成\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateAccount\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// サーバーにアカウント作成を要求、レスポンスは作成されたユーザIDとパスワード\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eaccountService\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateAccount\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// ログイン\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebool\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eLogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// ユーザIDとパスワードをサーバーに投げてログイン、レスポンスはセッション情報\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eaccountService\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eapplicationHostは\u003ccode\u003elocalhost\u003c/code\u003eにしてありますが、後でデプロイ先のエンドポイントに切り替えます。\u003cbr\u003e\nセキュリティの関係からsslにすべきですが、今回は割愛です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-ログインテストコードを実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e④ ログインテストコードを実装\u003c/h2\u003e\n\n\u003cp\u003e実際にログインのテストコードを記述してみます。\u003cbr\u003e\n処理内容はとても単純で、まずローカルに保存してあるユーザー情報(ユーザーID、パスワード)を読み込みます。ユーザー情報そのものがなかったらアカウントを作成し作成されたユーザー情報を保存します。次に、ユーザー情報を元にログインし、通った時と通らなかった時で処理を分けるという形です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLoginTest.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMessagePack\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eMessagePackObject\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUserData\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLoginTest\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ネットワークマネージャ取得\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enetwork\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNetworkManager\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 保存してあるユーザーデータ情報を読み込み\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eUserData\u003c/span\u003e \u003cspan class=\"n\"\u003euserData\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003euserData\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMessagePackSerializer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eUserData\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadAllBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epersistentDataPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/userData.dat\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ユーザーデータが存在しなかったらアカウント作成\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserData\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アカウント作成開始\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003enetwork\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateAccount\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// TODO: アカウント作成失敗時の処理\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アカウント作成失敗。。。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003euserData\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eUserData\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003euserData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003euserData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ユーザー情報保存(※本来は暗号化等する事！)\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMessagePackSerializer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSerialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserData\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteAllBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epersistentDataPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/userData.dat\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アカウント作成成功\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ログイン\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ログイン中...\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eloginResult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003enetwork\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003euserData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eloginResult\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// TODO: ログイン失敗時の処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ログイン失敗。。。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// TODO: ログインが通った後の処理\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ログイン成功！\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e本来ならばもっと厳密にログイン処理を行うべきですが、今回はテストなので超単純に作っています。\u003cbr\u003e\nここを通ればログインに成功したことになるので、後はクライアント側は煮るなり焼くなりするだけです。\u003c/p\u003e\n\n\u003cp\u003e次に、サーバーサイドの実装に移ります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"サーバーサイド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%82%B5%E3%82%A4%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサーバーサイド\u003c/h1\u003e\n\n\u003cp\u003eサーバーサイドはフレームワークとして.NetCore3.1を使います。言語は当然C#です。\u003cbr\u003e\n.NetFrameworkを使ってしまうとデプロイ周りで苦労することになるので、サーバーサイドC#は.NetCoreを使ってください。\u003c/p\u003e\n\n\u003cp\u003eサーバーの実装手順としては以下の様になります。\u003c/p\u003e\n\n\u003cp\u003e① プロジェクトの準備、MagicOnionのインストール\u003cbr\u003e\n② Mainプログラムの記述\u003cbr\u003e\n③ AccountServiceの実装\u003cbr\u003e\n④ ローカル環境で動作確認\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-プロジェクトの準備magiconionのインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E6%BA%96%E5%82%99magiconion%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e① プロジェクトの準備、MagicOnionのインストール\u003c/h2\u003e\n\n\u003cp\u003eまず、プロジェクトを作成します。プロジェクトは「コンソール アプリ(.NET Core)」を選択してください。プロジェクト名は何でもいいです。私はとりあえず「Qiita2020TestServer」にしました。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/e7d2221e5d5912df27f2a7140377a576faa9edc0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f38343431346631622d303433652d626232622d396534382d3937386633333430356565642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F84414f1b-043e-bb2b-9e48-978f33405eed.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b7f11d238dc89f50c8406dbc46651fc7\" alt=\"qiita2020_003.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/84414f1b-043e-bb2b-9e48-978f33405eed.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F84414f1b-043e-bb2b-9e48-978f33405eed.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f757b368c2dcbe0b1e3bcf76c903c121 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eプロジェクトの作成が終わったら、クライアントとの通信に必要なコンポーネントをNuget経由でインストールします。\u003cbr\u003e\nプロジェクトのコンテキストメニューの「Nuget パッケージの管理(N)...」から\u003ccode\u003eMagicOnion.Hosting\u003c/code\u003eをインストールします。バージョンは最新の安定板で大丈夫です。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/ddadec4e4a9fa43186530c735cf8733a5bc1e14d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f33326536663330392d366566392d636635392d653233612d3762336236636333363434642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F32e6f309-6ef9-cf59-e23a-7b3b6cc3644d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=95d18ba0e78c49bdeb1eab5a124eacf2\" alt=\"qiita2020_004.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/32e6f309-6ef9-cf59-e23a-7b3b6cc3644d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F32e6f309-6ef9-cf59-e23a-7b3b6cc3644d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a965d5e782e5d07c5231aabe55abb2e4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e一応、Unityで使われている型をサーバーでも扱えるように\u003ccode\u003eMessagePack.UnityShims\u003c/code\u003eもインストールしておきます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/3c4aa427fb8c37e3d3d7b02715d98f4bfaa789fb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36356634343965362d356431392d346239362d343936332d3033653134393562316530372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F65f449e6-5d19-4b96-4963-03e1495b1e07.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=12b2ee6062c6ffd10b405aec88fc8744\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/65f449e6-5d19-4b96-4963-03e1495b1e07.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F65f449e6-5d19-4b96-4963-03e1495b1e07.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=03ab4c0ef3738179d944c9262cc4626e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれでサーバーサイドに必要なコンポーネントがインストールできました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-mainプログラムの記述\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-main%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E8%A8%98%E8%BF%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e② Mainプログラムの記述\u003c/h2\u003e\n\n\u003cp\u003eサーバーを起動するMainプログラムを記述します。\u003cbr\u003e\nやっていることはとても単純で、ログ出力先をコンソールに指定し、ホストとポートを指定して起動しているだけです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eProgram.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eGrpc.Core\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMagicOnion.Hosting\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMagicOnion.Server\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMicrosoft.Extensions.Hosting\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Threading.Tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eQiita2020TestServer\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eProgram\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// コンソールにログ出力するように設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGrpcEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eGrpc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLogging\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eConsoleLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// MagicOnionを使ってホスト作成、起動\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eMagicOnionHost\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateDefaultBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUseMagicOnion\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMagicOnionOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisReturnExceptionStackTraceInErrorDetail\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eServerPort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"0.0.0.0\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e12345\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eServerCredentials\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInsecure\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunConsoleAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e一応これだけでもサーバーを起動することはできます。デバッグ実行すると以下の様な画面が出るはずです。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/f0a79597a17cd921bb8297b40362bd3a5bce6a12/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36333536666637302d323835342d353130352d376634312d6561373465346636316533342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6356ff70-2854-5105-7f41-ea74e4f61e34.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=93f5ae193c817f9d316639a9c13e36c3\" alt=\"qiita2020_006.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/6356ff70-2854-5105-7f41-ea74e4f61e34.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6356ff70-2854-5105-7f41-ea74e4f61e34.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cfd31241b00811bb16dfd52889b38a52 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれだけでは何の機能もない張りぼてサーバーなので、クライアント側で実装した「アカウント作成」と「ログイン」機能を実装していきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-accountserviceの実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-accountservice%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e③ AccountServiceの実装\u003c/h2\u003e\n\n\u003cp\u003eサーバー側のアカウント作成とログイン機能の実装をします。\u003cbr\u003e\nクライアントで定義したIAccountService.csが必要なので、予め丸々コピーしておいてください。（本来は、submodule等用いてソースコードの共有をすることをお勧めします。）\u003c/p\u003e\n\n\u003cp\u003eアカウント作成は、ランダムなハッシュ値を用います。ユーザーIDは20桁、パスワードは12桁にしておきます。ログインは作成されたユーザーIDとパスワードを検証し、一致したら以降のAPIを呼び出すことが出来るセッションを返します。セッションも一先ずランダムな20桁のハッシュ値を返します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAccountService.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMagicOnion\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMagicOnion.Server\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Security.Cryptography\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eQiita2020TestServer\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAccountService\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eServiceBase\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIAccountService\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;,\u003c/span\u003e \u003cspan class=\"n\"\u003eIAccountService\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// セッション情報管理（本来はRedis等用いる事！）\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003eexpireAt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esessions\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003eexpireAt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u0026gt;();\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003elockObject\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// アカウント作成\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eUnaryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateAccount\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CreateAccount Request\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGenerateHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGenerateHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// アカウント情報を仮でファイルに保存(本来はDBに入れる事！)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"accounts\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"accounts\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"accounts/\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"CreateAccount Error\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"CreateAccount UserId:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e, Password:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ログイン\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eUnaryResult\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eLogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Login Request\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// アカウントがない\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"accounts/\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// パスワードが一致しない\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"accounts/\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Login failed: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Login Error\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// セッション情報作成\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGenerateHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003elock\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elockObject\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 一先ず1日有効なセッションを保存\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esessions\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUtcNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddDays\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"【\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003euserId\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"】Login succeeded!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// セッションを返す\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 指定の長さのランダムハッシュ値を取得\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eGenerateHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eSha256\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"N\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToLower\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Sha256ハッシュ\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eSha256\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003einput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eASCII\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esha\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSHA256CryptoServiceProvider\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esha256\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esha\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eComputeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003esha256\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{0:X2}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esha256\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]));\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれで、アカウント作成とログイン機能を備えたサーバープログラムが整いました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-ローカル環境で動作確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E7%92%B0%E5%A2%83%E3%81%A7%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e④ ローカル環境で動作確認\u003c/h2\u003e\n\n\u003cp\u003eここまでで、ローカル環境で動作確認をすることが出来るようになったので、確認してみます。\u003cbr\u003e\nサーバーをデバッグ実行してローカルサーバーを立ち上げ、クライアントをデバッグ実行します。\u003cbr\u003e\n問題がなければクライアントは以下の様に表示されるはずです。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/8775797bf24683a05909750c5b1abac6a6a183bd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36313465616563332d353738362d336533332d313938392d3139316537663834653739372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F614eaec3-5786-3e33-1989-191e7f84e797.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9046203e923a3716438ec2516706cb69\" alt=\"qiita2020_007.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/614eaec3-5786-3e33-1989-191e7f84e797.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F614eaec3-5786-3e33-1989-191e7f84e797.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4cffadf7961d3dde6ade075329018bbc 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nサーバー側は以下の様に表示されます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/abdef55af5e6fb0635fdee2e9480ae3dd7decde4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f65376166333333302d633331332d613066652d353665392d6266613535633437336466362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe7af3330-c313-a0fe-56e9-bfa55c473df6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3a2512b585dad2f392c61a07ccebb703\" alt=\"qiita2020_008.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/e7af3330-c313-a0fe-56e9-bfa55c473df6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe7af3330-c313-a0fe-56e9-bfa55c473df6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ed16d6be70f82da56f1b7b350a85e9c7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nローカルで問題なく動作できていることが確認できました。\u003cbr\u003e\n最後に、実際にクラウド上にデプロイして確認してみたいと思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"デプロイ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデプロイ\u003c/h1\u003e\n\n\u003cp\u003eローカル環境で問題なく動作させることが確認できれば、本来はデプロイまでは頑張らなくてもいいですが、せっかくなのでEC2へのデプロイまでやってみたいと思います。CI/CDやDockerコンテナでもよかったのですが解説が逸れそうなので直デプロイします。\u003c/p\u003e\n\n\u003cp\u003e手順としては、以下の様になります。\u003cbr\u003e\n① awsでEC2インスタンスを用意、起動する\u003cbr\u003e\n② ターミナルでEC2インスタンスにログイン\u003cbr\u003e\n③ .NetCore3.1をインストール\u003cbr\u003e\n④ サーバープロジェクトを配置、実行\u003cbr\u003e\n⑤ クライアント動作確認\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-awsでec2インスタンスを用意起動する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-aws%E3%81%A7ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%82%92%E7%94%A8%E6%84%8F%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e① awsでEC2インスタンスを用意、起動する\u003c/h2\u003e\n\n\u003cp\u003e最初にAWSコンソールにサインインします。アカウントを持ってない人は作ってください。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/81281cd6dfd6225dd4c8af324a0401e551a2719b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63303933316162342d646236392d316134652d393530382d3439313464663763336536612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc0931ab4-db69-1a4e-9508-4914df7c3e6a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ea0fb41f76ba6efad0c814085145002c\" alt=\"qiita2020_010.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/c0931ab4-db69-1a4e-9508-4914df7c3e6a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc0931ab4-db69-1a4e-9508-4914df7c3e6a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e0bba12a33bf6d47f6607dd7c0da8514 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eサインインしたらEC2を選択します。EC2は仮想サーバーみたいなものだと思ってください。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/172d8b2753fd1ff2b92f87d93ea05f740844b9d8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39323462303939652d333333352d636139632d393838332d3739646264383039303661622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F924b099e-3335-ca9c-9883-79dbd80906ab.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=160812408d753c52279e27e6b66b040e\" alt=\"qiita2020_009.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/924b099e-3335-ca9c-9883-79dbd80906ab.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F924b099e-3335-ca9c-9883-79dbd80906ab.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ad5e3eb5882c29821aec5e0637687000 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e左側の「キーペア」を選択します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d497d734de6973c744baaff0afd57d9a52c3f59f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f31633533316635392d396636662d386439392d333566622d6538643730663838626639372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1c531f59-9f6f-8d99-35fb-e8d70f88bf97.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d9fb05119f0dd99ad0a4094e4dcd569d\" alt=\"qiita2020_020.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/1c531f59-9f6f-8d99-35fb-e8d70f88bf97.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1c531f59-9f6f-8d99-35fb-e8d70f88bf97.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=65c0bc2932d9bd193115acefab5c9d0d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e右上の「キーペアを作成」をクリックします。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/56900b617c4f51fcbd04fd60d618c52fe7b95bb5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f32383234373735372d373634362d366231362d613561612d3465653365646239373139622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F28247757-7646-6b16-a5aa-4ee3edb9719b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=40ce35ff6e74a4bd91e42c270d119360\" alt=\"qiita2020_021.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/28247757-7646-6b16-a5aa-4ee3edb9719b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F28247757-7646-6b16-a5aa-4ee3edb9719b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7cc6dd5dd729f632a8ad609a518332e1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e名前を「Qiita2020TestServer」(名前は何でもいいです)にして、「キーペアを作成」をクリックします。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/87b9189220158c7433acd1157857dade44321ff8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63663132383965342d376238652d323133652d396263362d3038373437396561653034662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf1289e4-7b8e-213e-9bc6-087479eae04f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5880f9e2dbb0e53ed17379c956538ae5\" alt=\"qiita2020_022.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/cf1289e4-7b8e-213e-9bc6-087479eae04f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf1289e4-7b8e-213e-9bc6-087479eae04f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=dc84130be12310662b294398e93c55b8 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eキーペアが作成されppkファイルがダウンロードされます。\u003cbr\u003e\nこのキーは後で作るインスタンスへのログインに必要なので、大切に保管しましょう。\u003c/p\u003e\n\n\u003cp\u003e次に、左側の「インスタンス」を選択します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/a9b55c41033bee231f01d94b2bf3d8b12758355f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f34656161653363372d353437622d303939382d306333612d3035366434623333306261392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F4eaae3c7-547b-0998-0c3a-056d4b330ba9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ed79f3eabd2ebb61744eb856c171b8a8\" alt=\"qiita2020_011.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/4eaae3c7-547b-0998-0c3a-056d4b330ba9.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F4eaae3c7-547b-0998-0c3a-056d4b330ba9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=42b0d9a700da049a322df445acc741ca 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「インスタンスの作成」をクリックします。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d858f8e8e02dec6ae995493e502a281f9a2539f8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f61626531643161382d623536322d643630392d643561622d6161636466366237636337302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fabe1d1a8-b562-d609-d5ab-aacdf6b7cc70.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0b03faa9247d9070055e87ec792e600b\" alt=\"qiita2020_012.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/abe1d1a8-b562-d609-d5ab-aacdf6b7cc70.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fabe1d1a8-b562-d609-d5ab-aacdf6b7cc70.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=600360009c34a9693a6ba3872b53315c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e何のインスタンスを作るか聞かれるので、「Amazon Linux 2 AMI」を選択してください。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/85d83fd5c4891bd4b51bbc39fb56f33665ed7a4b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f31353138666235392d613930332d616633312d646535612d3136663065663965663039662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1518fb59-a903-af31-de5a-16f0ef9ef09f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0f74ab9105acc3de806faf96e24187b2\" alt=\"qiita2020_013.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/1518fb59-a903-af31-de5a-16f0ef9ef09f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1518fb59-a903-af31-de5a-16f0ef9ef09f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5c0de003a8367d9da44c393b9a0eba36 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eどのスペックの仮想マシンを立ち上げるか聞かれるので、無料で使える「t2.micro」を選択し、「次のステップ：インスタンスの詳細と設定」をクリック。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/a36caf836d2ba935b60e3cdae0269156e98df19a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f65343433653434612d373934662d616230362d616331392d3135323837376537343362312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe443e44a-794f-ab06-ac19-152877e743b1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=415796aaba0673cea1d64444916fbb0f\" alt=\"qiita2020_014.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/e443e44a-794f-ab06-ac19-152877e743b1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fe443e44a-794f-ab06-ac19-152877e743b1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a6ac1ffdf63ca57c0ba0911522a32bcd 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eいろんな設定項目がありますが、ここでは「自動割り当てパブリックIP」を「有効」にします。\u003cbr\u003e\n有効にしたら「次のステップ：ストレージの追加」へ。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/95b48fded7184eff5605e44f183a4d7abb0cfe74/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39373061323664352d636337652d646564382d636236642d3831663362346530366561642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F970a26d5-cc7e-ded8-cb6d-81f3b4e06ead.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6b4ad83365b201226f5686ffd448d00c\" alt=\"qiita2020_015.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/970a26d5-cc7e-ded8-cb6d-81f3b4e06ead.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F970a26d5-cc7e-ded8-cb6d-81f3b4e06ead.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=65b6b5cbff218d428a1bc7d22e39b73a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eストレージは30GBまで無料らしいので一先ず30GBに設定し「次のステップ：タグの追加」へ。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/31d3675d6ac8a5a1f6e08a4a77acdb9a0d549fcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f35383139386338352d613666312d666165322d303161652d3362303031316535386336622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F58198c85-a6f1-fae2-01ae-3b0011e58c6b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1787a21617557c16e71d77ea4ca2156e\" alt=\"qiita2020_016.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/58198c85-a6f1-fae2-01ae-3b0011e58c6b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F58198c85-a6f1-fae2-01ae-3b0011e58c6b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5d8fd17e25687ddbe09447c01e7b2087 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eタグの追加を押し、キーに「Name」、値に「Qiita2020TestServer」と入力します。（値はわかれば何でもいいです）\u003cbr\u003e\n入力したら「次のステップ：セキュリティグループの設定」へ。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/55ef5b25987cab6210fbc44753ff4257bff22a4c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f32343339623264342d363565312d633837632d653761652d6131356466333738396465312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F2439b2d4-65e1-c87c-e7ae-a15df3789de1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9721995630beff469d0b9e405bbb3357\" alt=\"qiita2020_017.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/2439b2d4-65e1-c87c-e7ae-a15df3789de1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F2439b2d4-65e1-c87c-e7ae-a15df3789de1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bbbb62499d1d866caa77c7b6dc069c73 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「ルールの追加」を押し、以下の様に入力し12345ポートを解放します。\u003cbr\u003e\n分かりやすいように説明も入れておきましょう。(※画像は日本語ですが、日本語の説明ではインスタンスが作成できなかったので、英語で入力してください！)\u003cbr\u003e\n入力したら「確認と作成」をクリック。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/dea78e8f328c0e8578c187f9921e64c70ceda05e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f34336632386536372d303834352d386264612d363164312d6634633964366666336362362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F43f28e67-0845-8bda-61d1-f4c9d6ff3cb6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=23e2bd792b7a10fdb8ae30a87ff47c72\" alt=\"qiita2020_018.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/43f28e67-0845-8bda-61d1-f4c9d6ff3cb6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F43f28e67-0845-8bda-61d1-f4c9d6ff3cb6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f8cda13770c19b198a5e84ac5f35956d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e確認画面で「すべてのIPからインスタンスにアクセスできるよ、いいの？」と警告されますが気にせず「起動」を押します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/7eaae782dbfcddc9806fd44b6b78c78b13b4033a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63663061393964322d643230312d643630322d613162362d3235313931323164393930372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf0a99d2-d201-d602-a1b6-2519121d9907.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8ddb16b6fa924d4ea24f075fa6a274df\" alt=\"qiita2020_019.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/cf0a99d2-d201-d602-a1b6-2519121d9907.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fcf0a99d2-d201-d602-a1b6-2519121d9907.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=39c301062c6e974d2c16c4b54b7537a4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eインスタンスに安全に接続するためのキーペアを選びます。先ほど作成した「Qiita2020TestServer」キーペアを選んで、「インスタンスの作成」をクリックします。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d25b7c79167db76c5f80635b8f3b5d6ebb632c37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39353266623331362d666163312d656131332d666365662d3466633738353462363335312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F952fb316-fac1-ea13-fcef-4fc7854b6351.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=47bf2f4074e792c0a3b87d5c03e2ac8b\" alt=\"qiita2020_024.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/952fb316-fac1-ea13-fcef-4fc7854b6351.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F952fb316-fac1-ea13-fcef-4fc7854b6351.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a5247d9148a41c9663f7895b4501b0e0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eインスタンス作成中の画面が表示されるので、右下の「インスタンスの表示」をクリックしてください。\u003cbr\u003e\nすると、作成されたインスタンス一覧が表示されます。問題がなければインスタンスはそのまま起動します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/4aab736dcb635f7a0a2fc5500db84a1b58c8f6df/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f31616335363636372d313531372d356537352d623864372d3137376162356361323630372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1ac56667-1517-5e75-b8d7-177ab5ca2607.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b33ba848e174e340cd2966692185a3bd\" alt=\"qiita2020_026.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/1ac56667-1517-5e75-b8d7-177ab5ca2607.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F1ac56667-1517-5e75-b8d7-177ab5ca2607.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=98be92743c7e14668adc59612c209b37 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれで、インスタンスの準備は整いました。\u003cbr\u003e\n作成したインスタンスの「IPv4パブリックIP」はターミナル接続先なので控えておいてください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-ターミナルでec2インスタンスにログイン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-%E3%82%BF%E3%83%BC%E3%83%9F%E3%83%8A%E3%83%AB%E3%81%A7ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AB%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e② ターミナルでEC2インスタンスにログイン\u003c/h2\u003e\n\n\u003cp\u003eEC2インスタンスにログインします。\u003cbr\u003e\nターミナルソフトは何でもいいですが、私は「TeraTerm」を使って解説します。\u003c/p\u003e\n\n\u003cp\u003eTeraTermを起動したらホストに先ほど作成したインスタンスのパブリックIPを入力してOKをクリック。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/f82f7668a2dc15a7b54efcfac6b1c71ba41a3602/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f35333961653262322d636133302d313634312d643939392d3130623966356338376130392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F539ae2b2-ca30-1641-d999-10b9f5c87a09.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a3f1405fc357988924f5a9150decd43e\" alt=\"qiita2020_033.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/539ae2b2-ca30-1641-d999-10b9f5c87a09.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F539ae2b2-ca30-1641-d999-10b9f5c87a09.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=da8eff7c4894d815cdd5e3a43dfa4a9c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSSH認証が必要なので、ユーザ名に「ec2-user」、認証方式には最初の方に作成したキーペアの秘密鍵「Qiira2020TestServer.ppk」を指定します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/95e3bcbb1727e846c6f462ece5ce3f082939bd21/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f63336663623432302d363332662d303335342d353037392d6339646365653132383965332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc3fcb420-632f-0354-5079-c9dcee1289e3.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7bbbb32d051c3017f69e37c81c3b5df0\" alt=\"qiita2020_034.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/c3fcb420-632f-0354-5079-c9dcee1289e3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fc3fcb420-632f-0354-5079-c9dcee1289e3.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=51387f1792635650d6b365f2dcf89ed1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e問題なくSSH接続できたら以下の様に表示されます。ここからはいつものターミナルです。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/3731778a0702e5a52c78368a1980bae2036481af/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36306432323365332d306632362d343363382d623338662d3934363935643530616634662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F60d223e3-0f26-43c8-b38f-94695d50af4f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=fb1e567a6baf32ab4d783fc3025b5d13\" alt=\"qiita2020_035.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/60d223e3-0f26-43c8-b38f-94695d50af4f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F60d223e3-0f26-43c8-b38f-94695d50af4f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=54a5af8f5c715fb645247682096a98e2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-netcore31をインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-netcore31%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e③ .NetCore3.1をインストール\u003c/h2\u003e\n\n\u003cp\u003e必要なパッケージをインストールします。今回は.NetCoreを動かすためのランタイム「.NetCoreRuntime」をインストールすればOKです。\u003c/p\u003e\n\n\u003cp\u003eまずはパッケージ更新\u003cbr\u003e\n\u003ccode\u003e$ sudo yum update\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eMicrosoftパッケージリポジトリを追加。\u003cbr\u003e\n\u003ccode\u003e$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e.NetCore3.1SDKインストール\u003cbr\u003e\n\u003ccode\u003e$ sudo yum install dotnet-sdk-3.1\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e.NetCore3.1ランタイムインストール\u003cbr\u003e\n\u003ccode\u003e$ sudo yum install dotnet-runtime-3.1\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eこれでEC2上で.NetCore3.1プロジェクトが実行できるようになりました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-サーバープロジェクトを配置実行\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E9%85%8D%E7%BD%AE%E5%AE%9F%E8%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e④ サーバープロジェクトを配置、実行\u003c/h2\u003e\n\n\u003cp\u003eサーバープロジェクトを配置します。配置方法は何でもいいですが個人的にはgitを使うのが一番楽です(余力のある方はGithubActions等を使ったCI/CDをお勧めします。)。サーバープロジェクトをgithubでリモート管理し、git cloneでそのまま配置します。こうすると何が良いかというと、サーバープロジェクトの更新が入った時にgit pullするだけで更新できます。\u003cbr\u003e\nただ今回はプロジェクトをgithubに配置しないので、おとなしくsftpで配置します。sftpの解説はしません。各自良い感じにサーバープロジェクトを根こそぎ持ってきてください。\u003c/p\u003e\n\n\u003cp\u003e配置場所は\u003ccode\u003eec2-user\u003c/code\u003eフォルダ内に「Qiita2020TestServer」を作ります。\u003cbr\u003e\n\u003ccode\u003e$ mkdir Qiita2020TestServer\u003c/code\u003e\u003cbr\u003e\nこの中にプロジェクトを配置します。\u003c/p\u003e\n\n\u003cp\u003e配置したら、Qiita2020TestServer.csprojがあるフォルダまで移動します。\u003cbr\u003e\n.Netはcsprojをそのまま\u003ccode\u003edotnet run\u003c/code\u003eで実行することが出来るので、実行してみます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e$ dotnet run\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eこれで以下の様にEC2上でサーバーが立ち上がりました。\u003cbr\u003e\n直に立ち上げるとSSHを終了した段階でサーバープログラムが止まってしまうので\u003ccode\u003escreen\u003c/code\u003eを使うと色々捗ります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/e6ab468946b62e5f6b6f125c8ec60d85054183b1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f39373133636132642d396331322d333531632d343536642d6132306666666236313038302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F9713ca2d-9c12-351c-456d-a20fffb61080.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=cad99ef57c55c086a1676e1fd9ce64c5\" alt=\"qiita2020_036.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/9713ca2d-9c12-351c-456d-a20fffb61080.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F9713ca2d-9c12-351c-456d-a20fffb61080.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c0e3e76e0323742e2c34cce6e3de11d2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e最後にクライアントからEC2上にアクセスできるか確認します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-クライアント動作確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e⑤ クライアント動作確認\u003c/h2\u003e\n\n\u003cp\u003eクライアントのapplicationHostが\u003ccode\u003elocalhost\u003c/code\u003eのままなので、NetworkManagerのこの部分をEC2インスタンスのパブリックIPに置き換えてください。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/0cc946f4b297ed43e65cc63a51b6ea83f1dea1f4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f36373837616337302d323035302d663465392d626433392d6462646564313934653833632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6787ac70-2050-f4e9-bd39-dbded194e83c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7c8d517166926cce5e1b9ec68b7bc592\" alt=\"qiita2020_037.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/6787ac70-2050-f4e9-bd39-dbded194e83c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F6787ac70-2050-f4e9-bd39-dbded194e83c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=74ac4a5bdb2e722bb0cb79fe7c67b157 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e置き換えて、クライアントをデバッグ実行します。そして、以下の表示が出たらEC2との接続に成功です！\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/e85cb3d71c751c88c56748cc20d127e8f535847f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333539352f38313061373337372d663136652d613235342d643764622d3831313336306663613364382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F810a7377-f16e-a254-d7db-811360fca3d8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e469cca1d87f319d035cdc9ad305af49\" alt=\"qiita2020_007.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/810a7377-f16e-a254-d7db-811360fca3d8.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2F810a7377-f16e-a254-d7db-811360fca3d8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=535d627ab41ca8cdb8a0aba595265683 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれで、C#のみで作ったソシャゲの最低限の基盤ができました。\u003cbr\u003e\nここからマスターデータやアセバン管理、クエスト処理やガチャ処理等を生やしていけば、C#のみで作るソシャゲの出来上がりです。お疲れまでした。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h1\u003e\n\n\u003cp\u003eいかがでしょうか、意外と簡単にソシャゲの最低限の基盤を作ることができたのではないかと思います。もちろん本物はこれだけじゃ済まないボリュームですが、基礎を捉えるのは大きな前進になるのではないかと思います。\u003c/p\u003e\n\n\u003cp\u003e今回は省きまくりましたが、\u003cstrong\u003eセキュリティだけはしっかり設定してください\u003c/strong\u003e。ソシャゲはユーザの大事な情報を管理するので、ガバガバ設定では当然許されません。最低でも、ユーザーデータの暗号化、SSL、サーバー監視はしっかりするように！\u003c/p\u003e\n\n\u003cp\u003e皆様はもちろんC#信者だと思うので、その熱意をUnityだけではなくそのままサーバーサイドにも向けてみてはいかがでしょうか。私もまだまだサーバーサイドは勉強中なので偉そうなことは言えませんが、クライアントサイドとはまた別の面白さがあるので、やりがいはいっぱいあるかと思います。\u003c/p\u003e\n\n\u003cp\u003e頑張れば、一人でもソシャゲが作れる時代です。\u003c/p\u003e\n\n\u003cp\u003e最後まで読んでいただき、ありがとうございました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考資料\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考資料\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/core/install/linux-centos\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCentOS に .NET Core SDK または .NET Core ランタイムをインストールする\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.slideshare.net/torisoup/magiconion-174973732\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMagicOnion入門\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/_y_minami/items/c7899fdf1db505c06ba2\" id=\"reference-765e5ead9629bb6e19bc\"\u003eUnity+.NET Core+MagicOnionの環境構築ハンズオン\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/Cysharp/MagicOnion\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMagicOnion - github\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/neuecc/MessagePack-CSharp\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMessagePack-CSharp - github\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2020-06-28T23:10:08Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"3EFjNsULkiuJHlqOjhqlIiePpOypJ5YyjA==--pyd3atwypGRGwH5Z--8mo+gFvPZBgn6c3lvRgtfw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-06-30T00:05:23Z","likesCount":327,"linkUrl":"https://qiita.com/yoship1639/items/c54f6942d847f8374377","organization":null,"originalId":1254470,"stockedCount":342,"title":"C#のみを使って、今ソーシャルゲームアプリを作るとしたら","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%82%B7%E3%83%A3%E3%82%B2%E3%81%AE%E6%A6%82%E8%A6%81\"\u003eソシャゲの概要\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A7%8B%E6%88%90%E3%81%AE%E5%85%A8%E4%BD%93%E5%83%8F\"\u003e構成の全体像\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%82%B5%E3%82%A4%E3%83%89\"\u003eクライアントサイド\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#-magiconion-messagepack-grpc-%E3%82%92unity%E3%81%AB%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%99%E3%82%8B\"\u003e① MagicOnion, MessagePack, grpc をUnityにインポートする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-service%E3%82%92%E5%AE%9A%E7%BE%A9\"\u003e② Serviceを定義\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-networkmanager%E3%82%92%E5%AE%9F%E8%A3%85\"\u003e③ NetworkManagerを実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%AE%9F%E8%A3%85\"\u003e④ ログインテストコードを実装\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%82%B5%E3%82%A4%E3%83%89\"\u003eサーバーサイド\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E6%BA%96%E5%82%99magiconion%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e① プロジェクトの準備、MagicOnionのインストール\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-main%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E8%A8%98%E8%BF%B0\"\u003e② Mainプログラムの記述\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-accountservice%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e③ AccountServiceの実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E7%92%B0%E5%A2%83%E3%81%A7%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e④ ローカル環境で動作確認\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\"\u003eデプロイ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#-aws%E3%81%A7ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%82%92%E7%94%A8%E6%84%8F%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B\"\u003e① awsでEC2インスタンスを用意、起動する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-%E3%82%BF%E3%83%BC%E3%83%9F%E3%83%8A%E3%83%AB%E3%81%A7ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AB%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3\"\u003e② ターミナルでEC2インスタンスにログイン\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-netcore31%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e③ .NetCore3.1をインストール\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E9%85%8D%E7%BD%AE%E5%AE%9F%E8%A1%8C\"\u003e④ サーバープロジェクトを配置、実行\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e⑤ クライアント動作確認\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"\u003e参考資料\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":23146,"uuid":"c54f6942d847f8374377","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"R7ponH6U/PQv13VJHbjMKwTBU5gC--ACdhuvCxfuWIWiL4--NMiebAcyc2wGRNOepeOV0Q==","originalId":113595,"description":"ゲームエンジニア。C#er。バックエンドも触る。ゲーム、ゲームエンジン、仮想通貨等を自作していました。フロントエンドから物理ベースシェーダまで幅広く対応可能。理解しやすく正しい記事を記述することを心がけます。","facebookUrl":null,"githubUrl":"https://github.com/yoship1639","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"Yoshihiro Ito","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113595/profile-images/1594732889","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fprofile-images%2F1594732889?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=a965ad82da9feffcce9cef12a92425a3","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113595%2Fprofile-images%2F1594732889?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=716c2b13f79841ad7658dcce03a19ac2","urlName":"yoship1639","websiteUrl":"https://twitter.com/yoship1639","twitterUrl":"https://twitter.com/yoship1639","twitterUrlName":"yoship1639","revealedOrganizations":{"edges":[{"node":{"encryptedId":"vQzv/RImXQg59jHtNNuGc0OLEA5bLmBQLXA=--XoqGPg/a4be02aNC--dFceYF1nuO6EBvjM2vHfaQ==","isBetaReleaseEnabled":false,"isFollowableByViewer":false,"isFollowedByViewer":false,"name":"Unityゲーム開発者ギルド","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/f7eb993765ddcdb2c5e6890556c43ea3de8fbfb7/original.jpg?1570215690","urlName":"unity-game-dev-guild","description":"趣味・仕事問わずUnityでゲームを作っている開発者のみで構成されるオンラインコミュニティです。Unityでゲームを開発・運用するにあたって必要なあらゆる知見を共有することを目的とします。","url":"https://unity-game-dev-guild.github.io/"}}]}},"tags":[{"name":"AWS","urlName":"aws"},{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"MagicOnion","urlName":"magiconion"},{"name":"Qiita夏祭り2020_パソナテック","urlName":"qiita%e5%a4%8f%e7%a5%ad%e3%82%8a2020_%e3%83%91%e3%82%bd%e3%83%8a%e3%83%86%e3%83%83%e3%82%af"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
