More than 1 year has passed since last update.皆様は、Windowsでスクリーンショット（以下、スクショ）を撮るときに何を使いますか？
デフォルトで入ってる機能として、主に以下のものがあります。Print Screen
すべてのディスプレイに対して、一枚の画像としてスクショします。
ペイントなどに貼り付けて保存する必要があります。Alt + Print Screen
アクティブなウィンドウに対してスクショします。
ペイントなどに貼り付けて保存する必要があります。Win + Print Screen
すべてのディスプレイに対して、一枚の画像としてスクショします。
自動で保存され、デフォルトでは「C:\Users\Username\Pictures\Screenshots」に保存されます。Win + Alt + Print Screen
アクティブなウィンドウに対してスクショします。
自動で保存され、デフォルトでは「C:\Users\Username\Videos\Captures」に保存されます。使い勝手のいいのは、下2つでしょうか。
しかし、キーが押しづらく、使い勝手もいまいちだったので、自分で同様以上のことができるアプリ作ろうと思いました。最後に配布URLを貼っています。気になった方は是非使ってみてください。まず、キモとなる技術的な裏付けとして、フォーム外のキー入力を感知できるかを調べました。
できることが分かったので、作れる確信を持ちました。メインの仕様として、作る前に以下を決めました。サブの仕様として、作りながら以下を決めました。
アイコンは、こちらのフリー素材を使用しました。
タスクトレイの表示
メニューとツールチップ
デフォルトでは、Pauseキーでスクショができます。
(P)は、PrimaryDisplayです。
設定画面アプリは、C#(.Net)で Windows Form Application として作成しました。
以下、機能を実装するのに調べたことをまとめます。フォーム外のキーイベントを監視することを、キーロガーというそうです。
メインフォームに、Timerコントロールを追加して監視します。参考：https://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q12189853917NotifyIconコントロールを追加します。メニューはこのNotifyIconに付属させます。
以下は、メニューのExitを押したときのイベントです。
アプリを終了する前に、notifyIcon1.Dispose()をすることで、タスクトレイ上にアイコンが残らないようにします。以下は、ウィンドウの影を含めないで、キャプチャする方法です。
※アクティブウィンドウは、立体感を出すためかウィンドウ周りに影が入っていて、通常はそれを含めてキャプチャしてしまいます。参考：https://teratail.com/questions/103093あとは、設定の読み込み処理や保存処理などをちょこちょこ書けば終わりです。アクティブウィンドウを取得する場合、対象がブラウザだとうまく取得できません。
以下に、（推測みたいですが）理由がありました。
Unity×Windowsの画面キャプチャで四苦八苦してる話(1)user32.dllを使用している場合、うまく取得できないウィンドウがあるみたいですね...以下で配布しています。（配布は、予告なく終了する可能性があります）
zipを解凍したら、フォルダごとどこかに置いて、ScreenShotApp.exeを起動してください。


