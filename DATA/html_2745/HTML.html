<!DOCTYPE html><html><head><meta charset="utf-8" /><title>.NET Core 3.0でサポートされるWindowsデスクトップアプリケーションを追う - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/yaegaki/items/592bbaefdc87abc40dca" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="A6IeJAe2YVxUCTtLskr9rVRn8jOLsYB9ih1L1HbFg/YM/Hd65HD+iCtLoPgMFjCU01EjUxlhIoyA6p10DyMJ5Q==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@yayaegaki" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content=".NET Core 3.0でサポートされるWindowsデスクトップアプリケーションを追う - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1MazVGVkNCRGIzSmxJRE11TU9PQnAtT0N0ZU9EbmVPRHZPT0RpT09CbGVPQ2pPT0NpMWRwYm1SdmQzUGpnNGZqZ3JuamdxX2pnNGpqZzRQamc1ZmpncUxqZzVmamc2cmpnckhqZzd6amdyZmpnNmZqZzdQamdwTG92NzNqZ1lZJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTI2ZTc5ZmIyM2ZhYjRlMWU1Mjc3NmM2OTJlNjkzZjg0&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGxoWldkaGEyayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTUyOTQ2ZmI3ODFhMWEzYWNlMDMwNWJhOWMyZmQ4Nzdl&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=916dff44d9470bdebbf45ead5a66f64b"><meta property="og:description" content="

はじめに

.NET Core 3.0が9月23日にリリースされ、様々な新機能が追加されています。
この中でも個人的に気になったのがWindowsデスクトップアプリケーションのサポートです。
今回はこれについて詳しく調べてみました..."><meta content="https://qiita.com/yaegaki/items/592bbaefdc87abc40dca" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,.NET,.NETCore" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-b7497611-21b3-4c87-a198-03b2fa2f512f"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fyaegaki%2Fitems%2F592bbaefdc87abc40dca">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fyaegaki%2Fitems%2F592bbaefdc87abc40dca">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-b7497611-21b3-4c87-a198-03b2fa2f512f">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-09-24T22:49:39.000+09:00","dateModified":"2019-09-24T22:49:39.000+09:00","headline":".NET Core 3.0でサポートされるWindowsデスクトップアプリケーションを追う","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1MazVGVkNCRGIzSmxJRE11TU9PQnAtT0N0ZU9EbmVPRHZPT0RpT09CbGVPQ2pPT0NpMWRwYm1SdmQzUGpnNGZqZ3JuamdxX2pnNGpqZzRQamc1ZmpncUxqZzVmamc2cmpnckhqZzd6amdyZmpnNmZqZzdQamdwTG92NzNqZ1lZJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTI2ZTc5ZmIyM2ZhYjRlMWU1Mjc3NmM2OTJlNjkzZjg0\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGxoWldkaGEyayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTUyOTQ2ZmI3ODFhMWEzYWNlMDMwNWJhOWMyZmQ4Nzdl\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=916dff44d9470bdebbf45ead5a66f64b","mainEntityOfPage":"https://qiita.com/yaegaki/items/592bbaefdc87abc40dca","author":{"@type":"Person","address":"Kanagawa","email":null,"identifier":"yaegaki","name":"yaegaki","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F42193%2Fprofile-images%2F1473689068?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=f8b35d8bb7020c495cc470f37fe29ee8","url":"https://qiita.com/yaegaki","description":"アセンブリからWebまで広くやっています。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yaegaki","type":"items","id":"592bbaefdc87abc40dca"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yaegaki","type":"items","id":"592bbaefdc87abc40dca"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yaegaki","type":"items","id":"592bbaefdc87abc40dca"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/yaegaki/items/592bbaefdc87abc40dca","location":"/yaegaki/items/592bbaefdc87abc40dca","scheme":"https","host":"qiita.com","port":null,"pathname":"/yaegaki/items/592bbaefdc87abc40dca","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"gPNsyQdUkxXxJ8X7aGNd5MaaipVM9Zr1kIoLMpdw4iKPrQWX5JIMwY5lXkjWP5DdQaxb9d4lOASafd2S7pZoMQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-3337cb39-3820-41d1-9c32-d94dd10296f0"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yaegaki/items/592bbaefdc87abc40dca/likers" class="css-1iupg5d">7</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">7</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/592bbaefdc87abc40dca/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yaegaki/items/592bbaefdc87abc40dca/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yaegaki/items/592bbaefdc87abc40dca/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yaegaki/items/592bbaefdc87abc40dca/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yaegaki/items/592bbaefdc87abc40dca.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/yaegaki"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/42193/profile-images/1473689068" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/yaegaki" class="css-10ougpm">@<!-- -->yaegaki</a><div class="css-1ay9vb9"><time dateTime="2019-09-24T13:49:39Z" class="css-m19uds">posted at 2019-09-24</time></div></div></div></div></div><h1 class="css-cgzq40">.NET Core 3.0でサポートされるWindowsデスクトップアプリケーションを追う</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/.net" class="css-4czcte">.NET</a><a href="/tags/.netcore" class="css-4czcte">.NETCore</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h2>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h2>

<p>.NET Core 3.0が9月23日にリリースされ、様々な新機能が追加されています。<br>
この中でも個人的に気になったのが<strong>Windowsデスクトップアプリケーション</strong>のサポートです。<br>
今回はこれについて詳しく調べてみました。<br>
.NET Core 3.0の新機能については以下のページが参考になります。</p>

<p><a href="https://docs.microsoft.com/ja-jp/dotnet/core/whats-new/dotnet-core-3-0" rel="nofollow noopener" target="_blank">.NET Core 3.0 (プレビュー 9) の新機能</a><br>
<a href="https://forest.watch.impress.co.jp/docs/news/1208888.html" rel="nofollow noopener" target="_blank">Microsoft、「.NET Core 3.0」を正式リリース ～オープンソース化されたWPF/WinForms開発をサポート - 窓の杜</a></p>

<h2>
<span id="windowsデスクトップアプリケーションの作成" class="fragment"></span><a href="#windows%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>Windowsデスクトップアプリケーションの作成</h2>

<p>Windowsデスクトップアプリケーションの作成は以下のコマンドで作成することができます。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code><span class="c"># WinForms</span>
<span class="nv">$ </span>dotnet new winforms
<span class="c"># Wpf</span>
<span class="nv">$ </span>dotnet new wpf
</code></pre></div></div>

<p>作成できるプロジェクトは<code>dotnet new</code>で確認することができます。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code><span class="nv">$ </span>dotnet new
使用法: new <span class="o">[</span>options]

<span class="c">## 省略</span>

Templates                                         Short Name               Language          Tags
<span class="nt">----------------------------------------------------------------------------------------------------------------------------------</span>
Console Application                               console                  <span class="o">[</span>C#], F#, VB      Common/Console
Class library                                     classlib                 <span class="o">[</span>C#], F#, VB      Common/Library
WPF Application                                   wpf                      <span class="o">[</span>C#]              Common/WPF
WPF Class library                                 wpflib                   <span class="o">[</span>C#]              Common/WPF
WPF Custom Control Library                        wpfcustomcontrollib      <span class="o">[</span>C#]              Common/WPF
WPF User Control Library                          wpfusercontrollib        <span class="o">[</span>C#]              Common/WPF
Windows Forms <span class="o">(</span>WinForms<span class="o">)</span> Application              winforms                 <span class="o">[</span>C#]              Common/WinForms
Windows Forms <span class="o">(</span>WinForms<span class="o">)</span> Class library            winformslib              <span class="o">[</span>C#]              Common/WinForms
Worker Service                                    worker                   <span class="o">[</span>C#]              Common/Worker/Web

<span class="c">## 省略</span>
</code></pre></div></div>

<p>試しに<strong>wpfプロジェクト</strong>を作成してみます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>## wpfプロジェクト作成
C:\Users\xxx\Documents\dotnet-wpf-test&gt;dotnet new wpf
The template "WPF Application" was created successfully.

Processing post-creation actions...
Running 'dotnet restore' on C:\Users\xxx\Documents\dotnet-wpf-test\dotnet-wpf-test.csproj...
  C:\Users\xxx\Documents\dotnet-wpf-test\dotnet-wpf-test.csproj の復元が 49.81 ms で完了しました。

Restore succeeded.

# ファイル確認
C:\Users\xxx\Documents\dotnet-wpf-test&gt;dir
 ドライブ C のボリューム ラベルがありません。
 ボリューム シリアル番号は 7036-8880 です

 C:\Users\xxx\Documents\dotnet-wpf-test のディレクトリ

2019/09/24  21:21    &lt;DIR&gt;          .
2019/09/24  21:21    &lt;DIR&gt;          ..
2019/09/24  21:21               384 App.xaml
2019/09/24  21:21               348 App.xaml.cs
2019/09/24  21:21               276 dotnet-wpf-test.csproj
2019/09/24  21:21               509 MainWindow.xaml
2019/09/24  21:21               667 MainWindow.xaml.cs
2019/09/24  21:21    &lt;DIR&gt;          obj
               5 個のファイル               2,184 バイト
               3 個のディレクトリ  22,242,934,784 バイトの空き領域
</code></pre></div></div>

<p>通常の.NET Frameworkで<strong>wpfプロジェクト</strong>を作成したときとほぼ同じ内容のファイルが作成されています。<br>
このプロジェクトは通常の.NET Coreのプロジェクトと同様に<code>dotnet run</code>コマンドで実行できます。<br>
実行すると何もないウィンドウが表示されます。</p>

<p><a href="https://camo.qiitausercontent.com/895cac9393d248afe2abdf207e169c752bf2ff8a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34323139332f38326636323231332d323835332d373638372d313837632d3765643938306639303663642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F42193%2F82f62213-2853-7687-187c-7ed980f906cd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7d66102cead2a81916b0e3ffecc4c264" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/42193/82f62213-2853-7687-187c-7ed980f906cd.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F42193%2F82f62213-2853-7687-187c-7ed980f906cd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c10eb7c22127f1b6769ba587db3b6081 1x" loading="lazy"></a></p>

<h2>
<span id="windowsデスクトップアプリケーションと従来のアプリケーションの違い" class="fragment"></span><a href="#windows%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A8%E5%BE%93%E6%9D%A5%E3%81%AE%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E9%81%95%E3%81%84"><i class="fa fa-link"></i></a>Windowsデスクトップアプリケーションと従来のアプリケーションの違い</h2>

<p>Windowsデスクトップアプリケーションがサポートされる前でもWin32APIを使用すればウィンドウを持ったアプリケーションを作成することはできました。<br>
ではWindowsデスクトップアプリケーションとは<strong>winforms</strong>や<strong>wpf</strong>ことを指すのでしょうか。<br>
従来のアプリケーションの決定的な違いは<code>publish</code>したときに現れます。</p>

<p>試しに先ほど作成したプロジェクトを<code>publish</code>してみます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code># publish
C:\Users\xxx\Documents\dotnet-wpf-test&gt;dotnet publish
.NET Core 向け Microsoft (R) Build Engine バージョン 16.3.0+0f4c62fea
Copyright (C) Microsoft Corporation.All rights reserved.

  C:\Users\xxx\Documents\dotnet-wpf-test\dotnet-wpf-test.csproj の復元が 13.77 ms で完了しました。
  dotnet-wpf-test -&gt; C:\Users\xxx\Documents\dotnet-wpf-test\bin\Debug\netcoreapp3.0\dotnet-wpf-test.dll
  dotnet-wpf-test -&gt; C:\Users\xxx\Documents\dotnet-wpf-test\bin\Debug\netcoreapp3.0\publish\

# ファイル確認
C:\Users\xxx\Documents\dotnet-wpf-test&gt;dir bin\Debug\netcoreapp3.0\publish
 ドライブ C のボリューム ラベルがありません。
 ボリューム シリアル番号は 7036-8880 です

 C:\Users\xxx\Documents\dotnet-wpf-test\bin\Debug\netcoreapp3.0\publish のディレクトリ

2019/09/24  21:30    &lt;DIR&gt;          .
2019/09/24  21:30    &lt;DIR&gt;          ..
2019/09/24  21:24               437 dotnet-wpf-test.deps.json
2019/09/24  21:30             7,168 dotnet-wpf-test.dll
2019/09/24  21:30           159,744 dotnet-wpf-test.exe
2019/09/24  21:30             1,644 dotnet-wpf-test.pdb
2019/09/24  21:24               161 dotnet-wpf-test.runtimeconfig.json
               5 個のファイル             169,154 バイト
               2 個のディレクトリ  22,245,412,864 バイトの空き領域
</code></pre></div></div>

<p><code>dotnet-wpf-test.exe</code>をエクスプローラからダブルクリックします。<br>
すると<strong><code>MainWindow</code>のみが表示されます</strong>。<br>
従来のプロジェクトでは必ずコンソールウィンドウが同時に表示されていましたが<strong>Windows Desktopアプリケーションでは表示されません</strong>。<br>
これがWindows Desktopアプリケーションと従来のアプリケーションの違いです。</p>

<h3>
<span id="補足peフォーマットとsubsystem" class="fragment"></span><a href="#%E8%A3%9C%E8%B6%B3pe%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88%E3%81%A8subsystem"><i class="fa fa-link"></i></a>(補足)PEフォーマットと<code>Subsystem</code>
</h3>

<p>Windowsがサポートしている<code>.exe</code>ファイルはPEフォーマットと呼ばれるフォーマットになっています。<br>
PEフォーマットには<code>Subsystem</code>と呼ばれるフィールドがあり、Windowsはこのフィールドを見て<strong>Windowsアプリケーション</strong>か<strong>コンソールアプリケーション</strong>かを判断しています。<br>
<strong>Windowsデスクトップアプリケーション</strong>を<code>publish</code>するとこのフィールドが<strong>Windowsアプリケーション</strong>の値になるためコンソールウィンドウが表示されなくなります。</p>

<p>参考:<a href="http://home.a00.itscom.net/hatada/mcc/doc/pe.html" rel="nofollow noopener" target="_blank">PE(Portable Executable)ファイルフォーマットの概要</a></p>

<h2>
<span id="csproj解読" class="fragment"></span><a href="#csproj%E8%A7%A3%E8%AA%AD"><i class="fa fa-link"></i></a>csproj解読</h2>

<p>作成したプロジェクトの<code>.csproj</code>は以下のようになっています。</p>

<div class="code-frame" data-lang="xml"><div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Project</span> <span class="na">Sdk=</span><span class="s">"Microsoft.NET.Sdk.WindowsDesktop"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;PropertyGroup&gt;</span>
    <span class="nt">&lt;OutputType&gt;</span>WinExe<span class="nt">&lt;/OutputType&gt;</span>
    <span class="nt">&lt;TargetFramework&gt;</span>netcoreapp3.0<span class="nt">&lt;/TargetFramework&gt;</span>
    <span class="nt">&lt;RootNamespace&gt;</span>dotnet_wpf_test<span class="nt">&lt;/RootNamespace&gt;</span>
    <span class="nt">&lt;UseWPF&gt;</span>true<span class="nt">&lt;/UseWPF&gt;</span>
  <span class="nt">&lt;/PropertyGroup&gt;</span>

<span class="nt">&lt;/Project&gt;</span>
</code></pre></div></div>

<p>注目すべきは<strong>OutputTypeがWinExeになっている</strong>こと、<strong>SdkがMicrosoft.NET.Sdk.WindowsDesktop</strong>になっていることでしょうか。<br>
プロジェクトを展開して<strong>WinExe</strong>で調べてみます。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code><span class="nv">$ </span>dotnet build <span class="nt">-pp</span> <span class="o">&gt;</span> project-all.txt
</code></pre></div></div>

<p>いくつか引っ掛かりますが興味深いのは以下の場所です。</p>

<div class="code-frame" data-lang="xml"><div class="highlight"><pre class="with-code"><code>  <span class="c">&lt;!--
    ============================================================
                                        _CreateAppHost
    If we found a restored apphost, create the modified destination apphost
    with options from the project.
    ============================================================
     --&gt;</span>
  <span class="nt">&lt;UsingTask</span> <span class="na">TaskName=</span><span class="s">"CreateAppHost"</span> <span class="na">AssemblyFile=</span><span class="s">"$(MicrosoftNETBuildTasksAssembly)"</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/developer/msbuild/2003"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Target</span> <span class="na">Name=</span><span class="s">"_CreateAppHost"</span> <span class="na">Inputs=</span><span class="s">"@(IntermediateAssembly);$(AppHostSourcePath)"</span> <span class="na">Outputs=</span><span class="s">"$(AppHostIntermediatePath)"</span> <span class="na">DependsOnTargets=</span><span class="s">"_GetAppHostPaths;CoreCompile"</span> <span class="na">Condition=</span><span class="s">"'$(ComputeNETCoreBuildOutputFiles)' == 'true' and&amp;#xD;&amp;#xA;                     '$(AppHostSourcePath)' != '' and&amp;#xD;&amp;#xA;                     Exists('@(IntermediateAssembly)') and&amp;#xD;&amp;#xA;                     Exists('$(AppHostSourcePath)')"</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/developer/msbuild/2003"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;PropertyGroup&gt;</span>
      <span class="c">&lt;!-- ★注目ポイント --&gt;</span>
      <span class="nt">&lt;_UseWindowsGraphicalUserInterface</span> <span class="na">Condition=</span><span class="s">"($(RuntimeIdentifier.StartsWith('win')) or $(DefaultAppHostRuntimeIdentifier.StartsWith('win'))) and '$(OutputType)'=='WinExe'"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/_UseWindowsGraphicalUserInterface&gt;</span>
    <span class="nt">&lt;/PropertyGroup&gt;</span>
    <span class="nt">&lt;CreateAppHost</span> <span class="na">AppHostSourcePath=</span><span class="s">"$(AppHostSourcePath)"</span> <span class="na">AppHostDestinationPath=</span><span class="s">"$(AppHostIntermediatePath)"</span> <span class="na">AppBinaryName=</span><span class="s">"$(AssemblyName)$(TargetExt)"</span> <span class="na">IntermediateAssembly=</span><span class="s">"@(IntermediateAssembly-&gt;'%(FullPath)')"</span> <span class="na">WindowsGraphicalUserInterface=</span><span class="s">"$(_UseWindowsGraphicalUserInterface)"</span> <span class="na">Retries=</span><span class="s">"$(CopyRetryCount)"</span> <span class="na">RetryDelayMilliseconds=</span><span class="s">"$(CopyRetryDelayMilliseconds)"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/Target&gt;</span>
</code></pre></div></div>

<p>OutputTypeがWinExeのとき、<strong>CreateAppHostタスクのWindowsGraphicalUserInterfaceがtrueになる</strong>ことがわかります。</p>

<p>CreateAppHostのソースは以下にあります。</p>

<p><qiita-embed-ogp src="https://github.com/dotnet/sdk/blob/master/src/Tasks/Microsoft.NET.Build.Tasks/CreateAppHost.cs"></qiita-embed-ogp></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// CreateAppHost.csより引用</span>

<span class="n">HostWriter</span><span class="p">.</span><span class="nf">CreateAppHost</span><span class="p">(</span><span class="n">appHostSourceFilePath</span><span class="p">:</span> <span class="n">AppHostSourcePath</span><span class="p">,</span>
                        <span class="n">appHostDestinationFilePath</span><span class="p">:</span> <span class="n">AppHostDestinationPath</span><span class="p">,</span>
                        <span class="n">appBinaryFilePath</span><span class="p">:</span> <span class="n">AppBinaryName</span><span class="p">,</span>
                        <span class="n">windowsGraphicalUserInterface</span><span class="p">:</span> <span class="n">isGUI</span><span class="p">,</span>
                        <span class="n">assemblyToCopyResorcesFrom</span><span class="p">:</span> <span class="n">resourcesAssembly</span><span class="p">);</span>
</code></pre></div></div>

<p>HostWriterのCreateAppHost関数に<code>isGUI (WindowsGraphicalUserInterface)</code>を渡しています。</p>

<p>HostWriterのソースは以下にあります</p>

<p><qiita-embed-ogp src="https://github.com/dotnet/core-setup/blob/master/src/managed/Microsoft.NET.HostModel/AppHost/HostWriter.cs"></qiita-embed-ogp></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// HostWriter.csより引用</span>

<span class="c1">// Re-write the destination apphost with the proper contents.</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">memoryMappedFile</span> <span class="p">=</span> <span class="n">MemoryMappedFile</span><span class="p">.</span><span class="nf">CreateFromFile</span><span class="p">(</span><span class="n">appHostDestinationFilePath</span><span class="p">))</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="p">(</span><span class="n">MemoryMappedViewAccessor</span> <span class="n">accessor</span> <span class="p">=</span> <span class="n">memoryMappedFile</span><span class="p">.</span><span class="nf">CreateViewAccessor</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">BinaryUtils</span><span class="p">.</span><span class="nf">SearchAndReplace</span><span class="p">(</span><span class="n">accessor</span><span class="p">,</span> <span class="n">AppBinaryPathPlaceholderSearchValue</span><span class="p">,</span> <span class="n">bytesToWrite</span><span class="p">);</span>

        <span class="n">appHostIsPEImage</span> <span class="p">=</span> <span class="n">BinaryUtils</span><span class="p">.</span><span class="nf">IsPEImage</span><span class="p">(</span><span class="n">accessor</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">windowsGraphicalUserInterface</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">appHostIsPEImage</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">AppHostNotPEFileException</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="n">BinaryUtils</span><span class="p">.</span><span class="nf">SetWindowsGraphicalUserInterfaceBit</span><span class="p">(</span><span class="n">accessor</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>BinaryUtils.SetWindowsGraphicalUserInterfaceBitがそれっぽい処理みたいです。</p>

<p><qiita-embed-ogp src="https://github.com/dotnet/core-setup/blob/master/src/managed/Microsoft.NET.HostModel/AppHost/BinaryUtils.cs"></qiita-embed-ogp></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// BinaryUtils.csより引用 (★部分は追記部分)</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// The value of the sybsystem field which indicates Windows GUI (Graphical UI)</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">private</span> <span class="k">const</span> <span class="n">UInt16</span> <span class="n">WindowsGUISubsystem</span> <span class="p">=</span> <span class="m">0x2</span><span class="p">;</span>


<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// This method will attempt to set the subsystem to GUI. The apphost file should be a windows PE file.</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="accessor"&gt;The memory accessor which has the apphost file opened.&lt;/param&gt;</span>
<span class="k">internal</span> <span class="k">static</span> <span class="k">unsafe</span> <span class="k">void</span> <span class="nf">SetWindowsGraphicalUserInterfaceBit</span><span class="p">(</span><span class="n">MemoryMappedViewAccessor</span> <span class="n">accessor</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">byte</span><span class="p">*</span> <span class="n">pointer</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">try</span>
    <span class="p">{</span>
        <span class="n">accessor</span><span class="p">.</span><span class="n">SafeMemoryMappedViewHandle</span><span class="p">.</span><span class="nf">AcquirePointer</span><span class="p">(</span><span class="k">ref</span> <span class="n">pointer</span><span class="p">);</span>
        <span class="kt">byte</span><span class="p">*</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">pointer</span> <span class="p">+</span> <span class="n">accessor</span><span class="p">.</span><span class="n">PointerOffset</span><span class="p">;</span>

        <span class="c1">// https://en.wikipedia.org/wiki/Portable_Executable</span>
        <span class="n">UInt32</span> <span class="n">peHeaderOffset</span> <span class="p">=</span> <span class="p">((</span><span class="n">UInt32</span><span class="p">*)(</span><span class="n">bytes</span> <span class="p">+</span> <span class="n">PEHeaderPointerOffset</span><span class="p">))[</span><span class="m">0</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">accessor</span><span class="p">.</span><span class="n">Capacity</span> <span class="p">&lt;</span> <span class="n">peHeaderOffset</span> <span class="p">+</span> <span class="n">SubsystemOffset</span> <span class="p">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">UInt16</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">AppHostNotPEFileException</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="n">UInt16</span><span class="p">*</span> <span class="n">subsystem</span> <span class="p">=</span> <span class="p">((</span><span class="n">UInt16</span><span class="p">*)(</span><span class="n">bytes</span> <span class="p">+</span> <span class="n">peHeaderOffset</span> <span class="p">+</span> <span class="n">SubsystemOffset</span><span class="p">));</span>

        <span class="c1">// https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#windows-subsystem</span>
        <span class="c1">// The subsystem of the prebuilt apphost should be set to CUI</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">subsystem</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">!=</span> <span class="n">WindowsCUISubsystem</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">AppHostNotCUIException</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">// ★WindowsGUISubsystem(2)の書き込み</span>
        <span class="c1">// Set the subsystem to GUI</span>
        <span class="n">subsystem</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="n">WindowsGUISubsystem</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">finally</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pointer</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">accessor</span><span class="p">.</span><span class="n">SafeMemoryMappedViewHandle</span><span class="p">.</span><span class="nf">ReleasePointer</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>これでようやく<strong>OutputType</strong>を<strong>WinExe</strong>にすると<strong>Windowsアプリケーションとして作成される</strong>ことがわかりました。</p>

<h2>
<span id="最後に" class="fragment"></span><a href="#%E6%9C%80%E5%BE%8C%E3%81%AB"><i class="fa fa-link"></i></a>最後に</h2>

<p>今回の記事はほぼ何の役にもたたないことばかり書いてますが.NET Coreでデスクトップアプリケーションが作成できるようになったというのは感動的です。<br>
他にもC#8.0が使えたり.NET Standard 2.1がサポートされていたりするので<strong>.NET Core3.0をぜひ試してみましょう</strong>😊</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fyaegaki%2Fitems%2F592bbaefdc87abc40dca&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fyaegaki%2Fitems%2F592bbaefdc87abc40dca&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yaegaki/items/592bbaefdc87abc40dca/likers" class="css-1iupg5d">7</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">7</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/592bbaefdc87abc40dca/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yaegaki/items/592bbaefdc87abc40dca/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yaegaki/items/592bbaefdc87abc40dca/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yaegaki/items/592bbaefdc87abc40dca/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yaegaki/items/592bbaefdc87abc40dca.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-3337cb39-3820-41d1-9c32-d94dd10296f0">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-1e858a01-3e1b-4f2d-af60-6ef06f020603"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-1e858a01-3e1b-4f2d-af60-6ef06f020603">{}</script>
      
<div id="LoginModal-react-component-778fb501-abae-4550-959d-57173d2ad8d9"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-778fb501-abae-4550-959d-57173d2ad8d9">{}</script>
      
<div id="StockModal-react-component-c28992ad-cc05-4bb8-b3b4-06399f1ff570"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-c28992ad-cc05-4bb8-b3b4-06399f1ff570">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;42q4PCQafDEumZmTG8RqqgzpBb5eo/HNcJicBThDftHsNNFix9zj5VHbAiClmKeTi9/U3sxzUzx6b0qlQaX0wg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch2\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h2\u003e\n\n\u003cp\u003e.NET Core 3.0が9月23日にリリースされ、様々な新機能が追加されています。\u003cbr\u003e\nこの中でも個人的に気になったのが\u003cstrong\u003eWindowsデスクトップアプリケーション\u003c/strong\u003eのサポートです。\u003cbr\u003e\n今回はこれについて詳しく調べてみました。\u003cbr\u003e\n.NET Core 3.0の新機能については以下のページが参考になります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/core/whats-new/dotnet-core-3-0\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NET Core 3.0 (プレビュー 9) の新機能\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://forest.watch.impress.co.jp/docs/news/1208888.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMicrosoft、「.NET Core 3.0」を正式リリース ～オープンソース化されたWPF/WinForms開発をサポート - 窓の杜\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"windowsデスクトップアプリケーションの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#windows%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWindowsデスクトップアプリケーションの作成\u003c/h2\u003e\n\n\u003cp\u003eWindowsデスクトップアプリケーションの作成は以下のコマンドで作成することができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e# WinForms\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003edotnet new winforms\n\u003cspan class=\"c\"\u003e# Wpf\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003edotnet new wpf\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e作成できるプロジェクトは\u003ccode\u003edotnet new\u003c/code\u003eで確認することができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003edotnet new\n使用法: new \u003cspan class=\"o\"\u003e[\u003c/span\u003eoptions]\n\n\u003cspan class=\"c\"\u003e## 省略\u003c/span\u003e\n\nTemplates                                         Short Name               Language          Tags\n\u003cspan class=\"nt\"\u003e----------------------------------------------------------------------------------------------------------------------------------\u003c/span\u003e\nConsole Application                               console                  \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#], F#, VB      Common/Console\nClass library                                     classlib                 \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#], F#, VB      Common/Library\nWPF Application                                   wpf                      \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#]              Common/WPF\nWPF Class library                                 wpflib                   \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#]              Common/WPF\nWPF Custom Control Library                        wpfcustomcontrollib      \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#]              Common/WPF\nWPF User Control Library                          wpfusercontrollib        \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#]              Common/WPF\nWindows Forms \u003cspan class=\"o\"\u003e(\u003c/span\u003eWinForms\u003cspan class=\"o\"\u003e)\u003c/span\u003e Application              winforms                 \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#]              Common/WinForms\nWindows Forms \u003cspan class=\"o\"\u003e(\u003c/span\u003eWinForms\u003cspan class=\"o\"\u003e)\u003c/span\u003e Class library            winformslib              \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#]              Common/WinForms\nWorker Service                                    worker                   \u003cspan class=\"o\"\u003e[\u003c/span\u003eC#]              Common/Worker/Web\n\n\u003cspan class=\"c\"\u003e## 省略\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e試しに\u003cstrong\u003ewpfプロジェクト\u003c/strong\u003eを作成してみます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e## wpfプロジェクト作成\nC:\\Users\\xxx\\Documents\\dotnet-wpf-test\u0026gt;dotnet new wpf\nThe template \"WPF Application\" was created successfully.\n\nProcessing post-creation actions...\nRunning 'dotnet restore' on C:\\Users\\xxx\\Documents\\dotnet-wpf-test\\dotnet-wpf-test.csproj...\n  C:\\Users\\xxx\\Documents\\dotnet-wpf-test\\dotnet-wpf-test.csproj の復元が 49.81 ms で完了しました。\n\nRestore succeeded.\n\n# ファイル確認\nC:\\Users\\xxx\\Documents\\dotnet-wpf-test\u0026gt;dir\n ドライブ C のボリューム ラベルがありません。\n ボリューム シリアル番号は 7036-8880 です\n\n C:\\Users\\xxx\\Documents\\dotnet-wpf-test のディレクトリ\n\n2019/09/24  21:21    \u0026lt;DIR\u0026gt;          .\n2019/09/24  21:21    \u0026lt;DIR\u0026gt;          ..\n2019/09/24  21:21               384 App.xaml\n2019/09/24  21:21               348 App.xaml.cs\n2019/09/24  21:21               276 dotnet-wpf-test.csproj\n2019/09/24  21:21               509 MainWindow.xaml\n2019/09/24  21:21               667 MainWindow.xaml.cs\n2019/09/24  21:21    \u0026lt;DIR\u0026gt;          obj\n               5 個のファイル               2,184 バイト\n               3 個のディレクトリ  22,242,934,784 バイトの空き領域\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e通常の.NET Frameworkで\u003cstrong\u003ewpfプロジェクト\u003c/strong\u003eを作成したときとほぼ同じ内容のファイルが作成されています。\u003cbr\u003e\nこのプロジェクトは通常の.NET Coreのプロジェクトと同様に\u003ccode\u003edotnet run\u003c/code\u003eコマンドで実行できます。\u003cbr\u003e\n実行すると何もないウィンドウが表示されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/895cac9393d248afe2abdf207e169c752bf2ff8a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34323139332f38326636323231332d323835332d373638372d313837632d3765643938306639303663642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F42193%2F82f62213-2853-7687-187c-7ed980f906cd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7d66102cead2a81916b0e3ffecc4c264\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/42193/82f62213-2853-7687-187c-7ed980f906cd.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F42193%2F82f62213-2853-7687-187c-7ed980f906cd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c10eb7c22127f1b6769ba587db3b6081 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"windowsデスクトップアプリケーションと従来のアプリケーションの違い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#windows%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A8%E5%BE%93%E6%9D%A5%E3%81%AE%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E9%81%95%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWindowsデスクトップアプリケーションと従来のアプリケーションの違い\u003c/h2\u003e\n\n\u003cp\u003eWindowsデスクトップアプリケーションがサポートされる前でもWin32APIを使用すればウィンドウを持ったアプリケーションを作成することはできました。\u003cbr\u003e\nではWindowsデスクトップアプリケーションとは\u003cstrong\u003ewinforms\u003c/strong\u003eや\u003cstrong\u003ewpf\u003c/strong\u003eことを指すのでしょうか。\u003cbr\u003e\n従来のアプリケーションの決定的な違いは\u003ccode\u003epublish\u003c/code\u003eしたときに現れます。\u003c/p\u003e\n\n\u003cp\u003e試しに先ほど作成したプロジェクトを\u003ccode\u003epublish\u003c/code\u003eしてみます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e# publish\nC:\\Users\\xxx\\Documents\\dotnet-wpf-test\u0026gt;dotnet publish\n.NET Core 向け Microsoft (R) Build Engine バージョン 16.3.0+0f4c62fea\nCopyright (C) Microsoft Corporation.All rights reserved.\n\n  C:\\Users\\xxx\\Documents\\dotnet-wpf-test\\dotnet-wpf-test.csproj の復元が 13.77 ms で完了しました。\n  dotnet-wpf-test -\u0026gt; C:\\Users\\xxx\\Documents\\dotnet-wpf-test\\bin\\Debug\\netcoreapp3.0\\dotnet-wpf-test.dll\n  dotnet-wpf-test -\u0026gt; C:\\Users\\xxx\\Documents\\dotnet-wpf-test\\bin\\Debug\\netcoreapp3.0\\publish\\\n\n# ファイル確認\nC:\\Users\\xxx\\Documents\\dotnet-wpf-test\u0026gt;dir bin\\Debug\\netcoreapp3.0\\publish\n ドライブ C のボリューム ラベルがありません。\n ボリューム シリアル番号は 7036-8880 です\n\n C:\\Users\\xxx\\Documents\\dotnet-wpf-test\\bin\\Debug\\netcoreapp3.0\\publish のディレクトリ\n\n2019/09/24  21:30    \u0026lt;DIR\u0026gt;          .\n2019/09/24  21:30    \u0026lt;DIR\u0026gt;          ..\n2019/09/24  21:24               437 dotnet-wpf-test.deps.json\n2019/09/24  21:30             7,168 dotnet-wpf-test.dll\n2019/09/24  21:30           159,744 dotnet-wpf-test.exe\n2019/09/24  21:30             1,644 dotnet-wpf-test.pdb\n2019/09/24  21:24               161 dotnet-wpf-test.runtimeconfig.json\n               5 個のファイル             169,154 バイト\n               2 個のディレクトリ  22,245,412,864 バイトの空き領域\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003edotnet-wpf-test.exe\u003c/code\u003eをエクスプローラからダブルクリックします。\u003cbr\u003e\nすると\u003cstrong\u003e\u003ccode\u003eMainWindow\u003c/code\u003eのみが表示されます\u003c/strong\u003e。\u003cbr\u003e\n従来のプロジェクトでは必ずコンソールウィンドウが同時に表示されていましたが\u003cstrong\u003eWindows Desktopアプリケーションでは表示されません\u003c/strong\u003e。\u003cbr\u003e\nこれがWindows Desktopアプリケーションと従来のアプリケーションの違いです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"補足peフォーマットとsubsystem\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A3%9C%E8%B6%B3pe%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88%E3%81%A8subsystem\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e(補足)PEフォーマットと\u003ccode\u003eSubsystem\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003eWindowsがサポートしている\u003ccode\u003e.exe\u003c/code\u003eファイルはPEフォーマットと呼ばれるフォーマットになっています。\u003cbr\u003e\nPEフォーマットには\u003ccode\u003eSubsystem\u003c/code\u003eと呼ばれるフィールドがあり、Windowsはこのフィールドを見て\u003cstrong\u003eWindowsアプリケーション\u003c/strong\u003eか\u003cstrong\u003eコンソールアプリケーション\u003c/strong\u003eかを判断しています。\u003cbr\u003e\n\u003cstrong\u003eWindowsデスクトップアプリケーション\u003c/strong\u003eを\u003ccode\u003epublish\u003c/code\u003eするとこのフィールドが\u003cstrong\u003eWindowsアプリケーション\u003c/strong\u003eの値になるためコンソールウィンドウが表示されなくなります。\u003c/p\u003e\n\n\u003cp\u003e参考:\u003ca href=\"http://home.a00.itscom.net/hatada/mcc/doc/pe.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePE(Portable Executable)ファイルフォーマットの概要\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"csproj解読\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#csproj%E8%A7%A3%E8%AA%AD\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ecsproj解読\u003c/h2\u003e\n\n\u003cp\u003e作成したプロジェクトの\u003ccode\u003e.csproj\u003c/code\u003eは以下のようになっています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Project\u003c/span\u003e \u003cspan class=\"na\"\u003eSdk=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Microsoft.NET.Sdk.WindowsDesktop\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\n  \u003cspan class=\"nt\"\u003e\u0026lt;PropertyGroup\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;OutputType\u0026gt;\u003c/span\u003eWinExe\u003cspan class=\"nt\"\u003e\u0026lt;/OutputType\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;TargetFramework\u0026gt;\u003c/span\u003enetcoreapp3.0\u003cspan class=\"nt\"\u003e\u0026lt;/TargetFramework\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;RootNamespace\u0026gt;\u003c/span\u003edotnet_wpf_test\u003cspan class=\"nt\"\u003e\u0026lt;/RootNamespace\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;UseWPF\u0026gt;\u003c/span\u003etrue\u003cspan class=\"nt\"\u003e\u0026lt;/UseWPF\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/PropertyGroup\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;/Project\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e注目すべきは\u003cstrong\u003eOutputTypeがWinExeになっている\u003c/strong\u003eこと、\u003cstrong\u003eSdkがMicrosoft.NET.Sdk.WindowsDesktop\u003c/strong\u003eになっていることでしょうか。\u003cbr\u003e\nプロジェクトを展開して\u003cstrong\u003eWinExe\u003c/strong\u003eで調べてみます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003edotnet build \u003cspan class=\"nt\"\u003e-pp\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e project-all.txt\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eいくつか引っ掛かりますが興味深いのは以下の場所です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"c\"\u003e\u0026lt;!--\n    ============================================================\n                                        _CreateAppHost\n    If we found a restored apphost, create the modified destination apphost\n    with options from the project.\n    ============================================================\n     --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;UsingTask\u003c/span\u003e \u003cspan class=\"na\"\u003eTaskName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CreateAppHost\"\u003c/span\u003e \u003cspan class=\"na\"\u003eAssemblyFile=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(MicrosoftNETBuildTasksAssembly)\"\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/developer/msbuild/2003\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;Target\u003c/span\u003e \u003cspan class=\"na\"\u003eName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"_CreateAppHost\"\u003c/span\u003e \u003cspan class=\"na\"\u003eInputs=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"@(IntermediateAssembly);$(AppHostSourcePath)\"\u003c/span\u003e \u003cspan class=\"na\"\u003eOutputs=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(AppHostIntermediatePath)\"\u003c/span\u003e \u003cspan class=\"na\"\u003eDependsOnTargets=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"_GetAppHostPaths;CoreCompile\"\u003c/span\u003e \u003cspan class=\"na\"\u003eCondition=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"'$(ComputeNETCoreBuildOutputFiles)' == 'true' and\u0026amp;#xD;\u0026amp;#xA;                     '$(AppHostSourcePath)' != '' and\u0026amp;#xD;\u0026amp;#xA;                     Exists('@(IntermediateAssembly)') and\u0026amp;#xD;\u0026amp;#xA;                     Exists('$(AppHostSourcePath)')\"\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/developer/msbuild/2003\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;PropertyGroup\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"c\"\u003e\u0026lt;!-- ★注目ポイント --\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;_UseWindowsGraphicalUserInterface\u003c/span\u003e \u003cspan class=\"na\"\u003eCondition=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"($(RuntimeIdentifier.StartsWith('win')) or $(DefaultAppHostRuntimeIdentifier.StartsWith('win'))) and '$(OutputType)'=='WinExe'\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003etrue\u003cspan class=\"nt\"\u003e\u0026lt;/_UseWindowsGraphicalUserInterface\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/PropertyGroup\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;CreateAppHost\u003c/span\u003e \u003cspan class=\"na\"\u003eAppHostSourcePath=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(AppHostSourcePath)\"\u003c/span\u003e \u003cspan class=\"na\"\u003eAppHostDestinationPath=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(AppHostIntermediatePath)\"\u003c/span\u003e \u003cspan class=\"na\"\u003eAppBinaryName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(AssemblyName)$(TargetExt)\"\u003c/span\u003e \u003cspan class=\"na\"\u003eIntermediateAssembly=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"@(IntermediateAssembly-\u0026gt;'%(FullPath)')\"\u003c/span\u003e \u003cspan class=\"na\"\u003eWindowsGraphicalUserInterface=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(_UseWindowsGraphicalUserInterface)\"\u003c/span\u003e \u003cspan class=\"na\"\u003eRetries=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(CopyRetryCount)\"\u003c/span\u003e \u003cspan class=\"na\"\u003eRetryDelayMilliseconds=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"$(CopyRetryDelayMilliseconds)\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/Target\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eOutputTypeがWinExeのとき、\u003cstrong\u003eCreateAppHostタスクのWindowsGraphicalUserInterfaceがtrueになる\u003c/strong\u003eことがわかります。\u003c/p\u003e\n\n\u003cp\u003eCreateAppHostのソースは以下にあります。\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://github.com/dotnet/sdk/blob/master/src/Tasks/Microsoft.NET.Build.Tasks/CreateAppHost.cs\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// CreateAppHost.csより引用\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eHostWriter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateAppHost\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eappHostSourceFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eAppHostSourcePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eappHostDestinationFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eAppHostDestinationPath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eappBinaryFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eAppBinaryName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ewindowsGraphicalUserInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eisGUI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eassemblyToCopyResorcesFrom\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eresourcesAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eHostWriterのCreateAppHost関数に\u003ccode\u003eisGUI (WindowsGraphicalUserInterface)\u003c/code\u003eを渡しています。\u003c/p\u003e\n\n\u003cp\u003eHostWriterのソースは以下にあります\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://github.com/dotnet/core-setup/blob/master/src/managed/Microsoft.NET.HostModel/AppHost/HostWriter.cs\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// HostWriter.csより引用\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Re-write the destination apphost with the proper contents.\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ememoryMappedFile\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMemoryMappedFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateFromFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eappHostDestinationFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMemoryMappedViewAccessor\u003c/span\u003e \u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ememoryMappedFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateViewAccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eBinaryUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSearchAndReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAppBinaryPathPlaceholderSearchValue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebytesToWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eappHostIsPEImage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBinaryUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsPEImage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewindowsGraphicalUserInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eappHostIsPEImage\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAppHostNotPEFileException\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eBinaryUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetWindowsGraphicalUserInterfaceBit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eBinaryUtils.SetWindowsGraphicalUserInterfaceBitがそれっぽい処理みたいです。\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://github.com/dotnet/core-setup/blob/master/src/managed/Microsoft.NET.HostModel/AppHost/BinaryUtils.cs\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// BinaryUtils.csより引用 (★部分は追記部分)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// The value of the sybsystem field which indicates Windows GUI (Graphical UI)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"n\"\u003eUInt16\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsGUISubsystem\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0x2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// This method will attempt to set the subsystem to GUI. The apphost file should be a windows PE file.\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"accessor\"\u0026gt;The memory accessor which has the apphost file opened.\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetWindowsGraphicalUserInterfaceBit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMemoryMappedViewAccessor\u003c/span\u003e \u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003epointer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSafeMemoryMappedViewHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAcquirePointer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003epointer\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebytes\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epointer\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePointerOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// https://en.wikipedia.org/wiki/Portable_Executable\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eUInt32\u003c/span\u003e \u003cspan class=\"n\"\u003epeHeaderOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eUInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e*)(\u003c/span\u003e\u003cspan class=\"n\"\u003ebytes\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ePEHeaderPointerOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e))[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCapacity\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003epeHeaderOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eSubsystemOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eUInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAppHostNotPEFileException\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eUInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esubsystem\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eUInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e*)(\u003c/span\u003e\u003cspan class=\"n\"\u003ebytes\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003epeHeaderOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eSubsystemOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#windows-subsystem\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// The subsystem of the prebuilt apphost should be set to CUI\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubsystem\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsCUISubsystem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAppHostNotCUIException\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ★WindowsGUISubsystem(2)の書き込み\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Set the subsystem to GUI\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esubsystem\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowsGUISubsystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epointer\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eaccessor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSafeMemoryMappedViewHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleasePointer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれでようやく\u003cstrong\u003eOutputType\u003c/strong\u003eを\u003cstrong\u003eWinExe\u003c/strong\u003eにすると\u003cstrong\u003eWindowsアプリケーションとして作成される\u003c/strong\u003eことがわかりました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"最後に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最後に\u003c/h2\u003e\n\n\u003cp\u003e今回の記事はほぼ何の役にもたたないことばかり書いてますが.NET Coreでデスクトップアプリケーションが作成できるようになったというのは感動的です。\u003cbr\u003e\n他にもC#8.0が使えたり.NET Standard 2.1がサポートされていたりするので\u003cstrong\u003e.NET Core3.0をぜひ試してみましょう\u003c/strong\u003e😊\u003c/p\u003e\n","createdAt":"2019-09-24T13:49:39Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"Y2GpLI4/Z0t141Zeusqd3JDzoafzpxM2JA==--gcYAC97bYY9p0ucM--EodAotJhiUe2wJxR0f418Q==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2019-09-24T13:49:39Z","likesCount":7,"linkUrl":"https://qiita.com/yaegaki/items/592bbaefdc87abc40dca","organization":null,"originalId":1029121,"stockedCount":7,"title":".NET Core 3.0でサポートされるWindowsデスクトップアプリケーションを追う","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#windows%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E4%BD%9C%E6%88%90\"\u003eWindowsデスクトップアプリケーションの作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#windows%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A8%E5%BE%93%E6%9D%A5%E3%81%AE%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E9%81%95%E3%81%84\"\u003eWindowsデスクトップアプリケーションと従来のアプリケーションの違い\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A3%9C%E8%B6%B3pe%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88%E3%81%A8subsystem\"\u003e(補足)PEフォーマットとSubsystem\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#csproj%E8%A7%A3%E8%AA%AD\"\u003ecsproj解読\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e最後に\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":3965,"uuid":"592bbaefdc87abc40dca","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"E0CJGUFrE5FCqBt610AonY5WMrw=--Tfcf49usvtVCZxwT--B2aXiskXOb0f6WCJp7mkZg==","originalId":42193,"description":"アセンブリからWebまで広くやっています。","facebookUrl":null,"githubUrl":"https://github.com/yaegaki","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/42193/profile-images/1473689068","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F42193%2Fprofile-images%2F1473689068?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=b20da3dad599766cd792f1dce99e1c92","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F42193%2Fprofile-images%2F1473689068?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=f8b35d8bb7020c495cc470f37fe29ee8","urlName":"yaegaki","websiteUrl":"https://yaegaki.dev/","twitterUrl":"https://twitter.com/yayaegaki","twitterUrlName":"yayaegaki","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":".NET","urlName":".net"},{"name":".NETCore","urlName":".netcore"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
