More than 1 year has passed since last update.ManagementEventWatcher Class
クエリに基づいて、Windows上のイベントを拾えるみたいです。この方法には問題点があって、64bitのOS上で実行するアプリケーションがx86だった場合でかつ、WoW6432Nodeが存在しうるキーパスを監視する場合、必ずWoW6432Nodeの中を監視してしまいます。その場合は次のようにWin32APIをP/Invokeして使う必要があります。簡単な方法と違って数行で済まないため、出来合いのクラスを貼っておきます。
レジストリの変更とキャンセルの通知どちらかの変更を、新たなスレッドでループさせて待ちます。変更が加えられるとWaitしていた部分を通過してイベントを起こします。上記クラスの使用例も兼ねてます


