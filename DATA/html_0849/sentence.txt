こういうやつ
ちゃんとポートの抜き差しも反映されるよ新規作成→プロジェクトでWPFアプリ(.NET Framawork)を選択、プロジェクトを作成します。
プロジェクト名はSerialPortComboBoxとします。ツールボックスから、ComboBoxとButtonを配置する。
名前をそれぞれ、SerialPortComboBoxとConnectButtonに変更ソリューションエクスプローラーで右クリック、追加→新しい項目で、クラスファイルを作成。ファイル名をSerialPortComboBox.csとする以下のように書くCOMPortSelector.Init();を呼び出せば機能してくれます。
ボタンが押されるなどに応じてCOMPortSelector.PushConnectButton();を呼び出すことでConnect, Disconnectの切り替えを行います。以下、COMPortSelectorクラスが行っている処理の解説SerialPort.GetPortNames()で接続されているポートの一覧を取得することができますが、これをUpdateSerialPortComboBox()内で行い、CmboBoxのアイテム一覧に反映させています。また、ポートの抜き差しに応じてアイテムの一覧が反映させたいので、DispatcherTimerを使用し、1秒ごとにUpdateSerialPortComboBox()を呼び出すことで実装しています。他には、SetDataReceivedHandle();を使うと受信イベントによって呼び出すメソッドを設定することができます。メインで、COMPortSelector.SetDataReceivedHandle(aDataReceivedHandler);とし、
受信ごとにaDataReceivedHandlerが呼び出されます。


