More than 3 years have passed since last update.C#を使っていると、たまに別のアプリを起動したくなることがあります。
例えば、画像処理ツールのImageMagickをプログラムで実行したいときなどですね。今回、実行環境はdotnet core2.0を使っていますが、もちろん.Net Frameworkでも問題ないと思います。
試してはいないですけど。
あ、実行OSはWindows10です。System.Diagnostics名前空間のProcess#Startメソッドを使えば簡単に実行できます。
よくあるサンプルとして、メモ帳を起動するコードが以下です。極めて簡単。
こいつを実行すると、音もなくすっとメモ帳が起動できます。実行時引数であるとか、ウィンドウの表示・非表示であるとか、色々指定したいときには、
ProcessStartInfoインスタンスを使用します。
以下は、メモ帳を引数付きで実行するサンプルです。正直今回の記事の本題はこれ。
ほーん。こんなに簡単に起動できるのか！便利やん！と思って、メモ帳以外のアプリを起動しようと思ったら、このWin32Exceptionが発生して起動できない！ってことが発生しました。ここではVisual Studio Codeを起動してみることにしましょう。
まずはコマンドプロンプトでもパワーシェルでもいいので、起動できることと、アプリ名を確認します。codeというコマンド名で実行するとVisual Studio Codeが起動することは確認しました。
あとはメモ帳と同じようにファイル名にcodeを指定すればよさそうです。しかし、上記を実行するとWin32Exceptionが発生して起動できません。
同様に、結構なアプリで起動ができないです。
しかも、公式のも含め、みんなメモ帳を起動するサンプルコードしかないのでにっちもさっちもいきません。UseShellExecuteをtrueにしてシェルから起動するように指定してあげればいいみたいです。メモ帳もこれでも起動できたので、基本この指定方法でいいんじゃないかなぁと。


