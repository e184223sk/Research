C#で NetOffice を使ってWordの中のオートシェイプをグループ化する要件があった。その際に時々成功するが、時々失敗するという事象に悩まされたので、ここにメモしておく。具体的には以下のようなコードで問題が発生した。例外の内容２つあった。高速化の観点からWordを非表示にしていて実行していたが、Group化する際にはVisibleがtrueじゃないといけない(Wordが見えてないといけない)ようだ。グループ化対象のShapeが見えない位置にあると、上記のUnauthorizedAccessException が出るようで、例えば1ページ目にShapeがあれば成功するが、2ページ目にあると失敗するという現象が発生した。 今回の場合、以下のようなVisible操作とページ遷移コードをrange.Group() の前に実行しておく必要があった。これで安定してグループ化することができました。


