<!DOCTYPE html><html><head><meta charset="utf-8" /><title>【C#】なぜReactiveExtensionsを導入すると幸せになれるのか - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/yutorisan/items/2475eaf5d8c3a6454e3f" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="EUO4jnqKvKybeDPYe2G3jl22ZnUxuAW0lkdHUBBtN+vs2+Mxwbs4W2CXeVg9SMt8hmKUFyBCECecQGSCqg4vSw==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@yutorisan19" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="【C#】なぜReactiveExtensionsを導入すると幸せになれるのか - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRUXlQamdKSGpnYXJqZ1p4U1pXRmpkR2wyWlVWNGRHVnVjMmx2Ym5QamdwTGxzSTdsaGFYamdabmpnb3ZqZ2FqbHViampnWnZqZ2F2amdhcmpnb3pqZ292amdhN2pnWXMmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NWQ3NzVmOWMzOTEwZDA4ZDZiNWJjZDNjY2I3ZjhiY2Q&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGwxZEc5eWFYTmhiZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTgxODZjNmQyOWMyMjMwNjA0NDYxZjBhZTI0ODQ3YzI4&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=d188c8c2a551b9365339d074d4fa20ad"><meta property="og:description" content="この記事は C# Advent Calendar 2020 21日目の記事です。


はじめに

僕はとある会社で働いているのですが、頑なにReactiveExtensions（以下Rx）に拒否反応を示す先輩がいます。
Rxの使い方と..."><meta content="https://qiita.com/yutorisan/items/2475eaf5d8c3a6454e3f" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,ReactiveExtensions,UniRx" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-380ee913-3bb6-4f4e-88a8-67899cff4f44"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fyutorisan%2Fitems%2F2475eaf5d8c3a6454e3f">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fyutorisan%2Fitems%2F2475eaf5d8c3a6454e3f">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-380ee913-3bb6-4f4e-88a8-67899cff4f44">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-12-21T01:33:17.000+09:00","dateModified":"2021-04-08T01:08:15.000+09:00","headline":"【C#】なぜReactiveExtensionsを導入すると幸せになれるのか","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRUXlQamdKSGpnYXJqZ1p4U1pXRmpkR2wyWlVWNGRHVnVjMmx2Ym5QamdwTGxzSTdsaGFYamdabmpnb3ZqZ2FqbHViampnWnZqZ2F2amdhcmpnb3pqZ292amdhN2pnWXMmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NWQ3NzVmOWMzOTEwZDA4ZDZiNWJjZDNjY2I3ZjhiY2Q\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGwxZEc5eWFYTmhiZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTgxODZjNmQyOWMyMjMwNjA0NDYxZjBhZTI0ODQ3YzI4\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=d188c8c2a551b9365339d074d4fa20ad","mainEntityOfPage":"https://qiita.com/yutorisan/items/2475eaf5d8c3a6454e3f","author":{"@type":"Person","address":"","email":null,"identifier":"yutorisan","name":"yutorisan","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fpbs.twimg.com%2Fprofile_images%2F1274400166120812544%2FDAWcpHec_bigger.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=754be610f489085be0fdfc48de5585a9","url":"https://qiita.com/yutorisan","description":"C#が好きです","memberOf":[{"@type":"Organization","address":"オンライン@Slack","legalName":"Unityゲーム開発者ギルド","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/5e3ba3bb442371003e6b5d4618ef627b9b478357/original.jpg?1570216541","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/f7eb993765ddcdb2c5e6890556c43ea3de8fbfb7/original.jpg?1570215690","identifier":"unity-game-dev-guild","description":"趣味・仕事問わずUnityでゲームを作っている開発者のみで構成されるオンラインコミュニティです。Unityでゲームを開発・運用するにあたって必要なあらゆる知見を共有することを目的とします。"}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202106-uzabase-3/">社員の行動の基盤となるユーザベースのミッション・バリュー</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202106-uzabase-3/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yutorisan","type":"items","id":"2475eaf5d8c3a6454e3f"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"社員の行動の基盤となるユーザベースのミッション・バリュー","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yutorisan","type":"items","id":"2475eaf5d8c3a6454e3f"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"社員の行動の基盤となるユーザベースのミッション・バリュー","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yutorisan","type":"items","id":"2475eaf5d8c3a6454e3f"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"社員の行動の基盤となるユーザベースのミッション・バリュー","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/yutorisan/items/2475eaf5d8c3a6454e3f","location":"/yutorisan/items/2475eaf5d8c3a6454e3f","scheme":"https","host":"qiita.com","port":null,"pathname":"/yutorisan/items/2475eaf5d8c3a6454e3f","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"zfux+QI9HDOO8xNaQzdbm6nEpSp9ZFR6J25gUSAhByEwY+pGuQyYxHUcWdoFHidpchBXSGyeQektaUODmkIfgQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-d1f22e5c-8a4d-4776-8a17-b774b736b567"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/likers" class="css-1iupg5d">95</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">85</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/2475eaf5d8c3a6454e3f/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yutorisan/items/2475eaf5d8c3a6454e3f.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2020/csharplang" class="it-AdcalRibbon_title">C#<!-- --> Advent Calendar<!-- --> <!-- -->2020</a>Day 21</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/yutorisan"><img class="css-100alwu eyfquo10" src="https://pbs.twimg.com/profile_images/1274400166120812544/DAWcpHec_bigger.jpg" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/yutorisan" class="css-10ougpm">@<!-- -->yutorisan</a><div class="css-1ay9vb9"><span><meta content="2020-12-20T16:33:17Z"/><time dateTime="2021-04-07T16:08:15Z" class="css-m19uds">updated at 2021-04-07</time></span></div></div></div></div></div><h1 class="css-cgzq40">【C#】なぜReactiveExtensionsを導入すると幸せになれるのか</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/reactiveextensions" class="css-4czcte">ReactiveExtensions</a><a href="/tags/unirx" class="css-4czcte">UniRx</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>この記事は <a href="https://qiita.com/advent-calendar/2020/csharplang">C# Advent Calendar 2020</a> 21日目の記事です。</p>

<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>僕はとある会社で働いているのですが、頑なにReactiveExtensions（以下Rx）に拒否反応を示す先輩がいます。<br>
Rxの使い方と導入の利点を説明したのですが、なかなか理解してもらえず…。<br>
そこで自分自身もRxの利点をきちんと理解し、胸を張って説明できるのか？と不安になってきたため、ここに整理してみます。</p>

<h1>
<span id="なぜrxを導入すると幸せになれるのか" class="fragment"></span><a href="#%E3%81%AA%E3%81%9Crx%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B%E3%81%A8%E5%B9%B8%E3%81%9B%E3%81%AB%E3%81%AA%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>なぜRxを導入すると幸せになれるのか</h1>

<p>いきなり本題ですが、「なぜRxを導入すると幸せになれるのか」。<br>
幸せになれるというのはただのキャッチフレーズであり言いすぎですが、なぜRxを導入するべきなのか。</p>

<p>それは、Rxとは<strong>C#標準機能であるeventの完全上位互換<sup id="fnref1"><a href="#fn1" title="「Rxはeventの完全上位互換」というフレーズは@toRisouPさんのこの記事から学ばせていただきました。">1</a></sup>となる機能を提供するライブラリであるから</strong>です。</p>

<p>つまり、Rxを導入すると標準のeventではできなかった、あんなことやこんなことが簡単にできるようになり、結果的に<strong>ソースコードの可読性・保守性が飛躍的に高める</strong>ことができます。<br>
また、コード全体でRxを導入することで、イベント駆動型<sup id="fnref2"><a href="#fn2" title="イベント駆動型という表現が適切かどうかあまり自信がありません…">2</a></sup>のコーディングスタイルとなり、結果的に<strong>クラス同士が疎結合となるような設計</strong>がしやすくなります。</p>

<h2>
<span id="rxがeventに比べて追加で提供する機能" class="fragment"></span><a href="#rx%E3%81%8Cevent%E3%81%AB%E6%AF%94%E3%81%B9%E3%81%A6%E8%BF%BD%E5%8A%A0%E3%81%A7%E6%8F%90%E4%BE%9B%E3%81%99%E3%82%8B%E6%A9%9F%E8%83%BD"><i class="fa fa-link"></i></a>Rxがeventに比べて追加で提供する機能</h2>

<p>ここで重要なのは、eventに対してRxが追加で提供する機能が、<strong>とんでもなく強力である</strong>ということです。<br>
具体的には、eventに比べて以下のような機能が追加で提供されます。</p>

<ol>
<li>イベント発行値に対して多彩なLINQオペレータを適用</li>
<li>イベントのオブジェクト化</li>
<li>容易なイベント解除</li>
</ol>

<p>一つずつ簡単な例を示します。</p>

<h3>
<span id="1イベント発行値に対してlinqオペレータを適用" class="fragment"></span><a href="#1%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E7%99%BA%E8%A1%8C%E5%80%A4%E3%81%AB%E5%AF%BE%E3%81%97%E3%81%A6linq%E3%82%AA%E3%83%9A%E3%83%AC%E3%83%BC%E3%82%BF%E3%82%92%E9%81%A9%E7%94%A8"><i class="fa fa-link"></i></a>1.イベント発行値に対してLINQオペレータを適用</h3>

<p>この機能がRxのメインというか、要となる機能です。<br>
<code>IEnumerable&lt;T&gt;</code>でおなじみのLINQメソッド群を、ほぼそのままeventの発行値に対して適用することができます。</p>

<p>具体的には、以下のような事が可能になります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">eventPublisher</span><span class="p">.</span><span class="n">SomeIntEvent</span> <span class="c1">//Int型を発行する何らかのイベントに対して…</span>
              <span class="c1">//発行された値のうち、偶数のものだけに絞り込み…</span>
              <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">n</span> <span class="p">%</span> <span class="m">2</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
              <span class="c1">//それを文字列型に直して…</span>
              <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="s">$"</span><span class="p">{</span><span class="n">n</span><span class="p">}</span><span class="s">が発行されました"</span><span class="p">)</span>
              <span class="c1">//購読する！</span>
              <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">str</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">str</span><span class="p">));</span>
</code></pre></div></div>

<p><code>Subscribe</code>というのは後で詳しく説明しますが、イベントを購読するという意味です。<br>
要は、発行されたイベントをそのまま購読するのではなく、<code>Where</code>や<code>Select</code>といったLINQメソッドチェーンを自由に適用し、都合の良い形に変形した上で、イベントを購読することができるというわけです。</p>

<p>これを同じことをeventでやろうとすると、LINQメソッドチェーンが使用できないため、次のようになります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">eventPublisher</span><span class="p">.</span><span class="n">SomeIntEvent</span> <span class="p">+=</span> <span class="n">n</span> <span class="p">=&gt;</span> 
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="p">%</span> <span class="m">2</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="s">$"</span><span class="p">{</span><span class="n">n</span><span class="p">}</span><span class="s">が発行されました"</span><span class="p">;</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>LINQメソッドチェーンを利用した場合に比べ、ひと目でなにをやっているのかを理解することができず、可読性が低くなっています。<br>
また、LINQのように処理がブロックごとに分離されていないため、変更に対して弱いという欠点もあります。</p>

<p>これは簡単な例なのでまだ良いのですが、複雑な処理になればなるほど、イベントの発行値に対してLINQオペレータが適用できるというRxの利点は、極めて大きく重要なものとなってきます。</p>

<h3>
<span id="2イベントのオブジェクト化" class="fragment"></span><a href="#2%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%8C%96"><i class="fa fa-link"></i></a>2.イベントのオブジェクト化</h3>

<p>C#標準のeventはオブジェクトではないため、イベントを購読できる人はイベントに直接アクセスできる人だけとなります。<br>
ところが、Rxの場合はイベントの購読権を<code>IObservable</code>というオブジェクトとして表現されるため、<strong>イベントの購読権を自由に別のクラスに引き渡したり</strong>することができます。</p>

<p>具体例を見てみます。<br>
まず、標準のeventの場合。eventがオブジェクトではないため、<strong>eventを購読できるのはそのイベントを発行するクラスのインスタンスを保持しているクラスのみ</strong>となります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">class</span> <span class="nc">EventPublisher</span>
<span class="p">{</span>
    <span class="c1">//..中略..</span>
    <span class="k">public</span> <span class="k">event</span> <span class="n">Action</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">SomeEvent</span><span class="p">;</span>
    <span class="c1">//..中略..</span>
<span class="p">}</span>

<span class="c1">//EventPublisherのインスタンスを直接保持しているクラス</span>
<span class="k">class</span> <span class="nc">HogeClass</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">EventPublisher</span> <span class="n">publisher</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">EventPublisher</span><span class="p">();</span>
    <span class="k">private</span> <span class="n">MogeClass</span> <span class="n">moge</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">HogeClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">moge</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MogeClass</span><span class="p">();</span>

        <span class="c1">//自分は当然イベント購読が可能</span>
        <span class="n">publisher</span><span class="p">.</span><span class="n">SomeEvent</span> <span class="p">+=</span> <span class="n">n</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="cm">/* 何らかの処理 */</span> <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//EventPublisherのインスタンスを保持していないクラス</span>
<span class="k">class</span> <span class="nc">MogeClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">MogeClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//EventPublisherを保持していないので、EventPublisherが発行するイベントを購読できない</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>次に、Rxの場合。<br>
Rxの場合は購読する権利を<code>IObservable</code>というオブジェクトとして表現されるため、購読権を他のクラスに引き渡すことで、<strong>イベントを発行するクラスのインスタンスを直接保持していなくてもイベントの購読が可能</strong>となります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">class</span> <span class="nc">EventPublisher</span>
<span class="p">{</span>
    <span class="c1">//..中略..</span>
    <span class="k">public</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">SomeObservable</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
    <span class="c1">//..中略..</span>
<span class="p">}</span>

<span class="c1">//EventPublisherのインスタンスを直接保持しているクラス</span>
<span class="k">class</span> <span class="nc">HogeClass</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">EventPublisher</span> <span class="n">publisher</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">EventPublisher</span><span class="p">();</span>
    <span class="k">private</span> <span class="n">MogeClass</span> <span class="n">moge</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">HogeClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//MogeClassにイベントの購読権を引き渡す</span>
        <span class="n">moge</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MogeClass</span><span class="p">(</span><span class="n">publisher</span><span class="p">.</span><span class="n">SomeObservable</span><span class="p">);</span>

        <span class="c1">//自分は当然イベント購読が可能</span>
        <span class="n">publisher</span><span class="p">.</span><span class="n">SomeObservable</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="cm">/* 何らかの処理 */</span> <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//EventPublisherのインスタンスを保持していないクラス</span>
<span class="k">class</span> <span class="nc">MogeClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">MogeClass</span><span class="p">(</span><span class="n">IObservable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">observable</span><span class="p">)</span> <span class="c1">//イベントの購読権を受けるようにする</span>
    <span class="p">{</span>
        <span class="c1">//取得した購読権を使用して、イベントを購読可能！</span>
        <span class="n">observable</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="cm">/* 何らかの処理 */</span> <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<h3>
<span id="3容易なイベントの解除" class="fragment"></span><a href="#3%E5%AE%B9%E6%98%93%E3%81%AA%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E8%A7%A3%E9%99%A4"><i class="fa fa-link"></i></a>3.容易なイベントの解除</h3>

<p>C#標準のイベントの場合、一度登録したイベントを解除するには<code>-=</code>演算子を利用して、登録したときと全く同じメソッドを指定する必要があります。<br>
つまり、<strong>ラムダ式を登録した場合は解除できなくなってしまう</strong>のです。</p>

<p>一方、Rxの場合は<strong><code>Subscribe</code>したときに出てくる<code>IDisposable</code>を<code>Dispose</code>するだけ</strong>で済みます。</p>

<p>具体的には以下のような感じになります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">//イベント購読。購読時に解除用のIDisposableを取得する</span>
<span class="n">IDisposable</span> <span class="n">disposable</span> <span class="p">=</span> <span class="n">someObservable</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="cm">/* 処理 */</span><span class="p">);</span>

<span class="c1">//..中略..</span>

<span class="c1">//購読を解除したいときはIDisposableをDisposeするだけ</span>
<span class="n">disposable</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
</code></pre></div></div>

<p>Rxでは、イベントの購読権が<code>IObservable</code>というオブジェクトとして表現されるのと同様に、<strong>イベントの解除権も<code>IDisposable</code>というオブジェクトで表現される</strong>こともポイントです。<br>
例えば、複数のイベントを購読して出てきた<code>IDisposable</code>を<code>List</code>にためておき、後でまとめて購読解除するといったことも容易に実現可能です。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">//購読解除用IDisposableをためておくList</span>
<span class="n">List</span><span class="p">&lt;</span><span class="n">IDisposable</span><span class="p">&gt;</span> <span class="n">disposables</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">IDisposable</span><span class="p">&gt;();</span>

<span class="c1">//イベントを複数購読し、出てきたIDisposableをためておく</span>
<span class="n">disposables</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">observable1</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="cm">/* 処理 */</span><span class="p">));</span>
<span class="n">disposables</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">observable2</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="cm">/* 処理 */</span><span class="p">));</span>
<span class="n">disposables</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">observable3</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="cm">/* 処理 */</span><span class="p">));</span>

<span class="c1">//..中略..</span>

<span class="c1">//購読解除したいときに一気に購読解除</span>
<span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">disposable</span> <span class="k">in</span> <span class="n">disposables</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">disposable</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ちなみに、上記のようなことが容易に行える<code>CompositeDisposable</code>クラスや<code>AddTo</code>メソッドもあります。詳しくはググってみてください。</p>

<h1>
<span id="rxはどのような場面で役立つのか" class="fragment"></span><a href="#rx%E3%81%AF%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AA%E5%A0%B4%E9%9D%A2%E3%81%A7%E5%BD%B9%E7%AB%8B%E3%81%A4%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>Rxはどのような場面で役立つのか</h1>

<p>このように様々な利点があるRxですが、どのような場面で利用できる・効果を発揮するのでしょうか？<br>
大きく分けて、次の２つの場面で役立てることができると考えています。</p>

<h2>
<span id="1クラス間でメッセージのやり取りを行いたいとき" class="fragment"></span><a href="#1%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%93%E3%81%A7%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%84%E3%82%8A%E5%8F%96%E3%82%8A%E3%82%92%E8%A1%8C%E3%81%84%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D"><i class="fa fa-link"></i></a>1.クラス間でメッセージのやり取りを行いたいとき</h2>

<p>１つ目は、クラス間でメッセージ（データ）のやり取りを行いたい場面です。<br>
これはつまるところ、<strong>eventの代わりとして利用できます</strong>という意味です。<br>
Rxはeventの完全上位互換なので当然ですね。</p>

<p>すでに説明したように、Rxはeventに比べて非常に強力な機能が追加で利用できるため、わざわざeventを利用する意味はありません<sup id="fnref3"><a href="#fn3" title="Rxの利点をすべて利用しない（event標準機能だけで事足りる）ことが確定している場合はこの限りではありません。">3</a></sup>。Rxを使いましょう。</p>

<h2>
<span id="2ある時間間隔で一定の処理を行いたい場合" class="fragment"></span><a href="#2%E3%81%82%E3%82%8B%E6%99%82%E9%96%93%E9%96%93%E9%9A%94%E3%81%A7%E4%B8%80%E5%AE%9A%E3%81%AE%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%84%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>2.ある時間間隔で一定の処理を行いたい場合</h2>

<p>２つ目は、一定、または不定の時間間隔である処理を行いたい場合です。<br>
いわゆるタイマー処理です。Rxはこの場合にも、その威力を存分に発揮します。</p>

<p>というのも、Rxには一定、または不定の時間間隔でイベント（<code>IObservable</code>）を発行するクラスを生成するファクトリメソッドが、予め用意されているのです。<br>
そのため、時間間隔で何かをしたい場合、利用者はただ、その用意されたファクトリメソッドを呼び出し、イベントを購読して処理を登録するだけで済みます。</p>

<p><code>System.Windows.Forms.Timer</code>とか<code>System.Threading.Timer</code>は不要です。Unityの場合は<code>Time.deltaTime</code>をアレコレしたり、<code>WaitForSecounds</code>をどうこうする必要はもうありません。</p>

<p>具体的には後で説明しますが、簡単に書くと次のように非常に簡潔に一定の時間間隔で処理を行うことができます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">Observable</span><span class="p">.</span><span class="nf">Interval</span><span class="p">(</span><span class="m">100</span><span class="p">).</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"100msごとにメッセージが表示されるよ！"</span><span class="p">));</span>
</code></pre></div></div>

<p>やっていることとしては「『一定間隔でイベントを発行するクラス』からのメッセージを受け取って一定の処理を実行する」のと同じであるため、本質的には「1.クラス間でメッセージのやり取りを行いたいとき」に帰着します。</p>

<h1>
<span id="rxを使う上で最低限必要な知識" class="fragment"></span><a href="#rx%E3%82%92%E4%BD%BF%E3%81%86%E4%B8%8A%E3%81%A7%E6%9C%80%E4%BD%8E%E9%99%90%E5%BF%85%E8%A6%81%E3%81%AA%E7%9F%A5%E8%AD%98"><i class="fa fa-link"></i></a>Rxを使う上で最低限必要な知識</h1>

<p>Rxの利点と使い所がわかったところで、実際にどのように使うのかを説明したいところですが、その前にRxを使用する上で最低限必要な知識をここで紹介します。</p>

<h2>
<span id="observerパターン" class="fragment"></span><a href="#observer%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>Observerパターン</h2>

<p>Rxはデザインパターンの一つである<strong>Observerパターン</strong> が基礎になっています。</p>

<p>Observerパターンについて詳しく知りたい方は、別記事を書きましたので↓を参照してください。</p>

<p><strong><a href="https://qiita.com/yutorisan/items/6e960426da71b7e02af7" id="reference-6d0aff97d7d3fce00195">C#でObserverパターンをきちんと理解して実装する</a></strong></p>

<p>ところが、実際にRxを使う上ではObserverパターンそのものを意識する必要はあまりありません。<br>
その上で、どうしてもRxを使う上で必要となる次の3つのクラスとインターフェイス、それから<code>Subscribe</code>メソッドのオーバーロードについて簡単に説明していきます。<br>
※一部↑の記事と内容が重複しています</p>

<ul>
<li>
<code>IObserver&lt;T&gt;</code>インターフェイス</li>
<li>
<code>IObservable&lt;T&gt;</code>インターフェイス</li>
<li>
<code>Subject&lt;T&gt;</code>クラス</li>
<li>アクションを直接受け取る<code>Subscribe</code>メソッドのオーバーロード</li>
</ul>

<p>※この記事では必要最低限の解説のみ行います。詳しい説明は↑の記事を参照ください。</p>

<h3>
<span id="iobservertインターフェイス" class="fragment"></span><a href="#iobservert%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9"><i class="fa fa-link"></i></a><code>IObserver&lt;T&gt;</code>インターフェイス</h3>

<p><code>IObserver&lt;T&gt;</code>インターフェイスは、<strong>発行された値を受け取るクラス</strong>が実装するインターフェイスです。</p>

<p>定義は次のようになっています。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IObserver</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 値を通知する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="value"&gt;&lt;/param&gt;</span>
    <span class="k">void</span> <span class="nf">OnNext</span><span class="p">(</span><span class="n">T</span> <span class="k">value</span><span class="p">);</span>    
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 例外が発生したことを通知する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
    <span class="k">void</span> <span class="nf">OnError</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">);</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 値の発行がすべて完了したことを通知する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">void</span> <span class="nf">OnCompleted</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code>IObserver&lt;T&gt;</code>に値を通知したい人は、この<strong><code>OnNext</code>メソッドの引数に通知したい値を乗せて呼び出す</strong>ことで、値を通知することができます。<br>
また、「もう発行する値がない」ことを伝える<code>OnCompleted</code>メソッドや、値の発行元で何らかの例外が発生してしまったことを伝える<code>OnError</code>メソッドも用意されています。</p>

<h3>
<span id="iobservabletインターフェイス" class="fragment"></span><a href="#iobservablet%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9"><i class="fa fa-link"></i></a><code>IObservable&lt;T&gt;</code>インターフェイス</h3>

<p><code>IObservable&lt;T&gt;</code>インターフェイスは、<strong>値を発行するクラス</strong>が実装するインターフェイスです。</p>

<p>定義は次のようになっています。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IObservable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 値を購読する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="observer"&gt;値の発行先&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="n">IDisposable</span> <span class="nf">Subscribe</span><span class="p">(</span><span class="n">IObserver</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">observer</span><span class="p">);</span>    
<span class="p">}</span>
</code></pre></div></div>

<p>このクラスが発行する値を受け取りたいクラスは、この<strong><code>Subscribe</code>メソッドに自分自身を引数で引き渡して呼び出す</strong>ことで、発行先として登録することができます。<br>
※値を受け取るクラスは<code>IObserver&lt;T&gt;</code>である必要があります</p>

<p>発行先の<code>IObserver&lt;T&gt;</code>を受け取ったObservableなクラスは、値を発行するタイミングで、受け取った<code>IObserver&lt;T&gt;</code>を<code>OnNext</code>することによって、値を通知することができます。</p>

<p><a href="https://camo.qiitausercontent.com/69ae5f2cd9c51fceb57cda9a4f3a5966919bbae7/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f6171396d61656d7171396963667873757576646d74726b6b386a6c71" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2Faq9maemqq9icfxsuuvdmtrkk8jlq?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=eede8429eb3c535e9ba9331d4be16218" alt="" data-canonical-src="https://storage.googleapis.com/zenn-user-upload/aq9maemqq9icfxsuuvdmtrkk8jlq" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2Faq9maemqq9icfxsuuvdmtrkk8jlq?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9ab1ee0ef60acb42d3bc9087e8ad18c9 1x" loading="lazy"></a></p>

<p>ここまでが、<strong>ベタなObserverパターン</strong>の<strong>簡易的な説明</strong>になります。<br>
繰り返しになりますが、きちんとObserverパターンを理解したい場合は下記記事を参照ください。<br>
<strong><a href="https://qiita.com/yutorisan/items/6e960426da71b7e02af7">C#でObserverパターンをきちんと理解して実装する</a></strong></p>

<h4>
<span id="ベタなobserverパターンの問題点" class="fragment"></span><a href="#%E3%83%99%E3%82%BF%E3%81%AAobserver%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9"><i class="fa fa-link"></i></a>ベタなObserverパターンの問題点</h4>

<p>ベタなObserverパターンでも値の発行と受け取りは可能なのですが、次のような問題が発生してしまい使い勝手が悪いです。</p>

<ol>
<li>値を発行する側は、同じ型の値を複数種類発行できない。</li>
<li>値を受け取る側も同様に、同じ型の値を複数種類購読できない。</li>
</ol>

<h5>
<span id="1値を発行する側は同じ型の値を複数種類発行できない" class="fragment"></span><a href="#1%E5%80%A4%E3%82%92%E7%99%BA%E8%A1%8C%E3%81%99%E3%82%8B%E5%81%B4%E3%81%AF%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%80%A4%E3%82%92%E8%A4%87%E6%95%B0%E7%A8%AE%E9%A1%9E%E7%99%BA%E8%A1%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>1.値を発行する側は、同じ型の値を複数種類発行できない。</h5>

<p>値を発行する側のクラスは、同じ型の値を複数種類発行することができません。</p>

<p>例えば「キーボード」を例にとって考えてみます。<br>
キーボードは、押されたキーをPCに送信します。このとき、同時押しを考慮すると、「押されたキー」だけではなく「離されたキー」の情報もPCに送信しなければなりません。<br>
つまり、「押されたキー」「離されたキー」の２種類の値をPCに発行したいことになります。</p>

<p>これをそのまま実装しようと思っても、、</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">class</span> <span class="nc">KeyBoard</span> <span class="p">:</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="n">KeyCode</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">IObserver</span><span class="p">&lt;</span><span class="n">KeyCode</span><span class="p">&gt;</span> <span class="n">m_observer</span><span class="p">;</span>
    <span class="c1">//値の発行先を受け取る</span>
    <span class="k">public</span> <span class="n">IDisposable</span> <span class="nf">Subscribe</span><span class="p">(</span><span class="n">IObserver</span><span class="p">&lt;</span><span class="n">KeyCode</span><span class="p">&gt;</span> <span class="n">observer</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">m_observer</span> <span class="p">=</span> <span class="n">observer</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span> <span class="c1">//Disposeの処理は省略</span>
    <span class="p">}</span>

    <span class="c1">//キーを謳歌されたときの処理</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnPushDown</span><span class="p">(</span><span class="n">KeyCode</span> <span class="n">keyCode</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//押下されたキーを通知する</span>
        <span class="n">m_observer</span><span class="p">.</span><span class="nf">OnNext</span><span class="p">(</span><span class="n">keyCode</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">//押されたキーが離されたときの処理</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnPushUp</span><span class="p">(</span><span class="n">KeyCode</span> <span class="n">keyCode</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//m_observer.OnNextすると押下通知を混ざってしまう</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>このように、押下されたキーの通知と、押下状態を解除されたキーの通知が混ざってしまい、それぞれを分けて通知することができません。</p>

<h5>
<span id="2値を受け取る側も同様に同じ型の値を複数種類購読できない" class="fragment"></span><a href="#2%E5%80%A4%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B%E5%81%B4%E3%82%82%E5%90%8C%E6%A7%98%E3%81%AB%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%80%A4%E3%82%92%E8%A4%87%E6%95%B0%E7%A8%AE%E9%A1%9E%E8%B3%BC%E8%AA%AD%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>2.値を受け取る側も同様に、同じ型の値を複数種類購読できない。</h5>

<p>この問題は受け取る側（Observer側）にも発生します。<br>
理由は、<code>IObserver&lt;T&gt;</code>インターフェイスを複数個実装できないため、受け取り口が同じになってしまい、これまたすべての通知が混ざってしまうからです。</p>

<p>例えば、次のようにPCにに2台のキーボードを接続し、キーボードからの入力を購読したとします。<br>
しかし、両方のキーボードからの通知が同じ<code>OnNext</code>に来るので、どちらのキーボードからの入力なのか判別できません。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">class</span> <span class="nc">PC</span> <span class="p">:</span> <span class="n">IObserver</span><span class="p">&lt;</span><span class="n">KeyCode</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">KeyBoard</span> <span class="n">keyBoard1</span><span class="p">,</span> <span class="n">keyBoard2</span><span class="p">;</span>
    <span class="k">public</span> <span class="nf">PC</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//例えば、2種類のキーボードからの通知を購読したとしても…</span>
        <span class="n">keyBoard1</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="n">keyBoard2</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnCompleted</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//省略</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnError</span><span class="p">(</span><span class="n">Exception</span> <span class="n">error</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//省略</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnNext</span><span class="p">(</span><span class="n">KeyCode</span> <span class="k">value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//両方ともここに通知がくるので、どちらのキーボードからの通知かわからない</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>これらの問題を解決するために、Rxには次に紹介する<code>Subject&lt;T&gt;</code>クラスが用意されています。</strong></p>

<h3>
<span id="subjecttクラス" class="fragment"></span><a href="#subjectt%E3%82%AF%E3%83%A9%E3%82%B9"><i class="fa fa-link"></i></a><code>Subject&lt;T&gt;</code>クラス</h3>

<p><code>Subject&lt;T&gt;</code>クラスは、 <strong><code>IObservable&lt;T&gt;</code>インターフェイスと<code>IObserver&lt;T&gt;</code>インターフェイスを両方実装したクラス</strong> です。<br>
つまり、<code>Subject&lt;T&gt;</code>は、「値を受け取る機能」と「値を発行する機能」を併せ持ったクラス、ということになります。</p>

<p>これがどう役立つのかというと、ちょうど <strong>値の発行側と受け取り側の仲介役</strong> のような役割を果たしてくれます。</p>

<p><a href="https://camo.qiitausercontent.com/4cd24395b2c306df79b5b22861abf8507f07840c/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f317163337761726c7871667778356539666676663439373637776d30" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F1qc3warlxqfwx5e9ffvf49767wm0?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9b478536d03ea581c499e2531a9ee84d" alt="" data-canonical-src="https://storage.googleapis.com/zenn-user-upload/1qc3warlxqfwx5e9ffvf49767wm0" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F1qc3warlxqfwx5e9ffvf49767wm0?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3e22ccdd7b7f4349bffe0f47474f10ab 1x" loading="lazy"></a></p>

<h4>
<span id="observerとobservableの間に立つ仲介役" class="fragment"></span><a href="#observer%E3%81%A8observable%E3%81%AE%E9%96%93%E3%81%AB%E7%AB%8B%E3%81%A4%E4%BB%B2%E4%BB%8B%E5%BD%B9"><i class="fa fa-link"></i></a>ObserverとObservableの間に立つ仲介役</h4>

<p>今までのベタなObserverパターンでは、ObserverがObservableに自分自身を値の発行先として登録して、Observableは登録されたObserverに値を渡す…といったように、ObserverとObservableが直接繋がっていました。<br>
直接つながっているが故、お互いが言わば密結合のような状態になり、Observerは<code>Subscribe</code>したただ1種類の値しか受け取れないし、Observableも自分が発行する値をただひとつに定めなければなりませんでした。</p>

<p>そこへ、仲介役となる<code>Subject&lt;T&gt;</code>クラスを登場させることにより、互いの密結合を解消させることができます。<br>
しかも、<code>Subject&lt;T&gt;</code>クラスは<code>IObserver&lt;T&gt;</code>と<code>IObservable&lt;T&gt;</code>の機能を持っているので、<strong>もはや元の「値を受け取るクラス」と「値を発行するクラス」がそれらの機能を持つ必要はありません</strong>。<br>
<strong>購読者の管理、発行された値の通知といった煩雑な処理は、全部<code>Subject&lt;T&gt;</code>が担ってくれる</strong>ので、元のクラスはそのクラス本来の責務に専念することができるようになります。</p>

<p>しかも！<code>Subject&lt;T&gt;</code>クラスは完全に独立した存在なので、<strong>発行したい値のぶんだけ、好きなだけ仲介役を生成することができます</strong>！<br>
これによって、ベタなObserverパターンのデメリットとして挙げた「ただ一つの種類の値しか発行・購読ができない」を解消させる事が可能となります。</p>

<p>以下に<code>Subject&lt;T&gt;</code>クラスによる利点を整理しておきます。</p>

<ul>
<li>値を発行するクラス、値を受け取るクラスが<code>IObservable&lt;T&gt;</code>、<code>IObserver&lt;T&gt;</code>を実装しなくても良くなる</li>
<li>仲介役の役割をしてくれるので、値を発行するクラス、値を受け取るクラスが密結合しなくなる</li>
<li>好きなだけ仲介役を用意することで、何種類でも値の発行・受け取りが可能となる</li>
</ul>

<p>実際にどのように<code>Subject&lt;T&gt;</code>クラスを使用するのかは、「Rxを使ってみる」の章で説明します。</p>

<h3>
<span id="アクションを直接指定するsubscribeのオーバーロード" class="fragment"></span><a href="#%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E7%9B%B4%E6%8E%A5%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8Bsubscribe%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AD%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>アクションを直接指定する<code>Subscribe</code>のオーバーロード</h3>

<p><code>Subject&lt;T&gt;</code>クラスの登場により、値を受け取るクラスは<code>IObserver&lt;T&gt;</code>である必要がなくなりました。<br>
そのため、<strong><code>Subscribe</code>メソッドの引数で指定する<code>IObserver&lt;T&gt;</code>をどうするか</strong>という問題が発生します。</p>

<p>ここで、<code>IObserver&lt;T&gt;</code>インターフェイスの役割について考えてみると、ただ「値を受け取ったときに任意の処理を実行できる」ということでした。<br>
であれば、次のように任意の処理を直接指定できてもよいのでは？と考えることができます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">void</span> <span class="n">Subscribe</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>         <span class="n">onNext</span><span class="p">,</span>       <span class="c1">//OnNext時の処理を直接指定</span>
                  <span class="n">Action</span><span class="p">&lt;</span><span class="n">Exception</span><span class="p">&gt;</span> <span class="n">onError</span><span class="p">,</span>      <span class="c1">//OnError時の処理を直接指定</span>
                  <span class="n">Action</span>            <span class="n">onCompleted</span><span class="p">);</span> <span class="c1">//OnCompleted時の処理を直接指定</span>
</code></pre></div></div>

<p>Rxには、この<code>Subscribe</code>メソッドのオーバーロードが用意されているため、値を受け取るクラスは<code>IObserver&lt;T&gt;</code>である必要はなく、<strong>値を受け取ったときのコールバック処理を直接指定することができるようになっています</strong>。</p>

<p>実際にどのように<code>Subscribe</code>メソッドのオーバーロードを使用するのかは、「Rxを使ってみる」の章で説明します。</p>

<h2>
<span id="rxの環境構築" class="fragment"></span><a href="#rx%E3%81%AE%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89"><i class="fa fa-link"></i></a>Rxの環境構築</h2>

<p>Rxを使う前に、Rxを使えるように開発環境を用意する必要があります。<br>
とはいっても、大したことは有りません。</p>

<h3>
<span id="windowsアプリケーション開発の場合" class="fragment"></span><a href="#windows%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E9%96%8B%E7%99%BA%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>Windowsアプリケーション開発の場合</h3>

<p>VisualStudioによるWindowsアプリケーション開発の場合、VisualStudioのNuGetを使って<del><code>System.Reactive.Linq</code></del> <code>System.Reactive</code><sup id="fnref4"><a href="#fn4" title="@soi様より指摘いただきました。System.Reactive.Linqは互換性のために残っているパッケージだそうで、今はSystem.Reactiveをインストールすれば良いそうです。">4</a></sup>をインストールすれば完了です。<br>
<a href="https://camo.qiitausercontent.com/c9174fd26367844f939cb79aaa2bb4287a27c9b9/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f366338767a6e31726b7736733237633671646d30327a7a6c76783132" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F6c8vzn1rkw6s27c6qdm02zzlvx12?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=14e52a1f93e63b1fab1c8123e246a149" alt="" data-canonical-src="https://storage.googleapis.com/zenn-user-upload/6c8vzn1rkw6s27c6qdm02zzlvx12" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F6c8vzn1rkw6s27c6qdm02zzlvx12?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=20b3d2adce46ee401ea61ca00b73e606 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/9523b394f84800de92629537cdd7c01e85ed7e14/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f33776134696f7a397966376a356f387a36357a36326d366a33706c63" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F3wa4ioz9yf7j5o8z65z62m6j3plc?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8bfa54970d40b1e7fafead4bcaa834b8" alt="" data-canonical-src="https://storage.googleapis.com/zenn-user-upload/3wa4ioz9yf7j5o8z65z62m6j3plc" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F3wa4ioz9yf7j5o8z65z62m6j3plc?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ca98e3850c15785928f3707d50092958 1x" loading="lazy"></a><br>
↑画像は<code>System.Reactive.Linq</code>を指していますが、<code>System.Reactive</code>をインストールしてください。</p>

<h3>
<span id="unity開発の場合" class="fragment"></span><a href="#unity%E9%96%8B%E7%99%BA%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>Unity開発の場合</h3>

<p>Unity開発の場合はAssetStoreからUniRxをインストールすれば完了です。</p>

<h1>
<span id="rxを使ってみる" class="fragment"></span><a href="#rx%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>Rxを使ってみる</h1>

<p>それでは、<code>IObserver&lt;T&gt;</code>インターフェイス, <code>IObservable&lt;T&gt;</code>インターフェイス, <code>Subject&lt;T&gt;</code>クラス、<code>Subscribe</code>メソッドのオーバーロードについて理解したところで、実際にRxを使ってみます。</p>

<h2>
<span id="値を発行する方法" class="fragment"></span><a href="#%E5%80%A4%E3%82%92%E7%99%BA%E8%A1%8C%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>値を発行する方法</h2>

<p>値を発行したいクラスが値を発行するには以下のようにします。</p>

<ol>
<li>仲介役となる<code>Subject&lt;T&gt;</code>インスタンスをprivateフィールドで内部に持ちます</li>
<li>その<code>Subject&lt;T&gt;</code>を<code>IObservable&lt;T&gt;</code>で公開します</li>
<li>
<code>Subject&lt;T&gt;</code>に<code>OnNext</code>して値を発行します</li>
</ol>

<p>具体的なソースコードは以下のようになります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">//値を発行するクラス</span>
<span class="k">class</span> <span class="nc">PublishClass</span>
<span class="p">{</span>
    <span class="c1">//1. 仲介役となるSubject&lt;T&gt;インスタンスをprivateフィールドで内部に持ちます</span>
    <span class="k">private</span> <span class="n">Subject</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">m_someSubject</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Subject</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>

    <span class="c1">//2. そのSubject&lt;T&gt;をIObservable&lt;T&gt;で公開します</span>
    <span class="k">public</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">SomeObservable</span> <span class="p">=&gt;</span> <span class="n">m_someSubject</span><span class="p">.</span><span class="nf">AsObservable</span><span class="p">();</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">PublishValue</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//3. Subject&lt;T&gt;にOnNextして値を発行します</span>
        <span class="n">m_someSubject</span><span class="p">.</span><span class="nf">OnNext</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code>AsObservable</code>はなくても良いのですが、つけておくと<code>IObservable&lt;T&gt;</code>を<code>Subject&lt;T&gt;</code>にキャストされるのを防ぐことができます。</p>

<h2>
<span id="値を受け取る方法" class="fragment"></span><a href="#%E5%80%A4%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>値を受け取る方法</h2>

<p>値を受け取りたいクラスが値を受け取るには以下のようにします。</p>

<ol>
<li>値を発行するクラスのインスタンスを取得します</li>
<li>値を発行するクラスから公開された<code>IObservable&lt;T&gt;</code>インターフェイスの<code>Subscribe</code>メソッドを呼び出し、引数に値を受け取ったときの処理を指定します</li>
</ol>

<p>具体的なソースコードは以下のようになります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">class</span> <span class="nc">ReceiveClass</span>
<span class="p">{</span>
    <span class="c1">//1. 値を発行するクラスのインスタンスを取得します</span>
    <span class="k">private</span> <span class="n">PublishClass</span> <span class="n">publisher</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PublishClass</span><span class="p">();</span>

    <span class="k">public</span> <span class="nf">ReceiveClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//2. 値を発行するクラスから公開された`IObservable&lt;T&gt;`インターフェイスの`Subscribe`メソッドを呼び出し、引数に値を受け取ったときの処理を指定します</span>
        <span class="n">publisher</span><span class="p">.</span><span class="n">SomeObservable</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">n</span><span class="p">}</span><span class="s">を受け取りました"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="iobservabletはインターフェイス経由で引き渡すとreadonlyが保証される" class="fragment"></span><a href="#iobservablet%E3%81%AF%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E7%B5%8C%E7%94%B1%E3%81%A7%E5%BC%95%E3%81%8D%E6%B8%A1%E3%81%99%E3%81%A8readonly%E3%81%8C%E4%BF%9D%E8%A8%BC%E3%81%95%E3%82%8C%E3%82%8B"><i class="fa fa-link"></i></a><code>IObservable&lt;T&gt;</code>はインターフェイス経由で引き渡すとReadOnlyが保証される</h3>

<p>上記の例では、<code>ReceiveClass</code>が<code>PublishClass</code>のインスタンスを直接参照しています。<br>
この方法でももちろん値の受け取りは可能なのですが、下記のように<strong><code>IObservable&lt;T&gt;</code>を引き渡す専用のインターフェイス経由でアクセス</strong>するように設計すると、<strong><code>ReceiveClass</code>から<code>PublishClass</code>へのアクセスが読み取り専用であることが保証</strong>され<sup id="fnref5"><a href="#fn5" title="IObservable&lt;T&gt;はSubscribeのみができるインターフェイスなので、IObservable&lt;T&gt;は読み取り専用です。したがって、IObservable&lt;T&gt;しか公開しないインターフェイスは、読み取り専用となります。">5</a></sup>、より良い設計となります。</p>

<p><a href="https://camo.qiitausercontent.com/8b355cf6e3ec526f1b2b86153232620183e5582a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f35633132363936362d653630632d616438302d666364632d6532613966353738636264352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F5c126966-e60c-ad80-fcdc-e2a9f578cbd5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f35dd9b37dddc2efa89870add2f6513d" alt="a.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/5c126966-e60c-ad80-fcdc-e2a9f578cbd5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F5c126966-e60c-ad80-fcdc-e2a9f578cbd5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=66e6f20114e0d44d98fcf17b11a640d6 1x" loading="lazy"></a></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">//SomeObservableの購読を提供する読み取り専用インターフェイス</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IObservableSome</span>
<span class="p">{</span>
    <span class="n">IObservable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">SomeObservable</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">PublishClass</span> <span class="p">:</span> <span class="n">IObservableSome</span>
<span class="p">{</span>
    <span class="c1">//1. 仲介役となるSubject&lt;T&gt;インスタンスをprivateフィールドで内部に持ちます</span>
    <span class="k">private</span> <span class="n">Subject</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">m_someSubject</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Subject</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>

    <span class="c1">//2. そのSubject&lt;T&gt;をIObservable&lt;T&gt;で公開します</span>
    <span class="k">public</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">SomeObservable</span> <span class="p">=&gt;</span> <span class="n">m_someSubject</span><span class="p">.</span><span class="nf">AsObservable</span><span class="p">();</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">PublishValue</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//3. Subject&lt;T&gt;にOnNextして値を発行します</span>
        <span class="n">m_someSubject</span><span class="p">.</span><span class="nf">OnNext</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">ReceiveClass</span>
<span class="p">{</span>
    <span class="c1">//1. 値を発行するクラスのインスタンスを取得します</span>
    <span class="k">private</span> <span class="n">IObservableSome</span> <span class="n">publisher</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PublishClass</span><span class="p">();</span>

    <span class="k">public</span> <span class="nf">ReceiveClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//2. 値を発行するクラスから公開された`IObservable&lt;T&gt;`インターフェイスの`Subscribe`メソッドを呼び出し、引数に値を受け取ったときの処理を指定します</span>
        <span class="n">publisher</span><span class="p">.</span><span class="n">SomeObservable</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">n</span><span class="p">}</span><span class="s">を受け取りました"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>このように、値の購読のみが可能な読み取り専用インターフェイス経由でアクセスさせることで、<strong>例え<code>PublishClass</code>に読み取り専用ではないメンバが存在したとしても、<code>ReceiveClass</code>からは読み取り専用であることが保証される</strong>ため、保守性の向上に繋がります。</p>

<p>インターフェイスを利用する利点については、下記記事に詳しく記載していますので、適宜参照ください。</p>

<p><strong><a href="https://qiita.com/yutorisan/items/d28386f168f2f3ab166d" id="reference-4ca7be4bdad028035488">【C#】インターフェイスの利点が理解できない人は「インターフェイスには３つのタイプがある」ことを理解しよう</a></strong></p>

<h2>
<span id="linqを利用してデータを加工する方法" class="fragment"></span><a href="#linq%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8A%A0%E5%B7%A5%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>LINQを利用してデータを加工する方法</h2>

<p>ここからがRxの本領発揮です。<br>
これまで紹介した「値の発行・受け取り」は、C#標準のeventでも全く同じことができます。<br>
しかし、Rxを使うと、以下のようにLINQを利用して<strong>受け取ったデータを自分の都合の良いように自由に加工することができます</strong> 。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">publisher</span><span class="p">.</span><span class="n">SomeObservable</span>
         <span class="c1">//0以上の値に絞り込み</span>
         <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">n</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
         <span class="c1">//受け取った値を秒としてTimeSpan構造体を生成</span>
         <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
         <span class="c1">//TimeSpan構造体を購読</span>
         <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">time</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"受け取った値を秒とすると</span><span class="p">{</span><span class="n">time</span><span class="p">.</span><span class="n">TotalHours</span><span class="p">}</span><span class="s">時間です"</span><span class="p">));</span>
</code></pre></div></div>

<p>LINQオペレータが<code>IEnumerable&lt;T&gt;</code>を受け取って<code>IEnumerable&lt;T&gt;</code>を返すように、Rxオペレータも<code>IObservable&lt;T&gt;</code>を受け取って<code>IObservable&lt;T&gt;</code>を返すように設計されているため、このようなことが可能となります。</p>

<p>他にもいろいろなオペレータが用意されています。詳しくは <a href="/toRisouP" class="user-mention js-hovercard" title="toRisouP" data-hovercard-target-type="user" data-hovercard-target-name="toRisouP">@toRisouP</a>さんの下記のような記事が役立つと思いますので参照ください。</p>

<p><strong><a href="https://qiita.com/toRisouP/items/3cf1c9be3c37e7609a2f" id="reference-7c2e7afd7b8deba7aeac">UniRx オペレータ逆引き</a></strong></p>

<h2>
<span id="ファクトリメソッドを利用してイベントソースを簡単に生成する方法" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E7%B0%A1%E5%8D%98%E3%81%AB%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>ファクトリメソッドを利用してイベントソースを簡単に生成する方法</h2>

<p>今までは、自作クラスの内部に<code>Subject&lt;T&gt;</code>を持って値を発行したいタイミングで<code>OnNext</code>を行うように、<strong>「値の発行側」を自前で作っていました</strong>。<br>
しかしRxには、<strong>便利な「値の発行側」があらかじめ用意されています</strong>。これらは、<code>IObservable</code>を生成することから、「ファクトリメソッド」と呼ばれています。</p>

<p>ここでは、Rxに搭載されているいくつかのファクトリメソッドのうち、個人的にもっともよく使用する<code>Observable.Interval</code>ファクトリメソッドと<code>Observable.FromEvent</code>ファクトリメソッドを紹介します。</p>

<h3>
<span id="observableintervalファクトリメソッド" class="fragment"></span><a href="#observableinterval%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89"><i class="fa fa-link"></i></a><code>Observable.Interval</code>ファクトリメソッド</h3>

<p><code>Observable.Interval</code>ファクトリメソッドは、<strong>一定時間間隔で値を発行する<code>IObservable&lt;T&gt;</code>を生成するファクトリメソッド</strong>です。<br>
<strong>引数に<code>TimeSpan</code>構造体を入れるだけで、その指定した時間間隔で値を発行してくれる<code>IObservable&lt;T&gt;</code>が手に入ります。</strong><br>
発行される値は、0から順にインクリメントされたものになります。</p>

<p>次のように使用します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">Observable</span><span class="p">.</span><span class="nf">Interval</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">1</span><span class="p">))</span> <span class="c1">//1秒間隔で値を発行</span>
          <span class="p">.</span><span class="nf">Take</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>                           <span class="c1">//値を5回受け取る</span>
          <span class="p">.</span><span class="nf">Timestamp</span><span class="p">()</span>                       <span class="c1">//タイムスタンプを付加</span>
          <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Value:</span><span class="p">{</span><span class="n">t</span><span class="p">.</span><span class="n">Value</span><span class="p">}</span><span class="s"> Time:</span><span class="p">{</span><span class="n">t</span><span class="p">.</span><span class="n">Timestamp</span><span class="p">}</span><span class="s">"</span><span class="p">),</span>
                     <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"OnCompleted"</span><span class="p">));</span>
</code></pre></div></div>

<p>このコードを順に追って説明します。</p>

<ol>
<li>
<code>Observable.Interval(TimeSpan.FromSeconds(1))</code>で、1秒間隔で0,1,2,...と値を順番に発行する<code>IObservable</code>を作り出します。</li>
<li>
<code>Take(5)</code>で発行された値を5個だけ受け取り、その後OnCompletedするように設定します。</li>
<li>
<code>Timestamp()</code>で受け取ったときのタイムスタンプを付加します。<sup id="fnref6"><a href="#fn6" title="Timestamp()を通過すると、流れてきた値はTimestamped&lt;T&gt;という構造体にラップされます。この構造体はT型のValueプロパティとDateTimeOffset型のTimestampプロパティを持ち、それぞれラップされた値とタイムスタンプを取得できるようになっています。">6</a></sup>
</li>
<li>流れてきた値を購読して出力します。</li>
</ol>

<p>出力結果は次のようになります。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>Value:0 Time:2020/09/28 13:27:06 +00:00
Value:1 Time:2020/09/28 13:27:07 +00:00
Value:2 Time:2020/09/28 13:27:08 +00:00
Value:3 Time:2020/09/28 13:27:09 +00:00
Value:4 Time:2020/09/28 13:27:10 +00:00
OnCompleted
</code></pre></div></div>

<p>このように、1秒間隔で値が発行されていることがわかります。</p>

<p><code>Observable.Interval</code>ファクトリメソッドを使うと、このように簡単に一定時間間隔で値が発行される<code>IObservable&lt;T&gt;</code>を作り出すことができるので、一定周期で一位の処理を行いたい場合などに非常に便利です。</p>

<p>ちなみに、一定間隔ではなく「任意の時間間隔」で値を発行することもできます。<br>
少しやり方が複雑になるのですが、興味がある方は下記記事も参照ください。<br>
<strong><a href="https://qiita.com/yutorisan/items/3249e4d5aac5b7bd4189" id="reference-6b5fc00fd4e8d53559e6">【ReactiveExtensions】任意の時間間隔で値を発行する2つの方法</a></strong></p>

<h3>
<span id="observablefromeventファクトリメソッド" class="fragment"></span><a href="#observablefromevent%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89"><i class="fa fa-link"></i></a><code>Observable.FromEvent</code>ファクトリメソッド</h3>

<p><code>Observable.FromEvent</code>ファクトリメソッドは、その名の通り<strong>「C#標準のイベント」を<code>IObservable&lt;T&gt;</code>に変換するファクトリメソッド</strong>です。<br>
記事の冒頭で説明した<strong>「イベントのオブジェクト化」を実現するファクトリメソッド</strong>でもあります。</p>

<p>このファクトリメソッドを利用して、例えば<strong>クラスライブラリから提供されるeventを<code>IObservable&lt;T&gt;</code>に変換する</strong>ことで、LINQオペレータを適用する、eventのオブジェクト化により別のクラスに購読権を引き渡すといった、<strong>Rxの利点を活用する</strong>ことが可能になります。</p>

<p>例えば、<code>System.Windows.Forms.Button</code>の<code>Click</code>イベントを<code>IObservable&lt;Unit&gt;</code>に変換するには以下のようにします。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">IObservable</span><span class="p">&lt;</span><span class="n">Unit</span><span class="p">&gt;</span> <span class="n">clickEvent</span> <span class="p">=</span> 
    <span class="n">Observable</span><span class="p">.</span><span class="n">FromEvent</span><span class="p">&lt;</span><span class="n">EventHandler</span><span class="p">,</span> <span class="n">Unit</span><span class="p">&gt;(</span>
        <span class="n">h</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">eventargs</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nf">h</span><span class="p">(</span><span class="n">Unit</span><span class="p">.</span><span class="n">Default</span><span class="p">),</span>
        <span class="n">h</span> <span class="p">=&gt;</span> <span class="n">button1</span><span class="p">.</span><span class="n">Click</span> <span class="p">+=</span> <span class="n">h</span><span class="p">,</span>
        <span class="n">h</span> <span class="p">=&gt;</span> <span class="n">button1</span><span class="p">.</span><span class="n">Click</span> <span class="p">-=</span> <span class="n">h</span><span class="p">);</span> 
</code></pre></div></div>

<p>引数が複雑なのですが、簡単に書くと第一引数には「eventから発行された値をどのように<code>IObservable&lt;T&gt;</code>シーケンスに伝達するか」、第二引数には「<code>Subscribe</code>されたときの処理」、「第三引数には<code>Dispose</code>されたときの処理」を記述します。</p>

<p>本当はもう少し詳しく書きたいのですが、アドベントカレンダーの公開まで時間がないので割愛させていただきます（残り5時間あまり。。）</p>

<h3>
<span id="他にもいろいろなファクトリメソッド" class="fragment"></span><a href="#%E4%BB%96%E3%81%AB%E3%82%82%E3%81%84%E3%82%8D%E3%81%84%E3%82%8D%E3%81%AA%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89"><i class="fa fa-link"></i></a>他にもいろいろなファクトリメソッド</h3>

<p>Rxには他にも多数のファクトリメソッドが用意されています。</p>

<p>詳しくは、<a href="/okazuki" class="user-mention js-hovercard" title="okazuki" data-hovercard-target-type="user" data-hovercard-target-name="okazuki">@okazuki</a>さんの下記記事などを参考にすると良いと思います。<br>
<a href="https://blog.okazuki.jp/entry/20111104/1320409976" rel="nofollow noopener" target="_blank">Reactive Extensions再入門 その３「IObservableのファクトリメソッド」</a></p>

<h1>
<span id="rxを導入する利点まとめ" class="fragment"></span><a href="#rx%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B%E5%88%A9%E7%82%B9%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>Rxを導入する利点まとめ</h1>

<p>長くなってしまったので、以下にRxを導入する利点をまとめます。</p>

<h2>
<span id="可読性の向上" class="fragment"></span><a href="#%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A"><i class="fa fa-link"></i></a>可読性の向上</h2>

<p>Rxを導入するとソースコードの可読性の向上に繋がります。<br>
具体的には、次の2つの要因が可読性の向上に寄与します。</p>

<ol>
<li>LINQによる可読性の向上</li>
<li>イベント駆動型プログラミングによる可読性の向上</li>
</ol>

<h3>
<span id="linqによる可読性の向上" class="fragment"></span><a href="#linq%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A"><i class="fa fa-link"></i></a>LINQによる可読性の向上</h3>

<p>これはもう言わずもがなと思いますが、<strong>RxのLINQ機能を利用することで、可読性の向上が期待</strong>できます。</p>

<p>C#標準のイベントを使い続け、以下のようなコードになっていたら目も当てられません。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="kt">int</span> <span class="n">tmpValue</span><span class="p">;</span>

<span class="n">hogeClass</span><span class="p">.</span><span class="n">MogeEvent</span> <span class="p">+=</span> <span class="n">n</span> <span class="p">=&gt;</span> 
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">tmpValue</span> <span class="p">!=</span> <span class="n">n</span><span class="p">)</span> <span class="c1">//前回と値が変わっていたら</span>
    <span class="p">{</span>
        <span class="n">tmpValue</span> <span class="p">=</span> <span class="n">n</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="p">&gt;</span> <span class="m">100</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

<span class="n">hogeClass</span><span class="p">.</span><span class="n">FugaEvent</span> <span class="p">+=</span> <span class="n">n</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</code></pre></div></div>

<p>RxとLINQを利用すると、以下のように簡潔に分かりやすく記述できます。<br>
どちらが可読性が高いかは一目瞭然です。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">hogeClass</span><span class="p">.</span><span class="n">MogeObservable</span>
         <span class="c1">//前回と値が異なるものだけ通す</span>
         <span class="p">.</span><span class="nf">DistinctUntilChanged</span><span class="p">()</span>
         <span class="c1">//その中から100より大きいものに絞り込む</span>
         <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">n</span> <span class="p">&gt;</span> <span class="m">100</span><span class="p">)</span>
         <span class="c1">//FugaObservableと合成して次に流す</span>
         <span class="p">.</span><span class="nf">Merge</span><span class="p">(</span><span class="n">hogeClass</span><span class="p">.</span><span class="n">FugaObservable</span><span class="p">)</span>
         <span class="c1">//購読する</span>
         <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>
</code></pre></div></div>

<h3>
<span id="イベント駆動型プログラミングによる可読性の向上" class="fragment"></span><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E9%A7%86%E5%8B%95%E5%9E%8B%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A"><i class="fa fa-link"></i></a>イベント駆動型プログラミングによる可読性の向上</h3>

<p>Rxをプロジェクト全体に導入すると、自然とイベント駆動型のコーディングスタイルとなります。<br>
そのため、「<strong>情報を欲しい人が取りに行く</strong>」という自然なソースコードになるため、可読性の向上が期待できます。</p>

<p>例えば、「情報を持っているクラス」と「その情報がほしいクラス」があるとします。<br>
Rxを導入しない場合、「情報を必要とするクラス」は情報をもらう口となるようなメソッドを用意しておき、情報の獲得に関し受動的であるようなコードになることがあります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">//情報を持っているクラス</span>
<span class="k">class</span> <span class="nc">HaveInformationClass</span>
<span class="p">{</span>
    <span class="c1">//情報を受ける口を用意しておく。情報は受動的にもらう。</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">ReceiveInformation</span><span class="p">(</span><span class="n">Information</span> <span class="n">information</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//処理</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//情報を必要とするクラス</span>
<span class="k">class</span> <span class="nc">InformationRequiredClass</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">HaveInformationClass</span> <span class="n">destination</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Information</span> <span class="n">information</span><span class="p">;</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">SendInformation</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//「情報を必要とするクラス」が欲しい情報を渡しに行く</span>
        <span class="n">destination</span><span class="p">.</span><span class="nf">ReceiveInformation</span><span class="p">(</span><span class="n">information</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>しかし、このようなコーディングスタイルはいささか不自然に感じます。<br>
本来、「<strong>情報は必要とする人が取りに行く</strong>」というのが自然であると考えるからです。</p>

<p>Rxは、<strong>まさにこの「情報は必要とする人が取りに行く」コーディングスタイルが実現される</strong>ため、各クラスが自然な行動になり、可読性が向上します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">//情報を持っているクラス</span>
<span class="k">class</span> <span class="nc">HaveInformationClass</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">InformationRequiredClass</span> <span class="n">infoSource</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">HaveInformationClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//情報を必要とするクラスが能動的に貰いに行く</span>
        <span class="n">infoSource</span><span class="p">.</span><span class="n">ObservableInformation</span>
                  <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">info</span> <span class="p">=&gt;</span> <span class="cm">/* 処理 */</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//情報を必要とするクラス</span>
<span class="k">class</span> <span class="nc">InformationRequiredClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="n">Information</span><span class="p">&gt;</span> <span class="n">ObservableInformation</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">//--省略--</span>
<span class="p">}</span>
</code></pre></div></div>

<h2>
<span id="変更に強い" class="fragment"></span><a href="#%E5%A4%89%E6%9B%B4%E3%81%AB%E5%BC%B7%E3%81%84"><i class="fa fa-link"></i></a>変更に強い</h2>

<p>前項で紹介した「情報を欲しい人が取りに行く」という自然なコーディングスタイルは、変更に対しても強いです。</p>

<p>「情報を欲しい人」が情報の獲得に対し受動的なコーディングスタイルの場合、<strong>「情報を欲しい人」が増えた場合に、情報の発信元にも変更が必要</strong>になってきます。<br>
<a href="https://camo.qiitausercontent.com/180dba7a327640061d82a01c510afad466171683/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f30356438363864322d306537632d323631312d633039372d3430636337393532323235642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F05d868d2-0e7c-2611-c097-40cc7952225d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9b94570cc07bfe8883af58f4c8969e69" alt="Rxは変更に強い_変更が必要.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/05d868d2-0e7c-2611-c097-40cc7952225d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F05d868d2-0e7c-2611-c097-40cc7952225d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1fdef04685c81d4979f6c669385f755b 1x" loading="lazy"></a></p>

<p>ところが、「情報を欲しい人が取りに行く」場合、<strong>「情報を欲しい人」が増えたとしても、情報の発信側には何も影響がありません</strong>。<br>
<a href="https://camo.qiitausercontent.com/420f65988a3de3e18ace3885b83fc81898146136/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f38643939623336392d343362662d346363622d343932322d3463613636646536303134392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F8d99b369-43bf-4ccb-4922-4ca66de60149.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=039e09ef9c10251eacc621a039b528cb" alt="Rxは変更に強い_変更が不要.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/8d99b369-43bf-4ccb-4922-4ca66de60149.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F8d99b369-43bf-4ccb-4922-4ca66de60149.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d6c8861dd0646e00de6698ed69009242 1x" loading="lazy"></a></p>

<h2>
<span id="密結合を回避できる" class="fragment"></span><a href="#%E5%AF%86%E7%B5%90%E5%90%88%E3%82%92%E5%9B%9E%E9%81%BF%E3%81%A7%E3%81%8D%E3%82%8B"><i class="fa fa-link"></i></a>密結合を回避できる</h2>

<p>前述した通り、Rxを導入するとイベントを<code>IObservable&lt;T&gt;</code>オブジェクトとして扱えるようになります。<br>
<code>IObservable&lt;T&gt;</code>オブジェクトは「情報の購読権」として自由に引き渡しが可能であるため、<strong>情報の発信ソースを直接知らないクラスでも、<code>IObservable&lt;T&gt;</code>オブジェクトを引き渡すことで情報の購読が可能</strong>になります。</p>

<p><a href="https://camo.qiitausercontent.com/e69f0c8f3e23d4c0e37f3aae34f17b6f2f907ab6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f31623064636239622d636134622d363836632d396633302d3862323261376236356364312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F1b0dcb9b-ca4b-686c-9f30-8b22a7b65cd1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=84028bbc95a26d0398a6b2fd4b9b67e2" alt="aaa.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/1b0dcb9b-ca4b-686c-9f30-8b22a7b65cd1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F1b0dcb9b-ca4b-686c-9f30-8b22a7b65cd1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=09bcbf391f96ad9adcd4e4f255cacfb1 1x" loading="lazy"></a></p>

<p>Rxを導入しなかった場合、イベントをオブジェクトとして扱えないため、情報を購読するためには、<strong>その情報を発信しているクラスを直接知る必要</strong>が出てきます。<br>
それ故、<strong>本来関わる必要がなかったクラス同士が関わってしまい、クラス同士の結合度が高くなる恐れ</strong>があります。<br>
<a href="https://camo.qiitausercontent.com/26a84bd11d96748bb0697ae9d6069539c4c6ecb0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f66396163343634622d616365392d316131392d663365332d3531333631306239633632312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2Ff9ac464b-ace9-1a19-f3e3-513610b9c621.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5ed56e2ee20977d5212cc510bc2d003f" alt="bbb.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/f9ac464b-ace9-1a19-f3e3-513610b9c621.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2Ff9ac464b-ace9-1a19-f3e3-513610b9c621.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6ea1f93dd7edde8ad388509a2786ff39 1x" loading="lazy"></a></p>

<h2>
<span id="基礎部分だけなら学習コストも高くない" class="fragment"></span><a href="#%E5%9F%BA%E7%A4%8E%E9%83%A8%E5%88%86%E3%81%A0%E3%81%91%E3%81%AA%E3%82%89%E5%AD%A6%E7%BF%92%E3%82%B3%E3%82%B9%E3%83%88%E3%82%82%E9%AB%98%E3%81%8F%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>基礎部分だけなら、学習コストも高くない</h2>

<p>学習コストが高いと思われがちなRxですが、この記事で紹介したような「値の発行」「値の購読」「LINQの適用」などの基本的な部分だけならそこまで学習コストは高くありません。<br>
以下の通り再掲しておきます。</p>

<h3>
<span id="値の発行3ステップ" class="fragment"></span><a href="#%E5%80%A4%E3%81%AE%E7%99%BA%E8%A1%8C3%E3%82%B9%E3%83%86%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>「値の発行」3ステップ</h3>

<ol>
<li>仲介役となる<code>Subject&lt;T&gt;</code>インスタンスをprivateフィールドで内部に持ちます</li>
<li>その<code>Subject&lt;T&gt;</code>を<code>IObservable&lt;T&gt;</code>で公開します</li>
<li>
<code>Subject&lt;T&gt;</code>に<code>OnNext</code>して値を発行します</li>
</ol>

<h3>
<span id="値の購読2ステップ" class="fragment"></span><a href="#%E5%80%A4%E3%81%AE%E8%B3%BC%E8%AA%AD2%E3%82%B9%E3%83%86%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>「値の購読」2ステップ</h3>

<ol>
<li>値を発行するクラスのインスタンスを取得します</li>
<li>値を発行するクラスから公開された<code>IObservable&lt;T&gt;</code>インターフェイスの<code>Subscribe</code>メソッドを呼び出し、引数に値を受け取ったときの処理を指定します</li>
</ol>

<h3>
<span id="linqの適用" class="fragment"></span><a href="#linq%E3%81%AE%E9%81%A9%E7%94%A8"><i class="fa fa-link"></i></a>LINQの適用</h3>

<p><code>IEnumerable&lt;T&gt;</code>のLINQと全く同じように利用可能です。<br>
一部<code>IEnumerable&lt;T&gt;</code>にはあるけど<code>IObservable&lt;T&gt;</code>にはないオペレータや、その逆もありますが、調べながら使っていくうちにだんだん覚えていくと思われます。</p>

<h3>
<span id="使い込むならば踏み込んだ理解も必要" class="fragment"></span><a href="#%E4%BD%BF%E3%81%84%E8%BE%BC%E3%82%80%E3%81%AA%E3%82%89%E3%81%B0%E8%B8%8F%E3%81%BF%E8%BE%BC%E3%82%93%E3%81%A0%E7%90%86%E8%A7%A3%E3%82%82%E5%BF%85%E8%A6%81"><i class="fa fa-link"></i></a>使い込むならば踏み込んだ理解も必要</h3>

<p>ただ、Rxを本格的に使い込んでいくならば、<code>IObservable&lt;T&gt;</code>のHot-Coldの違いなど、少し踏み込んだ部分の理解も必要になってきます。<br>
この章で言いたいのは、「学習コストが高そう」という理由だけで、Rxを導入する多大なメリットを捨てないでほしいということです。</p>

<p>[追記]<br>
RxのHot-Cold関係の記事を書きましたので、Rxを少し使い慣れてきた頃にご覧ください！</p>

<p><qiita-embed-ogp src="https://qiita.com/yutorisan/items/844eaeab392abf03ce80"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/yutorisan/items/68bd68bbffe3c4f3ba32"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/yutorisan/items/fc566d8afe9ce9eb4f6d"></qiita-embed-ogp></p>

<h1>
<span id="さいごに" class="fragment"></span><a href="#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB"><i class="fa fa-link"></i></a>さいごに</h1>

<p>アドベントカレンダーの投稿期限ぎりぎりになってしまったため、最後駆け足な感じになってしまいましたが、Rxを導入する利点の説明になっているでしょうか。<br>
普段Rxを多用していますが、「なぜ、Rxを導入するべきなのか？」という点について、他人にきちんと説明できるかが不安で整理してみました。</p>

<p>色々ツッコミどころがあるかと思いますが、もしよければコメント残していただけると幸いです。</p>

<p>また、下記に参考にさせて頂いた記事、及びRxの理解に役立った記事のリンクを掲載させていただきます。</p>

<p><qiita-embed-ogp src="https://qiita.com/toRisouP/items/2f1643e344c741dd94f8"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/toRisouP/items/3cf1c9be3c37e7609a2f"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://blog.okazuki.jp/entry/20111104/1320409976"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/toRisouP/items/f6088963037bfda658d3"></qiita-embed-ogp></p>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p>「Rxはeventの完全上位互換」というフレーズは<a href="/toRisouP" class="user-mention js-hovercard" title="toRisouP" data-hovercard-target-type="user" data-hovercard-target-name="toRisouP">@toRisouP</a>さんの<a href="https://qiita.com/toRisouP/items/2f1643e344c741dd94f8">この記事</a>から学ばせていただきました。 <a href="#fnref1">↩</a></p>
</li>

<li id="fn2">
<p>イベント駆動型という表現が適切かどうかあまり自信がありません… <a href="#fnref2">↩</a></p>
</li>

<li id="fn3">
<p>Rxの利点をすべて利用しない（event標準機能だけで事足りる）ことが確定している場合はこの限りではありません。 <a href="#fnref3">↩</a></p>
</li>

<li id="fn4">
<p><a href="/soi" class="user-mention js-hovercard" title="soi" data-hovercard-target-type="user" data-hovercard-target-name="soi">@soi</a>様より指摘いただきました。<code>System.Reactive.Linq</code>は互換性のために残っているパッケージだそうで、今は<code>System.Reactive</code>をインストールすれば良いそうです。 <a href="#fnref4">↩</a></p>
</li>

<li id="fn5">
<p><code>IObservable&lt;T&gt;</code>は<code>Subscribe</code>のみができるインターフェイスなので、<code>IObservable&lt;T&gt;</code>は読み取り専用です。したがって、<code>IObservable&lt;T&gt;</code>しか公開しないインターフェイスは、読み取り専用となります。 <a href="#fnref5">↩</a></p>
</li>

<li id="fn6">
<p><code>Timestamp()</code>を通過すると、流れてきた値は<code>Timestamped&lt;T&gt;</code>という構造体にラップされます。この構造体は<code>T</code>型の<code>Value</code>プロパティと<code>DateTimeOffset</code>型の<code>Timestamp</code>プロパティを持ち、それぞれラップされた値とタイムスタンプを取得できるようになっています。 <a href="#fnref6">↩</a></p>
</li>

</ol>
</div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fyutorisan%2Fitems%2F2475eaf5d8c3a6454e3f&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fyutorisan%2Fitems%2F2475eaf5d8c3a6454e3f&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/likers" class="css-1iupg5d">95</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">85</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/2475eaf5d8c3a6454e3f/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yutorisan/items/2475eaf5d8c3a6454e3f/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yutorisan/items/2475eaf5d8c3a6454e3f.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-d1f22e5c-8a4d-4776-8a17-b774b736b567">{"authorAnalyticsTrackingId":"UA-135447292-3","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-8d085f5c-ede0-4682-9bb4-4891cb6be883"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-8d085f5c-ede0-4682-9bb4-4891cb6be883">{}</script>
      
<div id="LoginModal-react-component-703cfd5f-e00f-4286-b23a-9fd8b5f68cd7"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-703cfd5f-e00f-4286-b23a-9fd8b5f68cd7">{}</script>
      
<div id="StockModal-react-component-3fccb7cb-74cd-4b7e-930e-dd766037bfc1"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-3fccb7cb-74cd-4b7e-930e-dd766037bfc1">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;ZMEGuTJC/OoAbtN/exhis9aI7ItuVUouIYML3ERMnLuZWV0GiXN4HfuBmf89MR5BDVwe6X+vX70rhCgO/i+EGw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eこの記事は \u003ca href=\"https://qiita.com/advent-calendar/2020/csharplang\"\u003eC# Advent Calendar 2020\u003c/a\u003e 21日目の記事です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e僕はとある会社で働いているのですが、頑なにReactiveExtensions（以下Rx）に拒否反応を示す先輩がいます。\u003cbr\u003e\nRxの使い方と導入の利点を説明したのですが、なかなか理解してもらえず…。\u003cbr\u003e\nそこで自分自身もRxの利点をきちんと理解し、胸を張って説明できるのか？と不安になってきたため、ここに整理してみます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"なぜrxを導入すると幸せになれるのか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AA%E3%81%9Crx%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B%E3%81%A8%E5%B9%B8%E3%81%9B%E3%81%AB%E3%81%AA%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eなぜRxを導入すると幸せになれるのか\u003c/h1\u003e\n\n\u003cp\u003eいきなり本題ですが、「なぜRxを導入すると幸せになれるのか」。\u003cbr\u003e\n幸せになれるというのはただのキャッチフレーズであり言いすぎですが、なぜRxを導入するべきなのか。\u003c/p\u003e\n\n\u003cp\u003eそれは、Rxとは\u003cstrong\u003eC#標準機能であるeventの完全上位互換\u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" title=\"「Rxはeventの完全上位互換」というフレーズは@toRisouPさんのこの記事から学ばせていただきました。\"\u003e1\u003c/a\u003e\u003c/sup\u003eとなる機能を提供するライブラリであるから\u003c/strong\u003eです。\u003c/p\u003e\n\n\u003cp\u003eつまり、Rxを導入すると標準のeventではできなかった、あんなことやこんなことが簡単にできるようになり、結果的に\u003cstrong\u003eソースコードの可読性・保守性が飛躍的に高める\u003c/strong\u003eことができます。\u003cbr\u003e\nまた、コード全体でRxを導入することで、イベント駆動型\u003csup id=\"fnref2\"\u003e\u003ca href=\"#fn2\" title=\"イベント駆動型という表現が適切かどうかあまり自信がありません…\"\u003e2\u003c/a\u003e\u003c/sup\u003eのコーディングスタイルとなり、結果的に\u003cstrong\u003eクラス同士が疎結合となるような設計\u003c/strong\u003eがしやすくなります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"rxがeventに比べて追加で提供する機能\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rx%E3%81%8Cevent%E3%81%AB%E6%AF%94%E3%81%B9%E3%81%A6%E8%BF%BD%E5%8A%A0%E3%81%A7%E6%8F%90%E4%BE%9B%E3%81%99%E3%82%8B%E6%A9%9F%E8%83%BD\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRxがeventに比べて追加で提供する機能\u003c/h2\u003e\n\n\u003cp\u003eここで重要なのは、eventに対してRxが追加で提供する機能が、\u003cstrong\u003eとんでもなく強力である\u003c/strong\u003eということです。\u003cbr\u003e\n具体的には、eventに比べて以下のような機能が追加で提供されます。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eイベント発行値に対して多彩なLINQオペレータを適用\u003c/li\u003e\n\u003cli\u003eイベントのオブジェクト化\u003c/li\u003e\n\u003cli\u003e容易なイベント解除\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e一つずつ簡単な例を示します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"1イベント発行値に対してlinqオペレータを適用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E7%99%BA%E8%A1%8C%E5%80%A4%E3%81%AB%E5%AF%BE%E3%81%97%E3%81%A6linq%E3%82%AA%E3%83%9A%E3%83%AC%E3%83%BC%E3%82%BF%E3%82%92%E9%81%A9%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1.イベント発行値に対してLINQオペレータを適用\u003c/h3\u003e\n\n\u003cp\u003eこの機能がRxのメインというか、要となる機能です。\u003cbr\u003e\n\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003eでおなじみのLINQメソッド群を、ほぼそのままeventの発行値に対して適用することができます。\u003c/p\u003e\n\n\u003cp\u003e具体的には、以下のような事が可能になります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eeventPublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeIntEvent\u003c/span\u003e \u003cspan class=\"c1\"\u003e//Int型を発行する何らかのイベントに対して…\u003c/span\u003e\n              \u003cspan class=\"c1\"\u003e//発行された値のうち、偶数のものだけに絞り込み…\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"c1\"\u003e//それを文字列型に直して…\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003eが発行されました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"c1\"\u003e//購読する！\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eSubscribe\u003c/code\u003eというのは後で詳しく説明しますが、イベントを購読するという意味です。\u003cbr\u003e\n要は、発行されたイベントをそのまま購読するのではなく、\u003ccode\u003eWhere\u003c/code\u003eや\u003ccode\u003eSelect\u003c/code\u003eといったLINQメソッドチェーンを自由に適用し、都合の良い形に変形した上で、イベントを購読することができるというわけです。\u003c/p\u003e\n\n\u003cp\u003eこれを同じことをeventでやろうとすると、LINQメソッドチェーンが使用できないため、次のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eeventPublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeIntEvent\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003eが発行されました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eLINQメソッドチェーンを利用した場合に比べ、ひと目でなにをやっているのかを理解することができず、可読性が低くなっています。\u003cbr\u003e\nまた、LINQのように処理がブロックごとに分離されていないため、変更に対して弱いという欠点もあります。\u003c/p\u003e\n\n\u003cp\u003eこれは簡単な例なのでまだ良いのですが、複雑な処理になればなるほど、イベントの発行値に対してLINQオペレータが適用できるというRxの利点は、極めて大きく重要なものとなってきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"2イベントのオブジェクト化\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%8C%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2.イベントのオブジェクト化\u003c/h3\u003e\n\n\u003cp\u003eC#標準のeventはオブジェクトではないため、イベントを購読できる人はイベントに直接アクセスできる人だけとなります。\u003cbr\u003e\nところが、Rxの場合はイベントの購読権を\u003ccode\u003eIObservable\u003c/code\u003eというオブジェクトとして表現されるため、\u003cstrong\u003eイベントの購読権を自由に別のクラスに引き渡したり\u003c/strong\u003eすることができます。\u003c/p\u003e\n\n\u003cp\u003e具体例を見てみます。\u003cbr\u003e\nまず、標準のeventの場合。eventがオブジェクトではないため、\u003cstrong\u003eeventを購読できるのはそのイベントを発行するクラスのインスタンスを保持しているクラスのみ\u003c/strong\u003eとなります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEventPublisher\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//..中略..\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eevent\u003c/span\u003e \u003cspan class=\"n\"\u003eAction\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSomeEvent\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//..中略..\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//EventPublisherのインスタンスを直接保持しているクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHogeClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eEventPublisher\u003c/span\u003e \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eEventPublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eMogeClass\u003c/span\u003e \u003cspan class=\"n\"\u003emoge\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eHogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emoge\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//自分は当然イベント購読が可能\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeEvent\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 何らかの処理 */\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//EventPublisherのインスタンスを保持していないクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMogeClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//EventPublisherを保持していないので、EventPublisherが発行するイベントを購読できない\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次に、Rxの場合。\u003cbr\u003e\nRxの場合は購読する権利を\u003ccode\u003eIObservable\u003c/code\u003eというオブジェクトとして表現されるため、購読権を他のクラスに引き渡すことで、\u003cstrong\u003eイベントを発行するクラスのインスタンスを直接保持していなくてもイベントの購読が可能\u003c/strong\u003eとなります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEventPublisher\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//..中略..\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//..中略..\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//EventPublisherのインスタンスを直接保持しているクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHogeClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eEventPublisher\u003c/span\u003e \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eEventPublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eMogeClass\u003c/span\u003e \u003cspan class=\"n\"\u003emoge\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eHogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//MogeClassにイベントの購読権を引き渡す\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emoge\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//自分は当然イベント購読が可能\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 何らかの処理 */\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//EventPublisherのインスタンスを保持していないクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMogeClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eobservable\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//イベントの購読権を受けるようにする\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//取得した購読権を使用して、イベントを購読可能！\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eobservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 何らかの処理 */\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"3容易なイベントの解除\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3%E5%AE%B9%E6%98%93%E3%81%AA%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E8%A7%A3%E9%99%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3.容易なイベントの解除\u003c/h3\u003e\n\n\u003cp\u003eC#標準のイベントの場合、一度登録したイベントを解除するには\u003ccode\u003e-=\u003c/code\u003e演算子を利用して、登録したときと全く同じメソッドを指定する必要があります。\u003cbr\u003e\nつまり、\u003cstrong\u003eラムダ式を登録した場合は解除できなくなってしまう\u003c/strong\u003eのです。\u003c/p\u003e\n\n\u003cp\u003e一方、Rxの場合は\u003cstrong\u003e\u003ccode\u003eSubscribe\u003c/code\u003eしたときに出てくる\u003ccode\u003eIDisposable\u003c/code\u003eを\u003ccode\u003eDispose\u003c/code\u003eするだけ\u003c/strong\u003eで済みます。\u003c/p\u003e\n\n\u003cp\u003e具体的には以下のような感じになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//イベント購読。購読時に解除用のIDisposableを取得する\u003c/span\u003e\n\u003cspan class=\"n\"\u003eIDisposable\u003c/span\u003e \u003cspan class=\"n\"\u003edisposable\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esomeObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 処理 */\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//..中略..\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//購読を解除したいときはIDisposableをDisposeするだけ\u003c/span\u003e\n\u003cspan class=\"n\"\u003edisposable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eRxでは、イベントの購読権が\u003ccode\u003eIObservable\u003c/code\u003eというオブジェクトとして表現されるのと同様に、\u003cstrong\u003eイベントの解除権も\u003ccode\u003eIDisposable\u003c/code\u003eというオブジェクトで表現される\u003c/strong\u003eこともポイントです。\u003cbr\u003e\n例えば、複数のイベントを購読して出てきた\u003ccode\u003eIDisposable\u003c/code\u003eを\u003ccode\u003eList\u003c/code\u003eにためておき、後でまとめて購読解除するといったことも容易に実現可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//購読解除用IDisposableをためておくList\u003c/span\u003e\n\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIDisposable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edisposables\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIDisposable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//イベントを複数購読し、出てきたIDisposableをためておく\u003c/span\u003e\n\u003cspan class=\"n\"\u003edisposables\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobservable1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 処理 */\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003edisposables\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobservable2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 処理 */\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003edisposables\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobservable3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 処理 */\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//..中略..\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//購読解除したいときに一気に購読解除\u003c/span\u003e\n\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edisposable\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edisposables\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edisposable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eちなみに、上記のようなことが容易に行える\u003ccode\u003eCompositeDisposable\u003c/code\u003eクラスや\u003ccode\u003eAddTo\u003c/code\u003eメソッドもあります。詳しくはググってみてください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"rxはどのような場面で役立つのか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rx%E3%81%AF%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AA%E5%A0%B4%E9%9D%A2%E3%81%A7%E5%BD%B9%E7%AB%8B%E3%81%A4%E3%81%AE%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRxはどのような場面で役立つのか\u003c/h1\u003e\n\n\u003cp\u003eこのように様々な利点があるRxですが、どのような場面で利用できる・効果を発揮するのでしょうか？\u003cbr\u003e\n大きく分けて、次の２つの場面で役立てることができると考えています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"1クラス間でメッセージのやり取りを行いたいとき\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%93%E3%81%A7%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%84%E3%82%8A%E5%8F%96%E3%82%8A%E3%82%92%E8%A1%8C%E3%81%84%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1.クラス間でメッセージのやり取りを行いたいとき\u003c/h2\u003e\n\n\u003cp\u003e１つ目は、クラス間でメッセージ（データ）のやり取りを行いたい場面です。\u003cbr\u003e\nこれはつまるところ、\u003cstrong\u003eeventの代わりとして利用できます\u003c/strong\u003eという意味です。\u003cbr\u003e\nRxはeventの完全上位互換なので当然ですね。\u003c/p\u003e\n\n\u003cp\u003eすでに説明したように、Rxはeventに比べて非常に強力な機能が追加で利用できるため、わざわざeventを利用する意味はありません\u003csup id=\"fnref3\"\u003e\u003ca href=\"#fn3\" title=\"Rxの利点をすべて利用しない（event標準機能だけで事足りる）ことが確定している場合はこの限りではありません。\"\u003e3\u003c/a\u003e\u003c/sup\u003e。Rxを使いましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"2ある時間間隔で一定の処理を行いたい場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2%E3%81%82%E3%82%8B%E6%99%82%E9%96%93%E9%96%93%E9%9A%94%E3%81%A7%E4%B8%80%E5%AE%9A%E3%81%AE%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%84%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2.ある時間間隔で一定の処理を行いたい場合\u003c/h2\u003e\n\n\u003cp\u003e２つ目は、一定、または不定の時間間隔である処理を行いたい場合です。\u003cbr\u003e\nいわゆるタイマー処理です。Rxはこの場合にも、その威力を存分に発揮します。\u003c/p\u003e\n\n\u003cp\u003eというのも、Rxには一定、または不定の時間間隔でイベント（\u003ccode\u003eIObservable\u003c/code\u003e）を発行するクラスを生成するファクトリメソッドが、予め用意されているのです。\u003cbr\u003e\nそのため、時間間隔で何かをしたい場合、利用者はただ、その用意されたファクトリメソッドを呼び出し、イベントを購読して処理を登録するだけで済みます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eSystem.Windows.Forms.Timer\u003c/code\u003eとか\u003ccode\u003eSystem.Threading.Timer\u003c/code\u003eは不要です。Unityの場合は\u003ccode\u003eTime.deltaTime\u003c/code\u003eをアレコレしたり、\u003ccode\u003eWaitForSecounds\u003c/code\u003eをどうこうする必要はもうありません。\u003c/p\u003e\n\n\u003cp\u003e具体的には後で説明しますが、簡単に書くと次のように非常に簡潔に一定の時間間隔で処理を行うことができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInterval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"100msごとにメッセージが表示されるよ！\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eやっていることとしては「『一定間隔でイベントを発行するクラス』からのメッセージを受け取って一定の処理を実行する」のと同じであるため、本質的には「1.クラス間でメッセージのやり取りを行いたいとき」に帰着します。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"rxを使う上で最低限必要な知識\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rx%E3%82%92%E4%BD%BF%E3%81%86%E4%B8%8A%E3%81%A7%E6%9C%80%E4%BD%8E%E9%99%90%E5%BF%85%E8%A6%81%E3%81%AA%E7%9F%A5%E8%AD%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRxを使う上で最低限必要な知識\u003c/h1\u003e\n\n\u003cp\u003eRxの利点と使い所がわかったところで、実際にどのように使うのかを説明したいところですが、その前にRxを使用する上で最低限必要な知識をここで紹介します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"observerパターン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#observer%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eObserverパターン\u003c/h2\u003e\n\n\u003cp\u003eRxはデザインパターンの一つである\u003cstrong\u003eObserverパターン\u003c/strong\u003e が基礎になっています。\u003c/p\u003e\n\n\u003cp\u003eObserverパターンについて詳しく知りたい方は、別記事を書きましたので↓を参照してください。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://qiita.com/yutorisan/items/6e960426da71b7e02af7\" id=\"reference-6d0aff97d7d3fce00195\"\u003eC#でObserverパターンをきちんと理解して実装する\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eところが、実際にRxを使う上ではObserverパターンそのものを意識する必要はあまりありません。\u003cbr\u003e\nその上で、どうしてもRxを使う上で必要となる次の3つのクラスとインターフェイス、それから\u003ccode\u003eSubscribe\u003c/code\u003eメソッドのオーバーロードについて簡単に説明していきます。\u003cbr\u003e\n※一部↑の記事と内容が重複しています\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイス\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイス\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラス\u003c/li\u003e\n\u003cli\u003eアクションを直接受け取る\u003ccode\u003eSubscribe\u003c/code\u003eメソッドのオーバーロード\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e※この記事では必要最低限の解説のみ行います。詳しい説明は↑の記事を参照ください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"iobservertインターフェイス\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#iobservert%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイス\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスは、\u003cstrong\u003e発行された値を受け取るクラス\u003c/strong\u003eが実装するインターフェイスです。\u003c/p\u003e\n\n\u003cp\u003e定義は次のようになっています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIObserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 値を通知する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"value\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnNext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e    \n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 例外が発生したことを通知する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 値の発行がすべて完了したことを通知する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnCompleted\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eに値を通知したい人は、この\u003cstrong\u003e\u003ccode\u003eOnNext\u003c/code\u003eメソッドの引数に通知したい値を乗せて呼び出す\u003c/strong\u003eことで、値を通知することができます。\u003cbr\u003e\nまた、「もう発行する値がない」ことを伝える\u003ccode\u003eOnCompleted\u003c/code\u003eメソッドや、値の発行元で何らかの例外が発生してしまったことを伝える\u003ccode\u003eOnError\u003c/code\u003eメソッドも用意されています。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"iobservabletインターフェイス\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#iobservablet%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイス\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスは、\u003cstrong\u003e値を発行するクラス\u003c/strong\u003eが実装するインターフェイスです。\u003c/p\u003e\n\n\u003cp\u003e定義は次のようになっています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 値を購読する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"observer\"\u0026gt;値の発行先\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eIDisposable\u003c/span\u003e \u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIObserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eobserver\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e    \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのクラスが発行する値を受け取りたいクラスは、この\u003cstrong\u003e\u003ccode\u003eSubscribe\u003c/code\u003eメソッドに自分自身を引数で引き渡して呼び出す\u003c/strong\u003eことで、発行先として登録することができます。\u003cbr\u003e\n※値を受け取るクラスは\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eである必要があります\u003c/p\u003e\n\n\u003cp\u003e発行先の\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eを受け取ったObservableなクラスは、値を発行するタイミングで、受け取った\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eを\u003ccode\u003eOnNext\u003c/code\u003eすることによって、値を通知することができます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/69ae5f2cd9c51fceb57cda9a4f3a5966919bbae7/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f6171396d61656d7171396963667873757576646d74726b6b386a6c71\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2Faq9maemqq9icfxsuuvdmtrkk8jlq?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=eede8429eb3c535e9ba9331d4be16218\" alt=\"\" data-canonical-src=\"https://storage.googleapis.com/zenn-user-upload/aq9maemqq9icfxsuuvdmtrkk8jlq\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2Faq9maemqq9icfxsuuvdmtrkk8jlq?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9ab1ee0ef60acb42d3bc9087e8ad18c9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここまでが、\u003cstrong\u003eベタなObserverパターン\u003c/strong\u003eの\u003cstrong\u003e簡易的な説明\u003c/strong\u003eになります。\u003cbr\u003e\n繰り返しになりますが、きちんとObserverパターンを理解したい場合は下記記事を参照ください。\u003cbr\u003e\n\u003cstrong\u003e\u003ca href=\"https://qiita.com/yutorisan/items/6e960426da71b7e02af7\"\u003eC#でObserverパターンをきちんと理解して実装する\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ベタなobserverパターンの問題点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%99%E3%82%BF%E3%81%AAobserver%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eベタなObserverパターンの問題点\u003c/h4\u003e\n\n\u003cp\u003eベタなObserverパターンでも値の発行と受け取りは可能なのですが、次のような問題が発生してしまい使い勝手が悪いです。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e値を発行する側は、同じ型の値を複数種類発行できない。\u003c/li\u003e\n\u003cli\u003e値を受け取る側も同様に、同じ型の値を複数種類購読できない。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"1値を発行する側は同じ型の値を複数種類発行できない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1%E5%80%A4%E3%82%92%E7%99%BA%E8%A1%8C%E3%81%99%E3%82%8B%E5%81%B4%E3%81%AF%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%80%A4%E3%82%92%E8%A4%87%E6%95%B0%E7%A8%AE%E9%A1%9E%E7%99%BA%E8%A1%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1.値を発行する側は、同じ型の値を複数種類発行できない。\u003c/h5\u003e\n\n\u003cp\u003e値を発行する側のクラスは、同じ型の値を複数種類発行することができません。\u003c/p\u003e\n\n\u003cp\u003e例えば「キーボード」を例にとって考えてみます。\u003cbr\u003e\nキーボードは、押されたキーをPCに送信します。このとき、同時押しを考慮すると、「押されたキー」だけではなく「離されたキー」の情報もPCに送信しなければなりません。\u003cbr\u003e\nつまり、「押されたキー」「離されたキー」の２種類の値をPCに発行したいことになります。\u003c/p\u003e\n\n\u003cp\u003eこれをそのまま実装しようと思っても、、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eKeyBoard\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eKeyCode\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIObserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eKeyCode\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003em_observer\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//値の発行先を受け取る\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIDisposable\u003c/span\u003e \u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIObserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eKeyCode\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eobserver\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_observer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eobserver\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//Disposeの処理は省略\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//キーを謳歌されたときの処理\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnPushDown\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeyCode\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyCode\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//押下されたキーを通知する\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_observer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnNext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyCode\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//押されたキーが離されたときの処理\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnPushUp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeyCode\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyCode\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//m_observer.OnNextすると押下通知を混ざってしまう\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのように、押下されたキーの通知と、押下状態を解除されたキーの通知が混ざってしまい、それぞれを分けて通知することができません。\u003c/p\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"2値を受け取る側も同様に同じ型の値を複数種類購読できない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2%E5%80%A4%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B%E5%81%B4%E3%82%82%E5%90%8C%E6%A7%98%E3%81%AB%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%80%A4%E3%82%92%E8%A4%87%E6%95%B0%E7%A8%AE%E9%A1%9E%E8%B3%BC%E8%AA%AD%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2.値を受け取る側も同様に、同じ型の値を複数種類購読できない。\u003c/h5\u003e\n\n\u003cp\u003eこの問題は受け取る側（Observer側）にも発生します。\u003cbr\u003e\n理由は、\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスを複数個実装できないため、受け取り口が同じになってしまい、これまたすべての通知が混ざってしまうからです。\u003c/p\u003e\n\n\u003cp\u003e例えば、次のようにPCにに2台のキーボードを接続し、キーボードからの入力を購読したとします。\u003cbr\u003e\nしかし、両方のキーボードからの通知が同じ\u003ccode\u003eOnNext\u003c/code\u003eに来るので、どちらのキーボードからの入力なのか判別できません。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePC\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIObserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eKeyCode\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eKeyBoard\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyBoard1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyBoard2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003ePC\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//例えば、2種類のキーボードからの通知を購読したとしても…\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ekeyBoard1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ekeyBoard2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnCompleted\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//省略\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//省略\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnNext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKeyCode\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//両方ともここに通知がくるので、どちらのキーボードからの通知かわからない\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eこれらの問題を解決するために、Rxには次に紹介する\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスが用意されています。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"subjecttクラス\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#subjectt%E3%82%AF%E3%83%A9%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラス\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスは、 \u003cstrong\u003e\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスと\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスを両方実装したクラス\u003c/strong\u003e です。\u003cbr\u003e\nつまり、\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eは、「値を受け取る機能」と「値を発行する機能」を併せ持ったクラス、ということになります。\u003c/p\u003e\n\n\u003cp\u003eこれがどう役立つのかというと、ちょうど \u003cstrong\u003e値の発行側と受け取り側の仲介役\u003c/strong\u003e のような役割を果たしてくれます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4cd24395b2c306df79b5b22861abf8507f07840c/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f317163337761726c7871667778356539666676663439373637776d30\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F1qc3warlxqfwx5e9ffvf49767wm0?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9b478536d03ea581c499e2531a9ee84d\" alt=\"\" data-canonical-src=\"https://storage.googleapis.com/zenn-user-upload/1qc3warlxqfwx5e9ffvf49767wm0\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F1qc3warlxqfwx5e9ffvf49767wm0?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3e22ccdd7b7f4349bffe0f47474f10ab 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"observerとobservableの間に立つ仲介役\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#observer%E3%81%A8observable%E3%81%AE%E9%96%93%E3%81%AB%E7%AB%8B%E3%81%A4%E4%BB%B2%E4%BB%8B%E5%BD%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eObserverとObservableの間に立つ仲介役\u003c/h4\u003e\n\n\u003cp\u003e今までのベタなObserverパターンでは、ObserverがObservableに自分自身を値の発行先として登録して、Observableは登録されたObserverに値を渡す…といったように、ObserverとObservableが直接繋がっていました。\u003cbr\u003e\n直接つながっているが故、お互いが言わば密結合のような状態になり、Observerは\u003ccode\u003eSubscribe\u003c/code\u003eしたただ1種類の値しか受け取れないし、Observableも自分が発行する値をただひとつに定めなければなりませんでした。\u003c/p\u003e\n\n\u003cp\u003eそこへ、仲介役となる\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスを登場させることにより、互いの密結合を解消させることができます。\u003cbr\u003e\nしかも、\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスは\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eと\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eの機能を持っているので、\u003cstrong\u003eもはや元の「値を受け取るクラス」と「値を発行するクラス」がそれらの機能を持つ必要はありません\u003c/strong\u003e。\u003cbr\u003e\n\u003cstrong\u003e購読者の管理、発行された値の通知といった煩雑な処理は、全部\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eが担ってくれる\u003c/strong\u003eので、元のクラスはそのクラス本来の責務に専念することができるようになります。\u003c/p\u003e\n\n\u003cp\u003eしかも！\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスは完全に独立した存在なので、\u003cstrong\u003e発行したい値のぶんだけ、好きなだけ仲介役を生成することができます\u003c/strong\u003e！\u003cbr\u003e\nこれによって、ベタなObserverパターンのデメリットとして挙げた「ただ一つの種類の値しか発行・購読ができない」を解消させる事が可能となります。\u003c/p\u003e\n\n\u003cp\u003e以下に\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスによる利点を整理しておきます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e値を発行するクラス、値を受け取るクラスが\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003e、\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eを実装しなくても良くなる\u003c/li\u003e\n\u003cli\u003e仲介役の役割をしてくれるので、値を発行するクラス、値を受け取るクラスが密結合しなくなる\u003c/li\u003e\n\u003cli\u003e好きなだけ仲介役を用意することで、何種類でも値の発行・受け取りが可能となる\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e実際にどのように\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスを使用するのかは、「Rxを使ってみる」の章で説明します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アクションを直接指定するsubscribeのオーバーロード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E7%9B%B4%E6%8E%A5%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8Bsubscribe%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AD%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアクションを直接指定する\u003ccode\u003eSubscribe\u003c/code\u003eのオーバーロード\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラスの登場により、値を受け取るクラスは\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eである必要がなくなりました。\u003cbr\u003e\nそのため、\u003cstrong\u003e\u003ccode\u003eSubscribe\u003c/code\u003eメソッドの引数で指定する\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eをどうするか\u003c/strong\u003eという問題が発生します。\u003c/p\u003e\n\n\u003cp\u003eここで、\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスの役割について考えてみると、ただ「値を受け取ったときに任意の処理を実行できる」ということでした。\u003cbr\u003e\nであれば、次のように任意の処理を直接指定できてもよいのでは？と考えることができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eAction\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e         \u003cspan class=\"n\"\u003eonNext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e       \u003cspan class=\"c1\"\u003e//OnNext時の処理を直接指定\u003c/span\u003e\n                  \u003cspan class=\"n\"\u003eAction\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eonError\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e      \u003cspan class=\"c1\"\u003e//OnError時の処理を直接指定\u003c/span\u003e\n                  \u003cspan class=\"n\"\u003eAction\u003c/span\u003e            \u003cspan class=\"n\"\u003eonCompleted\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//OnCompleted時の処理を直接指定\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eRxには、この\u003ccode\u003eSubscribe\u003c/code\u003eメソッドのオーバーロードが用意されているため、値を受け取るクラスは\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eである必要はなく、\u003cstrong\u003e値を受け取ったときのコールバック処理を直接指定することができるようになっています\u003c/strong\u003e。\u003c/p\u003e\n\n\u003cp\u003e実際にどのように\u003ccode\u003eSubscribe\u003c/code\u003eメソッドのオーバーロードを使用するのかは、「Rxを使ってみる」の章で説明します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"rxの環境構築\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rx%E3%81%AE%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRxの環境構築\u003c/h2\u003e\n\n\u003cp\u003eRxを使う前に、Rxを使えるように開発環境を用意する必要があります。\u003cbr\u003e\nとはいっても、大したことは有りません。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"windowsアプリケーション開発の場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#windows%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E9%96%8B%E7%99%BA%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWindowsアプリケーション開発の場合\u003c/h3\u003e\n\n\u003cp\u003eVisualStudioによるWindowsアプリケーション開発の場合、VisualStudioのNuGetを使って\u003cdel\u003e\u003ccode\u003eSystem.Reactive.Linq\u003c/code\u003e\u003c/del\u003e \u003ccode\u003eSystem.Reactive\u003c/code\u003e\u003csup id=\"fnref4\"\u003e\u003ca href=\"#fn4\" title=\"@soi様より指摘いただきました。System.Reactive.Linqは互換性のために残っているパッケージだそうで、今はSystem.Reactiveをインストールすれば良いそうです。\"\u003e4\u003c/a\u003e\u003c/sup\u003eをインストールすれば完了です。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/c9174fd26367844f939cb79aaa2bb4287a27c9b9/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f366338767a6e31726b7736733237633671646d30327a7a6c76783132\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F6c8vzn1rkw6s27c6qdm02zzlvx12?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=14e52a1f93e63b1fab1c8123e246a149\" alt=\"\" data-canonical-src=\"https://storage.googleapis.com/zenn-user-upload/6c8vzn1rkw6s27c6qdm02zzlvx12\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F6c8vzn1rkw6s27c6qdm02zzlvx12?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=20b3d2adce46ee401ea61ca00b73e606 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/9523b394f84800de92629537cdd7c01e85ed7e14/68747470733a2f2f73746f726167652e676f6f676c65617069732e636f6d2f7a656e6e2d757365722d75706c6f61642f33776134696f7a397966376a356f387a36357a36326d366a33706c63\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F3wa4ioz9yf7j5o8z65z62m6j3plc?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8bfa54970d40b1e7fafead4bcaa834b8\" alt=\"\" data-canonical-src=\"https://storage.googleapis.com/zenn-user-upload/3wa4ioz9yf7j5o8z65z62m6j3plc\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fstorage.googleapis.com%2Fzenn-user-upload%2F3wa4ioz9yf7j5o8z65z62m6j3plc?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ca98e3850c15785928f3707d50092958 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n↑画像は\u003ccode\u003eSystem.Reactive.Linq\u003c/code\u003eを指していますが、\u003ccode\u003eSystem.Reactive\u003c/code\u003eをインストールしてください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"unity開発の場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unity%E9%96%8B%E7%99%BA%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUnity開発の場合\u003c/h3\u003e\n\n\u003cp\u003eUnity開発の場合はAssetStoreからUniRxをインストールすれば完了です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"rxを使ってみる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rx%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRxを使ってみる\u003c/h1\u003e\n\n\u003cp\u003eそれでは、\u003ccode\u003eIObserver\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイス, \u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイス, \u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eクラス、\u003ccode\u003eSubscribe\u003c/code\u003eメソッドのオーバーロードについて理解したところで、実際にRxを使ってみます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"値を発行する方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%80%A4%E3%82%92%E7%99%BA%E8%A1%8C%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e値を発行する方法\u003c/h2\u003e\n\n\u003cp\u003e値を発行したいクラスが値を発行するには以下のようにします。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e仲介役となる\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eインスタンスをprivateフィールドで内部に持ちます\u003c/li\u003e\n\u003cli\u003eその\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eを\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eで公開します\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eに\u003ccode\u003eOnNext\u003c/code\u003eして値を発行します\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e具体的なソースコードは以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//値を発行するクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePublishClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//1. 仲介役となるSubject\u0026lt;T\u0026gt;インスタンスをprivateフィールドで内部に持ちます\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003em_someSubject\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//2. そのSubject\u0026lt;T\u0026gt;をIObservable\u0026lt;T\u0026gt;で公開します\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003em_someSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAsObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003ePublishValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//3. Subject\u0026lt;T\u0026gt;にOnNextして値を発行します\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_someSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnNext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eAsObservable\u003c/code\u003eはなくても良いのですが、つけておくと\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eを\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eにキャストされるのを防ぐことができます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"値を受け取る方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%80%A4%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e値を受け取る方法\u003c/h2\u003e\n\n\u003cp\u003e値を受け取りたいクラスが値を受け取るには以下のようにします。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e値を発行するクラスのインスタンスを取得します\u003c/li\u003e\n\u003cli\u003e値を発行するクラスから公開された\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスの\u003ccode\u003eSubscribe\u003c/code\u003eメソッドを呼び出し、引数に値を受け取ったときの処理を指定します\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e具体的なソースコードは以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eReceiveClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//1. 値を発行するクラスのインスタンスを取得します\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003ePublishClass\u003c/span\u003e \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePublishClass\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eReceiveClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//2. 値を発行するクラスから公開された`IObservable\u0026lt;T\u0026gt;`インターフェイスの`Subscribe`メソッドを呼び出し、引数に値を受け取ったときの処理を指定します\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003eを受け取りました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"iobservabletはインターフェイス経由で引き渡すとreadonlyが保証される\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#iobservablet%E3%81%AF%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E7%B5%8C%E7%94%B1%E3%81%A7%E5%BC%95%E3%81%8D%E6%B8%A1%E3%81%99%E3%81%A8readonly%E3%81%8C%E4%BF%9D%E8%A8%BC%E3%81%95%E3%82%8C%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eはインターフェイス経由で引き渡すとReadOnlyが保証される\u003c/h3\u003e\n\n\u003cp\u003e上記の例では、\u003ccode\u003eReceiveClass\u003c/code\u003eが\u003ccode\u003ePublishClass\u003c/code\u003eのインスタンスを直接参照しています。\u003cbr\u003e\nこの方法でももちろん値の受け取りは可能なのですが、下記のように\u003cstrong\u003e\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eを引き渡す専用のインターフェイス経由でアクセス\u003c/strong\u003eするように設計すると、\u003cstrong\u003e\u003ccode\u003eReceiveClass\u003c/code\u003eから\u003ccode\u003ePublishClass\u003c/code\u003eへのアクセスが読み取り専用であることが保証\u003c/strong\u003eされ\u003csup id=\"fnref5\"\u003e\u003ca href=\"#fn5\" title=\"IObservable\u0026lt;T\u0026gt;はSubscribeのみができるインターフェイスなので、IObservable\u0026lt;T\u0026gt;は読み取り専用です。したがって、IObservable\u0026lt;T\u0026gt;しか公開しないインターフェイスは、読み取り専用となります。\"\u003e5\u003c/a\u003e\u003c/sup\u003e、より良い設計となります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/8b355cf6e3ec526f1b2b86153232620183e5582a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f35633132363936362d653630632d616438302d666364632d6532613966353738636264352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F5c126966-e60c-ad80-fcdc-e2a9f578cbd5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f35dd9b37dddc2efa89870add2f6513d\" alt=\"a.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/5c126966-e60c-ad80-fcdc-e2a9f578cbd5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F5c126966-e60c-ad80-fcdc-e2a9f578cbd5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=66e6f20114e0d44d98fcf17b11a640d6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//SomeObservableの購読を提供する読み取り専用インターフェイス\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIObservableSome\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePublishClass\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIObservableSome\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//1. 仲介役となるSubject\u0026lt;T\u0026gt;インスタンスをprivateフィールドで内部に持ちます\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003em_someSubject\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//2. そのSubject\u0026lt;T\u0026gt;をIObservable\u0026lt;T\u0026gt;で公開します\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003em_someSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAsObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003ePublishValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//3. Subject\u0026lt;T\u0026gt;にOnNextして値を発行します\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_someSubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnNext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eReceiveClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//1. 値を発行するクラスのインスタンスを取得します\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIObservableSome\u003c/span\u003e \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePublishClass\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eReceiveClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//2. 値を発行するクラスから公開された`IObservable\u0026lt;T\u0026gt;`インターフェイスの`Subscribe`メソッドを呼び出し、引数に値を受け取ったときの処理を指定します\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003eを受け取りました\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのように、値の購読のみが可能な読み取り専用インターフェイス経由でアクセスさせることで、\u003cstrong\u003e例え\u003ccode\u003ePublishClass\u003c/code\u003eに読み取り専用ではないメンバが存在したとしても、\u003ccode\u003eReceiveClass\u003c/code\u003eからは読み取り専用であることが保証される\u003c/strong\u003eため、保守性の向上に繋がります。\u003c/p\u003e\n\n\u003cp\u003eインターフェイスを利用する利点については、下記記事に詳しく記載していますので、適宜参照ください。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://qiita.com/yutorisan/items/d28386f168f2f3ab166d\" id=\"reference-4ca7be4bdad028035488\"\u003e【C#】インターフェイスの利点が理解できない人は「インターフェイスには３つのタイプがある」ことを理解しよう\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"linqを利用してデータを加工する方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#linq%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8A%A0%E5%B7%A5%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eLINQを利用してデータを加工する方法\u003c/h2\u003e\n\n\u003cp\u003eここからがRxの本領発揮です。\u003cbr\u003e\nこれまで紹介した「値の発行・受け取り」は、C#標準のeventでも全く同じことができます。\u003cbr\u003e\nしかし、Rxを使うと、以下のようにLINQを利用して\u003cstrong\u003e受け取ったデータを自分の都合の良いように自由に加工することができます\u003c/strong\u003e 。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003epublisher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSomeObservable\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//0以上の値に絞り込み\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//受け取った値を秒としてTimeSpan構造体を生成\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//TimeSpan構造体を購読\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"受け取った値を秒とすると\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTotalHours\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e時間です\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eLINQオペレータが\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003eを受け取って\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003eを返すように、Rxオペレータも\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eを受け取って\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eを返すように設計されているため、このようなことが可能となります。\u003c/p\u003e\n\n\u003cp\u003e他にもいろいろなオペレータが用意されています。詳しくは \u003ca href=\"/toRisouP\" class=\"user-mention js-hovercard\" title=\"toRisouP\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"toRisouP\"\u003e@toRisouP\u003c/a\u003eさんの下記のような記事が役立つと思いますので参照ください。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://qiita.com/toRisouP/items/3cf1c9be3c37e7609a2f\" id=\"reference-7c2e7afd7b8deba7aeac\"\u003eUniRx オペレータ逆引き\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ファクトリメソッドを利用してイベントソースを簡単に生成する方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E7%B0%A1%E5%8D%98%E3%81%AB%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファクトリメソッドを利用してイベントソースを簡単に生成する方法\u003c/h2\u003e\n\n\u003cp\u003e今までは、自作クラスの内部に\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eを持って値を発行したいタイミングで\u003ccode\u003eOnNext\u003c/code\u003eを行うように、\u003cstrong\u003e「値の発行側」を自前で作っていました\u003c/strong\u003e。\u003cbr\u003e\nしかしRxには、\u003cstrong\u003e便利な「値の発行側」があらかじめ用意されています\u003c/strong\u003e。これらは、\u003ccode\u003eIObservable\u003c/code\u003eを生成することから、「ファクトリメソッド」と呼ばれています。\u003c/p\u003e\n\n\u003cp\u003eここでは、Rxに搭載されているいくつかのファクトリメソッドのうち、個人的にもっともよく使用する\u003ccode\u003eObservable.Interval\u003c/code\u003eファクトリメソッドと\u003ccode\u003eObservable.FromEvent\u003c/code\u003eファクトリメソッドを紹介します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"observableintervalファクトリメソッド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#observableinterval%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eObservable.Interval\u003c/code\u003eファクトリメソッド\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eObservable.Interval\u003c/code\u003eファクトリメソッドは、\u003cstrong\u003e一定時間間隔で値を発行する\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eを生成するファクトリメソッド\u003c/strong\u003eです。\u003cbr\u003e\n\u003cstrong\u003e引数に\u003ccode\u003eTimeSpan\u003c/code\u003e構造体を入れるだけで、その指定した時間間隔で値を発行してくれる\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eが手に入ります。\u003c/strong\u003e\u003cbr\u003e\n発行される値は、0から順にインクリメントされたものになります。\u003c/p\u003e\n\n\u003cp\u003e次のように使用します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInterval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"c1\"\u003e//1秒間隔で値を発行\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTake\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e                           \u003cspan class=\"c1\"\u003e//値を5回受け取る\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTimestamp\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e                       \u003cspan class=\"c1\"\u003e//タイムスタンプを付加\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Value:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e Time:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTimestamp\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                     \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"OnCompleted\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのコードを順に追って説明します。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003eObservable.Interval(TimeSpan.FromSeconds(1))\u003c/code\u003eで、1秒間隔で0,1,2,...と値を順番に発行する\u003ccode\u003eIObservable\u003c/code\u003eを作り出します。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eTake(5)\u003c/code\u003eで発行された値を5個だけ受け取り、その後OnCompletedするように設定します。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eTimestamp()\u003c/code\u003eで受け取ったときのタイムスタンプを付加します。\u003csup id=\"fnref6\"\u003e\u003ca href=\"#fn6\" title=\"Timestamp()を通過すると、流れてきた値はTimestamped\u0026lt;T\u0026gt;という構造体にラップされます。この構造体はT型のValueプロパティとDateTimeOffset型のTimestampプロパティを持ち、それぞれラップされた値とタイムスタンプを取得できるようになっています。\"\u003e6\u003c/a\u003e\u003c/sup\u003e\n\u003c/li\u003e\n\u003cli\u003e流れてきた値を購読して出力します。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e出力結果は次のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eValue:0 Time:2020/09/28 13:27:06 +00:00\nValue:1 Time:2020/09/28 13:27:07 +00:00\nValue:2 Time:2020/09/28 13:27:08 +00:00\nValue:3 Time:2020/09/28 13:27:09 +00:00\nValue:4 Time:2020/09/28 13:27:10 +00:00\nOnCompleted\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのように、1秒間隔で値が発行されていることがわかります。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eObservable.Interval\u003c/code\u003eファクトリメソッドを使うと、このように簡単に一定時間間隔で値が発行される\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eを作り出すことができるので、一定周期で一位の処理を行いたい場合などに非常に便利です。\u003c/p\u003e\n\n\u003cp\u003eちなみに、一定間隔ではなく「任意の時間間隔」で値を発行することもできます。\u003cbr\u003e\n少しやり方が複雑になるのですが、興味がある方は下記記事も参照ください。\u003cbr\u003e\n\u003cstrong\u003e\u003ca href=\"https://qiita.com/yutorisan/items/3249e4d5aac5b7bd4189\" id=\"reference-6b5fc00fd4e8d53559e6\"\u003e【ReactiveExtensions】任意の時間間隔で値を発行する2つの方法\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"observablefromeventファクトリメソッド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#observablefromevent%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eObservable.FromEvent\u003c/code\u003eファクトリメソッド\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eObservable.FromEvent\u003c/code\u003eファクトリメソッドは、その名の通り\u003cstrong\u003e「C#標準のイベント」を\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eに変換するファクトリメソッド\u003c/strong\u003eです。\u003cbr\u003e\n記事の冒頭で説明した\u003cstrong\u003e「イベントのオブジェクト化」を実現するファクトリメソッド\u003c/strong\u003eでもあります。\u003c/p\u003e\n\n\u003cp\u003eこのファクトリメソッドを利用して、例えば\u003cstrong\u003eクラスライブラリから提供されるeventを\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eに変換する\u003c/strong\u003eことで、LINQオペレータを適用する、eventのオブジェクト化により別のクラスに購読権を引き渡すといった、\u003cstrong\u003eRxの利点を活用する\u003c/strong\u003eことが可能になります。\u003c/p\u003e\n\n\u003cp\u003e例えば、\u003ccode\u003eSystem.Windows.Forms.Button\u003c/code\u003eの\u003ccode\u003eClick\u003c/code\u003eイベントを\u003ccode\u003eIObservable\u0026lt;Unit\u0026gt;\u003c/code\u003eに変換するには以下のようにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eclickEvent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFromEvent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEventHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eh\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eeventargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eh\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebutton1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eClick\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eh\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebutton1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eClick\u003c/span\u003e \u003cspan class=\"p\"\u003e-=\u003c/span\u003e \u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e引数が複雑なのですが、簡単に書くと第一引数には「eventから発行された値をどのように\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eシーケンスに伝達するか」、第二引数には「\u003ccode\u003eSubscribe\u003c/code\u003eされたときの処理」、「第三引数には\u003ccode\u003eDispose\u003c/code\u003eされたときの処理」を記述します。\u003c/p\u003e\n\n\u003cp\u003e本当はもう少し詳しく書きたいのですが、アドベントカレンダーの公開まで時間がないので割愛させていただきます（残り5時間あまり。。）\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"他にもいろいろなファクトリメソッド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BB%96%E3%81%AB%E3%82%82%E3%81%84%E3%82%8D%E3%81%84%E3%82%8D%E3%81%AA%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e他にもいろいろなファクトリメソッド\u003c/h3\u003e\n\n\u003cp\u003eRxには他にも多数のファクトリメソッドが用意されています。\u003c/p\u003e\n\n\u003cp\u003e詳しくは、\u003ca href=\"/okazuki\" class=\"user-mention js-hovercard\" title=\"okazuki\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"okazuki\"\u003e@okazuki\u003c/a\u003eさんの下記記事などを参考にすると良いと思います。\u003cbr\u003e\n\u003ca href=\"https://blog.okazuki.jp/entry/20111104/1320409976\" rel=\"nofollow noopener\" target=\"_blank\"\u003eReactive Extensions再入門 その３「IObservableのファクトリメソッド」\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"rxを導入する利点まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rx%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B%E5%88%A9%E7%82%B9%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRxを導入する利点まとめ\u003c/h1\u003e\n\n\u003cp\u003e長くなってしまったので、以下にRxを導入する利点をまとめます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"可読性の向上\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e可読性の向上\u003c/h2\u003e\n\n\u003cp\u003eRxを導入するとソースコードの可読性の向上に繋がります。\u003cbr\u003e\n具体的には、次の2つの要因が可読性の向上に寄与します。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLINQによる可読性の向上\u003c/li\u003e\n\u003cli\u003eイベント駆動型プログラミングによる可読性の向上\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"linqによる可読性の向上\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#linq%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eLINQによる可読性の向上\u003c/h3\u003e\n\n\u003cp\u003eこれはもう言わずもがなと思いますが、\u003cstrong\u003eRxのLINQ機能を利用することで、可読性の向上が期待\u003c/strong\u003eできます。\u003c/p\u003e\n\n\u003cp\u003eC#標準のイベントを使い続け、以下のようなコードになっていたら目も当てられません。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003etmpValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ehogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMogeEvent\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etmpValue\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//前回と値が変わっていたら\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etmpValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ehogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFugaEvent\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eRxとLINQを利用すると、以下のように簡潔に分かりやすく記述できます。\u003cbr\u003e\nどちらが可読性が高いかは一目瞭然です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003ehogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMogeObservable\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//前回と値が異なるものだけ通す\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDistinctUntilChanged\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//その中から100より大きいものに絞り込む\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//FugaObservableと合成して次に流す\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehogeClass\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFugaObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//購読する\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"イベント駆動型プログラミングによる可読性の向上\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E9%A7%86%E5%8B%95%E5%9E%8B%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eイベント駆動型プログラミングによる可読性の向上\u003c/h3\u003e\n\n\u003cp\u003eRxをプロジェクト全体に導入すると、自然とイベント駆動型のコーディングスタイルとなります。\u003cbr\u003e\nそのため、「\u003cstrong\u003e情報を欲しい人が取りに行く\u003c/strong\u003e」という自然なソースコードになるため、可読性の向上が期待できます。\u003c/p\u003e\n\n\u003cp\u003e例えば、「情報を持っているクラス」と「その情報がほしいクラス」があるとします。\u003cbr\u003e\nRxを導入しない場合、「情報を必要とするクラス」は情報をもらう口となるようなメソッドを用意しておき、情報の獲得に関し受動的であるようなコードになることがあります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//情報を持っているクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHaveInformationClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//情報を受ける口を用意しておく。情報は受動的にもらう。\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eReceiveInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eInformation\u003c/span\u003e \u003cspan class=\"n\"\u003einformation\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//処理\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//情報を必要とするクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eInformationRequiredClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eHaveInformationClass\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eInformation\u003c/span\u003e \u003cspan class=\"n\"\u003einformation\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSendInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//「情報を必要とするクラス」が欲しい情報を渡しに行く\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReceiveInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einformation\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eしかし、このようなコーディングスタイルはいささか不自然に感じます。\u003cbr\u003e\n本来、「\u003cstrong\u003e情報は必要とする人が取りに行く\u003c/strong\u003e」というのが自然であると考えるからです。\u003c/p\u003e\n\n\u003cp\u003eRxは、\u003cstrong\u003eまさにこの「情報は必要とする人が取りに行く」コーディングスタイルが実現される\u003c/strong\u003eため、各クラスが自然な行動になり、可読性が向上します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//情報を持っているクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHaveInformationClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eInformationRequiredClass\u003c/span\u003e \u003cspan class=\"n\"\u003einfoSource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eHaveInformationClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//情報を必要とするクラスが能動的に貰いに行く\u003c/span\u003e\n        \u003cspan class=\"n\"\u003einfoSource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eObservableInformation\u003c/span\u003e\n                  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"cm\"\u003e/* 処理 */\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//情報を必要とするクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eInformationRequiredClass\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eObservableInformation\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//--省略--\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"変更に強い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%A4%89%E6%9B%B4%E3%81%AB%E5%BC%B7%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e変更に強い\u003c/h2\u003e\n\n\u003cp\u003e前項で紹介した「情報を欲しい人が取りに行く」という自然なコーディングスタイルは、変更に対しても強いです。\u003c/p\u003e\n\n\u003cp\u003e「情報を欲しい人」が情報の獲得に対し受動的なコーディングスタイルの場合、\u003cstrong\u003e「情報を欲しい人」が増えた場合に、情報の発信元にも変更が必要\u003c/strong\u003eになってきます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/180dba7a327640061d82a01c510afad466171683/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f30356438363864322d306537632d323631312d633039372d3430636337393532323235642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F05d868d2-0e7c-2611-c097-40cc7952225d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9b94570cc07bfe8883af58f4c8969e69\" alt=\"Rxは変更に強い_変更が必要.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/05d868d2-0e7c-2611-c097-40cc7952225d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F05d868d2-0e7c-2611-c097-40cc7952225d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1fdef04685c81d4979f6c669385f755b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eところが、「情報を欲しい人が取りに行く」場合、\u003cstrong\u003e「情報を欲しい人」が増えたとしても、情報の発信側には何も影響がありません\u003c/strong\u003e。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/420f65988a3de3e18ace3885b83fc81898146136/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f38643939623336392d343362662d346363622d343932322d3463613636646536303134392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F8d99b369-43bf-4ccb-4922-4ca66de60149.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=039e09ef9c10251eacc621a039b528cb\" alt=\"Rxは変更に強い_変更が不要.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/8d99b369-43bf-4ccb-4922-4ca66de60149.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F8d99b369-43bf-4ccb-4922-4ca66de60149.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d6c8861dd0646e00de6698ed69009242 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"密結合を回避できる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AF%86%E7%B5%90%E5%90%88%E3%82%92%E5%9B%9E%E9%81%BF%E3%81%A7%E3%81%8D%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e密結合を回避できる\u003c/h2\u003e\n\n\u003cp\u003e前述した通り、Rxを導入するとイベントを\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eオブジェクトとして扱えるようになります。\u003cbr\u003e\n\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eオブジェクトは「情報の購読権」として自由に引き渡しが可能であるため、\u003cstrong\u003e情報の発信ソースを直接知らないクラスでも、\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eオブジェクトを引き渡すことで情報の購読が可能\u003c/strong\u003eになります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e69f0c8f3e23d4c0e37f3aae34f17b6f2f907ab6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f31623064636239622d636134622d363836632d396633302d3862323261376236356364312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F1b0dcb9b-ca4b-686c-9f30-8b22a7b65cd1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=84028bbc95a26d0398a6b2fd4b9b67e2\" alt=\"aaa.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/1b0dcb9b-ca4b-686c-9f30-8b22a7b65cd1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2F1b0dcb9b-ca4b-686c-9f30-8b22a7b65cd1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=09bcbf391f96ad9adcd4e4f255cacfb1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRxを導入しなかった場合、イベントをオブジェクトとして扱えないため、情報を購読するためには、\u003cstrong\u003eその情報を発信しているクラスを直接知る必要\u003c/strong\u003eが出てきます。\u003cbr\u003e\nそれ故、\u003cstrong\u003e本来関わる必要がなかったクラス同士が関わってしまい、クラス同士の結合度が高くなる恐れ\u003c/strong\u003eがあります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/26a84bd11d96748bb0697ae9d6069539c4c6ecb0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3639373833302f66396163343634622d616365392d316131392d663365332d3531333631306239633632312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2Ff9ac464b-ace9-1a19-f3e3-513610b9c621.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5ed56e2ee20977d5212cc510bc2d003f\" alt=\"bbb.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/697830/f9ac464b-ace9-1a19-f3e3-513610b9c621.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F697830%2Ff9ac464b-ace9-1a19-f3e3-513610b9c621.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6ea1f93dd7edde8ad388509a2786ff39 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"基礎部分だけなら学習コストも高くない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9F%BA%E7%A4%8E%E9%83%A8%E5%88%86%E3%81%A0%E3%81%91%E3%81%AA%E3%82%89%E5%AD%A6%E7%BF%92%E3%82%B3%E3%82%B9%E3%83%88%E3%82%82%E9%AB%98%E3%81%8F%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e基礎部分だけなら、学習コストも高くない\u003c/h2\u003e\n\n\u003cp\u003e学習コストが高いと思われがちなRxですが、この記事で紹介したような「値の発行」「値の購読」「LINQの適用」などの基本的な部分だけならそこまで学習コストは高くありません。\u003cbr\u003e\n以下の通り再掲しておきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"値の発行3ステップ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%80%A4%E3%81%AE%E7%99%BA%E8%A1%8C3%E3%82%B9%E3%83%86%E3%83%83%E3%83%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e「値の発行」3ステップ\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003e仲介役となる\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eインスタンスをprivateフィールドで内部に持ちます\u003c/li\u003e\n\u003cli\u003eその\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eを\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eで公開します\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eSubject\u0026lt;T\u0026gt;\u003c/code\u003eに\u003ccode\u003eOnNext\u003c/code\u003eして値を発行します\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"値の購読2ステップ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%80%A4%E3%81%AE%E8%B3%BC%E8%AA%AD2%E3%82%B9%E3%83%86%E3%83%83%E3%83%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e「値の購読」2ステップ\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003e値を発行するクラスのインスタンスを取得します\u003c/li\u003e\n\u003cli\u003e値を発行するクラスから公開された\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eインターフェイスの\u003ccode\u003eSubscribe\u003c/code\u003eメソッドを呼び出し、引数に値を受け取ったときの処理を指定します\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"linqの適用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#linq%E3%81%AE%E9%81%A9%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eLINQの適用\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003eのLINQと全く同じように利用可能です。\u003cbr\u003e\n一部\u003ccode\u003eIEnumerable\u0026lt;T\u0026gt;\u003c/code\u003eにはあるけど\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eにはないオペレータや、その逆もありますが、調べながら使っていくうちにだんだん覚えていくと思われます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"使い込むならば踏み込んだ理解も必要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%BF%E3%81%84%E8%BE%BC%E3%82%80%E3%81%AA%E3%82%89%E3%81%B0%E8%B8%8F%E3%81%BF%E8%BE%BC%E3%82%93%E3%81%A0%E7%90%86%E8%A7%A3%E3%82%82%E5%BF%85%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e使い込むならば踏み込んだ理解も必要\u003c/h3\u003e\n\n\u003cp\u003eただ、Rxを本格的に使い込んでいくならば、\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eのHot-Coldの違いなど、少し踏み込んだ部分の理解も必要になってきます。\u003cbr\u003e\nこの章で言いたいのは、「学習コストが高そう」という理由だけで、Rxを導入する多大なメリットを捨てないでほしいということです。\u003c/p\u003e\n\n\u003cp\u003e[追記]\u003cbr\u003e\nRxのHot-Cold関係の記事を書きましたので、Rxを少し使い慣れてきた頃にご覧ください！\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/yutorisan/items/844eaeab392abf03ce80\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/yutorisan/items/68bd68bbffe3c4f3ba32\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/yutorisan/items/fc566d8afe9ce9eb4f6d\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"さいごに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eさいごに\u003c/h1\u003e\n\n\u003cp\u003eアドベントカレンダーの投稿期限ぎりぎりになってしまったため、最後駆け足な感じになってしまいましたが、Rxを導入する利点の説明になっているでしょうか。\u003cbr\u003e\n普段Rxを多用していますが、「なぜ、Rxを導入するべきなのか？」という点について、他人にきちんと説明できるかが不安で整理してみました。\u003c/p\u003e\n\n\u003cp\u003e色々ツッコミどころがあるかと思いますが、もしよければコメント残していただけると幸いです。\u003c/p\u003e\n\n\u003cp\u003eまた、下記に参考にさせて頂いた記事、及びRxの理解に役立った記事のリンクを掲載させていただきます。\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/toRisouP/items/2f1643e344c741dd94f8\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/toRisouP/items/3cf1c9be3c37e7609a2f\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://blog.okazuki.jp/entry/20111104/1320409976\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/toRisouP/items/f6088963037bfda658d3\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003e「Rxはeventの完全上位互換」というフレーズは\u003ca href=\"/toRisouP\" class=\"user-mention js-hovercard\" title=\"toRisouP\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"toRisouP\"\u003e@toRisouP\u003c/a\u003eさんの\u003ca href=\"https://qiita.com/toRisouP/items/2f1643e344c741dd94f8\"\u003eこの記事\u003c/a\u003eから学ばせていただきました。 \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn2\"\u003e\n\u003cp\u003eイベント駆動型という表現が適切かどうかあまり自信がありません… \u003ca href=\"#fnref2\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn3\"\u003e\n\u003cp\u003eRxの利点をすべて利用しない（event標準機能だけで事足りる）ことが確定している場合はこの限りではありません。 \u003ca href=\"#fnref3\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn4\"\u003e\n\u003cp\u003e\u003ca href=\"/soi\" class=\"user-mention js-hovercard\" title=\"soi\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"soi\"\u003e@soi\u003c/a\u003e様より指摘いただきました。\u003ccode\u003eSystem.Reactive.Linq\u003c/code\u003eは互換性のために残っているパッケージだそうで、今は\u003ccode\u003eSystem.Reactive\u003c/code\u003eをインストールすれば良いそうです。 \u003ca href=\"#fnref4\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn5\"\u003e\n\u003cp\u003e\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eは\u003ccode\u003eSubscribe\u003c/code\u003eのみができるインターフェイスなので、\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eは読み取り専用です。したがって、\u003ccode\u003eIObservable\u0026lt;T\u0026gt;\u003c/code\u003eしか公開しないインターフェイスは、読み取り専用となります。 \u003ca href=\"#fnref5\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn6\"\u003e\n\u003cp\u003e\u003ccode\u003eTimestamp()\u003c/code\u003eを通過すると、流れてきた値は\u003ccode\u003eTimestamped\u0026lt;T\u0026gt;\u003c/code\u003eという構造体にラップされます。この構造体は\u003ccode\u003eT\u003c/code\u003e型の\u003ccode\u003eValue\u003c/code\u003eプロパティと\u003ccode\u003eDateTimeOffset\u003c/code\u003e型の\u003ccode\u003eTimestamp\u003c/code\u003eプロパティを持ち、それぞれラップされた値とタイムスタンプを取得できるようになっています。 \u003ca href=\"#fnref6\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","createdAt":"2020-12-20T16:33:17Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"Ah/0E4S0KJBJGqD4K6M4vuieoo5UKBqKnA==--j0Z+MFUlI3hNN5vV--NdH26jAegSnP/1JO9KaS9w==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2021-04-07T16:08:15Z","likesCount":95,"linkUrl":"https://qiita.com/yutorisan/items/2475eaf5d8c3a6454e3f","organization":null,"originalId":1363220,"stockedCount":85,"title":"【C#】なぜReactiveExtensionsを導入すると幸せになれるのか","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AA%E3%81%9Crx%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B%E3%81%A8%E5%B9%B8%E3%81%9B%E3%81%AB%E3%81%AA%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8B\"\u003eなぜRxを導入すると幸せになれるのか\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#rx%E3%81%8Cevent%E3%81%AB%E6%AF%94%E3%81%B9%E3%81%A6%E8%BF%BD%E5%8A%A0%E3%81%A7%E6%8F%90%E4%BE%9B%E3%81%99%E3%82%8B%E6%A9%9F%E8%83%BD\"\u003eRxがeventに比べて追加で提供する機能\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E7%99%BA%E8%A1%8C%E5%80%A4%E3%81%AB%E5%AF%BE%E3%81%97%E3%81%A6linq%E3%82%AA%E3%83%9A%E3%83%AC%E3%83%BC%E3%82%BF%E3%82%92%E9%81%A9%E7%94%A8\"\u003e1.イベント発行値に対してLINQオペレータを適用\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%8C%96\"\u003e2.イベントのオブジェクト化\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#3%E5%AE%B9%E6%98%93%E3%81%AA%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E8%A7%A3%E9%99%A4\"\u003e3.容易なイベントの解除\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rx%E3%81%AF%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AA%E5%A0%B4%E9%9D%A2%E3%81%A7%E5%BD%B9%E7%AB%8B%E3%81%A4%E3%81%AE%E3%81%8B\"\u003eRxはどのような場面で役立つのか\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%93%E3%81%A7%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%84%E3%82%8A%E5%8F%96%E3%82%8A%E3%82%92%E8%A1%8C%E3%81%84%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D\"\u003e1.クラス間でメッセージのやり取りを行いたいとき\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2%E3%81%82%E3%82%8B%E6%99%82%E9%96%93%E9%96%93%E9%9A%94%E3%81%A7%E4%B8%80%E5%AE%9A%E3%81%AE%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%84%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88\"\u003e2.ある時間間隔で一定の処理を行いたい場合\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rx%E3%82%92%E4%BD%BF%E3%81%86%E4%B8%8A%E3%81%A7%E6%9C%80%E4%BD%8E%E9%99%90%E5%BF%85%E8%A6%81%E3%81%AA%E7%9F%A5%E8%AD%98\"\u003eRxを使う上で最低限必要な知識\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#observer%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003eObserverパターン\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#iobservert%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9\"\u003eIObserver\u0026lt;T\u0026gt;インターフェイス\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#iobservablet%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9\"\u003eIObservable\u0026lt;T\u0026gt;インターフェイス\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%99%E3%82%BF%E3%81%AAobserver%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9\"\u003eベタなObserverパターンの問題点\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1%E5%80%A4%E3%82%92%E7%99%BA%E8%A1%8C%E3%81%99%E3%82%8B%E5%81%B4%E3%81%AF%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%80%A4%E3%82%92%E8%A4%87%E6%95%B0%E7%A8%AE%E9%A1%9E%E7%99%BA%E8%A1%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003e1.値を発行する側は、同じ型の値を複数種類発行できない。\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2%E5%80%A4%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B%E5%81%B4%E3%82%82%E5%90%8C%E6%A7%98%E3%81%AB%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%80%A4%E3%82%92%E8%A4%87%E6%95%B0%E7%A8%AE%E9%A1%9E%E8%B3%BC%E8%AA%AD%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84\"\u003e2.値を受け取る側も同様に、同じ型の値を複数種類購読できない。\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#subjectt%E3%82%AF%E3%83%A9%E3%82%B9\"\u003eSubject\u0026lt;T\u0026gt;クラス\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#observer%E3%81%A8observable%E3%81%AE%E9%96%93%E3%81%AB%E7%AB%8B%E3%81%A4%E4%BB%B2%E4%BB%8B%E5%BD%B9\"\u003eObserverとObservableの間に立つ仲介役\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E7%9B%B4%E6%8E%A5%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8Bsubscribe%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AD%E3%83%BC%E3%83%89\"\u003eアクションを直接指定するSubscribeのオーバーロード\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rx%E3%81%AE%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\"\u003eRxの環境構築\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#windows%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E9%96%8B%E7%99%BA%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eWindowsアプリケーション開発の場合\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#unity%E9%96%8B%E7%99%BA%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eUnity開発の場合\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rx%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B\"\u003eRxを使ってみる\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%80%A4%E3%82%92%E7%99%BA%E8%A1%8C%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003e値を発行する方法\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%80%A4%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B%E6%96%B9%E6%B3%95\"\u003e値を受け取る方法\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#iobservablet%E3%81%AF%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E7%B5%8C%E7%94%B1%E3%81%A7%E5%BC%95%E3%81%8D%E6%B8%A1%E3%81%99%E3%81%A8readonly%E3%81%8C%E4%BF%9D%E8%A8%BC%E3%81%95%E3%82%8C%E3%82%8B\"\u003eIObservable\u0026lt;T\u0026gt;はインターフェイス経由で引き渡すとReadOnlyが保証される\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#linq%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8A%A0%E5%B7%A5%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003eLINQを利用してデータを加工する方法\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E7%B0%A1%E5%8D%98%E3%81%AB%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003eファクトリメソッドを利用してイベントソースを簡単に生成する方法\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#observableinterval%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003eObservable.Intervalファクトリメソッド\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#observablefromevent%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003eObservable.FromEventファクトリメソッド\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BB%96%E3%81%AB%E3%82%82%E3%81%84%E3%82%8D%E3%81%84%E3%82%8D%E3%81%AA%E3%83%95%E3%82%A1%E3%82%AF%E3%83%88%E3%83%AA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003e他にもいろいろなファクトリメソッド\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rx%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B%E5%88%A9%E7%82%B9%E3%81%BE%E3%81%A8%E3%82%81\"\u003eRxを導入する利点まとめ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003e可読性の向上\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#linq%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003eLINQによる可読性の向上\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E9%A7%86%E5%8B%95%E5%9E%8B%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%AF%E8%AA%AD%E6%80%A7%E3%81%AE%E5%90%91%E4%B8%8A\"\u003eイベント駆動型プログラミングによる可読性の向上\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%A4%89%E6%9B%B4%E3%81%AB%E5%BC%B7%E3%81%84\"\u003e変更に強い\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AF%86%E7%B5%90%E5%90%88%E3%82%92%E5%9B%9E%E9%81%BF%E3%81%A7%E3%81%8D%E3%82%8B\"\u003e密結合を回避できる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9F%BA%E7%A4%8E%E9%83%A8%E5%88%86%E3%81%A0%E3%81%91%E3%81%AA%E3%82%89%E5%AD%A6%E7%BF%92%E3%82%B3%E3%82%B9%E3%83%88%E3%82%82%E9%AB%98%E3%81%8F%E3%81%AA%E3%81%84\"\u003e基礎部分だけなら、学習コストも高くない\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%80%A4%E3%81%AE%E7%99%BA%E8%A1%8C3%E3%82%B9%E3%83%86%E3%83%83%E3%83%97\"\u003e「値の発行」3ステップ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%80%A4%E3%81%AE%E8%B3%BC%E8%AA%AD2%E3%82%B9%E3%83%86%E3%83%83%E3%83%97\"\u003e「値の購読」2ステップ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#linq%E3%81%AE%E9%81%A9%E7%94%A8\"\u003eLINQの適用\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%BF%E3%81%84%E8%BE%BC%E3%82%80%E3%81%AA%E3%82%89%E3%81%B0%E8%B8%8F%E3%81%BF%E8%BE%BC%E3%82%93%E3%81%A0%E7%90%86%E8%A7%A3%E3%82%82%E5%BF%85%E8%A6%81\"\u003e使い込むならば踏み込んだ理解も必要\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"\u003eさいごに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":9531,"uuid":"2475eaf5d8c3a6454e3f","banReason":null,"adventCalendarItem":{"day":21,"calendar":{"name":"C#","urlName":"csharplang","year":2020,"organization":null}},"author":{"encryptedId":"63NEuJSGJY7vPHLrWcm4m/kyXnKN--9aEDZMnvDRX3USaz--6RoqgY6iLsWECUdP0iUM1w==","originalId":697830,"description":"C#が好きです","facebookUrl":null,"githubUrl":"https://github.com/yutorisan","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://pbs.twimg.com/profile_images/1274400166120812544/DAWcpHec_bigger.jpg","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fpbs.twimg.com%2Fprofile_images%2F1274400166120812544%2FDAWcpHec_bigger.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=b517115d0e848c54aa4fe1fc93bfa0ff","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fpbs.twimg.com%2Fprofile_images%2F1274400166120812544%2FDAWcpHec_bigger.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=754be610f489085be0fdfc48de5585a9","urlName":"yutorisan","websiteUrl":"","twitterUrl":"https://twitter.com/yutorisan19","twitterUrlName":"yutorisan19","revealedOrganizations":{"edges":[{"node":{"encryptedId":"smipRNT/YM0DfSbmI2y4LJZgKgNO04h3NAs=--ktGNkIkyD7svF1We--i+cZ6BBfYQuB7MShpEVgDg==","isBetaReleaseEnabled":false,"isFollowableByViewer":false,"isFollowedByViewer":false,"name":"Unityゲーム開発者ギルド","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/f7eb993765ddcdb2c5e6890556c43ea3de8fbfb7/original.jpg?1570215690","urlName":"unity-game-dev-guild","description":"趣味・仕事問わずUnityでゲームを作っている開発者のみで構成されるオンラインコミュニティです。Unityでゲームを開発・運用するにあたって必要なあらゆる知見を共有することを目的とします。","url":"https://unity-game-dev-guild.github.io/"}}]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"ReactiveExtensions","urlName":"reactiveextensions"},{"name":"UniRx","urlName":"unirx"}],"followingLikers":{"edges":[]},"comments":{"totalCount":5}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
