More than 1 year has passed since last update.DataGridViewのセルにカーソルを合わせたときに表示されるToolTipの見た目のカスタマイズ方法です。
カスタマイズ後のイメージが以下になります。
ToolTipにはセルのX、Y座標とセルの値を表示しています。
背景を黒で塗りつぶして文字と枠線を白にしています。
さらにフォントもデフォルトより大きくしています。ToolTipコントロールを作成し、OwnerDraw、ShowAlwaysプロパティにtrueを設定します。
Draw、Popupにイベントを設定します。
ここまではデザイナを使用して行っても構いません。次にDataGridViewのtoolTip変数に作成したToolTipコントロールを設定します。
DataGridViewのtoolTipはプロパティが無いので、GetFieldメソッドやSetValueメソッドを使用して設定しています。CellFormattingイベントでセルのToolTipTextプロパティに表示させたい内容を設定します。
今回はセルのX、Y座標とセルの値を設定しています。フォントを変更すると表示領域のサイズも変化する可能性があるため、PopupイベントでToolTipのサイズを設定します。DrawイベントでToolTipの描画部分を記述します。
塗りつぶしや枠線、文字の色、文字のフォントなどをここで設定します。
枠線のコードを省略すると枠線なしのToolTipになります。コード全体です。
InitDataGridViewメソッドでDataGridViewの設定と行列を追加しています。
RandomStringメソッドはDataGridViewのセルの値を作成しています。仕事でDataGridViewのToolTipのフォントサイズを変更したくて方法を調べました。
CellToolTipTextNeededイベントを使用する方法が見つかりましたが、DataSourceプロパティが設定されているか、VirtualModeプロパティがtrueの場合にのみこのイベントが発生するようです。
なので今回の例のようにDataGridViewに直接行列を追加している場合はイベントが発生しませんでした。試行錯誤していて、DataGridViewのちらつきを防止するときに使用するDoubleBufferedにアクセスする方法と同じ方法でDataGridViewのToolTipにアクセスできるのではないか？と思いつき、今回の方法を考え付きました。


