More than 1 year has passed since last update.DB にパスワードを保存するとき、そのまま平文で保存すると、
データが漏れた場合に、パスワードが 見た瞬間わかってしまいます。この記事では C# を使って DB にパスワードをハッシュ化して登録してみたいと思います。パスワードを暗号化する際にsaltを利用すると別々のユーザが同じパスワードを使っても別のハッシュを作ることができます。
認証の際はsaltと平文のパスワードから作成できるハッシュが DB に登録されているハッシュと同じ場合、正しいパスワードです。Cryptography.KeyDerivationを使用しています。使用例を兼ねたテストこんな感じです。テスト時のソルト
ハッシュ化されたパスワード
上記のライブラリを使用して簡易的な Web API を実装しました。
ユーザー登録と認証機能が使えます。上記のコントローラーが移譲している実際のユーザー登録と認証は以下の通りです。ソースは GitHub に置きました。
https://github.com/sano-suguru/PasswordHash以下のコマンドで試せます。
DB はインメモリDBを使っていますので、ストレージは汚しません。ユーザーを登録
認証
ユーザーが重複したとき
認証失敗
学習を兼ねて作成しましたが、実際に認証処理を開発するときは抜け漏れがあると大変なので、
 ASP.NET Identity や OAuth などを使用すると良いと思います。


