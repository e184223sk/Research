More than 3 years have passed since last update.2017/08/31 Friendly勉強会 の第1回に参加しました。参加してみての感想などを簡単に書いていきます。テスト自動化を目的としたWindowsアプリの操作ライブラリです。ネイティブ、.NetのForm、WPFアプリケーションに対応しているようです。勉強会はハンズオン形式で参加者は説明を受けながらコードを打ち、わからなければ都度質問する、という形で進められました。今回はWPFアプリケーションを対象とし、「コントロールの特定方法」について学びました。以下、ハンズオンで記載したコードです。なお、ハンズオン資料はこちらからダウンロード可能です。最初にウィンドウの特定方法について4パターン紹介して頂きました。どの方法でも操作対象アプリケーションのメインウィンドウを特定できますが、
WindowTextを使った方法が良く使われるとのことです。アプリケーションのウィンドウ名は "Friendly Handson" ではなく、"FRIENDLY HANDSON" とすべて大文字になっていますが、
これは別途使用しているライブラリの関係でそうなっているのではないかということでした。そのため、WindowTextを指定する時は WpfApplication の MainWindow.xaml にあるTitle="Friendly Handson"を参考にするのが良さそうです。次にタブやテキストボックス、コンボボックスなど各種コントロールの特定・操作方法について紹介して頂きました。ここで、Friendly の大きな特徴である「対象プロセスのハッキング」が登場します。logicalツリーを使って MainWindow.xaml の木構造を取得した後、各コントロールを取得していきます。それを実現しているのが、AppVarクラスです。このクラスのオブジェクトには、コントロールオブジェクトのポインタのようなものが入っているイメージと説明を受けました。実際、AppVarオブジェクトの情報を基にタブを切り替えたり、テキストボックスから値を取得したり、といった各コントロールの操作や情報取得を体験することができました。今回の勉強会では手を動かしたのはここまでで、最後に質問タイムがあって終了となりました。自分はWPFアプリケーションを触るのは今回初めてだったのですが、丁寧に教えて頂けたため楽しんでハンズオンを進めることができました。「対象プロセスのハッキング」がFriendlyの大きな特徴とおっしゃっていましたが、実際体験したことでその凄さを感じ、どうやって実現しているか興味もわいてきました。勉強会は今後も一回完結ものの形で継続的に行われるようなので、参加して理解を深めていきたいと思います。


