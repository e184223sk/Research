More than 1 year has passed since last update.UWP（C#）でSwitchBot（BLEデバイス）を操作する - Qiita
のWPF編
微妙に書き方が違ったり、できることが違ったりする。WPFといいつつ、BLE周りのAPIはUWPにしかないので、UwpDesktopをnugetで入れる。経緯はUWP編の方で書いたので、最終的なコードだけ中身的にはUWPのAPIを呼んでるだけのはずなのだが、asyncの方はWPFからは呼べない。
それに伴って、エラーチェック周りの処理も変わる。ペアリングしていないSwitchBotも見つかるが、GattServicesでサービスを取得できない。
ソースコード中でペアリングすることも考えたが、煩雑になるのでやめて、UWPに移行した。
UWPでは事前のペアリングに関わらずコマンドを送信することができる。
SwitchBotのiOSアプリではペアリング有無に関わらず、電波の届く範囲のSwitchBotが検出／操作できるのでUWPではそれに近い実装ができる。


