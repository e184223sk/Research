    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (!(value is DiffPaneModel diffVM))
            return Binding.DoNothing;

        var paragraph = new Paragraph();
        foreach (var lineVM in diffVM.Lines)
        {
            List&lt;Run&gt; lineView = ConvertLinveVmToRun(lineVM);

            paragraph.Inlines.AddRange(lineView);

            //æ”¹è¡Œã‚’è¿½åŠ 
            paragraph.Inlines.Add(new LineBreak());
        }
        return new FlowDocument(paragraph);
    }

    private static List&lt;Run&gt; ConvertLinveVmToRun(DiffPiece lineVM)
    {
        //å·®åˆ†ã‚¿ã‚¤ãƒ—ã«ã‚ˆã£ã¦ã€è¡Œé ­ã®æ–‡å­—åˆ—å†…å®¹ã¨èƒŒæ™¯è‰²ã‚’æ±ºå®š
        var (color, preFix) = lineVM.Type switch
        {
            ChangeType.Deleted =&gt; (Colors.Pink, "ğŸ’£| "),
            ChangeType.Inserted =&gt; (Colors.GreenYellow, "â•| "),
            ChangeType.Imaginary =&gt; (Colors.SkyBlue, "ğŸ“Œ| "),
            ChangeType.Modified =&gt; (Colors.Yellow, "âœ| "),
            _ =&gt; (Colors.Transparent, "ğŸ”| "),
        };

        //è¦‹ã‚„ã™ã„ã‚ˆã†ã«å°‘ã—åŠé€æ˜ã«ã—ã¦ãŠã
        color.A = 0xC0;
        var baseColorBrush = new SolidColorBrush(color);
        var modifiedPieceBrush = new SolidColorBrush(Colors.Orange);

        //ChangeType.Modifiedä»¥å¤–ã¯è¡Œå…¨ä½“ã§åŒã˜æ›¸å¼
        if (lineVM.Type != ChangeType.Modified)
        {
            var lineView = new Run()
            {
                Text = preFix + lineVM.Text,
                Background = baseColorBrush,

            };
            return new List&lt;Run&gt; { lineView };
        }

        //ChangeType.Modifiedã ã£ãŸã‚‰å¤‰æ›´ã•ã‚ŒãŸéƒ¨åˆ†ã ã‘ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ãŸã„ã®ã§SubPieceã‹ã‚‰ã„ã‚ã„ã‚ã‚„ã‚‹
        var prefixRun = new Run()
        {
            Text = preFix,
            Background = baseColorBrush,
        };
        var runs = new List&lt;Run&gt; { prefixRun };

        foreach (var piece in lineVM.SubPieces)
        {
            runs.Add(new Run
            {
                Text = piece.Text,
                Background = piece.Type == ChangeType.Unchanged
                    ? baseColorBrush
                    : modifiedPieceBrush,
            });
        }
        return runs;
    }

