More than 3 years have passed since last update.何も気にしないでClickOnceのアプリケーションを発行した場合、
バージョンアップすると設定が消えてしまいます。
その対策です。Upgrade()を実行する処理の前に、IsUpgradedによる条件を追加しています。
これは、常にUpgrade()を実行すると、以下のパターンで問題が発生するためです。「データディレクトリ」と呼ばれるディレクトリのファイルは、バージョンアップしても保持されます。そのため、このディレクトリに設定を保存します。
ただし、データディレクトリの取得は、直接exeを実行した場合は例外になるため条件を追加します。


