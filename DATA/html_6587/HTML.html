<!DOCTYPE html><html><head><meta charset="utf-8" /><title>XamarinでWindows / Mac OSX 両対応のデスクトップアプリを作る - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/okajima/items/8ca53ff00a825f28dbc6" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="vziPJiYStddPlx+Bpgcwykilds9hjRpaSBe/nqT0GpJWx6MW8tdBe6dlesIXcoME92Uk1BgjTDR64Gh4Z542hg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="XamarinでWindows / Mac OSX 両対応のデスクトップアプリを作る - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XR0Z0WVhKcGJ1T0JwMWRwYm1SdmQzTWdMeUJOWVdNZ1QxTllJT1M0b2VXdnZ1V19uT09CcnVPRGgtT0N1ZU9Dci1PRGlPT0RnLU9EbC1PQ291T0RsLU9EcXVPQ2t1UzluT09DaXcmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NmEzNmZmYWU0YmY3M2Q3ODBiMDFjZGIzNWMyMGQxMzc&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzlyWVdwcGJXRSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTg2MmViNzQyN2U3ZmEwODIzYTBmZWE0M2FiYTBjYTJh&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=e89e3b4e5096fa43abe5aca1adf27139"><meta property="og:description" content="　私はSSHクライアントPoderosaを開発・販売していますが、最近、従来のWindows版に加えてMac OSX版をXamarinを使って作成するという仕事をしましたので、そこでの知見をまとめておこうと思います。
　Windows..."><meta content="https://qiita.com/okajima/items/8ca53ff00a825f28dbc6" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="Windows,C#,MacOSX,Xamarin" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-2009706c-1a8c-4fed-97d6-b17725eda886"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fokajima%2Fitems%2F8ca53ff00a825f28dbc6">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fokajima%2Fitems%2F8ca53ff00a825f28dbc6">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-2009706c-1a8c-4fed-97d6-b17725eda886">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/windows","name":"Windows"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-02-22T00:00:15.000+09:00","dateModified":"2017-02-22T21:59:54.000+09:00","headline":"XamarinでWindows / Mac OSX 両対応のデスクトップアプリを作る","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XR0Z0WVhKcGJ1T0JwMWRwYm1SdmQzTWdMeUJOWVdNZ1QxTllJT1M0b2VXdnZ1V19uT09CcnVPRGgtT0N1ZU9Dci1PRGlPT0RnLU9EbC1PQ291T0RsLU9EcXVPQ2t1UzluT09DaXcmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NmEzNmZmYWU0YmY3M2Q3ODBiMDFjZGIzNWMyMGQxMzc\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzlyWVdwcGJXRSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTg2MmViNzQyN2U3ZmEwODIzYTBmZWE0M2FiYTBjYTJh\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=e89e3b4e5096fa43abe5aca1adf27139","mainEntityOfPage":"https://qiita.com/okajima/items/8ca53ff00a825f28dbc6","author":{"@type":"Person","address":"Tokyo","email":"okajima@lagarto.co.jp","identifier":"okajima","name":"okajima","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F59073%2Fprofile-images%2F1560256459?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=4d436e7a8eb9ada03d337aa8d43849c7","url":"https://qiita.com/okajima","description":"Poderosaの中の人。2016年復活。Twitter @Poderosa_JA","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"okajima","type":"items","id":"8ca53ff00a825f28dbc6"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"okajima","type":"items","id":"8ca53ff00a825f28dbc6"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"okajima","type":"items","id":"8ca53ff00a825f28dbc6"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/okajima/items/8ca53ff00a825f28dbc6","location":"/okajima/items/8ca53ff00a825f28dbc6","scheme":"https","host":"qiita.com","port":null,"pathname":"/okajima/items/8ca53ff00a825f28dbc6","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"DniHo9fWB+zlwZ4ZHT6C8x24O9AHsN/Z6aHdgrG6M1fnh6uTAxPzQA0z+1qsSzE9onhpy34eibfbVgpkctAfQw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-f23d455b-ecfa-4007-aa2b-edf901c53f1e"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/okajima/items/8ca53ff00a825f28dbc6/likers" class="css-1iupg5d">371</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">382</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/8ca53ff00a825f28dbc6/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/okajima/items/8ca53ff00a825f28dbc6/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/okajima/items/8ca53ff00a825f28dbc6/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/okajima/items/8ca53ff00a825f28dbc6/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/okajima/items/8ca53ff00a825f28dbc6.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/okajima"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/59073/profile-images/1560256459" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/okajima" class="css-10ougpm">@<!-- -->okajima</a><div class="css-1ay9vb9"><span><meta content="2017-02-21T15:00:15Z"/><time dateTime="2017-02-22T12:59:54Z" class="css-m19uds">updated at 2017-02-22</time></span></div></div></div></div></div><h1 class="css-cgzq40">XamarinでWindows / Mac OSX 両対応のデスクトップアプリを作る</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/windows" class="css-4czcte">Windows</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/macosx" class="css-4czcte">MacOSX</a><a href="/tags/xamarin" class="css-4czcte">Xamarin</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>　私は<a href="https://ja.poderosa-terminal.com/" rel="nofollow noopener" target="_blank">SSHクライアントPoderosa</a>を開発・販売していますが、最近、従来のWindows版に加えてMac OSX版をXamarinを使って作成するという仕事をしましたので、そこでの知見をまとめておこうと思います。<br>
　Windows/OSXの両対応アプリを作る際の定石のようなものも見えてきました。<br>
　なおこの記事執筆時点ではOSX版Poderosaは開発終盤ですが未公開です。2017年4月に正式リリース予定です。</p>

<h1>
<span id="基礎知識おさらい" class="fragment"></span><a href="#%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98%E3%81%8A%E3%81%95%E3%82%89%E3%81%84"><i class="fa fa-link"></i></a>基礎知識おさらい</h1>

<p>　Xamarin社は、源流はオープンソースの.NET環境ですが、現在はマイクロソフト傘下になっています。Xamarinの構成要素も多岐にわたり、C#コンパイラ、CLRランタイム、本家.NET互換の基本ライブラリ群、Xamarin FormsというiOS/android両対応のモバイルアプリを作る環境、Xamarin StudioというIDE、などいろいろありますが、この記事ではモバイルアプリは関係ありません。<strong>WindowsとOSXの両対応のデスクトップアプリのお話です。</strong><br>
　この周辺では、.NET coreという、MS本家の.NETの一部をマルチプラットフォーム＆オープンソース化したものや、OSX版Visual Studioのようなツールも出始めており、状況は複雑です。</p>

<p>　なお、マルチプラットフォームのデスクトップアプリというと<a href="http://electron.atom.io/" rel="nofollow noopener" target="_blank">Electron</a>というのもあります。これはnode.jsベースで、HTMLとJavaScriptで書くとデスクトップアプリをビルドしてくれるというやつです。<a href="https://cordova.apache.org/" rel="nofollow noopener" target="_blank">cordova</a>の仲間ですね。あまり凝った動作は要らないから工数削減が最優先、というケースならElectronで良さそうですが、PoderosaはC#で書かれたオリジナルのWindows版が既にあったのでElectronは選択肢になりません。ただ、イチからお手軽にデスクトップアプリを作りたい場合は有力と思います。</p>

<h1>
<span id="シングルソースというわけにはいかない" class="fragment"></span><a href="#%E3%82%B7%E3%83%B3%E3%82%B0%E3%83%AB%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%A8%E3%81%84%E3%81%86%E3%82%8F%E3%81%91%E3%81%AB%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>シングルソースというわけにはいかない</h1>

<p>　いきなり結論ですが、<strong>一つのソースで両対応アプリがビルドできる、というのは幻想です。</strong>さすがに無理筋。<br>
　ライブラリに非互換な点があるから、とかの些末な問題でなく、<strong>WindowsとOSXの文化の違い</strong>が最大要因です。（もっとも、Windows版PoderosaはGUIにWPFを使っており、WPFはXamarinでは非対応であることから、シングルソースは最初からあきらめていましたが）</p>

<h2>
<span id="例１-excelとitunes" class="fragment"></span><a href="#%E4%BE%8B%EF%BC%91-excel%E3%81%A8itunes"><i class="fa fa-link"></i></a>例１ ExcelとiTunes</h2>

<p>　<a href="https://camo.qiitausercontent.com/6c6e72c477540f3ce8f04aafd3318a71919cd131/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f64336464666239342d393666362d633337662d323439352d6365313765363736646563382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2Fd3ddfb94-96f6-c37f-2495-ce17e676dec8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=45300efc5df6e117962d624f2b9e0ec1" alt="ExcelSS.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/59073/d3ddfb94-96f6-c37f-2495-ce17e676dec8.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2Fd3ddfb94-96f6-c37f-2495-ce17e676dec8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bee210673b68f00f4ff14204cabb5680 1x" loading="lazy"></a><br>
  <a href="https://camo.qiitausercontent.com/13ddbccb946ff3b6e0b6f3b4ef791927df7fec9e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f36396639323530382d323165352d373230612d346632632d3230363030326135363130612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F69f92508-21e5-720a-4f2c-206002a5610a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3baacf0fd98facf6f9a56f84e642d001" alt="iTunesSS.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/59073/69f92508-21e5-720a-4f2c-206002a5610a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F69f92508-21e5-720a-4f2c-206002a5610a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=521cc6afb5def996634480011d59cf99 1x" loading="lazy"></a></p>

<p>　これらはWindowsとOSXそれぞれの代表的なアプリケーションであるExcelとiTunesのものですが、</p>

<ul>
<li>OK/Cancelボタンのうち、WindowsではOKボタンは左。OSXでは右。</li>
<li>Windowsではダイアログの項目にキーボードショートカットのニーモニック(Altキーを押しながら選択するもの)がある。OSXにはない。(<em>というか、OSXではAltキーはまず使わないよね</em>)</li>
</ul>

<p>　といった違いがあります。</p>

<h2>
<span id="例２-ビットマップ上への描画" class="fragment"></span><a href="#%E4%BE%8B%EF%BC%92-%E3%83%93%E3%83%83%E3%83%88%E3%83%9E%E3%83%83%E3%83%97%E4%B8%8A%E3%81%B8%E3%81%AE%E6%8F%8F%E7%94%BB"><i class="fa fa-link"></i></a>例２ ビットマップ上への描画</h2>

<p>　メモリ上に確保したビットマップの上に文字を書く、という例で両方のAPI構造を確認してみます。</p>

<div class="code-frame" data-lang="C#">
<div class="code-lang"><span class="bold">Windows版</span></div>
<div class="highlight"><pre class="with-code"><code>            <span class="n">Font</span> <span class="n">font</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Font</span><span class="p">(</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">);</span>
            <span class="n">Bitmap</span> <span class="n">bmp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Bitmap</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">width</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">height</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Imaging</span><span class="p">.</span><span class="n">PixelFormat</span><span class="p">.</span><span class="n">Format32bppArgb</span><span class="p">);</span>
            <span class="n">Graphics</span> <span class="n">g</span> <span class="p">=</span> <span class="n">Graphics</span><span class="p">.</span><span class="nf">FromImage</span><span class="p">(</span><span class="n">bmp</span><span class="p">);</span>
            <span class="n">g</span><span class="p">.</span><span class="nf">DrawString</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">Brushes</span><span class="p">.</span><span class="n">White</span><span class="p">,</span> <span class="p">(</span><span class="n">bmp</span><span class="p">.</span><span class="n">Width</span><span class="p">-</span><span class="n">size</span><span class="p">.</span><span class="n">Width</span><span class="p">)/</span><span class="m">2</span><span class="p">,</span> <span class="p">(</span><span class="n">bmp</span><span class="p">.</span><span class="n">Height</span><span class="p">-</span><span class="n">size</span><span class="p">.</span><span class="n">Height</span><span class="p">)/</span><span class="m">2</span><span class="p">);</span>
            <span class="n">g</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="C#">
<div class="code-lang"><span class="bold">OSX版</span></div>
<div class="highlight"><pre class="with-code"><code>            <span class="n">NSFont</span> <span class="n">font</span> <span class="p">=</span> <span class="n">NSFont</span><span class="p">.</span><span class="nf">FromFontName</span><span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">ID</span><span class="p">,</span> <span class="n">k</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">attr</span> <span class="p">=</span> <span class="n">NSDictionary</span><span class="p">.</span><span class="nf">FromObjectsAndKeys</span><span class="p">(</span>
                <span class="k">new</span> <span class="n">NSObject</span><span class="p">[]</span> <span class="p">{</span> <span class="n">font</span><span class="p">,</span> <span class="n">NSColor</span><span class="p">.</span><span class="n">White</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">NSObject</span><span class="p">[]</span> <span class="p">{</span> <span class="n">NSStringAttributeKey</span><span class="p">.</span><span class="n">Font</span><span class="p">,</span> <span class="n">NSStringAttributeKey</span><span class="p">.</span><span class="n">ForegroundColor</span> <span class="p">}</span>
                <span class="p">);</span>
            <span class="n">NSImage</span> <span class="n">bmp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">NSImage</span><span class="p">(</span><span class="n">picsize</span><span class="p">);</span>
            <span class="n">bmp</span><span class="p">.</span><span class="nf">LockFocus</span><span class="p">();</span>
            <span class="n">text</span><span class="p">.</span><span class="nf">DrawInRect</span><span class="p">(</span><span class="k">new</span> <span class="nf">CGRect</span><span class="p">((</span><span class="n">picsize</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">size</span><span class="p">.</span><span class="n">Width</span><span class="p">)</span> <span class="p">/</span> <span class="m">2</span><span class="p">,</span> <span class="p">(</span><span class="n">picsize</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="n">size</span><span class="p">.</span><span class="n">Height</span><span class="p">)</span> <span class="p">/</span> <span class="m">2</span><span class="p">,</span> <span class="n">size</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">size</span><span class="p">.</span><span class="n">Height</span><span class="p">),</span> <span class="n">attr</span><span class="p">);</span>
            <span class="n">bmp</span><span class="p">.</span><span class="nf">UnlockFocus</span><span class="p">();</span>
</code></pre></div>
</div>

<p>　もう全然違いますね。描画がStringのメソッド、というOSXの動作は違和感強いですが、NeXT時代からそうなっている歴史的理由があるので仕方ありません。</p>

<p>　こういう違いがある以上、１つのソースから両対応できるような統一的なAPIを設計し、十分なパフォーマンスを確保し、なおかつ間違った使い方をしたら適切なエラーメッセージとともに例外を投げるようにするのは<strong>確実に不可能</strong>といえます。これはXamarinの出来が悪いからとかではなく、誰がどう設計しても無理というものです。</p>

<p>　余談ですが、昔は<a href="https://ja.wikipedia.org/wiki/Swing" rel="nofollow noopener" target="_blank">Swing</a>というJavaベースのマルチプラットフォームGUI環境がありました。ひょっとすると今は知らない人も多いかもしれませんが、これはマルチプラットフォームのGUIという魔境にがっぷり四つに組んでしまったため、パフォーマンスが劣悪なうえ各OSネイティブのGUIとは使用感が異なり、特定のOSでしか発生しないバグがどうしても残るなど悪夢そのものでした。<br>
　WindowsアプリにはWindowsらしさが求められ、それはマイクロソフトがエクスプローラやExcelを通して「模範」を示してくれます。同様に、OSXアプリにはOSXらしさが求められ、それはAppleがFinderやiTunesを通して模範を示します。よほど強い理由がない限りその模範には従うべきなのです。<br>
　もちろんアプリ開発の側からすれば同じにしてしまったほうが楽ですが、それぞれのOSの文化ごとに作るのはやむを得ないだろうと思います。<strong>郷に入れば郷に従え</strong>、です。</p>

<h1>
<span id="アプリ設計の定石" class="fragment"></span><a href="#%E3%82%A2%E3%83%97%E3%83%AA%E8%A8%AD%E8%A8%88%E3%81%AE%E5%AE%9A%E7%9F%B3"><i class="fa fa-link"></i></a>アプリ設計の定石</h1>

<p><a href="https://camo.qiitausercontent.com/67217e8890f941f63cc5d286d2d12432b4ab59a5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f37656365633065392d626137312d666462312d313438392d6436323639323338616138622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F7ecec0e9-ba71-fdb1-1489-d6269238aa8b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=94bb9e020d826214dc5a31a77417c2af" alt="xamarin1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/59073/7ecec0e9-ba71-fdb1-1489-d6269238aa8b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F7ecec0e9-ba71-fdb1-1489-d6269238aa8b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=70c2dabaef175a293d72e88e7ead1423 1x" loading="lazy"></a></p>

<p>　ここに、Windows/OSX両対応アプリを作る場合のアセンブリの依存関係の典型パターンを示しました。キーポイントとしては以下です：</p>

<ul>
<li>自分のアプリを、<strong>「OSによらない共通パート(MyApp.Common)」</strong>と<strong>「OSによる個別パート(MyApp.Windows / MyApp.OSX)」</strong>に分ける</li>
<li>各モジュールの接続インタフェースをきっちり決める</li>
<li>共通パートにできるだけ多くの機能が乗り、個別パートはできるだけスリムになるよう心掛けるが、やりすぎてインタフェースが複雑になるのは禁物。</li>
</ul>

<p>　実際には、NuGetからもってきたライブラリが絡んだり（しかもそれがXamarinでは動かないとかで）して話はそう単純ではなくなりますが、経験ではグラフィックが絡まなければほぼすべての部分に十分な互換性があるようにXamarinはできているようです。ファイルIOやソケットまわりも安定しています。<br>
　ですが、アプリ開発ではいつでも非互換の地雷を踏む可能性があるので、本家の.NETの互換、というフレコミをそのまま信用はできません。<strong>エンジニアたるもの、自分の目で見たコードとテスト結果以外は信用してはいけません</strong>ね。共通パートのユニットテストはWindows/OSXの両方で実行する必要がありますし、機能追加/変更時にも「この作業の結果Win/OSXの非互換な点が見つかるとしたらどういうものがあるだろうか？」とシミュレーションして、そのトラブル対応も入れたスケジュールをあらかじめ予測しておくべきです。（もっとも、この手の作業に事前のスケジュール見積もりは困難なので、<strong>完全な見通しが立ってからはじめて対外的なスケジュールを確約する</strong>のが実務上はトラブルがありません。</p>

<p>　さて、この分離方式において、アプリケーションの種類によっては、共通パートからOSごとに異なる実装になる機能を使いたい場合もあるでしょう。そういうときは共通パートに抽象クラスを用意し、個別パートで派生クラスを書いてOSによる差を隠蔽します。例えばビットマップを扱いたい場合、こういう具合ですね。<br>
<a href="https://camo.qiitausercontent.com/26f53f58604c74005e8cf66b7f1ab2bff3e2d4fe/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f36383236353663612d353932642d623365392d643633622d3635363532616364326434362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F682656ca-592d-b3e9-d63b-65652acd2d46.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8fcd83a9d2ffe222b6b5f8aec8d5088c" alt="bitmap1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/59073/682656ca-592d-b3e9-d63b-65652acd2d46.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F682656ca-592d-b3e9-d63b-65652acd2d46.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a35f7a1f6f1b578b482a3b323aa3b348 1x" loading="lazy"></a></p>

<p>　共通パートからは抽象クラスだけにアクセスします。派生クラスのMyWindowsBitmap / MyOSXBitmapのそれぞれ単独でテストすれば動作も軽く済みます。<br>
　もっとも、Windowsで動かすことしか考えずに書かれたコードから出発する場合、共通パートと個別パートに分離する作業からはじめないといけないのでこれがけっこう手間です。(Poderosaではこれだけで２週間かかりました）<br>
　「今はWindowsだけだが、将来OSX版もやるかも」というアプリを新規開発する場合は最初からこういう構造に作っておいた方がいいでしょう。</p>

<h1>
<span id="wpfからの移植" class="fragment"></span><a href="#wpf%E3%81%8B%E3%82%89%E3%81%AE%E7%A7%BB%E6%A4%8D"><i class="fa fa-link"></i></a>WPFからの移植</h1>

<p>　Windows版のGUIコードはWPFで書かれていましたが、これをOSXに移植するのはおおむね次のようにしました。<br>
　細かく説明すればきりがなく、これだけで本１冊のボリュームになりかねない勢いなんですが、大胆に要約するとこんな具合です。</p>

<table>
<thead>
<tr>
<th style="text-align: left">Windows</th>
<th style="text-align: left">OSX</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">WPFのXAMLのうち、基本レイアウト部分</td>
<td style="text-align: left">完全手作業でxibに置き換え</td>
</tr>
<tr>
<td style="text-align: left">WPFのXAMLのうち、スタイルとアニメーション部分</td>
<td style="text-align: left">OSXではあきらめる(StoryBoardを駆使すれば何とかなるかもしれないが調査不足)</td>
</tr>
<tr>
<td style="text-align: left">Button,CheckBox,RadioButton</td>
<td style="text-align: left">NSButton(クリック以外のイベントが欲しいときはNSButtonまたはNSViewからの派生クラスを)</td>
</tr>
<tr>
<td style="text-align: left">Label,TextBox</td>
<td style="text-align: left">NSTextField</td>
</tr>
<tr>
<td style="text-align: left">ComboBox</td>
<td style="text-align: left">NSComboBox(要素はSystem.Stringでは受け付けてくれず、Foundation.NSStringに変換しないといけないのが面倒)</td>
</tr>
<tr>
<td style="text-align: left">ImageBox</td>
<td style="text-align: left">NSImageView</td>
</tr>
</tbody>
</table>

<p>だいたいは、WPFのコントロールのプロパティに対応するものがCocoaにもあるので、ごく機械的に変換してやればできます。しかしイベントは殆ど用意されていないので、凝ったことをするにはいちいち派生クラスを書いてメソッドをoverrideしてやる必要があり、面倒です。<br>
なお<strong>超難関はLayoutConstraint系</strong>で、自分が慣れていないせいもありますが、謎の挙動が多すぎて正直付き合いきれないと思いました。WPFならDockPanel, StackPanel, Gridの組み合わせでかなり柔軟にGUIのレイアウトができますが、OSXはこの点非常にキビシイ。可変サイズのダイアログには可能な限り手を出さない方がいいと思いました。</p>

<h1>
<span id="我らの味方-ifdef" class="fragment"></span><a href="#%E6%88%91%E3%82%89%E3%81%AE%E5%91%B3%E6%96%B9-ifdef"><i class="fa fa-link"></i></a>我らの味方！ #ifdef</h1>

<p>　ここまで説明した路線でだいたいなんとかなるのですが、そうはいっても手掛けるのは悪魔の潜むGUI<br>
アプリ開発なので、そう綺麗ごとばかりで済むわけではありません。<strong>緊急対応やその場しのぎ</strong>はどうしてもあります。<br>
　そのときの強い味方は #ifdef です。Xamarin側のプロジェクト設定で適当にシンボルを決めておいて、</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>#if XAMARIN
(Xamarin固有コード)
#else
(Windows固有コード)
#endif
</code></pre></div></div>

<p>　みたいにやるわけです。<br>
　<strong>スマートでないのは百も承知</strong>ですが、<strong>「いざとなったら#ifdefがあるもんね～」</strong>というのはコーディング時に<strong>心の余裕</strong>が生まれます。一旦#ifdefでしのいでおいて、後で時間に余裕ができたらスマートな解決法を改めて考える、としましょう。これは<strong>Javaにはできない芸当</strong>です。#ifdef XAMARINの中はWindowsではコンパイルも通らない（また、#elseの中がMacでコンパイルできない）、という構造でも許してくれるので。<br>
　当初、OSX版Poderosaをやるかどうか悩んでいた時期にXamarinが使い物になるかどうかを実験していたのですが、正直に白状すると、この「#ifdefがある」というのが実は決断の決め手になりました。まあPoderosaは半分趣味・半分仕事のプロジェクトなので、#ifdefさえあれば、リリースが不可能になるような重大な問題にぶつかることはないだろうという判断です。</p>

<h1>
<span id="xamarinmacとは何か" class="fragment"></span><a href="#xamarinmac%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B"><i class="fa fa-link"></i></a>Xamarin.Macとは何か</h1>

<p>　ある程度推測も入ってますが、Cocoaを含むOSXの'Framework'に収録されている型情報を材料に、C#からObjective-Cのメソッド呼び出しをブリッジするソースコードを自動生成し、それをビルドしたものをXamarin.Macとしている模様です。なので、OSXのAPIの「直訳」としてXamarin.Macが使えます。もっとも、OSXのAPIは非常にわかりづらいので、そこに<strong>さらにXamarin独自のレイヤーが挟まったら死ぬのは確実</strong>です。直訳にしたのは良い決定だったと思います。どのみちある程度複雑な機能に対するAPIは、StackOverflow等のサイトにQ&amp;Aが十分蓄積されないと使い物にならないので仕方ないでしょう。<br>
　なお、このあたりの機構は今後掘り下げて調べるつもり（主目的は、新しいMacBookに搭載されているTouchBarをXamarin経由でいじるため）なので、後日別記事でまとめようと思います。</p>

<h1>
<span id="visual-studioとxamarin-studio" class="fragment"></span><a href="#visual-studio%E3%81%A8xamarin-studio"><i class="fa fa-link"></i></a>Visual StudioとXamarin Studio</h1>

<p>　Xamarin Studioはかなりよくできている(少なくともAndroid Studioよりは何倍もマシ)と思いますが、比較相手が天下のVisual Studioというのは<strong>相手が悪すぎ</strong>です。私がVisual Studio使用歴20年で慣れ過ぎているから、というのも少なからずありますが、特にデバッガの機能と信頼性においてはVisual Studioのほうが明らかによくできています。<br>
　なので、開発の<strong>「司令部」をWindows + Visual Studio</strong>におき、<strong>「前線基地」をOSX + Xamarin Studio</strong>にするのがいいと思います。</p>

<p>　つまらないバグを取る、仕様未確定な機能の試作をする、リファクタリングをする、とかはふだんWindows上のみで行っておいて、<strong>ある程度落ち着いたらまとめてOSX版にもっていってテスト</strong>、という流れです。Xamarin StudioでデバッグするのはOSX固有の問題を追跡する場合に限る、としたほうが時間の効率がよいです。</p>

<h1>
<span id="objective-cについて" class="fragment"></span><a href="#objective-c%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>Objective-Cについて</h1>

<p>　Xamarinの宣伝文句を見ると、<strong>「使い慣れたC#でアプリ開発を！」</strong>みたいに書いてありますが、C#だけ知っていればいいわけではありません。OSXの厄介な問題に取り組むときは、参考情報はほぼ全部Objective-Cで書いてあるので、最低限<strong>読むことは必要</strong>です。また、Objective-Cのセレクタを重度に使う機能（そういうのは稀ですが）はXamarinではちゃんとサポートされてないので苦労します。ですがここの事情はおそらくXamarin Formsでも同じでしょう。<br>
　あと、そもそもの話として、OSXデスクトップアプリを作っている人はWindowsに比べて少ないので、何をするにもWeb上の参考資料が見つかりにくいというのがあります。不便ですが仕方ないですね。</p>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<p>　なんだかんだいっても、<strong>OSの全機能を使いつつクロスプラットフォームにできる点でXamarinはとても強力</strong>です。クロスプラットフォームのGUIというとSwingやらQtやらしかなかった時代と比べるとずいぶんハッピーです。<br>
　とりわけ、C#で書かれたWindows用アプリをOSXに移植するにはほぼ唯一の選択肢といっていいと思います。<a href="https://ja.poderosa-terminal.com/" rel="nofollow noopener" target="_blank">今回開発したPoderosa</a>の場合、共通パートに全体のコード量の70%ほどを収録することができました。<br>
　ある程度以上の規模のアプリになると、型のない言語だといろいろ不便(<strong>...というか死ぬ</strong>)です。型のない言語でのアクロバティックな実装も好きですが、コンパイル時にエラーを出してくれるのはユニットテストの一部を代替してくれていると思ってきっちり利用してやりましょう！</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fokajima%2Fitems%2F8ca53ff00a825f28dbc6&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fokajima%2Fitems%2F8ca53ff00a825f28dbc6&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/okajima/items/8ca53ff00a825f28dbc6/likers" class="css-1iupg5d">371</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">382</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/8ca53ff00a825f28dbc6/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/okajima/items/8ca53ff00a825f28dbc6/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/okajima/items/8ca53ff00a825f28dbc6/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/okajima/items/8ca53ff00a825f28dbc6/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/okajima/items/8ca53ff00a825f28dbc6.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-f23d455b-ecfa-4007-aa2b-edf901c53f1e">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-30514ae1-6486-402d-9bcb-345249cc8952"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-30514ae1-6486-402d-9bcb-345249cc8952">{}</script>
      
<div id="LoginModal-react-component-bafe6a0c-e11d-41f9-ba50-1c7655219ca7"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-bafe6a0c-e11d-41f9-ba50-1c7655219ca7">{}</script>
      
<div id="StockModal-react-component-a66e4fb0-7e7d-4923-a3c6-c37d4c29f169"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-a66e4fb0-7e7d-4923-a3c6-c37d4c29f169">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;QZHBOlkkK/jJtj8SWGdfzKjhbezGC5GfR1T/qKJemOGobu0KjeHfVCFEWlHpEuwCFyE/97+lx/F1oyhOYTS09Q==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e　私は\u003ca href=\"https://ja.poderosa-terminal.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSSHクライアントPoderosa\u003c/a\u003eを開発・販売していますが、最近、従来のWindows版に加えてMac OSX版をXamarinを使って作成するという仕事をしましたので、そこでの知見をまとめておこうと思います。\u003cbr\u003e\n　Windows/OSXの両対応アプリを作る際の定石のようなものも見えてきました。\u003cbr\u003e\n　なおこの記事執筆時点ではOSX版Poderosaは開発終盤ですが未公開です。2017年4月に正式リリース予定です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"基礎知識おさらい\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98%E3%81%8A%E3%81%95%E3%82%89%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e基礎知識おさらい\u003c/h1\u003e\n\n\u003cp\u003e　Xamarin社は、源流はオープンソースの.NET環境ですが、現在はマイクロソフト傘下になっています。Xamarinの構成要素も多岐にわたり、C#コンパイラ、CLRランタイム、本家.NET互換の基本ライブラリ群、Xamarin FormsというiOS/android両対応のモバイルアプリを作る環境、Xamarin StudioというIDE、などいろいろありますが、この記事ではモバイルアプリは関係ありません。\u003cstrong\u003eWindowsとOSXの両対応のデスクトップアプリのお話です。\u003c/strong\u003e\u003cbr\u003e\n　この周辺では、.NET coreという、MS本家の.NETの一部をマルチプラットフォーム＆オープンソース化したものや、OSX版Visual Studioのようなツールも出始めており、状況は複雑です。\u003c/p\u003e\n\n\u003cp\u003e　なお、マルチプラットフォームのデスクトップアプリというと\u003ca href=\"http://electron.atom.io/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eElectron\u003c/a\u003eというのもあります。これはnode.jsベースで、HTMLとJavaScriptで書くとデスクトップアプリをビルドしてくれるというやつです。\u003ca href=\"https://cordova.apache.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ecordova\u003c/a\u003eの仲間ですね。あまり凝った動作は要らないから工数削減が最優先、というケースならElectronで良さそうですが、PoderosaはC#で書かれたオリジナルのWindows版が既にあったのでElectronは選択肢になりません。ただ、イチからお手軽にデスクトップアプリを作りたい場合は有力と思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"シングルソースというわけにはいかない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B7%E3%83%B3%E3%82%B0%E3%83%AB%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%A8%E3%81%84%E3%81%86%E3%82%8F%E3%81%91%E3%81%AB%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eシングルソースというわけにはいかない\u003c/h1\u003e\n\n\u003cp\u003e　いきなり結論ですが、\u003cstrong\u003e一つのソースで両対応アプリがビルドできる、というのは幻想です。\u003c/strong\u003eさすがに無理筋。\u003cbr\u003e\n　ライブラリに非互換な点があるから、とかの些末な問題でなく、\u003cstrong\u003eWindowsとOSXの文化の違い\u003c/strong\u003eが最大要因です。（もっとも、Windows版PoderosaはGUIにWPFを使っており、WPFはXamarinでは非対応であることから、シングルソースは最初からあきらめていましたが）\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"例１-excelとitunes\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%8B%EF%BC%91-excel%E3%81%A8itunes\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e例１ ExcelとiTunes\u003c/h2\u003e\n\n\u003cp\u003e　\u003ca href=\"https://camo.qiitausercontent.com/6c6e72c477540f3ce8f04aafd3318a71919cd131/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f64336464666239342d393666362d633337662d323439352d6365313765363736646563382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2Fd3ddfb94-96f6-c37f-2495-ce17e676dec8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=45300efc5df6e117962d624f2b9e0ec1\" alt=\"ExcelSS.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/59073/d3ddfb94-96f6-c37f-2495-ce17e676dec8.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2Fd3ddfb94-96f6-c37f-2495-ce17e676dec8.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bee210673b68f00f4ff14204cabb5680 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n  \u003ca href=\"https://camo.qiitausercontent.com/13ddbccb946ff3b6e0b6f3b4ef791927df7fec9e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f36396639323530382d323165352d373230612d346632632d3230363030326135363130612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F69f92508-21e5-720a-4f2c-206002a5610a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3baacf0fd98facf6f9a56f84e642d001\" alt=\"iTunesSS.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/59073/69f92508-21e5-720a-4f2c-206002a5610a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F69f92508-21e5-720a-4f2c-206002a5610a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=521cc6afb5def996634480011d59cf99 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　これらはWindowsとOSXそれぞれの代表的なアプリケーションであるExcelとiTunesのものですが、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOK/Cancelボタンのうち、WindowsではOKボタンは左。OSXでは右。\u003c/li\u003e\n\u003cli\u003eWindowsではダイアログの項目にキーボードショートカットのニーモニック(Altキーを押しながら選択するもの)がある。OSXにはない。(\u003cem\u003eというか、OSXではAltキーはまず使わないよね\u003c/em\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e　といった違いがあります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"例２-ビットマップ上への描画\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%8B%EF%BC%92-%E3%83%93%E3%83%83%E3%83%88%E3%83%9E%E3%83%83%E3%83%97%E4%B8%8A%E3%81%B8%E3%81%AE%E6%8F%8F%E7%94%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e例２ ビットマップ上への描画\u003c/h2\u003e\n\n\u003cp\u003e　メモリ上に確保したビットマップの上に文字を書く、という例で両方のAPI構造を確認してみます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eWindows版\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e            \u003cspan class=\"n\"\u003eFont\u003c/span\u003e \u003cspan class=\"n\"\u003efont\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eFont\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efontname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efontsize\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eBitmap\u003c/span\u003e \u003cspan class=\"n\"\u003ebmp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eBitmap\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDrawing\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eImaging\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePixelFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat32bppArgb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGraphics\u003c/span\u003e \u003cspan class=\"n\"\u003eg\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGraphics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromImage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebmp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDrawString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efont\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBrushes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e)/\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e)/\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eOSX版\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e            \u003cspan class=\"n\"\u003eNSFont\u003c/span\u003e \u003cspan class=\"n\"\u003efont\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eNSFont\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromFontName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eattr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eNSDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromObjectsAndKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eNSObject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003efont\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eNSColor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n                \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eNSObject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eNSStringAttributeKey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFont\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eNSStringAttributeKey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eForegroundColor\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eNSImage\u003c/span\u003e \u003cspan class=\"n\"\u003ebmp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eNSImage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epicsize\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLockFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDrawInRect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCGRect\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003epicsize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epicsize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eattr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUnlockFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e　もう全然違いますね。描画がStringのメソッド、というOSXの動作は違和感強いですが、NeXT時代からそうなっている歴史的理由があるので仕方ありません。\u003c/p\u003e\n\n\u003cp\u003e　こういう違いがある以上、１つのソースから両対応できるような統一的なAPIを設計し、十分なパフォーマンスを確保し、なおかつ間違った使い方をしたら適切なエラーメッセージとともに例外を投げるようにするのは\u003cstrong\u003e確実に不可能\u003c/strong\u003eといえます。これはXamarinの出来が悪いからとかではなく、誰がどう設計しても無理というものです。\u003c/p\u003e\n\n\u003cp\u003e　余談ですが、昔は\u003ca href=\"https://ja.wikipedia.org/wiki/Swing\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSwing\u003c/a\u003eというJavaベースのマルチプラットフォームGUI環境がありました。ひょっとすると今は知らない人も多いかもしれませんが、これはマルチプラットフォームのGUIという魔境にがっぷり四つに組んでしまったため、パフォーマンスが劣悪なうえ各OSネイティブのGUIとは使用感が異なり、特定のOSでしか発生しないバグがどうしても残るなど悪夢そのものでした。\u003cbr\u003e\n　WindowsアプリにはWindowsらしさが求められ、それはマイクロソフトがエクスプローラやExcelを通して「模範」を示してくれます。同様に、OSXアプリにはOSXらしさが求められ、それはAppleがFinderやiTunesを通して模範を示します。よほど強い理由がない限りその模範には従うべきなのです。\u003cbr\u003e\n　もちろんアプリ開発の側からすれば同じにしてしまったほうが楽ですが、それぞれのOSの文化ごとに作るのはやむを得ないだろうと思います。\u003cstrong\u003e郷に入れば郷に従え\u003c/strong\u003e、です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"アプリ設計の定石\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%97%E3%83%AA%E8%A8%AD%E8%A8%88%E3%81%AE%E5%AE%9A%E7%9F%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアプリ設計の定石\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/67217e8890f941f63cc5d286d2d12432b4ab59a5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f37656365633065392d626137312d666462312d313438392d6436323639323338616138622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F7ecec0e9-ba71-fdb1-1489-d6269238aa8b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=94bb9e020d826214dc5a31a77417c2af\" alt=\"xamarin1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/59073/7ecec0e9-ba71-fdb1-1489-d6269238aa8b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F7ecec0e9-ba71-fdb1-1489-d6269238aa8b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=70c2dabaef175a293d72e88e7ead1423 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　ここに、Windows/OSX両対応アプリを作る場合のアセンブリの依存関係の典型パターンを示しました。キーポイントとしては以下です：\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e自分のアプリを、\u003cstrong\u003e「OSによらない共通パート(MyApp.Common)」\u003c/strong\u003eと\u003cstrong\u003e「OSによる個別パート(MyApp.Windows / MyApp.OSX)」\u003c/strong\u003eに分ける\u003c/li\u003e\n\u003cli\u003e各モジュールの接続インタフェースをきっちり決める\u003c/li\u003e\n\u003cli\u003e共通パートにできるだけ多くの機能が乗り、個別パートはできるだけスリムになるよう心掛けるが、やりすぎてインタフェースが複雑になるのは禁物。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e　実際には、NuGetからもってきたライブラリが絡んだり（しかもそれがXamarinでは動かないとかで）して話はそう単純ではなくなりますが、経験ではグラフィックが絡まなければほぼすべての部分に十分な互換性があるようにXamarinはできているようです。ファイルIOやソケットまわりも安定しています。\u003cbr\u003e\n　ですが、アプリ開発ではいつでも非互換の地雷を踏む可能性があるので、本家の.NETの互換、というフレコミをそのまま信用はできません。\u003cstrong\u003eエンジニアたるもの、自分の目で見たコードとテスト結果以外は信用してはいけません\u003c/strong\u003eね。共通パートのユニットテストはWindows/OSXの両方で実行する必要がありますし、機能追加/変更時にも「この作業の結果Win/OSXの非互換な点が見つかるとしたらどういうものがあるだろうか？」とシミュレーションして、そのトラブル対応も入れたスケジュールをあらかじめ予測しておくべきです。（もっとも、この手の作業に事前のスケジュール見積もりは困難なので、\u003cstrong\u003e完全な見通しが立ってからはじめて対外的なスケジュールを確約する\u003c/strong\u003eのが実務上はトラブルがありません。\u003c/p\u003e\n\n\u003cp\u003e　さて、この分離方式において、アプリケーションの種類によっては、共通パートからOSごとに異なる実装になる機能を使いたい場合もあるでしょう。そういうときは共通パートに抽象クラスを用意し、個別パートで派生クラスを書いてOSによる差を隠蔽します。例えばビットマップを扱いたい場合、こういう具合ですね。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/26f53f58604c74005e8cf66b7f1ab2bff3e2d4fe/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35393037332f36383236353663612d353932642d623365392d643633622d3635363532616364326434362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F682656ca-592d-b3e9-d63b-65652acd2d46.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8fcd83a9d2ffe222b6b5f8aec8d5088c\" alt=\"bitmap1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/59073/682656ca-592d-b3e9-d63b-65652acd2d46.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F59073%2F682656ca-592d-b3e9-d63b-65652acd2d46.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a35f7a1f6f1b578b482a3b323aa3b348 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　共通パートからは抽象クラスだけにアクセスします。派生クラスのMyWindowsBitmap / MyOSXBitmapのそれぞれ単独でテストすれば動作も軽く済みます。\u003cbr\u003e\n　もっとも、Windowsで動かすことしか考えずに書かれたコードから出発する場合、共通パートと個別パートに分離する作業からはじめないといけないのでこれがけっこう手間です。(Poderosaではこれだけで２週間かかりました）\u003cbr\u003e\n　「今はWindowsだけだが、将来OSX版もやるかも」というアプリを新規開発する場合は最初からこういう構造に作っておいた方がいいでしょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"wpfからの移植\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#wpf%E3%81%8B%E3%82%89%E3%81%AE%E7%A7%BB%E6%A4%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWPFからの移植\u003c/h1\u003e\n\n\u003cp\u003e　Windows版のGUIコードはWPFで書かれていましたが、これをOSXに移植するのはおおむね次のようにしました。\u003cbr\u003e\n　細かく説明すればきりがなく、これだけで本１冊のボリュームになりかねない勢いなんですが、大胆に要約するとこんな具合です。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003eWindows\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003eOSX\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eWPFのXAMLのうち、基本レイアウト部分\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e完全手作業でxibに置き換え\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eWPFのXAMLのうち、スタイルとアニメーション部分\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eOSXではあきらめる(StoryBoardを駆使すれば何とかなるかもしれないが調査不足)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eButton,CheckBox,RadioButton\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eNSButton(クリック以外のイベントが欲しいときはNSButtonまたはNSViewからの派生クラスを)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eLabel,TextBox\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eNSTextField\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eComboBox\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eNSComboBox(要素はSystem.Stringでは受け付けてくれず、Foundation.NSStringに変換しないといけないのが面倒)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eImageBox\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eNSImageView\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eだいたいは、WPFのコントロールのプロパティに対応するものがCocoaにもあるので、ごく機械的に変換してやればできます。しかしイベントは殆ど用意されていないので、凝ったことをするにはいちいち派生クラスを書いてメソッドをoverrideしてやる必要があり、面倒です。\u003cbr\u003e\nなお\u003cstrong\u003e超難関はLayoutConstraint系\u003c/strong\u003eで、自分が慣れていないせいもありますが、謎の挙動が多すぎて正直付き合いきれないと思いました。WPFならDockPanel, StackPanel, Gridの組み合わせでかなり柔軟にGUIのレイアウトができますが、OSXはこの点非常にキビシイ。可変サイズのダイアログには可能な限り手を出さない方がいいと思いました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"我らの味方-ifdef\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%88%91%E3%82%89%E3%81%AE%E5%91%B3%E6%96%B9-ifdef\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e我らの味方！ #ifdef\u003c/h1\u003e\n\n\u003cp\u003e　ここまで説明した路線でだいたいなんとかなるのですが、そうはいっても手掛けるのは悪魔の潜むGUI\u003cbr\u003e\nアプリ開発なので、そう綺麗ごとばかりで済むわけではありません。\u003cstrong\u003e緊急対応やその場しのぎ\u003c/strong\u003eはどうしてもあります。\u003cbr\u003e\n　そのときの強い味方は #ifdef です。Xamarin側のプロジェクト設定で適当にシンボルを決めておいて、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e#if XAMARIN\n(Xamarin固有コード)\n#else\n(Windows固有コード)\n#endif\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e　みたいにやるわけです。\u003cbr\u003e\n　\u003cstrong\u003eスマートでないのは百も承知\u003c/strong\u003eですが、\u003cstrong\u003e「いざとなったら#ifdefがあるもんね～」\u003c/strong\u003eというのはコーディング時に\u003cstrong\u003e心の余裕\u003c/strong\u003eが生まれます。一旦#ifdefでしのいでおいて、後で時間に余裕ができたらスマートな解決法を改めて考える、としましょう。これは\u003cstrong\u003eJavaにはできない芸当\u003c/strong\u003eです。#ifdef XAMARINの中はWindowsではコンパイルも通らない（また、#elseの中がMacでコンパイルできない）、という構造でも許してくれるので。\u003cbr\u003e\n　当初、OSX版Poderosaをやるかどうか悩んでいた時期にXamarinが使い物になるかどうかを実験していたのですが、正直に白状すると、この「#ifdefがある」というのが実は決断の決め手になりました。まあPoderosaは半分趣味・半分仕事のプロジェクトなので、#ifdefさえあれば、リリースが不可能になるような重大な問題にぶつかることはないだろうという判断です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"xamarinmacとは何か\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#xamarinmac%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eXamarin.Macとは何か\u003c/h1\u003e\n\n\u003cp\u003e　ある程度推測も入ってますが、Cocoaを含むOSXの'Framework'に収録されている型情報を材料に、C#からObjective-Cのメソッド呼び出しをブリッジするソースコードを自動生成し、それをビルドしたものをXamarin.Macとしている模様です。なので、OSXのAPIの「直訳」としてXamarin.Macが使えます。もっとも、OSXのAPIは非常にわかりづらいので、そこに\u003cstrong\u003eさらにXamarin独自のレイヤーが挟まったら死ぬのは確実\u003c/strong\u003eです。直訳にしたのは良い決定だったと思います。どのみちある程度複雑な機能に対するAPIは、StackOverflow等のサイトにQ\u0026amp;Aが十分蓄積されないと使い物にならないので仕方ないでしょう。\u003cbr\u003e\n　なお、このあたりの機構は今後掘り下げて調べるつもり（主目的は、新しいMacBookに搭載されているTouchBarをXamarin経由でいじるため）なので、後日別記事でまとめようと思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"visual-studioとxamarin-studio\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#visual-studio%E3%81%A8xamarin-studio\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eVisual StudioとXamarin Studio\u003c/h1\u003e\n\n\u003cp\u003e　Xamarin Studioはかなりよくできている(少なくともAndroid Studioよりは何倍もマシ)と思いますが、比較相手が天下のVisual Studioというのは\u003cstrong\u003e相手が悪すぎ\u003c/strong\u003eです。私がVisual Studio使用歴20年で慣れ過ぎているから、というのも少なからずありますが、特にデバッガの機能と信頼性においてはVisual Studioのほうが明らかによくできています。\u003cbr\u003e\n　なので、開発の\u003cstrong\u003e「司令部」をWindows + Visual Studio\u003c/strong\u003eにおき、\u003cstrong\u003e「前線基地」をOSX + Xamarin Studio\u003c/strong\u003eにするのがいいと思います。\u003c/p\u003e\n\n\u003cp\u003e　つまらないバグを取る、仕様未確定な機能の試作をする、リファクタリングをする、とかはふだんWindows上のみで行っておいて、\u003cstrong\u003eある程度落ち着いたらまとめてOSX版にもっていってテスト\u003c/strong\u003e、という流れです。Xamarin StudioでデバッグするのはOSX固有の問題を追跡する場合に限る、としたほうが時間の効率がよいです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"objective-cについて\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#objective-c%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eObjective-Cについて\u003c/h1\u003e\n\n\u003cp\u003e　Xamarinの宣伝文句を見ると、\u003cstrong\u003e「使い慣れたC#でアプリ開発を！」\u003c/strong\u003eみたいに書いてありますが、C#だけ知っていればいいわけではありません。OSXの厄介な問題に取り組むときは、参考情報はほぼ全部Objective-Cで書いてあるので、最低限\u003cstrong\u003e読むことは必要\u003c/strong\u003eです。また、Objective-Cのセレクタを重度に使う機能（そういうのは稀ですが）はXamarinではちゃんとサポートされてないので苦労します。ですがここの事情はおそらくXamarin Formsでも同じでしょう。\u003cbr\u003e\n　あと、そもそもの話として、OSXデスクトップアプリを作っている人はWindowsに比べて少ないので、何をするにもWeb上の参考資料が見つかりにくいというのがあります。不便ですが仕方ないですね。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003e　なんだかんだいっても、\u003cstrong\u003eOSの全機能を使いつつクロスプラットフォームにできる点でXamarinはとても強力\u003c/strong\u003eです。クロスプラットフォームのGUIというとSwingやらQtやらしかなかった時代と比べるとずいぶんハッピーです。\u003cbr\u003e\n　とりわけ、C#で書かれたWindows用アプリをOSXに移植するにはほぼ唯一の選択肢といっていいと思います。\u003ca href=\"https://ja.poderosa-terminal.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e今回開発したPoderosa\u003c/a\u003eの場合、共通パートに全体のコード量の70%ほどを収録することができました。\u003cbr\u003e\n　ある程度以上の規模のアプリになると、型のない言語だといろいろ不便(\u003cstrong\u003e...というか死ぬ\u003c/strong\u003e)です。型のない言語でのアクロバティックな実装も好きですが、コンパイル時にエラーを出してくれるのはユニットテストの一部を代替してくれていると思ってきっちり利用してやりましょう！\u003c/p\u003e\n","createdAt":"2017-02-21T15:00:15Z","elapsedYearsFromLastModifiedAt":4,"encryptedId":"fWkXylsSbDToNwEBhW0sEZqlIVPcJU29--sJfXG7b8S45Bp6T+--UT7Gg2VfBlHWerahdvlI4Q==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2017-02-22T12:59:54Z","likesCount":371,"linkUrl":"https://qiita.com/okajima/items/8ca53ff00a825f28dbc6","organization":null,"originalId":470789,"stockedCount":382,"title":"XamarinでWindows / Mac OSX 両対応のデスクトップアプリを作る","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98%E3%81%8A%E3%81%95%E3%82%89%E3%81%84\"\u003e基礎知識おさらい\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B7%E3%83%B3%E3%82%B0%E3%83%AB%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%A8%E3%81%84%E3%81%86%E3%82%8F%E3%81%91%E3%81%AB%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84\"\u003eシングルソースというわけにはいかない\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BE%8B%EF%BC%91-excel%E3%81%A8itunes\"\u003e例１ ExcelとiTunes\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BE%8B%EF%BC%92-%E3%83%93%E3%83%83%E3%83%88%E3%83%9E%E3%83%83%E3%83%97%E4%B8%8A%E3%81%B8%E3%81%AE%E6%8F%8F%E7%94%BB\"\u003e例２ ビットマップ上への描画\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%97%E3%83%AA%E8%A8%AD%E8%A8%88%E3%81%AE%E5%AE%9A%E7%9F%B3\"\u003eアプリ設計の定石\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#wpf%E3%81%8B%E3%82%89%E3%81%AE%E7%A7%BB%E6%A4%8D\"\u003eWPFからの移植\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%88%91%E3%82%89%E3%81%AE%E5%91%B3%E6%96%B9-ifdef\"\u003e我らの味方！ #ifdef\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#xamarinmac%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B\"\u003eXamarin.Macとは何か\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#visual-studio%E3%81%A8xamarin-studio\"\u003eVisual StudioとXamarin Studio\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#objective-c%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003eObjective-Cについて\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":70421,"uuid":"8ca53ff00a825f28dbc6","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"h1YRRIsjJJwmBUXZqnvss4nmq3Q=--A3sCaG39z5zyhtdT--+Ee1ztjAtxs/pbVZ3lmMgg==","originalId":59073,"description":"Poderosaの中の人。2016年復活。Twitter @Poderosa_JA","facebookUrl":"https://facebook.com/daisuke.okajima.14","githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"大介 岡嶋","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/59073/profile-images/1560256459","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F59073%2Fprofile-images%2F1560256459?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=841ead2f930fdec1d1829170462231a4","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F59073%2Fprofile-images%2F1560256459?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=4d436e7a8eb9ada03d337aa8d43849c7","urlName":"okajima","websiteUrl":"https://ja.poderosa-terminal.com/","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"Windows","urlName":"windows"},{"name":"C#","urlName":"csharp"},{"name":"MacOSX","urlName":"macosx"},{"name":"Xamarin","urlName":"xamarin"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
