More than 1 year has passed since last update.コンソールで一行用のプログレスバーを作る時は"\r"(Cr、キャリッジリターン)が使用されるのは割と有名ですが、これでは一行を過ぎると戻らなくなってしまいます。
ここでは、1行目にゲージを、2行目以降にメッセージを表現するプログレスバーの例を記述します。


コンソールのカーソルの位置を記憶して、標準出力後に戻してます。
Node.jsではカーソルの位置の取得ができなかったので、コンソールの最大桁数と出力する文字バイト幅から何行分に相当するか計算して、相対座標で移動しています。
Node.jsのバイト数の計算はこちらのUnicode表に基づいて、半角全角判別するメソッドを書いて使用しています。(とりあえず、半角英数記号に加えてラテンBまでと半角カナ、半角ハングルまでを半角(1バイト)として計算。この区分分けについてベターと言えそうなものがなかったので自分で実装。)
Pythonの方は文字のコードから文字種の判別できるようなので、そレを利用しています。なお、Python3については標準じゃ厳しかったのでcoloramaを使用しています。
インストールはpipから次のように行っています。Node.jsではWindowsでもANSIエスケープコードが使えるみたいですね。
流石replやnpmがやたらカラフルなだけあって感心したのですが、拡張色選ぼうとしたらバグったので使えるのは7色だけのようです。なお、Python3でだけcolorama使用しても何故か背景色が変わりませんでした...
他の言語と見た目が若干変わるのは妥協の証。


