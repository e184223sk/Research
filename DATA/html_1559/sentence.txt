More than 1 year has passed since last update.最近ASP.NETでWEBアプリ開発してますが、macOS版の情報無さすぎワロタ。
なのでささやかながらvisual studio for macの情報を共有していきたいと思います。今回は、ASP.NETとMySQLを接続する方法について書いていきます。プロジェクトを作成する段階から初めて行こうと思います。まずvisual studio for macを起動して。
new→Webアプリケーション（MVC）→認証無しと続き、
プロジェクト名は「TestApp」 としておきます。MySQLにデータベースを作るのが目的ですが、接続した後に確認ができる様にコントローラーとビューをいじっていきます
今回は新しく「TestController」を作ります
Controllersディレクトリ上で右クリックして「追加」→「コントローラークラス」で名前をつけます
「Views」ディレクトリのなかに「Test」ディレクトリ、その中に「Razorページ」で「Index.cshtml」を作成します。
奈きみはこの様に記述します。ここからモデルを操作します。
まずModelsディレクトリで右クリックし、「空のクラス」を作成、名前は「Book」します。
中身を下記の様に記述します。
この記述がカラムとデータ型を指定しています次にコンテキストを用意します。
Bookクラスで定義したデータをデータベースに橋渡しするのがコンテキストクラスの役割です。
コンテキストクラスを作成する前にNuGetで必要なパッケージをインストールします上記のパッケージをインストールできたら、
Bookクラス同様に空のクラスを作成し、下記の様に記述します。appsettings.jsonを編集します最後にStartup.csを編集します。ここまでできたらターミナルに移ります。
作業ディレクトリはTestApp/TestApp、このコマンドを打ち込めばMySQLにデータベースができているはずです
せっかくなのでMySQLに直接データを打ち込んでデータ呼び出しまでやります。
TestControllerに以下を記述します。コンテキストのインスタンスを宣言し、コンストラクタで自身のフィールドに代入、
データを呼び出したいビューに、引数を入れてあげるという流れです。ビューの方を記述してあげます。
予めMySQLに直でデータを打ち込んでいます。
呼び出しはforeach文を使って繰り返し表示してあげます。１行目では渡されたモデルに応じて@modelディレクティブでその型を宣言します。
中身はIEnumerable型になっています。
モデルにアクセスするためにはModelを使います。これで呼び出し完了です。
ローカル環境でここまでの実装を最終確認するために、画面左上の三角マークをクリックしてhttps://localhost:ポートNo/Testでブラウザを開いてください。

こんな画面になっていたら実装完了です。ここまでご覧いただきありがとうございました。
間違っていることがありましたらご指摘お願いします。MySQLと接続するのに「MySQL.Data.EntityFrameworkCore」というパッケージNuGetでインストールして用いる方が結構いらっしゃいました。
私も最初はそちらでやりましたが、うまくいかず「Pomelo.EntityFrameworkCore.MySql」に切り替えまして、そちらでうまくいきました。
英語のStackOverFlowをみてみると「MySQL.Data.EntityFrameworkCore」と「Pomelo.EntityFrameworkCore.MySql」は共存できない様です。また、多くの方はdotnet efコマンドを使うために「Microsoft.EntityFrameworkCore.Tools.DotNet」というパッケージをインストールしてましたが、前述のパッケージのみでイけました。


