More than 3 years have passed since last update.どうも、この度大学生になりました、drumathです。
さて、今回はUnityについての記事を書こうと思います。とはいえほんの小ネタですが、どうぞお付き合いください。3Dゲームだと、敵を撃ったりするモーションがよくあるじゃないですか。そんなものを作りたいと考えまして、自分なりに作ってみました。どんな砲台を作るのかというと、以上です。まずはオブジェクトを置いていきましょう。最初に必要なものは3個だけ、
ヒエラルキービューで右クリック→3D Object→Plane, Cylinder, Sphereを選択し、置きます。

3つのオブジェクトをそれぞれ、「ground」「battery」「ammunition」と名付けました。
テキトーにマテリアルも設定しておきます。

そしたら次に、砲台の発射口となるEmptyObjectをbatteryの子要素として作ります。このオブジェクトの位置を複製した砲弾オブジェクトの初期値として渡します。

次に、ammunitionオブジェクトに、Rigidbodyをアタッチします。設定はデフォルトのままで。好みでCollisionにPhysicsMaterialを設定してみてもいいと思います。私は反発係数をつけたかったのでそうしました。それができたら、ヒエラルキービューからアセットのほうへD&amp;Dしてプレハブ化しましょう。これで砲弾の設定が終わりました。


次に、batteryオブジェクトにC#スクリプトをアタッチします。名前は「batteryController」にしました。
先ほどbatteryにアタッチした、スクリプトを以下のように編集しました。わずか40行にも満たないコードですが、これで左右回転する砲台のスクリプトが完成しました。
補足をします。うえの3つの変数はすべてPublicな変数ですので、あとでUnity上で格納してやる必要があります。
portには砲台の子要素に設定した発射口のEmptyObjectを入れてください。
ammunitionにはプレハブ化したammunitionオブジェクトをD&amp;Dして格納します。
forceStrengthには好みの強さをUnity上で入れてください。なんかオブジェクトが生成されるけど打ち出されない･･･なんて時にはこいつの設定が小さすぎるか、設定してないかだと思います。次にUpdate()の中身ですが、
まず、一行目ではスペースが押されたら発火するような条件が組まれています。
2行目はInstantiate()を使ってammutionオブジェクトをportの位置で複製しています。これを変数gに格納します。
3行目では、先ほど複製したオブジェクト、gに瞬間的な力積を与えることで飛ばします。その方向はtransform.upつまり上方向です。
4行目では、gをDestroy関数で削除していますが、よくみると、第2引数に5が設定されています。これは5秒後に削除するという意味です。実際これもpublicな変数にすればあとから変更も利きますね。お好みでどうぞ。ここはわかりやすいですよね。左右の矢印キーが押されている間、指定の方向に回転しているだけです。
今回は以上です。最後まで見ていただき、ありがとうございました。


