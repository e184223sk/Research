More than 3 years have passed since last update.ASP.NET Core Web Applicationで、IServiceProvider(DIコンテナ)に登録されるコンポーネントの情報を確認してみます。Startupクラスに下記のようなShowComponents()メソッドを追加し、ConfigureServices()の最後で呼び出します。上記により、IServiceProviderに登録されるコンポーネントの情報がわかります。登録されるコンポーネントのインスタンス解決方法については、以下の3種類があります。また、ライフサイクルについては以下の三種類があります。AddMvc()しただけのプロジェクトでの出力結果を以下に載せておきます。順序についてはソート済みで、名前空間は一部略記にしてあります。名前空間の略記は、「M.A」が「Microsoft.AspNetCore」、「M.E」が「Microsoft.Extensions」、「S」が「System」の略になります。一部、同一の情報が登録されているものがありますが、これはAddXxx()メソッド内などにおいて、それぞれの処理が必要とするコンポーネントの情報が個別に登録されているためです。ASP.NET Coreでは同一の登録情報が複数件あった場合、そのうちの1件の情報を元にインスタンスの解決が行われることを想定しています。標準のIServiceProvider(Microsoft.Extensions.DependencyInjection)では最後に登録された情報が使用されます。色々なAddXxx()をした状態で登録されているものを確認してみると面白いかも(・ω・)


