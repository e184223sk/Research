<!DOCTYPE html><html><head><meta charset="utf-8" /><title>.NET FrameworkからのExcel操作 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/tomohideyo/items/f46eab04b86316d917c5" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="WFA7rxA9/CZLL5lKjcQnTf9/PVrn59BRMdytkLb+n+eYHPwhVpqCAlRUtnmoljocGKnNkYgRAExzMVT4RMHU0Q==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content=".NET FrameworkからのExcel操作 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1MazVGVkNCR2NtRnRaWGR2Y212amdZdmpnb25qZ2E1RmVHTmxiT2FUamVTOW5BJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWFiYzNiN2NjNTI1OTk0ZTFhMzlhMGJhMTE4MDU1OGE0&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSFJ2Ylc5b2FXUmxlVzgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz05MTYxYThhZWIzZGY3YzU3Y2FjYzFkMDhhYTliY2YwOQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=e689004155f45910605c9020305e086a"><meta property="og:description" content="本記事は2012年末頃に、社内向けに作成した説明資料をQiita向けに編集したものです。
最新の仕様とは異なる場合があるので注意してください。


はじめに

　.NET Frameworkには「COM相互運用1」と呼ばれる機能があり..."><meta content="https://qiita.com/tomohideyo/items/f46eab04b86316d917c5" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Excel,.NETFramework" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-81e6ae70-3dad-4f1d-8164-fea63260af18"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Ftomohideyo%2Fitems%2Ff46eab04b86316d917c5">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Ftomohideyo%2Fitems%2Ff46eab04b86316d917c5">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-81e6ae70-3dad-4f1d-8164-fea63260af18">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-08-29T17:07:55.000+09:00","dateModified":"2019-08-29T17:14:58.000+09:00","headline":".NET FrameworkからのExcel操作","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1MazVGVkNCR2NtRnRaWGR2Y212amdZdmpnb25qZ2E1RmVHTmxiT2FUamVTOW5BJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWFiYzNiN2NjNTI1OTk0ZTFhMzlhMGJhMTE4MDU1OGE0\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSFJ2Ylc5b2FXUmxlVzgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz05MTYxYThhZWIzZGY3YzU3Y2FjYzFkMDhhYTliY2YwOQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=e689004155f45910605c9020305e086a","mainEntityOfPage":"https://qiita.com/tomohideyo/items/f46eab04b86316d917c5","author":{"@type":"Person","address":"","email":null,"identifier":"tomohideyo","name":"tomohideyo","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Flh4.googleusercontent.com%2F-IEcgZNtrBa0%2FAAAAAAAAAAI%2FAAAAAAAAAAc%2FG7JSCX54aMo%2Fs50%2Fphoto.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=3cd3aa11e5836b6919dde752f163ea17","url":"https://qiita.com/tomohideyo","description":"システムエンジニアという漠然とした概念つまり社会の歯車。 ","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tomohideyo","type":"items","id":"f46eab04b86316d917c5"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tomohideyo","type":"items","id":"f46eab04b86316d917c5"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tomohideyo","type":"items","id":"f46eab04b86316d917c5"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/tomohideyo/items/f46eab04b86316d917c5","location":"/tomohideyo/items/f46eab04b86316d917c5","scheme":"https","host":"qiita.com","port":null,"pathname":"/tomohideyo/items/f46eab04b86316d917c5","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"Loe15YmgI+mPy+4MKfXUDJmJpwJbJXWQ7FOS0LIJ947uy3JrzwddzZCwwT8Mp8ldfl9XyTTTpY2uvmu4QDa8uA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-39f25b24-201c-4498-95d7-3ccf582fcebb"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/tomohideyo/items/f46eab04b86316d917c5/likers" class="css-1iupg5d">25</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">24</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/f46eab04b86316d917c5/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/tomohideyo/items/f46eab04b86316d917c5/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/tomohideyo/items/f46eab04b86316d917c5/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/tomohideyo/items/f46eab04b86316d917c5/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/tomohideyo/items/f46eab04b86316d917c5.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/tomohideyo"><img class="css-100alwu eyfquo10" src="https://lh4.googleusercontent.com/-IEcgZNtrBa0/AAAAAAAAAAI/AAAAAAAAAAc/G7JSCX54aMo/s50/photo.jpg" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/tomohideyo" class="css-10ougpm">@<!-- -->tomohideyo</a><div class="css-1ay9vb9"><span><meta content="2019-08-29T08:07:55Z"/><time dateTime="2019-08-29T08:14:58Z" class="css-m19uds">updated at 2019-08-29</time></span></div></div></div></div></div><h1 class="css-cgzq40">.NET FrameworkからのExcel操作</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/excel" class="css-4czcte">Excel</a><a href="/tags/.netframework" class="css-4czcte">.NETFramework</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><strong>本記事は2012年末頃に、社内向けに作成した説明資料をQiita向けに編集したものです。</strong><br>
<strong>最新の仕様とは異なる場合があるので注意してください。</strong></p>

<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>　.NET Frameworkには「COM相互運用<sup id="fnref1"><a href="#fn1" title="簡単に言うと、アプリを外から操作する技術">1</a></sup>」と呼ばれる機能があり、COMコンポーネント<sup id="fnref2"><a href="#fn2" title="COMを使用して開発されたソフトウェア">2</a></sup>を手軽に呼び出すことができます。一方、ExcelをはじめとするOffice製品は、その機能をマクロ（VBA）などからも活用できるようにCOMコンポーネントとして実装されています。このため、COM相互運用を使えば.NETアプリケーションから容易にExcelやWordのファイルを開き、それをさまざまに操作することが可能です。</p>

<p>　本記事ではC#で作成されたサンプルアプリケーションのソースコードを基に、COM相互運用機能を用いてExcelファイルを操作する方法を説明します。<br>
　使用しているVisual Studioのバージョンは” Microsoft Visual Studio Express 2012 for Windows Desktop”です。ただし、Visual Studioの旧バージョンとの差は見た目ぐらいですので、特に問題はないと思います。<br>
　.Net Frameworkのバージョン、およびC#のバージョンに依存している記述などについては、その都度言及して、補足を行なっていきます。</p>

<p>　以降の章では、サンプルアプリケーションのうち、Excelファイルを操作している部分に着目して説明を行なっていきます。ファイルの存在チェックや出力のフォーマットに関しては、本書の目的とそれるので割愛します。サンプルプロジェクトのソースファイルを見てください。</p>

<h1>
<span id="事前バインディング" class="fragment"></span><a href="#%E4%BA%8B%E5%89%8D%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>事前バインディング</h1>

<p>　本章では、C#からExcelを操作する上で一般的に使用される「事前バインディング」方式を用いて、Excelファイルを操作する手順を説明します。<br>
　「事前バインディング」方式とは、文字通り事前に必要なDLLの参照設定を行なっておき、そのDLL使用する方式です。参照を追加するため、コードの補完機能などが使用出来るので、Excelを操作するコーディングを行う上でも一番やりやすい方法となります。<br>
　以下に、「事前バインディング」方式によるExcelファイルを操作する手順を示していきます。</p>

<h2>
<span id="プロジェクトへ参照を追加" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%B8%E5%8F%82%E7%85%A7%E3%82%92%E8%BF%BD%E5%8A%A0"><i class="fa fa-link"></i></a>プロジェクトへ参照を追加</h2>

<p>　まずは、事前バインディングの名の通り、Excelファイルを操作するためのDLL参照を設定します。<br>
　[プロジェクト]メニュー – [参照の追加]をクリックし、参照マネージャーを起動してください。ソリューションエクスプローラーから見える参照設定の右クリックメニューからでも同様の操作が行えます。<a href="https://camo.qiitausercontent.com/f4aa62db84c2d1e6c030659415cf303cfd0f24da/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f35623038323663662d646431302d346562322d346134382d6534623238313130333565352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F5b0826cf-dd10-4eb2-4a48-e4b2811035e5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=18a27cc2a749aff59dba3986acf0a626" alt="図3.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/5b0826cf-dd10-4eb2-4a48-e4b2811035e5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F5b0826cf-dd10-4eb2-4a48-e4b2811035e5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f134e66bf6e9e207d211cbc43a4204a7 1x" loading="lazy"></a><br>
　参照マネージャーの[COM]タブをクリックし、表示されるライブラリーの一覧から「Microsoft Excel XX Object Library」を選択します。インストールされているExcelのバージョンによって、XXの部分に表示されるライブラリーのバージョン番号が異なります。<br>
<a href="https://camo.qiitausercontent.com/8d803a03ba2b8fce37cb5dfa19497206a01923f0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f38313136316131382d666337342d353164642d313163312d3862616437393766653963322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F81161a18-fc74-51dd-11c1-8bad797fe9c2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9f4c2d79ca1802d9294597a6b04b898a" alt="図4.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/81161a18-fc74-51dd-11c1-8bad797fe9c2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F81161a18-fc74-51dd-11c1-8bad797fe9c2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ebcc441cb950b99b1e5ffae14f4f0ffa 1x" loading="lazy"></a></p>

<table>
<thead>
<tr>
<th style="text-align: center">Officeのバージョン</th>
<th style="text-align: center">ライブラリのバージョン<sup id="fnref3"><a href="#fn3" title="「13」は忌み数なので欠番">3</a></sup>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center">Microsoft Office 2010</td>
<td style="text-align: center">14.0</td>
</tr>
<tr>
<td style="text-align: center">Microsoft Office 2007</td>
<td style="text-align: center">12.0</td>
</tr>
<tr>
<td style="text-align: center">Microsoft Office 2003</td>
<td style="text-align: center">11.0</td>
</tr>
<tr>
<td style="text-align: center">Microsoft Excel 2002</td>
<td style="text-align: center">10.0</td>
</tr>
<tr>
<td style="text-align: center">Microsoft Excel 2000</td>
<td style="text-align: center">9.0</td>
</tr>
<tr>
<td style="text-align: center">Microsoft Excel 97</td>
<td style="text-align: center">8.0</td>
</tr>
</tbody>
</table>

<p>　参照の追加が行われたら、ソリューションエクスプローラーの参照設定に「Micorosoft.Office.Core」と「Microsoft.Office.Interop.Excel」が追加されるのが見て取れます。<br>
<a href="https://camo.qiitausercontent.com/71e4ee2684f5d42d935298f2cd48886f3d961508/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f62343234323437392d366466322d373230362d616366342d6462346363623461346565622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Fb4242479-6df2-7206-acf4-db4ccb4a4eeb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=dff32710f54350da51e01a56cabef6d9" alt="図5.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/b4242479-6df2-7206-acf4-db4ccb4a4eeb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Fb4242479-6df2-7206-acf4-db4ccb4a4eeb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=91447381b170b56b35d7e1d5bbe6b5dd 1x" loading="lazy"></a><br>
　最後に、バインドした参照のうち、使用するクラスが含まれている名前空間を追加します。追加する名前空間は「Microsoft.Office.Interop.Excel」になります。<br>
<a href="https://camo.qiitausercontent.com/42918c57af529641212922c7bccfa27142885366/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f32346266653839662d633837642d353334652d326461632d6231323633303533653465662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F24bfe89f-c87d-534e-2dac-b1263053e4ef.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e4df3caff8f6e9aafc70caf1550d994b" alt="図6.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/24bfe89f-c87d-534e-2dac-b1263053e4ef.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F24bfe89f-c87d-534e-2dac-b1263053e4ef.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=31d07ebaabf848623a73efe2a001cfd8 1x" loading="lazy"></a><br>
　名前空間の追加が正しく行われると、コーディング時にコードサジェストが行われます。<br>
<a href="https://camo.qiitausercontent.com/6ca6abdf077418da77bebda516f14f47735b6427/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f66306233386435322d303637622d633534622d646664652d3138383136396230326465662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Ff0b38d52-067b-c54b-dfde-188169b02def.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ba24e5bd0c1fc75a67f5982e2244bb40" alt="図7.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/f0b38d52-067b-c54b-dfde-188169b02def.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Ff0b38d52-067b-c54b-dfde-188169b02def.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=45b17c6d83987d46d8d2c4659beebb1f 1x" loading="lazy"></a></p>

<h2>
<span id="ソースコード解説" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC"><i class="fa fa-link"></i></a>ソースコード解説</h2>

<p>　ここからは、サンプルコードを元に、C#からどのようにExcelを操作するかを説明します。<br>
　操作は主に5ステップ存在します。<br>
　　　1. ファイルオープンなどの前処理<br>
　　　2. シート、セルの領域指定<br>
　　　3. 選択したセル領域から値の取得<br>
　　　4. 取得した値の詰め替え<br>
　　　5. ファイルクローズなどの後処理<br>
　以下、ステップごとに行う処理について説明します。<br>
　サンプルコードの全文はAppendix. 「事前バインディング」を参照してください。</p>

<h3>
<span id="前処理" class="fragment"></span><a href="#%E5%89%8D%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>前処理</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// ファイルオープン</span>
<span class="n">Application</span> <span class="n">xlApp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Application</span><span class="p">();</span>
<span class="n">Workbooks</span> <span class="n">xlBooks</span> <span class="p">=</span> <span class="n">xlApp</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">;</span>
<span class="n">Workbook</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span>
    <span class="n">ExcelFileName</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span>
<span class="p">);</span>
</code></pre></div></div>

<table>
<thead>
<tr>
<th style="text-align: left">行</th>
<th style="text-align: left">解説</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">2</td>
<td style="text-align: left">Applicationインスタンスの生成。<br>xlAppにExcelを操作するMicrosoft.Office.Interop.Excel.Application COMオブジェクトクラスのインスタンスが格納されます。</td>
</tr>
<tr>
<td style="text-align: left">3</td>
<td style="text-align: left">xlAppが持つWorkbooksプロパティ（MDIの親玉）を取得。</td>
</tr>
<tr>
<td style="text-align: left">4〜10</td>
<td style="text-align: left">xlBooksに、ExcelFileNameで指定したファイルをオープンし、そのインスタンスをxlBookに格納します。<br>第2引数以降で指定している”Type.Missing”で、パラメーターの既定値（所謂デフォルトパラメータ）を使用するようメソッドに通知しています。<br>Workbooks.Openメソッドの引数の詳細については、<a href="http://msdn.microsoft.com/ja-jp/library/microsoft.office.interop.excel.workbooks.open(office.11).aspx" rel="nofollow noopener" target="_blank">こちら</a>を参照してください。</td>
</tr>
</tbody>
</table>

<p>　なお、C# 4.0 (Visual Studio 2010)からはデフォルトパラメータを省略できるようになったので、4行目のExcelファイルのオープン処理は、以下のように記述することが可能です。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="n">Workbook</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span> <span class="n">ExcelFileName</span> <span class="p">);</span>
</code></pre></div></div>

<p>　ExcelのCOMオブジェクト構成は、</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>Application
└ Workbooks[]
　├ Workbook
　│ ├ Sheets[]
　│ │ ├ Sheet1
　│ │ │ ├ Cells[]
　│ │ ├ Sheet2
　│ │ ├ Sheet3
　│ │ ├ ：
　├ Workbook
　├ Workbook
　├ 　：
</code></pre></div></div>

<p>となっており、操作対象となるセルオブジェクトに到達するまで、上位のオブジェクトから順次取得して行く必要があります。上述の前処理で行ったのは、この内上位3階層分のオブジェクトの取得処理に当たります。</p>

<h3>
<span id="シートセルの領域指定" class="fragment"></span><a href="#%E3%82%B7%E3%83%BC%E3%83%88%E3%82%BB%E3%83%AB%E3%81%AE%E9%A0%98%E5%9F%9F%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a>シート、セルの領域指定</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// シートを選択</span>
<span class="n">Worksheet</span> <span class="n">sheet</span> <span class="p">=</span> <span class="n">xlBook</span><span class="p">.</span><span class="n">Sheets</span><span class="p">[</span><span class="s">"メンバー一覧"</span><span class="p">];</span>

<span class="c1">// セルの領域を選択</span>
<span class="n">Range</span> <span class="n">TableRange</span> <span class="p">=</span> <span class="n">sheet</span><span class="p">.</span><span class="n">Range</span><span class="p">[</span><span class="s">"A1"</span><span class="p">,</span> <span class="s">"B15"</span><span class="p">];</span>
</code></pre></div></div>

<table>
<thead>
<tr>
<th style="text-align: left">行</th>
<th style="text-align: left">解説</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">２</td>
<td style="text-align: left">OpenしたExcelファイルから、”メンバー一覧”シートを指定して取得します。<br>Sheets[]コレクションは、要素番号とシート名どちらでもアクセスできます。今回操作対象シートが明確なのでシート名でアクセスしています。</td>
</tr>
<tr>
<td style="text-align: left">５</td>
<td style="text-align: left">”メンバー一覧”シートの領域$A$1:$B$15を示すオブジェクトを取得します。<br>領域取得には他に、<br>　　Range TableRange = sheet.Range["A1:B15"];<br>というふうに、1次元目だけを使用した記述方法も可能です。</td>
</tr>
</tbody>
</table>

<p>　領域オブジェクトを取得する操作は、上記の他にget_Range()メソッドが存在します。<br>
　しかし、get_Range()には後方互換性の不備があり、<font color="Red"><strong>.NET Frameworkのある特定の更新に限り正常に動作しないというバグが存在します。</strong></font><br>
　領域オブジェクトを取得する際には、Range[]アクセサーからの取得を推奨します。</p>

<h3>
<span id="選択したセル領域から値の取得" class="fragment"></span><a href="#%E9%81%B8%E6%8A%9E%E3%81%97%E3%81%9F%E3%82%BB%E3%83%AB%E9%A0%98%E5%9F%9F%E3%81%8B%E3%82%89%E5%80%A4%E3%81%AE%E5%8F%96%E5%BE%97"><i class="fa fa-link"></i></a>選択したセル領域から値の取得</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// 選択した領域の値をメモリー上に格納</span>
<span class="kt">object</span><span class="p">[,]</span> <span class="n">values</span> <span class="p">=</span> <span class="n">TableRange</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
</code></pre></div></div>

<table>
<thead>
<tr>
<th style="text-align: left">行</th>
<th style="text-align: left">解説</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">２</td>
<td style="text-align: left">選択した領域の値を配列に格納しています。<br>領域オブジェクトのValueまたはValue2プロパティは、まとめて取得されメモリー上に配置されます。<br>今回、セルには文字が書き込まれているので、セルの書式設定が日付/通貨の時のみ意味があるValue2ではなく、Valueで取得しています。</td>
</tr>
</tbody>
</table>

<p>　領域オブジェクトから、値を二次元配列に格納するという手法は、Excel VBAでもよく使われる高速化テクニックの一つです。領域内のセルをループで取得するのに比べ、格段に早くすることができます。<br>
　なお、たとえ一列しか選択していなくても二次元目の深さが１である二次元配列になります。<br>
　また、<strong>配列の添字は１が最初です</strong>。要素0へアクセスすると例外が発生するので、注意してください。</p>

<h3>
<span id="取得した値の詰め替え" class="fragment"></span><a href="#%E5%8F%96%E5%BE%97%E3%81%97%E3%81%9F%E5%80%A4%E3%81%AE%E8%A9%B0%E3%82%81%E6%9B%BF%E3%81%88"><i class="fa fa-link"></i></a>取得した値の詰め替え</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// 配列アクセスができるので、それぞれをDictionaryに追加</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="n">values</span><span class="p">.</span><span class="nf">GetLength</span><span class="p">(</span><span class="m">0</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
<span class="p">{</span>
    <span class="n">dic</span><span class="p">.</span><span class="nf">Add</span><span class="p">((</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">1</span><span class="p">],</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">2</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div>

<table>
<thead>
<tr>
<th style="text-align: left">行</th>
<th style="text-align: left">解説</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">２〜5</td>
<td style="text-align: left">値を格納した二次元配列から値を取り出し、それぞれkeyとvalueとしてDictionaryに格納しています。配列の添字は１が最初。</td>
</tr>
</tbody>
</table>

<h3>
<span id="後処理" class="fragment"></span><a href="#%E5%BE%8C%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>後処理</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// 使用したCOMオブジェクトを解放</span>
<span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">TableRange</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>

<span class="c1">// Excelのクローズ</span>
<span class="n">xlBook</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
<span class="n">xlApp</span><span class="p">.</span><span class="nf">Quit</span><span class="p">();</span>

<span class="c1">// 使用したCOMオブジェクトを解放その２</span>
<span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBook</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBooks</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlApp</span><span class="p">);</span>
</code></pre></div></div>

<table>
<thead>
<tr>
<th style="text-align: left">行</th>
<th style="text-align: left">解説</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">２〜3</td>
<td style="text-align: left">使用したRangeやSheetのCOMオブジェクトを解放します。</td>
</tr>
<tr>
<td style="text-align: left">6</td>
<td style="text-align: left">Close()メソッドにより、ファイルをクローズします。</td>
</tr>
<tr>
<td style="text-align: left">7</td>
<td style="text-align: left">Quit()メソッドにより、アプリケーションを終了します。</td>
</tr>
<tr>
<td style="text-align: left">10〜12</td>
<td style="text-align: left">使用したApplicationやWorkbooksなどのCOMオブジェクトを解放します。後ほど詳しく説明します。</td>
</tr>
</tbody>
</table>

<p>　ReleaseComObject()／FinalReleaseComObject()メソッドは、COMオブジェクトの参照カウントを1／すべて減らすメソッドです。<br>
　参照カウント絡みの話は割りと深く面倒くさいものですので、今はあまり時間がないけどとにかく使えるようになりたい方は、「COMは、メモリーのalloc()/free()と同様に、使用者が管理するもの」という程度に理解していただければまず十分です。詳しく知りたい方はAppendix. 「COMの仕組み」をお読みください。<br>
　なお、COMオブジェクトが正しく解放されなかった場合、<font color="Red"><strong>Excelのプロセスが残り続けてしまいます</strong></font>。オブジェクトの解放忘れには十分に注意してください。</p>

<h2>
<span id="comオブジェクトを解放し忘れる典型的パターン" class="fragment"></span><a href="#com%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E8%A7%A3%E6%94%BE%E3%81%97%E5%BF%98%E3%82%8C%E3%82%8B%E5%85%B8%E5%9E%8B%E7%9A%84%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>COMオブジェクトを解放し忘れる典型的パターン</h2>

<p>　以下に、解放を忘れるパターンを示します。この記述を行うとCOMオブジェクトの解放し忘れにつながるため、<strong>使用してはいけません</strong>。この記述を見つけた場合、速やかに指摘してあげてください。</p>

<ol>
<li>一気にOpen<br>一般的にC#でファイルをオープンするときは、以下の様な記述をすることがよくあります。<br>
　　FileStream fs = System.IO.File.Open(filename, FileMode.Open);<br>
これと同じ感覚でExcelファイルのオープンを記述すると<br>
　　Workbook book = new Application().Workbooks.Open(ExcelFileName);<br>
となりますが、ApplicationオブジェクトとWorkbooksオブジェクトをどの変数にも格納していないため、後々ReleaseComObject()で解放することができず、COMオブジェクトが残存します。COMオブジェクトを返すメソッドやプロパティでは、面倒でもひとつひとつ変数に格納して行きましょう。</li>
<li>Cellsプロパティ<br>セルの領域を取得する方法として、上ではRange[]アクセサーを使用する方法を紹介しましたが、Cellsプロパティを使用して取得することもできます。<br>
　　　Range TableRange = sheet.Cells["A1", "B15"];<br>
しかし、CellsプロパティはCOMオブジェクトを返すので、上記の記述ではCellsを受け取る変数がおらず、COMオブジェクトを開放することができません。<br>
　（実際はこうなっている）<br>
　　Range TableRange = sheet.Cells.Range["A1", "B15"];<br>
Cellsプロパティを使用して各セルにアクセスする場合は、Cellsのオブジェクトを変数に格納し、そこから各セルのRangeオブジェクトをアクセサーで取得する必要があります。<br>
　　Range cells = sheet.Cells;    // cellsはあとでReleaseComObject()で解放する<br>
　　Range TableRange = cells["A1", "B15"];<br>
</li>
</ol>

<p>　その他、COMオブジェクトを返すプロパティを、変数へ格納せずに使用している箇所はすべて解放忘れにつながります。発見次第、修正してください。COMオブジェクトを返すプロパティについては、Appendix.「COMオブジェクトを返すプロパティ」を参照してください。</p>

<h1>
<span id="遅延バインディング" class="fragment"></span><a href="#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>遅延バインディング</h1>

<p>　「遅延バインディング」方式とは、DLLやCOM内のクラス・関数を、必要になったときに、必要な分だけ実行時に読み込む機能です。実行時に読み込まれるということは、プログラマーはそのDLLの存在やバージョンについて、実装時に意識する必要がなくなるということになります<sup id="fnref4"><a href="#fn4" title="実行時にDLLが存在しないと行けないし、バージョン依存の記述もあるでしょうから、一概にすべて意識する必要がなくなるという訳でもないですが……">4</a></sup>。<br>
　バージョンを意識する必要がなくなるため、事前バインディングの時のように、Excelのバージョンに応じてライブラリーを読み込む必要がなく、将来新しいバージョンのExcelが出てきたとしても、プログラムに改変を加えることなくサポートできる可能性が高いということになります。<br>
　以下に、「遅延バインディング」方式によるExcelファイルを操作する手順を示していきます。</p>

<h3>
<span id="ソースコード解説-1" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC-1"><i class="fa fa-link"></i></a>ソースコード解説</h3>

<p>　サンプルコードを元に、遅延バインディングを使用してC#からExcelを操作する方法を説明します。<br>
　操作自体は事前バインディングと同じ5ステップで、ステップごとに行っている処理も同様のため省略し、ここでは、遅延バインディング独特の構文について説明します。<br>
　サンプルコードの全文はAppendix.「遅延バインディング」を参照してください。<br>
　以下に例として、前処理で行うExcelファイルオープン処理を、遅延バインディング形式で記述したものを示します。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// ファイルオープン</span>
<span class="kt">object</span> <span class="n">xlApp</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">Type</span><span class="p">.</span><span class="nf">GetTypeFromProgID</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">));</span>
<span class="kt">object</span> <span class="n">xlBooks</span> <span class="p">=</span> <span class="n">xlApp</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Workbooks"</span><span class="p">,</span> 
    <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">xlApp</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
<span class="kt">object</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Open"</span><span class="p">,</span>
    <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">xlBooks</span><span class="p">,</span>
    <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span>
        <span class="n">ExcelFileName</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
        <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
        <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
        <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
        <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span>
    <span class="p">});</span>
</code></pre></div></div>

<p>　突然摩訶不思議な記述になりましたが、処理の内容自体は事前バインディングの時と何らかわりがありません。Applicationオブジェクトを作成し、Workbooksプロパティを取得し、Workbookをオープンしているだけです。ここでは、その摩訶不思議な部分であるActivator.CreateInstance()、Type.GetTypeFromProgID()、Type.InvokeMember()メソッドの解説を行います。</p>

<ul>
<li>Type.GetTypeFromProgID()<br>
指定したプログラムID(ProgID)に関連付けられている型を取得します。ここで指定している引数は”Excel.Application”なので、取得できる型はMicrosoft.Office.Interop.Excel.Applicationクラスとなります。</li>
<li>Activator.CreateInstance()<br>
CreateInstanceメソッドは、指定した引数に最も一致するコンストラクターを呼び出して、アセンブリで定義された型のインスタンスを作成します。つまり、Applicationクラスのインスタンスを作成してくれます。</li>
<li>Type.InvokeMember()<br>
InvokeMemberは、引数の文字列と一致するメソッドやメンバーの操作を行うメソッドです。コンストラクターのメンバーまたはメソッドのメンバーの呼び出し、プロパティのメンバーの取得または設定、データフィールドのメンバーの取得または設定、または配列のメンバーの要素の取得または設定を行います。<br>身も蓋もなく日本語に直すなら「”第4引数”から、”第1引数”のプロパティまたはメソッドを、[”第5引数”のobject配列を”第3引数”に変換したものを引数として] ”第2引数”します」という感じ。</li>
</ul>

<table>
<thead>
<tr>
<th style="text-align: left">引数インデックス</th>
<th style="text-align: left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">第1引数</td>
<td style="text-align: left">メンバー名、メソッド名の文字列</td>
</tr>
<tr>
<td style="text-align: left">第2引数</td>
<td style="text-align: left">クラスへのアクセス用フラグ</td>
</tr>
<tr>
<td style="text-align: left">第3引数</td>
<td style="text-align: left">引数のコンバータ用クラス</td>
</tr>
<tr>
<td style="text-align: left">第4引数</td>
<td style="text-align: left">制御対象インスタンス</td>
</tr>
<tr>
<td style="text-align: left">第5引数</td>
<td style="text-align: left">メソッド引数</td>
</tr>
</tbody>
</table>

<p>　上述の例のように、基本的にはCOMオブジェクトを操作する処理をInvokeMember()メソッドに書き換えることで、遅延バインディング方式の記述となります。</p>

<h3>
<span id="遅延バインディングのデメリット" class="fragment"></span><a href="#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88"><i class="fa fa-link"></i></a>遅延バインディングのデメリット</h3>

<p>　Excelのバージョンに寄らず記述できる遅延バインディングですが、以下の様なデメリットが存在します。</p>

<ol>
<li>Excel操作クラスの形を自分で知る必要がある<br>
DLL参照を追加しておけばIntellisenseによる補完機能が働きますが、遅延バインディングでは参照を追加しないためその機能は働いてくれません。自分が操作したいCOMオブジェクトのメソッドやプロパティ名が正しいかどうかは、自分の目で確かめる必要があります。</li>
<li>実行時にしか正当性が判別できない<br>
(1)と同様に、Intellisenseによる誤り訂正が働かないので、実際に実行してみるまでメソッド名を正しく記述できたかどうかはわかりません。そして、間違っていた場合は例外が発生することもあるので、例外処理をおこなっていないとCOMオブジェクトが解放されずに……</li>
<li>記述がとても長くなる<br>
例を見ればわかるように、あからさまに横に伸びます。ただでさえCOMの解放処理で縦に伸びているのに、これで横にまで伸びてしまうのは明らかに可読性が下がっていきます。ただでさえInvokeMethod()は可読性が悪いのに……</li>
</ol>

<h1>
<span id="c-40-dynamicキーワードを用いた遅延バインディング" class="fragment"></span><a href="#c-40-dynamic%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>[C# 4.0] dynamicキーワードを用いた遅延バインディング</h1>

<p>　C# 4.0で導入された、動的言語との連携の仕組みの1つが動的型付け変数（dynamicキーワード）です。動的型付け変数を使うことで、動的な（コンパイル時にメンバー情報がわからない型の）メンバーアクセスが可能になります。このdynamicキーワードを用いると、先ほど指摘した遅延バインディングのデメリットがほぼ解消されます。早速、前処理で行うExcelファイルオープン処理を、dynamicキーワードを用いた記述で見てみましょう。</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="c1">// ファイルオープン</span>
<span class="kt">dynamic</span> <span class="n">xlApp</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">Type</span><span class="p">.</span><span class="nf">GetTypeFromProgID</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">));</span>
<span class="kt">dynamic</span> <span class="n">xlBooks</span> <span class="p">=</span> <span class="n">xlApp</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">;</span>
<span class="kt">dynamic</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="n">ExcelFileName</span><span class="p">);</span>
</code></pre></div></div>

<p>2行目だけ遅延バインディング形式と同じで、あとは事前バインディング方式の時とほぼ同じです。違うのは、変数の型がdynamicになっているだけです。このことから、<br>
1. 事前バインディング形式でExcel操作クラスを実装し、動作確認を行う。<br>
2. COMオブジェクトを格納する変数の型をdynamicへ変更する。<br>
3. DLLの参照を削除する。<br>
という手順を踏めば、Excelのバージョンに依存する事前バインディングの記述を、バージョンに依存しない遅延バインディングに変換できます。</p>

<h1>
<span id="appendix" class="fragment"></span><a href="#appendix"><i class="fa fa-link"></i></a>Appendix.</h1>

<h2>
<span id="comの仕組み" class="fragment"></span><a href="#com%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF"><i class="fa fa-link"></i></a>COMの仕組み</h2>

<p>　.NET から COM オブジェクトを扱うということは、マネージドからアンマネージにアクセスするということであり、すなわちマーシャリングが必要となります。これは、ランタイム呼び出し可能ラッパー（RCW: Runtime Callable Wrapper）なるしくみによって行われています。<br>
<a href="https://camo.qiitausercontent.com/1b4935dd79eb4aed3b5d1c302d9ab6bf4bea837f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f33636336383638372d663133352d633638332d613762392d6434356330653539613437642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F3cc68687-f135-c683-a7b9-d45c0e59a47d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a7d430bbe163643bbdb81d8710e3b37d" alt="スクリーンショット 2019-08-29 16.53.20.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/3cc68687-f135-c683-a7b9-d45c0e59a47d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F3cc68687-f135-c683-a7b9-d45c0e59a47d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0655f02cceb40a7f678c62e66b6cb41c 1x" loading="lazy"></a><br>
　通常、.NET クライアント（アプリケーション）が直接的に扱うのは、生身の COM オブジェクトではなく、そのラッパーたる RCW です。ランタイム（.NET Framework）によってサポートされるため意識しづらいですが、RCW というプロキシを挟んで COM オブジェクトにアクセスしているのです。これは重要な事実であり、認識しておかなければなりません。<br>
　COMの規定によれば、COMオブジェクトたるもの「自分のメモリーは自分で解放する責任がある」とのこと。そして、それを実現するためには、参照カウントというテクニックが用いられます。参照カウントとは、その COMオブジェクトが他からどれだけ参照されているかを示す数値です。COMオブジェクトは、自分が使ったメモリーを自分で解放するために、自身への参照数を自分で管理していて、参照数が"0"になったら他からの参照がなくなった（＝用済み）と判断して、自分自身のメモリーを解放してくれます。だけどもそれ故に、いま誰が必要とし、必要としなくなったのかは、使う側から通達しなくてはなりません。<br>
　.NETでメモリー管理といえばガベージコレクション（GC）です。COMオブジェクトを内包するRCWは、マネージドであり、もちろんGCの管理対象です。しかし、COMオブジェクトは、自分のメモリーは自分で解放する責務を負っています。ここに、メモリー管理のアプローチの違いからくるミスマッチが生まれています。RCWはGCの管理下にありますが、内包するCOMオブジェクトがGCの対象ではないので、結局、アプリケーション作成者が RCW を通じてCOMオブジェクトが使用するメモリーを、参照カウントというしくみで管理しなければならない、ということになっています。<br>
　管理するとは、つまり、RCWをすべて変数に保持しておくということであり、そしてその参照カウントをデクリメントするのがReleaseComObject()メソッドです。</p>

<div class="code-frame" data-lang="VB">
<div class="code-lang"><span class="bold">VBScript</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">Sub</span> <span class="nf">ShowRangeA1</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">excel</span>
    <span class="k">Dim</span> <span class="nv">book</span>
    <span class="k">Set</span> <span class="n">excel</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">)</span>
    <span class="k">Set</span> <span class="n">book</span> <span class="o">=</span> <span class="n">excel</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="s">"hoge.xls"</span><span class="p">)</span>

    <span class="k">Dim</span> <span class="nv">a1val</span>
    <span class="n">a1val</span> <span class="o">=</span> <span class="n">book</span><span class="p">.</span><span class="n">Sheets</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Range</span><span class="p">(</span><span class="s">"A1"</span><span class="p">).</span><span class="n">Value</span>

    <span class="n">book</span><span class="p">.</span><span class="n">Close</span> <span class="k">False</span>
    <span class="n">excel</span><span class="p">.</span><span class="n">Quit</span>

    <span class="n">WScript</span><span class="p">.</span><span class="n">Echo</span> <span class="n">a1val</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
</div>

<p>VBScriptだとこれだけですむのに…</p>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">ShowRangeA1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Application</span> <span class="n">xlApp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Application</span><span class="p">();</span>
    <span class="n">Workbooks</span> <span class="n">xlBooks</span> <span class="p">=</span> <span class="n">xlApp</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">;</span>
    <span class="n">Workbook</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="s">@"hoge.xls"</span><span class="p">);</span>
    <span class="n">Sheets</span> <span class="n">xlSheets</span> <span class="p">=</span> <span class="n">xlBook</span><span class="p">.</span><span class="n">Worksheets</span><span class="p">;</span>
    <span class="n">Worksheet</span> <span class="n">xlSheet</span> <span class="p">=</span> <span class="p">(</span><span class="n">Worksheet</span><span class="p">)</span><span class="n">xlSheets</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
    <span class="n">Range</span> <span class="n">xlCells</span> <span class="p">=</span> <span class="n">xlSheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">;</span>
    <span class="n">Range</span> <span class="n">xlRangeA1</span> <span class="p">=</span> <span class="p">(</span><span class="n">Range</span><span class="p">)</span><span class="n">xlCells</span><span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">];</span>

    <span class="kt">string</span> <span class="n">a1val</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">xlRangeA1</span><span class="p">.</span><span class="n">Value2</span><span class="p">;</span>

    <span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">xlRangeA1</span><span class="p">);</span>
    <span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">xlCells</span><span class="p">);</span>
    <span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">xlSheet</span><span class="p">);</span>
    <span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">xlSheets</span><span class="p">);</span>
    <span class="n">xlBook</span><span class="p">.</span><span class="nf">Close</span><span class="p">(</span><span class="k">false</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">);</span>
    <span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">xlBook</span><span class="p">);</span>
    <span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">xlBooks</span><span class="p">);</span>
    <span class="n">xlApp</span><span class="p">.</span><span class="nf">Quit</span><span class="p">();</span>
    <span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">xlApp</span><span class="p">);</span>

    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="n">a1val</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>C#だとごらんの有様だよ！</p>

<p>上記例を見ればわかるように、処理の本質ではないコード、タイプ量が激増しています。これだけでも十分面倒くさいのに、実は例外発生時にも確実にデクリメントを行うためには、RCWを生成するごとにtry～finallyをしてやらなければいけません。詳しくは<a href="http://jeanne.wankuma.com/tips/csharp/programming/releasecom.html" rel="nofollow noopener" target="_blank">こちらの記事</a>を参考にして頂きますが、こうなると、超絶ネスト構造の一丁上がりです。意味がわかりません。しかし、COM相互参照を使用するということは、本来はこういうことを行う必要があると理解してください。</p>

<h2>
<span id="comオブジェクトを返すプロパティ一覧" class="fragment"></span><a href="#com%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E8%BF%94%E3%81%99%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E4%B8%80%E8%A6%A7"><i class="fa fa-link"></i></a>COMオブジェクトを返すプロパティ一覧</h2>

<table>
<thead>
<tr>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
<th style="text-align: center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center">Application</td>
<td style="text-align: center">Areas</td>
<td style="text-align: center">Borders</td>
<td style="text-align: center">Cells</td>
</tr>
<tr>
<td style="text-align: center">Characters</td>
<td style="text-align: center">Columns</td>
<td style="text-align: center">Comment</td>
<td style="text-align: center">CurrentArray</td>
</tr>
<tr>
<td style="text-align: center">CurrentRegion</td>
<td style="text-align: center">Dependents</td>
<td style="text-align: center">DirectDependents</td>
<td style="text-align: center">DirectPrecedents</td>
</tr>
<tr>
<td style="text-align: center">End</td>
<td style="text-align: center">EntireColumn</td>
<td style="text-align: center">EntireRow</td>
<td style="text-align: center">Font</td>
</tr>
<tr>
<td style="text-align: center">FormatConditions</td>
<td style="text-align: center">Hyperlinks</td>
<td style="text-align: center">Interior</td>
<td style="text-align: center">Item</td>
</tr>
<tr>
<td style="text-align: center">ListObject</td>
<td style="text-align: center">MDX</td>
<td style="text-align: center">MergeArea</td>
<td style="text-align: center">Next</td>
</tr>
<tr>
<td style="text-align: center">Offset</td>
<td style="text-align: center">Parent</td>
<td style="text-align: center">Phonetic</td>
<td style="text-align: center">Phonetics</td>
</tr>
<tr>
<td style="text-align: center">PivotCell</td>
<td style="text-align: center">PivotField</td>
<td style="text-align: center">PivotItem</td>
<td style="text-align: center">PivotTable</td>
</tr>
<tr>
<td style="text-align: center">Precedents</td>
<td style="text-align: center">Previous</td>
<td style="text-align: center">QueryTable</td>
<td style="text-align: center">Range</td>
</tr>
<tr>
<td style="text-align: center">Resize</td>
<td style="text-align: center">Rows</td>
<td style="text-align: center">ServerActions</td>
<td style="text-align: center">SmartTags</td>
</tr>
<tr>
<td style="text-align: center">Validation</td>
<td style="text-align: center">Worksheet</td>
<td style="text-align: center">XPath</td>
<td style="text-align: center"></td>
</tr>
</tbody>
</table>

<h2>
<span id="サンプルアプリケーションのソースコード" class="fragment"></span><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>サンプルアプリケーションのソースコード</h2>

<h3>
<span id="事前バインディング-1" class="fragment"></span><a href="#%E4%BA%8B%E5%89%8D%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0-1"><i class="fa fa-link"></i></a>事前バインディング</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="c1">//インターフェースの名前空間</span>
<span class="k">using</span> <span class="nn">ExtractExcelDataInterface</span><span class="p">;</span>

<span class="c1">//Excelを操作するために必要なクラスの名前空間を追加</span>
<span class="k">using</span> <span class="nn">Microsoft.Office.Interop.Excel</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExtractExcelData</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExtractExcelUseExcelDLL</span> <span class="p">:</span> <span class="n">IExtractExcelData</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="nf">ExtractExcelData</span><span class="p">(</span><span class="kt">string</span> <span class="n">ExcelFileName</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//returnするDicionaryインスタンス</span>
            <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">dic</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

            <span class="c1">// ファイルオープン</span>
            <span class="n">Application</span> <span class="n">xlApp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Application</span><span class="p">();</span>
            <span class="n">Workbooks</span> <span class="n">xlBooks</span> <span class="p">=</span> <span class="n">xlApp</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">;</span>
            <span class="n">Workbook</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span>
                    <span class="n">ExcelFileName</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
                    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
                    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
                    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span>
                    <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span>
                <span class="p">);</span>

            <span class="c1">// シートを選択</span>
            <span class="n">Worksheet</span> <span class="n">sheet</span> <span class="p">=</span> <span class="n">xlBook</span><span class="p">.</span><span class="n">Sheets</span><span class="p">[</span><span class="s">"メンバー一覧"</span><span class="p">];</span>

            <span class="c1">// セルの領域を選択</span>
            <span class="n">Range</span> <span class="n">TableRange</span> <span class="p">=</span> <span class="n">sheet</span><span class="p">.</span><span class="n">Range</span><span class="p">[</span><span class="s">"A1"</span><span class="p">,</span> <span class="s">"B15"</span><span class="p">];</span>

            <span class="c1">// 選択した領域の値をメモリー上に格納</span>
            <span class="c1">// （１セルずつ見ていくよりも早い）</span>
            <span class="kt">object</span><span class="p">[,]</span> <span class="n">values</span> <span class="p">=</span> <span class="n">TableRange</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>

            <span class="c1">// 配列アクセスができるので、それぞれをDictionaryに追加</span>
            <span class="c1">// [WARNING] 配列の開始インデックスは１から</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="n">values</span><span class="p">.</span><span class="nf">GetLength</span><span class="p">(</span><span class="m">0</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">dic</span><span class="p">.</span><span class="nf">Add</span><span class="p">((</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">1</span><span class="p">],</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">2</span><span class="p">]);</span>
            <span class="p">}</span>

            <span class="c1">// 使用したCOMオブジェクトを解放</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">TableRange</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>

            <span class="c1">// Excelのクローズ</span>
            <span class="n">xlBook</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
            <span class="n">xlApp</span><span class="p">.</span><span class="nf">Quit</span><span class="p">();</span>

            <span class="c1">// 使用したCOMオブジェクトを解放その２</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBook</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBooks</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlApp</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">dic</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="遅延バインディング-1" class="fragment"></span><a href="#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0-1"><i class="fa fa-link"></i></a>遅延バインディング</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">using</span> <span class="nn">ExtractExcelDataInterface</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExtractExcelData</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExtractDelayBinding</span> <span class="p">:</span> <span class="n">IExtractExcelData</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="nf">ExtractExcelData</span><span class="p">(</span><span class="kt">string</span> <span class="n">ExcelFileName</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">dic</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

            <span class="kt">object</span> <span class="n">xlApp</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">Type</span><span class="p">.</span><span class="nf">GetTypeFromProgID</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">));</span>
            <span class="kt">object</span> <span class="n">xlBooks</span> <span class="p">=</span> <span class="n">xlApp</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Workbooks"</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">xlApp</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
            <span class="kt">object</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Open"</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">xlBooks</span><span class="p">,</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span> <span class="n">ExcelFileName</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span><span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span><span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">Missing</span> <span class="p">});</span>

            <span class="c1">// シートを選択</span>
            <span class="kt">object</span> <span class="n">sheet</span> <span class="p">=</span> <span class="n">xlBook</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Sheets"</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">xlBook</span><span class="p">,</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"メンバー一覧"</span> <span class="p">});</span>

            <span class="c1">// セルの領域を選択</span>
            <span class="kt">object</span> <span class="n">TableRange</span> <span class="p">=</span> <span class="n">sheet</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Range"</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"A1"</span><span class="p">,</span> <span class="s">"B15"</span> <span class="p">});</span>

            <span class="c1">// 選択した領域の値をメモリー上に格納</span>
            <span class="c1">// （１セルずつ見ていくよりも早い）</span>
            <span class="kt">object</span><span class="p">[,]</span> <span class="n">values</span> <span class="p">=</span> <span class="n">TableRange</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Value"</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">TableRange</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="kt">object</span><span class="p">[,];</span>

            <span class="c1">// 配列アクセスができるので、それぞれをDictionaryに追加</span>
            <span class="c1">// [WARNING] 配列の開始インデックスは１から</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="n">values</span><span class="p">.</span><span class="nf">GetLength</span><span class="p">(</span><span class="m">0</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">dic</span><span class="p">.</span><span class="nf">Add</span><span class="p">((</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">1</span><span class="p">],</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">2</span><span class="p">]);</span>
            <span class="p">}</span>

            <span class="c1">// 使用したCOMオブジェクトを解放</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">TableRange</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>

            <span class="c1">// Excelのクローズ</span>
            <span class="n">xlBook</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Close"</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">xlBook</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
            <span class="n">xlApp</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">InvokeMember</span><span class="p">(</span><span class="s">"Quit"</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">xlApp</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>

            <span class="c1">// 使用したCOMオブジェクトを解放その２</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBook</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBooks</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlApp</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">dic</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="dynamicキーワードを使用した遅延バインディング" class="fragment"></span><a href="#dynamic%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>dynamicキーワードを使用した遅延バインディング</h3>

<div class="code-frame" data-lang="C#"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">using</span> <span class="nn">ExtractExcelDataInterface</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExtractExcelData</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExtractDelayBindUseDynamic</span> <span class="p">:</span> <span class="n">IExtractExcelData</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="nf">ExtractExcelData</span><span class="p">(</span><span class="kt">string</span> <span class="n">ExcelFileName</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">dic</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

            <span class="c1">// ファイルオープン</span>
            <span class="kt">dynamic</span> <span class="n">xlApp</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">Type</span><span class="p">.</span><span class="nf">GetTypeFromProgID</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">));</span>
            <span class="kt">dynamic</span> <span class="n">xlBooks</span> <span class="p">=</span> <span class="n">xlApp</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">;</span>
            <span class="kt">dynamic</span> <span class="n">xlBook</span> <span class="p">=</span> <span class="n">xlBooks</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="n">ExcelFileName</span><span class="p">);</span>

            <span class="c1">// シートを選択</span>
            <span class="kt">dynamic</span> <span class="n">sheet</span> <span class="p">=</span> <span class="n">xlBook</span><span class="p">.</span><span class="n">Sheets</span><span class="p">[</span><span class="s">"メンバー一覧"</span><span class="p">];</span>

            <span class="c1">// セルの領域を選択</span>
            <span class="kt">dynamic</span> <span class="n">TableRange</span> <span class="p">=</span> <span class="n">sheet</span><span class="p">.</span><span class="n">Range</span><span class="p">[</span><span class="s">"A1"</span><span class="p">,</span> <span class="s">"B15"</span><span class="p">];</span>

            <span class="c1">// 選択した領域の値をメモリー上に格納</span>
            <span class="c1">// （１セルずつ見ていくよりも早い）</span>
            <span class="kt">object</span><span class="p">[,]</span> <span class="n">values</span> <span class="p">=</span> <span class="n">TableRange</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>

            <span class="c1">// 配列アクセスができるので、それぞれをDictionaryに追加</span>
            <span class="c1">// [WARNING] 配列の開始インデックスは１から</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="n">values</span><span class="p">.</span><span class="nf">GetLength</span><span class="p">(</span><span class="m">0</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">dic</span><span class="p">.</span><span class="nf">Add</span><span class="p">((</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">1</span><span class="p">],</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">2</span><span class="p">]);</span>
            <span class="p">}</span>

            <span class="c1">// 使用したCOMオブジェクトを解放</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">TableRange</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">ReleaseComObject</span><span class="p">(</span><span class="n">sheet</span><span class="p">);</span>

            <span class="c1">// Excelのクローズ</span>
            <span class="n">xlBook</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
            <span class="n">xlApp</span><span class="p">.</span><span class="nf">Quit</span><span class="p">();</span>

            <span class="c1">// 使用したCOMオブジェクトを解放その２</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBook</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlBooks</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">FinalReleaseComObject</span><span class="p">(</span><span class="n">xlApp</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">dic</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p>簡単に言うと、アプリを外から操作する技術 <a href="#fnref1">↩</a></p>
</li>

<li id="fn2">
<p>COMを使用して開発されたソフトウェア <a href="#fnref2">↩</a></p>
</li>

<li id="fn3">
<p>「13」は忌み数なので欠番 <a href="#fnref3">↩</a></p>
</li>

<li id="fn4">
<p>実行時にDLLが存在しないと行けないし、バージョン依存の記述もあるでしょうから、一概にすべて意識する必要がなくなるという訳でもないですが…… <a href="#fnref4">↩</a></p>
</li>

</ol>
</div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Ftomohideyo%2Fitems%2Ff46eab04b86316d917c5&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Ftomohideyo%2Fitems%2Ff46eab04b86316d917c5&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/tomohideyo/items/f46eab04b86316d917c5/likers" class="css-1iupg5d">25</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">24</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/f46eab04b86316d917c5/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/tomohideyo/items/f46eab04b86316d917c5/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/tomohideyo/items/f46eab04b86316d917c5/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/tomohideyo/items/f46eab04b86316d917c5/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/tomohideyo/items/f46eab04b86316d917c5.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-39f25b24-201c-4498-95d7-3ccf582fcebb">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-33c28788-7dee-4689-818f-587ef3ad9222"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-33c28788-7dee-4689-818f-587ef3ad9222">{}</script>
      
<div id="LoginModal-react-component-2592976c-45b1-422b-93e4-3abb4e7f78f0"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-2592976c-45b1-422b-93e4-3abb4e7f78f0">{}</script>
      
<div id="StockModal-react-component-04900393-e4ff-4b88-b6d7-27a3342057ad"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-04900393-e4ff-4b88-b6d7-27a3342057ad">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;qYY1czVog//mDhnTPao9de/RJcFPuIjQ5G5KT97QdrtpyvL9c8/92/l1NuAY+CAkCAfVCiBOWM2mg7MnLO89jQ==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003cstrong\u003e本記事は2012年末頃に、社内向けに作成した説明資料をQiita向けに編集したものです。\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e最新の仕様とは異なる場合があるので注意してください。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e　.NET Frameworkには「COM相互運用\u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" title=\"簡単に言うと、アプリを外から操作する技術\"\u003e1\u003c/a\u003e\u003c/sup\u003e」と呼ばれる機能があり、COMコンポーネント\u003csup id=\"fnref2\"\u003e\u003ca href=\"#fn2\" title=\"COMを使用して開発されたソフトウェア\"\u003e2\u003c/a\u003e\u003c/sup\u003eを手軽に呼び出すことができます。一方、ExcelをはじめとするOffice製品は、その機能をマクロ（VBA）などからも活用できるようにCOMコンポーネントとして実装されています。このため、COM相互運用を使えば.NETアプリケーションから容易にExcelやWordのファイルを開き、それをさまざまに操作することが可能です。\u003c/p\u003e\n\n\u003cp\u003e　本記事ではC#で作成されたサンプルアプリケーションのソースコードを基に、COM相互運用機能を用いてExcelファイルを操作する方法を説明します。\u003cbr\u003e\n　使用しているVisual Studioのバージョンは” Microsoft Visual Studio Express 2012 for Windows Desktop”です。ただし、Visual Studioの旧バージョンとの差は見た目ぐらいですので、特に問題はないと思います。\u003cbr\u003e\n　.Net Frameworkのバージョン、およびC#のバージョンに依存している記述などについては、その都度言及して、補足を行なっていきます。\u003c/p\u003e\n\n\u003cp\u003e　以降の章では、サンプルアプリケーションのうち、Excelファイルを操作している部分に着目して説明を行なっていきます。ファイルの存在チェックや出力のフォーマットに関しては、本書の目的とそれるので割愛します。サンプルプロジェクトのソースファイルを見てください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"事前バインディング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BA%8B%E5%89%8D%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e事前バインディング\u003c/h1\u003e\n\n\u003cp\u003e　本章では、C#からExcelを操作する上で一般的に使用される「事前バインディング」方式を用いて、Excelファイルを操作する手順を説明します。\u003cbr\u003e\n　「事前バインディング」方式とは、文字通り事前に必要なDLLの参照設定を行なっておき、そのDLL使用する方式です。参照を追加するため、コードの補完機能などが使用出来るので、Excelを操作するコーディングを行う上でも一番やりやすい方法となります。\u003cbr\u003e\n　以下に、「事前バインディング」方式によるExcelファイルを操作する手順を示していきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"プロジェクトへ参照を追加\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%B8%E5%8F%82%E7%85%A7%E3%82%92%E8%BF%BD%E5%8A%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクトへ参照を追加\u003c/h2\u003e\n\n\u003cp\u003e　まずは、事前バインディングの名の通り、Excelファイルを操作するためのDLL参照を設定します。\u003cbr\u003e\n　[プロジェクト]メニュー – [参照の追加]をクリックし、参照マネージャーを起動してください。ソリューションエクスプローラーから見える参照設定の右クリックメニューからでも同様の操作が行えます。\u003ca href=\"https://camo.qiitausercontent.com/f4aa62db84c2d1e6c030659415cf303cfd0f24da/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f35623038323663662d646431302d346562322d346134382d6534623238313130333565352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F5b0826cf-dd10-4eb2-4a48-e4b2811035e5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=18a27cc2a749aff59dba3986acf0a626\" alt=\"図3.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/5b0826cf-dd10-4eb2-4a48-e4b2811035e5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F5b0826cf-dd10-4eb2-4a48-e4b2811035e5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f134e66bf6e9e207d211cbc43a4204a7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n　参照マネージャーの[COM]タブをクリックし、表示されるライブラリーの一覧から「Microsoft Excel XX Object Library」を選択します。インストールされているExcelのバージョンによって、XXの部分に表示されるライブラリーのバージョン番号が異なります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/8d803a03ba2b8fce37cb5dfa19497206a01923f0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f38313136316131382d666337342d353164642d313163312d3862616437393766653963322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F81161a18-fc74-51dd-11c1-8bad797fe9c2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9f4c2d79ca1802d9294597a6b04b898a\" alt=\"図4.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/81161a18-fc74-51dd-11c1-8bad797fe9c2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F81161a18-fc74-51dd-11c1-8bad797fe9c2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ebcc441cb950b99b1e5ffae14f4f0ffa 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003eOfficeのバージョン\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003eライブラリのバージョン\u003csup id=\"fnref3\"\u003e\u003ca href=\"#fn3\" title=\"「13」は忌み数なので欠番\"\u003e3\u003c/a\u003e\u003c/sup\u003e\n\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eMicrosoft Office 2010\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e14.0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eMicrosoft Office 2007\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e12.0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eMicrosoft Office 2003\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e11.0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eMicrosoft Excel 2002\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e10.0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eMicrosoft Excel 2000\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e9.0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eMicrosoft Excel 97\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e8.0\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e　参照の追加が行われたら、ソリューションエクスプローラーの参照設定に「Micorosoft.Office.Core」と「Microsoft.Office.Interop.Excel」が追加されるのが見て取れます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/71e4ee2684f5d42d935298f2cd48886f3d961508/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f62343234323437392d366466322d373230362d616366342d6462346363623461346565622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Fb4242479-6df2-7206-acf4-db4ccb4a4eeb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=dff32710f54350da51e01a56cabef6d9\" alt=\"図5.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/b4242479-6df2-7206-acf4-db4ccb4a4eeb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Fb4242479-6df2-7206-acf4-db4ccb4a4eeb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=91447381b170b56b35d7e1d5bbe6b5dd 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n　最後に、バインドした参照のうち、使用するクラスが含まれている名前空間を追加します。追加する名前空間は「Microsoft.Office.Interop.Excel」になります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/42918c57af529641212922c7bccfa27142885366/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f32346266653839662d633837642d353334652d326461632d6231323633303533653465662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F24bfe89f-c87d-534e-2dac-b1263053e4ef.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e4df3caff8f6e9aafc70caf1550d994b\" alt=\"図6.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/24bfe89f-c87d-534e-2dac-b1263053e4ef.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F24bfe89f-c87d-534e-2dac-b1263053e4ef.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=31d07ebaabf848623a73efe2a001cfd8 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n　名前空間の追加が正しく行われると、コーディング時にコードサジェストが行われます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/6ca6abdf077418da77bebda516f14f47735b6427/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f66306233386435322d303637622d633534622d646664652d3138383136396230326465662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Ff0b38d52-067b-c54b-dfde-188169b02def.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ba24e5bd0c1fc75a67f5982e2244bb40\" alt=\"図7.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/f0b38d52-067b-c54b-dfde-188169b02def.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2Ff0b38d52-067b-c54b-dfde-188169b02def.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=45b17c6d83987d46d8d2c4659beebb1f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ソースコード解説\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースコード解説\u003c/h2\u003e\n\n\u003cp\u003e　ここからは、サンプルコードを元に、C#からどのようにExcelを操作するかを説明します。\u003cbr\u003e\n　操作は主に5ステップ存在します。\u003cbr\u003e\n　　　1. ファイルオープンなどの前処理\u003cbr\u003e\n　　　2. シート、セルの領域指定\u003cbr\u003e\n　　　3. 選択したセル領域から値の取得\u003cbr\u003e\n　　　4. 取得した値の詰め替え\u003cbr\u003e\n　　　5. ファイルクローズなどの後処理\u003cbr\u003e\n　以下、ステップごとに行う処理について説明します。\u003cbr\u003e\n　サンプルコードの全文はAppendix. 「事前バインディング」を参照してください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"前処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前処理\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// ファイルオープン\u003c/span\u003e\n\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eWorkbook\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\n\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e行\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e解説\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eApplicationインスタンスの生成。\u003cbr\u003exlAppにExcelを操作するMicrosoft.Office.Interop.Excel.Application COMオブジェクトクラスのインスタンスが格納されます。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003exlAppが持つWorkbooksプロパティ（MDIの親玉）を取得。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e4〜10\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003exlBooksに、ExcelFileNameで指定したファイルをオープンし、そのインスタンスをxlBookに格納します。\u003cbr\u003e第2引数以降で指定している”Type.Missing”で、パラメーターの既定値（所謂デフォルトパラメータ）を使用するようメソッドに通知しています。\u003cbr\u003eWorkbooks.Openメソッドの引数の詳細については、\u003ca href=\"http://msdn.microsoft.com/ja-jp/library/microsoft.office.interop.excel.workbooks.open(office.11).aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eを参照してください。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e　なお、C# 4.0 (Visual Studio 2010)からはデフォルトパラメータを省略できるようになったので、4行目のExcelファイルのオープン処理は、以下のように記述することが可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eWorkbook\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e　ExcelのCOMオブジェクト構成は、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eApplication\n└ Workbooks[]\n　├ Workbook\n　│ ├ Sheets[]\n　│ │ ├ Sheet1\n　│ │ │ ├ Cells[]\n　│ │ ├ Sheet2\n　│ │ ├ Sheet3\n　│ │ ├ ：\n　├ Workbook\n　├ Workbook\n　├ 　：\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eとなっており、操作対象となるセルオブジェクトに到達するまで、上位のオブジェクトから順次取得して行く必要があります。上述の前処理で行ったのは、この内上位3階層分のオブジェクトの取得処理に当たります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"シートセルの領域指定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B7%E3%83%BC%E3%83%88%E3%82%BB%E3%83%AB%E3%81%AE%E9%A0%98%E5%9F%9F%E6%8C%87%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eシート、セルの領域指定\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// シートを選択\u003c/span\u003e\n\u003cspan class=\"n\"\u003eWorksheet\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSheets\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"メンバー一覧\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// セルの領域を選択\u003c/span\u003e\n\u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"A1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"B15\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e行\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e解説\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e２\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eOpenしたExcelファイルから、”メンバー一覧”シートを指定して取得します。\u003cbr\u003eSheets[]コレクションは、要素番号とシート名どちらでもアクセスできます。今回操作対象シートが明確なのでシート名でアクセスしています。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e５\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e”メンバー一覧”シートの領域$A$1:$B$15を示すオブジェクトを取得します。\u003cbr\u003e領域取得には他に、\u003cbr\u003e　　Range TableRange = sheet.Range[\"A1:B15\"];\u003cbr\u003eというふうに、1次元目だけを使用した記述方法も可能です。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e　領域オブジェクトを取得する操作は、上記の他にget_Range()メソッドが存在します。\u003cbr\u003e\n　しかし、get_Range()には後方互換性の不備があり、\u003cfont color=\"Red\"\u003e\u003cstrong\u003e.NET Frameworkのある特定の更新に限り正常に動作しないというバグが存在します。\u003c/strong\u003e\u003c/font\u003e\u003cbr\u003e\n　領域オブジェクトを取得する際には、Range[]アクセサーからの取得を推奨します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"選択したセル領域から値の取得\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%81%B8%E6%8A%9E%E3%81%97%E3%81%9F%E3%82%BB%E3%83%AB%E9%A0%98%E5%9F%9F%E3%81%8B%E3%82%89%E5%80%A4%E3%81%AE%E5%8F%96%E5%BE%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e選択したセル領域から値の取得\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 選択した領域の値をメモリー上に格納\u003c/span\u003e\n\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[,]\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e行\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e解説\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e２\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e選択した領域の値を配列に格納しています。\u003cbr\u003e領域オブジェクトのValueまたはValue2プロパティは、まとめて取得されメモリー上に配置されます。\u003cbr\u003e今回、セルには文字が書き込まれているので、セルの書式設定が日付/通貨の時のみ意味があるValue2ではなく、Valueで取得しています。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e　領域オブジェクトから、値を二次元配列に格納するという手法は、Excel VBAでもよく使われる高速化テクニックの一つです。領域内のセルをループで取得するのに比べ、格段に早くすることができます。\u003cbr\u003e\n　なお、たとえ一列しか選択していなくても二次元目の深さが１である二次元配列になります。\u003cbr\u003e\n　また、\u003cstrong\u003e配列の添字は１が最初です\u003c/strong\u003e。要素0へアクセスすると例外が発生するので、注意してください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"取得した値の詰め替え\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%96%E5%BE%97%E3%81%97%E3%81%9F%E5%80%A4%E3%81%AE%E8%A9%B0%E3%82%81%E6%9B%BF%E3%81%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e取得した値の詰め替え\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 配列アクセスができるので、それぞれをDictionaryに追加\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e行\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e解説\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e２〜5\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e値を格納した二次元配列から値を取り出し、それぞれkeyとvalueとしてDictionaryに格納しています。配列の添字は１が最初。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"後処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BE%8C%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e後処理\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放\u003c/span\u003e\n\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Excelのクローズ\u003c/span\u003e\n\u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eQuit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放その２\u003c/span\u003e\n\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e行\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e解説\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e２〜3\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e使用したRangeやSheetのCOMオブジェクトを解放します。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e6\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eClose()メソッドにより、ファイルをクローズします。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e7\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eQuit()メソッドにより、アプリケーションを終了します。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e10〜12\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e使用したApplicationやWorkbooksなどのCOMオブジェクトを解放します。後ほど詳しく説明します。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e　ReleaseComObject()／FinalReleaseComObject()メソッドは、COMオブジェクトの参照カウントを1／すべて減らすメソッドです。\u003cbr\u003e\n　参照カウント絡みの話は割りと深く面倒くさいものですので、今はあまり時間がないけどとにかく使えるようになりたい方は、「COMは、メモリーのalloc()/free()と同様に、使用者が管理するもの」という程度に理解していただければまず十分です。詳しく知りたい方はAppendix. 「COMの仕組み」をお読みください。\u003cbr\u003e\n　なお、COMオブジェクトが正しく解放されなかった場合、\u003cfont color=\"Red\"\u003e\u003cstrong\u003eExcelのプロセスが残り続けてしまいます\u003c/strong\u003e\u003c/font\u003e。オブジェクトの解放忘れには十分に注意してください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"comオブジェクトを解放し忘れる典型的パターン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#com%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E8%A7%A3%E6%94%BE%E3%81%97%E5%BF%98%E3%82%8C%E3%82%8B%E5%85%B8%E5%9E%8B%E7%9A%84%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCOMオブジェクトを解放し忘れる典型的パターン\u003c/h2\u003e\n\n\u003cp\u003e　以下に、解放を忘れるパターンを示します。この記述を行うとCOMオブジェクトの解放し忘れにつながるため、\u003cstrong\u003e使用してはいけません\u003c/strong\u003e。この記述を見つけた場合、速やかに指摘してあげてください。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e一気にOpen\u003cbr\u003e一般的にC#でファイルをオープンするときは、以下の様な記述をすることがよくあります。\u003cbr\u003e\n　　FileStream fs = System.IO.File.Open(filename, FileMode.Open);\u003cbr\u003e\nこれと同じ感覚でExcelファイルのオープンを記述すると\u003cbr\u003e\n　　Workbook book = new Application().Workbooks.Open(ExcelFileName);\u003cbr\u003e\nとなりますが、ApplicationオブジェクトとWorkbooksオブジェクトをどの変数にも格納していないため、後々ReleaseComObject()で解放することができず、COMオブジェクトが残存します。COMオブジェクトを返すメソッドやプロパティでは、面倒でもひとつひとつ変数に格納して行きましょう。\u003c/li\u003e\n\u003cli\u003eCellsプロパティ\u003cbr\u003eセルの領域を取得する方法として、上ではRange[]アクセサーを使用する方法を紹介しましたが、Cellsプロパティを使用して取得することもできます。\u003cbr\u003e\n　　　Range TableRange = sheet.Cells[\"A1\", \"B15\"];\u003cbr\u003e\nしかし、CellsプロパティはCOMオブジェクトを返すので、上記の記述ではCellsを受け取る変数がおらず、COMオブジェクトを開放することができません。\u003cbr\u003e\n　（実際はこうなっている）\u003cbr\u003e\n　　Range TableRange = sheet.Cells.Range[\"A1\", \"B15\"];\u003cbr\u003e\nCellsプロパティを使用して各セルにアクセスする場合は、Cellsのオブジェクトを変数に格納し、そこから各セルのRangeオブジェクトをアクセサーで取得する必要があります。\u003cbr\u003e\n　　Range cells = sheet.Cells;    // cellsはあとでReleaseComObject()で解放する\u003cbr\u003e\n　　Range TableRange = cells[\"A1\", \"B15\"];\u003cbr\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e　その他、COMオブジェクトを返すプロパティを、変数へ格納せずに使用している箇所はすべて解放忘れにつながります。発見次第、修正してください。COMオブジェクトを返すプロパティについては、Appendix.「COMオブジェクトを返すプロパティ」を参照してください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"遅延バインディング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e遅延バインディング\u003c/h1\u003e\n\n\u003cp\u003e　「遅延バインディング」方式とは、DLLやCOM内のクラス・関数を、必要になったときに、必要な分だけ実行時に読み込む機能です。実行時に読み込まれるということは、プログラマーはそのDLLの存在やバージョンについて、実装時に意識する必要がなくなるということになります\u003csup id=\"fnref4\"\u003e\u003ca href=\"#fn4\" title=\"実行時にDLLが存在しないと行けないし、バージョン依存の記述もあるでしょうから、一概にすべて意識する必要がなくなるという訳でもないですが……\"\u003e4\u003c/a\u003e\u003c/sup\u003e。\u003cbr\u003e\n　バージョンを意識する必要がなくなるため、事前バインディングの時のように、Excelのバージョンに応じてライブラリーを読み込む必要がなく、将来新しいバージョンのExcelが出てきたとしても、プログラムに改変を加えることなくサポートできる可能性が高いということになります。\u003cbr\u003e\n　以下に、「遅延バインディング」方式によるExcelファイルを操作する手順を示していきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ソースコード解説-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースコード解説\u003c/h3\u003e\n\n\u003cp\u003e　サンプルコードを元に、遅延バインディングを使用してC#からExcelを操作する方法を説明します。\u003cbr\u003e\n　操作自体は事前バインディングと同じ5ステップで、ステップごとに行っている処理も同様のため省略し、ここでは、遅延バインディング独特の構文について説明します。\u003cbr\u003e\n　サンプルコードの全文はAppendix.「遅延バインディング」を参照してください。\u003cbr\u003e\n　以下に例として、前処理で行うExcelファイルオープン処理を、遅延バインディング形式で記述したものを示します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// ファイルオープン\u003c/span\u003e\n\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eActivator\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetTypeFromProgID\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Excel.Application\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Workbooks\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Open\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInvokeMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e　突然摩訶不思議な記述になりましたが、処理の内容自体は事前バインディングの時と何らかわりがありません。Applicationオブジェクトを作成し、Workbooksプロパティを取得し、Workbookをオープンしているだけです。ここでは、その摩訶不思議な部分であるActivator.CreateInstance()、Type.GetTypeFromProgID()、Type.InvokeMember()メソッドの解説を行います。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eType.GetTypeFromProgID()\u003cbr\u003e\n指定したプログラムID(ProgID)に関連付けられている型を取得します。ここで指定している引数は”Excel.Application”なので、取得できる型はMicrosoft.Office.Interop.Excel.Applicationクラスとなります。\u003c/li\u003e\n\u003cli\u003eActivator.CreateInstance()\u003cbr\u003e\nCreateInstanceメソッドは、指定した引数に最も一致するコンストラクターを呼び出して、アセンブリで定義された型のインスタンスを作成します。つまり、Applicationクラスのインスタンスを作成してくれます。\u003c/li\u003e\n\u003cli\u003eType.InvokeMember()\u003cbr\u003e\nInvokeMemberは、引数の文字列と一致するメソッドやメンバーの操作を行うメソッドです。コンストラクターのメンバーまたはメソッドのメンバーの呼び出し、プロパティのメンバーの取得または設定、データフィールドのメンバーの取得または設定、または配列のメンバーの要素の取得または設定を行います。\u003cbr\u003e身も蓋もなく日本語に直すなら「”第4引数”から、”第1引数”のプロパティまたはメソッドを、[”第5引数”のobject配列を”第3引数”に変換したものを引数として] ”第2引数”します」という感じ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e引数インデックス\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e説明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e第1引数\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eメンバー名、メソッド名の文字列\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e第2引数\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eクラスへのアクセス用フラグ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e第3引数\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e引数のコンバータ用クラス\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e第4引数\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e制御対象インスタンス\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e第5引数\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eメソッド引数\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e　上述の例のように、基本的にはCOMオブジェクトを操作する処理をInvokeMember()メソッドに書き換えることで、遅延バインディング方式の記述となります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"遅延バインディングのデメリット\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e遅延バインディングのデメリット\u003c/h3\u003e\n\n\u003cp\u003e　Excelのバージョンに寄らず記述できる遅延バインディングですが、以下の様なデメリットが存在します。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eExcel操作クラスの形を自分で知る必要がある\u003cbr\u003e\nDLL参照を追加しておけばIntellisenseによる補完機能が働きますが、遅延バインディングでは参照を追加しないためその機能は働いてくれません。自分が操作したいCOMオブジェクトのメソッドやプロパティ名が正しいかどうかは、自分の目で確かめる必要があります。\u003c/li\u003e\n\u003cli\u003e実行時にしか正当性が判別できない\u003cbr\u003e\n(1)と同様に、Intellisenseによる誤り訂正が働かないので、実際に実行してみるまでメソッド名を正しく記述できたかどうかはわかりません。そして、間違っていた場合は例外が発生することもあるので、例外処理をおこなっていないとCOMオブジェクトが解放されずに……\u003c/li\u003e\n\u003cli\u003e記述がとても長くなる\u003cbr\u003e\n例を見ればわかるように、あからさまに横に伸びます。ただでさえCOMの解放処理で縦に伸びているのに、これで横にまで伸びてしまうのは明らかに可読性が下がっていきます。ただでさえInvokeMethod()は可読性が悪いのに……\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"c-40-dynamicキーワードを用いた遅延バインディング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#c-40-dynamic%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[C# 4.0] dynamicキーワードを用いた遅延バインディング\u003c/h1\u003e\n\n\u003cp\u003e　C# 4.0で導入された、動的言語との連携の仕組みの1つが動的型付け変数（dynamicキーワード）です。動的型付け変数を使うことで、動的な（コンパイル時にメンバー情報がわからない型の）メンバーアクセスが可能になります。このdynamicキーワードを用いると、先ほど指摘した遅延バインディングのデメリットがほぼ解消されます。早速、前処理で行うExcelファイルオープン処理を、dynamicキーワードを用いた記述で見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// ファイルオープン\u003c/span\u003e\n\u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eActivator\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetTypeFromProgID\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Excel.Application\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e2行目だけ遅延バインディング形式と同じで、あとは事前バインディング方式の時とほぼ同じです。違うのは、変数の型がdynamicになっているだけです。このことから、\u003cbr\u003e\n1. 事前バインディング形式でExcel操作クラスを実装し、動作確認を行う。\u003cbr\u003e\n2. COMオブジェクトを格納する変数の型をdynamicへ変更する。\u003cbr\u003e\n3. DLLの参照を削除する。\u003cbr\u003e\nという手順を踏めば、Excelのバージョンに依存する事前バインディングの記述を、バージョンに依存しない遅延バインディングに変換できます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"appendix\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#appendix\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAppendix.\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"comの仕組み\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#com%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCOMの仕組み\u003c/h2\u003e\n\n\u003cp\u003e　.NET から COM オブジェクトを扱うということは、マネージドからアンマネージにアクセスするということであり、すなわちマーシャリングが必要となります。これは、ランタイム呼び出し可能ラッパー（RCW: Runtime Callable Wrapper）なるしくみによって行われています。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/1b4935dd79eb4aed3b5d1c302d9ab6bf4bea837f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3433323637352f33636336383638372d663133352d633638332d613762392d6434356330653539613437642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F3cc68687-f135-c683-a7b9-d45c0e59a47d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a7d430bbe163643bbdb81d8710e3b37d\" alt=\"スクリーンショット 2019-08-29 16.53.20.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/432675/3cc68687-f135-c683-a7b9-d45c0e59a47d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F432675%2F3cc68687-f135-c683-a7b9-d45c0e59a47d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0655f02cceb40a7f678c62e66b6cb41c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n　通常、.NET クライアント（アプリケーション）が直接的に扱うのは、生身の COM オブジェクトではなく、そのラッパーたる RCW です。ランタイム（.NET Framework）によってサポートされるため意識しづらいですが、RCW というプロキシを挟んで COM オブジェクトにアクセスしているのです。これは重要な事実であり、認識しておかなければなりません。\u003cbr\u003e\n　COMの規定によれば、COMオブジェクトたるもの「自分のメモリーは自分で解放する責任がある」とのこと。そして、それを実現するためには、参照カウントというテクニックが用いられます。参照カウントとは、その COMオブジェクトが他からどれだけ参照されているかを示す数値です。COMオブジェクトは、自分が使ったメモリーを自分で解放するために、自身への参照数を自分で管理していて、参照数が\"0\"になったら他からの参照がなくなった（＝用済み）と判断して、自分自身のメモリーを解放してくれます。だけどもそれ故に、いま誰が必要とし、必要としなくなったのかは、使う側から通達しなくてはなりません。\u003cbr\u003e\n　.NETでメモリー管理といえばガベージコレクション（GC）です。COMオブジェクトを内包するRCWは、マネージドであり、もちろんGCの管理対象です。しかし、COMオブジェクトは、自分のメモリーは自分で解放する責務を負っています。ここに、メモリー管理のアプローチの違いからくるミスマッチが生まれています。RCWはGCの管理下にありますが、内包するCOMオブジェクトがGCの対象ではないので、結局、アプリケーション作成者が RCW を通じてCOMオブジェクトが使用するメモリーを、参照カウントというしくみで管理しなければならない、ということになっています。\u003cbr\u003e\n　管理するとは、つまり、RCWをすべて変数に保持しておくということであり、そしてその参照カウントをデクリメントするのがReleaseComObject()メソッドです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"VB\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVBScript\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eSub\u003c/span\u003e \u003cspan class=\"nf\"\u003eShowRangeA1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eexcel\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ebook\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eSet\u003c/span\u003e \u003cspan class=\"n\"\u003eexcel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Excel.Application\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eSet\u003c/span\u003e \u003cspan class=\"n\"\u003ebook\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eexcel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"hoge.xls\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ea1val\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ea1val\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSheets\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"A1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eClose\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexcel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eQuit\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eWScript\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEcho\u003c/span\u003e \u003cspan class=\"n\"\u003ea1val\u003c/span\u003e\n\u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eSub\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eVBScriptだとこれだけですむのに…\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eShowRangeA1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWorkbook\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e@\"hoge.xls\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eSheets\u003c/span\u003e \u003cspan class=\"n\"\u003exlSheets\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWorksheets\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eWorksheet\u003c/span\u003e \u003cspan class=\"n\"\u003exlSheet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWorksheet\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003exlSheets\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003exlCells\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlSheet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCells\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003exlRangeA1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003exlCells\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ea1val\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003exlRangeA1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlRangeA1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlCells\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlSheet\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlSheets\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eQuit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ea1val\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eC#だとごらんの有様だよ！\u003c/p\u003e\n\n\u003cp\u003e上記例を見ればわかるように、処理の本質ではないコード、タイプ量が激増しています。これだけでも十分面倒くさいのに、実は例外発生時にも確実にデクリメントを行うためには、RCWを生成するごとにtry～finallyをしてやらなければいけません。詳しくは\u003ca href=\"http://jeanne.wankuma.com/tips/csharp/programming/releasecom.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちらの記事\u003c/a\u003eを参考にして頂きますが、こうなると、超絶ネスト構造の一丁上がりです。意味がわかりません。しかし、COM相互参照を使用するということは、本来はこういうことを行う必要があると理解してください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"comオブジェクトを返すプロパティ一覧\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#com%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E8%BF%94%E3%81%99%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E4%B8%80%E8%A6%A7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCOMオブジェクトを返すプロパティ一覧\u003c/h2\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003e\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003e\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eApplication\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eAreas\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eBorders\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eCells\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eCharacters\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eColumns\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eComment\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eCurrentArray\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eCurrentRegion\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eDependents\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eDirectDependents\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eDirectPrecedents\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eEnd\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eEntireColumn\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eEntireRow\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eFont\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eFormatConditions\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eHyperlinks\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eInterior\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eItem\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eListObject\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eMDX\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eMergeArea\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eNext\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eOffset\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eParent\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003ePhonetic\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003ePhonetics\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003ePivotCell\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003ePivotField\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003ePivotItem\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003ePivotTable\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003ePrecedents\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003ePrevious\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eQueryTable\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eRange\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eResize\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eRows\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eServerActions\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eSmartTags\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eValidation\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eWorksheet\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eXPath\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サンプルアプリケーションのソースコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサンプルアプリケーションのソースコード\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"事前バインディング-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BA%8B%E5%89%8D%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e事前バインディング\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Linq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Threading.Tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//インターフェースの名前空間\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eExtractExcelDataInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//Excelを操作するために必要なクラスの名前空間を追加\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMicrosoft.Office.Interop.Excel\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eExtractExcelData\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExtractExcelUseExcelDLL\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIExtractExcelData\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eExtractExcelData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//returnするDicionaryインスタンス\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ファイルオープン\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWorkbook\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// シートを選択\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWorksheet\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSheets\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"メンバー一覧\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// セルの領域を選択\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eRange\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"A1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"B15\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 選択した領域の値をメモリー上に格納\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// （１セルずつ見ていくよりも早い）\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[,]\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 配列アクセスができるので、それぞれをDictionaryに追加\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// [WARNING] 配列の開始インデックスは１から\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// Excelのクローズ\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eQuit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放その２\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"遅延バインディング-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e遅延バインディング\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Linq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Threading.Tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eExtractExcelDataInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eExtractExcelData\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExtractDelayBinding\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIExtractExcelData\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eExtractExcelData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eActivator\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetTypeFromProgID\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Excel.Application\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Workbooks\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Open\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInvokeMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMissing\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// シートを選択\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Sheets\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"s\"\u003e\"メンバー一覧\"\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// セルの領域を選択\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Range\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"s\"\u003e\"A1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"B15\"\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 選択した領域の値をメモリー上に格納\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// （１セルずつ見ていくよりも早い）\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[,]\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[,];\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 配列アクセスができるので、それぞれをDictionaryに追加\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// [WARNING] 配列の開始インデックスは１から\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// Excelのクローズ\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Close\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInvokeMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvokeMember\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Quit\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInvokeMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放その２\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"dynamicキーワードを使用した遅延バインディング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#dynamic%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003edynamicキーワードを使用した遅延バインディング\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Linq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Threading.Tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eExtractExcelDataInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eExtractExcelData\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExtractDelayBindUseDynamic\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIExtractExcelData\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eExtractExcelData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ファイルオープン\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eActivator\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetTypeFromProgID\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Excel.Application\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWorkbooks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eExcelFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// シートを選択\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSheets\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"メンバー一覧\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// セルの領域を選択\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRange\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"A1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"B15\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 選択した領域の値をメモリー上に格納\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// （１セルずつ見ていくよりも早い）\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[,]\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 配列アクセスができるので、それぞれをDictionaryに追加\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// [WARNING] 配列の開始インデックスは１から\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTableRange\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esheet\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// Excelのクローズ\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eQuit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 使用したCOMオブジェクトを解放その２\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBook\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlBooks\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInteropServices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFinalReleaseComObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exlApp\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003e簡単に言うと、アプリを外から操作する技術 \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn2\"\u003e\n\u003cp\u003eCOMを使用して開発されたソフトウェア \u003ca href=\"#fnref2\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn3\"\u003e\n\u003cp\u003e「13」は忌み数なので欠番 \u003ca href=\"#fnref3\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn4\"\u003e\n\u003cp\u003e実行時にDLLが存在しないと行けないし、バージョン依存の記述もあるでしょうから、一概にすべて意識する必要がなくなるという訳でもないですが…… \u003ca href=\"#fnref4\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","createdAt":"2019-08-29T08:07:55Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"kxOB8F8rVRRofxImcy2L9OdvEEfb91ngbA==--c1OVvaoE4EHnaOJg--Aooh2fTvFKwW6HtQAqAajA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-08-29T08:14:58Z","likesCount":25,"linkUrl":"https://qiita.com/tomohideyo/items/f46eab04b86316d917c5","organization":null,"originalId":1007654,"stockedCount":24,"title":".NET FrameworkからのExcel操作","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BA%8B%E5%89%8D%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e事前バインディング\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%B8%E5%8F%82%E7%85%A7%E3%82%92%E8%BF%BD%E5%8A%A0\"\u003eプロジェクトへ参照を追加\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC\"\u003eソースコード解説\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E5%87%A6%E7%90%86\"\u003e前処理\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B7%E3%83%BC%E3%83%88%E3%82%BB%E3%83%AB%E3%81%AE%E9%A0%98%E5%9F%9F%E6%8C%87%E5%AE%9A\"\u003eシート、セルの領域指定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%81%B8%E6%8A%9E%E3%81%97%E3%81%9F%E3%82%BB%E3%83%AB%E9%A0%98%E5%9F%9F%E3%81%8B%E3%82%89%E5%80%A4%E3%81%AE%E5%8F%96%E5%BE%97\"\u003e選択したセル領域から値の取得\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%96%E5%BE%97%E3%81%97%E3%81%9F%E5%80%A4%E3%81%AE%E8%A9%B0%E3%82%81%E6%9B%BF%E3%81%88\"\u003e取得した値の詰め替え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BE%8C%E5%87%A6%E7%90%86\"\u003e後処理\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#com%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E8%A7%A3%E6%94%BE%E3%81%97%E5%BF%98%E3%82%8C%E3%82%8B%E5%85%B8%E5%9E%8B%E7%9A%84%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003eCOMオブジェクトを解放し忘れる典型的パターン\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e遅延バインディング\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC-1\"\u003eソースコード解説\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003e遅延バインディングのデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cli\u003e\n\u003ca href=\"#c-40-dynamic%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e[C# 4.0] dynamicキーワードを用いた遅延バインディング\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#appendix\"\u003eAppendix.\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#com%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF\"\u003eCOMの仕組み\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#com%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E8%BF%94%E3%81%99%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E4%B8%80%E8%A6%A7\"\u003eCOMオブジェクトを返すプロパティ一覧\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003eサンプルアプリケーションのソースコード\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BA%8B%E5%89%8D%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0-1\"\u003e事前バインディング\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0-1\"\u003e遅延バインディング\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#dynamic%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E9%81%85%E5%BB%B6%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003edynamicキーワードを使用した遅延バインディング\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n","totalPv":21607,"uuid":"f46eab04b86316d917c5","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"iWd60Y1PWx0044kD5aBzL6x43VVg--GUIvAJFbhVLWoRCa--Q2iZf1YUnO1tOnm0qA4sVA==","originalId":432675,"description":"システムエンジニアという漠然とした概念つまり社会の歯車。 ","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":false,"linkedinUrl":null,"name":"","profileImageUrl":"https://lh4.googleusercontent.com/-IEcgZNtrBa0/AAAAAAAAAAI/AAAAAAAAAAc/G7JSCX54aMo/s50/photo.jpg","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Flh4.googleusercontent.com%2F-IEcgZNtrBa0%2FAAAAAAAAAAI%2FAAAAAAAAAAc%2FG7JSCX54aMo%2Fs50%2Fphoto.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=b7494d3fdf4e9f4327c68db6dc66360b","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Flh4.googleusercontent.com%2F-IEcgZNtrBa0%2FAAAAAAAAAAI%2FAAAAAAAAAAc%2FG7JSCX54aMo%2Fs50%2Fphoto.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=3cd3aa11e5836b6919dde752f163ea17","urlName":"tomohideyo","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Excel","urlName":"excel"},{"name":".NETFramework","urlName":".netframework"}],"followingLikers":{"edges":[]},"comments":{"totalCount":1}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
