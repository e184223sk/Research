進捗や技術情報などを外部公開しながら開発を進める「公開型開発」という取り組みがあります。生産性を向上させるツール『PRODUCTICA』の開発を開始！SNSなどで開発状況などを社外に公開しながら、開発を進めるという新しい取り組みになります。#公開型開発#PRODUCTICA#生産性向上 pic.twitter.com/7dYyIR5eZlそんな悩みを救うアプリの技術情報です。
ショートカットをレコメンドするためには、どのようなマウス操作が行われたかを判別する必要があります。
現在はExcelのみを対象にしてますが、Excel以外のアプリにも対応したいため、汎用的な処理方式が求められます。
つまり、操作イベントを得るために対象アプリのAPIを利用することや、対象アプリに処理を組み込むような方式は最終手段にする必要があります。クリックされた周辺画像を機械学習の画像分類で判別を行う案です。
この方式は、精度が保証し辛いことと、判別したい操作ごとに多くの学習データを作成するのが大変という問題があります。
特に精度の面は重要で、このアプリにおいては少々筋が悪いです。OCR方式は、クリックされた周辺画像を切り抜き、その画像をOCRにかけて文字列を抽出、判別します。
この方式は、セル、シートのコンテキストメニューの「挿入(I)...」において、OCRで同一の文字列である「挿入(I)...」が得られるため、セルの挿入なのか、シートの挿入なのか、判別できないという問題がありました。
また、コンテキストメニューの選択肢などの文字列が表示されているものには対応できますが、リボン内のアイコンクリックに対応するのは困難です。テンプレートマッチングは、対象画像を走査してテンプレート画像に一致する部分を見つける手法です。
つまり、画面キャプチャで取得したコンテキストメニューの画像と、事前に用意した行、列、セル、シートのコンテキストメニュー画像をマッチングすることで、マウス操作の判別が出来ます。
OCR方式では困難であったアイコンクリックも判別可能です。テンプレートマッチングはパラダイスの予感がします。OpenCVSharpを利用したテンプレートマッチングの例です。以下の形で利用します。以下の画像を MatchTemplate フォルダに格納します。
コンテキストメニューには「列の幅」を入れるなど、当該コンテキストメニューの特徴となる部分もテンプレ画像含めることがポイントになります。
コンテキストメニューだけでなく、アイコンクリックも判別出来ようにSave、Boldアイコンも用意しました。マウスクリックされた周辺画像を入力したところ、良好な結果を得ることができました。
きちんとテンプレート画像に合致する箇所が識別され、赤枠で囲まれています。マウス操作の判定精度向上の為、テンプレートマッチング方式を検証。左ウィンドウの赤枠の部分がテンプレ画像とマッチした部分です。判別したい操作のテンプレ画像を用意することで、かなり精度が出ます。#公開型開発#PRODUCTICA#テンプレートマッチング pic.twitter.com/0fm7R3h6ev明日のリレー記事は @o-chang です！リンク情報システム株式会社では一緒に働く仲間を随時募集しています！
また、お仕事のご依頼、ビジネスパートナー様も募集しております。お気軽にご連絡ください。
Facebook：https://ja-jp.facebook.com/lis.co.jp/
Twitter：https://twitter.com/liscojp/
公開型開発「PRODUCTICA」公式：https://twitter.com/Productica_lis
　
　


