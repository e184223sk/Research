<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#のエラーハンドリング実装あれこれ - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/masaru_b_cl/items/104f1df602ac56487806" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="jLnkWtEzLaRqBRRxhlPMlcsxsRFupFA5m+a0qb88/lsUbYMqkNR1UpqFwSF2rgFXEMRSRQuy8g+HPpM0qy5/ig==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@masaru_b_cl" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#のエラーハンドリング実装あれこれ - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amdxampnNm5qZzd6amc0X2pnN1BqZzRuamc2cmpnN1BqZ3JEbHJwX29vNFhqZ1lMamdvempnWlBqZ293JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTVkYTZjNzVmN2RjMjM4MjA0MjM2ZWNmYzBmYmU5MDU1&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFoYzJGeWRWOWlYMk5zJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NjMzYTcyZTEwMGUxZTcwMWQwZWNjMDViM2ZkY2FlNWY&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=892b3ffc9660756894f5ef534bbd3034"><meta property="og:description" content="この記事はC# Advent Calendar 2017の19日目の記事です。

18日目は@usamik26さんの「Moq : Mocking Framework for .NET - Qiita」でした。


C#におけるエラーハ..."><meta content="https://qiita.com/masaru_b_cl/items/104f1df602ac56487806" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,AdventCalendar" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-29c84561-64cc-4722-8c89-b07aef3d9411"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fmasaru_b_cl%2Fitems%2F104f1df602ac56487806">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fmasaru_b_cl%2Fitems%2F104f1df602ac56487806">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-29c84561-64cc-4722-8c89-b07aef3d9411">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-12-19T00:55:51.000+09:00","dateModified":"2017-12-21T14:23:43.000+09:00","headline":"C#のエラーハンドリング実装あれこれ","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amdxampnNm5qZzd6amc0X2pnN1BqZzRuamc2cmpnN1BqZ3JEbHJwX29vNFhqZ1lMamdvempnWlBqZ293JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTVkYTZjNzVmN2RjMjM4MjA0MjM2ZWNmYzBmYmU5MDU1\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFoYzJGeWRWOWlYMk5zJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NjMzYTcyZTEwMGUxZTcwMWQwZWNjMDViM2ZkY2FlNWY\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=892b3ffc9660756894f5ef534bbd3034","mainEntityOfPage":"https://qiita.com/masaru_b_cl/items/104f1df602ac56487806","author":{"@type":"Person","address":"Nagaoka, Niigata Pref., Japan","email":null,"identifier":"masaru_b_cl","name":"masaru_b_cl","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F12039%2Fprofile-images%2F1473682255?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=52953c9c7ec6b059fae2c2139ef850fa","url":"https://qiita.com/masaru_b_cl","description":"越後の在宅リモートワーカー / JavaとかC#とかGitとかTDDとかビルドとか洗濯とかアイロンとかを主に嗜んでおります","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"masaru_b_cl","type":"items","id":"104f1df602ac56487806"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"masaru_b_cl","type":"items","id":"104f1df602ac56487806"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"masaru_b_cl","type":"items","id":"104f1df602ac56487806"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/masaru_b_cl/items/104f1df602ac56487806","location":"/masaru_b_cl/items/104f1df602ac56487806","scheme":"https","host":"qiita.com","port":null,"pathname":"/masaru_b_cl/items/104f1df602ac56487806","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"QpHxeH/X/TIXorFpf5teF8Rqdza5QVRQULUiHVIMC43aRZYIPjClxOciZDmPZpPVH5+UYtxX9mZMbQWARh6KXA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-98672609-42c1-46a3-b0ef-e47e45792bf1"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/masaru_b_cl/items/104f1df602ac56487806/likers" class="css-1iupg5d">79</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">77</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/104f1df602ac56487806/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/masaru_b_cl/items/104f1df602ac56487806/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/masaru_b_cl/items/104f1df602ac56487806/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/masaru_b_cl/items/104f1df602ac56487806/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/masaru_b_cl/items/104f1df602ac56487806.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2017/csharp" class="it-AdcalRibbon_title">C#<!-- --> Advent Calendar<!-- --> <!-- -->2017</a>Day 19</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/masaru_b_cl"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/12039/profile-images/1473682255" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/masaru_b_cl" class="css-10ougpm">@<!-- -->masaru_b_cl</a><div class="css-1ay9vb9"><span><meta content="2017-12-18T15:55:51Z"/><time dateTime="2017-12-21T05:23:43Z" class="css-m19uds">updated at 2017-12-21</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#のエラーハンドリング実装あれこれ</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/adventcalendar" class="css-4czcte">AdventCalendar</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>この記事は<a href="https://qiita.com/advent-calendar/2017/csharp">C# Advent Calendar 2017</a>の19日目の記事です。</p>

<p>18日目は<a href="https://twitter.com/usamik26" rel="nofollow noopener" target="_blank">@usamik26</a>さんの「<a href="https://qiita.com/usamik26/items/42959d8b95397d3a8ffb" id="reference-79d553b27e2508d33025">Moq : Mocking Framework for .NET - Qiita</a>」でした。</p>

<h1>
<span id="cにおけるエラーハンドリング" class="fragment"></span><a href="#c%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>C#におけるエラーハンドリング</h1>

<p>C#は2002年に.NET Frameworkとともにバージョン1.0がリリースされ<sup id="fnref1"><a href="#fn1" title="https://en.wikipedia.org/wiki/C_Sharp_(programming_language)#Versions">1</a></sup>、既に15年ほどの歴史があり、2017年12月19日現在はバージョン7.2まで進化しています<sup id="fnref2"><a href="#fn2" title="VS 15.5で正式サポート開始 https://blogs.msdn.microsoft.com/visualstudio/2017/12/04/visual-studio-2017-version-15-5-visual-studio-for-mac-released/">2</a></sup>。その歴史の中では、当然言語機能も増え、エラーハンドリングのやり方も徐々に種類が増えてきました。</p>

<p>そこで、C#に置けるエラーハンドリングの実装を一度ここで整理し、特徴をまとめてみます。</p>

<h1>
<span id="免責事項" class="fragment"></span><a href="#%E5%85%8D%E8%B2%AC%E4%BA%8B%E9%A0%85"><i class="fa fa-link"></i></a>免責事項</h1>

<p>このリストはもちろん完全ではありません。誤字脱字から認識の齟齬、他にもこんなやりかたがあるよ、特徴にこんなものがあるよ、などありましたら、遠慮なく<strong>編集リクエスト</strong>や<strong>コメント</strong>にてお知らせください。</p>

<h1>
<span id="前提条件" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><i class="fa fa-link"></i></a>前提条件</h1>

<p>ここで「エラー」と呼んでいるのは例外(Exception)ではなく、ロジックのエラー(いわゆる業務エラー)のことを指しています。エラーの種類については、<a href="https://twitter.com/nakama00" rel="nofollow noopener" target="_blank">赤間さん</a>のエントリ<a href="https://blogs.msdn.microsoft.com/nakama/2008/12/29/net-part-1/" rel="nofollow noopener" target="_blank">.NETの例外処理</a>の定義に倣います。</p>

<h1>
<span id="エラーハンドリング実装あれこれ" class="fragment"></span><a href="#%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E5%AE%9F%E8%A3%85%E3%81%82%E3%82%8C%E3%81%93%E3%82%8C"><i class="fa fa-link"></i></a>エラーハンドリング実装あれこれ</h1>

<h2>
<span id="1-エラーハンドリングをしない" class="fragment"></span><a href="#1-%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%82%92%E3%81%97%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>1. エラーハンドリングをしない</h2>

<p>業務エラーと判定する処理がない場合、エラーハンドリングを端折ることもあるでしょう。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// メソッド定義</span>
<span class="kt">string</span> <span class="nf">NonErrorHandling</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">){</span>
  <span class="k">return</span> <span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="nf">NonErrorHandling</span><span class="p">(</span><span class="n">userName</span><span class="p">);</span>  
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>エラー処理がない分メインの処理はわかりやすくなる</li>
</ul>

<h3>
<span id="デメリット" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>エラー時は実行時例外が発生してしまう可能性が高い</li>
</ul>

<h2>
<span id="2-戻り値がデフォルト値かどうかでエラー有無を判定する" class="fragment"></span><a href="#2-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%8C%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E5%80%A4%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E6%9C%89%E7%84%A1%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>2. 戻り値がデフォルト値かどうかでエラー有無を判定する</h2>

<p>処理結果を返す際、エラーがあった場合は処理結果の型の既定値(例：intなら0、参照型ならnull)を返します。ただ、本Advent Calendar 9日目の猪股さんによる「<a href="https://qiita.com/matarillo/items/4304df03d28db889f7e5" id="reference-99f07a470652f62b02f4">Null 非許容な参照型 - Qiita</a>にある通り、今後は参照型でもnullを排除していく方向ですので、注意が必要です。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// メソッド定義</span>
<span class="kt">string</span> <span class="nf">ReturningResultOnly</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span>

  <span class="k">return</span> <span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="nf">ReturningResultOnly</span><span class="p">(</span><span class="n">userName</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Some Error!"</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-1" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-1"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>結果とエラーを1つの変数で扱える</li>
</ul>

<h3>
<span id="デメリット-1" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-1"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>エラーがあったかどうかの検出しかできない

<ul>
<li>どのようなエラーなのかが表現できない</li>
</ul>
</li>
</ul>

<h2>
<span id="3-戻り値と同じ型でエラーも扱う" class="fragment"></span><a href="#3-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A8%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%82%E6%89%B1%E3%81%86"><i class="fa fa-link"></i></a>3. 戻り値と同じ型でエラーも扱う</h2>

<p>ひとつ前と戻り値と同じ型でエラーを表すのは同じですが、既定値ではなくあらかじめ決めて置いた値をエラーとして扱います。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// メソッド定義</span>
<span class="kt">string</span> <span class="nf">ReturningResultOrErrorCode</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="k">return</span> <span class="s">"E001"</span><span class="p">;</span>

  <span class="c1">// some validation with return error code "Exxx";</span>

  <span class="k">return</span> <span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="nf">ReturningResultOrErrorCode</span><span class="p">(</span><span class="n">userName</span><span class="p">);</span>
  <span class="k">switch</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">case</span> <span class="s">"E001"</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"name is empty!"</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="c1">// case "Exx" :</span>
    <span class="c1">//   error handling</span>
    <span class="c1">//   return;</span>
  <span class="p">}</span>

  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>    
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-2" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-2"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>多くの種類のエラーを表現できる</li>
<li>エラーコードなどを返し、呼び出し元でエラーコードをもとにエラーメッセージを引くといったことができる</li>
</ul>

<h3>
<span id="デメリット-2" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-2"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>処理結果とエラー内容が混ざってしまう</li>
<li>正常値とエラー値の境界がコード上に現れない

<ul>
<li>エラーとする値の範囲をもれなく扱うのが困難</li>
<li>定数として定義しても管理が大変</li>
</ul>
</li>
<li>想定していないエラー値が入り込む余地がある</li>
</ul>

<h2>
<span id="4-戻り値でエラー有無出力引数で処理結果を表す" class="fragment"></span><a href="#4-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E6%9C%89%E7%84%A1%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99"><i class="fa fa-link"></i></a>4. 戻り値でエラー有無、出力引数で処理結果を表す</h2>

<p>エラーかどうかと処理結果を分けます。成功/失敗のような単純なケースでは有用です。<br>
C# 7.0で追加された<a href="http://ufcpp.net/study/csharp/cheatsheet/ap_ver7/#out-var" rel="nofollow noopener" target="_blank">出力変数宣言</a>を使えば、すっきりと書くことができます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// メソッド定義</span>
<span class="kt">bool</span> <span class="nf">ReturningIsValidAndSettingResultToOutVar</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="k">out</span> <span class="kt">string</span> <span class="n">greeting</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="n">greeting</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">greeting</span> <span class="p">=</span> <span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>

  <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="n">isValid</span> <span class="p">=</span> <span class="nf">ReturningIsValidAndSettingResultToOutVar</span><span class="p">(</span><span class="n">userName</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">result</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(!</span><span class="n">isValid</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Some Error!"</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>    
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-3" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-3"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>結果とエラーが混ざらない</li>
</ul>

<h3>
<span id="デメリット-3" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-3"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>エラーがあったかどうかの検出しかできない

<ul>
<li>どのようなエラーなのかが表現できない</li>
</ul>
</li>
</ul>

<h2>
<span id="5-戻り値でエラーコード出力引数で処理結果を表す" class="fragment"></span><a href="#5-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%B3%E3%83%BC%E3%83%89%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99"><i class="fa fa-link"></i></a>5. 戻り値でエラーコード、出力引数で処理結果を表す</h2>

<p>ひとつ前と異なり、エラー有無をエラーコードで返します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="kt">string</span> <span class="nf">ReturningErrorCodeAndSettingResultToOutVar</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="k">out</span> <span class="kt">string</span> <span class="n">greeting</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="n">greeting</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="k">return</span> <span class="s">"E001"</span><span class="p">;</span>
  <span class="p">}</span> 

  <span class="c1">// some validation with return error code "Exxx";</span>

  <span class="n">greeting</span> <span class="p">=</span> <span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>

  <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="n">errorCode</span> <span class="p">=</span> <span class="nf">ReturningErrorCodeAndSettingResultToOutVar</span><span class="p">(</span><span class="n">userName</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">result</span><span class="p">);</span>
  <span class="k">switch</span><span class="p">(</span><span class="n">errorCode</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">case</span> <span class="s">"E001"</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"name is empty!"</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="c1">// case "Exx" :</span>
    <span class="c1">//   error handling</span>
    <span class="c1">//   return;</span>
  <span class="p">}</span>

  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-4" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-4"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>結果とエラーが混ざらない</li>
<li>多様なエラーを表せる</li>
<li>呼び出し元でエラーコードをもとにエラーメッセージを引くといったことができる</li>
</ul>

<h3>
<span id="デメリット-4" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-4"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>エラーがない場合を表す値がシグネチャからは分からない

<ul>
<li>あくまで「取り決め」としてエラーでない値を定める必要がある</li>
</ul>
</li>
</ul>

<h2>
<span id="6-列挙型の戻り値でエラーの種類出力引数で処理結果を表す" class="fragment"></span><a href="#6-%E5%88%97%E6%8C%99%E5%9E%8B%E3%81%AE%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99"><i class="fa fa-link"></i></a>6. 列挙型の戻り値でエラーの種類、出力引数で処理結果を表す</h2>

<p>現在のところ、最も現実的な実装方法の一つです。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// エラーの種類</span>
<span class="k">enum</span> <span class="n">ErrorType</span>
<span class="p">{</span>
  <span class="n">NoError</span><span class="p">,</span>
  <span class="n">NameIsEmpty</span><span class="p">,</span>
  <span class="c1">// SomeError</span>
<span class="p">}</span>

<span class="c1">// メソッド定義</span>
<span class="n">ErrorType</span> <span class="nf">ReturningErrorTypeAndSettingResultToOutVar</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="k">out</span> <span class="kt">string</span> <span class="n">greeting</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="n">greeting</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NameIsEmpty</span><span class="p">;</span>
  <span class="p">}</span> 

  <span class="c1">// some validation with return error code "Exxx";</span>

  <span class="n">greeting</span> <span class="p">=</span> <span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NoError</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="n">errorType</span> <span class="p">=</span> <span class="nf">ReturningErrorTypeAndSettingResultToOutVar</span><span class="p">(</span><span class="n">userName</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">result</span><span class="p">);</span>
  <span class="k">switch</span><span class="p">(</span><span class="n">errorType</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">case</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NoError</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="k">case</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NameIsEmpty</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"name is empty!"</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="c1">// case ErrorType.SomeError :</span>
    <span class="c1">//   error handling</span>
    <span class="c1">//   return;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-5" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-5"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>結果とエラーが混ざらない</li>
<li>多様なエラーを表せる</li>
<li>エラーの有無を型で表せる</li>
</ul>

<h3>
<span id="デメリット-5" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-5"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>エラーチェックの種類ごとに列挙型を定義しないといけない</li>
<li>エラーとするケースが増えても呼び出し側ではそのことがわからない</li>
</ul>

<h2>
<span id="7-処理結果とエラーの種類をvaluetupleで一緒に返す" class="fragment"></span><a href="#7-%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E%E3%82%92valuetuple%E3%81%A7%E4%B8%80%E7%B7%92%E3%81%AB%E8%BF%94%E3%81%99"><i class="fa fa-link"></i></a>7. 処理結果とエラーの種類をValueTupleで一緒に返す</h2>

<p>ひとつ前とほぼ同じですが、C# 7.0で導入された<a href="http://ufcpp.net/study/csharp/datatype/tuples/" rel="nofollow noopener" target="_blank">ValueTuple</a>を使って処理結果とエラーを一度に返します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// エラーの種類</span>
<span class="k">enum</span> <span class="n">ErrorType</span>
<span class="p">{</span>
  <span class="n">NoError</span><span class="p">,</span>
  <span class="n">NameIsEmpty</span><span class="p">,</span>
  <span class="c1">// SomeError</span>
<span class="p">}</span>

<span class="c1">// メソッド定義</span>
<span class="p">(</span><span class="kt">string</span> <span class="n">result</span><span class="p">,</span> <span class="n">ErrorType</span> <span class="n">errorType</span><span class="p">)</span> <span class="nf">ReturningResultAndErrorAsValueTuple</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NameIsEmpty</span><span class="p">);</span>
  <span class="p">}</span> 

  <span class="c1">// some validation with return error code "Exxx";</span>

  <span class="k">return</span> <span class="p">(</span><span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">,</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NoError</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">errorType</span><span class="p">)</span> <span class="p">=</span> <span class="nf">ReturningResultAndErrorAsValueTuple</span><span class="p">(</span><span class="n">userName</span><span class="p">);</span>
  <span class="k">switch</span><span class="p">(</span><span class="n">errorType</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">case</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NoError</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="k">case</span> <span class="n">ErrorType</span><span class="p">.</span><span class="n">NameIsEmpty</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"name is empty!"</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="c1">// case ErrorType.SomeError :</span>
    <span class="c1">//   error handling</span>
    <span class="c1">//   return;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-6" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-6"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>結果とエラーが混ざらない</li>
<li>多様なエラーを表せる</li>
<li>エラーの有無を型で表せる</li>
<li>ValueTupeの分解を使い結果とエラー種類の両方の変数を一度に宣言できる

<ul>
<li>Go言語っぽい書き味になる</li>
</ul>
</li>
</ul>

<h3>
<span id="デメリット-6" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-6"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>エラーチェックの種類ごとに列挙型を定義しないといけない</li>
<li>エラーとするケースが増えても呼び出し側ではそのことがわからない</li>
<li>ValueTupeがない古い<s>C#では使えない</s>.NET FrameworkではNuGetからパッケージを導入しないといけない(コメント欄にて<a href="/aetos" class="user-mention js-hovercard" title="aetos" data-hovercard-target-type="user" data-hovercard-target-name="aetos">@aetos</a>さんから<a href="https://qiita.com/masaru_b_cl/items/104f1df602ac56487806#comment-539c261f82fba5fc7afd">指摘あり</a>)<br>
<a href="https://www.nuget.org/packages/System.ValueTuple/" rel="nofollow noopener" target="_blank">NuGet Gallery | System.ValueTuple</a>
</li>
</ul>

<h2>
<span id="8例外を戻して型スイッチで分岐" class="fragment"></span><a href="#8%E4%BE%8B%E5%A4%96%E3%82%92%E6%88%BB%E3%81%97%E3%81%A6%E5%9E%8B%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81%E3%81%A7%E5%88%86%E5%B2%90"><i class="fa fa-link"></i></a>8.例外を戻して型スイッチで分岐</h2>

<p>C# 7.0から導入された<a href="http://ufcpp.net/study/csharp/datatype/typeswitch/" rel="nofollow noopener" target="_blank">型スイッチ</a>を活用する方法です。エラーを表すのに独自の型を作成するのでなく、既存の例外を再利用します。</p>

<p>※エントリ公開後に<a href="https://twitter.com/kazuk" rel="nofollow noopener" target="_blank">@kazuk</a>さんに教えてもらいました。</p>

<blockquote class="twitter-tweet">
<p>エラー値としてのenumはexceptionを使うのも割と選択肢として悪くない<br><br>return new indexoutofrangeexception</p>— Kazuhiko Kikuchi (@kazuk) <a href="https://twitter.com/kazuk/status/942911209774313472?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">2017年12月19日</a>
</blockquote>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 独自定義の例外</span>
<span class="k">class</span> <span class="nc">MyException</span> <span class="p">:</span> <span class="n">Exception</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">ErrorCode</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;}</span>
<span class="p">}</span>

<span class="c1">// メソッド定義</span>
<span class="p">(</span><span class="kt">string</span> <span class="n">result</span><span class="p">,</span> <span class="n">Exception</span> <span class="n">exception</span><span class="p">)</span> <span class="nf">ReturningResultAndExceptionAsValueTuple</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">name</span><span class="p">)));</span>
  <span class="p">}</span>

  <span class="kt">string</span> <span class="n">person</span> <span class="p">=</span> <span class="nf">FindByName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">person</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">new</span> <span class="n">MyException</span> <span class="p">{</span> <span class="n">ErrorCode</span> <span class="p">=</span> <span class="s">"E001"</span> <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span><span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">string</span> <span class="nf">FindByName</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// 名前から人を探しに行く</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="nf">StartsWith</span><span class="p">(</span><span class="s">"0"</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="c1">// 見つからなかった</span>
    <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="s">"FullName"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="kt">var</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="p">=</span> <span class="nf">ReturningResultAndExceptionAsValueTuple</span><span class="p">(</span><span class="n">userName</span><span class="p">);</span>
  <span class="k">switch</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">case</span> <span class="n">ArgumentNullException</span> <span class="n">ex</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">ex</span><span class="p">.</span><span class="n">ParamName</span><span class="p">}</span><span class="s"> is empty!"</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="k">case</span> <span class="n">MyException</span> <span class="n">ex</span> <span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Some Error: </span><span class="p">{</span><span class="n">ex</span><span class="p">.</span><span class="n">ErrorCode</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>

    <span class="k">case</span> <span class="n">Exception</span> <span class="n">ex</span><span class="p">:</span>
          <span class="k">throw</span> <span class="n">ex</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-7" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-7"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>既存の例外が標準ライブラリなどに豊富にあるため流用可能</li>
<li>独自の業務エラー用例外を作れば付加情報も扱える</li>
<li>業務例外以外はそのままthrowすることもできる</li>
<li>エラーなしを表す値を定義しなくてよい(nullでいける)</li>
</ul>

<h3>
<span id="デメリット-7" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-7"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>列挙型の時と同様にエラーとするケースが増えても呼び出し側ではそのことがわからない</li>
<li>null非許容の参照型が導入されたら注意が必要</li>
<li>型スイッチがない古いC#では使えない</li>
</ul>

<h2>
<span id="番外-例外を使って業務エラーも処理する" class="fragment"></span><a href="#%E7%95%AA%E5%A4%96-%E4%BE%8B%E5%A4%96%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E6%A5%AD%E5%8B%99%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%82%E5%87%A6%E7%90%86%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>番外. 例外を使って業務エラーも処理する</h2>

<p>業務エラーも例外を使って表します。いわゆる「部品」における引数の検証などではよく使われます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// メソッド定義</span>
<span class="kt">string</span> <span class="nf">ReturningResultAndThrowingBusinessException</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">name</span><span class="p">));</span>

  <span class="k">return</span> <span class="s">$"Hello! </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 呼び出し</span>
  <span class="kt">var</span> <span class="n">userName</span> <span class="p">=</span> <span class="s">"Sho"</span><span class="p">;</span>
  <span class="k">try</span>
  <span class="p">{</span>
    <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="nf">ReturningResultAndThrowingBusinessException</span><span class="p">(</span><span class="n">userName</span><span class="p">);</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="n">ArgumentNullException</span> <span class="n">ex</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"argument `</span><span class="p">{</span><span class="n">ex</span><span class="p">.</span><span class="n">ParamName</span><span class="p">}</span><span class="s">` is empty."</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="メリット-8" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-8"><i class="fa fa-link"></i></a>メリット</h3>

<ul>
<li>エラー時に即時に終了することが分かりやすい</li>
</ul>

<h3>
<span id="デメリット-8" class="fragment"></span><a href="#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-8"><i class="fa fa-link"></i></a>デメリット</h3>

<ul>
<li>例外は「重い」処理</li>
<li>例外は本当に「例外的」な時だけ使い、フロー制御に使うべきではない

<ul>
<li><a href="https://www.slideshare.net/t_wada/exception-design-by-contract/12" rel="nofollow noopener" target="_blank">例外設計における大罪 - SlideShare : 乱用(p.12)</a></li>
</ul>
</li>
</ul>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<p>現時点ではいずれの実装でも完全とは言えません。個人的には「<a href="http://ufcpp.net/blog/2016/12/tipsuniontypes/" rel="nofollow noopener" target="_blank">小ネタ チェック例外とUnion型 | ++C++; // 未確認飛行 C ブログ</a>」でも言及されているような、Union型があればいいなーとは思いますが、今のところ導入されそうな様子はありません。</p>

<p>しかし現実は待ってくれません。与えられた材料や条件を元に、それぞれのメリット、デメリットを天秤に掛け、最適と思えるやり方を選ぶことになります。</p>

<p>本エントリーが少しでもその助けとなれば幸いです。</p>

<p>20日目は<a href="https://twitter.com/4_mio_11" rel="nofollow noopener" target="_blank">@4_mio_11</a>さんの<a href="https://speakerdeck.com/rossam/shi-te-wakaru-c-number-7-dot-1madefalseyan-yu-ji-neng" rel="nofollow noopener" target="_blank">視て、わかる！C#7.1までの言語機能(スライド)</a>です。</p>

<h1>
<span id="サンプルコード" class="fragment"></span><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>サンプルコード</h1>

<p>本エントリのサンプルコードは、みんな大好き<a href="https://www.linqpad.net/" rel="nofollow noopener" target="_blank">LINQPad</a>の*.linqファイルとしてGitHubにアップしてあります。</p>

<p><qiita-embed-ogp src="https://github.com/masaru-b-cl/csharp-ac2017"></qiita-embed-ogp></p>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p><a href="https://en.wikipedia.org/wiki/C_Sharp_(programming_language)#Versions" class="autolink" rel="nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/C_Sharp_(programming_language)#Versions</a> <a href="#fnref1">↩</a></p>
</li>

<li id="fn2">
<p>VS 15.5で正式サポート開始 <a href="https://blogs.msdn.microsoft.com/visualstudio/2017/12/04/visual-studio-2017-version-15-5-visual-studio-for-mac-released/" class="autolink" rel="nofollow noopener" target="_blank">https://blogs.msdn.microsoft.com/visualstudio/2017/12/04/visual-studio-2017-version-15-5-visual-studio-for-mac-released/</a> <a href="#fnref2">↩</a></p>
</li>

</ol>
</div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fmasaru_b_cl%2Fitems%2F104f1df602ac56487806&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fmasaru_b_cl%2Fitems%2F104f1df602ac56487806&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/masaru_b_cl/items/104f1df602ac56487806/likers" class="css-1iupg5d">79</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">77</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/104f1df602ac56487806/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/masaru_b_cl/items/104f1df602ac56487806/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/masaru_b_cl/items/104f1df602ac56487806/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/masaru_b_cl/items/104f1df602ac56487806/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/masaru_b_cl/items/104f1df602ac56487806.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-98672609-42c1-46a3-b0ef-e47e45792bf1">{"authorAnalyticsTrackingId":"UA-44895823-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-84ef5d7a-3290-48d1-9154-ca4a7eb58d76"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-84ef5d7a-3290-48d1-9154-ca4a7eb58d76">{}</script>
      
<div id="LoginModal-react-component-341efbab-9af5-4fa3-9e2f-ab10ff2a650a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-341efbab-9af5-4fa3-9e2f-ab10ff2a650a">{}</script>
      
<div id="StockModal-react-component-552f64cb-2a54-4f22-8bef-b99badaebb5f"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-552f64cb-2a54-4f22-8bef-b99badaebb5f">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;QUBVNn0070l3Hq9rx+t71OPeBAsf+NOes80RjhmNcojZlDJGPNO3v4eeejs3FrYWOCvnX3rucaivFTYTDZ/zWQ==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eこの記事は\u003ca href=\"https://qiita.com/advent-calendar/2017/csharp\"\u003eC# Advent Calendar 2017\u003c/a\u003eの19日目の記事です。\u003c/p\u003e\n\n\u003cp\u003e18日目は\u003ca href=\"https://twitter.com/usamik26\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@usamik26\u003c/a\u003eさんの「\u003ca href=\"https://qiita.com/usamik26/items/42959d8b95397d3a8ffb\" id=\"reference-79d553b27e2508d33025\"\u003eMoq : Mocking Framework for .NET - Qiita\u003c/a\u003e」でした。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"cにおけるエラーハンドリング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#c%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eC#におけるエラーハンドリング\u003c/h1\u003e\n\n\u003cp\u003eC#は2002年に.NET Frameworkとともにバージョン1.0がリリースされ\u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" title=\"https://en.wikipedia.org/wiki/C_Sharp_(programming_language)#Versions\"\u003e1\u003c/a\u003e\u003c/sup\u003e、既に15年ほどの歴史があり、2017年12月19日現在はバージョン7.2まで進化しています\u003csup id=\"fnref2\"\u003e\u003ca href=\"#fn2\" title=\"VS 15.5で正式サポート開始 https://blogs.msdn.microsoft.com/visualstudio/2017/12/04/visual-studio-2017-version-15-5-visual-studio-for-mac-released/\"\u003e2\u003c/a\u003e\u003c/sup\u003e。その歴史の中では、当然言語機能も増え、エラーハンドリングのやり方も徐々に種類が増えてきました。\u003c/p\u003e\n\n\u003cp\u003eそこで、C#に置けるエラーハンドリングの実装を一度ここで整理し、特徴をまとめてみます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"免責事項\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%8D%E8%B2%AC%E4%BA%8B%E9%A0%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e免責事項\u003c/h1\u003e\n\n\u003cp\u003eこのリストはもちろん完全ではありません。誤字脱字から認識の齟齬、他にもこんなやりかたがあるよ、特徴にこんなものがあるよ、などありましたら、遠慮なく\u003cstrong\u003e編集リクエスト\u003c/strong\u003eや\u003cstrong\u003eコメント\u003c/strong\u003eにてお知らせください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前提条件\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提条件\u003c/h1\u003e\n\n\u003cp\u003eここで「エラー」と呼んでいるのは例外(Exception)ではなく、ロジックのエラー(いわゆる業務エラー)のことを指しています。エラーの種類については、\u003ca href=\"https://twitter.com/nakama00\" rel=\"nofollow noopener\" target=\"_blank\"\u003e赤間さん\u003c/a\u003eのエントリ\u003ca href=\"https://blogs.msdn.microsoft.com/nakama/2008/12/29/net-part-1/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NETの例外処理\u003c/a\u003eの定義に倣います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"エラーハンドリング実装あれこれ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E5%AE%9F%E8%A3%85%E3%81%82%E3%82%8C%E3%81%93%E3%82%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eエラーハンドリング実装あれこれ\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"1-エラーハンドリングをしない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1-%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%82%92%E3%81%97%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1. エラーハンドリングをしない\u003c/h2\u003e\n\n\u003cp\u003e業務エラーと判定する処理がない場合、エラーハンドリングを端折ることもあるでしょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eNonErrorHandling\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eNonErrorHandling\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラー処理がない分メインの処理はわかりやすくなる\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラー時は実行時例外が発生してしまう可能性が高い\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"2-戻り値がデフォルト値かどうかでエラー有無を判定する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%8C%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E5%80%A4%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E6%9C%89%E7%84%A1%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2. 戻り値がデフォルト値かどうかでエラー有無を判定する\u003c/h2\u003e\n\n\u003cp\u003e処理結果を返す際、エラーがあった場合は処理結果の型の既定値(例：intなら0、参照型ならnull)を返します。ただ、本Advent Calendar 9日目の猪股さんによる「\u003ca href=\"https://qiita.com/matarillo/items/4304df03d28db889f7e5\" id=\"reference-99f07a470652f62b02f4\"\u003eNull 非許容な参照型 - Qiita\u003c/a\u003eにある通り、今後は参照型でもnullを排除していく方向ですので、注意が必要です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Some Error!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e結果とエラーを1つの変数で扱える\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラーがあったかどうかの検出しかできない\n\n\u003cul\u003e\n\u003cli\u003eどのようなエラーなのかが表現できない\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"3-戻り値と同じ型でエラーも扱う\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A8%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%82%E6%89%B1%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3. 戻り値と同じ型でエラーも扱う\u003c/h2\u003e\n\n\u003cp\u003eひとつ前と戻り値と同じ型でエラーを表すのは同じですが、既定値ではなくあらかじめ決めて置いた値をエラーとして扱います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultOrErrorCode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\"E001\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e// some validation with return error code \"Exxx\";\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultOrErrorCode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s\"\u003e\"E001\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name is empty!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// case \"Exx\" :\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   error handling\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   return;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e    \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e多くの種類のエラーを表現できる\u003c/li\u003e\n\u003cli\u003eエラーコードなどを返し、呼び出し元でエラーコードをもとにエラーメッセージを引くといったことができる\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e処理結果とエラー内容が混ざってしまう\u003c/li\u003e\n\u003cli\u003e正常値とエラー値の境界がコード上に現れない\n\n\u003cul\u003e\n\u003cli\u003eエラーとする値の範囲をもれなく扱うのが困難\u003c/li\u003e\n\u003cli\u003e定数として定義しても管理が大変\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e想定していないエラー値が入り込む余地がある\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"4-戻り値でエラー有無出力引数で処理結果を表す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#4-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E6%9C%89%E7%84%A1%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e4. 戻り値でエラー有無、出力引数で処理結果を表す\u003c/h2\u003e\n\n\u003cp\u003eエラーかどうかと処理結果を分けます。成功/失敗のような単純なケースでは有用です。\u003cbr\u003e\nC# 7.0で追加された\u003ca href=\"http://ufcpp.net/study/csharp/cheatsheet/ap_ver7/#out-var\" rel=\"nofollow noopener\" target=\"_blank\"\u003e出力変数宣言\u003c/a\u003eを使えば、すっきりと書くことができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningIsValidAndSettingResultToOutVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eisValid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningIsValidAndSettingResultToOutVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eisValid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Some Error!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e    \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e結果とエラーが混ざらない\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラーがあったかどうかの検出しかできない\n\n\u003cul\u003e\n\u003cli\u003eどのようなエラーなのかが表現できない\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"5-戻り値でエラーコード出力引数で処理結果を表す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#5-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%B3%E3%83%BC%E3%83%89%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e5. 戻り値でエラーコード、出力引数で処理結果を表す\u003c/h2\u003e\n\n\u003cp\u003eひとつ前と異なり、エラー有無をエラーコードで返します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningErrorCodeAndSettingResultToOutVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\"E001\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n  \u003cspan class=\"c1\"\u003e// some validation with return error code \"Exxx\";\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eerrorCode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningErrorCodeAndSettingResultToOutVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eerrorCode\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s\"\u003e\"E001\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name is empty!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// case \"Exx\" :\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   error handling\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   return;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e結果とエラーが混ざらない\u003c/li\u003e\n\u003cli\u003e多様なエラーを表せる\u003c/li\u003e\n\u003cli\u003e呼び出し元でエラーコードをもとにエラーメッセージを引くといったことができる\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラーがない場合を表す値がシグネチャからは分からない\n\n\u003cul\u003e\n\u003cli\u003eあくまで「取り決め」としてエラーでない値を定める必要がある\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"6-列挙型の戻り値でエラーの種類出力引数で処理結果を表す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#6-%E5%88%97%E6%8C%99%E5%9E%8B%E3%81%AE%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e6. 列挙型の戻り値でエラーの種類、出力引数で処理結果を表す\u003c/h2\u003e\n\n\u003cp\u003e現在のところ、最も現実的な実装方法の一つです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// エラーの種類\u003c/span\u003e\n\u003cspan class=\"k\"\u003eenum\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eNoError\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eNameIsEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// SomeError\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningErrorTypeAndSettingResultToOutVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNameIsEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n  \u003cspan class=\"c1\"\u003e// some validation with return error code \"Exxx\";\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003egreeting\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNoError\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eerrorType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningErrorTypeAndSettingResultToOutVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eerrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNoError\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNameIsEmpty\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name is empty!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// case ErrorType.SomeError :\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   error handling\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   return;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e結果とエラーが混ざらない\u003c/li\u003e\n\u003cli\u003e多様なエラーを表せる\u003c/li\u003e\n\u003cli\u003eエラーの有無を型で表せる\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラーチェックの種類ごとに列挙型を定義しないといけない\u003c/li\u003e\n\u003cli\u003eエラーとするケースが増えても呼び出し側ではそのことがわからない\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"7-処理結果とエラーの種類をvaluetupleで一緒に返す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#7-%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E%E3%82%92valuetuple%E3%81%A7%E4%B8%80%E7%B7%92%E3%81%AB%E8%BF%94%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e7. 処理結果とエラーの種類をValueTupleで一緒に返す\u003c/h2\u003e\n\n\u003cp\u003eひとつ前とほぼ同じですが、C# 7.0で導入された\u003ca href=\"http://ufcpp.net/study/csharp/datatype/tuples/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eValueTuple\u003c/a\u003eを使って処理結果とエラーを一度に返します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// エラーの種類\u003c/span\u003e\n\u003cspan class=\"k\"\u003eenum\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eNoError\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eNameIsEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// SomeError\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e \u003cspan class=\"n\"\u003eerrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultAndErrorAsValueTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNameIsEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n  \u003cspan class=\"c1\"\u003e// some validation with return error code \"Exxx\";\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNoError\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eerrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultAndErrorAsValueTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eerrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNoError\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNameIsEmpty\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name is empty!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// case ErrorType.SomeError :\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   error handling\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//   return;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e結果とエラーが混ざらない\u003c/li\u003e\n\u003cli\u003e多様なエラーを表せる\u003c/li\u003e\n\u003cli\u003eエラーの有無を型で表せる\u003c/li\u003e\n\u003cli\u003eValueTupeの分解を使い結果とエラー種類の両方の変数を一度に宣言できる\n\n\u003cul\u003e\n\u003cli\u003eGo言語っぽい書き味になる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラーチェックの種類ごとに列挙型を定義しないといけない\u003c/li\u003e\n\u003cli\u003eエラーとするケースが増えても呼び出し側ではそのことがわからない\u003c/li\u003e\n\u003cli\u003eValueTupeがない古い\u003cs\u003eC#では使えない\u003c/s\u003e.NET FrameworkではNuGetからパッケージを導入しないといけない(コメント欄にて\u003ca href=\"/aetos\" class=\"user-mention js-hovercard\" title=\"aetos\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"aetos\"\u003e@aetos\u003c/a\u003eさんから\u003ca href=\"https://qiita.com/masaru_b_cl/items/104f1df602ac56487806#comment-539c261f82fba5fc7afd\"\u003e指摘あり\u003c/a\u003e)\u003cbr\u003e\n\u003ca href=\"https://www.nuget.org/packages/System.ValueTuple/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eNuGet Gallery | System.ValueTuple\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"8例外を戻して型スイッチで分岐\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#8%E4%BE%8B%E5%A4%96%E3%82%92%E6%88%BB%E3%81%97%E3%81%A6%E5%9E%8B%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81%E3%81%A7%E5%88%86%E5%B2%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e8.例外を戻して型スイッチで分岐\u003c/h2\u003e\n\n\u003cp\u003eC# 7.0から導入された\u003ca href=\"http://ufcpp.net/study/csharp/datatype/typeswitch/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e型スイッチ\u003c/a\u003eを活用する方法です。エラーを表すのに独自の型を作成するのでなく、既存の例外を再利用します。\u003c/p\u003e\n\n\u003cp\u003e※エントリ公開後に\u003ca href=\"https://twitter.com/kazuk\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@kazuk\u003c/a\u003eさんに教えてもらいました。\u003c/p\u003e\n\n\u003cblockquote class=\"twitter-tweet\"\u003e\n\u003cp\u003eエラー値としてのenumはexceptionを使うのも割と選択肢として悪くない\u003cbr\u003e\u003cbr\u003ereturn new indexoutofrangeexception\u003c/p\u003e— Kazuhiko Kikuchi (@kazuk) \u003ca href=\"https://twitter.com/kazuk/status/942911209774313472?ref_src=twsrc%5Etfw\" rel=\"nofollow noopener\" target=\"_blank\"\u003e2017年12月19日\u003c/a\u003e\n\u003c/blockquote\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 独自定義の例外\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyException\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eException\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorCode\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultAndExceptionAsValueTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eArgumentNullException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enameof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eperson\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eFindByName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eperson\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eMyException\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eErrorCode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"E001\"\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eFindByName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 名前から人を探しに行く\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 見つからなかった\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\"FullName\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultAndExceptionAsValueTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eArgumentNullException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParamName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e is empty!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eMyException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Some Error: \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eErrorCode\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-7\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e既存の例外が標準ライブラリなどに豊富にあるため流用可能\u003c/li\u003e\n\u003cli\u003e独自の業務エラー用例外を作れば付加情報も扱える\u003c/li\u003e\n\u003cli\u003e業務例外以外はそのままthrowすることもできる\u003c/li\u003e\n\u003cli\u003eエラーなしを表す値を定義しなくてよい(nullでいける)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-7\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e列挙型の時と同様にエラーとするケースが増えても呼び出し側ではそのことがわからない\u003c/li\u003e\n\u003cli\u003enull非許容の参照型が導入されたら注意が必要\u003c/li\u003e\n\u003cli\u003e型スイッチがない古いC#では使えない\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"番外-例外を使って業務エラーも処理する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%95%AA%E5%A4%96-%E4%BE%8B%E5%A4%96%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E6%A5%AD%E5%8B%99%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%82%E5%87%A6%E7%90%86%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e番外. 例外を使って業務エラーも処理する\u003c/h2\u003e\n\n\u003cp\u003e業務エラーも例外を使って表します。いわゆる「部品」における引数の検証などではよく使われます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// メソッド定義\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultAndThrowingBusinessException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eArgumentNullException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enameof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"Hello! \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// 呼び出し\u003c/span\u003e\n  \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003euserName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sho\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReturningResultAndThrowingBusinessException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euserName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eArgumentNullException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"argument `\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParamName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e` is empty.\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット-8\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eエラー時に即時に終了することが分かりやすい\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"デメリット-8\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデメリット\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e例外は「重い」処理\u003c/li\u003e\n\u003cli\u003e例外は本当に「例外的」な時だけ使い、フロー制御に使うべきではない\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.slideshare.net/t_wada/exception-design-by-contract/12\" rel=\"nofollow noopener\" target=\"_blank\"\u003e例外設計における大罪 - SlideShare : 乱用(p.12)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003e現時点ではいずれの実装でも完全とは言えません。個人的には「\u003ca href=\"http://ufcpp.net/blog/2016/12/tipsuniontypes/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e小ネタ チェック例外とUnion型 | ++C++; // 未確認飛行 C ブログ\u003c/a\u003e」でも言及されているような、Union型があればいいなーとは思いますが、今のところ導入されそうな様子はありません。\u003c/p\u003e\n\n\u003cp\u003eしかし現実は待ってくれません。与えられた材料や条件を元に、それぞれのメリット、デメリットを天秤に掛け、最適と思えるやり方を選ぶことになります。\u003c/p\u003e\n\n\u003cp\u003e本エントリーが少しでもその助けとなれば幸いです。\u003c/p\u003e\n\n\u003cp\u003e20日目は\u003ca href=\"https://twitter.com/4_mio_11\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@4_mio_11\u003c/a\u003eさんの\u003ca href=\"https://speakerdeck.com/rossam/shi-te-wakaru-c-number-7-dot-1madefalseyan-yu-ji-neng\" rel=\"nofollow noopener\" target=\"_blank\"\u003e視て、わかる！C#7.1までの言語機能(スライド)\u003c/a\u003eです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"サンプルコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサンプルコード\u003c/h1\u003e\n\n\u003cp\u003e本エントリのサンプルコードは、みんな大好き\u003ca href=\"https://www.linqpad.net/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eLINQPad\u003c/a\u003eの*.linqファイルとしてGitHubにアップしてあります。\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://github.com/masaru-b-cl/csharp-ac2017\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003e\u003ca href=\"https://en.wikipedia.org/wiki/C_Sharp_(programming_language)#Versions\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://en.wikipedia.org/wiki/C_Sharp_(programming_language)#Versions\u003c/a\u003e \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn2\"\u003e\n\u003cp\u003eVS 15.5で正式サポート開始 \u003ca href=\"https://blogs.msdn.microsoft.com/visualstudio/2017/12/04/visual-studio-2017-version-15-5-visual-studio-for-mac-released/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://blogs.msdn.microsoft.com/visualstudio/2017/12/04/visual-studio-2017-version-15-5-visual-studio-for-mac-released/\u003c/a\u003e \u003ca href=\"#fnref2\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","createdAt":"2017-12-18T15:55:51Z","elapsedYearsFromLastModifiedAt":3,"encryptedId":"WdzZlf9d6B/9TvTacxpbqqBL+NYPgt0Z--XsbmcAWXMKqixGxh--DrL9VgqAsVqYUNMqmD9SVQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2017-12-21T05:23:43Z","likesCount":79,"linkUrl":"https://qiita.com/masaru_b_cl/items/104f1df602ac56487806","organization":null,"originalId":590701,"stockedCount":77,"title":"C#のエラーハンドリング実装あれこれ","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#c%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0\"\u003eC#におけるエラーハンドリング\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%8D%E8%B2%AC%E4%BA%8B%E9%A0%85\"\u003e免責事項\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\"\u003e前提条件\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E5%AE%9F%E8%A3%85%E3%81%82%E3%82%8C%E3%81%93%E3%82%8C\"\u003eエラーハンドリング実装あれこれ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1-%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%82%92%E3%81%97%E3%81%AA%E3%81%84\"\u003e1. エラーハンドリングをしない\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%8C%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E5%80%A4%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E6%9C%89%E7%84%A1%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B\"\u003e2. 戻り値がデフォルト値かどうかでエラー有無を判定する\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-1\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-1\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#3-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A8%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%82%E6%89%B1%E3%81%86\"\u003e3. 戻り値と同じ型でエラーも扱う\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-2\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-2\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#4-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E6%9C%89%E7%84%A1%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99\"\u003e4. 戻り値でエラー有無、出力引数で処理結果を表す\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-3\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-3\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#5-%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%B3%E3%83%BC%E3%83%89%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99\"\u003e5. 戻り値でエラーコード、出力引数で処理結果を表す\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-4\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-4\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#6-%E5%88%97%E6%8C%99%E5%9E%8B%E3%81%AE%E6%88%BB%E3%82%8A%E5%80%A4%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E%E5%87%BA%E5%8A%9B%E5%BC%95%E6%95%B0%E3%81%A7%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%82%92%E8%A1%A8%E3%81%99\"\u003e6. 列挙型の戻り値でエラーの種類、出力引数で処理結果を表す\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-5\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-5\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#7-%E5%87%A6%E7%90%86%E7%B5%90%E6%9E%9C%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E%E3%82%92valuetuple%E3%81%A7%E4%B8%80%E7%B7%92%E3%81%AB%E8%BF%94%E3%81%99\"\u003e7. 処理結果とエラーの種類をValueTupleで一緒に返す\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-6\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-6\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#8%E4%BE%8B%E5%A4%96%E3%82%92%E6%88%BB%E3%81%97%E3%81%A6%E5%9E%8B%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81%E3%81%A7%E5%88%86%E5%B2%90\"\u003e8.例外を戻して型スイッチで分岐\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-7\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-7\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%95%AA%E5%A4%96-%E4%BE%8B%E5%A4%96%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E6%A5%AD%E5%8B%99%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%82%E5%87%A6%E7%90%86%E3%81%99%E3%82%8B\"\u003e番外. 例外を使って業務エラーも処理する\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-8\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88-8\"\u003eデメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%B3%E3%83%BC%E3%83%89\"\u003eサンプルコード\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":37658,"uuid":"104f1df602ac56487806","banReason":null,"adventCalendarItem":{"day":19,"calendar":{"name":"C#","urlName":"csharp","year":2017,"organization":null}},"author":{"encryptedId":"dxiNrOmZ622YxJzEs6YocWlhhcg=--t8WZzQ7nOkY+H0tB--ZEtLBcJshkED1LbH1HDHdQ==","originalId":12039,"description":"越後の在宅リモートワーカー / JavaとかC#とかGitとかTDDとかビルドとか洗濯とかアイロンとかを主に嗜んでおります","facebookUrl":"https://facebook.com/TAKANO.Sho","githubUrl":"https://github.com/masaru-b-cl","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":"https://www.linkedin.com/in/takanosho","name":"TAKANO Sho","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/12039/profile-images/1473682255","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F12039%2Fprofile-images%2F1473682255?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=bcc624c6caacf860e68c6d6b5b34c2e2","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F12039%2Fprofile-images%2F1473682255?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=52953c9c7ec6b059fae2c2139ef850fa","urlName":"masaru_b_cl","websiteUrl":"http://takanosho.wordpress.com/","twitterUrl":"https://twitter.com/masaru_b_cl","twitterUrlName":"masaru_b_cl","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"AdventCalendar","urlName":"adventcalendar"}],"followingLikers":{"edges":[]},"comments":{"totalCount":7}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
