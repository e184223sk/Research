<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Windows GUIプログラミング入門16 アラーム - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/Kosen-amai/items/02208712c8cac15ef995" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="qZfuz4pmo+S3r5mmsYTD6mOnGtwddWv1IS2MAIhi8HCxQ8ycWo5dDfdLnHrucrgfrxjj4rMEnVY92aO6MNsTAg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="Windows GUIプログラミング入門16 アラーム - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WMmx1Wkc5M2N5QkhWVW5qZzVmamc2M2pnckRqZzZuamc1X2pnN1BqZ3JEbGhhWHBsb0F4TmlEamdxTGpnNm5qZzd6amc2QSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1kMGNmNzU2NjBjNjg4MDA2MDEyZDFlM2FmNTFhZjczZg&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRXR2YzJWdUxXRnRZV2smdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1lMDg5ZWQ4OTRkZTM0ZGE1YWUzYmRhMzg4ODdiMGNkZQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=70551fee793ac6b734d6df2f8cbe3e3d"><meta property="og:description" content="

■はじめに

今回はアラームを作りながら正規表現やファイル読み書きなどを学びます。
入力チェックなどもして今までよりも少しまともなアプリケーションを作ります。

キーワード：正規表現, ファイル入出力, ファイル保存ダイアログ, ..."><meta content="https://qiita.com/Kosen-amai/items/02208712c8cac15ef995" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="Windows,C#,GUI,正規表現,入門" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-9b3cc116-844b-454f-a228-93e5b225165d"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FKosen-amai%2Fitems%2F02208712c8cac15ef995">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FKosen-amai%2Fitems%2F02208712c8cac15ef995">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-9b3cc116-844b-454f-a228-93e5b225165d">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/windows","name":"Windows"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-11-06T23:40:00.000+09:00","dateModified":"2020-10-06T19:20:46.000+09:00","headline":"Windows GUIプログラミング入門16 アラーム","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WMmx1Wkc5M2N5QkhWVW5qZzVmamc2M2pnckRqZzZuamc1X2pnN1BqZ3JEbGhhWHBsb0F4TmlEamdxTGpnNm5qZzd6amc2QSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1kMGNmNzU2NjBjNjg4MDA2MDEyZDFlM2FmNTFhZjczZg\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRXR2YzJWdUxXRnRZV2smdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1lMDg5ZWQ4OTRkZTM0ZGE1YWUzYmRhMzg4ODdiMGNkZQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=70551fee793ac6b734d6df2f8cbe3e3d","mainEntityOfPage":"https://qiita.com/Kosen-amai/items/02208712c8cac15ef995","author":{"@type":"Person","address":"","email":null,"identifier":"Kosen-amai","name":"Kosen-amai","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2Fprofile-images%2F1476188567?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d9b879212796ed8a879243c2e33fba15","url":"https://qiita.com/Kosen-amai","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Kosen-amai","type":"items","id":"02208712c8cac15ef995"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Kosen-amai","type":"items","id":"02208712c8cac15ef995"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Kosen-amai","type":"items","id":"02208712c8cac15ef995"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/Kosen-amai/items/02208712c8cac15ef995","location":"/Kosen-amai/items/02208712c8cac15ef995","scheme":"https","host":"qiita.com","port":null,"pathname":"/Kosen-amai/items/02208712c8cac15ef995","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"y1VaBrdk1uFcoMKYJQEe92NkY11PXO35RummW7xk0UfTgXhVZ4woCBxEx0R692UCr9uaY+EtG1paHYnhBN0yNQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-e430c3d4-74df-4d60-9d49-f618ff82a2fb"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Kosen-amai/items/02208712c8cac15ef995/likers" class="css-1iupg5d">8</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">6</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/02208712c8cac15ef995/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Kosen-amai/items/02208712c8cac15ef995/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Kosen-amai/items/02208712c8cac15ef995/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Kosen-amai/items/02208712c8cac15ef995/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Kosen-amai/items/02208712c8cac15ef995.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/Kosen-amai"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/142879/profile-images/1476188567" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/Kosen-amai" class="css-10ougpm">@<!-- -->Kosen-amai</a><div class="css-1ay9vb9"><span><meta content="2018-11-06T14:40:00Z"/><time dateTime="2020-10-06T10:20:46Z" class="css-m19uds">updated at 2020-10-06</time></span></div></div></div></div></div><h1 class="css-cgzq40">Windows GUIプログラミング入門16 アラーム</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/windows" class="css-4czcte">Windows</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/gui" class="css-4czcte">GUI</a><a href="/tags/%e6%ad%a3%e8%a6%8f%e8%a1%a8%e7%8f%be" class="css-4czcte">正規表現</a><a href="/tags/%e5%85%a5%e9%96%80" class="css-4czcte">入門</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>■はじめに</h1>

<p>今回はアラームを作りながら正規表現やファイル読み書きなどを学びます。<br>
入力チェックなどもして今までよりも少しまともなアプリケーションを作ります。</p>

<p>キーワード：正規表現, ファイル入出力, ファイル保存ダイアログ, タイマー,  Dictionary, スタイル, Null条件演算子</p>

<p>[注意]<br>
これまでの回で説明済みの操作方法等は、説明を省略したり簡略化している場合があります。</p>

<h1>
<span id="開発環境" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>■開発環境</h1>

<ul>
<li>Windows 10</li>
<li>Visual Studio Community 2017</li>
<li>.NET Framework 4.x</li>
</ul>

<h1>
<span id="作ってみる" class="fragment"></span><a href="#%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>■作ってみる</h1>

<h2>
<span id="画面作成" class="fragment"></span><a href="#%E7%94%BB%E9%9D%A2%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>◇画面作成</h2>

<p>新しいプロジェクトで <code>Visual C#</code> - <code>Windows デスクトップ</code> - <code>WPF アプリ</code>で任意の名前でプロジェクトを作成します。ここでは PoorAlarm と入力しました。<br>
そして以下のように画面を作成します。</p>

<p><a href="https://camo.qiitausercontent.com/e56889c03c19c9cf065c30b494eff8c69c353d22/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f38306438613233662d356531642d613934392d336335382d3439346234393938353066662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F80d8a23f-5e1d-a949-3c58-494b499850ff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4851deb6fda3cdb4fac914d70c2b4410" alt="wbg16-01.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/80d8a23f-5e1d-a949-3c58-494b499850ff.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F80d8a23f-5e1d-a949-3c58-494b499850ff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=384abdaea4fbb584fbe37da1d7510e0c 1x" loading="lazy"></a></p>

<p>Gridを横3×縦2に分割し、上段にLabel, TextBox, Button, ListBoxを、下段にRadioButtonを配置します。Gridの分割は <a href="https://qiita.com/Kosen-amai/items/af0c4962763f1b587387" title="Windows GUIプログラミング入門4 画面レイアウト(1)" id="reference-e41929c6c282caa4c3ce">連載4回目</a> や <a href="https://qiita.com/Kosen-amai/items/f2451acb2addd221193f" title="Windows GUIプログラミング入門5 画面レイアウト(2)、画面遷移(1)" id="reference-87de7f0a18c5cc2fe203">連載5回目</a> でやりましたね。<br>
Gridの<code>FocusManager.FocusedElement</code>は初期フォーカスを時刻のテキストボックスに設定しています。</p>

<div class="code-frame" data-lang="Xml">
<div class="code-lang"><span class="bold">MainWindow.xaml（Grid部分）</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Grid</span> <span class="na">FocusManager.FocusedElement=</span><span class="s">"{Binding ElementName=timeText}"</span> <span class="na">Background=</span><span class="s">"LightCyan"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Grid.RowDefinitions&gt;</span>
        <span class="nt">&lt;RowDefinition/&gt;</span>
        <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

    <span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
        <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;ColumnDefinition</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>

    <span class="nt">&lt;StackPanel&gt;</span>
        <span class="nt">&lt;Label</span> <span class="na">Content=</span><span class="s">"時刻"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;TextBox</span> <span class="na">Width=</span><span class="s">"60"</span> <span class="na">x:Name=</span><span class="s">"timeText"</span> <span class="na">MaxLength=</span><span class="s">"5"</span><span class="nt">/&gt;</span>

        <span class="nt">&lt;Label</span> <span class="na">Content=</span><span class="s">"メッセージ"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;TextBox</span> <span class="na">Height=</span><span class="s">"60"</span> <span class="na">Width=</span><span class="s">"200"</span> <span class="na">x:Name=</span><span class="s">"msgText"</span> <span class="na">TextWrapping=</span><span class="s">"Wrap"</span> <span class="na">VerticalScrollBarVisibility=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/StackPanel&gt;</span>

    <span class="nt">&lt;Button</span> <span class="na">Grid.Column=</span><span class="s">"1"</span> <span class="na">Content=</span><span class="s">"追加 &gt;"</span> <span class="na">IsDefault=</span><span class="s">"True"</span> <span class="na">Height=</span><span class="s">"30"</span> <span class="na">VerticalAlignment=</span><span class="s">"Top"</span> <span class="na">Margin=</span><span class="s">"5,50"</span> <span class="na">Padding=</span><span class="s">"5"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;ListBox</span> <span class="na">Grid.Column=</span><span class="s">"2"</span> <span class="na">Margin=</span><span class="s">"10"</span> <span class="na">x:Name=</span><span class="s">"listBox"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span> <span class="na">Grid.Row=</span><span class="s">"1"</span> <span class="na">Grid.ColumnSpan=</span><span class="s">"3"</span> <span class="na">Background=</span><span class="s">"PaleTurquoise"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;RadioButton</span> <span class="na">x:Name=</span><span class="s">"alarmOn"</span> <span class="na">Content=</span><span class="s">"アラームON"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;RadioButton</span> <span class="na">x:Name=</span><span class="s">"alarmOff"</span> <span class="na">Content=</span><span class="s">"アラームOFF"</span> <span class="na">IsChecked=</span><span class="s">"True"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/StackPanel&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</code></pre></div>
</div>

<p>WindowのResizeModeプロパティを変更してサイズ変更グリップを表示するようにしています。<br>
Window.Resourcesの中はLabel, TextBox, RadioButtonの既定のスタイルを設定しています。<br>
<a href="https://qiita.com/Kosen-amai/items/792c59392e72e65316bd" title="Windows GUIプログラミング入門10 設定保存(1)" id="reference-a1f5f93c0c818cdd5d26">連載10回目</a> ではスタイルに任意の名前を付けて、各コントロールのStyleプロパティでその名前を指定して適用していました。</p>

<div class="code-frame" data-lang="Xml">
<div class="code-lang"><span class="bold">MainWindow.xaml（先頭部分）</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"PoorAlarm.MainWindow"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:d=</span><span class="s">"http://schemas.microsoft.com/expression/blend/2008"</span>
        <span class="na">xmlns:mc=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
        <span class="na">xmlns:local=</span><span class="s">"clr-namespace:PoorAlarm"</span>
        <span class="na">mc:Ignorable=</span><span class="s">"d"</span>
        <span class="na">Title=</span><span class="s">"MainWindow"</span> <span class="na">Height=</span><span class="s">"450"</span> <span class="na">Width=</span><span class="s">"800"</span> <span class="na">ResizeMode=</span><span class="s">"CanResizeWithGrip"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Window.Resources&gt;</span>
        <span class="nt">&lt;Style</span> <span class="na">TargetType=</span><span class="s">"Label"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Margin"</span> <span class="na">Value=</span><span class="s">"5,10,5,2"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Padding"</span> <span class="na">Value=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Style&gt;</span>
        <span class="nt">&lt;Style</span> <span class="na">TargetType=</span><span class="s">"TextBox"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"HorizontalAlignment"</span> <span class="na">Value=</span><span class="s">"Left"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Margin"</span> <span class="na">Value=</span><span class="s">"5,0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Style&gt;</span>
        <span class="nt">&lt;Style</span> <span class="na">TargetType=</span><span class="s">"RadioButton"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Margin"</span> <span class="na">Value=</span><span class="s">"5"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Style&gt;</span>
    <span class="nt">&lt;/Window.Resources&gt;</span>

    <span class="nt">&lt;Grid</span> <span class="na">FocusManager.FocusedElement=</span><span class="s">"{Binding ElementName=timeText}"</span> <span class="na">Background=</span><span class="s">"LightCyan"</span><span class="nt">&gt;</span>
    ：
    ：
</code></pre></div>
</div>

<p>いったん実行してみます。</p>

<p><a href="https://camo.qiitausercontent.com/1e42c7d47100c857e60074468e7c37c5385d4445/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f33643136633939352d373937392d613938312d333363632d6631616132643062343837352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F3d16c995-7979-a981-33cc-f1aa2d0b4875.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1c11c22955e4c192c3a4de516e9be5d8" alt="wbg16-02.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/3d16c995-7979-a981-33cc-f1aa2d0b4875.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F3d16c995-7979-a981-33cc-f1aa2d0b4875.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3b40b41845a26ad5929fe17cfdb4be3a 1x" loading="lazy"></a></p>

<p>こんな感じ。<br>
時刻とメッセージを入力して追加ボタンを押すと右側の一覧に登録され、<br>
指定した時刻が来たら（アラームがONになっている場合）メッセージが表示される。<br>
というものにします。<br>
追加した時刻とメッセージの一覧は終了時にテキストファイルに保存し、次回起動時に読み込むようにします。</p>

<h2>
<span id="設定項目作成" class="fragment"></span><a href="#%E8%A8%AD%E5%AE%9A%E9%A0%85%E7%9B%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>◇設定項目作成</h2>

<p>アラームON/OFFラジオボタン選択値と、時刻・メッセージ一覧ファイルのパスを記録しておく設定項目を用意します。<br>
これは <a href="https://qiita.com/Kosen-amai/items/792c59392e72e65316bd" title="Windows GUIプログラミング入門10 設定保存(1)">連載10回目</a> でやりました。<br>
ソリューションエクスプローラーで<code>Settings.settings</code>をダブルクリックし、</p>

<p><a href="https://camo.qiitausercontent.com/30fa7b4499f911b3700c7d89307c7a066b77795f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f32323739303436612d393635302d656239362d663833382d6632383032613236643334342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F2279046a-9650-eb96-f838-f2802a26d344.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b40a54b06c58f81d060bf2fe8f86e66a" alt="wbg16-03.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/2279046a-9650-eb96-f838-f2802a26d344.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F2279046a-9650-eb96-f838-f2802a26d344.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1ed7a37aa0e71793377dcab29c9554ab 1x" loading="lazy"></a></p>

<p><code>AlarmEnabled</code>というbool型の設定項目と、<code>SaveConfigPath</code>というstring型の設定項目を用意します。</p>

<p><a href="https://camo.qiitausercontent.com/53498b07bc969e4ef20781e1b13ac2daedd21dd1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f39313632376262392d376562352d656461392d316235382d3334356233316239626264652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F91627bb9-7eb5-eda9-1b58-345b31b9bbde.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e45ee01d53fcb627b4a3187ab8876009" alt="wbg16-04.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/91627bb9-7eb5-eda9-1b58-345b31b9bbde.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F91627bb9-7eb5-eda9-1b58-345b31b9bbde.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9e12120d26411d7600213340a3e7ff45 1x" loading="lazy"></a></p>

<h2>
<span id="設定ファイル存在確認メソッド作成" class="fragment"></span><a href="#%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%AD%98%E5%9C%A8%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>◇設定ファイル存在確認メソッド作成</h2>

<p>設定の<code>SaveConfigPath</code>に値が設定されているか、設定されている場合はそのファイルが存在するか確認するメソッドを作成します。<br>
このメソッドは後で使います。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 一覧設定ファイルパス存在チェック</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;returns&gt;設定が有効ならtrue&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">bool</span> <span class="nf">IsExistsSaveConfigPath</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">SaveConfigPath</span><span class="p">)</span> <span class="p">||</span>
        <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">SaveConfigPath</span><span class="p">)</span> <span class="p">==</span> <span class="k">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// パスの設定が無い、または指定した場所にファイルが存在しない</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="c1">// パスが設定されていてファイルが実在する</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="文字列リソース作成" class="fragment"></span><a href="#%E6%96%87%E5%AD%97%E5%88%97%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>◇文字列リソース作成</h2>

<p>アプリのタイトルを文字列リソースとして登録します。<br>
ソリューションエクスプローラーで<code>Resources.resx</code>をダブルクリックし、</p>

<p><a href="https://camo.qiitausercontent.com/c7bf037f224e5c2126dc19ca22f0f1bc34411bd0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f36376264323163652d326234382d306336632d326162332d3965303961623462353435612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F67bd21ce-2b48-0c6c-2ab3-9e09ab4b545a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=628679c1b8c2aaf864851faeb0e005ad" alt="wbg16-05.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/67bd21ce-2b48-0c6c-2ab3-9e09ab4b545a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F67bd21ce-2b48-0c6c-2ab3-9e09ab4b545a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f9b1bf8ddb5bd73d0f4b04438e783df5 1x" loading="lazy"></a></p>

<p>「アクセス修飾子」を<code>Public</code>にし、<br>
「名前」に<code>AppTitle</code>、<br>
「値」にこのアプリの名前、<br>
「コメント」にこの文字列リソースをどこで使うのか等の説明を入力します。コメントは後で見た時に分かりやすくするためのものなので空欄でも構いません。</p>

<p><a href="https://camo.qiitausercontent.com/b7d224006ec1950a3b6e1c9d9701b6f390c5d0f5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f39356131656337392d353930392d633536332d303832652d6463306438616332363333662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F95a1ec79-5909-c563-082e-dc0d8ac2633f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2e5d5e91aebffd3f56e0bc5deef13fb2" alt="wbg16-06.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/95a1ec79-5909-c563-082e-dc0d8ac2633f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F95a1ec79-5909-c563-082e-dc0d8ac2633f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a3e25f8e5ad15f36ae1ca1818a0b50cf 1x" loading="lazy"></a></p>

<p>文字列リソースは英語版や日本語版など、多言語対応時に活きてくるものです。<br>
本来は画面のラベルやメッセージボックスのメッセージ内容なども文字列リソースとして登録しますが、今回は使い方の紹介なのでタイトルだけ登録します。</p>

<p>ここまでで一度ビルドしておきましょう。</p>

<h2>
<span id="文字列リソースの利用" class="fragment"></span><a href="#%E6%96%87%E5%AD%97%E5%88%97%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E5%88%A9%E7%94%A8"><i class="fa fa-link"></i></a>◇文字列リソースの利用</h2>

<p>Xamlに<code>xmlns:prop="clr-namespace:PoorAlarm.Properties"</code>を追加します。<br>
これでPropertiesが<code>prop</code>という識別子でアクセス可能になったので、<br>
<code>Title</code>プロパティの値を <code>{x:Static prop:Resources.AppTitle}</code> に書き換えます。</p>

<div class="code-frame" data-lang="Xml">
<div class="code-lang"><span class="bold">MainWindow.xaml（先頭部分）</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"PoorAlarm.MainWindow"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:d=</span><span class="s">"http://schemas.microsoft.com/expression/blend/2008"</span>
        <span class="na">xmlns:mc=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
        <span class="na">xmlns:local=</span><span class="s">"clr-namespace:PoorAlarm"</span>
        <span class="na">xmlns:prop=</span><span class="s">"clr-namespace:PoorAlarm.Properties"</span>
        <span class="na">mc:Ignorable=</span><span class="s">"d"</span>
        <span class="na">Title=</span><span class="s">"{x:Static prop:Resources.AppTitle}"</span> <span class="na">Height=</span><span class="s">"450"</span> <span class="na">Width=</span><span class="s">"800"</span> <span class="na">ResizeMode=</span><span class="s">"CanResizeWithGrip"</span><span class="nt">&gt;</span>
</code></pre></div>
</div>

<h2>
<span id="メッセージボックス表示メソッド作成" class="fragment"></span><a href="#%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E8%A1%A8%E7%A4%BA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>◇メッセージボックス表示メソッド作成</h2>

<p>メッセージボックスを表示するためのメソッドを作成します。<br>
<a href="https://qiita.com/Kosen-amai/items/f9e3df2aa80363f5af5b" title="Windows GUIプログラミング入門1 メッセージボックス表示" id="reference-1c266a6e60d6f72dd082">連載1回目</a> のメッセージボックスと違い、メッセージボックスタイトルとアイコンも指定しています。<br>
ここでもタイトル部分にリソース文字列を使用しています。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 情報メッセージ表示</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="msg"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">InfoMsg</span><span class="p">(</span><span class="kt">string</span> <span class="n">msg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">AppTitle</span><span class="p">,</span> 
        <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span> <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Information</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// エラーメッセージ表示</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="msg"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">ErrMsg</span><span class="p">(</span><span class="kt">string</span> <span class="n">msg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">AppTitle</span><span class="p">,</span> 
        <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span> <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Error</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="追加ボタンの処理1" class="fragment"></span><a href="#%E8%BF%BD%E5%8A%A0%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%87%A6%E7%90%861"><i class="fa fa-link"></i></a>◇追加ボタンの処理1</h2>

<p>追加ボタンのイベントハンドラを記述します。</p>

<div class="code-frame" data-lang="Xml">
<div class="code-lang"><span class="bold">MainWindow.xaml（追加ボタン定義）</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Button</span> <span class="na">Grid.Column=</span><span class="s">"1"</span> <span class="na">Content=</span><span class="s">"追加 &gt;"</span> <span class="na">IsDefault=</span><span class="s">"True"</span> <span class="na">Height=</span><span class="s">"30"</span> <span class="na">VerticalAlignment=</span><span class="s">"Top"</span> <span class="na">Margin=</span><span class="s">"5,50"</span> <span class="na">Padding=</span><span class="s">"5"</span> <span class="na">Click=</span><span class="s">"Button_Click"</span><span class="nt">/&gt;</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 追加ボタンクリック時の処理</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Button_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DateTime</span> <span class="n">d</span><span class="p">;</span>

    <span class="c1">// 時刻チェック</span>
    <span class="c1">//（数字2桁:数字2桁か簡易チェックしてOKならDateTime型に変換できるかチェックする）</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">RegularExpressions</span><span class="p">.</span><span class="n">Regex</span><span class="p">.</span><span class="nf">IsMatch</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="s">"^[0-9]{2}:[0-9]{2}$"</span><span class="p">)</span> <span class="p">&amp;&amp;</span>
        <span class="n">DateTime</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="s">"2000/01/01 "</span> <span class="p">+</span> <span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="k">out</span> <span class="n">d</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="c1">// 時刻として正しい</span>

        <span class="c1">// メッセージが入力されているか？</span>
        <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">msgText</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="c1">// メッセージ未入力（または空白しか入力されていない）</span>
            <span class="nf">ErrMsg</span><span class="p">(</span><span class="s">"メッセージを入力してください。"</span><span class="p">);</span>
            <span class="n">msgText</span><span class="p">.</span><span class="nf">Focus</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="c1">// 時刻もメッセージも入力されている</span>

            <span class="c1">// 一覧に追加</span>
            <span class="n">listBox</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span> <span class="p">+</span> <span class="s">"\t"</span> <span class="p">+</span> <span class="n">msgText</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>

            <span class="n">timeText</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">msgText</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">timeText</span><span class="p">.</span><span class="nf">Focus</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="c1">// 時刻として正しくない</span>
        <span class="nf">ErrMsg</span><span class="p">(</span><span class="s">"時刻を正しく入力してください。例）12:34"</span><span class="p">);</span>
        <span class="n">timeText</span><span class="p">.</span><span class="nf">Focus</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="時刻チェック1" class="fragment"></span><a href="#%E6%99%82%E5%88%BB%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF1"><i class="fa fa-link"></i></a>時刻チェック1</h3>

<p>まず、正規表現というものを使って入力された時刻が「数字2桁」 + 「:」 + 「数字2桁」になっているかチェックしています。<br>
条件に合致していればRegexクラスのIsMatchメソッドはtrueを返します。<br>
<code>"^[0-9]{2}:[0-9]{2}$"</code> の<code>^</code>は行頭、<code>[0-9]</code>は0～9のいずれか、<code>{2}</code>は直前（左）の文字を2回繰り返す、<code>$</code>は行末を意味します。<br>
<code>"^あいう"</code>という正規表現は、「あいう」から始まる<code>"あいうえお"</code>にはヒットしますが<code>"ああいうえお"</code>にはヒットしません。<br>
<code>"^いよ$"</code>という正規表現は<code>"いよ"</code>にはヒットしますが、<code>"いいよ"</code>、<code>"いよかん"</code>、<code>"たいよう"</code>にはヒットしません。</p>

<h3>
<span id="時刻チェック2" class="fragment"></span><a href="#%E6%99%82%E5%88%BB%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF2"><i class="fa fa-link"></i></a>時刻チェック2</h3>

<p>しかしこのままでは<code>25:99</code>なんてものもチェックを通ってしまいます。<br>
そこで次にDateTimeクラスのTryParseメソッドを使って日付型に変換できるか確認しています。<br>
日付型への変換が成功すれば戻り値にtrueが返り、2番目の引数に変換後の日付オブジェクトが設定されます。が、今回は日付に変換できるか知りたいだけなので<code>d</code>変数はこの先使いません。</p>

<h3>
<span id="時刻とメッセージの一覧への追加" class="fragment"></span><a href="#%E6%99%82%E5%88%BB%E3%81%A8%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AE%E4%B8%80%E8%A6%A7%E3%81%B8%E3%81%AE%E8%BF%BD%E5%8A%A0"><i class="fa fa-link"></i></a>時刻とメッセージの一覧への追加</h3>

<p>メッセージが入力されていることを確認したらリストボックスに時間とメッセージをタブ区切りで追加します。<code>\t</code>はタブ文字です。<br>
途中のチェックでエラーがあればエラーメッセージを表示します。</p>

<h2>
<span id="動作確認" class="fragment"></span><a href="#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>◇動作確認</h2>

<p>ここまでで一度実行してみましょう。</p>

<p>正しくない時刻を入力して追加ボタンを押してみると、エラーメッセージが表示されます。</p>

<p><a href="https://camo.qiitausercontent.com/25423a8692986e2055c001ff8864a94a71a9b7d8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f38323034393862312d623763652d383133642d326364392d6464653232306464346266632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F820498b1-b7ce-813d-2cd9-dde220dd4bfc.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d5c28aa69bab22280cb20cbd2aac8579" alt="wbg16-07.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/820498b1-b7ce-813d-2cd9-dde220dd4bfc.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F820498b1-b7ce-813d-2cd9-dde220dd4bfc.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=45ed666ccae61d59ce85e3c885230021 1x" loading="lazy"></a></p>

<p>正しい時刻とメッセージを入力して追加ボタンを押すと右の一覧に追加されます。</p>

<p><a href="https://camo.qiitausercontent.com/2c43c47f3a1a415838b98517ba6ea569d9fe6d28/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f34663665333766372d656138332d333837342d323939612d3563366530663730333634632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F4f6e37f7-ea83-3874-299a-5c6e0f70364c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f6ee5bfc03c904003769c8143e350e70" alt="wbg16-08.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/4f6e37f7-ea83-3874-299a-5c6e0f70364c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F4f6e37f7-ea83-3874-299a-5c6e0f70364c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cd17169b25ce229079983fc17d50ac23 1x" loading="lazy"></a></p>

<h2>
<span id="ウィンドウ起動時と終了時の処理" class="fragment"></span><a href="#%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%A8%E7%B5%82%E4%BA%86%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>◇ウィンドウ起動時と終了時の処理</h2>

<p>ウィンドウ起動時と終了時のイベントハンドラを用意します。</p>

<div class="code-frame" data-lang="Xml">
<div class="code-lang"><span class="bold">MainWindow.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"PoorAlarm.MainWindow"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:d=</span><span class="s">"http://schemas.microsoft.com/expression/blend/2008"</span>
        <span class="na">xmlns:mc=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
        <span class="na">xmlns:local=</span><span class="s">"clr-namespace:PoorAlarm"</span>
        <span class="na">xmlns:prop=</span><span class="s">"clr-namespace:PoorAlarm.Properties"</span>
        <span class="na">mc:Ignorable=</span><span class="s">"d"</span>
        <span class="na">Title=</span><span class="s">"{x:Static prop:Resources.AppTitle}"</span> <span class="na">Height=</span><span class="s">"450"</span> <span class="na">Width=</span><span class="s">"800"</span> <span class="na">ResizeMode=</span><span class="s">"CanResizeWithGrip"</span>
        <span class="na">Loaded=</span><span class="s">"Window_Loaded"</span> <span class="na">Closing=</span><span class="s">"Window_Closing"</span><span class="nt">&gt;</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// ウィンドウ起動時</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Window_Loaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// ウィンドウ終了時</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Window_Closing</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">ComponentModel</span><span class="p">.</span><span class="n">CancelEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="終了時の処理" class="fragment"></span><a href="#%E7%B5%82%E4%BA%86%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>終了時の処理</h3>

<p>アプリケーション終了時に呼び出す、一覧に追加した内容をファイルに保存するメソッドを作成します。<br>
<code>using { }</code> で囲った部分が終了すれば開かれたファイルは自動的に閉じられます。<br>
StreamWriterクラスを生成する部分は、コードを見ただけでパラメータの意味が分かるよう、パラメータ名も書いています。<br>
ここは <code>Properties.Settings.Default.SaveConfigPath, false, Encoding.UTF8</code> と記述することもできます。<br>
2番目の引数<code>false</code>は追記しない、つまり毎回ファイルを作り直すという意味です。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 一覧ファイル保存</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;remarks&gt;</span>
<span class="c1">/// 前提：SaveConfigPathに実在するパスが設定されていること</span>
<span class="c1">/// &lt;/remarks&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">SaveConfigFile</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sw</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="nf">StreamWriter</span><span class="p">(</span>
        <span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">SaveConfigPath</span><span class="p">,</span> <span class="n">append</span><span class="p">:</span> <span class="k">false</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="c1">// リストボックスの内容をファイル出力</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">item</span> <span class="k">in</span> <span class="n">listBox</span><span class="p">.</span><span class="n">Items</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 一行書き込み</span>
            <span class="n">sw</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>保存するファイルパスを指定するためのダイアログを表示する処理です。<br>
ファイルが指定されたら上で作成したファイル保存の処理を呼んでいます。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// ファイル保存ダイアログを表示してファイル保存</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">ShowSaveDialogToConfigFile</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// ダイアログ生成</span>
    <span class="kt">var</span> <span class="n">dlg</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Win32</span><span class="p">.</span><span class="nf">SaveFileDialog</span><span class="p">();</span>
    <span class="c1">// ダイアログタイトル設定</span>
    <span class="n">dlg</span><span class="p">.</span><span class="n">Title</span> <span class="p">=</span> <span class="s">"設定を保存"</span><span class="p">;</span>
    <span class="c1">// 保存する一覧ファイルの既定ファイル名を設定</span>
    <span class="n">dlg</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">AppTitle</span> <span class="p">+</span> <span class="s">"_設定.dat"</span><span class="p">;</span>
    <span class="c1">// フィルタ設定</span>
    <span class="n">dlg</span><span class="p">.</span><span class="n">Filter</span> <span class="p">=</span> <span class="s">"設定ファイル|*.dat|全てのファイル|*.*"</span><span class="p">;</span>

    <span class="c1">// 保存ダイアログ表示</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dlg</span><span class="p">.</span><span class="nf">ShowDialog</span><span class="p">()</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ダイアログでOKされたらファイルパス設定</span>
        <span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">SaveConfigPath</span> <span class="p">=</span> <span class="n">dlg</span><span class="p">.</span><span class="n">FileName</span><span class="p">;</span>
        <span class="c1">// ファイル保存</span>
        <span class="nf">SaveConfigFile</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>ウィンドウ終了イベントに処理を記述します。<br>
<code>Properties.Settings.Default.AlarmEnabled = alarmOn.IsChecked == true;</code>の部分は、アラームONのIsCheckedプロパティがtrueの場合に<code>AlarmEnabled</code>にtrueを、その他（nullかfalse）の場合に<code>AlarmEnabled</code>にfalseを設定しています。<br>
Settingsの変更をファイル保存するにはSaveメソッドを呼びます。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// ウィンドウ終了時</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Window_Closing</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">ComponentModel</span><span class="p">.</span><span class="n">CancelEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">listBox</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 一覧の保存先パスチェック</span>
            <span class="k">if</span> <span class="p">(</span><span class="nf">IsExistsSaveConfigPath</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="c1">// ファイル保存</span>
                <span class="nf">SaveConfigFile</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="c1">// 一覧ファイル保存先パスが未設定か、指定した場所にファイルが無い場合</span>

                <span class="c1">// ファイル保存ダイアログを表示してファイル保存</span>
                <span class="nf">ShowSaveDialogToConfigFile</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 画面のアラームOn/OFF設定値をSettingsに反映</span>
        <span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">AlarmEnabled</span> <span class="p">=</span> <span class="n">alarmOn</span><span class="p">.</span><span class="n">IsChecked</span> <span class="p">==</span> <span class="k">true</span><span class="p">;</span>
        <span class="c1">// 設定ファイル保存</span>
        <span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">Save</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nf">ErrMsg</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="初期処理タイマー処理" class="fragment"></span><a href="#%E5%88%9D%E6%9C%9F%E5%87%A6%E7%90%86%E3%82%BF%E3%82%A4%E3%83%9E%E3%83%BC%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>初期処理、タイマー処理</h3>

<p>色々と変数を用意します。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// MainWindow.xaml の相互作用ロジック</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">MainWindow</span> <span class="p">:</span> <span class="n">Window</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 前回メッセージ表示時間</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;remarks&gt;</span>
    <span class="c1">/// 同じ時間に何度もメッセージが出ないようにするためのもの</span>
    <span class="c1">/// &lt;/remarks&gt;</span>
    <span class="kt">string</span> <span class="n">showTime</span><span class="p">;</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 時間とメッセージ一覧</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">timeAndMsgs</span><span class="p">;</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// タイマー</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">private</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">DispatcherTimer</span> <span class="n">timer</span><span class="p">;</span>
</code></pre></div>
</div>

<p>初期化用のメソッドを作成します。<br>
Dictionaryクラスはキーと値のセットを格納できます。<br>
Dictionaryの後ろの<code>&lt;&gt;</code>の意味は<code>&lt;キーの型, 値の型&gt;</code>です。<br>
今回はキーに時刻の文字列、値にメッセージの文字列を格納します。<br>
タイマーは <a href="https://qiita.com/Kosen-amai/items/88b3d987b41f46ebea4b" title="Windows GUIプログラミング入門2 デジタル時計" id="reference-7163d792634e567a970a">連載2回目</a> でも使用しましたが、タイマーイベントの登録を別パターンで書いています。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 初期化処理</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">InitProc</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// 登録時間一覧初期化</span>
    <span class="n">timeAndMsgs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

    <span class="n">showTime</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>

    <span class="c1">// タイマー初期化</span>
    <span class="n">timer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="nf">DispatcherTimer</span><span class="p">();</span>
    <span class="c1">// イベント発生間隔を200ミリ秒に設定</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">Interval</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromMilliseconds</span><span class="p">(</span><span class="m">200</span><span class="p">);</span>
    <span class="c1">// タイマーイベント設定</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">Tick</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">EventHandler</span><span class="p">(</span><span class="n">timer_Tick</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>こちらがタイマーイベントの処理です。<br>
<code>timeAndMsgs</code>というのは先ほど用意したDictionaryです。<br>
現在時刻の文字列を取得し、それがtimeAndMsgsの中にあればメッセージを表示します。<br>
200ミリ秒ごとにこのイベントが発生するようにしているので、そのままだと分が変わるまで何度もメッセージが出てしまいます。<br>
その対策でメッセージを表示したら<code>showTime</code>変数に時刻を保存し、同じ分に連続してメッセージが出ないようにしています。<br>
メッセージ表示部分の <code>timeAndMsgs[time]</code> は、Dictionary変数にキーを渡すことで対応する値を取得できます。<br>
つまり時間文字列を渡して対応するメッセージを取得しています。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// タイマーイベント</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">timer_Tick</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 現在時刻取得</span>
    <span class="kt">string</span> <span class="n">time</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"HH:mm"</span><span class="p">);</span>

    <span class="c1">// 表示済みの時間ではないか？登録されている時刻か？</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">time</span> <span class="p">!=</span> <span class="n">showTime</span> <span class="p">&amp;&amp;</span> 
        <span class="n">timeAndMsgs</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="c1">// メッセージ表示時間を保存</span>
        <span class="n">showTime</span> <span class="p">=</span> <span class="n">time</span><span class="p">;</span>
        <span class="c1">// 対応するメッセージ表示</span>
        <span class="nf">InfoMsg</span><span class="p">(</span><span class="n">timeAndMsgs</span><span class="p">[</span><span class="n">time</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>そして初期化処理をコンストラクタで呼ぶようにします。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// コンストラクタ</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">public</span> <span class="nf">MainWindow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">InitializeComponent</span><span class="p">();</span>

    <span class="c1">// 初期化処理</span>
    <span class="nf">InitProc</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="追加ボタンの処理2" class="fragment"></span><a href="#%E8%BF%BD%E5%8A%A0%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%87%A6%E7%90%862"><i class="fa fa-link"></i></a>追加ボタンの処理2</h3>

<p>追加ボタンを押したときに、同じ時刻を登録できないようにDictionaryを使って重複チェックをし、<br>
リストボックスへの追加と同時にDictionaryへも追加するようにします。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="err">：</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="c1">// 時刻もメッセージも入力されている</span>

    <span class="c1">// まだ追加されてない時刻かチェック</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">timeAndMsgs</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="nf">ErrMsg</span><span class="p">(</span><span class="s">"この時刻は追加済みです。"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="c1">// 一覧に追加</span>
        <span class="n">listBox</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span> <span class="p">+</span> <span class="s">"\t"</span> <span class="p">+</span> <span class="n">msgText</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>
        <span class="n">timeAndMsgs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">msgText</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>

        <span class="n">timeText</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
        <span class="n">msgText</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">timeText</span><span class="p">.</span><span class="nf">Focus</span><span class="p">();</span>
<span class="p">}</span>
    <span class="err">：</span>
</code></pre></div>
</div>

<h3>
<span id="起動時の処理" class="fragment"></span><a href="#%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>起動時の処理</h3>

<p>ウィンドウ起動時の処理を作成します。<br>
ファイルの読み込みは<code>StreamReader</code>を使います。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// ウィンドウ起動時</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Window_Loaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="c1">// 一覧設定あり？</span>
        <span class="k">if</span> <span class="p">(</span><span class="nf">IsExistsSaveConfigPath</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="nf">StreamReader</span><span class="p">(</span>
                <span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">SaveConfigPath</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="c1">// ファイルの終わりまで繰り返し</span>
                <span class="k">while</span> <span class="p">(</span><span class="n">sr</span><span class="p">.</span><span class="n">EndOfStream</span> <span class="p">==</span> <span class="k">false</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">// 一行読み込み</span>
                    <span class="kt">string</span> <span class="n">line</span> <span class="p">=</span> <span class="n">sr</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
                    <span class="c1">// 分解</span>
                    <span class="kt">string</span><span class="p">[]</span> <span class="n">lineAry</span> <span class="p">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">Split</span><span class="p">(</span><span class="sc">'\t'</span><span class="p">);</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">lineAry</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="m">2</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="c1">// 追加</span>
                        <span class="n">listBox</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
                        <span class="n">timeAndMsgs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">lineAry</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">lineAry</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                    <span class="p">}</span>
                <span class="p">}</span>

            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// アラームON/OFF設定値読み込み</span>
        <span class="n">alarmOn</span><span class="p">.</span><span class="n">IsChecked</span> <span class="p">=</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">AlarmEnabled</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">alarmOn</span><span class="p">.</span><span class="n">IsChecked</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// アラームONならタイマー開始</span>
            <span class="n">timer</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nf">ErrMsg</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="ラジオボタンの動作" class="fragment"></span><a href="#%E3%83%A9%E3%82%B8%E3%82%AA%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%8B%95%E4%BD%9C"><i class="fa fa-link"></i></a>◇ラジオボタンの動作</h2>

<p>ラジオボタンのCheckedイベントを作成します。<br>
2つとも<code>alarmOnOff_Checked</code>を呼ぶようにします。<br>
複数のコントロールに同じ処理を設定するのは <a href="https://qiita.com/Kosen-amai/items/f2451acb2addd221193f" title="Windows GUIプログラミング入門5 画面レイアウト(2)、画面遷移(1)">連載5回目</a> でやりました。</p>

<div class="code-frame" data-lang="Xml">
<div class="code-lang"><span class="bold">MainWindow.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span> <span class="na">Grid.Row=</span><span class="s">"1"</span> <span class="na">Grid.ColumnSpan=</span><span class="s">"3"</span> <span class="na">Background=</span><span class="s">"PaleTurquoise"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;RadioButton</span> <span class="na">x:Name=</span><span class="s">"alarmOn"</span> <span class="na">Content=</span><span class="s">"アラームON"</span> 
                 <span class="na">Checked=</span><span class="s">"alarmOnOff_Checked"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;RadioButton</span> <span class="na">x:Name=</span><span class="s">"alarmOff"</span> <span class="na">Content=</span><span class="s">"アラームOFF"</span> <span class="na">IsChecked=</span><span class="s">"True"</span> 
                 <span class="na">Checked=</span><span class="s">"alarmOnOff_Checked"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/StackPanel&gt;</span>
</code></pre></div>
</div>

<p>アラームONがチェックされたらタイマーを起動し、OFFがチェックされたらタイマーを停止します。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// アラームON/OFFチェック時</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">alarmOnOff_Checked</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">timer</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">alarmOn</span><span class="p">.</span><span class="n">IsChecked</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">timer</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">timer</span><span class="p">.</span><span class="nf">Stop</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h1>
<span id="動かしてみる" class="fragment"></span><a href="#%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>■動かしてみる</h1>

<p>アラームONのラジオボタンが選択されているときに、右の一覧に登録されている時間が来たらメッセージが表示されるようになりました。<br>
時間が来てもアラームOFFが選択されている場合はメッセージは出ません。</p>

<p><a href="https://camo.qiitausercontent.com/87fef710c5d7bd6bdc4425fa032504806b9229eb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f33373061326537632d393835612d653063372d653766372d3839343461383138393764362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F370a2e7c-985a-e0c7-e7f7-8944a81897d6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=68cc4b75876ce467851a60d543c29d50" alt="wbg16-09.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/142879/370a2e7c-985a-e0c7-e7f7-8944a81897d6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F370a2e7c-985a-e0c7-e7f7-8944a81897d6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bc9039b72136f6b2add4a778613c20ec 1x" loading="lazy"></a></p>

<p>アプリケーションを閉じると、ファイル保存ダイアログが表示され、一覧ファイルの保存先を聞かれます。<br>
次回起動時はそのファイルを読み込み、一覧を画面に復元します。</p>

<h1>
<span id="おまけソース整理" class="fragment"></span><a href="#%E3%81%8A%E3%81%BE%E3%81%91%E3%82%BD%E3%83%BC%E3%82%B9%E6%95%B4%E7%90%86"><i class="fa fa-link"></i></a>■おまけ（ソース整理）</h1>

<p>追加ボタンを押したときの処理が、if文が入り組んでいて分かりづらいので少し整理します。<br>
エラーチェックしてエラーになったらreturnですぐ処理を抜けるようにし、if文のネストが深くならないようにしました。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 追加ボタンクリック時の処理</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Button_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DateTime</span> <span class="n">d</span><span class="p">;</span>

    <span class="c1">// 時刻の形式が正しいか？</span>
    <span class="c1">//（数字2桁:数字2桁か簡易チェックしてOKならDateTime型に変換できるかチェックする）</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">RegularExpressions</span><span class="p">.</span><span class="n">Regex</span><span class="p">.</span><span class="nf">IsMatch</span><span class="p">(</span>
        <span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="s">"^[0-9]{2}:[0-9]{2}$"</span><span class="p">)</span> <span class="p">==</span> <span class="k">false</span> <span class="p">||</span>
        <span class="n">DateTime</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="s">"2000/01/01 "</span> <span class="p">+</span> <span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="k">out</span> <span class="n">d</span><span class="p">)</span> <span class="p">==</span> <span class="k">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 時刻として正しくない</span>
        <span class="nf">ErrMsg</span><span class="p">(</span><span class="s">"時刻を正しく入力してください。例）12:34"</span><span class="p">);</span>
        <span class="n">timeText</span><span class="p">.</span><span class="nf">Focus</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// メッセージが入力されているか？</span>
    <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">msgText</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="c1">// メッセージ未入力（または空白しか入力されていない）</span>
        <span class="nf">ErrMsg</span><span class="p">(</span><span class="s">"メッセージを入力してください。"</span><span class="p">);</span>
        <span class="n">msgText</span><span class="p">.</span><span class="nf">Focus</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 時刻もメッセージも入力されている</span>

    <span class="c1">// まだ追加されていない時刻かチェック</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">timeAndMsgs</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="nf">ErrMsg</span><span class="p">(</span><span class="s">"この時刻は追加済みです。"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="c1">// 一覧に追加</span>
        <span class="n">listBox</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span> <span class="p">+</span> <span class="s">"\t"</span> <span class="p">+</span> <span class="n">msgText</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>
        <span class="n">timeAndMsgs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">timeText</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">msgText</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>

        <span class="n">timeText</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
        <span class="n">msgText</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">timeText</span><span class="p">.</span><span class="nf">Focus</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>ラジオボタン選択時の処理を修正します。<br>
timer変数が初期化される前にイベントが動いてしまうとStartやStopメソッドを呼ぶときにエラーになってしまうため、nullチェックをしていました。<br>
これを<strong>Null条件演算子</strong>「?.」を使うやり方に変えます。<br>
nullチェックしていたif文を削除し、<code>timer.Start()</code> を <code>timer?.Start()</code> に変えます。Stopも同様です。<br>
<code>?.</code>の左側のオブジェクトがnullの場合は右側は参照されず、nullを返します。今回の例で言えばStartやStopメソッドは実行されません。<br>
<code>?.</code>の左側がnull以外の時は右側が実行されます。<br>
Null条件演算子は連続して使うこともできます。<br>
<code>A?.B?.C()</code>は、オブジェクトAとBがnullではないときに、メソッドCが実行されます。</p>

<div class="code-frame" data-lang="CSharp">
<div class="code-lang"><span class="bold">MainWindow.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// アラームON/OFFチェック時</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">alarmOnOff_Checked</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">alarmOn</span><span class="p">.</span><span class="n">IsChecked</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">timer</span><span class="p">?.</span><span class="nf">Start</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">timer</span><span class="p">?.</span><span class="nf">Stop</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>おしまい</p>

<hr>

<p><a href="http://qiita.com/Kosen-amai/items/f9e3df2aa80363f5af5b" title="Windows GUIプログラミング入門1 メッセージボックス表示" id="reference-1c266a6e60d6f72dd082">＜＜ 最初の記事</a> 　 <a href="https://qiita.com/Kosen-amai/items/44392fdf3bd8b56cfacb" title="Windows GUIプログラミング入門15 インストーラー(1)" id="reference-1d75155e564e0df19cb9">＜ 前の記事</a> 　 <a href="https://qiita.com/Kosen-amai/items/c2542fe0d0b62d108096" title="Windows GUIプログラミング入門17 変換ツール" id="reference-9161ac9fa3d60e28f307">次の記事 ＞</a></p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FKosen-amai%2Fitems%2F02208712c8cac15ef995&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FKosen-amai%2Fitems%2F02208712c8cac15ef995&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Kosen-amai/items/02208712c8cac15ef995/likers" class="css-1iupg5d">8</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">6</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/02208712c8cac15ef995/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Kosen-amai/items/02208712c8cac15ef995/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Kosen-amai/items/02208712c8cac15ef995/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Kosen-amai/items/02208712c8cac15ef995/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Kosen-amai/items/02208712c8cac15ef995.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-e430c3d4-74df-4d60-9d49-f618ff82a2fb">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-47232dd3-bd22-4c67-afa8-38ddea7c5301"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-47232dd3-bd22-4c67-afa8-38ddea7c5301">{}</script>
      
<div id="LoginModal-react-component-dc56af87-c6ef-4250-b723-54d447025529"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-dc56af87-c6ef-4250-b723-54d447025529">{}</script>
      
<div id="StockModal-react-component-ae8578bd-fe2a-42af-82dd-64fbcda7bdbc"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-ae8578bd-fe2a-42af-82dd-64fbcda7bdbc">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;ZtnzsJ71j/MNlfezhm2CnTxgA6XHoDysHZc421tz/bB+DdHjTh1xGk1x8m/Zm/lo8N/6m2nRyg8BYxdh48oewg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e■はじめに\u003c/h1\u003e\n\n\u003cp\u003e今回はアラームを作りながら正規表現やファイル読み書きなどを学びます。\u003cbr\u003e\n入力チェックなどもして今までよりも少しまともなアプリケーションを作ります。\u003c/p\u003e\n\n\u003cp\u003eキーワード：正規表現, ファイル入出力, ファイル保存ダイアログ, タイマー,  Dictionary, スタイル, Null条件演算子\u003c/p\u003e\n\n\u003cp\u003e[注意]\u003cbr\u003e\nこれまでの回で説明済みの操作方法等は、説明を省略したり簡略化している場合があります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"開発環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e■開発環境\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows 10\u003c/li\u003e\n\u003cli\u003eVisual Studio Community 2017\u003c/li\u003e\n\u003cli\u003e.NET Framework 4.x\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"作ってみる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e■作ってみる\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"画面作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%94%BB%E9%9D%A2%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇画面作成\u003c/h2\u003e\n\n\u003cp\u003e新しいプロジェクトで \u003ccode\u003eVisual C#\u003c/code\u003e - \u003ccode\u003eWindows デスクトップ\u003c/code\u003e - \u003ccode\u003eWPF アプリ\u003c/code\u003eで任意の名前でプロジェクトを作成します。ここでは PoorAlarm と入力しました。\u003cbr\u003e\nそして以下のように画面を作成します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e56889c03c19c9cf065c30b494eff8c69c353d22/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f38306438613233662d356531642d613934392d336335382d3439346234393938353066662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F80d8a23f-5e1d-a949-3c58-494b499850ff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4851deb6fda3cdb4fac914d70c2b4410\" alt=\"wbg16-01.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/80d8a23f-5e1d-a949-3c58-494b499850ff.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F80d8a23f-5e1d-a949-3c58-494b499850ff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=384abdaea4fbb584fbe37da1d7510e0c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eGridを横3×縦2に分割し、上段にLabel, TextBox, Button, ListBoxを、下段にRadioButtonを配置します。Gridの分割は \u003ca href=\"https://qiita.com/Kosen-amai/items/af0c4962763f1b587387\" title=\"Windows GUIプログラミング入門4 画面レイアウト(1)\" id=\"reference-e41929c6c282caa4c3ce\"\u003e連載4回目\u003c/a\u003e や \u003ca href=\"https://qiita.com/Kosen-amai/items/f2451acb2addd221193f\" title=\"Windows GUIプログラミング入門5 画面レイアウト(2)、画面遷移(1)\" id=\"reference-87de7f0a18c5cc2fe203\"\u003e連載5回目\u003c/a\u003e でやりましたね。\u003cbr\u003e\nGridの\u003ccode\u003eFocusManager.FocusedElement\u003c/code\u003eは初期フォーカスを時刻のテキストボックスに設定しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"Xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml（Grid部分）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Grid\u003c/span\u003e \u003cspan class=\"na\"\u003eFocusManager.FocusedElement=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding ElementName=timeText}\"\u003c/span\u003e \u003cspan class=\"na\"\u003eBackground=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"LightCyan\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;Grid.RowDefinitions\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;RowDefinition/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;RowDefinition\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Auto\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/Grid.RowDefinitions\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"nt\"\u003e\u0026lt;Grid.ColumnDefinitions\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;ColumnDefinition\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Auto\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;ColumnDefinition\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Auto\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;ColumnDefinition\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/Grid.ColumnDefinitions\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"nt\"\u003e\u0026lt;StackPanel\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;Label\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"時刻\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;TextBox\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"60\"\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"timeText\"\u003c/span\u003e \u003cspan class=\"na\"\u003eMaxLength=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\n        \u003cspan class=\"nt\"\u003e\u0026lt;Label\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"メッセージ\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;TextBox\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"60\"\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"200\"\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"msgText\"\u003c/span\u003e \u003cspan class=\"na\"\u003eTextWrapping=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Wrap\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVerticalScrollBarVisibility=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Auto\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/StackPanel\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.Column=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"追加 \u0026gt;\"\u003c/span\u003e \u003cspan class=\"na\"\u003eIsDefault=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"True\"\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"30\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVerticalAlignment=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Top\"\u003c/span\u003e \u003cspan class=\"na\"\u003eMargin=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5,50\"\u003c/span\u003e \u003cspan class=\"na\"\u003ePadding=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"nt\"\u003e\u0026lt;ListBox\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.Column=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"2\"\u003c/span\u003e \u003cspan class=\"na\"\u003eMargin=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"10\"\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"listBox\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"nt\"\u003e\u0026lt;StackPanel\u003c/span\u003e \u003cspan class=\"na\"\u003eOrientation=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Horizontal\"\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.Row=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.ColumnSpan=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"3\"\u003c/span\u003e \u003cspan class=\"na\"\u003eBackground=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PaleTurquoise\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;RadioButton\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"alarmOn\"\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アラームON\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;RadioButton\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"alarmOff\"\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アラームOFF\"\u003c/span\u003e \u003cspan class=\"na\"\u003eIsChecked=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"True\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/StackPanel\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/Grid\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eWindowのResizeModeプロパティを変更してサイズ変更グリップを表示するようにしています。\u003cbr\u003e\nWindow.Resourcesの中はLabel, TextBox, RadioButtonの既定のスタイルを設定しています。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/Kosen-amai/items/792c59392e72e65316bd\" title=\"Windows GUIプログラミング入門10 設定保存(1)\" id=\"reference-a1f5f93c0c818cdd5d26\"\u003e連載10回目\u003c/a\u003e ではスタイルに任意の名前を付けて、各コントロールのStyleプロパティでその名前を指定して適用していました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"Xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml（先頭部分）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Window\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Class=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PoorAlarm.MainWindow\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:x=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:d=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/expression/blend/2008\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:mc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:local=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:PoorAlarm\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003emc:Ignorable=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eTitle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MainWindow\"\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"450\"\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"800\"\u003c/span\u003e \u003cspan class=\"na\"\u003eResizeMode=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CanResizeWithGrip\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;Window.Resources\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;Style\u003c/span\u003e \u003cspan class=\"na\"\u003eTargetType=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Label\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;Setter\u003c/span\u003e \u003cspan class=\"na\"\u003eProperty=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Margin\"\u003c/span\u003e \u003cspan class=\"na\"\u003eValue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5,10,5,2\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;Setter\u003c/span\u003e \u003cspan class=\"na\"\u003eProperty=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Padding\"\u003c/span\u003e \u003cspan class=\"na\"\u003eValue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/Style\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;Style\u003c/span\u003e \u003cspan class=\"na\"\u003eTargetType=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TextBox\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;Setter\u003c/span\u003e \u003cspan class=\"na\"\u003eProperty=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"HorizontalAlignment\"\u003c/span\u003e \u003cspan class=\"na\"\u003eValue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Left\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;Setter\u003c/span\u003e \u003cspan class=\"na\"\u003eProperty=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Margin\"\u003c/span\u003e \u003cspan class=\"na\"\u003eValue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5,0\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/Style\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;Style\u003c/span\u003e \u003cspan class=\"na\"\u003eTargetType=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"RadioButton\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;Setter\u003c/span\u003e \u003cspan class=\"na\"\u003eProperty=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Margin\"\u003c/span\u003e \u003cspan class=\"na\"\u003eValue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/Style\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/Window.Resources\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"nt\"\u003e\u0026lt;Grid\u003c/span\u003e \u003cspan class=\"na\"\u003eFocusManager.FocusedElement=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding ElementName=timeText}\"\u003c/span\u003e \u003cspan class=\"na\"\u003eBackground=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"LightCyan\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    ：\n    ：\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eいったん実行してみます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1e42c7d47100c857e60074468e7c37c5385d4445/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f33643136633939352d373937392d613938312d333363632d6631616132643062343837352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F3d16c995-7979-a981-33cc-f1aa2d0b4875.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1c11c22955e4c192c3a4de516e9be5d8\" alt=\"wbg16-02.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/3d16c995-7979-a981-33cc-f1aa2d0b4875.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F3d16c995-7979-a981-33cc-f1aa2d0b4875.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3b40b41845a26ad5929fe17cfdb4be3a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこんな感じ。\u003cbr\u003e\n時刻とメッセージを入力して追加ボタンを押すと右側の一覧に登録され、\u003cbr\u003e\n指定した時刻が来たら（アラームがONになっている場合）メッセージが表示される。\u003cbr\u003e\nというものにします。\u003cbr\u003e\n追加した時刻とメッセージの一覧は終了時にテキストファイルに保存し、次回起動時に読み込むようにします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"設定項目作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A8%AD%E5%AE%9A%E9%A0%85%E7%9B%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇設定項目作成\u003c/h2\u003e\n\n\u003cp\u003eアラームON/OFFラジオボタン選択値と、時刻・メッセージ一覧ファイルのパスを記録しておく設定項目を用意します。\u003cbr\u003e\nこれは \u003ca href=\"https://qiita.com/Kosen-amai/items/792c59392e72e65316bd\" title=\"Windows GUIプログラミング入門10 設定保存(1)\"\u003e連載10回目\u003c/a\u003e でやりました。\u003cbr\u003e\nソリューションエクスプローラーで\u003ccode\u003eSettings.settings\u003c/code\u003eをダブルクリックし、\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/30fa7b4499f911b3700c7d89307c7a066b77795f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f32323739303436612d393635302d656239362d663833382d6632383032613236643334342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F2279046a-9650-eb96-f838-f2802a26d344.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b40a54b06c58f81d060bf2fe8f86e66a\" alt=\"wbg16-03.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/2279046a-9650-eb96-f838-f2802a26d344.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F2279046a-9650-eb96-f838-f2802a26d344.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1ed7a37aa0e71793377dcab29c9554ab 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eAlarmEnabled\u003c/code\u003eというbool型の設定項目と、\u003ccode\u003eSaveConfigPath\u003c/code\u003eというstring型の設定項目を用意します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/53498b07bc969e4ef20781e1b13ac2daedd21dd1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f39313632376262392d376562352d656461392d316235382d3334356233316239626264652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F91627bb9-7eb5-eda9-1b58-345b31b9bbde.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e45ee01d53fcb627b4a3187ab8876009\" alt=\"wbg16-04.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/91627bb9-7eb5-eda9-1b58-345b31b9bbde.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F91627bb9-7eb5-eda9-1b58-345b31b9bbde.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9e12120d26411d7600213340a3e7ff45 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"設定ファイル存在確認メソッド作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%AD%98%E5%9C%A8%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇設定ファイル存在確認メソッド作成\u003c/h2\u003e\n\n\u003cp\u003e設定の\u003ccode\u003eSaveConfigPath\u003c/code\u003eに値が設定されているか、設定されている場合はそのファイルが存在するか確認するメソッドを作成します。\u003cbr\u003e\nこのメソッドは後で使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 一覧設定ファイルパス存在チェック\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;設定が有効ならtrue\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eIsExistsSaveConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrWhiteSpace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSaveConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSaveConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// パスの設定が無い、または指定した場所にファイルが存在しない\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// パスが設定されていてファイルが実在する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"文字列リソース作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%87%E5%AD%97%E5%88%97%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇文字列リソース作成\u003c/h2\u003e\n\n\u003cp\u003eアプリのタイトルを文字列リソースとして登録します。\u003cbr\u003e\nソリューションエクスプローラーで\u003ccode\u003eResources.resx\u003c/code\u003eをダブルクリックし、\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c7bf037f224e5c2126dc19ca22f0f1bc34411bd0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f36376264323163652d326234382d306336632d326162332d3965303961623462353435612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F67bd21ce-2b48-0c6c-2ab3-9e09ab4b545a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=628679c1b8c2aaf864851faeb0e005ad\" alt=\"wbg16-05.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/67bd21ce-2b48-0c6c-2ab3-9e09ab4b545a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F67bd21ce-2b48-0c6c-2ab3-9e09ab4b545a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f9b1bf8ddb5bd73d0f4b04438e783df5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「アクセス修飾子」を\u003ccode\u003ePublic\u003c/code\u003eにし、\u003cbr\u003e\n「名前」に\u003ccode\u003eAppTitle\u003c/code\u003e、\u003cbr\u003e\n「値」にこのアプリの名前、\u003cbr\u003e\n「コメント」にこの文字列リソースをどこで使うのか等の説明を入力します。コメントは後で見た時に分かりやすくするためのものなので空欄でも構いません。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b7d224006ec1950a3b6e1c9d9701b6f390c5d0f5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f39356131656337392d353930392d633536332d303832652d6463306438616332363333662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F95a1ec79-5909-c563-082e-dc0d8ac2633f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2e5d5e91aebffd3f56e0bc5deef13fb2\" alt=\"wbg16-06.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/95a1ec79-5909-c563-082e-dc0d8ac2633f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F95a1ec79-5909-c563-082e-dc0d8ac2633f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a3e25f8e5ad15f36ae1ca1818a0b50cf 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e文字列リソースは英語版や日本語版など、多言語対応時に活きてくるものです。\u003cbr\u003e\n本来は画面のラベルやメッセージボックスのメッセージ内容なども文字列リソースとして登録しますが、今回は使い方の紹介なのでタイトルだけ登録します。\u003c/p\u003e\n\n\u003cp\u003eここまでで一度ビルドしておきましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"文字列リソースの利用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%87%E5%AD%97%E5%88%97%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E5%88%A9%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇文字列リソースの利用\u003c/h2\u003e\n\n\u003cp\u003eXamlに\u003ccode\u003exmlns:prop=\"clr-namespace:PoorAlarm.Properties\"\u003c/code\u003eを追加します。\u003cbr\u003e\nこれでPropertiesが\u003ccode\u003eprop\u003c/code\u003eという識別子でアクセス可能になったので、\u003cbr\u003e\n\u003ccode\u003eTitle\u003c/code\u003eプロパティの値を \u003ccode\u003e{x:Static prop:Resources.AppTitle}\u003c/code\u003e に書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"Xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml（先頭部分）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Window\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Class=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PoorAlarm.MainWindow\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:x=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:d=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/expression/blend/2008\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:mc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:local=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:PoorAlarm\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:prop=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:PoorAlarm.Properties\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003emc:Ignorable=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eTitle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{x:Static prop:Resources.AppTitle}\"\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"450\"\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"800\"\u003c/span\u003e \u003cspan class=\"na\"\u003eResizeMode=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CanResizeWithGrip\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"メッセージボックス表示メソッド作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E8%A1%A8%E7%A4%BA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇メッセージボックス表示メソッド作成\u003c/h2\u003e\n\n\u003cp\u003eメッセージボックスを表示するためのメソッドを作成します。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/Kosen-amai/items/f9e3df2aa80363f5af5b\" title=\"Windows GUIプログラミング入門1 メッセージボックス表示\" id=\"reference-1c266a6e60d6f72dd082\"\u003e連載1回目\u003c/a\u003e のメッセージボックスと違い、メッセージボックスタイトルとアイコンも指定しています。\u003cbr\u003e\nここでもタイトル部分にリソース文字列を使用しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 情報メッセージ表示\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"msg\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInfoMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n        \u003cspan class=\"n\"\u003eMessageBoxButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eMessageBoxImage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// エラーメッセージ表示\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"msg\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMessageBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n        \u003cspan class=\"n\"\u003eMessageBoxButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eMessageBoxImage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"追加ボタンの処理1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E5%8A%A0%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%87%A6%E7%90%861\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇追加ボタンの処理1\u003c/h2\u003e\n\n\u003cp\u003e追加ボタンのイベントハンドラを記述します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"Xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml（追加ボタン定義）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.Column=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"追加 \u0026gt;\"\u003c/span\u003e \u003cspan class=\"na\"\u003eIsDefault=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"True\"\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"30\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVerticalAlignment=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Top\"\u003c/span\u003e \u003cspan class=\"na\"\u003eMargin=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5,50\"\u003c/span\u003e \u003cspan class=\"na\"\u003ePadding=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5\"\u003c/span\u003e \u003cspan class=\"na\"\u003eClick=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Button_Click\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 追加ボタンクリック時の処理\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eButton_Click\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRoutedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 時刻チェック\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//（数字2桁:数字2桁か簡易チェックしてOKならDateTime型に変換できるかチェックする）\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegularExpressions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^[0-9]{2}:[0-9]{2}$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTryParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"2000/01/01 \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 時刻として正しい\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// メッセージが入力されているか？\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrWhiteSpace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// メッセージ未入力（または空白しか入力されていない）\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"メッセージを入力してください。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 時刻もメッセージも入力されている\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 一覧に追加\u003c/span\u003e\n            \u003cspan class=\"n\"\u003elistBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\t\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 時刻として正しくない\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"時刻を正しく入力してください。例）12:34\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"時刻チェック1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%99%82%E5%88%BB%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e時刻チェック1\u003c/h3\u003e\n\n\u003cp\u003eまず、正規表現というものを使って入力された時刻が「数字2桁」 + 「:」 + 「数字2桁」になっているかチェックしています。\u003cbr\u003e\n条件に合致していればRegexクラスのIsMatchメソッドはtrueを返します。\u003cbr\u003e\n\u003ccode\u003e\"^[0-9]{2}:[0-9]{2}$\"\u003c/code\u003e の\u003ccode\u003e^\u003c/code\u003eは行頭、\u003ccode\u003e[0-9]\u003c/code\u003eは0～9のいずれか、\u003ccode\u003e{2}\u003c/code\u003eは直前（左）の文字を2回繰り返す、\u003ccode\u003e$\u003c/code\u003eは行末を意味します。\u003cbr\u003e\n\u003ccode\u003e\"^あいう\"\u003c/code\u003eという正規表現は、「あいう」から始まる\u003ccode\u003e\"あいうえお\"\u003c/code\u003eにはヒットしますが\u003ccode\u003e\"ああいうえお\"\u003c/code\u003eにはヒットしません。\u003cbr\u003e\n\u003ccode\u003e\"^いよ$\"\u003c/code\u003eという正規表現は\u003ccode\u003e\"いよ\"\u003c/code\u003eにはヒットしますが、\u003ccode\u003e\"いいよ\"\u003c/code\u003e、\u003ccode\u003e\"いよかん\"\u003c/code\u003e、\u003ccode\u003e\"たいよう\"\u003c/code\u003eにはヒットしません。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"時刻チェック2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%99%82%E5%88%BB%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e時刻チェック2\u003c/h3\u003e\n\n\u003cp\u003eしかしこのままでは\u003ccode\u003e25:99\u003c/code\u003eなんてものもチェックを通ってしまいます。\u003cbr\u003e\nそこで次にDateTimeクラスのTryParseメソッドを使って日付型に変換できるか確認しています。\u003cbr\u003e\n日付型への変換が成功すれば戻り値にtrueが返り、2番目の引数に変換後の日付オブジェクトが設定されます。が、今回は日付に変換できるか知りたいだけなので\u003ccode\u003ed\u003c/code\u003e変数はこの先使いません。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"時刻とメッセージの一覧への追加\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%99%82%E5%88%BB%E3%81%A8%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AE%E4%B8%80%E8%A6%A7%E3%81%B8%E3%81%AE%E8%BF%BD%E5%8A%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e時刻とメッセージの一覧への追加\u003c/h3\u003e\n\n\u003cp\u003eメッセージが入力されていることを確認したらリストボックスに時間とメッセージをタブ区切りで追加します。\u003ccode\u003e\\t\u003c/code\u003eはタブ文字です。\u003cbr\u003e\n途中のチェックでエラーがあればエラーメッセージを表示します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"動作確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇動作確認\u003c/h2\u003e\n\n\u003cp\u003eここまでで一度実行してみましょう。\u003c/p\u003e\n\n\u003cp\u003e正しくない時刻を入力して追加ボタンを押してみると、エラーメッセージが表示されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/25423a8692986e2055c001ff8864a94a71a9b7d8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f38323034393862312d623763652d383133642d326364392d6464653232306464346266632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F820498b1-b7ce-813d-2cd9-dde220dd4bfc.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d5c28aa69bab22280cb20cbd2aac8579\" alt=\"wbg16-07.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/820498b1-b7ce-813d-2cd9-dde220dd4bfc.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F820498b1-b7ce-813d-2cd9-dde220dd4bfc.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=45ed666ccae61d59ce85e3c885230021 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e正しい時刻とメッセージを入力して追加ボタンを押すと右の一覧に追加されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/2c43c47f3a1a415838b98517ba6ea569d9fe6d28/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f34663665333766372d656138332d333837342d323939612d3563366530663730333634632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F4f6e37f7-ea83-3874-299a-5c6e0f70364c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f6ee5bfc03c904003769c8143e350e70\" alt=\"wbg16-08.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/4f6e37f7-ea83-3874-299a-5c6e0f70364c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F4f6e37f7-ea83-3874-299a-5c6e0f70364c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cd17169b25ce229079983fc17d50ac23 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ウィンドウ起動時と終了時の処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%A8%E7%B5%82%E4%BA%86%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇ウィンドウ起動時と終了時の処理\u003c/h2\u003e\n\n\u003cp\u003eウィンドウ起動時と終了時のイベントハンドラを用意します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"Xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Window\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Class=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PoorAlarm.MainWindow\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:x=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/winfx/2006/xaml\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:d=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/expression/blend/2008\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:mc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:local=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:PoorAlarm\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003exmlns:prop=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clr-namespace:PoorAlarm.Properties\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003emc:Ignorable=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eTitle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{x:Static prop:Resources.AppTitle}\"\u003c/span\u003e \u003cspan class=\"na\"\u003eHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"450\"\u003c/span\u003e \u003cspan class=\"na\"\u003eWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"800\"\u003c/span\u003e \u003cspan class=\"na\"\u003eResizeMode=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CanResizeWithGrip\"\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eLoaded=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Window_Loaded\"\u003c/span\u003e \u003cspan class=\"na\"\u003eClosing=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Window_Closing\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// ウィンドウ起動時\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWindow_Loaded\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRoutedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// ウィンドウ終了時\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWindow_Closing\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eComponentModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancelEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"終了時の処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%82%E4%BA%86%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e終了時の処理\u003c/h3\u003e\n\n\u003cp\u003eアプリケーション終了時に呼び出す、一覧に追加した内容をファイルに保存するメソッドを作成します。\u003cbr\u003e\n\u003ccode\u003eusing { }\u003c/code\u003e で囲った部分が終了すれば開かれたファイルは自動的に閉じられます。\u003cbr\u003e\nStreamWriterクラスを生成する部分は、コードを見ただけでパラメータの意味が分かるよう、パラメータ名も書いています。\u003cbr\u003e\nここは \u003ccode\u003eProperties.Settings.Default.SaveConfigPath, false, Encoding.UTF8\u003c/code\u003e と記述することもできます。\u003cbr\u003e\n2番目の引数\u003ccode\u003efalse\u003c/code\u003eは追記しない、つまり毎回ファイルを作り直すという意味です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 一覧ファイル保存\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;remarks\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 前提：SaveConfigPathに実在するパスが設定されていること\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/remarks\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSaveConfigFile\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esw\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStreamWriter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSaveConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eencoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// リストボックスの内容をファイル出力\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003elistBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 一行書き込み\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e保存するファイルパスを指定するためのダイアログを表示する処理です。\u003cbr\u003e\nファイルが指定されたら上で作成したファイル保存の処理を呼んでいます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// ファイル保存ダイアログを表示してファイル保存\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eShowSaveDialogToConfigFile\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// ダイアログ生成\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edlg\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWin32\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSaveFileDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// ダイアログタイトル設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edlg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTitle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"設定を保存\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 保存する一覧ファイルの既定ファイル名を設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edlg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppTitle\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"_設定.dat\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// フィルタ設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edlg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"設定ファイル|*.dat|全てのファイル|*.*\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 保存ダイアログ表示\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edlg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShowDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ダイアログでOKされたらファイルパス設定\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSaveConfigPath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edlg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ファイル保存\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eSaveConfigFile\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eウィンドウ終了イベントに処理を記述します。\u003cbr\u003e\n\u003ccode\u003eProperties.Settings.Default.AlarmEnabled = alarmOn.IsChecked == true;\u003c/code\u003eの部分は、アラームONのIsCheckedプロパティがtrueの場合に\u003ccode\u003eAlarmEnabled\u003c/code\u003eにtrueを、その他（nullかfalse）の場合に\u003ccode\u003eAlarmEnabled\u003c/code\u003eにfalseを設定しています。\u003cbr\u003e\nSettingsの変更をファイル保存するにはSaveメソッドを呼びます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// ウィンドウ終了時\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWindow_Closing\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eComponentModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCancelEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elistBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 一覧の保存先パスチェック\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsExistsSaveConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// ファイル保存\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eSaveConfigFile\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 一覧ファイル保存先パスが未設定か、指定した場所にファイルが無い場合\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// ファイル保存ダイアログを表示してファイル保存\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eShowSaveDialogToConfigFile\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 画面のアラームOn/OFF設定値をSettingsに反映\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAlarmEnabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ealarmOn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsChecked\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 設定ファイル保存\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"初期処理タイマー処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%9D%E6%9C%9F%E5%87%A6%E7%90%86%E3%82%BF%E3%82%A4%E3%83%9E%E3%83%BC%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e初期処理、タイマー処理\u003c/h3\u003e\n\n\u003cp\u003e色々と変数を用意します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// MainWindow.xaml の相互作用ロジック\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMainWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eWindow\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 前回メッセージ表示時間\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;remarks\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 同じ時間に何度もメッセージが出ないようにするためのもの\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/remarks\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eshowTime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 時間とメッセージ一覧\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// タイマー\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDispatcherTimer\u003c/span\u003e \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e初期化用のメソッドを作成します。\u003cbr\u003e\nDictionaryクラスはキーと値のセットを格納できます。\u003cbr\u003e\nDictionaryの後ろの\u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003eの意味は\u003ccode\u003e\u0026lt;キーの型, 値の型\u0026gt;\u003c/code\u003eです。\u003cbr\u003e\n今回はキーに時刻の文字列、値にメッセージの文字列を格納します。\u003cbr\u003e\nタイマーは \u003ca href=\"https://qiita.com/Kosen-amai/items/88b3d987b41f46ebea4b\" title=\"Windows GUIプログラミング入門2 デジタル時計\" id=\"reference-7163d792634e567a970a\"\u003e連載2回目\u003c/a\u003e でも使用しましたが、タイマーイベントの登録を別パターンで書いています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 初期化処理\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitProc\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 登録時間一覧初期化\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eshowTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// タイマー初期化\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etimer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThreading\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDispatcherTimer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// イベント発生間隔を200ミリ秒に設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInterval\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromMilliseconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// タイマーイベント設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTick\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eEventHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimer_Tick\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこちらがタイマーイベントの処理です。\u003cbr\u003e\n\u003ccode\u003etimeAndMsgs\u003c/code\u003eというのは先ほど用意したDictionaryです。\u003cbr\u003e\n現在時刻の文字列を取得し、それがtimeAndMsgsの中にあればメッセージを表示します。\u003cbr\u003e\n200ミリ秒ごとにこのイベントが発生するようにしているので、そのままだと分が変わるまで何度もメッセージが出てしまいます。\u003cbr\u003e\nその対策でメッセージを表示したら\u003ccode\u003eshowTime\u003c/code\u003e変数に時刻を保存し、同じ分に連続してメッセージが出ないようにしています。\u003cbr\u003e\nメッセージ表示部分の \u003ccode\u003etimeAndMsgs[time]\u003c/code\u003e は、Dictionary変数にキーを渡すことで対応する値を取得できます。\u003cbr\u003e\nつまり時間文字列を渡して対応するメッセージを取得しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// タイマーイベント\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003etimer_Tick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 現在時刻取得\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"HH:mm\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 表示済みの時間ではないか？登録されている時刻か？\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eshowTime\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \n        \u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// メッセージ表示時間を保存\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eshowTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 対応するメッセージ表示\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eInfoMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eそして初期化処理をコンストラクタで呼ぶようにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// コンストラクタ\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 初期化処理\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eInitProc\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"追加ボタンの処理2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E5%8A%A0%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%87%A6%E7%90%862\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e追加ボタンの処理2\u003c/h3\u003e\n\n\u003cp\u003e追加ボタンを押したときに、同じ時刻を登録できないようにDictionaryを使って重複チェックをし、\u003cbr\u003e\nリストボックスへの追加と同時にDictionaryへも追加するようにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"err\"\u003e：\u003c/span\u003e\n\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 時刻もメッセージも入力されている\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// まだ追加されてない時刻かチェック\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"この時刻は追加済みです。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 一覧に追加\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elistBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\t\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e：\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"起動時の処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e起動時の処理\u003c/h3\u003e\n\n\u003cp\u003eウィンドウ起動時の処理を作成します。\u003cbr\u003e\nファイルの読み込みは\u003ccode\u003eStreamReader\u003c/code\u003eを使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// ウィンドウ起動時\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWindow_Loaded\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRoutedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 一覧設定あり？\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsExistsSaveConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStreamReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSaveConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// ファイルの終わりまで繰り返し\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEndOfStream\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 一行読み込み\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadLine\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// 分解\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003elineAry\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sc\"\u003e'\\t'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elineAry\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"c1\"\u003e// 追加\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003elistBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elineAry\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003elineAry\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// アラームON/OFF設定値読み込み\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ealarmOn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsChecked\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAlarmEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ealarmOn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsChecked\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// アラームONならタイマー開始\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ラジオボタンの動作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A9%E3%82%B8%E3%82%AA%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%8B%95%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e◇ラジオボタンの動作\u003c/h2\u003e\n\n\u003cp\u003eラジオボタンのCheckedイベントを作成します。\u003cbr\u003e\n2つとも\u003ccode\u003ealarmOnOff_Checked\u003c/code\u003eを呼ぶようにします。\u003cbr\u003e\n複数のコントロールに同じ処理を設定するのは \u003ca href=\"https://qiita.com/Kosen-amai/items/f2451acb2addd221193f\" title=\"Windows GUIプログラミング入門5 画面レイアウト(2)、画面遷移(1)\"\u003e連載5回目\u003c/a\u003e でやりました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"Xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;StackPanel\u003c/span\u003e \u003cspan class=\"na\"\u003eOrientation=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Horizontal\"\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.Row=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1\"\u003c/span\u003e \u003cspan class=\"na\"\u003eGrid.ColumnSpan=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"3\"\u003c/span\u003e \u003cspan class=\"na\"\u003eBackground=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PaleTurquoise\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;RadioButton\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"alarmOn\"\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アラームON\"\u003c/span\u003e \n                 \u003cspan class=\"na\"\u003eChecked=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"alarmOnOff_Checked\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;RadioButton\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"alarmOff\"\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"アラームOFF\"\u003c/span\u003e \u003cspan class=\"na\"\u003eIsChecked=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"True\"\u003c/span\u003e \n                 \u003cspan class=\"na\"\u003eChecked=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"alarmOnOff_Checked\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/StackPanel\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eアラームONがチェックされたらタイマーを起動し、OFFがチェックされたらタイマーを停止します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// アラームON/OFFチェック時\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003ealarmOnOff_Checked\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRoutedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimer\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ealarmOn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsChecked\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStop\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"動かしてみる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e■動かしてみる\u003c/h1\u003e\n\n\u003cp\u003eアラームONのラジオボタンが選択されているときに、右の一覧に登録されている時間が来たらメッセージが表示されるようになりました。\u003cbr\u003e\n時間が来てもアラームOFFが選択されている場合はメッセージは出ません。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/87fef710c5d7bd6bdc4425fa032504806b9229eb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3134323837392f33373061326537632d393835612d653063372d653766372d3839343461383138393764362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F370a2e7c-985a-e0c7-e7f7-8944a81897d6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=68cc4b75876ce467851a60d543c29d50\" alt=\"wbg16-09.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/142879/370a2e7c-985a-e0c7-e7f7-8944a81897d6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2F370a2e7c-985a-e0c7-e7f7-8944a81897d6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bc9039b72136f6b2add4a778613c20ec 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eアプリケーションを閉じると、ファイル保存ダイアログが表示され、一覧ファイルの保存先を聞かれます。\u003cbr\u003e\n次回起動時はそのファイルを読み込み、一覧を画面に復元します。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おまけソース整理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%81%BE%E3%81%91%E3%82%BD%E3%83%BC%E3%82%B9%E6%95%B4%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e■おまけ（ソース整理）\u003c/h1\u003e\n\n\u003cp\u003e追加ボタンを押したときの処理が、if文が入り組んでいて分かりづらいので少し整理します。\u003cbr\u003e\nエラーチェックしてエラーになったらreturnですぐ処理を抜けるようにし、if文のネストが深くならないようにしました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 追加ボタンクリック時の処理\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eButton_Click\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRoutedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 時刻の形式が正しいか？\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//（数字2桁:数字2桁か簡易チェックしてOKならDateTime型に変換できるかチェックする）\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegularExpressions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^[0-9]{2}:[0-9]{2}$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTryParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"2000/01/01 \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 時刻として正しくない\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"時刻を正しく入力してください。例）12:34\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// メッセージが入力されているか？\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrWhiteSpace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// メッセージ未入力（または空白しか入力されていない）\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"メッセージを入力してください。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 時刻もメッセージも入力されている\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// まだ追加されていない時刻かチェック\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eErrMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"この時刻は追加済みです。\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 一覧に追加\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elistBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\t\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimeAndMsgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emsgText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003etimeText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eラジオボタン選択時の処理を修正します。\u003cbr\u003e\ntimer変数が初期化される前にイベントが動いてしまうとStartやStopメソッドを呼ぶときにエラーになってしまうため、nullチェックをしていました。\u003cbr\u003e\nこれを\u003cstrong\u003eNull条件演算子\u003c/strong\u003e「?.」を使うやり方に変えます。\u003cbr\u003e\nnullチェックしていたif文を削除し、\u003ccode\u003etimer.Start()\u003c/code\u003e を \u003ccode\u003etimer?.Start()\u003c/code\u003e に変えます。Stopも同様です。\u003cbr\u003e\n\u003ccode\u003e?.\u003c/code\u003eの左側のオブジェクトがnullの場合は右側は参照されず、nullを返します。今回の例で言えばStartやStopメソッドは実行されません。\u003cbr\u003e\n\u003ccode\u003e?.\u003c/code\u003eの左側がnull以外の時は右側が実行されます。\u003cbr\u003e\nNull条件演算子は連続して使うこともできます。\u003cbr\u003e\n\u003ccode\u003eA?.B?.C()\u003c/code\u003eは、オブジェクトAとBがnullではないときに、メソッドCが実行されます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"CSharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// アラームON/OFFチェック時\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sender\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"e\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003ealarmOnOff_Checked\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRoutedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ealarmOn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsChecked\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etimer\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStop\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eおしまい\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003ca href=\"http://qiita.com/Kosen-amai/items/f9e3df2aa80363f5af5b\" title=\"Windows GUIプログラミング入門1 メッセージボックス表示\" id=\"reference-1c266a6e60d6f72dd082\"\u003e＜＜ 最初の記事\u003c/a\u003e 　 \u003ca href=\"https://qiita.com/Kosen-amai/items/44392fdf3bd8b56cfacb\" title=\"Windows GUIプログラミング入門15 インストーラー(1)\" id=\"reference-1d75155e564e0df19cb9\"\u003e＜ 前の記事\u003c/a\u003e 　 \u003ca href=\"https://qiita.com/Kosen-amai/items/c2542fe0d0b62d108096\" title=\"Windows GUIプログラミング入門17 変換ツール\" id=\"reference-9161ac9fa3d60e28f307\"\u003e次の記事 ＞\u003c/a\u003e\u003c/p\u003e\n","createdAt":"2018-11-06T14:40:00Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"4ll6ubhOYVyQqaxFel72PGQboMpoo4iK--4h6TvQwchLBoMEtZ--QyNy1a+eFmWHkhbEq6KAHA==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-10-06T10:20:46Z","likesCount":8,"linkUrl":"https://qiita.com/Kosen-amai/items/02208712c8cac15ef995","organization":null,"originalId":719149,"stockedCount":6,"title":"Windows GUIプログラミング入門16 アラーム","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e■はじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83\"\u003e■開発環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e■作ってみる\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%94%BB%E9%9D%A2%E4%BD%9C%E6%88%90\"\u003e◇画面作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A8%AD%E5%AE%9A%E9%A0%85%E7%9B%AE%E4%BD%9C%E6%88%90\"\u003e◇設定項目作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%AD%98%E5%9C%A8%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E4%BD%9C%E6%88%90\"\u003e◇設定ファイル存在確認メソッド作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%96%87%E5%AD%97%E5%88%97%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E4%BD%9C%E6%88%90\"\u003e◇文字列リソース作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%96%87%E5%AD%97%E5%88%97%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E5%88%A9%E7%94%A8\"\u003e◇文字列リソースの利用\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E8%A1%A8%E7%A4%BA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E4%BD%9C%E6%88%90\"\u003e◇メッセージボックス表示メソッド作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%BF%BD%E5%8A%A0%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%87%A6%E7%90%861\"\u003e◇追加ボタンの処理1\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%99%82%E5%88%BB%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF1\"\u003e時刻チェック1\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%99%82%E5%88%BB%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF2\"\u003e時刻チェック2\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%99%82%E5%88%BB%E3%81%A8%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AE%E4%B8%80%E8%A6%A7%E3%81%B8%E3%81%AE%E8%BF%BD%E5%8A%A0\"\u003e時刻とメッセージの一覧への追加\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e◇動作確認\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%A8%E7%B5%82%E4%BA%86%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86\"\u003e◇ウィンドウ起動時と終了時の処理\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B5%82%E4%BA%86%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86\"\u003e終了時の処理\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%9D%E6%9C%9F%E5%87%A6%E7%90%86%E3%82%BF%E3%82%A4%E3%83%9E%E3%83%BC%E5%87%A6%E7%90%86\"\u003e初期処理、タイマー処理\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%BF%BD%E5%8A%A0%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%87%A6%E7%90%862\"\u003e追加ボタンの処理2\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86\"\u003e起動時の処理\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A9%E3%82%B8%E3%82%AA%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E5%8B%95%E4%BD%9C\"\u003e◇ラジオボタンの動作\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e■動かしてみる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%81%BE%E3%81%91%E3%82%BD%E3%83%BC%E3%82%B9%E6%95%B4%E7%90%86\"\u003e■おまけ（ソース整理）\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":8349,"uuid":"02208712c8cac15ef995","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"dnUbBcSgSUmwpjttwfKlYt8D3CRD--xNLfnrQ9HY17hbKI--avhVVNMhQFrDHr7KDsI7GA==","originalId":142879,"description":"","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"Qiiwi","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/142879/profile-images/1476188567","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2Fprofile-images%2F1476188567?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=0834bc9f871004f1c30226ff9ae3afb1","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F142879%2Fprofile-images%2F1476188567?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d9b879212796ed8a879243c2e33fba15","urlName":"Kosen-amai","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"Windows","urlName":"windows"},{"name":"C#","urlName":"csharp"},{"name":"GUI","urlName":"gui"},{"name":"正規表現","urlName":"%e6%ad%a3%e8%a6%8f%e8%a1%a8%e7%8f%be"},{"name":"入門","urlName":"%e5%85%a5%e9%96%80"}],"followingLikers":{"edges":[]},"comments":{"totalCount":1}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
