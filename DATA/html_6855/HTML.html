<!DOCTYPE html><html><head><meta charset="utf-8" /><title>意識が高くないVisualStudioを使用した単体テストの自動化 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/mima_ita/items/05ce44c3eb1fd6e9dd46" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="KjCzReNzV8ffaEffSHNOG/3sBO+3SD1hh+KhBdBLh32OmIG+6sqqZVvHs4PtrsbEgVHR0aHKCei0VTzq2eauaQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="意識が高くないVisualStudioを使用した単体テストの自動化 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01b1NQNksyWTQ0R002YXVZNDRHUDQ0R3E0NEdFVm1semRXRnNVM1IxWkdsdjQ0S1M1TDJfNTVTbzQ0R1g0NEdmNVkyWTVMMlQ0NE9HNDRLNTQ0T0k0NEd1NkllcTVZdVY1WXlXJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWUyNjE3MDJkZDAxNjE0YmM1MjM4ZTA5YTNmYmQ5YmRl&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFwYldGZmFYUmgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz04OTA4M2RmMzNmOWExYmQyY2FiZTYxOTAyYzkzYzIxNg&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=02a84531baa548696e794b70ad0a2dc6"><meta property="og:description" content="

はじめに

この記事ではVisualStudioを使用して、どのように単体テストを自動化していくかを記述します。

この記事では「単体テストの自動化？なにそれおいしいの？」とかいう感じの組織で、現実的な妥協点を探っていくという、縛..."><meta content="https://qiita.com/mima_ita/items/05ce44c3eb1fd6e9dd46" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="TDD,C#,.NET,VisualStudio" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-11211a3a-b5eb-48a6-a1be-b7e44d75b81b"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fmima_ita%2Fitems%2F05ce44c3eb1fd6e9dd46">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fmima_ita%2Fitems%2F05ce44c3eb1fd6e9dd46">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-11211a3a-b5eb-48a6-a1be-b7e44d75b81b">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/tdd","name":"TDD"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2016-11-20T18:48:14.000+09:00","dateModified":"2016-11-20T19:04:29.000+09:00","headline":"意識が高くないVisualStudioを使用した単体テストの自動化","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01b1NQNksyWTQ0R002YXVZNDRHUDQ0R3E0NEdFVm1semRXRnNVM1IxWkdsdjQ0S1M1TDJfNTVTbzQ0R1g0NEdmNVkyWTVMMlQ0NE9HNDRLNTQ0T0k0NEd1NkllcTVZdVY1WXlXJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWUyNjE3MDJkZDAxNjE0YmM1MjM4ZTA5YTNmYmQ5YmRl\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFwYldGZmFYUmgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz04OTA4M2RmMzNmOWExYmQyY2FiZTYxOTAyYzkzYzIxNg\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=02a84531baa548696e794b70ad0a2dc6","mainEntityOfPage":"https://qiita.com/mima_ita/items/05ce44c3eb1fd6e9dd46","author":{"@type":"Person","address":"","email":null,"identifier":"mima_ita","name":"mima_ita","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F47856%2F0bc42d42eada368803d4098295f823130ecc5364%2Flarge.png%3F1571128517?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=aaca39e8c7ebef06bbfb64132a188a53","url":"https://qiita.com/mima_ita","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202106-uzabase-3/">社員の行動の基盤となるユーザベースのミッション・バリュー</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202106-uzabase-3/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mima_ita","type":"items","id":"05ce44c3eb1fd6e9dd46"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"社員の行動の基盤となるユーザベースのミッション・バリュー","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mima_ita","type":"items","id":"05ce44c3eb1fd6e9dd46"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"社員の行動の基盤となるユーザベースのミッション・バリュー","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mima_ita","type":"items","id":"05ce44c3eb1fd6e9dd46"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"社員の行動の基盤となるユーザベースのミッション・バリュー","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/mima_ita/items/05ce44c3eb1fd6e9dd46","location":"/mima_ita/items/05ce44c3eb1fd6e9dd46","scheme":"https","host":"qiita.com","port":null,"pathname":"/mima_ita/items/05ce44c3eb1fd6e9dd46","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"nF+8d3NHGJ6EqLgIWdV6xTP38SXuNuhqhGwH38g6s204946Mev7lPAAHTFT8CPIaT0okG/i03OO325owwZeaeQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-eb1695ca-5224-4067-ad17-0131ee501bc8"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/likers" class="css-1iupg5d">316</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">378</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/05ce44c3eb1fd6e9dd46/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/mima_ita"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/47856/0bc42d42eada368803d4098295f823130ecc5364/large.png?1571128517" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/mima_ita" class="css-10ougpm">@<!-- -->mima_ita</a><div class="css-1ay9vb9"><span><meta content="2016-11-20T09:48:14Z"/><time dateTime="2016-11-20T10:04:29Z" class="css-m19uds">updated at 2016-11-20</time></span></div></div></div></div></div><h1 class="css-cgzq40">意識が高くないVisualStudioを使用した単体テストの自動化</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/tdd" class="css-4czcte">TDD</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/.net" class="css-4czcte">.NET</a><a href="/tags/visualstudio" class="css-4czcte">VisualStudio</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>この記事ではVisualStudioを使用して、どのように単体テストを自動化していくかを記述します。</p>

<p>この記事では「単体テストの自動化？なにそれおいしいの？」とかいう感じの組織で、現実的な妥協点を探っていくという、縛りゲーをやるクソゲーマー向けて、ファミ通程度の攻略情報をお届けするのが目的です。</p>

<p>あと「単体テスト」を自動でやるという枝葉の話でしかないので、「テスト？なにそれおいしいの？」とか「品質管理？わいには関係ないで」とかいう方は「自動」云々でなく、まず基本的なソフトウェア技法から調べた方がよろしいです。</p>

<p>「まっとうなソフトウェアテストの知識」を持っている人が、ツールを駆使して、作業の効率化をもとめ品質を上げるってのが重要で、「まっとうなソフトウェアテストの知識」がない人が、手順だけを自動化するのは本質を踏み外しています。</p>

<p>JSTQBの教科書とか、ソフトウェアテストの本とかでもアマゾンで買ったほうが有益でしょう。</p>

<p><strong>自動化を目的にするのはやめましょう。</strong></p>

<h1>
<span id="単体テストの自動化の目的" class="fragment"></span><a href="#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%AE%E7%9B%AE%E7%9A%84"><i class="fa fa-link"></i></a>単体テストの自動化の目的</h1>

<p>「単体テスト」をテストコードによって実現します。<br>
流れとしては以下の全てをテストコードにより実現します。</p>

<p>・テスト対象が「どこ」でも「何時」でも実行できるように実行できる前提を作る<br>
・テスト対象を実行する<br>
・テスト対象が正しく動作したか検証する</p>

<p>これにより、回帰テストの効率が高まります。<br>
たとえば、別の機能を修正した場合、すくなくともテストコードが記述している箇所の挙動は保障されます。<br>
また、人力で実行した場合、人間は疲労等で結果の判定のミスをします。<br>
手動の単体テストで合格していたはずの項目があとになって動いてなかった経験はいくらでもあるでしょう。すくなくとも、テストコードは何回実行しても、書かれた通りにしか動かないので、疲れてミスもしませんし、証跡として無駄なスクリーンキャプチャーをとるより効率的ですし、意味もあります。</p>

<p>しかし、あくまで単体テストです。結合テストは別に考えましょう。<br>
単体テストを自動化して完全に動いても、それによって品質が高いと等価にはなりません。<br>
テストコードを書くことは重要ですが、それに過度の期待を持つべきではないというのも重要です。</p>

<p>たとえば画面の使い勝手や、同時実効性の問題は単体テストで検出するのはかなり厳しいです。</p>

<p>この前提は管理する側含めて全員の共有にした方が良いです。<br>
「単体テストを自動化したから結合テストの工数を削っていいよね」とかいう楽観主義は防ぐようにしてください。<br>
特に前線から離れた管理職は夢見がちな都合のいい楽観主義を現実と思い込む傾向があるので、ここは釘を強くさしておいてください。</p>

<p><strong>「単体テストはあくまで単体テスト。結合テストは別で考えろ」</strong></p>

<h2>
<span id="テスト対象がどこでも何時でも実行できるように実行できる前提を作る" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%81%A9%E3%81%93%E3%81%A7%E3%82%82%E4%BD%95%E6%99%82%E3%81%A7%E3%82%82%E5%AE%9F%E8%A1%8C%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E5%AE%9F%E8%A1%8C%E3%81%A7%E3%81%8D%E3%82%8B%E5%89%8D%E6%8F%90%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>テスト対象が「どこ」でも「何時」でも実行できるように実行できる前提を作る</h2>

<p>作成した単体テストが<strong>「どこ」</strong>でも<strong>「何時」</strong>でも実行できるようにするというのが重要です。<br>
たとえば、現在日付に依存するようなテストや、テストコードを書いた担当者の端末でしか動作しないようなテストは負債になります。</p>

<p>この工程では、それを防ぐために現在日付を取得する関数が常に同じ日付を返すように調整したり、どこの端末でもテスト対象が動作するように、ファイルやデータを読み込めるようにしたりします。</p>

<p>つまり、テスト対象が依存している機能がテストに都合のいい動作をするように設定します。<br>
VisualStudioの場合は、MoqやMicrosoftFakesを使用して、依存した機能をテストに都合のいいように設定するとよろしいでしょう。</p>

<p><strong>MSTestによるユニットテストの自動化 - Moq</strong><br>
<a href="http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#moq" class="autolink" id="reference-905240904b9bd89f83c4">http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#moq</a></p>

<p><strong>Microsoft Fakesを利用したテストコードの記述</strong><br>
<a href="http://qiita.com/mima_ita/items/9ebb0f40d3209f33a45d" class="autolink" id="reference-adecab421fe7bb48547e">http://qiita.com/mima_ita/items/9ebb0f40d3209f33a45d</a></p>

<p>また、よくあることですが、ある特定のテストを実行した後だと動かないということが多々あります。<br>
この工程では、前後で如何なるテストが行われても動くような状況を作成してください。</p>

<h2>
<span id="テスト対象を実行する" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>テスト対象を実行する</h2>

<p>GUIのテスト対象を実行するのは前段階が色々困難ですが、単体テストの場合、そのテスト対象の関数のみを実行すればいいのでなんとでもなります。</p>

<p>特に.NETの場合はリフレクションが使用できるので、プライベートメソッドだろが、プライベートプロパティだろうがアクセスすることが可能です。</p>

<p>VisualStudioのProfessional以上の場合、テストコードを記述するプロジェクトが作成できるので以下を参考に対象の関数を実行するといいでしょう。<br>
プライベートへのアクセスはPrivateObjectを使用してもいいですし、リフレクションを使用してもいいでしょう。</p>

<p><strong>MSTestによるユニットテストの自動化</strong><br>
<a href="http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24" class="autolink" id="reference-905240904b9bd89f83c4">http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24</a></p>

<p><strong>C# で private メソッドを呼んでみる</strong><br>
<a href="http://normalian.hatenablog.com/entry/20090124/1232782230" class="autolink" rel="nofollow noopener" target="_blank">http://normalian.hatenablog.com/entry/20090124/1232782230</a></p>

<h2>
<span id="テスト対象が正しく動作したか検証する" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%81%8C%E6%AD%A3%E3%81%97%E3%81%8F%E5%8B%95%E4%BD%9C%E3%81%97%E3%81%9F%E3%81%8B%E6%A4%9C%E8%A8%BC%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>テスト対象が正しく動作したか検証する</h2>

<p>テスト対象が正しく動作したかの検証も重要です。<br>
良く見るのが、テストの実行まではテストコードに書いて、実行結果を目視で確認するというやり方です。<br>
これは古式ゆかしいデバッグ方法ですが、自動化とはいいません。</p>

<p>MSTestには様々なAssert関数が用意されているので、それらを使用して実行結果を検証しましょう。</p>

<p><strong>様々なAssert機能</strong><br>
<a href="http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#%E6%A7%98%E3%80%85%E3%81%AAassert%E6%A9%9F%E8%83%BD" class="autolink" id="reference-905240904b9bd89f83c4">http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#%E6%A7%98%E3%80%85%E3%81%AAassert%E6%A9%9F%E8%83%BD</a></p>

<p>また、オブジェクトの内容をチェックする際は、それぞれのプロパティをAssertで愚直チェックをしてもいいですが、オブジェクトをJSONに変換してチェックする手もあります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>        <span class="k">public</span> <span class="k">class</span> <span class="nc">TestData12</span>
        <span class="p">{</span>
            <span class="k">public</span> <span class="k">class</span> <span class="nc">TestDataItem</span>
            <span class="p">{</span>
                <span class="k">public</span> <span class="kt">int</span> <span class="n">key</span> <span class="p">{</span> <span class="k">set</span><span class="p">;</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
                <span class="k">public</span> <span class="kt">string</span> <span class="n">name</span> <span class="p">{</span> <span class="k">set</span><span class="p">;</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">public</span> <span class="kt">string</span> <span class="n">GroupName</span> <span class="p">{</span> <span class="k">set</span><span class="p">;</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">TestDataItem</span><span class="p">&gt;</span> <span class="n">Items</span> <span class="p">{</span> <span class="k">set</span><span class="p">;</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestMethod12</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">expData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TestData12</span><span class="p">();</span>
            <span class="n">expData</span><span class="p">.</span><span class="n">GroupName</span> <span class="p">=</span> <span class="s">"Gp1"</span><span class="p">;</span>
            <span class="n">expData</span><span class="p">.</span><span class="n">Items</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">TestData12</span><span class="p">.</span><span class="n">TestDataItem</span><span class="p">&gt;();</span>
            <span class="n">expData</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">TestData12</span><span class="p">.</span><span class="n">TestDataItem</span>
            <span class="p">{</span>
                <span class="n">key</span> <span class="p">=</span> <span class="m">1111</span><span class="p">,</span>
                <span class="n">name</span> <span class="p">=</span> <span class="s">"item1"</span>
            <span class="p">});</span>
            <span class="n">expData</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">TestData12</span><span class="p">.</span><span class="n">TestDataItem</span>
            <span class="p">{</span>
                <span class="n">key</span> <span class="p">=</span> <span class="m">2222</span><span class="p">,</span>
                <span class="n">name</span> <span class="p">=</span> <span class="s">"item1"</span>
            <span class="p">});</span>
            <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">Newtonsoft</span><span class="p">.</span><span class="n">Json</span><span class="p">.</span><span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">expData</span><span class="p">);</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span>
                <span class="s">"{\"GroupName\":\"Gp1\",\"Items\":[{\"key\":1111,\"name\":\"item1\"},{\"key\":2222,\"name\":\"item1\"}]}"</span><span class="p">,</span>
                <span class="n">json</span>
            <span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>これを実行するにはNewtonsoft.Jsonが必要になります。<br>
<a href="http://www.newtonsoft.com/json" class="autolink" rel="nofollow noopener" target="_blank">http://www.newtonsoft.com/json</a></p>

<p>ここで紹介した方法はあくまで基本です。<br>
個々のプロジェクト用に必要な検証用のユーティリティ関数を作成するといいでしょう。</p>

<h1>
<span id="どれを自動化すべきか" class="fragment"></span><a href="#%E3%81%A9%E3%82%8C%E3%82%92%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%99%E3%81%B9%E3%81%8D%E3%81%8B"><i class="fa fa-link"></i></a>どれを自動化すべきか？</h1>

<p>意識が高い系の記事なら、「全部、カバレッジ100％に決まっているだろ」とか言いだしますが、ここでは「工数と開発者のスキルしだい」という面白くもない解答になります。</p>

<h2>
<span id="単体テストの自動化自体がはじめての場合" class="fragment"></span><a href="#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E8%87%AA%E4%BD%93%E3%81%8C%E3%81%AF%E3%81%98%E3%82%81%E3%81%A6%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>単体テストの自動化自体がはじめての場合</h2>

<p>単体テストの自動化が初めての場合は、簡単にできて効果の高い箇所をテストするといいでしょう。<br>
これは他のクラスになるべく依存していない、ユーティリティ関数のテストです。</p>

<p>static classの中から、なるべく多く機能で使用されているところから選定するといいでしょう。</p>

<h2>
<span id="共通的な機能あるいは業務的に重要な機能" class="fragment"></span><a href="#%E5%85%B1%E9%80%9A%E7%9A%84%E3%81%AA%E6%A9%9F%E8%83%BD%E3%81%82%E3%82%8B%E3%81%84%E3%81%AF%E6%A5%AD%E5%8B%99%E7%9A%84%E3%81%AB%E9%87%8D%E8%A6%81%E3%81%AA%E6%A9%9F%E8%83%BD"><i class="fa fa-link"></i></a>共通的な機能あるいは業務的に重要な機能</h2>

<p>次に単体テストを自動化して効果のある機能は多くの機能から呼ばれている機能です。<br>
多くのクラスのベースとなるクラスや、多くのクラスから参照される機能が対象になるでしょう。</p>

<p>単体テストを自動化することにより、仮にその共通機能に修正が入っても、他の機能に影響を与えないような修正になっていることを保証する回帰試験が容易になります。</p>

<p>また、品質の確保においてシビアなものを要求される重要な機能においても単体テストを自動化するのは有効です。</p>

<h2>
<span id="テストコードで保障されていない箇所を調べてテストコードを書く" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E4%BF%9D%E9%9A%9C%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E7%AE%87%E6%89%80%E3%82%92%E8%AA%BF%E3%81%B9%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F"><i class="fa fa-link"></i></a>テストコードで保障されていない箇所を調べてテストコードを書く</h2>

<p>VisualStudo2013のPremium以上もしくはVisualStudio2015のEnterpriseのエディションにはコードカバレッジを計測する機能がついています。<br>
これにより、どの機能がテストコードにより実行されていないか調べることが可能です。</p>

<p>(1)[テスト]→[コードカバレッジの分析]→[すべてのテスト]を選択<br>
<a href="https://camo.qiitausercontent.com/46375fd56a995dcaa5403d9a2ec697623ad90d15/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f66343934643337312d653238332d343065312d386666342d3766396130623935653461652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Ff494d371-e283-40e1-8ff4-7f9a0b95e4ae.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=aa7a9ef97fd133d8c6414800fd5c732b" alt="vs002.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/47856/f494d371-e283-40e1-8ff4-7f9a0b95e4ae.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Ff494d371-e283-40e1-8ff4-7f9a0b95e4ae.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=33de7e3f1c32633f669fac985a4f5715 1x" loading="lazy"></a></p>

<p>(2)コードカバレッジの結果が以下のように表示される。<br>
<a href="https://camo.qiitausercontent.com/6297aafc623130b5fa2298a03b2b4d7770717c03/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f66666234663230352d623237632d643165352d323736652d3531343963383065643566322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Fffb4f205-b27c-d1e5-276e-5149c80ed5f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=caead8276dcab99f7aad673dbc64dc34" alt="vs003.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/47856/ffb4f205-b27c-d1e5-276e-5149c80ed5f2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Fffb4f205-b27c-d1e5-276e-5149c80ed5f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d3844c3933f274c07f79dea6f09d55d0 1x" loading="lazy"></a></p>

<p>関数単位で未カバー（実行していない）箇所が出力される。</p>

<p>(3)結果の関数をクリックすると実行済みの行は青、未実行の行は赤で表示される。<br>
<a href="https://camo.qiitausercontent.com/ce8dccf91bc8dc7343286f3010f1cf33e88e761d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f39653262306335652d626437392d396235642d306361332d3465653634613761333334342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F9e2b0c5e-bd79-9b5d-0ca3-4ee64a7a3344.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4cc0a6774d64e222b6d0b060b6e6f51c" alt="vs004.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/47856/9e2b0c5e-bd79-9b5d-0ca3-4ee64a7a3344.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F9e2b0c5e-bd79-9b5d-0ca3-4ee64a7a3344.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ba26d90dc75c2ac98bb691ace45dd39b 1x" loading="lazy"></a></p>

<p>これらの機能を利用して、未実行の行を探して、そこを通るようにテストコードを書いていきます。</p>

<h2>
<span id="品質が悪そうな個所を探してテストコードを書く" class="fragment"></span><a href="#%E5%93%81%E8%B3%AA%E3%81%8C%E6%82%AA%E3%81%9D%E3%81%86%E3%81%AA%E5%80%8B%E6%89%80%E3%82%92%E6%8E%A2%E3%81%97%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F"><i class="fa fa-link"></i></a>品質が悪そうな個所を探してテストコードを書く</h2>

<p>ある程度、経験を積むとマズイ書き方をしているコードはわかります。<br>
たとえば、以下のようなコードはヤバい臭いがぷんぷんとします。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Count</span><span class="p">;++</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">y</span><span class="p">.</span><span class="n">Count</span><span class="p">;++</span><span class="n">j</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span> <span class="p">==</span> <span class="s">"XXX"</span><span class="p">)</span>
    <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">name</span> <span class="p">==</span> <span class="s">"ZZZ"</span><span class="p">)</span>
       <span class="p">{</span>
          <span class="nf">hoge1</span><span class="p">();</span>
          <span class="k">if</span> <span class="p">(</span><span class="nf">hoge2</span><span class="p">()</span> <span class="p">==</span> <span class="m">3</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="nf">hoge4</span><span class="p">();</span>
          <span class="p">}</span>
          <span class="k">else</span>
          <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nf">hoge3</span><span class="p">()</span> <span class="p">==</span> <span class="m">3</span><span class="p">)</span>
            <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="nf">hoge4</span><span class="p">()</span> <span class="p">==</span> <span class="m">5</span><span class="p">)</span>
               <span class="p">{</span>
                  <span class="nf">hoge6</span><span class="p">();</span>
               <span class="p">}</span>
               <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">==</span><span class="m">5</span><span class="p">)</span>
               <span class="p">{</span>
<span class="err">　　　　　　　　　</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                 <span class="p">{</span>
                 <span class="p">}</span>
                 <span class="k">else</span>
                 <span class="p">{</span>
                 <span class="p">}</span>
               <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="nf">hoge5</span><span class="p">();</span>
       <span class="p">}</span>
       <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">name</span> <span class="p">=</span> <span class="s">"dddd"</span><span class="p">)</span>
       <span class="p">{</span>
          <span class="nf">hoge1</span><span class="p">();</span>
          <span class="k">if</span> <span class="p">(</span><span class="nf">hoge2</span><span class="p">()</span> <span class="p">==</span> <span class="m">3</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="nf">hoge4</span><span class="p">();</span>
          <span class="p">}</span>
          <span class="k">else</span>
          <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nf">hoge3</span><span class="p">()</span> <span class="p">==</span> <span class="m">3</span><span class="p">)</span>
            <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="nf">hoge4</span><span class="p">()</span> <span class="p">==</span> <span class="m">5</span><span class="p">)</span>
               <span class="p">{</span>
                  <span class="nf">hoge6</span><span class="p">();</span>
               <span class="p">}</span>
               <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">==</span><span class="m">5</span><span class="p">)</span>
               <span class="p">{</span>
               <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="nf">hoge5</span><span class="p">();</span>
       <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>しかしながら、「クソコードだから直せよ、凸助」というと刃傷沙汰になります。<br>
そういう、マズイ書き方をしている箇所を定量的に見つける手段として、「サイクロマティック複雑度」という指標が存在します。</p>

<p><strong>循環的複雑度（Cyclomatic complexity）</strong><br>
<a href="https://ja.wikipedia.org/wiki/%E5%BE%AA%E7%92%B0%E7%9A%84%E8%A4%87%E9%9B%91%E5%BA%A6" class="autolink" rel="nofollow noopener" target="_blank">https://ja.wikipedia.org/wiki/%E5%BE%AA%E7%92%B0%E7%9A%84%E8%A4%87%E9%9B%91%E5%BA%A6</a></p>

<p>簡単にいうと、ループや分岐が多いほどこの複雑度は高くなります。<br>
1関数で25を超える場合、複雑度が極めて大きく、バグが潜んでいる可能性が高いです。</p>

<p>VisualStudioでは以下のようにサイクロマティック複雑度を計測します。</p>

<p>(1)[分析]→[ソリューションのコードメトリックスを計算]<br>
<a href="https://camo.qiitausercontent.com/3554f51b67ae066794f708b771c1e62689973370/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f61666662613635662d346663612d343238342d623132652d3934616230646466333336352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Faffba65f-4fca-4284-b12e-94ab0ddf3365.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d8c5be86530ac732dc750bc8bc633311" alt="vs005.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/47856/affba65f-4fca-4284-b12e-94ab0ddf3365.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Faffba65f-4fca-4284-b12e-94ab0ddf3365.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2015eefddd98836682ed66d8bf30f768 1x" loading="lazy"></a></p>

<p>(2)コードメトリックスの結果が表示される。<br>
<a href="https://camo.qiitausercontent.com/9c06a4351af8c259f92b182a97b3390189fab955/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f32663638383134632d393663352d303465362d376538302d6433303437393030616439632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F2f68814c-96c5-04e6-7e80-d3047900ad9c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3e4f9f100f35630cb752436a747641bd" alt="vs006.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/47856/2f68814c-96c5-04e6-7e80-d3047900ad9c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F2f68814c-96c5-04e6-7e80-d3047900ad9c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7ebda9f854a4c395c18631a0baf885f0 1x" loading="lazy"></a></p>

<p>サイクロマティック複雑度は25未満に抑えるように実装するのが筋ですが、直せない場合は、これを超える箇所を集中的にテストコードを記述しましょう。<br>
（だいたいバグがでてくるはず）</p>

<h1>
<span id="自動テストはいつ書いて実行すべきか" class="fragment"></span><a href="#%E8%87%AA%E5%8B%95%E3%83%86%E3%82%B9%E3%83%88%E3%81%AF%E3%81%84%E3%81%A4%E6%9B%B8%E3%81%84%E3%81%A6%E5%AE%9F%E8%A1%8C%E3%81%99%E3%81%B9%E3%81%8D%E3%81%8B"><i class="fa fa-link"></i></a>自動テストはいつ書いて実行すべきか？</h1>

<p>実装しながらテストコードを書いたほうが楽です。<br>
すくなくともテストコードが書けるレベルのコードになります。<br>
そしてテストコードは最低毎日実行して、必ず全てのテストコードが合格するように監視してください。</p>

<p>人間は安易な方向に、あっさり流されます。</p>

<p>いくら、「どの環境でもテストが動くようにしろ」と言っても自分の環境でしか動かないテストコードはコミットされますし、「テストコードを動かして合格してからコミットしろ」といってもテストを不合格にするような安易な修正がコミットされます。</p>

<p>これはなにをどうやっても防げません。</p>

<p>そしてそれを放置すると、動かないテストが大量に作成されて、単体テストの自動化が形骸化します。最悪[Ignore]属性を付与して無視する形でいいので、テストが合格しつづけることだけは死守しましょう。</p>

<p><strong>「毎日テストを実行して、その結果が合格になるように維持し続ける」ということだけは、なにがなんでも死守してください。</strong></p>

<h2>
<span id="コマンドラインからビルドしてテストを実行する方法" class="fragment"></span><a href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%81%8B%E3%82%89%E3%83%93%E3%83%AB%E3%83%89%E3%81%97%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>コマンドラインからビルドしてテストを実行する方法</h2>

<p>毎日実行しつづけるのに手でやるのはしんどいです。<br>
なので、コマンドラインから実行できるようにして、タスクスケジューラーかなにかで毎日実行するといいでしょう。</p>

<p>(1)MSBuildを使用してソリューションをビルドする</p>

<div class="code-frame" data-lang="txt"><div class="highlight"><pre class="with-code"><code>C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild TestSample.sln
</code></pre></div></div>

<p>(2)コマンドプロンプトからテストを実行する。</p>

<div class="code-frame" data-lang="txt"><div class="highlight"><pre class="with-code"><code>#環境変数の設定
"C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\Tools\VsDevCmd.bat"

#テストの実行
vstest.console.exe UnitTestProject1\bin\Debug\UnitTestProject1.dll

</code></pre></div></div>

<p><strong>コマンド ラインからの VSTest.console の使用</strong><br>
<a href="https://msdn.microsoft.com/ja-jp/library/jj155800.aspx" class="autolink" rel="nofollow noopener" target="_blank">https://msdn.microsoft.com/ja-jp/library/jj155800.aspx</a></p>

<p>可能ならJenkinsを使用するといいですが、手段は問わないので毎日実行して結果を監視しましょう。</p>

<h1>
<span id="どう説得するか" class="fragment"></span><a href="#%E3%81%A9%E3%81%86%E8%AA%AC%E5%BE%97%E3%81%99%E3%82%8B%E3%81%8B"><i class="fa fa-link"></i></a>どう説得するか？</h1>

<p>テストコードを書くことを認めさせる方法としていくつかのケースが考えられます。<br>
ここでは、その説得方法を考えてみましょう。</p>

<h2>
<span id="テストコード書かないと単体テストができないケース" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E6%9B%B8%E3%81%8B%E3%81%AA%E3%81%84%E3%81%A8%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E3%82%B1%E3%83%BC%E3%82%B9"><i class="fa fa-link"></i></a>テストコード書かないと単体テストができないケース</h2>

<p>このパターンが一番説得しやすいです。<br>
なぜならば、手動でテストができず、テストコードでしかテストできないので反論がしようがありません。<br>
代替手段のないことを提案するのが一番楽です。</p>

<h3>
<span id="外部の機能に依存しておりそれが完成していない場合" class="fragment"></span><a href="#%E5%A4%96%E9%83%A8%E3%81%AE%E6%A9%9F%E8%83%BD%E3%81%AB%E4%BE%9D%E5%AD%98%E3%81%97%E3%81%A6%E3%81%8A%E3%82%8A%E3%81%9D%E3%82%8C%E3%81%8C%E5%AE%8C%E6%88%90%E3%81%97%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>外部の機能に依存しており、それが完成していない場合</h3>

<p>たとえば、外部の機能に依存しており、そのシステムが現在開発中で手動でテストできないケースを考えてみましょう。</p>

<p>従来であれば、結合テストまで先送りして地獄を味わいます。<br>
しかし、テストコードを書くならば、外部のシステムのインターフェイスをMoqまたはMicrosfotFakesで偽装して単体テストを行うことが可能になります。</p>

<p>結合テストでのリスクを事前に減らせるというのは大きな説得材料になるでしょう。</p>

<h3>
<span id="大量のパターンがある場合" class="fragment"></span><a href="#%E5%A4%A7%E9%87%8F%E3%81%AE%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>大量のパターンがある場合</h3>

<p>たとえばある関数の引数が取りうるパターンが数百、数千あったとします。<br>
これは手動で実行するのは無理です。</p>

<p>しかしながら、テストコードであれば、パラメータを機械的に作成してテストコードを実行するだけなので有効です。</p>

<h2>
<span id="関連する機能もしくは自機能に変更が予測されテストを何回も行う必要があるケース" class="fragment"></span><a href="#%E9%96%A2%E9%80%A3%E3%81%99%E3%82%8B%E6%A9%9F%E8%83%BD%E3%82%82%E3%81%97%E3%81%8F%E3%81%AF%E8%87%AA%E6%A9%9F%E8%83%BD%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%8C%E4%BA%88%E6%B8%AC%E3%81%95%E3%82%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E4%BD%95%E5%9B%9E%E3%82%82%E8%A1%8C%E3%81%86%E5%BF%85%E8%A6%81%E3%81%8C%E3%81%82%E3%82%8B%E3%82%B1%E3%83%BC%E3%82%B9"><i class="fa fa-link"></i></a>関連する機能、もしくは自機能に変更が予測されテストを何回も行う必要があるケース</h2>

<p>次善のパターンです。<br>
このケースをもって説得する場合、以下の工数の勝負になります。</p>

<p>手動テストの工数：「一回の手動テストに係る工数」×「予測される変更回数」<br>
自動テストの工数：「テストコードを記述する工数」</p>

<p>これを算出して金額の差額で、勝負しましょう。</p>

<h2>
<span id="品質で勝負するケース" class="fragment"></span><a href="#%E5%93%81%E8%B3%AA%E3%81%A7%E5%8B%9D%E8%B2%A0%E3%81%99%E3%82%8B%E3%82%B1%E3%83%BC%E3%82%B9"><i class="fa fa-link"></i></a>品質で勝負するケース</h2>

<p>これは分の悪い勝負です。</p>

<p>テストコードを書いた方が品質が良くなる傾向がありますが、それを費用体効果で表すのはかなり難しいですし、事前に説得する材料を持ってくるのは無理でしょう。</p>

<p>ここで勝負するには、テストコードを書いた機能と書かなかった機能でバグ数/step数で比較することになりますが、この時点で手遅れなので、一手遅れます。</p>

<h1>
<span id="faq" class="fragment"></span><a href="#faq"><i class="fa fa-link"></i></a>FAQ</h1>

<p>よくある質問をまとめます。</p>

<h2>
<span id="他の開発者がテストコードを書いてくれません" class="fragment"></span><a href="#%E4%BB%96%E3%81%AE%E9%96%8B%E7%99%BA%E8%80%85%E3%81%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%BE%E3%81%9B%E3%82%93"><i class="fa fa-link"></i></a>他の開発者がテストコードを書いてくれません。</h2>

<h3>
<span id="作業者向けの答え" class="fragment"></span><a href="#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88"><i class="fa fa-link"></i></a>作業者向けの答え</h3>

<p>そういうもんです。あきらめましょう。<br>
無理やり書かせても、やっつけ仕事で意味のない仕事をあげてくるだけです。</p>

<p>ただし、他人が書かないのは、貴方が書かない理由にはなりません。<br>
少なくとも貴方は書けばいいです。<br>
貴方が書き続ける限りいずれ、カバレッジは100％に近づきます。</p>

<h3>
<span id="管理者向けの答え" class="fragment"></span><a href="#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88"><i class="fa fa-link"></i></a>管理者向けの答え</h3>

<p>泣き言いっていないで、テストコードを書ける人間を調達するか、教育しましょう。<br>
学習期間を用意する、テストコードを書くための工数を用意する、テストコードが正しくかけたかチェックする工数を確保するのは管理職の職責です。</p>

<h2>
<span id="管理者がテストコードを書く工数を確保してくれません" class="fragment"></span><a href="#%E7%AE%A1%E7%90%86%E8%80%85%E3%81%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F%E5%B7%A5%E6%95%B0%E3%82%92%E7%A2%BA%E4%BF%9D%E3%81%97%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%BE%E3%81%9B%E3%82%93"><i class="fa fa-link"></i></a>管理者がテストコードを書く工数を確保してくれません。</h2>

<h3>
<span id="作業者向けの答え-1" class="fragment"></span><a href="#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1"><i class="fa fa-link"></i></a>作業者向けの答え</h3>

<p>そういうもんです。あきらめましょう。<br>
本当に、そのテストコードが必要だと思うなら作業進捗を過小報告して裏で書きましょう。</p>

<p>残念ながら、まっとうじゃない状況で、まっとうなことをしたかったら、まっとうじゃない手段をとるしかありません。</p>

<h3>
<span id="管理者向けの答え-1" class="fragment"></span><a href="#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1"><i class="fa fa-link"></i></a>管理者向けの答え</h3>

<p>確保しましょう。<br>
どうしても確保できんのなら、優先度を考えて効果の高い部分だけ適用するのはどうでしょうか？</p>

<h2>
<span id="それでも私は周りにテストコードを書かせたいのです" class="fragment"></span><a href="#%E3%81%9D%E3%82%8C%E3%81%A7%E3%82%82%E7%A7%81%E3%81%AF%E5%91%A8%E3%82%8A%E3%81%AB%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8B%E3%81%9B%E3%81%9F%E3%81%84%E3%81%AE%E3%81%A7%E3%81%99"><i class="fa fa-link"></i></a>それでも私は周りにテストコードを書かせたいのです。</h2>

<h3>
<span id="作業者向けの答え-2" class="fragment"></span><a href="#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-2"><i class="fa fa-link"></i></a>作業者向けの答え</h3>

<p>権限のない人間が他人の行動を決めることはできません。</p>

<p>テストコードを書かない機能にバグがないなら、それはそれでうまくいっているので、無理にうまくいっている事を変更する必要がないでしょう。わりきりましょう。</p>

<p>バグが大量にあるなら、バグ報告をして、「品質に問題があるので是正処置をとる必要があります」という方向にもっていきましょう。</p>

<p>この際、テストコードがある機能のバグ件数/Step数と比較してやれば、管理職はテストコードを書かないとまずいんじゃないかと思い始めます。<br>
その事実を10か20も積み重ねれば、組織としてテストコードを書くようになるか、テストコードを書ける奴を雇ってくるでしょう。</p>

<h3>
<span id="管理者向けの答え-2" class="fragment"></span><a href="#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-2"><i class="fa fa-link"></i></a>管理者向けの答え</h3>

<p>こんなもん読んでないで、さっさと人を教育するか適切な人雇う手筈を考えた方がいいでしょう。<br>
貴方の組織の問題は貴方でないと解決できません。</p>

<h2>
<span id="テストコード書いてくれるのですが合格しないコードをコミットしやがります" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%8F%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%A7%E3%81%99%E3%81%8C%E5%90%88%E6%A0%BC%E3%81%97%E3%81%AA%E3%81%84%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E3%81%97%E3%82%84%E3%81%8C%E3%82%8A%E3%81%BE%E3%81%99"><i class="fa fa-link"></i></a>テストコード書いてくれるのですが、合格しないコードをコミットしやがります</h2>

<h3>
<span id="作業者向けの答え-3" class="fragment"></span><a href="#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-3"><i class="fa fa-link"></i></a>作業者向けの答え</h3>

<p>そういうもんです。あきらめましょう。</p>

<p>毎日、全体メールで<strong>「偉い管理職」</strong>でもまぜて不合格の旨を通知しつづけましょう。<br>
そのうち折れて直してきます。直さなくても管理職が問題視して勝手に対応してくれます。</p>

<p>放置されるようなら徐々に上役をCCにまぜていくといいでしょう。最後の偉い人まで行って放置されるなら、その組織の命数はもう長くないので、「プログラマがプロジェクトを救おうなどとおこがましいとは思わんかね？」とでも、ご自身に言い聞かせて、辞める準備をしましょう。</p>

<h3>
<span id="管理者向けの答え-3" class="fragment"></span><a href="#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-3"><i class="fa fa-link"></i></a>管理者向けの答え</h3>

<p>テストが通らないコードはコミットさせないという運用ルールを作って周知します。</p>

<p>可能なら、テストコードが適切に動作しているかチェックする人間を任命しましょう。<br>
当然、通常の作業量を減らすべきです。</p>

<h2>
<span id="テストコードが書きずらいです" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%81%8C%E6%9B%B8%E3%81%8D%E3%81%9A%E3%82%89%E3%81%84%E3%81%A7%E3%81%99"><i class="fa fa-link"></i></a>テストコードが書きずらいです。</h2>

<h3>
<span id="作業者向けの答え-4" class="fragment"></span><a href="#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-4"><i class="fa fa-link"></i></a>作業者向けの答え</h3>

<p>GUI、マルチスレッドなどはたしかにテストコードは書きずらいので、そういう単体テストに向かないところはテストコードを書かないのも手です。</p>

<p>そういう理由がないのに、テストコードが書きずらいのは単純に実装がへたくそなだけです。<br>
自分が書いた実装ならテストが書けるように直しましょう。</p>

<p>他人が書いた実装なら、バグを淡々と報告して、「作り直した方がはやい」ということを上に理解させましょう。<br>
たぶん、そういう実装を仕上げてくる方の成果物の品質は極めて悪いので、簡単にバグを見つけることができます。</p>

<h3>
<span id="管理職向けの答え" class="fragment"></span><a href="#%E7%AE%A1%E7%90%86%E8%81%B7%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88"><i class="fa fa-link"></i></a>管理職向けの答え</h3>

<p>特別の理由がない場合、実装が不味い可能性があります。<br>
サイクロマティック複雑度の計測をしてみてください。<br>
異常な値が出た場合は、残念ながらその機能はバグを含んでいる可能性が極めて高いです。<br>
別の人間にプロダクトコードの修正をできる権限をあたえて見直しをさせた方がいいでしょう。</p>

<h2>
<span id="単体テストを自動化する意味がわかりません" class="fragment"></span><a href="#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%99%E3%82%8B%E6%84%8F%E5%91%B3%E3%81%8C%E3%82%8F%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93"><i class="fa fa-link"></i></a>単体テストを自動化する意味がわかりません</h2>

<h3>
<span id="作業者向けの答え-5" class="fragment"></span><a href="#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-5"><i class="fa fa-link"></i></a>作業者向けの答え</h3>

<p>作りっぱなしで、終われる仕事だけしていればいいというなら、その考えもよろしいんじゃないでしょうか。</p>

<h3>
<span id="管理職向けの答え-1" class="fragment"></span><a href="#%E7%AE%A1%E7%90%86%E8%81%B7%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1"><i class="fa fa-link"></i></a>管理職向けの答え</h3>

<p>しょせん、コストと効果のトレードオフにしかすぎません。<br>
変更が発生する頻度と１回のテストの手間で、解答がかわります。<br>
プロジェクトの性質によっては、その答えになるのも已む得ないでしょう。</p>

<p>ただし、もし、あらゆる状況で意味がないというお考えならば、そもそも「ソフトウェア」の管理には向いていない疑義があります。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fmima_ita%2Fitems%2F05ce44c3eb1fd6e9dd46&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fmima_ita%2Fitems%2F05ce44c3eb1fd6e9dd46&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/likers" class="css-1iupg5d">316</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">378</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/05ce44c3eb1fd6e9dd46/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mima_ita/items/05ce44c3eb1fd6e9dd46.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-eb1695ca-5224-4067-ad17-0131ee501bc8">{"authorAnalyticsTrackingId":"UA-52996017-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-1e5aeb10-7f77-4713-ac03-5618be443ee9"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-1e5aeb10-7f77-4713-ac03-5618be443ee9">{}</script>
      
<div id="LoginModal-react-component-8bba3133-2a70-4a36-bd4e-cd94ca9ce77b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-8bba3133-2a70-4a36-bd4e-cd94ca9ce77b">{}</script>
      
<div id="StockModal-react-component-345a6c41-af09-4f97-984e-fe2a2b7356af"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-345a6c41-af09-4f97-984e-fe2a2b7356af">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;S3bedTYeF1pmMxmPLxVh+poyRDNfa1B1gqpkT7xcxZzv3uyOP6fq+OKc7dOKyOkl5o+RDUnpZPyxHfmgtfHsiA==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eこの記事ではVisualStudioを使用して、どのように単体テストを自動化していくかを記述します。\u003c/p\u003e\n\n\u003cp\u003eこの記事では「単体テストの自動化？なにそれおいしいの？」とかいう感じの組織で、現実的な妥協点を探っていくという、縛りゲーをやるクソゲーマー向けて、ファミ通程度の攻略情報をお届けするのが目的です。\u003c/p\u003e\n\n\u003cp\u003eあと「単体テスト」を自動でやるという枝葉の話でしかないので、「テスト？なにそれおいしいの？」とか「品質管理？わいには関係ないで」とかいう方は「自動」云々でなく、まず基本的なソフトウェア技法から調べた方がよろしいです。\u003c/p\u003e\n\n\u003cp\u003e「まっとうなソフトウェアテストの知識」を持っている人が、ツールを駆使して、作業の効率化をもとめ品質を上げるってのが重要で、「まっとうなソフトウェアテストの知識」がない人が、手順だけを自動化するのは本質を踏み外しています。\u003c/p\u003e\n\n\u003cp\u003eJSTQBの教科書とか、ソフトウェアテストの本とかでもアマゾンで買ったほうが有益でしょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e自動化を目的にするのはやめましょう。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"単体テストの自動化の目的\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%AE%E7%9B%AE%E7%9A%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e単体テストの自動化の目的\u003c/h1\u003e\n\n\u003cp\u003e「単体テスト」をテストコードによって実現します。\u003cbr\u003e\n流れとしては以下の全てをテストコードにより実現します。\u003c/p\u003e\n\n\u003cp\u003e・テスト対象が「どこ」でも「何時」でも実行できるように実行できる前提を作る\u003cbr\u003e\n・テスト対象を実行する\u003cbr\u003e\n・テスト対象が正しく動作したか検証する\u003c/p\u003e\n\n\u003cp\u003eこれにより、回帰テストの効率が高まります。\u003cbr\u003e\nたとえば、別の機能を修正した場合、すくなくともテストコードが記述している箇所の挙動は保障されます。\u003cbr\u003e\nまた、人力で実行した場合、人間は疲労等で結果の判定のミスをします。\u003cbr\u003e\n手動の単体テストで合格していたはずの項目があとになって動いてなかった経験はいくらでもあるでしょう。すくなくとも、テストコードは何回実行しても、書かれた通りにしか動かないので、疲れてミスもしませんし、証跡として無駄なスクリーンキャプチャーをとるより効率的ですし、意味もあります。\u003c/p\u003e\n\n\u003cp\u003eしかし、あくまで単体テストです。結合テストは別に考えましょう。\u003cbr\u003e\n単体テストを自動化して完全に動いても、それによって品質が高いと等価にはなりません。\u003cbr\u003e\nテストコードを書くことは重要ですが、それに過度の期待を持つべきではないというのも重要です。\u003c/p\u003e\n\n\u003cp\u003eたとえば画面の使い勝手や、同時実効性の問題は単体テストで検出するのはかなり厳しいです。\u003c/p\u003e\n\n\u003cp\u003eこの前提は管理する側含めて全員の共有にした方が良いです。\u003cbr\u003e\n「単体テストを自動化したから結合テストの工数を削っていいよね」とかいう楽観主義は防ぐようにしてください。\u003cbr\u003e\n特に前線から離れた管理職は夢見がちな都合のいい楽観主義を現実と思い込む傾向があるので、ここは釘を強くさしておいてください。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e「単体テストはあくまで単体テスト。結合テストは別で考えろ」\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テスト対象がどこでも何時でも実行できるように実行できる前提を作る\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%81%A9%E3%81%93%E3%81%A7%E3%82%82%E4%BD%95%E6%99%82%E3%81%A7%E3%82%82%E5%AE%9F%E8%A1%8C%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E5%AE%9F%E8%A1%8C%E3%81%A7%E3%81%8D%E3%82%8B%E5%89%8D%E6%8F%90%E3%82%92%E4%BD%9C%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテスト対象が「どこ」でも「何時」でも実行できるように実行できる前提を作る\u003c/h2\u003e\n\n\u003cp\u003e作成した単体テストが\u003cstrong\u003e「どこ」\u003c/strong\u003eでも\u003cstrong\u003e「何時」\u003c/strong\u003eでも実行できるようにするというのが重要です。\u003cbr\u003e\nたとえば、現在日付に依存するようなテストや、テストコードを書いた担当者の端末でしか動作しないようなテストは負債になります。\u003c/p\u003e\n\n\u003cp\u003eこの工程では、それを防ぐために現在日付を取得する関数が常に同じ日付を返すように調整したり、どこの端末でもテスト対象が動作するように、ファイルやデータを読み込めるようにしたりします。\u003c/p\u003e\n\n\u003cp\u003eつまり、テスト対象が依存している機能がテストに都合のいい動作をするように設定します。\u003cbr\u003e\nVisualStudioの場合は、MoqやMicrosoftFakesを使用して、依存した機能をテストに都合のいいように設定するとよろしいでしょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMSTestによるユニットテストの自動化 - Moq\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#moq\" class=\"autolink\" id=\"reference-905240904b9bd89f83c4\"\u003ehttp://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#moq\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMicrosoft Fakesを利用したテストコードの記述\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"http://qiita.com/mima_ita/items/9ebb0f40d3209f33a45d\" class=\"autolink\" id=\"reference-adecab421fe7bb48547e\"\u003ehttp://qiita.com/mima_ita/items/9ebb0f40d3209f33a45d\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eまた、よくあることですが、ある特定のテストを実行した後だと動かないということが多々あります。\u003cbr\u003e\nこの工程では、前後で如何なるテストが行われても動くような状況を作成してください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テスト対象を実行する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテスト対象を実行する\u003c/h2\u003e\n\n\u003cp\u003eGUIのテスト対象を実行するのは前段階が色々困難ですが、単体テストの場合、そのテスト対象の関数のみを実行すればいいのでなんとでもなります。\u003c/p\u003e\n\n\u003cp\u003e特に.NETの場合はリフレクションが使用できるので、プライベートメソッドだろが、プライベートプロパティだろうがアクセスすることが可能です。\u003c/p\u003e\n\n\u003cp\u003eVisualStudioのProfessional以上の場合、テストコードを記述するプロジェクトが作成できるので以下を参考に対象の関数を実行するといいでしょう。\u003cbr\u003e\nプライベートへのアクセスはPrivateObjectを使用してもいいですし、リフレクションを使用してもいいでしょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMSTestによるユニットテストの自動化\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24\" class=\"autolink\" id=\"reference-905240904b9bd89f83c4\"\u003ehttp://qiita.com/mima_ita/items/55394bcc851eb8b6dc24\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eC# で private メソッドを呼んでみる\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"http://normalian.hatenablog.com/entry/20090124/1232782230\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://normalian.hatenablog.com/entry/20090124/1232782230\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テスト対象が正しく動作したか検証する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%81%8C%E6%AD%A3%E3%81%97%E3%81%8F%E5%8B%95%E4%BD%9C%E3%81%97%E3%81%9F%E3%81%8B%E6%A4%9C%E8%A8%BC%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテスト対象が正しく動作したか検証する\u003c/h2\u003e\n\n\u003cp\u003eテスト対象が正しく動作したかの検証も重要です。\u003cbr\u003e\n良く見るのが、テストの実行まではテストコードに書いて、実行結果を目視で確認するというやり方です。\u003cbr\u003e\nこれは古式ゆかしいデバッグ方法ですが、自動化とはいいません。\u003c/p\u003e\n\n\u003cp\u003eMSTestには様々なAssert関数が用意されているので、それらを使用して実行結果を検証しましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e様々なAssert機能\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"http://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#%E6%A7%98%E3%80%85%E3%81%AAassert%E6%A9%9F%E8%83%BD\" class=\"autolink\" id=\"reference-905240904b9bd89f83c4\"\u003ehttp://qiita.com/mima_ita/items/55394bcc851eb8b6dc24#%E6%A7%98%E3%80%85%E3%81%AAassert%E6%A9%9F%E8%83%BD\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eまた、オブジェクトの内容をチェックする際は、それぞれのプロパティをAssertで愚直チェックをしてもいいですが、オブジェクトをJSONに変換してチェックする手もあります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTestData12\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTestDataItem\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eGroupName\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTestDataItem\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eItems\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestMethod12\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eexpData\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestData12\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eexpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroupName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Gp1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eexpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTestData12\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTestDataItem\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eexpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eTestData12\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTestDataItem\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1111\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"item1\"\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eexpData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eTestData12\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTestDataItem\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2222\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"item1\"\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eNewtonsoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eJson\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eJsonConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSerializeObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexpData\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"s\"\u003e\"{\\\"GroupName\\\":\\\"Gp1\\\",\\\"Items\\\":[{\\\"key\\\":1111,\\\"name\\\":\\\"item1\\\"},{\\\"key\\\":2222,\\\"name\\\":\\\"item1\\\"}]}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ejson\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれを実行するにはNewtonsoft.Jsonが必要になります。\u003cbr\u003e\n\u003ca href=\"http://www.newtonsoft.com/json\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://www.newtonsoft.com/json\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここで紹介した方法はあくまで基本です。\u003cbr\u003e\n個々のプロジェクト用に必要な検証用のユーティリティ関数を作成するといいでしょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"どれを自動化すべきか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%82%8C%E3%82%92%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%99%E3%81%B9%E3%81%8D%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどれを自動化すべきか？\u003c/h1\u003e\n\n\u003cp\u003e意識が高い系の記事なら、「全部、カバレッジ100％に決まっているだろ」とか言いだしますが、ここでは「工数と開発者のスキルしだい」という面白くもない解答になります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"単体テストの自動化自体がはじめての場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E8%87%AA%E4%BD%93%E3%81%8C%E3%81%AF%E3%81%98%E3%82%81%E3%81%A6%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e単体テストの自動化自体がはじめての場合\u003c/h2\u003e\n\n\u003cp\u003e単体テストの自動化が初めての場合は、簡単にできて効果の高い箇所をテストするといいでしょう。\u003cbr\u003e\nこれは他のクラスになるべく依存していない、ユーティリティ関数のテストです。\u003c/p\u003e\n\n\u003cp\u003estatic classの中から、なるべく多く機能で使用されているところから選定するといいでしょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"共通的な機能あるいは業務的に重要な機能\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%B1%E9%80%9A%E7%9A%84%E3%81%AA%E6%A9%9F%E8%83%BD%E3%81%82%E3%82%8B%E3%81%84%E3%81%AF%E6%A5%AD%E5%8B%99%E7%9A%84%E3%81%AB%E9%87%8D%E8%A6%81%E3%81%AA%E6%A9%9F%E8%83%BD\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e共通的な機能あるいは業務的に重要な機能\u003c/h2\u003e\n\n\u003cp\u003e次に単体テストを自動化して効果のある機能は多くの機能から呼ばれている機能です。\u003cbr\u003e\n多くのクラスのベースとなるクラスや、多くのクラスから参照される機能が対象になるでしょう。\u003c/p\u003e\n\n\u003cp\u003e単体テストを自動化することにより、仮にその共通機能に修正が入っても、他の機能に影響を与えないような修正になっていることを保証する回帰試験が容易になります。\u003c/p\u003e\n\n\u003cp\u003eまた、品質の確保においてシビアなものを要求される重要な機能においても単体テストを自動化するのは有効です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テストコードで保障されていない箇所を調べてテストコードを書く\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E4%BF%9D%E9%9A%9C%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E7%AE%87%E6%89%80%E3%82%92%E8%AA%BF%E3%81%B9%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテストコードで保障されていない箇所を調べてテストコードを書く\u003c/h2\u003e\n\n\u003cp\u003eVisualStudo2013のPremium以上もしくはVisualStudio2015のEnterpriseのエディションにはコードカバレッジを計測する機能がついています。\u003cbr\u003e\nこれにより、どの機能がテストコードにより実行されていないか調べることが可能です。\u003c/p\u003e\n\n\u003cp\u003e(1)[テスト]→[コードカバレッジの分析]→[すべてのテスト]を選択\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/46375fd56a995dcaa5403d9a2ec697623ad90d15/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f66343934643337312d653238332d343065312d386666342d3766396130623935653461652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Ff494d371-e283-40e1-8ff4-7f9a0b95e4ae.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=aa7a9ef97fd133d8c6414800fd5c732b\" alt=\"vs002.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/47856/f494d371-e283-40e1-8ff4-7f9a0b95e4ae.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Ff494d371-e283-40e1-8ff4-7f9a0b95e4ae.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=33de7e3f1c32633f669fac985a4f5715 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(2)コードカバレッジの結果が以下のように表示される。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/6297aafc623130b5fa2298a03b2b4d7770717c03/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f66666234663230352d623237632d643165352d323736652d3531343963383065643566322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Fffb4f205-b27c-d1e5-276e-5149c80ed5f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=caead8276dcab99f7aad673dbc64dc34\" alt=\"vs003.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/47856/ffb4f205-b27c-d1e5-276e-5149c80ed5f2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Fffb4f205-b27c-d1e5-276e-5149c80ed5f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d3844c3933f274c07f79dea6f09d55d0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e関数単位で未カバー（実行していない）箇所が出力される。\u003c/p\u003e\n\n\u003cp\u003e(3)結果の関数をクリックすると実行済みの行は青、未実行の行は赤で表示される。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/ce8dccf91bc8dc7343286f3010f1cf33e88e761d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f39653262306335652d626437392d396235642d306361332d3465653634613761333334342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F9e2b0c5e-bd79-9b5d-0ca3-4ee64a7a3344.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4cc0a6774d64e222b6d0b060b6e6f51c\" alt=\"vs004.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/47856/9e2b0c5e-bd79-9b5d-0ca3-4ee64a7a3344.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F9e2b0c5e-bd79-9b5d-0ca3-4ee64a7a3344.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ba26d90dc75c2ac98bb691ace45dd39b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれらの機能を利用して、未実行の行を探して、そこを通るようにテストコードを書いていきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"品質が悪そうな個所を探してテストコードを書く\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%93%81%E8%B3%AA%E3%81%8C%E6%82%AA%E3%81%9D%E3%81%86%E3%81%AA%E5%80%8B%E6%89%80%E3%82%92%E6%8E%A2%E3%81%97%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e品質が悪そうな個所を探してテストコードを書く\u003c/h2\u003e\n\n\u003cp\u003eある程度、経験を積むとマズイ書き方をしているコードはわかります。\u003cbr\u003e\nたとえば、以下のようなコードはヤバい臭いがぷんぷんとします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;++\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;++\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"XXX\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n       \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ZZZ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"nf\"\u003ehoge1\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n          \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003ehoge2\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n             \u003cspan class=\"nf\"\u003ehoge4\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003ehoge3\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n               \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003ehoge4\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                  \u003cspan class=\"nf\"\u003ehoge6\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n               \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e==\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"err\"\u003e　　　　　　　　　\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                 \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                 \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                 \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                 \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"nf\"\u003ehoge5\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n       \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"dddd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"nf\"\u003ehoge1\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n          \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003ehoge2\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n             \u003cspan class=\"nf\"\u003ehoge4\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003ehoge3\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n               \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003ehoge4\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                  \u003cspan class=\"nf\"\u003ehoge6\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n               \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e==\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n               \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"nf\"\u003ehoge5\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eしかしながら、「クソコードだから直せよ、凸助」というと刃傷沙汰になります。\u003cbr\u003e\nそういう、マズイ書き方をしている箇所を定量的に見つける手段として、「サイクロマティック複雑度」という指標が存在します。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e循環的複雑度（Cyclomatic complexity）\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://ja.wikipedia.org/wiki/%E5%BE%AA%E7%92%B0%E7%9A%84%E8%A4%87%E9%9B%91%E5%BA%A6\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://ja.wikipedia.org/wiki/%E5%BE%AA%E7%92%B0%E7%9A%84%E8%A4%87%E9%9B%91%E5%BA%A6\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e簡単にいうと、ループや分岐が多いほどこの複雑度は高くなります。\u003cbr\u003e\n1関数で25を超える場合、複雑度が極めて大きく、バグが潜んでいる可能性が高いです。\u003c/p\u003e\n\n\u003cp\u003eVisualStudioでは以下のようにサイクロマティック複雑度を計測します。\u003c/p\u003e\n\n\u003cp\u003e(1)[分析]→[ソリューションのコードメトリックスを計算]\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/3554f51b67ae066794f708b771c1e62689973370/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f61666662613635662d346663612d343238342d623132652d3934616230646466333336352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Faffba65f-4fca-4284-b12e-94ab0ddf3365.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d8c5be86530ac732dc750bc8bc633311\" alt=\"vs005.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/47856/affba65f-4fca-4284-b12e-94ab0ddf3365.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2Faffba65f-4fca-4284-b12e-94ab0ddf3365.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2015eefddd98836682ed66d8bf30f768 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(2)コードメトリックスの結果が表示される。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/9c06a4351af8c259f92b182a97b3390189fab955/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34373835362f32663638383134632d393663352d303465362d376538302d6433303437393030616439632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F2f68814c-96c5-04e6-7e80-d3047900ad9c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3e4f9f100f35630cb752436a747641bd\" alt=\"vs006.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/47856/2f68814c-96c5-04e6-7e80-d3047900ad9c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F47856%2F2f68814c-96c5-04e6-7e80-d3047900ad9c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7ebda9f854a4c395c18631a0baf885f0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eサイクロマティック複雑度は25未満に抑えるように実装するのが筋ですが、直せない場合は、これを超える箇所を集中的にテストコードを記述しましょう。\u003cbr\u003e\n（だいたいバグがでてくるはず）\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"自動テストはいつ書いて実行すべきか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%87%AA%E5%8B%95%E3%83%86%E3%82%B9%E3%83%88%E3%81%AF%E3%81%84%E3%81%A4%E6%9B%B8%E3%81%84%E3%81%A6%E5%AE%9F%E8%A1%8C%E3%81%99%E3%81%B9%E3%81%8D%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e自動テストはいつ書いて実行すべきか？\u003c/h1\u003e\n\n\u003cp\u003e実装しながらテストコードを書いたほうが楽です。\u003cbr\u003e\nすくなくともテストコードが書けるレベルのコードになります。\u003cbr\u003e\nそしてテストコードは最低毎日実行して、必ず全てのテストコードが合格するように監視してください。\u003c/p\u003e\n\n\u003cp\u003e人間は安易な方向に、あっさり流されます。\u003c/p\u003e\n\n\u003cp\u003eいくら、「どの環境でもテストが動くようにしろ」と言っても自分の環境でしか動かないテストコードはコミットされますし、「テストコードを動かして合格してからコミットしろ」といってもテストを不合格にするような安易な修正がコミットされます。\u003c/p\u003e\n\n\u003cp\u003eこれはなにをどうやっても防げません。\u003c/p\u003e\n\n\u003cp\u003eそしてそれを放置すると、動かないテストが大量に作成されて、単体テストの自動化が形骸化します。最悪[Ignore]属性を付与して無視する形でいいので、テストが合格しつづけることだけは死守しましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e「毎日テストを実行して、その結果が合格になるように維持し続ける」ということだけは、なにがなんでも死守してください。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コマンドラインからビルドしてテストを実行する方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%81%8B%E3%82%89%E3%83%93%E3%83%AB%E3%83%89%E3%81%97%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコマンドラインからビルドしてテストを実行する方法\u003c/h2\u003e\n\n\u003cp\u003e毎日実行しつづけるのに手でやるのはしんどいです。\u003cbr\u003e\nなので、コマンドラインから実行できるようにして、タスクスケジューラーかなにかで毎日実行するといいでしょう。\u003c/p\u003e\n\n\u003cp\u003e(1)MSBuildを使用してソリューションをビルドする\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"txt\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild TestSample.sln\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e(2)コマンドプロンプトからテストを実行する。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"txt\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e#環境変数の設定\n\"C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\Tools\\VsDevCmd.bat\"\n\n#テストの実行\nvstest.console.exe UnitTestProject1\\bin\\Debug\\UnitTestProject1.dll\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eコマンド ラインからの VSTest.console の使用\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/jj155800.aspx\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://msdn.microsoft.com/ja-jp/library/jj155800.aspx\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e可能ならJenkinsを使用するといいですが、手段は問わないので毎日実行して結果を監視しましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"どう説得するか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%81%86%E8%AA%AC%E5%BE%97%E3%81%99%E3%82%8B%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどう説得するか？\u003c/h1\u003e\n\n\u003cp\u003eテストコードを書くことを認めさせる方法としていくつかのケースが考えられます。\u003cbr\u003e\nここでは、その説得方法を考えてみましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テストコード書かないと単体テストができないケース\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E6%9B%B8%E3%81%8B%E3%81%AA%E3%81%84%E3%81%A8%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテストコード書かないと単体テストができないケース\u003c/h2\u003e\n\n\u003cp\u003eこのパターンが一番説得しやすいです。\u003cbr\u003e\nなぜならば、手動でテストができず、テストコードでしかテストできないので反論がしようがありません。\u003cbr\u003e\n代替手段のないことを提案するのが一番楽です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"外部の機能に依存しておりそれが完成していない場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%A4%96%E9%83%A8%E3%81%AE%E6%A9%9F%E8%83%BD%E3%81%AB%E4%BE%9D%E5%AD%98%E3%81%97%E3%81%A6%E3%81%8A%E3%82%8A%E3%81%9D%E3%82%8C%E3%81%8C%E5%AE%8C%E6%88%90%E3%81%97%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e外部の機能に依存しており、それが完成していない場合\u003c/h3\u003e\n\n\u003cp\u003eたとえば、外部の機能に依存しており、そのシステムが現在開発中で手動でテストできないケースを考えてみましょう。\u003c/p\u003e\n\n\u003cp\u003e従来であれば、結合テストまで先送りして地獄を味わいます。\u003cbr\u003e\nしかし、テストコードを書くならば、外部のシステムのインターフェイスをMoqまたはMicrosfotFakesで偽装して単体テストを行うことが可能になります。\u003c/p\u003e\n\n\u003cp\u003e結合テストでのリスクを事前に減らせるというのは大きな説得材料になるでしょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"大量のパターンがある場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%A4%A7%E9%87%8F%E3%81%AE%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e大量のパターンがある場合\u003c/h3\u003e\n\n\u003cp\u003eたとえばある関数の引数が取りうるパターンが数百、数千あったとします。\u003cbr\u003e\nこれは手動で実行するのは無理です。\u003c/p\u003e\n\n\u003cp\u003eしかしながら、テストコードであれば、パラメータを機械的に作成してテストコードを実行するだけなので有効です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"関連する機能もしくは自機能に変更が予測されテストを何回も行う必要があるケース\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%A2%E9%80%A3%E3%81%99%E3%82%8B%E6%A9%9F%E8%83%BD%E3%82%82%E3%81%97%E3%81%8F%E3%81%AF%E8%87%AA%E6%A9%9F%E8%83%BD%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%8C%E4%BA%88%E6%B8%AC%E3%81%95%E3%82%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E4%BD%95%E5%9B%9E%E3%82%82%E8%A1%8C%E3%81%86%E5%BF%85%E8%A6%81%E3%81%8C%E3%81%82%E3%82%8B%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e関連する機能、もしくは自機能に変更が予測されテストを何回も行う必要があるケース\u003c/h2\u003e\n\n\u003cp\u003e次善のパターンです。\u003cbr\u003e\nこのケースをもって説得する場合、以下の工数の勝負になります。\u003c/p\u003e\n\n\u003cp\u003e手動テストの工数：「一回の手動テストに係る工数」×「予測される変更回数」\u003cbr\u003e\n自動テストの工数：「テストコードを記述する工数」\u003c/p\u003e\n\n\u003cp\u003eこれを算出して金額の差額で、勝負しましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"品質で勝負するケース\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%93%81%E8%B3%AA%E3%81%A7%E5%8B%9D%E8%B2%A0%E3%81%99%E3%82%8B%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e品質で勝負するケース\u003c/h2\u003e\n\n\u003cp\u003eこれは分の悪い勝負です。\u003c/p\u003e\n\n\u003cp\u003eテストコードを書いた方が品質が良くなる傾向がありますが、それを費用体効果で表すのはかなり難しいですし、事前に説得する材料を持ってくるのは無理でしょう。\u003c/p\u003e\n\n\u003cp\u003eここで勝負するには、テストコードを書いた機能と書かなかった機能でバグ数/step数で比較することになりますが、この時点で手遅れなので、一手遅れます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"faq\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#faq\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eFAQ\u003c/h1\u003e\n\n\u003cp\u003eよくある質問をまとめます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"他の開発者がテストコードを書いてくれません\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BB%96%E3%81%AE%E9%96%8B%E7%99%BA%E8%80%85%E3%81%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%BE%E3%81%9B%E3%82%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e他の開発者がテストコードを書いてくれません。\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"作業者向けの答え\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作業者向けの答え\u003c/h3\u003e\n\n\u003cp\u003eそういうもんです。あきらめましょう。\u003cbr\u003e\n無理やり書かせても、やっつけ仕事で意味のない仕事をあげてくるだけです。\u003c/p\u003e\n\n\u003cp\u003eただし、他人が書かないのは、貴方が書かない理由にはなりません。\u003cbr\u003e\n少なくとも貴方は書けばいいです。\u003cbr\u003e\n貴方が書き続ける限りいずれ、カバレッジは100％に近づきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"管理者向けの答え\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e管理者向けの答え\u003c/h3\u003e\n\n\u003cp\u003e泣き言いっていないで、テストコードを書ける人間を調達するか、教育しましょう。\u003cbr\u003e\n学習期間を用意する、テストコードを書くための工数を用意する、テストコードが正しくかけたかチェックする工数を確保するのは管理職の職責です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"管理者がテストコードを書く工数を確保してくれません\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E3%81%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F%E5%B7%A5%E6%95%B0%E3%82%92%E7%A2%BA%E4%BF%9D%E3%81%97%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%BE%E3%81%9B%E3%82%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e管理者がテストコードを書く工数を確保してくれません。\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"作業者向けの答え-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作業者向けの答え\u003c/h3\u003e\n\n\u003cp\u003eそういうもんです。あきらめましょう。\u003cbr\u003e\n本当に、そのテストコードが必要だと思うなら作業進捗を過小報告して裏で書きましょう。\u003c/p\u003e\n\n\u003cp\u003e残念ながら、まっとうじゃない状況で、まっとうなことをしたかったら、まっとうじゃない手段をとるしかありません。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"管理者向けの答え-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e管理者向けの答え\u003c/h3\u003e\n\n\u003cp\u003e確保しましょう。\u003cbr\u003e\nどうしても確保できんのなら、優先度を考えて効果の高い部分だけ適用するのはどうでしょうか？\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"それでも私は周りにテストコードを書かせたいのです\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%82%8C%E3%81%A7%E3%82%82%E7%A7%81%E3%81%AF%E5%91%A8%E3%82%8A%E3%81%AB%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8B%E3%81%9B%E3%81%9F%E3%81%84%E3%81%AE%E3%81%A7%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eそれでも私は周りにテストコードを書かせたいのです。\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"作業者向けの答え-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作業者向けの答え\u003c/h3\u003e\n\n\u003cp\u003e権限のない人間が他人の行動を決めることはできません。\u003c/p\u003e\n\n\u003cp\u003eテストコードを書かない機能にバグがないなら、それはそれでうまくいっているので、無理にうまくいっている事を変更する必要がないでしょう。わりきりましょう。\u003c/p\u003e\n\n\u003cp\u003eバグが大量にあるなら、バグ報告をして、「品質に問題があるので是正処置をとる必要があります」という方向にもっていきましょう。\u003c/p\u003e\n\n\u003cp\u003eこの際、テストコードがある機能のバグ件数/Step数と比較してやれば、管理職はテストコードを書かないとまずいんじゃないかと思い始めます。\u003cbr\u003e\nその事実を10か20も積み重ねれば、組織としてテストコードを書くようになるか、テストコードを書ける奴を雇ってくるでしょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"管理者向けの答え-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e管理者向けの答え\u003c/h3\u003e\n\n\u003cp\u003eこんなもん読んでないで、さっさと人を教育するか適切な人雇う手筈を考えた方がいいでしょう。\u003cbr\u003e\n貴方の組織の問題は貴方でないと解決できません。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テストコード書いてくれるのですが合格しないコードをコミットしやがります\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%8F%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%A7%E3%81%99%E3%81%8C%E5%90%88%E6%A0%BC%E3%81%97%E3%81%AA%E3%81%84%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E3%81%97%E3%82%84%E3%81%8C%E3%82%8A%E3%81%BE%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテストコード書いてくれるのですが、合格しないコードをコミットしやがります\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"作業者向けの答え-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作業者向けの答え\u003c/h3\u003e\n\n\u003cp\u003eそういうもんです。あきらめましょう。\u003c/p\u003e\n\n\u003cp\u003e毎日、全体メールで\u003cstrong\u003e「偉い管理職」\u003c/strong\u003eでもまぜて不合格の旨を通知しつづけましょう。\u003cbr\u003e\nそのうち折れて直してきます。直さなくても管理職が問題視して勝手に対応してくれます。\u003c/p\u003e\n\n\u003cp\u003e放置されるようなら徐々に上役をCCにまぜていくといいでしょう。最後の偉い人まで行って放置されるなら、その組織の命数はもう長くないので、「プログラマがプロジェクトを救おうなどとおこがましいとは思わんかね？」とでも、ご自身に言い聞かせて、辞める準備をしましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"管理者向けの答え-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e管理者向けの答え\u003c/h3\u003e\n\n\u003cp\u003eテストが通らないコードはコミットさせないという運用ルールを作って周知します。\u003c/p\u003e\n\n\u003cp\u003e可能なら、テストコードが適切に動作しているかチェックする人間を任命しましょう。\u003cbr\u003e\n当然、通常の作業量を減らすべきです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テストコードが書きずらいです\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%81%8C%E6%9B%B8%E3%81%8D%E3%81%9A%E3%82%89%E3%81%84%E3%81%A7%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテストコードが書きずらいです。\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"作業者向けの答え-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作業者向けの答え\u003c/h3\u003e\n\n\u003cp\u003eGUI、マルチスレッドなどはたしかにテストコードは書きずらいので、そういう単体テストに向かないところはテストコードを書かないのも手です。\u003c/p\u003e\n\n\u003cp\u003eそういう理由がないのに、テストコードが書きずらいのは単純に実装がへたくそなだけです。\u003cbr\u003e\n自分が書いた実装ならテストが書けるように直しましょう。\u003c/p\u003e\n\n\u003cp\u003e他人が書いた実装なら、バグを淡々と報告して、「作り直した方がはやい」ということを上に理解させましょう。\u003cbr\u003e\nたぶん、そういう実装を仕上げてくる方の成果物の品質は極めて悪いので、簡単にバグを見つけることができます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"管理職向けの答え\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%81%B7%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e管理職向けの答え\u003c/h3\u003e\n\n\u003cp\u003e特別の理由がない場合、実装が不味い可能性があります。\u003cbr\u003e\nサイクロマティック複雑度の計測をしてみてください。\u003cbr\u003e\n異常な値が出た場合は、残念ながらその機能はバグを含んでいる可能性が極めて高いです。\u003cbr\u003e\n別の人間にプロダクトコードの修正をできる権限をあたえて見直しをさせた方がいいでしょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"単体テストを自動化する意味がわかりません\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%99%E3%82%8B%E6%84%8F%E5%91%B3%E3%81%8C%E3%82%8F%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e単体テストを自動化する意味がわかりません\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"作業者向けの答え-5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作業者向けの答え\u003c/h3\u003e\n\n\u003cp\u003e作りっぱなしで、終われる仕事だけしていればいいというなら、その考えもよろしいんじゃないでしょうか。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"管理職向けの答え-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%81%B7%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e管理職向けの答え\u003c/h3\u003e\n\n\u003cp\u003eしょせん、コストと効果のトレードオフにしかすぎません。\u003cbr\u003e\n変更が発生する頻度と１回のテストの手間で、解答がかわります。\u003cbr\u003e\nプロジェクトの性質によっては、その答えになるのも已む得ないでしょう。\u003c/p\u003e\n\n\u003cp\u003eただし、もし、あらゆる状況で意味がないというお考えならば、そもそも「ソフトウェア」の管理には向いていない疑義があります。\u003c/p\u003e\n","createdAt":"2016-11-20T09:48:14Z","elapsedYearsFromLastModifiedAt":4,"encryptedId":"U18Zzuj0/dptVFU2/I58iHQA1OGC3L+2--wR3PAaSX8THCOR60--GAkuDEd3O2qGv854GD0rNQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2016-11-20T10:04:29Z","likesCount":316,"linkUrl":"https://qiita.com/mima_ita/items/05ce44c3eb1fd6e9dd46","organization":null,"originalId":439739,"stockedCount":378,"title":"意識が高くないVisualStudioを使用した単体テストの自動化","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%AE%E7%9B%AE%E7%9A%84\"\u003e単体テストの自動化の目的\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%81%A9%E3%81%93%E3%81%A7%E3%82%82%E4%BD%95%E6%99%82%E3%81%A7%E3%82%82%E5%AE%9F%E8%A1%8C%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E5%AE%9F%E8%A1%8C%E3%81%A7%E3%81%8D%E3%82%8B%E5%89%8D%E6%8F%90%E3%82%92%E4%BD%9C%E3%82%8B\"\u003eテスト対象が「どこ」でも「何時」でも実行できるように実行できる前提を作る\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\"\u003eテスト対象を実行する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E5%AF%BE%E8%B1%A1%E3%81%8C%E6%AD%A3%E3%81%97%E3%81%8F%E5%8B%95%E4%BD%9C%E3%81%97%E3%81%9F%E3%81%8B%E6%A4%9C%E8%A8%BC%E3%81%99%E3%82%8B\"\u003eテスト対象が正しく動作したか検証する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%82%8C%E3%82%92%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%99%E3%81%B9%E3%81%8D%E3%81%8B\"\u003eどれを自動化すべきか？\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E8%87%AA%E4%BD%93%E3%81%8C%E3%81%AF%E3%81%98%E3%82%81%E3%81%A6%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e単体テストの自動化自体がはじめての場合\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%B1%E9%80%9A%E7%9A%84%E3%81%AA%E6%A9%9F%E8%83%BD%E3%81%82%E3%82%8B%E3%81%84%E3%81%AF%E6%A5%AD%E5%8B%99%E7%9A%84%E3%81%AB%E9%87%8D%E8%A6%81%E3%81%AA%E6%A9%9F%E8%83%BD\"\u003e共通的な機能あるいは業務的に重要な機能\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E4%BF%9D%E9%9A%9C%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E7%AE%87%E6%89%80%E3%82%92%E8%AA%BF%E3%81%B9%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"\u003eテストコードで保障されていない箇所を調べてテストコードを書く\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%93%81%E8%B3%AA%E3%81%8C%E6%82%AA%E3%81%9D%E3%81%86%E3%81%AA%E5%80%8B%E6%89%80%E3%82%92%E6%8E%A2%E3%81%97%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"\u003e品質が悪そうな個所を探してテストコードを書く\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%87%AA%E5%8B%95%E3%83%86%E3%82%B9%E3%83%88%E3%81%AF%E3%81%84%E3%81%A4%E6%9B%B8%E3%81%84%E3%81%A6%E5%AE%9F%E8%A1%8C%E3%81%99%E3%81%B9%E3%81%8D%E3%81%8B\"\u003e自動テストはいつ書いて実行すべきか？\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%81%8B%E3%82%89%E3%83%93%E3%83%AB%E3%83%89%E3%81%97%E3%81%A6%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"\u003eコマンドラインからビルドしてテストを実行する方法\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%81%86%E8%AA%AC%E5%BE%97%E3%81%99%E3%82%8B%E3%81%8B\"\u003eどう説得するか？\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E6%9B%B8%E3%81%8B%E3%81%AA%E3%81%84%E3%81%A8%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E3%82%B1%E3%83%BC%E3%82%B9\"\u003eテストコード書かないと単体テストができないケース\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%A4%96%E9%83%A8%E3%81%AE%E6%A9%9F%E8%83%BD%E3%81%AB%E4%BE%9D%E5%AD%98%E3%81%97%E3%81%A6%E3%81%8A%E3%82%8A%E3%81%9D%E3%82%8C%E3%81%8C%E5%AE%8C%E6%88%90%E3%81%97%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88\"\u003e外部の機能に依存しており、それが完成していない場合\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%A4%A7%E9%87%8F%E3%81%AE%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88\"\u003e大量のパターンがある場合\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%A2%E9%80%A3%E3%81%99%E3%82%8B%E6%A9%9F%E8%83%BD%E3%82%82%E3%81%97%E3%81%8F%E3%81%AF%E8%87%AA%E6%A9%9F%E8%83%BD%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%8C%E4%BA%88%E6%B8%AC%E3%81%95%E3%82%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E4%BD%95%E5%9B%9E%E3%82%82%E8%A1%8C%E3%81%86%E5%BF%85%E8%A6%81%E3%81%8C%E3%81%82%E3%82%8B%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e関連する機能、もしくは自機能に変更が予測されテストを何回も行う必要があるケース\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%93%81%E8%B3%AA%E3%81%A7%E5%8B%9D%E8%B2%A0%E3%81%99%E3%82%8B%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e品質で勝負するケース\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#faq\"\u003eFAQ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BB%96%E3%81%AE%E9%96%8B%E7%99%BA%E8%80%85%E3%81%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%BE%E3%81%9B%E3%82%93\"\u003e他の開発者がテストコードを書いてくれません。\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88\"\u003e作業者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88\"\u003e管理者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E3%81%8C%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F%E5%B7%A5%E6%95%B0%E3%82%92%E7%A2%BA%E4%BF%9D%E3%81%97%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%BE%E3%81%9B%E3%82%93\"\u003e管理者がテストコードを書く工数を確保してくれません。\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1\"\u003e作業者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1\"\u003e管理者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%82%8C%E3%81%A7%E3%82%82%E7%A7%81%E3%81%AF%E5%91%A8%E3%82%8A%E3%81%AB%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8B%E3%81%9B%E3%81%9F%E3%81%84%E3%81%AE%E3%81%A7%E3%81%99\"\u003eそれでも私は周りにテストコードを書かせたいのです。\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-2\"\u003e作業者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-2\"\u003e管理者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%8F%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%A7%E3%81%99%E3%81%8C%E5%90%88%E6%A0%BC%E3%81%97%E3%81%AA%E3%81%84%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E3%81%97%E3%82%84%E3%81%8C%E3%82%8A%E3%81%BE%E3%81%99\"\u003eテストコード書いてくれるのですが、合格しないコードをコミットしやがります\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-3\"\u003e作業者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-3\"\u003e管理者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%81%8C%E6%9B%B8%E3%81%8D%E3%81%9A%E3%82%89%E3%81%84%E3%81%A7%E3%81%99\"\u003eテストコードが書きずらいです。\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-4\"\u003e作業者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%81%B7%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88\"\u003e管理職向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8D%98%E4%BD%93%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%99%E3%82%8B%E6%84%8F%E5%91%B3%E3%81%8C%E3%82%8F%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93\"\u003e単体テストを自動化する意味がわかりません\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E8%80%85%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-5\"\u003e作業者向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AE%A1%E7%90%86%E8%81%B7%E5%90%91%E3%81%91%E3%81%AE%E7%AD%94%E3%81%88-1\"\u003e管理職向けの答え\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":120018,"uuid":"05ce44c3eb1fd6e9dd46","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"iKquGH0Rl92sSVHKXw28wt9BhIc=--PPLsTkw9caeS7FcS--4y1q3ERrCWqYZXl0VmuIQA==","originalId":47856,"description":"","facebookUrl":null,"githubUrl":"https://github.com/mima3","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/47856/0bc42d42eada368803d4098295f823130ecc5364/large.png?1571128517","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F47856%2F0bc42d42eada368803d4098295f823130ecc5364%2Flarge.png%3F1571128517?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=70713a14624753789e86c81ae02cf59f","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F47856%2F0bc42d42eada368803d4098295f823130ecc5364%2Flarge.png%3F1571128517?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=aaca39e8c7ebef06bbfb64132a188a53","urlName":"mima_ita","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"TDD","urlName":"tdd"},{"name":"C#","urlName":"csharp"},{"name":".NET","urlName":".net"},{"name":"VisualStudio","urlName":"visualstudio"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
