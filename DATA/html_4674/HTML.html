<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Unity 3DでUpdateとFixedUpdate間のタイミングを考慮したジャンプ（基礎） - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/mkgask/items/6d04d0be13cc0b14d4fb" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="bulOB/g3FfNS+HeoB3ZglfJNhgXomwsxJTD6+uXAzdGcQDdU5mhp7ngXfizAyLWxFgwKVNMkVea9zsPBrA6MDg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@mkgask" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="Unity 3DでUpdateとFixedUpdate間のタイミングを考慮したジャンプ（基礎） - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhrZ00wVGpnYWRWY0dSaGRHWGpnYWhHYVhobFpGVndaR0YwWmVtV2stT0JydU9Ddi1PQ3BPT0RuLU9Ecy1PQ3NPT0NrdWlBZy1hRnJ1T0JsLU9Cbi1PQ3VPT0RvLU9Ecy1PRGwtLThpT1dmdXVla2p1LThpUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0wMDhhMmQwZTViYjExODZjYjE4ODgxODg1MTlmOTVmZQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFyWjJGemF3JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9OGY4YjNmNTEzZmQzNWJjZmM5NGQwNWZlOGY3ZTE1NDY&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=d504cb2c9dba8c2c74e0932cfa49c64e"><meta property="og:description" content="

はじめに

Unity 3Dでのジャンプの長さが変わってもちゃんと動くアニメーション対応のジャンプ処理の記事を書こうと思ったのですが、その前にUnity 3Dでのジャンプ処理自体を取り扱っている記事が少なそうなので、基礎的なところ..."><meta content="https://qiita.com/mkgask/items/6d04d0be13cc0b14d4fb" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,ジャンプ" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-7a32b65d-14c8-4da3-b6e6-83a52c13be24"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fmkgask%2Fitems%2F6d04d0be13cc0b14d4fb">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fmkgask%2Fitems%2F6d04d0be13cc0b14d4fb">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-7a32b65d-14c8-4da3-b6e6-83a52c13be24">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-09-02T23:05:52.000+09:00","dateModified":"2019-06-21T00:59:20.000+09:00","headline":"Unity 3DでUpdateとFixedUpdate間のタイミングを考慮したジャンプ（基礎）","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhrZ00wVGpnYWRWY0dSaGRHWGpnYWhHYVhobFpGVndaR0YwWmVtV2stT0JydU9Ddi1PQ3BPT0RuLU9Ecy1PQ3NPT0NrdWlBZy1hRnJ1T0JsLU9Cbi1PQ3VPT0RvLU9Ecy1PRGwtLThpT1dmdXVla2p1LThpUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0wMDhhMmQwZTViYjExODZjYjE4ODgxODg1MTlmOTVmZQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFyWjJGemF3JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9OGY4YjNmNTEzZmQzNWJjZmM5NGQwNWZlOGY3ZTE1NDY\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=d504cb2c9dba8c2c74e0932cfa49c64e","mainEntityOfPage":"https://qiita.com/mkgask/items/6d04d0be13cc0b14d4fb","author":{"@type":"Person","address":"だがね","email":null,"identifier":"mkgask","name":"mkgask","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F72594%2Fprofile-images%2F1473699207?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13e12b10c92fd48268dbffad96bda4d6","url":"https://qiita.com/mkgask","description":"業務ではPHP触りつつ趣味ではUnity C#とPythonで遊んでいます。\r\n何か色々やってるのでフォローにはご注意くださいヾ( ╹◡╹)ﾉﾞ ","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mkgask","type":"items","id":"6d04d0be13cc0b14d4fb"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mkgask","type":"items","id":"6d04d0be13cc0b14d4fb"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mkgask","type":"items","id":"6d04d0be13cc0b14d4fb"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/mkgask/items/6d04d0be13cc0b14d4fb","location":"/mkgask/items/6d04d0be13cc0b14d4fb","scheme":"https","host":"qiita.com","port":null,"pathname":"/mkgask/items/6d04d0be13cc0b14d4fb","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"lVO7I29NuFZrTDWSZI70HW6s6d32e45bUrKIhuXKcstn+sJwcRLES0GjPBajMCE5iu1ljM3E0IzKTLG9rAQzFA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-c4f5ac84-fbd2-4098-aca8-937597a33b64"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mkgask/items/6d04d0be13cc0b14d4fb/likers" class="css-1iupg5d">18</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">17</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6d04d0be13cc0b14d4fb/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mkgask/items/6d04d0be13cc0b14d4fb/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mkgask/items/6d04d0be13cc0b14d4fb/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mkgask/items/6d04d0be13cc0b14d4fb/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mkgask/items/6d04d0be13cc0b14d4fb.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/mkgask"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/72594/profile-images/1473699207" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/mkgask" class="css-10ougpm">@<!-- -->mkgask</a><div class="css-1ay9vb9"><span><meta content="2018-09-02T14:05:52Z"/><time dateTime="2019-06-20T15:59:20Z" class="css-m19uds">updated at 2019-06-20</time></span></div></div></div></div></div><h1 class="css-cgzq40">Unity 3DでUpdateとFixedUpdate間のタイミングを考慮したジャンプ（基礎）</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/%e3%82%b8%e3%83%a3%e3%83%b3%e3%83%97" class="css-4czcte">ジャンプ</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>Unity 3Dでのジャンプの長さが変わってもちゃんと動くアニメーション対応のジャンプ処理の記事を書こうと思ったのですが、その前にUnity 3Dでのジャンプ処理自体を取り扱っている記事が少なそうなので、基礎的なところを先に書いていきます。<br>
（Qiitaに少なそうなだけでggればいろいろ出てくると思いますが）</p>

<p><em>（2018/09/16追記：色々って言うわりにUpdateとFixedUpdateの説明しか書いてないので記事名を変更）</em><br>
<em>（最初の記事名は「Unity 3Dで色々考慮したジャンプ（基礎）」でした）</em></p>

<h1>
<span id="確認した環境" class="fragment"></span><a href="#%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%9F%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>確認した環境</h1>

<ul>
<li>Windows 10</li>
<li>Unity 2018.2.4f1</li>
<li>プレイヤーキャラクターに <a href="http://unity-chan.com/" rel="nofollow noopener" target="_blank">Unity Technologies Japanオリジナルキャラクター Unityちゃん</a> を利用</li>
</ul>

<h1>
<span id="ベース環境作成" class="fragment"></span><a href="#%E3%83%99%E3%83%BC%E3%82%B9%E7%92%B0%E5%A2%83%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>ベース環境作成</h1>

<p>スクリプトに入る前に、プロジェクトをゼロから作っておきます。</p>

<h2>
<span id="プロジェクト作成" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>プロジェクト作成</h2>

<p>ご利用のUnityで新規プロジェクトを作成してください。</p>

<p>タイトルは何でも良いのですが、筆者は今回は JumpTest と付けました。</p>

<h2>
<span id="床作成" class="fragment"></span><a href="#%E5%BA%8A%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>床作成</h2>

<p>とりあえずの床として Plane を作成します。名前はFloorとします。</p>

<p><a href="https://camo.qiitausercontent.com/890e4fcd0ea71161993ad31e865f3bb8779b470b/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363436322d64323166653830302d616566662d313165382d396230362d3562353238343135356635612e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956462-d21fe800-aeff-11e8-9b06-5b5284155f5a.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9b50d4a6475a88f045609729d71c1894" alt="2" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956462-d21fe800-aeff-11e8-9b06-5b5284155f5a.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956462-d21fe800-aeff-11e8-9b06-5b5284155f5a.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bd18b722bc1d2df80fc1f0130d7d8fcb 1x" loading="lazy"></a></p>

<h2>
<span id="unityちゃん導入" class="fragment"></span><a href="#unity%E3%81%A1%E3%82%83%E3%82%93%E5%B0%8E%E5%85%A5"><i class="fa fa-link"></i></a>Unityちゃん導入</h2>

<p>Unityちゃんモデルの入手方法が、<a href="http://unity-chan.com/" rel="nofollow noopener" target="_blank">公式からのダウンロード</a>と<a href="https://assetstore.unity.com/packages/3d/characters/unity-chan-model-18705" rel="nofollow noopener" target="_blank">アセットストアからのもの</a>と2種類あるんですが、公式からダウンロードしてきてimportしたほうがバージョンが新しいようです。</p>

<p><a href="https://camo.qiitausercontent.com/dc6204989795543b2888deadaec3ef9e8c21d78f/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363436372d64653062616130302d616566662d313165382d383235612d3263396434313535613232362e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956467-de0baa00-aeff-11e8-825a-2c9d4155a226.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=730727e7b577875f92bb4c1cd0e22cde" alt="3" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956467-de0baa00-aeff-11e8-825a-2c9d4155a226.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956467-de0baa00-aeff-11e8-825a-2c9d4155a226.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=568bd295c56b21ef0dc8921a79a163ed 1x" loading="lazy"></a></p>

<p>アセットストアのものはバージョン 1.1</p>

<p><a href="https://camo.qiitausercontent.com/8f4a29dc590cf62898d687b75da8992d4b6eb6d5/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363436392d65353332623830302d616566662d313165382d383132312d3765363031396564643233352e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956469-e532b800-aeff-11e8-8121-7e6019edd235.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=fb16a3b170a2da282c9595cb3bd5b28b" alt="4-2" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956469-e532b800-aeff-11e8-8121-7e6019edd235.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956469-e532b800-aeff-11e8-8121-7e6019edd235.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fbf487914c8fdf9387518988fe5de3e1 1x" loading="lazy"></a></p>

<p>公式は1.2.1です。</p>

<p><a href="https://camo.qiitausercontent.com/49b46ba64fcff0c52e0a4070818f1d22eca1496a/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363437322d65643861663330302d616566662d313165382d393636662d6336303664393531656232392e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956472-ed8af300-aeff-11e8-966f-c606d951eb29.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=71065b37f7060179485de6f234c0c0ef" alt="5" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956472-ed8af300-aeff-11e8-966f-c606d951eb29.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956472-ed8af300-aeff-11e8-966f-c606d951eb29.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fbbee93bbcb45334c027f4167c6598bf 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/b4f5cfbacb1f2b19f83d1eb7ee1513963872714e/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363437362d66343139366138302d616566662d313165382d393135322d3439653337396435383362662e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956476-f4196a80-aeff-11e8-9152-49e379d583bf.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d4263b2b4baff02370e399017e7c0c4e" alt="6" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956476-f4196a80-aeff-11e8-9152-49e379d583bf.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956476-f4196a80-aeff-11e8-9152-49e379d583bf.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=96e23890b6a6094ac42214ccb200e51b 1x" loading="lazy"></a></p>

<p>Modelsディレクトリの中の unitychan をヒエラルキーに追加します。</p>

<p><a href="https://camo.qiitausercontent.com/6b57387ae4cf9bbb6ecf7f0dceea5fa050cd95cf/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363437392d30353632373730302d616630302d313165382d396166642d3439383162383534393731612e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956479-05627700-af00-11e8-9afd-4981b854971a.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=757ef8445c0451974af2db305365a5aa" alt="7" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956479-05627700-af00-11e8-9afd-4981b854971a.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956479-05627700-af00-11e8-9afd-4981b854971a.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1931ee6d4c90774553e164fbc009ea9f 1x" loading="lazy"></a></p>

<h1>
<span id="プレイヤーキャラクターのgameobjectに各種コンポーネントを設定" class="fragment"></span><a href="#%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%AD%E3%83%A3%E3%83%A9%E3%82%AF%E3%82%BF%E3%83%BC%E3%81%AEgameobject%E3%81%AB%E5%90%84%E7%A8%AE%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>プレイヤーキャラクターのGameObjectに各種コンポーネントを設定</h1>

<h2>
<span id="animator" class="fragment"></span><a href="#animator"><i class="fa fa-link"></i></a>Animator</h2>

<p>unitychan のGameObjectにはAnimatorコンポーネントが1つだけアタッチされていますが、今回は使わないので削除します。</p>

<p><a href="https://camo.qiitausercontent.com/7d67501ab1cdc86b0c25b521ac66495e2341cbee/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363438322d31316536636638302d616630302d313165382d393636312d6132626631346236396564392e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956482-11e6cf80-af00-11e8-9661-a2bf14b69ed9.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=df734560c063b8cbbc148243717c0013" alt="8" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956482-11e6cf80-af00-11e8-9661-a2bf14b69ed9.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956482-11e6cf80-af00-11e8-9661-a2bf14b69ed9.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d2ed1cfbbb2c5d09d9f9c018bc05736c 1x" loading="lazy"></a></p>

<h2>
<span id="capsule-collier" class="fragment"></span><a href="#capsule-collier"><i class="fa fa-link"></i></a>Capsule Collier</h2>

<p>今の状態では接触判定がありませんのでCapsule Collierを追加します。</p>

<p>何かコライダーがあれば接触判定は可能ですが、人型のオブジェクトには形状的にCapsule Collierが適しているので、これをアタッチします。<br>
（Capsule Colliderの端の球面のせいで接触判定に支障が出る場合は、Box Colliderでも十分代用が効きます。筆者は壁際に落ちてる細長いもの（剣とか棒とか）に接触出来なくて拾えなかったことがあります）</p>

<p>アタッチしたままではUnityちゃんの足元にだけ判定が出てしまうので、設定を行います。</p>

<p>InspectorのCenterでコライダーの中心をUnityちゃんの中心にあわせて、Heightでコライダーの高さをUnityちゃんの身長にあわせ、Radiusで半径を調整します。</p>

<p><a href="https://camo.qiitausercontent.com/91395753626992de39d669f3d2b2951456fc73d1/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363439352d32343631303930302d616630302d313165382d393735632d3734633837663965363564662e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956495-24610900-af00-11e8-975c-74c87f9e65df.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6b345c8242b72db79d33b8a4238078a0" alt="10" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956495-24610900-af00-11e8-975c-74c87f9e65df.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956495-24610900-af00-11e8-975c-74c87f9e65df.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2492e356f3fc4c78480c71df4b610bb2 1x" loading="lazy"></a></p>

<h2>
<span id="rigidbody" class="fragment"></span><a href="#rigidbody"><i class="fa fa-link"></i></a>Rigidbody</h2>

<p>物理法則に則った動作をしてもらうために、Rigidbodyも追加します。</p>

<p>そのままだとキャラクターがコケて倒れてしまったりなどするので、Constrainsの中にあるFreeze RotationでxとzのチェックをONし、倒れてしまう向きの回転を停止します。<br>
TransformのRotationのところをドラッグで数値を変更すると、どの値がどの向きの回転なのか分かります。yは横方向の回転のみなので、固定しなくても大丈夫です。</p>

<p><a href="https://camo.qiitausercontent.com/81e5ce19ebb1792e277da5ce8a0ddf50410ded50/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363530302d33326166323530302d616630302d313165382d393239662d6163363332633930323032652e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956500-32af2500-af00-11e8-929f-ac632c90202e.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4366fade411b81977de11f0441f91b37" alt="11" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956500-32af2500-af00-11e8-929f-ac632c90202e.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956500-32af2500-af00-11e8-929f-ac632c90202e.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6ae075b72c370372ea752451bbeb27f1 1x" loading="lazy"></a></p>

<h1>
<span id="スクリプト作成" class="fragment"></span><a href="#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>スクリプト作成</h1>

<p>これで基本の設定は完了したので、スクリプトを作成しますが、ここでまた考えないといけないことがあります。</p>

<p>Update()とFixedUpdate()の違いについてで、皆さんご存知のことと思いますが、Update()とFixedUpdate()は実行されるタイミングとするべき処理が違います。</p>

<p>UnityではUpdate()のFPSはデフォルトではディスプレイの垂直同期に同期します。<br>
一般的なディスプレイでは60Hzですが、VRゴーグルでは90Hzが多いようです。<br>
ゲーミングディスプレイの場合は120Hzや144Hzの場合もあり、現行機種で最も速いものは240Hzのものが出ています。数年すると300Hzが出てくるのではとも言われています。<br>
（Project Settings -&gt; Quality -&gt; V Sync Count）</p>

<p>FixedUpdate()はUpdate()とは独立したタイマーで固定時間毎に実行され、Unityで設定した通りのFPSで呼ばれます。デフォルトでは50fpsです。<br>
（Project Settings -&gt; Time -&gt; Fixed Timestep）</p>

<p>そして、Update()で入力処理を行わなければならず、FixedUpdate()で物理演算の処理を行う必要があることもご存知のことと思います。</p>

<p>スクリプトはこの2点について十分に留意して作成する必要があります。</p>

<p>垂直同期との同期をOFFにして目標FPSを別で設定する方法もありますが、参考資料にリンクを置いておくのでそちらのほうが良い方は各自ご確認ください。</p>

<h2>
<span id="タイミング概念図" class="fragment"></span><a href="#%E3%82%BF%E3%82%A4%E3%83%9F%E3%83%B3%E3%82%B0%E6%A6%82%E5%BF%B5%E5%9B%B3"><i class="fa fa-link"></i></a>タイミング概念図</h2>

<p><a href="https://camo.qiitausercontent.com/04be35faa0f112c7e1a3cebc0e76e6a6298b4e9f/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363530332d34343930633830302d616630302d313165382d386431632d3939343463313030333331302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956503-4490c800-af00-11e8-8d1c-9944c1003310.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=84b800f3d160de56fbaae3de83dc55de" alt="1" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956503-4490c800-af00-11e8-8d1c-9944c1003310.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956503-4490c800-af00-11e8-8d1c-9944c1003310.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f16d4fdfe5f1238d17f25dc73ef09027 1x" loading="lazy"></a></p>

<p>上図はUpdate()が60fps、FixedUpdate()が50fpsと仮定して、数回に1回Update()が2回くるタイミングがある図です。</p>

<p>Update()のフレームレートが上がると、もちろんUpdate()の介入回数が増えます。</p>

<p><a href="https://camo.qiitausercontent.com/9ca6503169e4e8626c0130c7791e24d5dd0a02cb/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363530372d35356439643438302d616630302d313165382d386131642d6237626564353632306533652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956507-55d9d480-af00-11e8-8a1d-b7bed5620e3e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ff5dc00353d72b00d63994649e4099a6" alt="2" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956507-55d9d480-af00-11e8-8a1d-b7bed5620e3e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956507-55d9d480-af00-11e8-8a1d-b7bed5620e3e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=026214cdddd11af60ad7e921492881e5 1x" loading="lazy"></a></p>

<p>120Hzまたは144Hzの場合は、だいたいUpdate()2回にFixedUpdate()が1回あり、時々Update()が3回ある、という形になります。</p>

<p><a href="https://camo.qiitausercontent.com/cb1fcf13bacc6a2121152433c3bb547e2f709f45/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363531302d35663633336338302d616630302d313165382d393266392d6134666162656139353762662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956510-5f633c80-af00-11e8-92f9-a4fabea957bf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a1b0cc0b08da3ba39ce8c56735aa8f37" alt="3" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956510-5f633c80-af00-11e8-92f9-a4fabea957bf.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956510-5f633c80-af00-11e8-92f9-a4fabea957bf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=05a441b047af6fc510a9b245e80c37cd 1x" loading="lazy"></a></p>

<p>240Hzでは4回に1回になり、時々5回になります。<br>
極端な例ですが、ディスプレイと設定次第で既に現実に起こり得るものです。</p>

<p>Update()でジャンプ入力が複数フレーム続き、次のFixedUpdate()のタイミングでジャンプ入力が終わってしまっていても1回だけジャンプ処理される、という処理にしなければなりません。</p>

<h2>
<span id="ジャンプ処理の設計" class="fragment"></span><a href="#%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%97%E5%87%A6%E7%90%86%E3%81%AE%E8%A8%AD%E8%A8%88"><i class="fa fa-link"></i></a>ジャンプ処理の設計</h2>

<p>以上の注意点とタイミング図からジャンプの設計は以下の通りとします。</p>

<ul>
<li>ジャンプ入力は、次のFixedUpdate()まで記憶する</li>
<li>ジャンプ入力の記憶は、ジャンプ入力が複数回あっても一つだけ記憶し、FixedUpdate()が来るまではジャンプ入力が終了しても記憶したままとする</li>
<li>ジャンプ入力の記憶がある間は再ジャンプ入力は受け付けない</li>
<li>ジャンプ処理が終わって着地したタイミングでジャンプ入力の記憶を消去する</li>
<li>FixedUpdate()ではジャンプ入力の記憶を見てジャンプ処理を開始する</li>
<li>ただし、このジャンプ入力の記憶は着地するまでずっとONのままなので、
FixedUpdate()内での再ジャンプ処理を禁止するための内部用の別のフラグが必要</li>
<li>内部用のフラグはFixedUpdate()内でジャンプ処理開始時にONし、着地時にOFFする</li>
</ul>

<p>だいたいこんな感じになっていれば、多重にジャンプ処理が行われてしまうことがなくなるはずです。</p>

<h2>
<span id="スクリプト" class="fragment"></span><a href="#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88"><i class="fa fa-link"></i></a>スクリプト</h2>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">PlayerController.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.Events</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">PlayerController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    ジャンプ処理に使用するRigidbody</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="n">Rigidbody</span> <span class="n">_rigidBody</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    ジャンプ入力フラグ</span>
    <span class="c1">///    ジャンプ入力が一度でもあったらON、着地したらOFF</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">bool</span> <span class="n">_jumpInput</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    ジャンプ処理中フラグ</span>
    <span class="c1">///    ジャンプ処理が開始されたらON、着地したらOFF</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">bool</span> <span class="n">_isJumping</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>


    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    Start()</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_rigidBody</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody</span><span class="p">&gt;();</span>
    <span class="p">}</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    Update()</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">CheckGroundDistance</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="n">_jumpInput</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="n">_isJumping</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">});</span>

        <span class="c1">// 既にジャンプ入力が行われていたら、ジャンプ入力チェックを飛ばす</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_jumpInput</span> <span class="p">||</span> <span class="nf">JumpInput</span><span class="p">())</span> <span class="n">_jumpInput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    FixedUpdate()</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">FixedUpdate</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_jumpInput</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">_isJumping</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">_isJumping</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="nf">DoJump</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    ジャンプ入力チェック</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">JumpInput</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ジャンプ最速入力のテスト用にGetButton</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="nf">GetButton</span><span class="p">(</span><span class="s">"Jump"</span><span class="p">))</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>    <span class="c1">// ジャンプキー押しっぱなしで連続ジャンプ</span>
        <span class="c1">//if (Input.GetButtonDown("Jump")) return true;    // ジャンプキーが押された時だけジャンプにする時はこっち</span>
            <span class="c1">// または、 if (Input.GetKeyUp(KeyCode.Space)) return true; とかでも可</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    ジャンプの強さ</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="kt">float</span> <span class="n">jumpPower</span> <span class="p">=</span> <span class="m">5f</span><span class="p">;</span>
    <span class="c1">//private const float jumpPower = 5f;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    ジャンプのための上方向への加圧</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">DoJump</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_rigidBody</span><span class="p">.</span><span class="nf">AddForce</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">up</span> <span class="p">*</span> <span class="n">jumpPower</span><span class="p">,</span> <span class="n">ForceMode</span><span class="p">.</span><span class="n">Impulse</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    接地してから何フレーム経過したか</span>
    <span class="c1">///    接地してない間は常にゼロとする</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">_isGround</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    接地してない間、何フレーム経過したか</span>
    <span class="c1">///    接地している間は常にゼロとする</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">_notGround</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    このフレーム数分接地していたらor接地していなかったら</span>
    <span class="c1">///    状態が変わったと認識する（ジャンプ開始したor着地した）</span>
    <span class="c1">///    接地してからキャラの状態が安定するまでに数フレーム用するため、</span>
    <span class="c1">///    キャラが安定する前に再ジャンプ入力を受け付けてしまうとバグる（ジャンプ出来なくなる）</span>
    <span class="c1">///    筆者PCでは 3 で安定するが、安全をとって今回は 5 とした</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">_isGroundStateChange</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    プレイヤーと地面の間の距離</span>
    <span class="c1">///    IsGround()が呼ばれるたびに更新される</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="kt">float</span> <span class="n">_groundDistance</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    _groundDistanceがこの値以下の場合接地していると判定する</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">const</span> <span class="kt">float</span> <span class="n">_groundDistanceLimit</span> <span class="p">=</span> <span class="m">0.01f</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    判定元の原点が地面に極端に近いとrayがヒットしない場合があるので、</span>
    <span class="c1">///    オフセットを設けて確実にヒットするようにする</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="n">Vector3</span> <span class="n">_raycastOffset</span>  <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0.005f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    プレイヤーキャラから下向きに地面判定のrayを飛ばす時の上限距離</span>
    <span class="c1">///    ゲーム中でプレイヤーキャラと地面が最も離れると考えられる場面の距離に、</span>
    <span class="c1">///    マージンを多少付けた値にしておくのが良</span>
    <span class="c1">///    Mathf.Infinityを指定すれば無制限も可能だが重くなる可能性があるかも？</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">const</span> <span class="kt">float</span> <span class="n">_raycastSearchDistance</span> <span class="p">=</span> <span class="m">100f</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    接地判定</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">CheckGroundDistance</span><span class="p">(</span><span class="n">UnityAction</span> <span class="n">landingAction</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span> <span class="n">UnityAction</span> <span class="n">takeOffAction</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">RaycastHit</span> <span class="n">hit</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">layerMask</span> <span class="p">=</span> <span class="n">LayerMask</span><span class="p">.</span><span class="nf">GetMask</span><span class="p">(</span><span class="s">"Ground"</span><span class="p">);</span>

        <span class="c1">// プレイヤーの位置から下向きにRaycast</span>
        <span class="c1">// レイヤーマスクでGroundを設定しているので、</span>
        <span class="c1">// 地面のGameObjectにGroundのレイヤーを設定しておけば、</span>
        <span class="c1">// Groundのレイヤーを持つGameObjectで一番近いものが一つだけヒットする</span>
        <span class="kt">var</span> <span class="n">isGroundHit</span> <span class="p">=</span> <span class="n">Physics</span><span class="p">.</span><span class="nf">Raycast</span><span class="p">(</span>
                <span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">+</span> <span class="n">_raycastOffset</span><span class="p">,</span>
                <span class="n">transform</span><span class="p">.</span><span class="nf">TransformDirection</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">down</span><span class="p">),</span>
                <span class="k">out</span> <span class="n">hit</span><span class="p">,</span>
                <span class="n">_raycastSearchDistance</span><span class="p">,</span>
                <span class="n">layerMask</span>
            <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">isGroundHit</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">_groundDistance</span> <span class="p">=</span> <span class="n">hit</span><span class="p">.</span><span class="n">distance</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// ヒットしなかった場合はキャラの下方に地面が存在しないものとして扱う</span>
            <span class="n">_groundDistance</span> <span class="p">=</span> <span class="kt">float</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// 地面とキャラの距離は環境によって様々で</span>
        <span class="c1">// 完全にゼロにはならない時もあるため、</span>
        <span class="c1">// ジャンプしていない時の値に多少のマージンをのせた</span>
        <span class="c1">// 一定値以下を接地と判定する</span>
        <span class="c1">// 通常あり得ないと思われるが、オーバーフローされると再度アクションが実行されてしまうので、越えたところで止める</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_groundDistance</span> <span class="p">&lt;</span> <span class="n">_groundDistanceLimit</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_isGround</span> <span class="p">&lt;=</span> <span class="n">_isGroundStateChange</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">_isGround</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
                <span class="n">_notGround</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_notGround</span> <span class="p">&lt;=</span> <span class="n">_isGroundStateChange</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">_isGround</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="n">_notGround</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 接地後またはジャンプ後、特定フレーム分状態の変化が無ければ、</span>
        <span class="c1">// 状態が安定したものとして接地処理またはジャンプ処理を行う</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_isGroundStateChange</span> <span class="p">==</span> <span class="n">_isGround</span> <span class="p">&amp;&amp;</span> <span class="n">_notGround</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">landingAction</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="nf">landingAction</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_isGroundStateChange</span> <span class="p">==</span> <span class="n">_notGround</span> <span class="p">&amp;&amp;</span> <span class="n">_isGround</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">takeOffAction</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="nf">takeOffAction</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
</div>

<p><em>（2018/09/16追記：クラス名がPlayerController2だったのをPlayerControllerに修正）</em></p>

<p>UniRx入れてReactivePropertyとかObservable使うともっとすっきり書けると思いますが、まずは分かりやすく素のUnityで動くスクリプトです。</p>

<p>Start()、Update()、FixedUpdate()を見れば大まかな処理は分かると思いますが、<br>
雑に一覧にした設計に従って、ジャンプ入力を受け付けて保持、FixedUpdateでジャンプ処理を行っています。</p>

<p>ジャンプ処理は <code>Rigidbody.AddForce()</code> を使っていて、<code>ForceMode.Impulse</code> で質量を考慮した瞬間的な加圧によってジャンプさせています。</p>

<p>着地の判定は <code>Physics.Raycast</code> で地面との距離をUpdate()で毎フレームチェックしていて、地面との距離が一定値以下の状態が指定フレーム続いたら着地したと判定するようになっています。</p>

<p>これはUnityの物理演算がブレを許容する構造になっているからで、地面と接触した瞬間を拾うようにすると、ジャンプ入力がそのフレームに同時に入った場合にジャンプが出来なかったり、ジャンプの高さが変わってしまったりする為です。</p>

<p>筆者環境では60fpsで3フレーム置けば安定して動作するのを確認済みですが、他の環境（ロースペックPCとかfpsがもっと高いとか）ではもしかしたらもっとかかるかもしれないので、一応マージンを取って5フレーム待つようにしてあります。</p>

<p>またこのスクリプトでは、最後の <code>CheckGroundDistance</code> メソッドでGroundレイヤーのオブジェクトを地面として認識しているので、<br>
床として作ったPlaneをGroundレイヤーとして設定します。</p>

<p><a href="https://camo.qiitausercontent.com/a946b2ef2052778b1eaa802f60661d6189145aa9/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536312d65346536656338302d616630302d313165382d383666312d3361636565396533356237362e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956561-e4e6ec80-af00-11e8-86f1-3acee9e35b76.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7372ad7a1834af1486e48c6f69064525" alt="13" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956561-e4e6ec80-af00-11e8-86f1-3acee9e35b76.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956561-e4e6ec80-af00-11e8-86f1-3acee9e35b76.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b986688f11a6f83a2d0a70542333dfc2 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/412e8de01fcd06335f11ca3ef03744946dc42f3d/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536332d65613434333730302d616630302d313165382d393539332d6238646236626131343738392e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956563-ea443700-af00-11e8-9593-b8db6ba14789.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d08e6bb407753e3deb4404f04c910a67" alt="14" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956563-ea443700-af00-11e8-9593-b8db6ba14789.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956563-ea443700-af00-11e8-9593-b8db6ba14789.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5ca1ff586c79b97101a53e8961499fcc 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/c5bce3c33ec6b03a7ee777dcd0bf4dde1b55b262/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536352d65653730353438302d616630302d313165382d386631642d6335316265393034353635652e6a7067" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956565-ee705480-af00-11e8-8f1d-c51be904565e.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0041e90ccab5b7f668e5b21a64e46222" alt="15" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956565-ee705480-af00-11e8-8f1d-c51be904565e.jpg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956565-ee705480-af00-11e8-8f1d-c51be904565e.jpg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0341640dae6abd51f3eff98614688c2f 1x" loading="lazy"></a></p>

<h2>
<span id="動かす" class="fragment"></span><a href="#%E5%8B%95%E3%81%8B%E3%81%99"><i class="fa fa-link"></i></a>動かす</h2>

<p><a href="https://camo.qiitausercontent.com/d712e292a7fd0d14da728dc94f2ec96ea4a1e0bb/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536382d66363266663930302d616630302d313165382d383665392d3165313630613861636234382e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956568-f62ff900-af00-11e8-86e9-1e160a8acb48.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d27490f17eab397b42a61d65512b26ce" alt="jump" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956568-f62ff900-af00-11e8-86e9-1e160a8acb48.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956568-f62ff900-af00-11e8-86e9-1e160a8acb48.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5e15240f419356f9b04cf3133758a0af 1x" loading="lazy"></a></p>

<p>ジャンプに使うスペースキーを押しっぱなしにしたり、定間隔でぽちぽち押してみたり<br>
色々試しましたが、ジャンプできなくなったり多重ジャンプしたりのような兆候は今の所見られません。</p>

<h2>
<span id="unirx" class="fragment"></span><a href="#unirx"><i class="fa fa-link"></i></a>UniRx</h2>

<p>まだあんまり書き慣れてないので粗末なものですが。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">PlayerControllerUniRx.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.Events</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UniRx</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UniRx.Triggers</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">PlayerController3</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    ジャンプの強さ</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="kt">float</span> <span class="n">jumpPower</span> <span class="p">=</span> <span class="m">5f</span><span class="p">;</span>


    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    Start()</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">rigidBody</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody</span><span class="p">&gt;();</span>

        <span class="kt">var</span> <span class="n">jumpInput</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">isJumping</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="cm">/*
        //入力ストリーム
        var inputStream = this.UpdateAsObservable()
            .Select(_ =&gt; {
                //if (jumpInput || JumpInput()) jumpInput = true;
                if (jumpInput || Input.GetButton("Jump")) jumpInput = true;
                return jumpInput;
            });
        // 入力ストリームを通すと処理が遅れるようでリアルタイムなやり取りが難しかったので
        // 今回はパス
*/</span>
        <span class="c1">//FixedUpdateを主軸にし、そこにinputStreamを合成する</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">FixedUpdateAsObservable</span><span class="p">()</span>
            <span class="c1">//.WithLatestFrom(inputStream, (_, jump_input) =&gt; jump_input)</span>
            <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">jumpInput</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">isJumping</span><span class="p">)</span>  <span class="p">{</span>
                    <span class="n">isJumping</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"jumping : "</span> <span class="p">+</span> <span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">up</span> <span class="p">*</span> <span class="n">jumpPower</span><span class="p">).</span><span class="nf">ToString</span><span class="p">());</span>
                    <span class="n">rigidBody</span><span class="p">.</span><span class="nf">AddForce</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">up</span> <span class="p">*</span> <span class="n">jumpPower</span><span class="p">,</span> <span class="n">ForceMode</span><span class="p">.</span><span class="n">Impulse</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>

        <span class="k">this</span><span class="p">.</span><span class="nf">UpdateAsObservable</span><span class="p">().</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">jumpInput</span> <span class="p">||</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetButton</span><span class="p">(</span><span class="s">"Jump"</span><span class="p">))</span> <span class="n">jumpInput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="nf">CheckGroundDistance</span><span class="p">();</span>
        <span class="p">});</span>

        <span class="c1">// 接地後またはジャンプ後、特定フレーム分状態の変化が無ければ、</span>
        <span class="c1">// 状態が安定したものとして接地処理またはジャンプ処理を行う</span>
        <span class="n">_is_ground</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="k">value</span> <span class="p">=&gt;</span> <span class="k">value</span> <span class="p">==</span> <span class="n">_isGroundStateChange</span><span class="p">).</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="n">jumpInput</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="n">isJumping</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">});</span>
<span class="cm">/*
        _not_ground.Where(v =&gt; v == _isGroundStateChange).Subscribe(x =&gt; {
                jumpInput = false;
                isJumping = false;
        });
*/</span>
    <span class="p">}</span>


    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    接地してから何フレーム経過したか</span>
    <span class="c1">///    接地してない間は常にゼロとする</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="n">ReactiveProperty</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">_is_ground</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReactiveProperty</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    接地してない間、何フレーム経過したか</span>
    <span class="c1">///    接地している間は常にゼロとする</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="n">ReactiveProperty</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">_not_ground</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReactiveProperty</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    このフレーム数分接地していたらor接地していなかったら</span>
    <span class="c1">///    状態が変わったと認識する（ジャンプ開始したor着地した）</span>
    <span class="c1">///    接地してからキャラの状態が安定するまでに数フレーム用するため、</span>
    <span class="c1">///    キャラが安定する前に再ジャンプ入力を受け付けてしまうとバグる（ジャンプ出来なくなる）</span>
    <span class="c1">///    筆者PCでは 3 で安定するが、安全をとって今回は 5 とした</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">_isGroundStateChange</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    プレイヤーと地面の間の距離</span>
    <span class="c1">///    IsGround()が呼ばれるたびに更新される</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="kt">float</span> <span class="n">_groundDistance</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    _groundDistanceがこの値以下の場合接地していると判定する</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">float</span> <span class="n">_groundDistanceLimit</span> <span class="p">=</span> <span class="m">0.01f</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    判定元の原点が地面に極端に近いとrayがヒットしない場合があるので、</span>
    <span class="c1">///    オフセットを設けて確実にヒットするようにする</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="n">Vector3</span> <span class="n">_raycastOffset</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0.005f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    プレイヤーキャラから下向きに地面判定のrayを飛ばす時の上限距離</span>
    <span class="c1">///    ゲーム中でプレイヤーキャラと地面が最も離れると考えられる場面の距離に、</span>
    <span class="c1">///    マージンを多少付けた値にしておくのが良</span>
    <span class="c1">///    Mathf.Infinityを指定すれば無制限も可能だが重くなる可能性があるかも？</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="kt">float</span> <span class="n">_raycastSearchDistance</span> <span class="p">=</span> <span class="m">100f</span><span class="p">;</span>

    <span class="c1">///&lt;summary&gt;</span>
    <span class="c1">///    接地判定</span>
    <span class="c1">///&lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">CheckGroundDistance</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">RaycastHit</span> <span class="n">hit</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">layerMask</span> <span class="p">=</span> <span class="n">LayerMask</span><span class="p">.</span><span class="nf">GetMask</span><span class="p">(</span><span class="s">"Ground"</span><span class="p">);</span>

        <span class="c1">// プレイヤーの位置から下向きにRaycast</span>
        <span class="c1">// レイヤーマスクでGroundを設定しているので、</span>
        <span class="c1">// 地面のGameObjectにGroundのレイヤーを設定しておけば、</span>
        <span class="c1">// Groundのレイヤーを持つGameObjectで一番近いものが一つだけヒットする</span>
        <span class="kt">var</span> <span class="n">isGroundHit</span> <span class="p">=</span> <span class="n">Physics</span><span class="p">.</span><span class="nf">Raycast</span><span class="p">(</span>
                <span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">+</span> <span class="n">_raycastOffset</span><span class="p">,</span>
                <span class="n">transform</span><span class="p">.</span><span class="nf">TransformDirection</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">down</span><span class="p">),</span>
                <span class="k">out</span> <span class="n">hit</span><span class="p">,</span>
                <span class="n">_raycastSearchDistance</span><span class="p">,</span>
                <span class="n">layerMask</span>
            <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">isGroundHit</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">_groundDistance</span> <span class="p">=</span> <span class="n">hit</span><span class="p">.</span><span class="n">distance</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// ヒットしなかった場合はキャラの下方に地面が存在しないものとして扱う</span>
            <span class="n">_groundDistance</span> <span class="p">=</span> <span class="kt">float</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// 地面とキャラの距離は環境によって様々で</span>
        <span class="c1">// 完全にゼロにはならない時もあるため、</span>
        <span class="c1">// ジャンプしていない時の値に多少のマージンをのせた</span>
        <span class="c1">// 一定値以下を接地と判定する</span>
        <span class="c1">// 通常あり得ないと思われるが、オーバーフローされると再度アクションが実行されてしまうので、越えたところで止める</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_groundDistance</span> <span class="p">&lt;</span> <span class="n">_groundDistanceLimit</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_is_ground</span><span class="p">.</span><span class="n">Value</span> <span class="p">&lt;=</span> <span class="n">_isGroundStateChange</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">_is_ground</span><span class="p">.</span><span class="n">Value</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
                <span class="n">_not_ground</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_not_ground</span><span class="p">.</span><span class="n">Value</span> <span class="p">&lt;=</span> <span class="n">_isGroundStateChange</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">_is_ground</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="n">_not_ground</span><span class="p">.</span><span class="n">Value</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>AsObservableしただけですね・・・<br>
もっとローカルにごりごり押し込んで高速化したり簡略化出来ると思いますが、これで安定動作しているので今回はこの辺で。</p>

<h1>
<span id="参考資料" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99"><i class="fa fa-link"></i></a>参考資料</h1>

<p><a href="http://unityleaning.blog.fc2.com/blog-entry-2.html" rel="nofollow noopener" target="_blank">Unityゲーム開発所 - UnityでFPSを設定する方法</a></p>

<p><a href="http://yaseino.hatenablog.com/entry/2016/02/23/234652" rel="nofollow noopener" target="_blank">Unityでゲームを作った際に「カクカクしている」と言われないためのTimeSettings.FixedTimestep講座 - 野生のはてなブログ</a></p>

<p><a href="https://docs.unity3d.com/ja/current/Manual/ExecutionOrder.html" rel="nofollow noopener" target="_blank">イベント関数の実行順 - Unity マニュアル</a></p>

<p><a href="https://qiita.com/toRisouP/items/aeddfec470ca6de5924a" id="reference-7a9ed4f386c468e26adb">【UniRx】Update()タイミングのイベントをFixedUpdate()のタイミングに変換する - Qiita</a><br>
とりすーぷさんいつもお世話になっております。</p>

<h1>
<span id="ライセンス表記" class="fragment"></span><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%A1%A8%E8%A8%98"><i class="fa fa-link"></i></a>ライセンス表記</h1>

<p><a href="http://unity-chan.com/contents/license_jp/" rel="nofollow noopener" target="_blank">この記事はユニティちゃんライセンス条項の元に提供されています。</a></p>

<p><a href="https://camo.qiitausercontent.com/487a62b3748c0fb1d7357f77c05d5281ccc5c8d3/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363537392d33373238306438302d616630312d313165382d383531332d3937323436653061653833372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956579-37280d80-af01-11e8-8513-97246e0ae837.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e55782551a33772c8ec3122c11ff53d4" alt="imagelicenselogo" data-canonical-src="https://user-images.githubusercontent.com/8291395/44956579-37280d80-af01-11e8-8513-97246e0ae837.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956579-37280d80-af01-11e8-8513-97246e0ae837.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=36b055ec4611f2fc6dce0a8e7e186479 1x" loading="lazy"></a></p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fmkgask%2Fitems%2F6d04d0be13cc0b14d4fb&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fmkgask%2Fitems%2F6d04d0be13cc0b14d4fb&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mkgask/items/6d04d0be13cc0b14d4fb/likers" class="css-1iupg5d">18</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">17</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6d04d0be13cc0b14d4fb/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mkgask/items/6d04d0be13cc0b14d4fb/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mkgask/items/6d04d0be13cc0b14d4fb/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mkgask/items/6d04d0be13cc0b14d4fb/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mkgask/items/6d04d0be13cc0b14d4fb.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-c4f5ac84-fbd2-4098-aca8-937597a33b64">{"authorAnalyticsTrackingId":"UA-80285705-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-9cd53e10-ad1b-47c1-a769-587ebdaf64a6"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-9cd53e10-ad1b-47c1-a769-587ebdaf64a6">{}</script>
      
<div id="LoginModal-react-component-4c9b1faf-a4ff-49c1-b4db-04c6ef21156a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-4c9b1faf-a4ff-49c1-b4db-04c6ef21156a">{}</script>
      
<div id="StockModal-react-component-b505c219-54ed-4593-bd0a-03516f8fc36a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-b505c219-54ed-4593-bd0a-03516f8fc36a">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;a3WpkxJ2Dpb9lUFWlHikOBp0hZX8lOLLNcK+Pq4Ays+Z3NDADClyi9d6SNJTxnEc/jUJxMcrvBytPIcF586LEA==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eUnity 3Dでのジャンプの長さが変わってもちゃんと動くアニメーション対応のジャンプ処理の記事を書こうと思ったのですが、その前にUnity 3Dでのジャンプ処理自体を取り扱っている記事が少なそうなので、基礎的なところを先に書いていきます。\u003cbr\u003e\n（Qiitaに少なそうなだけでggればいろいろ出てくると思いますが）\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003e（2018/09/16追記：色々って言うわりにUpdateとFixedUpdateの説明しか書いてないので記事名を変更）\u003c/em\u003e\u003cbr\u003e\n\u003cem\u003e（最初の記事名は「Unity 3Dで色々考慮したジャンプ（基礎）」でした）\u003c/em\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"確認した環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%9F%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e確認した環境\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows 10\u003c/li\u003e\n\u003cli\u003eUnity 2018.2.4f1\u003c/li\u003e\n\u003cli\u003eプレイヤーキャラクターに \u003ca href=\"http://unity-chan.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnity Technologies Japanオリジナルキャラクター Unityちゃん\u003c/a\u003e を利用\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ベース環境作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%99%E3%83%BC%E3%82%B9%E7%92%B0%E5%A2%83%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eベース環境作成\u003c/h1\u003e\n\n\u003cp\u003eスクリプトに入る前に、プロジェクトをゼロから作っておきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"プロジェクト作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクト作成\u003c/h2\u003e\n\n\u003cp\u003eご利用のUnityで新規プロジェクトを作成してください。\u003c/p\u003e\n\n\u003cp\u003eタイトルは何でも良いのですが、筆者は今回は JumpTest と付けました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"床作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BA%8A%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e床作成\u003c/h2\u003e\n\n\u003cp\u003eとりあえずの床として Plane を作成します。名前はFloorとします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/890e4fcd0ea71161993ad31e865f3bb8779b470b/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363436322d64323166653830302d616566662d313165382d396230362d3562353238343135356635612e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956462-d21fe800-aeff-11e8-9b06-5b5284155f5a.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9b50d4a6475a88f045609729d71c1894\" alt=\"2\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956462-d21fe800-aeff-11e8-9b06-5b5284155f5a.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956462-d21fe800-aeff-11e8-9b06-5b5284155f5a.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bd18b722bc1d2df80fc1f0130d7d8fcb 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"unityちゃん導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unity%E3%81%A1%E3%82%83%E3%82%93%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUnityちゃん導入\u003c/h2\u003e\n\n\u003cp\u003eUnityちゃんモデルの入手方法が、\u003ca href=\"http://unity-chan.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式からのダウンロード\u003c/a\u003eと\u003ca href=\"https://assetstore.unity.com/packages/3d/characters/unity-chan-model-18705\" rel=\"nofollow noopener\" target=\"_blank\"\u003eアセットストアからのもの\u003c/a\u003eと2種類あるんですが、公式からダウンロードしてきてimportしたほうがバージョンが新しいようです。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/dc6204989795543b2888deadaec3ef9e8c21d78f/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363436372d64653062616130302d616566662d313165382d383235612d3263396434313535613232362e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956467-de0baa00-aeff-11e8-825a-2c9d4155a226.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=730727e7b577875f92bb4c1cd0e22cde\" alt=\"3\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956467-de0baa00-aeff-11e8-825a-2c9d4155a226.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956467-de0baa00-aeff-11e8-825a-2c9d4155a226.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=568bd295c56b21ef0dc8921a79a163ed 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eアセットストアのものはバージョン 1.1\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/8f4a29dc590cf62898d687b75da8992d4b6eb6d5/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363436392d65353332623830302d616566662d313165382d383132312d3765363031396564643233352e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956469-e532b800-aeff-11e8-8121-7e6019edd235.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=fb16a3b170a2da282c9595cb3bd5b28b\" alt=\"4-2\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956469-e532b800-aeff-11e8-8121-7e6019edd235.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956469-e532b800-aeff-11e8-8121-7e6019edd235.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fbf487914c8fdf9387518988fe5de3e1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e公式は1.2.1です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/49b46ba64fcff0c52e0a4070818f1d22eca1496a/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363437322d65643861663330302d616566662d313165382d393636662d6336303664393531656232392e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956472-ed8af300-aeff-11e8-966f-c606d951eb29.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=71065b37f7060179485de6f234c0c0ef\" alt=\"5\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956472-ed8af300-aeff-11e8-966f-c606d951eb29.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956472-ed8af300-aeff-11e8-966f-c606d951eb29.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fbbee93bbcb45334c027f4167c6598bf 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b4f5cfbacb1f2b19f83d1eb7ee1513963872714e/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363437362d66343139366138302d616566662d313165382d393135322d3439653337396435383362662e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956476-f4196a80-aeff-11e8-9152-49e379d583bf.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d4263b2b4baff02370e399017e7c0c4e\" alt=\"6\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956476-f4196a80-aeff-11e8-9152-49e379d583bf.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956476-f4196a80-aeff-11e8-9152-49e379d583bf.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=96e23890b6a6094ac42214ccb200e51b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eModelsディレクトリの中の unitychan をヒエラルキーに追加します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/6b57387ae4cf9bbb6ecf7f0dceea5fa050cd95cf/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363437392d30353632373730302d616630302d313165382d396166642d3439383162383534393731612e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956479-05627700-af00-11e8-9afd-4981b854971a.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=757ef8445c0451974af2db305365a5aa\" alt=\"7\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956479-05627700-af00-11e8-9afd-4981b854971a.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956479-05627700-af00-11e8-9afd-4981b854971a.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1931ee6d4c90774553e164fbc009ea9f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"プレイヤーキャラクターのgameobjectに各種コンポーネントを設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%AD%E3%83%A3%E3%83%A9%E3%82%AF%E3%82%BF%E3%83%BC%E3%81%AEgameobject%E3%81%AB%E5%90%84%E7%A8%AE%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプレイヤーキャラクターのGameObjectに各種コンポーネントを設定\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"animator\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#animator\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAnimator\u003c/h2\u003e\n\n\u003cp\u003eunitychan のGameObjectにはAnimatorコンポーネントが1つだけアタッチされていますが、今回は使わないので削除します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/7d67501ab1cdc86b0c25b521ac66495e2341cbee/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363438322d31316536636638302d616630302d313165382d393636312d6132626631346236396564392e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956482-11e6cf80-af00-11e8-9661-a2bf14b69ed9.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=df734560c063b8cbbc148243717c0013\" alt=\"8\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956482-11e6cf80-af00-11e8-9661-a2bf14b69ed9.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956482-11e6cf80-af00-11e8-9661-a2bf14b69ed9.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d2ed1cfbbb2c5d09d9f9c018bc05736c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"capsule-collier\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#capsule-collier\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCapsule Collier\u003c/h2\u003e\n\n\u003cp\u003e今の状態では接触判定がありませんのでCapsule Collierを追加します。\u003c/p\u003e\n\n\u003cp\u003e何かコライダーがあれば接触判定は可能ですが、人型のオブジェクトには形状的にCapsule Collierが適しているので、これをアタッチします。\u003cbr\u003e\n（Capsule Colliderの端の球面のせいで接触判定に支障が出る場合は、Box Colliderでも十分代用が効きます。筆者は壁際に落ちてる細長いもの（剣とか棒とか）に接触出来なくて拾えなかったことがあります）\u003c/p\u003e\n\n\u003cp\u003eアタッチしたままではUnityちゃんの足元にだけ判定が出てしまうので、設定を行います。\u003c/p\u003e\n\n\u003cp\u003eInspectorのCenterでコライダーの中心をUnityちゃんの中心にあわせて、Heightでコライダーの高さをUnityちゃんの身長にあわせ、Radiusで半径を調整します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/91395753626992de39d669f3d2b2951456fc73d1/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363439352d32343631303930302d616630302d313165382d393735632d3734633837663965363564662e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956495-24610900-af00-11e8-975c-74c87f9e65df.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6b345c8242b72db79d33b8a4238078a0\" alt=\"10\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956495-24610900-af00-11e8-975c-74c87f9e65df.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956495-24610900-af00-11e8-975c-74c87f9e65df.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2492e356f3fc4c78480c71df4b610bb2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"rigidbody\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rigidbody\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRigidbody\u003c/h2\u003e\n\n\u003cp\u003e物理法則に則った動作をしてもらうために、Rigidbodyも追加します。\u003c/p\u003e\n\n\u003cp\u003eそのままだとキャラクターがコケて倒れてしまったりなどするので、Constrainsの中にあるFreeze RotationでxとzのチェックをONし、倒れてしまう向きの回転を停止します。\u003cbr\u003e\nTransformのRotationのところをドラッグで数値を変更すると、どの値がどの向きの回転なのか分かります。yは横方向の回転のみなので、固定しなくても大丈夫です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/81e5ce19ebb1792e277da5ce8a0ddf50410ded50/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363530302d33326166323530302d616630302d313165382d393239662d6163363332633930323032652e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956500-32af2500-af00-11e8-929f-ac632c90202e.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4366fade411b81977de11f0441f91b37\" alt=\"11\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956500-32af2500-af00-11e8-929f-ac632c90202e.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956500-32af2500-af00-11e8-929f-ac632c90202e.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6ae075b72c370372ea752451bbeb27f1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"スクリプト作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eスクリプト作成\u003c/h1\u003e\n\n\u003cp\u003eこれで基本の設定は完了したので、スクリプトを作成しますが、ここでまた考えないといけないことがあります。\u003c/p\u003e\n\n\u003cp\u003eUpdate()とFixedUpdate()の違いについてで、皆さんご存知のことと思いますが、Update()とFixedUpdate()は実行されるタイミングとするべき処理が違います。\u003c/p\u003e\n\n\u003cp\u003eUnityではUpdate()のFPSはデフォルトではディスプレイの垂直同期に同期します。\u003cbr\u003e\n一般的なディスプレイでは60Hzですが、VRゴーグルでは90Hzが多いようです。\u003cbr\u003e\nゲーミングディスプレイの場合は120Hzや144Hzの場合もあり、現行機種で最も速いものは240Hzのものが出ています。数年すると300Hzが出てくるのではとも言われています。\u003cbr\u003e\n（Project Settings -\u0026gt; Quality -\u0026gt; V Sync Count）\u003c/p\u003e\n\n\u003cp\u003eFixedUpdate()はUpdate()とは独立したタイマーで固定時間毎に実行され、Unityで設定した通りのFPSで呼ばれます。デフォルトでは50fpsです。\u003cbr\u003e\n（Project Settings -\u0026gt; Time -\u0026gt; Fixed Timestep）\u003c/p\u003e\n\n\u003cp\u003eそして、Update()で入力処理を行わなければならず、FixedUpdate()で物理演算の処理を行う必要があることもご存知のことと思います。\u003c/p\u003e\n\n\u003cp\u003eスクリプトはこの2点について十分に留意して作成する必要があります。\u003c/p\u003e\n\n\u003cp\u003e垂直同期との同期をOFFにして目標FPSを別で設定する方法もありますが、参考資料にリンクを置いておくのでそちらのほうが良い方は各自ご確認ください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"タイミング概念図\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%82%A4%E3%83%9F%E3%83%B3%E3%82%B0%E6%A6%82%E5%BF%B5%E5%9B%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタイミング概念図\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/04be35faa0f112c7e1a3cebc0e76e6a6298b4e9f/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363530332d34343930633830302d616630302d313165382d386431632d3939343463313030333331302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956503-4490c800-af00-11e8-8d1c-9944c1003310.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=84b800f3d160de56fbaae3de83dc55de\" alt=\"1\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956503-4490c800-af00-11e8-8d1c-9944c1003310.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956503-4490c800-af00-11e8-8d1c-9944c1003310.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f16d4fdfe5f1238d17f25dc73ef09027 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e上図はUpdate()が60fps、FixedUpdate()が50fpsと仮定して、数回に1回Update()が2回くるタイミングがある図です。\u003c/p\u003e\n\n\u003cp\u003eUpdate()のフレームレートが上がると、もちろんUpdate()の介入回数が増えます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/9ca6503169e4e8626c0130c7791e24d5dd0a02cb/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363530372d35356439643438302d616630302d313165382d386131642d6237626564353632306533652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956507-55d9d480-af00-11e8-8a1d-b7bed5620e3e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ff5dc00353d72b00d63994649e4099a6\" alt=\"2\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956507-55d9d480-af00-11e8-8a1d-b7bed5620e3e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956507-55d9d480-af00-11e8-8a1d-b7bed5620e3e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=026214cdddd11af60ad7e921492881e5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e120Hzまたは144Hzの場合は、だいたいUpdate()2回にFixedUpdate()が1回あり、時々Update()が3回ある、という形になります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/cb1fcf13bacc6a2121152433c3bb547e2f709f45/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363531302d35663633336338302d616630302d313165382d393266392d6134666162656139353762662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956510-5f633c80-af00-11e8-92f9-a4fabea957bf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a1b0cc0b08da3ba39ce8c56735aa8f37\" alt=\"3\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956510-5f633c80-af00-11e8-92f9-a4fabea957bf.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956510-5f633c80-af00-11e8-92f9-a4fabea957bf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=05a441b047af6fc510a9b245e80c37cd 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e240Hzでは4回に1回になり、時々5回になります。\u003cbr\u003e\n極端な例ですが、ディスプレイと設定次第で既に現実に起こり得るものです。\u003c/p\u003e\n\n\u003cp\u003eUpdate()でジャンプ入力が複数フレーム続き、次のFixedUpdate()のタイミングでジャンプ入力が終わってしまっていても1回だけジャンプ処理される、という処理にしなければなりません。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ジャンプ処理の設計\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%97%E5%87%A6%E7%90%86%E3%81%AE%E8%A8%AD%E8%A8%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジャンプ処理の設計\u003c/h2\u003e\n\n\u003cp\u003e以上の注意点とタイミング図からジャンプの設計は以下の通りとします。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eジャンプ入力は、次のFixedUpdate()まで記憶する\u003c/li\u003e\n\u003cli\u003eジャンプ入力の記憶は、ジャンプ入力が複数回あっても一つだけ記憶し、FixedUpdate()が来るまではジャンプ入力が終了しても記憶したままとする\u003c/li\u003e\n\u003cli\u003eジャンプ入力の記憶がある間は再ジャンプ入力は受け付けない\u003c/li\u003e\n\u003cli\u003eジャンプ処理が終わって着地したタイミングでジャンプ入力の記憶を消去する\u003c/li\u003e\n\u003cli\u003eFixedUpdate()ではジャンプ入力の記憶を見てジャンプ処理を開始する\u003c/li\u003e\n\u003cli\u003eただし、このジャンプ入力の記憶は着地するまでずっとONのままなので、\nFixedUpdate()内での再ジャンプ処理を禁止するための内部用の別のフラグが必要\u003c/li\u003e\n\u003cli\u003e内部用のフラグはFixedUpdate()内でジャンプ処理開始時にONし、着地時にOFFする\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eだいたいこんな感じになっていれば、多重にジャンプ処理が行われてしまうことがなくなるはずです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"スクリプト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eスクリプト\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ePlayerController.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine.Events\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePlayerController\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプ処理に使用するRigidbody\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eRigidbody\u003c/span\u003e \u003cspan class=\"n\"\u003e_rigidBody\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプ入力フラグ\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプ入力が一度でもあったらON、着地したらOFF\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003e_jumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプ処理中フラグ\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプ処理が開始されたらON、着地したらOFF\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003e_isJumping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    Start()\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_rigidBody\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eRigidbody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    Update()\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eCheckGroundDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_jumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_isJumping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 既にジャンプ入力が行われていたら、ジャンプ入力チェックを飛ばす\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_jumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"nf\"\u003eJumpInput\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"n\"\u003e_jumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    FixedUpdate()\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eFixedUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_jumpInput\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003e_isJumping\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_isJumping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eDoJump\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプ入力チェック\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eJumpInput\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ジャンプ最速入力のテスト用にGetButton\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Jump\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e    \u003cspan class=\"c1\"\u003e// ジャンプキー押しっぱなしで連続ジャンプ\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//if (Input.GetButtonDown(\"Jump\")) return true;    // ジャンプキーが押された時だけジャンプにする時はこっち\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// または、 if (Input.GetKeyUp(KeyCode.Space)) return true; とかでも可\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプの強さ\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializeField\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ejumpPower\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e5f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//private const float jumpPower = 5f;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプのための上方向への加圧\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoJump\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_rigidBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddForce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eup\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ejumpPower\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eForceMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eImpulse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してから何フレーム経過したか\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してない間は常にゼロとする\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGround\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してない間、何フレーム経過したか\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地している間は常にゼロとする\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003e_notGround\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    このフレーム数分接地していたらor接地していなかったら\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    状態が変わったと認識する（ジャンプ開始したor着地した）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してからキャラの状態が安定するまでに数フレーム用するため、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    キャラが安定する前に再ジャンプ入力を受け付けてしまうとバグる（ジャンプ出来なくなる）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    筆者PCでは 3 で安定するが、安全をとって今回は 5 とした\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    プレイヤーと地面の間の距離\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    IsGround()が呼ばれるたびに更新される\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializeField\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    _groundDistanceがこの値以下の場合接地していると判定する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003e_groundDistanceLimit\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.01f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    判定元の原点が地面に極端に近いとrayがヒットしない場合があるので、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    オフセットを設けて確実にヒットするようにする\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eVector3\u003c/span\u003e \u003cspan class=\"n\"\u003e_raycastOffset\u003c/span\u003e  \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.005f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    プレイヤーキャラから下向きに地面判定のrayを飛ばす時の上限距離\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ゲーム中でプレイヤーキャラと地面が最も離れると考えられる場面の距離に、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    マージンを多少付けた値にしておくのが良\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    Mathf.Infinityを指定すれば無制限も可能だが重くなる可能性があるかも？\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003e_raycastSearchDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e100f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地判定\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCheckGroundDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityAction\u003c/span\u003e \u003cspan class=\"n\"\u003elandingAction\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eUnityAction\u003c/span\u003e \u003cspan class=\"n\"\u003etakeOffAction\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eRaycastHit\u003c/span\u003e \u003cspan class=\"n\"\u003ehit\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elayerMask\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eLayerMask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetMask\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Ground\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// プレイヤーの位置から下向きにRaycast\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// レイヤーマスクでGroundを設定しているので、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 地面のGameObjectにGroundのレイヤーを設定しておけば、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Groundのレイヤーを持つGameObjectで一番近いものが一つだけヒットする\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eisGroundHit\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ePhysics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRaycast\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eposition\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003e_raycastOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTransformDirection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edown\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"n\"\u003ehit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_raycastSearchDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003elayerMask\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisGroundHit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edistance\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// ヒットしなかった場合はキャラの下方に地面が存在しないものとして扱う\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMaxValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 地面とキャラの距離は環境によって様々で\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 完全にゼロにはならない時もあるため、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ジャンプしていない時の値に多少のマージンをのせた\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 一定値以下を接地と判定する\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 通常あり得ないと思われるが、オーバーフローされると再度アクションが実行されてしまうので、越えたところで止める\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_groundDistanceLimit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_isGround\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_isGround\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_notGround\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_notGround\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_isGround\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_notGround\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 接地後またはジャンプ後、特定フレーム分状態の変化が無ければ、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 状態が安定したものとして接地処理またはジャンプ処理を行う\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGround\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003e_notGround\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elandingAction\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003elandingAction\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003e_notGround\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGround\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etakeOffAction\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003etakeOffAction\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003cem\u003e（2018/09/16追記：クラス名がPlayerController2だったのをPlayerControllerに修正）\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eUniRx入れてReactivePropertyとかObservable使うともっとすっきり書けると思いますが、まずは分かりやすく素のUnityで動くスクリプトです。\u003c/p\u003e\n\n\u003cp\u003eStart()、Update()、FixedUpdate()を見れば大まかな処理は分かると思いますが、\u003cbr\u003e\n雑に一覧にした設計に従って、ジャンプ入力を受け付けて保持、FixedUpdateでジャンプ処理を行っています。\u003c/p\u003e\n\n\u003cp\u003eジャンプ処理は \u003ccode\u003eRigidbody.AddForce()\u003c/code\u003e を使っていて、\u003ccode\u003eForceMode.Impulse\u003c/code\u003e で質量を考慮した瞬間的な加圧によってジャンプさせています。\u003c/p\u003e\n\n\u003cp\u003e着地の判定は \u003ccode\u003ePhysics.Raycast\u003c/code\u003e で地面との距離をUpdate()で毎フレームチェックしていて、地面との距離が一定値以下の状態が指定フレーム続いたら着地したと判定するようになっています。\u003c/p\u003e\n\n\u003cp\u003eこれはUnityの物理演算がブレを許容する構造になっているからで、地面と接触した瞬間を拾うようにすると、ジャンプ入力がそのフレームに同時に入った場合にジャンプが出来なかったり、ジャンプの高さが変わってしまったりする為です。\u003c/p\u003e\n\n\u003cp\u003e筆者環境では60fpsで3フレーム置けば安定して動作するのを確認済みですが、他の環境（ロースペックPCとかfpsがもっと高いとか）ではもしかしたらもっとかかるかもしれないので、一応マージンを取って5フレーム待つようにしてあります。\u003c/p\u003e\n\n\u003cp\u003eまたこのスクリプトでは、最後の \u003ccode\u003eCheckGroundDistance\u003c/code\u003e メソッドでGroundレイヤーのオブジェクトを地面として認識しているので、\u003cbr\u003e\n床として作ったPlaneをGroundレイヤーとして設定します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a946b2ef2052778b1eaa802f60661d6189145aa9/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536312d65346536656338302d616630302d313165382d383666312d3361636565396533356237362e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956561-e4e6ec80-af00-11e8-86f1-3acee9e35b76.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7372ad7a1834af1486e48c6f69064525\" alt=\"13\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956561-e4e6ec80-af00-11e8-86f1-3acee9e35b76.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956561-e4e6ec80-af00-11e8-86f1-3acee9e35b76.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b986688f11a6f83a2d0a70542333dfc2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/412e8de01fcd06335f11ca3ef03744946dc42f3d/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536332d65613434333730302d616630302d313165382d393539332d6238646236626131343738392e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956563-ea443700-af00-11e8-9593-b8db6ba14789.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d08e6bb407753e3deb4404f04c910a67\" alt=\"14\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956563-ea443700-af00-11e8-9593-b8db6ba14789.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956563-ea443700-af00-11e8-9593-b8db6ba14789.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5ca1ff586c79b97101a53e8961499fcc 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c5bce3c33ec6b03a7ee777dcd0bf4dde1b55b262/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536352d65653730353438302d616630302d313165382d386631642d6335316265393034353635652e6a7067\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956565-ee705480-af00-11e8-8f1d-c51be904565e.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0041e90ccab5b7f668e5b21a64e46222\" alt=\"15\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956565-ee705480-af00-11e8-8f1d-c51be904565e.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956565-ee705480-af00-11e8-8f1d-c51be904565e.jpg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0341640dae6abd51f3eff98614688c2f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"動かす\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E3%81%8B%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e動かす\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d712e292a7fd0d14da728dc94f2ec96ea4a1e0bb/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363536382d66363266663930302d616630302d313165382d383665392d3165313630613861636234382e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956568-f62ff900-af00-11e8-86e9-1e160a8acb48.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d27490f17eab397b42a61d65512b26ce\" alt=\"jump\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956568-f62ff900-af00-11e8-86e9-1e160a8acb48.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956568-f62ff900-af00-11e8-86e9-1e160a8acb48.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5e15240f419356f9b04cf3133758a0af 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eジャンプに使うスペースキーを押しっぱなしにしたり、定間隔でぽちぽち押してみたり\u003cbr\u003e\n色々試しましたが、ジャンプできなくなったり多重ジャンプしたりのような兆候は今の所見られません。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"unirx\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unirx\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUniRx\u003c/h2\u003e\n\n\u003cp\u003eまだあんまり書き慣れてないので粗末なものですが。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ePlayerControllerUniRx.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine.Events\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniRx\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniRx.Triggers\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePlayerController3\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ジャンプの強さ\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializeField\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ejumpPower\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e5f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    Start()\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erigidBody\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eRigidbody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ejumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eisJumping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"cm\"\u003e/*\n        //入力ストリーム\n        var inputStream = this.UpdateAsObservable()\n            .Select(_ =\u0026gt; {\n                //if (jumpInput || JumpInput()) jumpInput = true;\n                if (jumpInput || Input.GetButton(\"Jump\")) jumpInput = true;\n                return jumpInput;\n            });\n        // 入力ストリームを通すと処理が遅れるようでリアルタイムなやり取りが難しかったので\n        // 今回はパス\n*/\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//FixedUpdateを主軸にし、そこにinputStreamを合成する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFixedUpdateAsObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//.WithLatestFrom(inputStream, (_, jump_input) =\u0026gt; jump_input)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eisJumping\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eisJumping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"jumping : \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eup\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ejumpPower\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003erigidBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddForce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eup\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ejumpPower\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eForceMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eImpulse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUpdateAsObservable\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Jump\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"n\"\u003ejumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eCheckGroundDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 接地後またはジャンプ後、特定フレーム分状態の変化が無ければ、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 状態が安定したものとして接地処理またはジャンプ処理を行う\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_is_ground\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ejumpInput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eisJumping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"cm\"\u003e/*\n        _not_ground.Where(v =\u0026gt; v == _isGroundStateChange).Subscribe(x =\u0026gt; {\n                jumpInput = false;\n                isJumping = false;\n        });\n*/\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してから何フレーム経過したか\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してない間は常にゼロとする\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eReactiveProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_is_ground\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eReactiveProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してない間、何フレーム経過したか\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地している間は常にゼロとする\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eReactiveProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_not_ground\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eReactiveProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    このフレーム数分接地していたらor接地していなかったら\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    状態が変わったと認識する（ジャンプ開始したor着地した）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地してからキャラの状態が安定するまでに数フレーム用するため、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    キャラが安定する前に再ジャンプ入力を受け付けてしまうとバグる（ジャンプ出来なくなる）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    筆者PCでは 3 で安定するが、安全をとって今回は 5 とした\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    プレイヤーと地面の間の距離\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    IsGround()が呼ばれるたびに更新される\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializeField\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    _groundDistanceがこの値以下の場合接地していると判定する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003e_groundDistanceLimit\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.01f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    判定元の原点が地面に極端に近いとrayがヒットしない場合があるので、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    オフセットを設けて確実にヒットするようにする\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eVector3\u003c/span\u003e \u003cspan class=\"n\"\u003e_raycastOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.005f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    プレイヤーキャラから下向きに地面判定のrayを飛ばす時の上限距離\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    ゲーム中でプレイヤーキャラと地面が最も離れると考えられる場面の距離に、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    マージンを多少付けた値にしておくのが良\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    Mathf.Infinityを指定すれば無制限も可能だが重くなる可能性があるかも？\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003e_raycastSearchDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e100f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e///\u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///    接地判定\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e///\u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCheckGroundDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eRaycastHit\u003c/span\u003e \u003cspan class=\"n\"\u003ehit\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elayerMask\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eLayerMask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetMask\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Ground\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// プレイヤーの位置から下向きにRaycast\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// レイヤーマスクでGroundを設定しているので、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 地面のGameObjectにGroundのレイヤーを設定しておけば、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Groundのレイヤーを持つGameObjectで一番近いものが一つだけヒットする\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eisGroundHit\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ePhysics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRaycast\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eposition\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003e_raycastOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTransformDirection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edown\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"n\"\u003ehit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_raycastSearchDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003elayerMask\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisGroundHit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edistance\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// ヒットしなかった場合はキャラの下方に地面が存在しないものとして扱う\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMaxValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 地面とキャラの距離は環境によって様々で\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 完全にゼロにはならない時もあるため、\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ジャンプしていない時の値に多少のマージンをのせた\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 一定値以下を接地と判定する\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 通常あり得ないと思われるが、オーバーフローされると再度アクションが実行されてしまうので、越えたところで止める\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_groundDistance\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_groundDistanceLimit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_is_ground\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_is_ground\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_not_ground\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_not_ground\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"n\"\u003e_isGroundStateChange\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_is_ground\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_not_ground\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eAsObservableしただけですね・・・\u003cbr\u003e\nもっとローカルにごりごり押し込んで高速化したり簡略化出来ると思いますが、これで安定動作しているので今回はこの辺で。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考資料\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考資料\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"http://unityleaning.blog.fc2.com/blog-entry-2.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnityゲーム開発所 - UnityでFPSを設定する方法\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://yaseino.hatenablog.com/entry/2016/02/23/234652\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnityでゲームを作った際に「カクカクしている」と言われないためのTimeSettings.FixedTimestep講座 - 野生のはてなブログ\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://docs.unity3d.com/ja/current/Manual/ExecutionOrder.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eイベント関数の実行順 - Unity マニュアル\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/toRisouP/items/aeddfec470ca6de5924a\" id=\"reference-7a9ed4f386c468e26adb\"\u003e【UniRx】Update()タイミングのイベントをFixedUpdate()のタイミングに変換する - Qiita\u003c/a\u003e\u003cbr\u003e\nとりすーぷさんいつもお世話になっております。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ライセンス表記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%A1%A8%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eライセンス表記\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"http://unity-chan.com/contents/license_jp/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこの記事はユニティちゃんライセンス条項の元に提供されています。\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/487a62b3748c0fb1d7357f77c05d5281ccc5c8d3/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f383239313339352f34343935363537392d33373238306438302d616630312d313165382d383531332d3937323436653061653833372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956579-37280d80-af01-11e8-8513-97246e0ae837.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e55782551a33772c8ec3122c11ff53d4\" alt=\"imagelicenselogo\" data-canonical-src=\"https://user-images.githubusercontent.com/8291395/44956579-37280d80-af01-11e8-8513-97246e0ae837.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fuser-images.githubusercontent.com%2F8291395%2F44956579-37280d80-af01-11e8-8513-97246e0ae837.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=36b055ec4611f2fc6dce0a8e7e186479 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n","createdAt":"2018-09-02T14:05:52Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"I9PUGeLQPxGWyp6AmTlKWMeakUa8KRpI--JGk4VLKGTtrYLZSV--N09bR8uZAtp6yvlPVX02Hg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-06-20T15:59:20Z","likesCount":18,"linkUrl":"https://qiita.com/mkgask/items/6d04d0be13cc0b14d4fb","organization":null,"originalId":686007,"stockedCount":17,"title":"Unity 3DでUpdateとFixedUpdate間のタイミングを考慮したジャンプ（基礎）","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%9F%E7%92%B0%E5%A2%83\"\u003e確認した環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%99%E3%83%BC%E3%82%B9%E7%92%B0%E5%A2%83%E4%BD%9C%E6%88%90\"\u003eベース環境作成\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90\"\u003eプロジェクト作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BA%8A%E4%BD%9C%E6%88%90\"\u003e床作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#unity%E3%81%A1%E3%82%83%E3%82%93%E5%B0%8E%E5%85%A5\"\u003eUnityちゃん導入\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%AD%E3%83%A3%E3%83%A9%E3%82%AF%E3%82%BF%E3%83%BC%E3%81%AEgameobject%E3%81%AB%E5%90%84%E7%A8%AE%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E8%A8%AD%E5%AE%9A\"\u003eプレイヤーキャラクターのGameObjectに各種コンポーネントを設定\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#animator\"\u003eAnimator\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#capsule-collier\"\u003eCapsule Collier\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rigidbody\"\u003eRigidbody\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E4%BD%9C%E6%88%90\"\u003eスクリプト作成\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%A4%E3%83%9F%E3%83%B3%E3%82%B0%E6%A6%82%E5%BF%B5%E5%9B%B3\"\u003eタイミング概念図\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%97%E5%87%A6%E7%90%86%E3%81%AE%E8%A8%AD%E8%A8%88\"\u003eジャンプ処理の設計\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88\"\u003eスクリプト\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8B%95%E3%81%8B%E3%81%99\"\u003e動かす\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#unirx\"\u003eUniRx\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"\u003e参考資料\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%A1%A8%E8%A8%98\"\u003eライセンス表記\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":9755,"uuid":"6d04d0be13cc0b14d4fb","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"4DXCfnPOAuGq2u0l1BKG80JxMwE=--EXPKB0+v4Ii1Izgo--C2UDnddhZeRe2qQwe2hWYQ==","originalId":72594,"description":"業務ではPHP触りつつ趣味ではUnity C#とPythonで遊んでいます。\r\n何か色々やってるのでフォローにはご注意くださいヾ( ╹◡╹)ﾉﾞ ","facebookUrl":null,"githubUrl":"https://github.com/mkgask","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/72594/profile-images/1473699207","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F72594%2Fprofile-images%2F1473699207?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=b910d5ec1b2769448a88f943d3cd0763","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F72594%2Fprofile-images%2F1473699207?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13e12b10c92fd48268dbffad96bda4d6","urlName":"mkgask","websiteUrl":"http://zsw.jp","twitterUrl":"https://twitter.com/mkgask","twitterUrlName":"mkgask","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"ジャンプ","urlName":"%e3%82%b8%e3%83%a3%e3%83%b3%e3%83%97"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
