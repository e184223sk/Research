More than 1 year has passed since last update.これはVisual Basic Advent Calendar 2018の25日目の記事となります。もともと WinForms に 標準(IE)のWebブラウザーコントロールを作成したアプリケーションは、バーコードリーダーを使用してバーコードを入力するタイプのものです。
よって、サイトを表示した段階で入力項目にフォーカスがあり入力できる状態になっている必要があります。初期表示時にはフォーカスがセットされていない。
読込完了イベントにて、_webBrowser.Focus() としてフォーカスがセットするようにします。
UIスレッドなので Invoke メソッドを使用しています。お仕事で作成したものは、_webBrowser.Focus() では何故かフォーカスがセットされなかったため、Win32 APIのSetFocusを使用しました。フォーカスがセットされて入力可能になります。
バーコードリーダーで自動でEnterキーがセットされようにしているので、その際にイベントが動作するようにしたい。
IEのWebブラウザコンポーネントにあった previewkeydown イベントの代わりですね。それには、KeyboardHandleクラスを定義する必要があります。Enterキーを押すとメッセージボックスを表示します。Visual Basic Advent Calendar 2018の最後の記事でした。
参加して頂いた皆様ありがとうございます。


