<!DOCTYPE html><html><head><meta charset="utf-8" /><title>【Unity】クライアントもサーバもwebsocket-sharpで、オンラインゲームを作ってみよう【WebSocket】  - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/riyosy/items/5789ccdeee644b34a743" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="CgPmgqjrFoV+1wN2x000QXw85DFETNVBG3aWlfLRIE12+iJpNxeLnbRTeRtM5RXTvqPazSbAh+NnMyBp0o9IEA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@moyosy" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="【Unity】クライアントもサーバもwebsocket-sharpで、オンラインゲームを作ってみよう【WebSocket】  - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRVlc1cGRIbmpnSkhqZ3Ffamc2bmpncVRqZ3FMamc3UGpnNGpqZ29MamdyWGpnN3pqZzVEamdvSjNaV0p6YjJOclpYUXRjMmhoY25EamdhZmpnSUhqZ3Fyamc3UGpnNm5qZ3FUamc3UGpnckxqZzd6amc2RGpncExrdlp6amdhUGpnYWJqZ2JfamdvampnWWJqZ0pCWFpXSlRiMk5yWlhUamdKRWcmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9OGU1MjEwNTkxMzZkMDkwZWVjMzJiMGU1YzA0ZDAyZGY&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSEpwZVc5emVRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZjVmMDhjZTAxMzRhZGE1ZDE2MDM0OWNmYTk4MTFiYzY&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=9e89769e7c447c8577b6819f113170ba"><meta property="og:description" content="初めまして。
初投稿です。
未熟も未熟者ですが、よろしくお願いいたします。

早速ですが掲題の通り、
WebSocketを使ったUnityのゲームの作り方、サーバの用意の仕方とかを紹介したいと思います。
初心者でも分かるように、スクシ..."><meta content="https://qiita.com/riyosy/items/5789ccdeee644b34a743" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,初心者,websocket,オンラインゲーム" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-a83e7f32-0433-4894-b78d-fb94bf47fb54"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Friyosy%2Fitems%2F5789ccdeee644b34a743">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Friyosy%2Fitems%2F5789ccdeee644b34a743">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-a83e7f32-0433-4894-b78d-fb94bf47fb54">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-09-01T13:21:31.000+09:00","dateModified":"2019-09-01T13:21:31.000+09:00","headline":"【Unity】クライアントもサーバもwebsocket-sharpで、オンラインゲームを作ってみよう【WebSocket】 ","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRVlc1cGRIbmpnSkhqZ3Ffamc2bmpncVRqZ3FMamc3UGpnNGpqZ29MamdyWGpnN3pqZzVEamdvSjNaV0p6YjJOclpYUXRjMmhoY25EamdhZmpnSUhqZ3Fyamc3UGpnNm5qZ3FUamc3UGpnckxqZzd6amc2RGpncExrdlp6amdhUGpnYWJqZ2JfamdvampnWWJqZ0pCWFpXSlRiMk5yWlhUamdKRWcmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9OGU1MjEwNTkxMzZkMDkwZWVjMzJiMGU1YzA0ZDAyZGY\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSEpwZVc5emVRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZjVmMDhjZTAxMzRhZGE1ZDE2MDM0OWNmYTk4MTFiYzY\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=9e89769e7c447c8577b6819f113170ba","mainEntityOfPage":"https://qiita.com/riyosy/items/5789ccdeee644b34a743","author":{"@type":"Person","address":"","email":null,"identifier":"riyosy","name":"riyosy","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fprofile-images%2F1567311531?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=ccaef4d655963ed8583238a9ce85e787","url":"https://qiita.com/riyosy","description":"よくわからんがまぁ動いているからヨシ！的な思考から抜け出せません。。。\r\nご指導ご鞭撻のほど、よろしくお願い申し上げます。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita&amp;utm_medium=header-banner">「不動産取引をワンクリックで完結する」世界観へ。GA technologiesの取り組み</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"riyosy","type":"items","id":"5789ccdeee644b34a743"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「不動産取引をワンクリックで完結する」世界観へ。GA technologiesの取り組み","url":"https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"riyosy","type":"items","id":"5789ccdeee644b34a743"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「不動産取引をワンクリックで完結する」世界観へ。GA technologiesの取り組み","url":"https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"riyosy","type":"items","id":"5789ccdeee644b34a743"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「不動産取引をワンクリックで完結する」世界観へ。GA technologiesの取り組み","url":"https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/riyosy/items/5789ccdeee644b34a743","location":"/riyosy/items/5789ccdeee644b34a743","scheme":"https","host":"qiita.com","port":null,"pathname":"/riyosy/items/5789ccdeee644b34a743","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"eAVf26zc34mgKvxbxGo31QUrpJdynHQvbULnGY3VBdUE/JswMyBCkWquhjZPwhZHx7SaaxAQJo0RB1HlrYttiA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-928d3e26-facd-4fe8-af73-c9798d5c8362"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/riyosy/items/5789ccdeee644b34a743/likers" class="css-1iupg5d">12</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">16</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/5789ccdeee644b34a743/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/riyosy/items/5789ccdeee644b34a743/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/riyosy/items/5789ccdeee644b34a743/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/riyosy/items/5789ccdeee644b34a743/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/riyosy/items/5789ccdeee644b34a743.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/riyosy"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/profile-images/1567311531" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/riyosy" class="css-10ougpm">@<!-- -->riyosy</a><div class="css-1ay9vb9"><time dateTime="2019-09-01T04:21:31Z" class="css-m19uds">posted at 2019-09-01</time></div></div></div></div></div><h1 class="css-cgzq40">【Unity】クライアントもサーバもwebsocket-sharpで、オンラインゲームを作ってみよう【WebSocket】 </h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/%e5%88%9d%e5%bf%83%e8%80%85" class="css-4czcte">初心者</a><a href="/tags/websocket" class="css-4czcte">websocket</a><a href="/tags/%e3%82%aa%e3%83%b3%e3%83%a9%e3%82%a4%e3%83%b3%e3%82%b2%e3%83%bc%e3%83%a0" class="css-4czcte">オンラインゲーム</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>初めまして。<br>
初投稿です。<br>
未熟も未熟者ですが、よろしくお願いいたします。</p>

<p>早速ですが掲題の通り、<br>
WebSocketを使ったUnityのゲームの作り方、サーバの用意の仕方とかを紹介したいと思います。<br>
初心者でも分かるように、スクショ多めにがんばります。</p>

<h1>
<span id="環境" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>環境</h1>

<ul>
<li>Windows10</li>
<li>Unity 2019.2.2f1</li>
<li>Visual Studio Community 2019</li>
</ul>

<h1>
<span id="おおまかな流れ" class="fragment"></span><a href="#%E3%81%8A%E3%81%8A%E3%81%BE%E3%81%8B%E3%81%AA%E6%B5%81%E3%82%8C"><i class="fa fa-link"></i></a>おおまかな流れ</h1>

<p>とりあえず簡単なチャットアプリを作りたいと思います。</p>

<p>やり方ですが、一つのプロジェクト上に、<br>
サーバ側でのみ使うシーン、<br>
クライアント側でのみ使うシーンの2つを作ります。</p>

<p>クライアント側のシーンは、サーバへデータを送信する処理を、<br>
サーバ側のシーンは、クライアントからのデータ送信を待ち受ける処理を実行させることで、<br>
サーバ、クライアント間でのデータ送受信を実現したいと思います。</p>

<p>イメージこんな感じ。<br>
<a href="https://camo.qiitausercontent.com/bdc85c6cfe0189c375650c0c1fd7de13e2dbe09d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f38373139326636362d643663312d666335642d353361312d3366313539343965333961352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F87192f66-d6c1-fc5d-53a1-3f15949e39a5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d3540bbc9f2d5b7c3673c37f6662c79b" alt="uni1.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/87192f66-d6c1-fc5d-53a1-3f15949e39a5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F87192f66-d6c1-fc5d-53a1-3f15949e39a5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4dad86448397d4d745045bb7b3bfeeab 1x" loading="lazy"></a></p>

<h1>
<span id="プロジェクトにwebsocket-sharpを適用しよう" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%ABwebsocket-sharp%E3%82%92%E9%81%A9%E7%94%A8%E3%81%97%E3%82%88%E3%81%86"><i class="fa fa-link"></i></a>プロジェクトにwebsocket-sharpを適用しよう</h1>

<h2>
<span id="前準備" class="fragment"></span><a href="#%E5%89%8D%E6%BA%96%E5%82%99"><i class="fa fa-link"></i></a>前準備</h2>

<p>websocket-sharpのgithubのページに行き、ソースをzipでダウンロードしましょう。</p>

<p><qiita-embed-ogp src="https://github.com/sta/websocket-sharp"></qiita-embed-ogp></p>

<p><a href="https://camo.qiitausercontent.com/677f3abf7947c65fefbad7e045ed46e21cfadb88/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32343135613130312d323131362d633230632d646665382d6135373536623863326564362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2415a101-2116-c20c-dfe8-a5756b8c2ed6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c545efd5a3c24863b19fd6f51d8d39ef" alt="i1.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/2415a101-2116-c20c-dfe8-a5756b8c2ed6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2415a101-2116-c20c-dfe8-a5756b8c2ed6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=473ce449f343d63ec8fdc50a98dc3a7c 1x" loading="lazy"></a></p>

<p>ダウンロードしたらファイルを解凍し、中のwebsocket-sharp.slnをダブルクリックしてVisualStudioを起動させましょう。</p>

<p>ソリューションエクスプローラーから、Exampleは消してしまいましょう。<br>
<a href="https://camo.qiitausercontent.com/958173cb4e1f75b12ca785743810c7b6c9e45a99/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32393139313336322d623339372d343863612d613433392d3738393366383931343764302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F29191362-b397-48ca-a439-7893f89147d0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5fb804ff3773b1e9c730bad275c19d02" alt="i2.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/29191362-b397-48ca-a439-7893f89147d0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F29191362-b397-48ca-a439-7893f89147d0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a956fff6d23b730ed88734eb24f64b81 1x" loading="lazy"></a></p>

<p>このあと、ビルドをしたいのですが、websocket-sharp\Net\CookieException.csでエラーが起きてしまいますので、<br>
下記のように書き換えます。<br>
(下記記事より引用)<br>
<a href="https://techblog.primestructure.co.jp/2019/06/28/unity-%E3%81%A7-websocket-%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E7%94%A8%E3%81%84%E3%81%A6%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%BF%E3%82%A4%E3%83%A0%E9%80%9A%E4%BF%A1%E3%81%99%E3%82%8B/" class="autolink" rel="nofollow noopener" target="_blank">https://techblog.primestructure.co.jp/2019/06/28/unity-%E3%81%A7-websocket-%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E7%94%A8%E3%81%84%E3%81%A6%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%BF%E3%82%A4%E3%83%A0%E9%80%9A%E4%BF%A1%E3%81%99%E3%82%8B/</a></p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">CookieException.cs(修正前)</span></div>
<div class="highlight"><pre class="with-code"><code>  <span class="k">public</span> <span class="k">class</span> <span class="nc">CookieException</span> <span class="p">:</span> <span class="n">FormatException</span>
  <span class="p">{</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">CookieException.cs(修正後)</span></div>
<div class="highlight"><pre class="with-code"><code>  <span class="k">public</span> <span class="k">class</span> <span class="nc">CookieException</span> <span class="p">:</span> <span class="n">FormatException</span><span class="p">,</span> <span class="n">ISerializable</span>
  <span class="p">{</span>
</code></pre></div>
</div>

<p>ソリューション構成を、「Release」にします。</p>

<p><a href="https://camo.qiitausercontent.com/d5d7a229d69d396b01646f6490ce570aad8620c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f61616338666332652d623739362d386564382d366163612d6437343739656261613130632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Faac8fc2e-b796-8ed8-6aca-d7479ebaa10c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=edbd6f216dfb7c59cb2ab6700d82c5f6" alt="i3.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/aac8fc2e-b796-8ed8-6aca-d7479ebaa10c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Faac8fc2e-b796-8ed8-6aca-d7479ebaa10c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=32aa82d4475c37772bcd8e7557f96389 1x" loading="lazy"></a></p>

<p>以上の手順が済んだら、ビルドをしましょう。</p>

<p><a href="https://camo.qiitausercontent.com/ca7b6a79c64af113f1c9579b40ec8d784d4d53ac/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f65363062363430322d336437322d633234392d393433612d3962633530643262343234382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe60b6402-3d72-c249-943a-9bc50d2b4248.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7ede2d9d4d0713df667acc0303043fe2" alt="i4.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/e60b6402-3d72-c249-943a-9bc50d2b4248.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe60b6402-3d72-c249-943a-9bc50d2b4248.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=47daf72c437d7b67068f27e6ce41a6ad 1x" loading="lazy"></a></p>

<p>正常にビルドが終了すると、websocket-sharp\bin\Release上にwebsocket-sharp.dllができるはずです。これを、Unityのプロジェクトに適用します。<br>
<a href="https://camo.qiitausercontent.com/faafef06845b82282b5f654301783f751e1ff665/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f39356531626631322d666464642d386231652d323237332d3532363435663564383730352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F95e1bf12-fddd-8b1e-2273-52645f5d8705.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b0c54d64837a9dd293d0f408fd11ab50" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/95e1bf12-fddd-8b1e-2273-52645f5d8705.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F95e1bf12-fddd-8b1e-2273-52645f5d8705.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8a3de64914981f3e1d6d48db1333bd77 1x" loading="lazy"></a></p>

<h2>
<span id="websocket-sharpの適用" class="fragment"></span><a href="#websocket-sharp%E3%81%AE%E9%81%A9%E7%94%A8"><i class="fa fa-link"></i></a>websocket-sharpの適用</h2>

<p>Unityのプロジェクトを新規に作りましょう。ここでは「SampleProject」と呼称しておきます。<br>
次に、Assetsフォルダの中に、Pluginsフォルダを作ります。<br>
その中に、さきほど生成したwebsocket-sharp.dllを入れましょう。</p>

<p><a href="https://camo.qiitausercontent.com/e010d70835d9a45de5c9a87d74c78746d1a7b044/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f30346466623338642d613631382d653930662d653230632d3263613134323262393339342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F04dfb38d-a618-e90f-e20c-2ca1422b9394.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5d470f543173c1f214633ed47765af25" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/04dfb38d-a618-e90f-e20c-2ca1422b9394.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F04dfb38d-a618-e90f-e20c-2ca1422b9394.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3373e9831f230daa1c691fffe039675a 1x" loading="lazy"></a></p>

<p>これで、SampleProjectはWebSocketを使うための準備が整いました。</p>

<h1>
<span id="クライアント側の実装" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%81%B4%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>クライアント側の実装</h1>

<p>Sceneフォルダに、「ClientScene」というシーンを作り、その配下に以下のオブジェクトを用意しておきましょう。</p>

<ul>
<li>ChatText・・・チャットを表示するためのText</li>
<li>MessageInput・・・メッセージを送信するためのInputField</li>
<li>SendButton・・・メッセージ送信処理をするためのButton</li>
<li>ClientManager・・・WebSocketでサーバとの処理をするための空オブジェクト
<a href="https://camo.qiitausercontent.com/1a9978cf43ea440911aef377d868409a40519061/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f66636535633865652d653734612d363631362d383136302d3639343336366438646664312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffce5c8ee-e74a-6616-8160-694366d8dfd1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5ed814b479d572ff3bd5fc79bd3d4a6c" alt="i8.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/fce5c8ee-e74a-6616-8160-694366d8dfd1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffce5c8ee-e74a-6616-8160-694366d8dfd1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=707dfe8e6c400bd61ee1543ff08247c2 1x" loading="lazy"></a>
</li>
</ul>

<p>次に、プログラムを作っていきましょう。<br>
Assetsフォルダの中に、Scriptsフォルダを作り、その中に「ClientManager.cs」というC#スクリプトを用意します。</p>

<p>ClientManager.csの中身には、<br>
サーバへの接続処理、メッセージの送信処理、メッセージ表示処理を用意しておきます。</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">ClientManager.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.UI</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">ClientManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
   <span class="k">public</span> <span class="n">WebSocket</span> <span class="n">ws</span><span class="p">;</span>
   <span class="k">public</span> <span class="n">Text</span> <span class="n">chatText</span><span class="p">;</span>
   <span class="k">public</span> <span class="n">Button</span> <span class="n">sendButton</span><span class="p">;</span>
   <span class="k">public</span> <span class="n">InputField</span> <span class="n">messageInput</span><span class="p">;</span>

   <span class="c1">//サーバへ、メッセージを送信する</span>
   <span class="k">public</span> <span class="k">void</span> <span class="nf">SendText</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span><span class="p">(</span><span class="n">messageInput</span><span class="p">.</span><span class="n">text</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="c1">//サーバから受け取ったメッセージを、ChatTextに表示する</span>
   <span class="k">public</span> <span class="k">void</span> <span class="nf">RecvText</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="n">chatText</span><span class="p">.</span><span class="n">text</span> <span class="p">+=</span> <span class="p">(</span><span class="n">text</span> <span class="p">+</span> <span class="s">"\n"</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="c1">//サーバの接続が切れたときのメッセージを、ChatTextに表示する</span>
   <span class="k">public</span> <span class="k">void</span> <span class="nf">RecvClose</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="n">chatText</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="p">(</span><span class="s">"Close."</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="c1">//接続処理。接続先サーバと、ポート番号を指定する</span>
      <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span><span class="p">(</span><span class="s">"ws://localhost:12345/"</span><span class="p">);</span>
      <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span><span class="p">();</span>

      <span class="c1">//送信ボタンが押されたときに実行する処理「SendText」を登録する</span>
      <span class="n">sendButton</span><span class="p">.</span><span class="n">onClick</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="n">SendText</span><span class="p">);</span>
      <span class="c1">//サーバからメッセージを受信したときに実行する処理「RecvText」を登録する</span>
      <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nf">RecvText</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>
      <span class="c1">//サーバとの接続が切れたときに実行する処理「RecvClose」を登録する</span>
      <span class="n">ws</span><span class="p">.</span><span class="n">OnClose</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nf">RecvClose</span><span class="p">();</span>
   <span class="p">}</span>
<span class="p">}</span>


</code></pre></div>
</div>

<p>ではこのClientManager.csを、空オブジェクトとして用意しておいたClientManagerオブジェクトにアタッチします。<br>
ついでに他の各オブジェクトを、ClientManager.csのpublic フィールドとして定義していた変数たちにドラッグ＆ドロップで適用させておきます。<br>
<a href="https://camo.qiitausercontent.com/b95ee6a721d64b8b18856a16355acad91844dab9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f33366363623432302d373264652d383563312d316438622d3161626633623561333964302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F36ccb420-72de-85c1-1d8b-1abf3b5a39d0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4720302a18a1fb86a44d0e6fe0c47bb1" alt="i7.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/36ccb420-72de-85c1-1d8b-1abf3b5a39d0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F36ccb420-72de-85c1-1d8b-1abf3b5a39d0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=36f67ec552591f1a0d9b983666a41ce5 1x" loading="lazy"></a></p>

<p>以上でクライアント側の実装は終わりです。<br>
「画面を起動したらサーバへ自動的にログインをし、メッセージを書いてSendボタンを押したらメッセージが送信される」、これらすべてが用意できました。</p>

<h1>
<span id="サーバ側の実装" class="fragment"></span><a href="#%E3%82%B5%E3%83%BC%E3%83%90%E5%81%B4%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>サーバ側の実装</h1>

<p>「ServerScene」というシーンを作り、その配下に以下のオブジェクトを用意しておきましょう。</p>

<ul>
<li>ServerManager・・・WebSocketでクライアントとの処理をするための空オブジェクト</li>
</ul>

<p>サーバはあくまでサーバですから、画面を作るってことは特にないですね・・・<br>
<a href="https://camo.qiitausercontent.com/7b764e0aee239f118ce8a92435361aa571e57140/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f64336166353464362d666534312d616434322d366537372d3937626161633039306239302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fd3af54d6-fe41-ad42-6e77-97baac090b90.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=388b7404146457ab6354f0871a371382" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/d3af54d6-fe41-ad42-6e77-97baac090b90.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fd3af54d6-fe41-ad42-6e77-97baac090b90.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2eca056de751b90999c34a73e1bd6d2c 1x" loading="lazy"></a></p>

<p>では、サーバ側もプログラムを作っていきましょう。<br>
「ServerManager.cs」というC#スクリプトを用意します。</p>

<p>ServerManager.csの中身には、<br>
サーバ起動処理、クライアントのメッセージ送信待ち受け処理、接続クライアント全員へのメッセージ送信処理を用意しておきます。</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">ServerManager.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp.Server</span><span class="p">;</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ServerManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
   <span class="n">WebSocketServer</span> <span class="n">ws</span><span class="p">;</span>
   <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="c1">//ポート番号を指定</span>
      <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocketServer</span><span class="p">(</span><span class="m">12345</span><span class="p">);</span>
      <span class="c1">//クライアントからの通信時の挙動を定義したクラス、「ExWebSocketBehavior」を登録</span>
      <span class="n">ws</span><span class="p">.</span><span class="n">AddWebSocketService</span><span class="p">&lt;</span><span class="n">ExWebSocketBehavior</span><span class="p">&gt;(</span><span class="s">"/"</span><span class="p">);</span>
      <span class="c1">//サーバ起動</span>
      <span class="n">ws</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
      <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"サーバ起動"</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">private</span> <span class="k">void</span> <span class="nf">OnApplicationQuit</span><span class="p">()</span>
   <span class="p">{</span>
      <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"サーバ停止"</span><span class="p">);</span>
      <span class="n">ws</span><span class="p">.</span><span class="nf">Stop</span><span class="p">();</span>
   <span class="p">}</span>
   <span class="k">public</span> <span class="k">class</span> <span class="nc">ExWebSocketBehavior</span> <span class="p">:</span> <span class="n">WebSocketBehavior</span>
   <span class="p">{</span>
      <span class="c1">//誰が現在接続しているのか管理するリスト。</span>
      <span class="k">public</span> <span class="k">static</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ExWebSocketBehavior</span><span class="p">&gt;</span> <span class="n">clientList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">ExWebSocketBehavior</span><span class="p">&gt;();</span>
      <span class="c1">//接続者に番号を振るための変数。</span>
      <span class="k">static</span> <span class="kt">int</span> <span class="n">globalSeq</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
      <span class="c1">//自身の番号</span>
      <span class="kt">int</span> <span class="n">seq</span><span class="p">;</span>

      <span class="c1">//誰かがログインしてきたときに呼ばれるメソッド</span>
      <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnOpen</span><span class="p">()</span>
      <span class="p">{</span>
         <span class="c1">//ログインしてきた人には、番号をつけて、リストに登録。</span>
         <span class="n">globalSeq</span><span class="p">++;</span>
         <span class="k">this</span><span class="p">.</span><span class="n">seq</span> <span class="p">=</span> <span class="n">globalSeq</span><span class="p">;</span>
         <span class="n">clientList</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

         <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Seq"</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">seq</span> <span class="p">+</span> <span class="s">" Login. ("</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">ID</span> <span class="p">+</span> <span class="s">")"</span><span class="p">);</span>

         <span class="c1">//接続者全員にメッセージを送る</span>
         <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">client</span> <span class="k">in</span> <span class="n">clientList</span><span class="p">)</span>
         <span class="p">{</span>
            <span class="n">client</span><span class="p">.</span><span class="nf">Send</span><span class="p">(</span><span class="s">"Seq:"</span> <span class="p">+</span> <span class="n">seq</span> <span class="p">+</span> <span class="s">" Login."</span><span class="p">);</span>
         <span class="p">}</span>
      <span class="p">}</span>
      <span class="c1">//誰かがメッセージを送信してきたときに呼ばれるメソッド</span>
      <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="n">MessageEventArgs</span> <span class="n">e</span><span class="p">)</span>
      <span class="p">{</span>
         <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Seq:"</span> <span class="p">+</span> <span class="n">seq</span> <span class="p">+</span> <span class="s">"..."</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>
         <span class="c1">//接続者全員にメッセージを送る</span>
         <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">client</span> <span class="k">in</span> <span class="n">clientList</span><span class="p">)</span>
         <span class="p">{</span>
            <span class="n">client</span><span class="p">.</span><span class="nf">Send</span><span class="p">(</span><span class="s">"Seq:"</span> <span class="p">+</span> <span class="n">seq</span> <span class="p">+</span> <span class="s">"..."</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>
         <span class="p">}</span>
      <span class="p">}</span>

      <span class="c1">//誰かがログアウトしてきたときに呼ばれるメソッド</span>
      <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnClose</span><span class="p">(</span><span class="n">CloseEventArgs</span> <span class="n">e</span><span class="p">)</span>
      <span class="p">{</span>
         <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Seq"</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">seq</span> <span class="p">+</span> <span class="s">" Logout. ("</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">ID</span> <span class="p">+</span> <span class="s">")"</span><span class="p">);</span>

         <span class="c1">//ログアウトした人を、リストから削除。</span>
         <span class="n">clientList</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

         <span class="c1">//接続者全員にメッセージを送る</span>
         <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">client</span> <span class="k">in</span> <span class="n">clientList</span><span class="p">)</span>
         <span class="p">{</span>
            <span class="n">client</span><span class="p">.</span><span class="nf">Send</span><span class="p">(</span><span class="s">"Seq:"</span> <span class="p">+</span> <span class="n">seq</span> <span class="p">+</span> <span class="s">" Logout."</span><span class="p">);</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>ExWebSocketBehaviorはWebSocketBehaviorを継承しています。<br>
WebSocketBehaviorは抽象クラスで、このクラスの持つ様々なメソッドをオーバーライドすることで、<br>
サーバ側の挙動をカスタマイズすることができます。今回のサンプルではOnOpenとOnMessageとOnCloseだけ使いましたが、<br>
他にも様々なメソッドがあります。また様々なフィールドも定義されています。適宜、必要なものを使っていくといいと思います。</p>

<p>ちなみに、「接続者全員にメッセージを送る」という処理は、以下のように代替もできます。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code>     <span class="c1">//接続者全員にメッセージを送る</span>
      <span class="c1">// foreach (var client in clientList)</span>
      <span class="c1">// {</span>
      <span class="c1">//    client.Send("Seq:" + seq + "..." + e.Data);</span>
      <span class="c1">// }</span>
      <span class="k">this</span><span class="p">.</span><span class="n">Sessions</span><span class="p">.</span><span class="nf">Broadcast</span><span class="p">(</span><span class="s">"Seq:"</span> <span class="p">+</span> <span class="n">seq</span> <span class="p">+</span> <span class="s">"..."</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>
</code></pre></div></div>

<p>「とにかく全員に送ればよい」ということであれば、上記コードでいいと思います。<br>
しかし、「特定の誰かだけに送る」とか、「条件によって、特定の人には送らない」みたいなことをやろうと思ったら、<br>
上記のようなWebSocketBehaviorのリストを作って、その中から送る相手を選択するような実装になるんじゃないかなーと思っています。</p>

<p>それでは、このServerManager.csを、空オブジェクトとして用意しておいたServerManagerオブジェクトにアタッチします。<br>
これでサーバ側の実装は終わりです。<br>
「接続しているクライアントを管理し、クライアントからメッセージを受信したら、全員にそのメッセージを送信する」、これらすべての用意ができました。</p>

<h1>
<span id="ビルド" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89"><i class="fa fa-link"></i></a>ビルド</h1>

<p>実際に動かすために、ビルドしていきましょう。</p>

<p>手順ですが、クライアント側、サーバ側、それぞれを分けてビルドしていく必要があります。</p>

<p>サーバ側は、ServerSceneだけを対象にビルド、<br>
クライアント側は、ClientSceneだけを対象にビルド、という感じになります。<br>
それぞれフォルダを分けて、別々のところに保存しましょう。<br>
<a href="https://camo.qiitausercontent.com/3ca71185887d87e1761f6cf71ae6088cc07dd172/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f31346263303733652d646435632d656336392d656532642d3264653433363062336432642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F14bc073e-dd5c-ec69-ee2d-2de4360b3d2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=38e7570d9c006280a84157a0edc8a928" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/14bc073e-dd5c-ec69-ee2d-2de4360b3d2d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F14bc073e-dd5c-ec69-ee2d-2de4360b3d2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=358b610d1bb978911e826d22470a7682 1x" loading="lazy"></a><br>
<a href="https://camo.qiitausercontent.com/f4303eef9ef67faac39ea2b782249665b7a391c3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32383432316666652d393732382d396135302d336562332d6564373537356630633534372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F28421ffe-9728-9a50-3eb3-ed7575f0c547.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=014cb489090f34b5e54d87fce51dbf26" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/28421ffe-9728-9a50-3eb3-ed7575f0c547.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F28421ffe-9728-9a50-3eb3-ed7575f0c547.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5e1f215755f698bb975480534a15eb3d 1x" loading="lazy"></a></p>

<h1>
<span id="動作確認" class="fragment"></span><a href="#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>動作確認</h1>

<p>では動かしていきましょう。<br>
チャットしてる感を出したいので、サーバ側のSampleProject.exeを1つ、クライアント側のSampleProject.exeを3つ起動してみましょう。<br>
(クライアント側は、起動したらすぐに接続処理を始めてしまうので、サーバ側の方を先に起動しておくようにしましょう)<br>
<a href="https://camo.qiitausercontent.com/82e4a55ddb432b0a4503e6ce7d96f56a3158623a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f66646335353635312d626261352d653035312d373463612d6561343265666566343561662e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffdc55651-bba5-e051-74ca-ea42efef45af.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9f87aab451c36c5cc94368f69a513f6f" alt="websocket1.gif" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/fdc55651-bba5-e051-74ca-ea42efef45af.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffdc55651-bba5-e051-74ca-ea42efef45af.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fe2888fa3d7d8495318038ed1710559a 1x" loading="lazy"></a><br>
3つのクライアントで、チャットができるようになりました。またクライアントが切断をすると、他のクライアントにログアウトのメッセージが表示されること、<br>
サーバを閉じるとその旨がクライアントにも通知されること、なども確認できると思います。</p>

<h1>
<span id="デプロイしてみようおまけ" class="fragment"></span><a href="#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%97%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86%E3%81%8A%E3%81%BE%E3%81%91"><i class="fa fa-link"></i></a>デプロイしてみよう（おまけ）</h1>

<p><strong>※ここからの作業は、お金がかかってきます。</strong></p>

<p>上記の動作確認では、ローカルのアドレスに対し接続を行っていたので、いまいちオンラインしてる感がありません。<br>
実際にインターネット上のサーバを借りて、そこにサーバ側SampleProjectを実行してみることにしました。</p>

<p>VPSでもEC2でも、なんでもいいのですが、<br>
僕はとりあえず、EC2のUbuntuで作成してみました。<br>
<a href="https://camo.qiitausercontent.com/a677585101c9f0ff151bbc2feac4b4178bc855cc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32656139306363652d313036352d353438382d326132372d6566383238346664323939652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2ea90cce-1065-5488-2a27-ef8284fd299e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=44b20032df7b828ec3bf70997f327c19" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/2ea90cce-1065-5488-2a27-ef8284fd299e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2ea90cce-1065-5488-2a27-ef8284fd299e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=dee76f5476b0b6a48c07efbaa678f447 1x" loading="lazy"></a></p>

<p>Linuxサーバでサーバ側SampleProjectを動かすには、Linux用にビルドをする必要があります。<br>
<a href="https://camo.qiitausercontent.com/91784b90e5418045c60fd95799ce3f86ca37f1e2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f65346564663336632d346139362d393165352d643036322d3538383364613234643430332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe4edf36c-4a96-91e5-d062-5883da24d403.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=12d4ccc7f211c78c25097b411218138d" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/e4edf36c-4a96-91e5-d062-5883da24d403.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe4edf36c-4a96-91e5-d062-5883da24d403.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=112095c084ceab2230f5aa1f5c1b3e4f 1x" loading="lazy"></a></p>

<p>上記設定でビルドすると、SampleProject.x86_64とSampleProject_Dataが作成されました。<br>
この2つをLinuxサーバ上に持っていきます。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code>ubuntu@xxxxxxxxxx:~/unity/SampleProject<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 27648
drwxrwxr-x 3 ubuntu ubuntu     4096 Aug 31 22:22 <span class="nb">.</span>
drwxrwxr-x 4 ubuntu ubuntu     4096 Aug 31 22:22 ..
drwxrwxr-x 5 ubuntu ubuntu     4096 Aug 31 22:22 SampleProject_Data
<span class="nt">-rw-rw-r--</span> 1 ubuntu ubuntu 28295568 Aug 31 22:22 SampleProject.x86_64
</code></pre></div></div>

<p>さて、実際に動かすわけですが、そのまえにSampleProject.x86_64の実行権限を付与してあげましょう。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code>ubuntu@xxxxxxxxxx:~/unity/SampleProject<span class="nv">$ </span><span class="nb">chmod </span>755 SampleProject.x86_64 
ubuntu@xxxxxxxxxx:~/unity/SampleProject<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 27648
drwxrwxr-x 3 ubuntu ubuntu     4096 Aug 31 22:22 <span class="nb">.</span>
drwxrwxr-x 4 ubuntu ubuntu     4096 Aug 31 22:22 ..
drwxrwxr-x 5 ubuntu ubuntu     4096 Aug 31 22:22 SampleProject_Data
<span class="nt">-rwxr-xr-x</span> 1 ubuntu ubuntu 28295568 Aug 31 22:22 SampleProject.x86_64
</code></pre></div></div>

<p>それではサーバ起動！</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code>ubuntu@xxxxxxxxxx:~/unity/SampleProject<span class="nv">$ </span>./SampleProject.x86_64 
～～～
（なんやかんやログが出る）
～～～
UnloadTime: 0.677017 ms
サーバ起動
</code></pre></div></div>

<p>起動したっぽいですね。それでは、ローカルのPC上から、このLinuxサーバのSampleProjectに接続をしてみます。<br>
あ、ClientManager.cs内にある、接続先IPアドレスやポート番号の指定を、このLinuxサーバに合わせて書き換えることをお忘れずに。</p>

<p><a href="https://camo.qiitausercontent.com/076e8b7a1f64920ed8d6ac42ed2823498141db9d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f63343064333738362d613264312d363239342d396139382d3932653931313863316236632e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fc40d3786-a2d1-6294-9a98-92e9118c1b6c.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9dc13c846f60fd3e227a45766490a71a" alt="websocket2.gif" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/c40d3786-a2d1-6294-9a98-92e9118c1b6c.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fc40d3786-a2d1-6294-9a98-92e9118c1b6c.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bc42d40ed2bb2aefd668cd1d0b36a7a0 1x" loading="lazy"></a></p>

<p>問題なく動作していますね。サーバ側は、画面を起動していません。こういった起動モードを、Headlessモードとか言ったりします。<br>
Headlessモードで起動した場合、Debug.Log()とかで書いたログ出力処理は上記のようにコンソール上に出るようになります。<br>
ログ解析とかに役立ちそうですね。</p>

<p>ちなみに、「自分がHeadlessモードで起動しているか」を判断する方法があったりします。<br>
<a href="https://qiita.com/su10/items/a56762ce3fe1b529e0bd" class="autolink" id="reference-34ad2a8235458923c93c">https://qiita.com/su10/items/a56762ce3fe1b529e0bd</a></p>

<p>ですので、「Headlessモードであれば、ServerManagerを実行し、そうでなければClientManagerを実行する」みたいな分岐処理を入れておけば、<br>
いちいちビルドを2つに分ける必要もなくなるので、かなり楽になりそうですね。</p>

<h1>
<span id="終わりに" class="fragment"></span><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>終わりに</h1>

<p>特に作り込むこともなく、オンライン処理ができるようになりました。<br>
また、サーバ側、クライアント側両方をUnity上で実装できるっていうのは、かなりありがたい（？）ことに感じます。<br>
(昔オンラインゲームをちょっと作ってみた時、クライアント側はUnity、サーバ側はPythonとかいう謎構成でやっていました。<br>
なのでC#のコード、Pythonのコード、お互いで使い回せる部分が少なすぎて手間2倍だった思い出があります)</p>

<p>このサーバが、どのぐらいの負荷に耐えられるかは未検証ですが、ガリガリ作り込めば、カードゲームだろうとFPSだろうと、<br>
なんでも作れそうな感じがして、夢が膨らみますね。</p>

<h1>
<span id="独り言" class="fragment"></span><a href="#%E7%8B%AC%E3%82%8A%E8%A8%80"><i class="fa fa-link"></i></a>独り言</h1>

<ul>
<li>Unityエディタ上でシーンをダブルクリックすると、VSCodeが起動してしまうのは何故なんでしょう・・・？　確かにC#コーディングはVSCodeでやってますが、シーンは別にVSCode使わないっつーの　<img alt=":rage:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f621.png" title=":rage:" width="20" loading="lazy"><img alt=":rage:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f621.png" title=":rage:" width="20" loading="lazy"><img alt=":rage:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f621.png" title=":rage:" width="20" loading="lazy">
</li>
<li>Textオブジェクトのtextを変更しても、画面上に反映されない現象に見舞われています。　</li>
</ul>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code>      <span class="n">chatText</span><span class="p">.</span><span class="n">text</span> <span class="p">+=</span> <span class="p">(</span><span class="n">text</span> <span class="p">+</span> <span class="s">"\n"</span><span class="p">);</span>
</code></pre></div></div>

<p>これやっても画面上に変更が反映されません。なんでこんな単純なことができなくなったんや　<img alt=":innocent:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png" title=":innocent:" width="20" loading="lazy"><img alt=":innocent:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png" title=":innocent:" width="20" loading="lazy"><img alt=":innocent:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png" title=":innocent:" width="20" loading="lazy"><img alt=":innocent:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png" title=":innocent:" width="20" loading="lazy"><img alt=":innocent:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png" title=":innocent:" width="20" loading="lazy"><br>
（結局、この処理の前後に、chatText.enabled = false;とかtrue;とかを入れて再表示させることで、今回のサンプルではごまかしました）</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Friyosy%2Fitems%2F5789ccdeee644b34a743&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Friyosy%2Fitems%2F5789ccdeee644b34a743&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/riyosy/items/5789ccdeee644b34a743/likers" class="css-1iupg5d">12</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">16</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/5789ccdeee644b34a743/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/riyosy/items/5789ccdeee644b34a743/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/riyosy/items/5789ccdeee644b34a743/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/riyosy/items/5789ccdeee644b34a743/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/riyosy/items/5789ccdeee644b34a743.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-928d3e26-facd-4fe8-af73-c9798d5c8362">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-ab75aaaf-6473-41aa-8192-41d4e6bdba3b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-ab75aaaf-6473-41aa-8192-41d4e6bdba3b">{}</script>
      
<div id="LoginModal-react-component-75815f35-13e2-4893-b9a3-224c186c3e31"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-75815f35-13e2-4893-b9a3-224c186c3e31">{}</script>
      
<div id="StockModal-react-component-1f4b6c5a-ead8-493e-94dd-2a790d2f80e2"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-1f4b6c5a-ead8-493e-94dd-2a790d2f80e2">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;//F1Gv1jabz+2tdErOpNoLxVTC2PnndM19iIz/tenR2DCLHxYp/0pDRerSknQmwyfspy0e0SJe6rnT4z2wD1QA==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e初めまして。\u003cbr\u003e\n初投稿です。\u003cbr\u003e\n未熟も未熟者ですが、よろしくお願いいたします。\u003c/p\u003e\n\n\u003cp\u003e早速ですが掲題の通り、\u003cbr\u003e\nWebSocketを使ったUnityのゲームの作り方、サーバの用意の仕方とかを紹介したいと思います。\u003cbr\u003e\n初心者でも分かるように、スクショ多めにがんばります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e環境\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows10\u003c/li\u003e\n\u003cli\u003eUnity 2019.2.2f1\u003c/li\u003e\n\u003cli\u003eVisual Studio Community 2019\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おおまかな流れ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%81%8A%E3%81%BE%E3%81%8B%E3%81%AA%E6%B5%81%E3%82%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおおまかな流れ\u003c/h1\u003e\n\n\u003cp\u003eとりあえず簡単なチャットアプリを作りたいと思います。\u003c/p\u003e\n\n\u003cp\u003eやり方ですが、一つのプロジェクト上に、\u003cbr\u003e\nサーバ側でのみ使うシーン、\u003cbr\u003e\nクライアント側でのみ使うシーンの2つを作ります。\u003c/p\u003e\n\n\u003cp\u003eクライアント側のシーンは、サーバへデータを送信する処理を、\u003cbr\u003e\nサーバ側のシーンは、クライアントからのデータ送信を待ち受ける処理を実行させることで、\u003cbr\u003e\nサーバ、クライアント間でのデータ送受信を実現したいと思います。\u003c/p\u003e\n\n\u003cp\u003eイメージこんな感じ。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/bdc85c6cfe0189c375650c0c1fd7de13e2dbe09d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f38373139326636362d643663312d666335642d353361312d3366313539343965333961352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F87192f66-d6c1-fc5d-53a1-3f15949e39a5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d3540bbc9f2d5b7c3673c37f6662c79b\" alt=\"uni1.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/87192f66-d6c1-fc5d-53a1-3f15949e39a5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F87192f66-d6c1-fc5d-53a1-3f15949e39a5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4dad86448397d4d745045bb7b3bfeeab 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"プロジェクトにwebsocket-sharpを適用しよう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%ABwebsocket-sharp%E3%82%92%E9%81%A9%E7%94%A8%E3%81%97%E3%82%88%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクトにwebsocket-sharpを適用しよう\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"前準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前準備\u003c/h2\u003e\n\n\u003cp\u003ewebsocket-sharpのgithubのページに行き、ソースをzipでダウンロードしましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://github.com/sta/websocket-sharp\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/677f3abf7947c65fefbad7e045ed46e21cfadb88/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32343135613130312d323131362d633230632d646665382d6135373536623863326564362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2415a101-2116-c20c-dfe8-a5756b8c2ed6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c545efd5a3c24863b19fd6f51d8d39ef\" alt=\"i1.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/2415a101-2116-c20c-dfe8-a5756b8c2ed6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2415a101-2116-c20c-dfe8-a5756b8c2ed6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=473ce449f343d63ec8fdc50a98dc3a7c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eダウンロードしたらファイルを解凍し、中のwebsocket-sharp.slnをダブルクリックしてVisualStudioを起動させましょう。\u003c/p\u003e\n\n\u003cp\u003eソリューションエクスプローラーから、Exampleは消してしまいましょう。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/958173cb4e1f75b12ca785743810c7b6c9e45a99/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32393139313336322d623339372d343863612d613433392d3738393366383931343764302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F29191362-b397-48ca-a439-7893f89147d0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5fb804ff3773b1e9c730bad275c19d02\" alt=\"i2.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/29191362-b397-48ca-a439-7893f89147d0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F29191362-b397-48ca-a439-7893f89147d0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a956fff6d23b730ed88734eb24f64b81 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこのあと、ビルドをしたいのですが、websocket-sharp\\Net\\CookieException.csでエラーが起きてしまいますので、\u003cbr\u003e\n下記のように書き換えます。\u003cbr\u003e\n(下記記事より引用)\u003cbr\u003e\n\u003ca href=\"https://techblog.primestructure.co.jp/2019/06/28/unity-%E3%81%A7-websocket-%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E7%94%A8%E3%81%84%E3%81%A6%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%BF%E3%82%A4%E3%83%A0%E9%80%9A%E4%BF%A1%E3%81%99%E3%82%8B/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://techblog.primestructure.co.jp/2019/06/28/unity-%E3%81%A7-websocket-%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E7%94%A8%E3%81%84%E3%81%A6%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%BF%E3%82%A4%E3%83%A0%E9%80%9A%E4%BF%A1%E3%81%99%E3%82%8B/\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eCookieException.cs(修正前)\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCookieException\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eFormatException\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eCookieException.cs(修正後)\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCookieException\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eFormatException\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eISerializable\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eソリューション構成を、「Release」にします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d5d7a229d69d396b01646f6490ce570aad8620c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f61616338666332652d623739362d386564382d366163612d6437343739656261613130632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Faac8fc2e-b796-8ed8-6aca-d7479ebaa10c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=edbd6f216dfb7c59cb2ab6700d82c5f6\" alt=\"i3.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/aac8fc2e-b796-8ed8-6aca-d7479ebaa10c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Faac8fc2e-b796-8ed8-6aca-d7479ebaa10c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=32aa82d4475c37772bcd8e7557f96389 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e以上の手順が済んだら、ビルドをしましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ca7b6a79c64af113f1c9579b40ec8d784d4d53ac/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f65363062363430322d336437322d633234392d393433612d3962633530643262343234382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe60b6402-3d72-c249-943a-9bc50d2b4248.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7ede2d9d4d0713df667acc0303043fe2\" alt=\"i4.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/e60b6402-3d72-c249-943a-9bc50d2b4248.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe60b6402-3d72-c249-943a-9bc50d2b4248.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=47daf72c437d7b67068f27e6ce41a6ad 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e正常にビルドが終了すると、websocket-sharp\\bin\\Release上にwebsocket-sharp.dllができるはずです。これを、Unityのプロジェクトに適用します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/faafef06845b82282b5f654301783f751e1ff665/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f39356531626631322d666464642d386231652d323237332d3532363435663564383730352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F95e1bf12-fddd-8b1e-2273-52645f5d8705.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b0c54d64837a9dd293d0f408fd11ab50\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/95e1bf12-fddd-8b1e-2273-52645f5d8705.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F95e1bf12-fddd-8b1e-2273-52645f5d8705.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8a3de64914981f3e1d6d48db1333bd77 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"websocket-sharpの適用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#websocket-sharp%E3%81%AE%E9%81%A9%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewebsocket-sharpの適用\u003c/h2\u003e\n\n\u003cp\u003eUnityのプロジェクトを新規に作りましょう。ここでは「SampleProject」と呼称しておきます。\u003cbr\u003e\n次に、Assetsフォルダの中に、Pluginsフォルダを作ります。\u003cbr\u003e\nその中に、さきほど生成したwebsocket-sharp.dllを入れましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e010d70835d9a45de5c9a87d74c78746d1a7b044/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f30346466623338642d613631382d653930662d653230632d3263613134323262393339342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F04dfb38d-a618-e90f-e20c-2ca1422b9394.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5d470f543173c1f214633ed47765af25\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/04dfb38d-a618-e90f-e20c-2ca1422b9394.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F04dfb38d-a618-e90f-e20c-2ca1422b9394.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3373e9831f230daa1c691fffe039675a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれで、SampleProjectはWebSocketを使うための準備が整いました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"クライアント側の実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%81%B4%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクライアント側の実装\u003c/h1\u003e\n\n\u003cp\u003eSceneフォルダに、「ClientScene」というシーンを作り、その配下に以下のオブジェクトを用意しておきましょう。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eChatText・・・チャットを表示するためのText\u003c/li\u003e\n\u003cli\u003eMessageInput・・・メッセージを送信するためのInputField\u003c/li\u003e\n\u003cli\u003eSendButton・・・メッセージ送信処理をするためのButton\u003c/li\u003e\n\u003cli\u003eClientManager・・・WebSocketでサーバとの処理をするための空オブジェクト\n\u003ca href=\"https://camo.qiitausercontent.com/1a9978cf43ea440911aef377d868409a40519061/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f66636535633865652d653734612d363631362d383136302d3639343336366438646664312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffce5c8ee-e74a-6616-8160-694366d8dfd1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5ed814b479d572ff3bd5fc79bd3d4a6c\" alt=\"i8.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/fce5c8ee-e74a-6616-8160-694366d8dfd1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffce5c8ee-e74a-6616-8160-694366d8dfd1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=707dfe8e6c400bd61ee1543ff08247c2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e次に、プログラムを作っていきましょう。\u003cbr\u003e\nAssetsフォルダの中に、Scriptsフォルダを作り、その中に「ClientManager.cs」というC#スクリプトを用意します。\u003c/p\u003e\n\n\u003cp\u003eClientManager.csの中身には、\u003cbr\u003e\nサーバへの接続処理、メッセージの送信処理、メッセージ表示処理を用意しておきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eClientManager.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWebSocketSharp\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWebSocketSharp.Net\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine.UI\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eClientManager\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eWebSocket\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"n\"\u003echatText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eButton\u003c/span\u003e \u003cspan class=\"n\"\u003esendButton\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eInputField\u003c/span\u003e \u003cspan class=\"n\"\u003emessageInput\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n   \u003cspan class=\"c1\"\u003e//サーバへ、メッセージを送信する\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSendText\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emessageInput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n   \u003cspan class=\"c1\"\u003e//サーバから受け取ったメッセージを、ChatTextに表示する\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRecvText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"n\"\u003echatText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n   \u003cspan class=\"c1\"\u003e//サーバの接続が切れたときのメッセージを、ChatTextに表示する\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRecvClose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"n\"\u003echatText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Close.\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n   \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//接続処理。接続先サーバと、ポート番号を指定する\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWebSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ws://localhost:12345/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eConnect\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n      \u003cspan class=\"c1\"\u003e//送信ボタンが押されたときに実行する処理「SendText」を登録する\u003c/span\u003e\n      \u003cspan class=\"n\"\u003esendButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eonClick\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSendText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//サーバからメッセージを受信したときに実行する処理「RecvText」を登録する\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOnMessage\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eRecvText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//サーバとの接続が切れたときに実行する処理「RecvClose」を登録する\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOnClose\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eRecvClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eではこのClientManager.csを、空オブジェクトとして用意しておいたClientManagerオブジェクトにアタッチします。\u003cbr\u003e\nついでに他の各オブジェクトを、ClientManager.csのpublic フィールドとして定義していた変数たちにドラッグ＆ドロップで適用させておきます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/b95ee6a721d64b8b18856a16355acad91844dab9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f33366363623432302d373264652d383563312d316438622d3161626633623561333964302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F36ccb420-72de-85c1-1d8b-1abf3b5a39d0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4720302a18a1fb86a44d0e6fe0c47bb1\" alt=\"i7.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/36ccb420-72de-85c1-1d8b-1abf3b5a39d0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F36ccb420-72de-85c1-1d8b-1abf3b5a39d0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=36f67ec552591f1a0d9b983666a41ce5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e以上でクライアント側の実装は終わりです。\u003cbr\u003e\n「画面を起動したらサーバへ自動的にログインをし、メッセージを書いてSendボタンを押したらメッセージが送信される」、これらすべてが用意できました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"サーバ側の実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%90%E5%81%B4%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサーバ側の実装\u003c/h1\u003e\n\n\u003cp\u003e「ServerScene」というシーンを作り、その配下に以下のオブジェクトを用意しておきましょう。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eServerManager・・・WebSocketでクライアントとの処理をするための空オブジェクト\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eサーバはあくまでサーバですから、画面を作るってことは特にないですね・・・\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/7b764e0aee239f118ce8a92435361aa571e57140/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f64336166353464362d666534312d616434322d366537372d3937626161633039306239302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fd3af54d6-fe41-ad42-6e77-97baac090b90.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=388b7404146457ab6354f0871a371382\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/d3af54d6-fe41-ad42-6e77-97baac090b90.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fd3af54d6-fe41-ad42-6e77-97baac090b90.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2eca056de751b90999c34a73e1bd6d2c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eでは、サーバ側もプログラムを作っていきましょう。\u003cbr\u003e\n「ServerManager.cs」というC#スクリプトを用意します。\u003c/p\u003e\n\n\u003cp\u003eServerManager.csの中身には、\u003cbr\u003e\nサーバ起動処理、クライアントのメッセージ送信待ち受け処理、接続クライアント全員へのメッセージ送信処理を用意しておきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eServerManager.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWebSocketSharp\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWebSocketSharp.Net\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWebSocketSharp.Server\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eServerManager\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n   \u003cspan class=\"n\"\u003eWebSocketServer\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n   \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//ポート番号を指定\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWebSocketServer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e12345\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//クライアントからの通信時の挙動を定義したクラス、「ExWebSocketBehavior」を登録\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAddWebSocketService\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExWebSocketBehavior\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//サーバ起動\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"サーバ起動\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n   \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnApplicationQuit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"サーバ停止\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStop\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n   \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExWebSocketBehavior\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eWebSocketBehavior\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//誰が現在接続しているのか管理するリスト。\u003c/span\u003e\n      \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExWebSocketBehavior\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eclientList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExWebSocketBehavior\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//接続者に番号を振るための変数。\u003c/span\u003e\n      \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eglobalSeq\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//自身の番号\u003c/span\u003e\n      \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eseq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n      \u003cspan class=\"c1\"\u003e//誰かがログインしてきたときに呼ばれるメソッド\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//ログインしてきた人には、番号をつけて、リストに登録。\u003c/span\u003e\n         \u003cspan class=\"n\"\u003eglobalSeq\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n         \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eglobalSeq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n         \u003cspan class=\"n\"\u003eclientList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n         \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Seq\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" Login. (\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eID\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\")\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n         \u003cspan class=\"c1\"\u003e//接続者全員にメッセージを送る\u003c/span\u003e\n         \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eclient\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eclientList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Seq:\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" Login.\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//誰かがメッセージを送信してきたときに呼ばれるメソッド\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMessageEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n         \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Seq:\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"...\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n         \u003cspan class=\"c1\"\u003e//接続者全員にメッセージを送る\u003c/span\u003e\n         \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eclient\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eclientList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Seq:\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"...\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n      \u003cspan class=\"c1\"\u003e//誰かがログアウトしてきたときに呼ばれるメソッド\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnClose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCloseEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n         \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Seq\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" Logout. (\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eID\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\")\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n         \u003cspan class=\"c1\"\u003e//ログアウトした人を、リストから削除。\u003c/span\u003e\n         \u003cspan class=\"n\"\u003eclientList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRemove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n         \u003cspan class=\"c1\"\u003e//接続者全員にメッセージを送る\u003c/span\u003e\n         \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eclient\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eclientList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Seq:\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" Logout.\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n         \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eExWebSocketBehaviorはWebSocketBehaviorを継承しています。\u003cbr\u003e\nWebSocketBehaviorは抽象クラスで、このクラスの持つ様々なメソッドをオーバーライドすることで、\u003cbr\u003e\nサーバ側の挙動をカスタマイズすることができます。今回のサンプルではOnOpenとOnMessageとOnCloseだけ使いましたが、\u003cbr\u003e\n他にも様々なメソッドがあります。また様々なフィールドも定義されています。適宜、必要なものを使っていくといいと思います。\u003c/p\u003e\n\n\u003cp\u003eちなみに、「接続者全員にメッセージを送る」という処理は、以下のように代替もできます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e     \u003cspan class=\"c1\"\u003e//接続者全員にメッセージを送る\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e// foreach (var client in clientList)\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e// {\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//    client.Send(\"Seq:\" + seq + \"...\" + e.Data);\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e// }\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSessions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eBroadcast\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Seq:\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"...\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「とにかく全員に送ればよい」ということであれば、上記コードでいいと思います。\u003cbr\u003e\nしかし、「特定の誰かだけに送る」とか、「条件によって、特定の人には送らない」みたいなことをやろうと思ったら、\u003cbr\u003e\n上記のようなWebSocketBehaviorのリストを作って、その中から送る相手を選択するような実装になるんじゃないかなーと思っています。\u003c/p\u003e\n\n\u003cp\u003eそれでは、このServerManager.csを、空オブジェクトとして用意しておいたServerManagerオブジェクトにアタッチします。\u003cbr\u003e\nこれでサーバ側の実装は終わりです。\u003cbr\u003e\n「接続しているクライアントを管理し、クライアントからメッセージを受信したら、全員にそのメッセージを送信する」、これらすべての用意ができました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ビルド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%93%E3%83%AB%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eビルド\u003c/h1\u003e\n\n\u003cp\u003e実際に動かすために、ビルドしていきましょう。\u003c/p\u003e\n\n\u003cp\u003e手順ですが、クライアント側、サーバ側、それぞれを分けてビルドしていく必要があります。\u003c/p\u003e\n\n\u003cp\u003eサーバ側は、ServerSceneだけを対象にビルド、\u003cbr\u003e\nクライアント側は、ClientSceneだけを対象にビルド、という感じになります。\u003cbr\u003e\nそれぞれフォルダを分けて、別々のところに保存しましょう。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/3ca71185887d87e1761f6cf71ae6088cc07dd172/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f31346263303733652d646435632d656336392d656532642d3264653433363062336432642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F14bc073e-dd5c-ec69-ee2d-2de4360b3d2d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=38e7570d9c006280a84157a0edc8a928\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/14bc073e-dd5c-ec69-ee2d-2de4360b3d2d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F14bc073e-dd5c-ec69-ee2d-2de4360b3d2d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=358b610d1bb978911e826d22470a7682 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/f4303eef9ef67faac39ea2b782249665b7a391c3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32383432316666652d393732382d396135302d336562332d6564373537356630633534372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F28421ffe-9728-9a50-3eb3-ed7575f0c547.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=014cb489090f34b5e54d87fce51dbf26\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/28421ffe-9728-9a50-3eb3-ed7575f0c547.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F28421ffe-9728-9a50-3eb3-ed7575f0c547.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5e1f215755f698bb975480534a15eb3d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"動作確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e動作確認\u003c/h1\u003e\n\n\u003cp\u003eでは動かしていきましょう。\u003cbr\u003e\nチャットしてる感を出したいので、サーバ側のSampleProject.exeを1つ、クライアント側のSampleProject.exeを3つ起動してみましょう。\u003cbr\u003e\n(クライアント側は、起動したらすぐに接続処理を始めてしまうので、サーバ側の方を先に起動しておくようにしましょう)\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/82e4a55ddb432b0a4503e6ce7d96f56a3158623a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f66646335353635312d626261352d653035312d373463612d6561343265666566343561662e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffdc55651-bba5-e051-74ca-ea42efef45af.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9f87aab451c36c5cc94368f69a513f6f\" alt=\"websocket1.gif\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/fdc55651-bba5-e051-74ca-ea42efef45af.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Ffdc55651-bba5-e051-74ca-ea42efef45af.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fe2888fa3d7d8495318038ed1710559a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n3つのクライアントで、チャットができるようになりました。またクライアントが切断をすると、他のクライアントにログアウトのメッセージが表示されること、\u003cbr\u003e\nサーバを閉じるとその旨がクライアントにも通知されること、なども確認できると思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"デプロイしてみようおまけ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%97%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86%E3%81%8A%E3%81%BE%E3%81%91\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデプロイしてみよう（おまけ）\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003e※ここからの作業は、お金がかかってきます。\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e上記の動作確認では、ローカルのアドレスに対し接続を行っていたので、いまいちオンラインしてる感がありません。\u003cbr\u003e\n実際にインターネット上のサーバを借りて、そこにサーバ側SampleProjectを実行してみることにしました。\u003c/p\u003e\n\n\u003cp\u003eVPSでもEC2でも、なんでもいいのですが、\u003cbr\u003e\n僕はとりあえず、EC2のUbuntuで作成してみました。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/a677585101c9f0ff151bbc2feac4b4178bc855cc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f32656139306363652d313036352d353438382d326132372d6566383238346664323939652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2ea90cce-1065-5488-2a27-ef8284fd299e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=44b20032df7b828ec3bf70997f327c19\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/2ea90cce-1065-5488-2a27-ef8284fd299e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2F2ea90cce-1065-5488-2a27-ef8284fd299e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=dee76f5476b0b6a48c07efbaa678f447 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLinuxサーバでサーバ側SampleProjectを動かすには、Linux用にビルドをする必要があります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/91784b90e5418045c60fd95799ce3f86ca37f1e2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f65346564663336632d346139362d393165352d643036322d3538383364613234643430332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe4edf36c-4a96-91e5-d062-5883da24d403.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=12d4ccc7f211c78c25097b411218138d\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/e4edf36c-4a96-91e5-d062-5883da24d403.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fe4edf36c-4a96-91e5-d062-5883da24d403.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=112095c084ceab2230f5aa1f5c1b3e4f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e上記設定でビルドすると、SampleProject.x86_64とSampleProject_Dataが作成されました。\u003cbr\u003e\nこの2つをLinuxサーバ上に持っていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eubuntu@xxxxxxxxxx:~/unity/SampleProject\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003els\u003c/span\u003e \u003cspan class=\"nt\"\u003e-la\u003c/span\u003e\ntotal 27648\ndrwxrwxr-x 3 ubuntu ubuntu     4096 Aug 31 22:22 \u003cspan class=\"nb\"\u003e.\u003c/span\u003e\ndrwxrwxr-x 4 ubuntu ubuntu     4096 Aug 31 22:22 ..\ndrwxrwxr-x 5 ubuntu ubuntu     4096 Aug 31 22:22 SampleProject_Data\n\u003cspan class=\"nt\"\u003e-rw-rw-r--\u003c/span\u003e 1 ubuntu ubuntu 28295568 Aug 31 22:22 SampleProject.x86_64\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eさて、実際に動かすわけですが、そのまえにSampleProject.x86_64の実行権限を付与してあげましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eubuntu@xxxxxxxxxx:~/unity/SampleProject\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003echmod \u003c/span\u003e755 SampleProject.x86_64 \nubuntu@xxxxxxxxxx:~/unity/SampleProject\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003els\u003c/span\u003e \u003cspan class=\"nt\"\u003e-la\u003c/span\u003e\ntotal 27648\ndrwxrwxr-x 3 ubuntu ubuntu     4096 Aug 31 22:22 \u003cspan class=\"nb\"\u003e.\u003c/span\u003e\ndrwxrwxr-x 4 ubuntu ubuntu     4096 Aug 31 22:22 ..\ndrwxrwxr-x 5 ubuntu ubuntu     4096 Aug 31 22:22 SampleProject_Data\n\u003cspan class=\"nt\"\u003e-rwxr-xr-x\u003c/span\u003e 1 ubuntu ubuntu 28295568 Aug 31 22:22 SampleProject.x86_64\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eそれではサーバ起動！\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eubuntu@xxxxxxxxxx:~/unity/SampleProject\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e./SampleProject.x86_64 \n～～～\n（なんやかんやログが出る）\n～～～\nUnloadTime: 0.677017 ms\nサーバ起動\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e起動したっぽいですね。それでは、ローカルのPC上から、このLinuxサーバのSampleProjectに接続をしてみます。\u003cbr\u003e\nあ、ClientManager.cs内にある、接続先IPアドレスやポート番号の指定を、このLinuxサーバに合わせて書き換えることをお忘れずに。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/076e8b7a1f64920ed8d6ac42ed2823498141db9d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3431303230382f63343064333738362d613264312d363239342d396139382d3932653931313863316236632e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fc40d3786-a2d1-6294-9a98-92e9118c1b6c.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9dc13c846f60fd3e227a45766490a71a\" alt=\"websocket2.gif\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/c40d3786-a2d1-6294-9a98-92e9118c1b6c.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fc40d3786-a2d1-6294-9a98-92e9118c1b6c.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bc42d40ed2bb2aefd668cd1d0b36a7a0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e問題なく動作していますね。サーバ側は、画面を起動していません。こういった起動モードを、Headlessモードとか言ったりします。\u003cbr\u003e\nHeadlessモードで起動した場合、Debug.Log()とかで書いたログ出力処理は上記のようにコンソール上に出るようになります。\u003cbr\u003e\nログ解析とかに役立ちそうですね。\u003c/p\u003e\n\n\u003cp\u003eちなみに、「自分がHeadlessモードで起動しているか」を判断する方法があったりします。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/su10/items/a56762ce3fe1b529e0bd\" class=\"autolink\" id=\"reference-34ad2a8235458923c93c\"\u003ehttps://qiita.com/su10/items/a56762ce3fe1b529e0bd\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eですので、「Headlessモードであれば、ServerManagerを実行し、そうでなければClientManagerを実行する」みたいな分岐処理を入れておけば、\u003cbr\u003e\nいちいちビルドを2つに分ける必要もなくなるので、かなり楽になりそうですね。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"終わりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e終わりに\u003c/h1\u003e\n\n\u003cp\u003e特に作り込むこともなく、オンライン処理ができるようになりました。\u003cbr\u003e\nまた、サーバ側、クライアント側両方をUnity上で実装できるっていうのは、かなりありがたい（？）ことに感じます。\u003cbr\u003e\n(昔オンラインゲームをちょっと作ってみた時、クライアント側はUnity、サーバ側はPythonとかいう謎構成でやっていました。\u003cbr\u003e\nなのでC#のコード、Pythonのコード、お互いで使い回せる部分が少なすぎて手間2倍だった思い出があります)\u003c/p\u003e\n\n\u003cp\u003eこのサーバが、どのぐらいの負荷に耐えられるかは未検証ですが、ガリガリ作り込めば、カードゲームだろうとFPSだろうと、\u003cbr\u003e\nなんでも作れそうな感じがして、夢が膨らみますね。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"独り言\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%8B%AC%E3%82%8A%E8%A8%80\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e独り言\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eUnityエディタ上でシーンをダブルクリックすると、VSCodeが起動してしまうのは何故なんでしょう・・・？　確かにC#コーディングはVSCodeでやってますが、シーンは別にVSCode使わないっつーの　\u003cimg alt=\":rage:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f621.png\" title=\":rage:\" width=\"20\" loading=\"lazy\"\u003e\u003cimg alt=\":rage:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f621.png\" title=\":rage:\" width=\"20\" loading=\"lazy\"\u003e\u003cimg alt=\":rage:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f621.png\" title=\":rage:\" width=\"20\" loading=\"lazy\"\u003e\n\u003c/li\u003e\n\u003cli\u003eTextオブジェクトのtextを変更しても、画面上に反映されない現象に見舞われています。　\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e      \u003cspan class=\"n\"\u003echatText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれやっても画面上に変更が反映されません。なんでこんな単純なことができなくなったんや　\u003cimg alt=\":innocent:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png\" title=\":innocent:\" width=\"20\" loading=\"lazy\"\u003e\u003cimg alt=\":innocent:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png\" title=\":innocent:\" width=\"20\" loading=\"lazy\"\u003e\u003cimg alt=\":innocent:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png\" title=\":innocent:\" width=\"20\" loading=\"lazy\"\u003e\u003cimg alt=\":innocent:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png\" title=\":innocent:\" width=\"20\" loading=\"lazy\"\u003e\u003cimg alt=\":innocent:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png\" title=\":innocent:\" width=\"20\" loading=\"lazy\"\u003e\u003cbr\u003e\n（結局、この処理の前後に、chatText.enabled = false;とかtrue;とかを入れて再表示させることで、今回のサンプルではごまかしました）\u003c/p\u003e\n","createdAt":"2019-09-01T04:21:31Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"qwhJL5iBYBjkdP3xb3PXcsacEMkSN0n3GA==--VWV1LlW/HXRRI8gY--69tdW67stfzBdb6bo4MwRw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2019-09-01T04:21:31Z","likesCount":12,"linkUrl":"https://qiita.com/riyosy/items/5789ccdeee644b34a743","organization":null,"originalId":1009172,"stockedCount":16,"title":"【Unity】クライアントもサーバもwebsocket-sharpで、オンラインゲームを作ってみよう【WebSocket】 ","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%81%8A%E3%81%BE%E3%81%8B%E3%81%AA%E6%B5%81%E3%82%8C\"\u003eおおまかな流れ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%ABwebsocket-sharp%E3%82%92%E9%81%A9%E7%94%A8%E3%81%97%E3%82%88%E3%81%86\"\u003eプロジェクトにwebsocket-sharpを適用しよう\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99\"\u003e前準備\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#websocket-sharp%E3%81%AE%E9%81%A9%E7%94%A8\"\u003ewebsocket-sharpの適用\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%81%B4%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003eクライアント側の実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%90%E5%81%B4%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003eサーバ側の実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%93%E3%83%AB%E3%83%89\"\u003eビルド\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e動作確認\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%97%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86%E3%81%8A%E3%81%BE%E3%81%91\"\u003eデプロイしてみよう（おまけ）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e終わりに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%8B%AC%E3%82%8A%E8%A8%80\"\u003e独り言\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":7249,"uuid":"5789ccdeee644b34a743","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"q/yc4jlSFVrtGpFVB+B923tY4TXs--RSlXQ+7UGU3InxiU--TjK2cGG1vxOBYtpQbcIsyA==","originalId":410208,"description":"よくわからんがまぁ動いているからヨシ！的な思考から抜け出せません。。。\r\nご指導ご鞭撻のほど、よろしくお願い申し上げます。","facebookUrl":null,"githubUrl":"https://github.com/riyosy","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/410208/profile-images/1567311531","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fprofile-images%2F1567311531?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=51d270321bf2c44827e8cec6bc54dcc8","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F410208%2Fprofile-images%2F1567311531?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=ccaef4d655963ed8583238a9ce85e787","urlName":"riyosy","websiteUrl":"http://sheepqueue.com","twitterUrl":"https://twitter.com/moyosy","twitterUrlName":"moyosy","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"初心者","urlName":"%e5%88%9d%e5%bf%83%e8%80%85"},{"name":"websocket","urlName":"websocket"},{"name":"オンラインゲーム","urlName":"%e3%82%aa%e3%83%b3%e3%83%a9%e3%82%a4%e3%83%b3%e3%82%b2%e3%83%bc%e3%83%a0"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
