リクエストで送られてくる際にHttpヘッダーの特定のキーの値を用いて認証することがあると思います。
今回はASP.NET Core WebAPIプロジェクトを例にしてHttpヘッダーのTESTキーの値を取得してみます。ASP.NET Core WebAPIプロジェクトを立ち上げます。
テンプレートで用意されているWeatherForecastController.csは以下のようになっています。まずはそのままビルドし、実行してみます。
立ち上がりました。
次にこちらへGetメソッドでリクエストを送ってみます。APIが正常に終了し、データが返却されたことを確認できました。さて、それでは本題であるHttpヘッダーの特定のキーの値を取得する方法を書いていこうと思います。
認証的にはとてつもなくダメダメな例ではありますが、TESTキーに値が入っている場合はデータが返却され、入っていない場合は401エラー(Unauthorized)が返却される仕様を例にサンプルコードを書いていきましょう。Httpヘッダーの特定のキーの値を取得する際は以下のHttpRequest.Headersプロパティを利用します。こちらを用いると先ほど記載したテンプレート(WeatherForecastController.cs)のGetメソッドは以下のように書けます。動作を確認してみましょう。TESTキーをセットしていない場合は401エラーで落ちます。TESTキーをセットした場合は値が返却されていることが分かります。
以上、Httpヘッダーの特定のキーから値を取得する方法でした。
同様の処理を行う方々の参考になれば幸いです。


