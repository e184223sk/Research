<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#のみを使って、変更前後の差分表示のできる、ファイル名変更ソフトの作り方 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/soi/items/aa82eb68577d339dd6af" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="0+pInwt3f8Gjo+Oal3aQzu9bfl2BoS2wt4qCumIObdPXz97O8VKbM48JArsZ8ilbKjAocxPFBYLh++uRWIjBXA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@soi2flatline" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#のみを使って、変更前後の差分表示のできる、ファイル名変更ソフトの作り方 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amdiX2pncExrdmJfamdhUGpnYWJqZ0lIbHBJbm1tN1RsaVkzbHZvempnYTdsdDY3bGlJYm9vYWpucExyamdhN2pnYWZqZ1kzamdvdmpnSUhqZzVYamdxSGpncVRqZzZ2bGtJM2xwSW5tbTdUamdyM2pnNVhqZzRqamdhN2t2WnpqZ29ybWxyayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1iNmE3Zjc4Njk1ZmY3Zjc0OTI0MmUzMWI0YmFjZjExZQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE52YVEmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1jY2U0NzBlOTc2ZmUyMWVmODI0NTAxZDY0NDlhYTIxOA&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=12452171d94cd71bdbf8223c20a084f5"><meta property="og:description" content="

概要

2020年にもなってファイル名変更ソフトを新しく作りました。名前はFileRenamerDiffです。
この記事では、ソフトウェアの記述解説をします。

ソフトウェアの内容やスクリーンショットは前回の記事を参照ください。
..."><meta content="https://qiita.com/soi/items/aa82eb68577d339dd6af" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,.NET,WPF,ReactiveProperty,個人開発" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-3b24cf1f-b6cb-4f1e-af78-10c7d45c0db3"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fsoi%2Fitems%2Faa82eb68577d339dd6af">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fsoi%2Fitems%2Faa82eb68577d339dd6af">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-3b24cf1f-b6cb-4f1e-af78-10c7d45c0db3">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-07-22T07:50:57.000+09:00","dateModified":"2020-07-22T21:39:59.000+09:00","headline":"C#のみを使って、変更前後の差分表示のできる、ファイル名変更ソフトの作り方","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amdiX2pncExrdmJfamdhUGpnYWJqZ0lIbHBJbm1tN1RsaVkzbHZvempnYTdsdDY3bGlJYm9vYWpucExyamdhN2pnYWZqZ1kzamdvdmpnSUhqZzVYamdxSGpncVRqZzZ2bGtJM2xwSW5tbTdUamdyM2pnNVhqZzRqamdhN2t2WnpqZ29ybWxyayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1iNmE3Zjc4Njk1ZmY3Zjc0OTI0MmUzMWI0YmFjZjExZQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE52YVEmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1jY2U0NzBlOTc2ZmUyMWVmODI0NTAxZDY0NDlhYTIxOA\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=12452171d94cd71bdbf8223c20a084f5","mainEntityOfPage":"https://qiita.com/soi/items/aa82eb68577d339dd6af","author":{"@type":"Person","address":"","email":null,"identifier":"soi","name":"soi","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F120077%2Fprofile-images%2F1473714466?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e5a35cbc09752410b5c78938fa1e1273","url":"https://qiita.com/soi","description":"ソフトウェアエンジニア\r\nC#, Xaml チョットワカル","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"soi","type":"items","id":"aa82eb68577d339dd6af"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"soi","type":"items","id":"aa82eb68577d339dd6af"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"soi","type":"items","id":"aa82eb68577d339dd6af"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/soi/items/aa82eb68577d339dd6af","location":"/soi/items/aa82eb68577d339dd6af","scheme":"https","host":"qiita.com","port":null,"pathname":"/soi/items/aa82eb68577d339dd6af","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"85hWU+PJ8ojX6l8MNHEiWzVDm4wnebwAeTfLI0YJetb3vcACGewWevtAvi269ZvO8CjNorUdlDIvRqIIfI/WWQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-4465c91c-1c8d-425d-93c3-b22630955524"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/soi/items/aa82eb68577d339dd6af/likers" class="css-1iupg5d">6</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">10</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/aa82eb68577d339dd6af/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/soi/items/aa82eb68577d339dd6af/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/soi/items/aa82eb68577d339dd6af/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/soi/items/aa82eb68577d339dd6af/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/soi/items/aa82eb68577d339dd6af.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/soi"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/120077/profile-images/1473714466" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/soi" class="css-10ougpm">@<!-- -->soi</a><div class="css-1ay9vb9"><span><meta content="2020-07-21T22:50:57Z"/><time dateTime="2020-07-22T12:39:59Z" class="css-m19uds">updated at 2020-07-22</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#のみを使って、変更前後の差分表示のできる、ファイル名変更ソフトの作り方</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/.net" class="css-4czcte">.NET</a><a href="/tags/wpf" class="css-4czcte">WPF</a><a href="/tags/reactiveproperty" class="css-4czcte">ReactiveProperty</a><a href="/tags/%e5%80%8b%e4%ba%ba%e9%96%8b%e7%99%ba" class="css-4czcte">個人開発</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="概要" class="fragment"></span><a href="#%E6%A6%82%E8%A6%81"><i class="fa fa-link"></i></a>概要</h1>

<p>2020年にもなってファイル名変更ソフトを新しく作りました。名前はFileRenamerDiffです。<br>
この記事では、ソフトウェアの記述解説をします。</p>

<p>ソフトウェアの内容やスクリーンショットは<a href="https://qiita.com/soi/items/b03cdfadb9cab8edaf88" id="reference-208698646830d4ac87c1">前回の記事</a>を参照ください。</p>

<p><a href="https://camo.qiitausercontent.com/c909411662837b6d96b7a1ef6654dce16693c227/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f66646366613465332d663162612d613563362d373032622d3265306332363335663834302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Ffdcfa4e3-f1ba-a5c6-702b-2e0c2635f840.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3f10a41d27939bed275f4015c9b3268f" alt="screenshot_ja.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/fdcfa4e3-f1ba-a5c6-702b-2e0c2635f840.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Ffdcfa4e3-f1ba-a5c6-702b-2e0c2635f840.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=19a7ea7825671704bf7ad4fa3f523c1a 1x" loading="lazy"></a></p>

<p>ざっくりいうと、WPF on .NET Core by C#です。<br>
MVVMライブラリはLivetとReactivePropertyを使用しています。<br>
ソースコード全体は<a href="https://github.com/soi013/FileRenamerDiff" rel="nofollow noopener" target="_blank">GitHub</a>にあります。</p>

<h1>
<span id="使用している主なライブラリ" class="fragment"></span><a href="#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E4%B8%BB%E3%81%AA%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA"><i class="fa fa-link"></i></a>使用している主なライブラリ</h1>

<table>
<thead>
<tr>
<th>ライブラリ名</th>
<th>使用目的</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReactiveProperty</td>
<td>MVVMライブラリとして、主にViewModelで使用</td>
</tr>
<tr>
<td>Livet</td>
<td>MVVMライブラリとして、ViewとViewModelの連携やINotifyPropertyChanged実装基底クラスなど</td>
</tr>
<tr>
<td>DiffPlex</td>
<td>差分表示、ViewModelで使用。ViewではDataGrid内のRichTextBoxにBindingされます。</td>
</tr>
<tr>
<td>MahApps</td>
<td>Viewのデザインライブラリ</td>
</tr>
<tr>
<td>MaterialDesignThemes</td>
<td>Viewのデザインライブラリ</td>
</tr>
<tr>
<td>Markdig</td>
<td>Viewのライセンス表記などのMarkdownの表示</td>
</tr>
<tr>
<td>Utf8Json</td>
<td>JSON設定ファイルの読込／保存</td>
</tr>
<tr>
<td>Serilog</td>
<td>ロギング</td>
</tr>
</tbody>
</table>

<h1>
<span id="全体構成" class="fragment"></span><a href="#%E5%85%A8%E4%BD%93%E6%A7%8B%E6%88%90"><i class="fa fa-link"></i></a>全体構成</h1>

<p>MVVMパターンですので、Model-ViewModel-Viewの3層に分割して、ViewとViewModelの間はBindingによってつながっています。</p>

<p>メインとなるクラスだけ抜き出したクラス図は以下のようになっています。PlantUMLで書きました。</p>

<p><a href="https://camo.qiitausercontent.com/058d1a6cc726f170b2913d9503fb58eab3a827ae/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f30643966323161392d613530302d336432662d316130382d6365346663386639666334302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F0d9f21a9-a500-3d2f-1a08-ce4fc8f9fc40.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ef4f5e62041c5b15c505c90dff0d981c" alt="FileRenamerDiff.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/0d9f21a9-a500-3d2f-1a08-ce4fc8f9fc40.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F0d9f21a9-a500-3d2f-1a08-ce4fc8f9fc40.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c90af4db0393ef0a327377d05780a35f 1x" loading="lazy"></a></p>

<p>各層ごとに解説します。</p>

<h1>
<span id="model" class="fragment"></span><a href="#model"><i class="fa fa-link"></i></a>Model</h1>

<p>Model層ではファイルの探索、正規表現を使ったリネーム、リネーム保存、設定ファイル読み書きといったことを行っています。</p>

<h4>
<span id="ファイル探索" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%8E%A2%E7%B4%A2"><i class="fa fa-link"></i></a>ファイル探索</h4>

<p>指定されたパス以下のファイルパスを取得します。このとき設定によって、隠しファイルやフォルダ・（狭義の）ファイルの両方か片方だけリストにするか切り替えます。<br>
探索されたファイルの情報を<code>FileElementModel</code>にまとめて、そこにリネーム後のファイル名もあとで加えます。</p>

<h4>
<span id="リネーム処理プレビュー" class="fragment"></span><a href="#%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%E5%87%A6%E7%90%86%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC"><i class="fa fa-link"></i></a>リネーム処理（プレビュー）</h4>

<p>設定は<code>SettingAppModel</code>にまとめてあり、このクラス全体をJSONにシリアライズして設定ファイルとして保存しています。設定には探索対象ディレクトリや複数の削除パターン・置換パターンが含まれています。</p>

<p>リネームの実行は.NETの<code>Regex</code>に置換後の文字列を加えた<code>ReplaceRegex</code>クラスで行います。複数のファイル名に対して行うのを想定しているので、<code>RegexOption</code>は<code>Compiled</code>にしておきます。<br>
ソフトウェアの設定では削除パターンと置換パターンで2種類がありますが、Regexを生成する際には、この削除パターンは全て<code>|</code>で結合した1つのRegexにし、置換後の文字列は<code>""</code>にしておきます。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">例）"a"、"b"、"c"、を削除</span></div>
<div class="highlight"><pre class="with-code"><code><span class="n">Regex</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="s">"a1b2c3"</span><span class="p">,</span> <span class="s">"(a|b|c)"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span> <span class="c1">//結果"123"</span>
</code></pre></div>
</div>

<h4>
<span id="重複判定" class="fragment"></span><a href="#%E9%87%8D%E8%A4%87%E5%88%A4%E5%AE%9A"><i class="fa fa-link"></i></a>重複判定</h4>

<p>リネーム処理後に同じファイルパスが含まれていた場合、ファイルパスが重複しているとみなし、リネーム保存を禁止しています。なお、Windowsは大文字・小文字は同じとみなします。<br>
リネーム後のファイルパスだけでなく、リネーム前のファイルパスとも重複していないかを判定しています。これは保存の順番によっては失敗する場合があるためです。<br>
例）"A.txt", "B.txt"というファイル名が同じディレクトリにあり、"A"を"b"に、"B"を"c"に置き換えるリネームをした場合、先に"A.txt"→"b.txt"が保存されると既存の"B.txt"と重複して失敗してしまいます。</p>

<h4>
<span id="リネーム保存" class="fragment"></span><a href="#%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%E4%BF%9D%E5%AD%98"><i class="fa fa-link"></i></a>リネーム保存</h4>

<p>リネーム保存時は深い階層のファイルから保存します。フォルダもリネームする場合、保存前のファイルが移動したことになり失敗してしまいます。<br>
例）"/Main/Sub/"という階層のフォルダがあり、"/Main"と"/Sub"をリネームする場合、"/Main"を先にリネーム保存してしまうと、"/Main/Sub"が見つからなくなります。</p>

<p>また、リネーム処理自体もファイルかフォルダかで処理が微妙に異なります。これは過去記事を参照ください。<br>
<a href="https://qiita.com/soi/items/18d5b10b20f5e221efca" id="reference-88c44b4aefdb679081c1">C#で確実にファイル名を変更する</a></p>

<h4>
<span id="reactivepropertymodel" class="fragment"></span><a href="#reactivepropertymodel"><i class="fa fa-link"></i></a>ReactiveProperty（Model）</h4>

<p>シリアライズされる<code>SettingAppModel</code>クラス以外はViewModelから参照される可変プロパティはだいたいReactivePropertyにしてあります。<br>
これにより、Modelでの変更がRxなストリームとしてViewModel・Viewに伝わります。</p>

<h1>
<span id="viewmodel" class="fragment"></span><a href="#viewmodel"><i class="fa fa-link"></i></a>ViewModel</h1>

<p>基本的にはModelの上記機能を呼び出すためのReactiveCommandとModelの状態を反映するReactivePropertyがメインです。<br>
ViewModelはなるべく薄く作るべきなのですが、差分表示(DiffPlex)やDataGrid用のCollectionViewなどで、ふくらんでいます。</p>

<h4>
<span id="reactivepropertyviewmodel" class="fragment"></span><a href="#reactivepropertyviewmodel"><i class="fa fa-link"></i></a>ReactiveProperty（ViewModel）</h4>

<p>リネーム保存などの時間のかかる処理は非同期で行うべきですが、ViewにBindingされるプロパティはUIスレッド以外から変更すると例外が発生してしまいます。<br>
こういった事情もReactivePropertyのSchedulerやRxの<code>ObserveOnUIDispatcher()</code>を使うと解決できます。</p>

<p>例えば、Modelでの非同期処理の結果、リネームファイル数プロパティ<code>CountReplaced</code>が変更になり、それをViewにも表示するためViewModelで同名のプロパティを作る場合はこうします。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">FileElementsGridViewModel.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//プロパティ宣言</span>
<span class="k">public</span> <span class="n">IReadOnlyReactiveProperty</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">CountConflicted</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

<span class="c1">//コンストラクタ内で</span>
<span class="k">this</span><span class="p">.</span><span class="n">CountReplaced</span> <span class="p">=</span> <span class="n">model</span><span class="p">.</span><span class="n">CountReplaced</span><span class="p">.</span><span class="nf">ObserveOnUIDispatcher</span><span class="p">().</span><span class="nf">ToReadOnlyReactivePropertySlim</span><span class="p">();</span>
</code></pre></div>
</div>

<p>これにより、Modelのプロパティ変更時のスレッドに関係なく、ViewModelのプロパティ変更はUIスレッドから行われます。</p>

<h4>
<span id="差分表示" class="fragment"></span><a href="#%E5%B7%AE%E5%88%86%E8%A1%A8%E7%A4%BA"><i class="fa fa-link"></i></a>差分表示</h4>

<p>DiffPlexというライブラリを使用して、リネーム前後のファイル名の差分情報を生成します。</p>

<p>DiffPlexの詳しい解説は過去記事を参照ください。<br>
<a href="https://qiita.com/soi/items/ae880d73377b13322ec7" id="reference-6909e9579c6819ccb582">WPFでGitのDiffっぽい差分表示をするDiffPlexライブラリ。～あるいは、あるジェダイの変遷</a></p>

<p>ファイル名の性質上、1行全体のハイライトをしても意味がないので、ワード境界を細かく区切りました。<br>
デフォルトの差分表示時のワード境界が全角文字などに対応していなかったので、追加しました。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="n">SideBySideDiffModel</span> <span class="nf">CreateDiff</span><span class="p">(</span><span class="kt">string</span> <span class="n">inputText</span><span class="p">,</span> <span class="kt">string</span> <span class="n">outText</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">char</span><span class="p">[]</span> <span class="n">wordSeparaters</span> <span class="p">=</span>
    <span class="p">{</span>
        <span class="sc">' '</span><span class="p">,</span> <span class="sc">'\t'</span><span class="p">,</span> <span class="sc">'.'</span><span class="p">,</span> <span class="sc">'('</span><span class="p">,</span> <span class="sc">')'</span><span class="p">,</span> <span class="sc">'{'</span><span class="p">,</span> <span class="sc">'}'</span><span class="p">,</span> <span class="sc">','</span><span class="p">,</span> <span class="sc">'!'</span><span class="p">,</span> <span class="sc">'?'</span><span class="p">,</span> <span class="sc">';'</span><span class="p">,</span> <span class="c1">//MarkDiffデフォルトからコピー</span>
        <span class="sc">'_'</span><span class="p">,</span><span class="sc">'-'</span><span class="p">,</span><span class="sc">'['</span><span class="p">,</span><span class="sc">']'</span><span class="p">,</span><span class="sc">'~'</span><span class="p">,</span><span class="sc">'+'</span><span class="p">,</span><span class="sc">'='</span><span class="p">,</span><span class="sc">'^'</span><span class="p">,</span>    <span class="c1">//半角系</span>
        <span class="sc">'　'</span><span class="p">,</span><span class="sc">'、'</span><span class="p">,</span><span class="sc">'。'</span><span class="p">,</span><span class="sc">'「'</span><span class="p">,</span><span class="sc">'」'</span><span class="p">,</span><span class="sc">'（'</span><span class="p">,</span><span class="sc">'）'</span><span class="p">,</span><span class="sc">'｛'</span><span class="p">,</span><span class="sc">'｝'</span><span class="p">,</span><span class="sc">'・'</span><span class="p">,</span><span class="sc">'！'</span><span class="p">,</span><span class="sc">'？'</span><span class="p">,</span><span class="sc">'；'</span><span class="p">,</span><span class="sc">'：'</span><span class="p">,</span><span class="sc">'＿'</span><span class="p">,</span><span class="sc">'ー'</span><span class="p">,</span><span class="sc">'－'</span><span class="p">,</span><span class="sc">'～'</span><span class="p">,</span><span class="sc">'‐'</span><span class="p">,</span><span class="sc">'＋'</span><span class="p">,</span><span class="sc">'＊'</span><span class="p">,</span><span class="sc">'／'</span><span class="p">,</span><span class="sc">'＝'</span><span class="p">,</span><span class="sc">'＾'</span><span class="p">,</span>    <span class="c1">//全角系</span>
    <span class="p">};</span>
    <span class="kt">var</span> <span class="n">diff</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SideBySideDiffBuilder</span><span class="p">(</span><span class="k">new</span> <span class="nf">Differ</span><span class="p">(),</span> <span class="n">wordSeparaters</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">diff</span><span class="p">.</span><span class="nf">BuildDiffModel</span><span class="p">(</span><span class="n">inputText</span><span class="p">,</span> <span class="n">outText</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>これにより、どこが変更されたかが分かりやすくなります。<br>
$\style{background-color:pink;}{報告書「最終版」}$.txt <br>
→　$\style{background-color:LightGreen;}{報告書「最終手前版」}$.txt<br>
👇<br>
報告書「$\style{background-color:pink;}{最終版}$」.txt <br>
→ 報告書「$\style{background-color:LightGreen;}{最終手前版}$」.txt</p>

<h4>
<span id="ファイル情報datagrid用viewmodel" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%83%85%E5%A0%B1datagrid%E7%94%A8viewmodel"><i class="fa fa-link"></i></a>ファイル情報DataGrid用ViewModel</h4>

<p>Modelでのファイル情報クラス<code>FileElementModel</code>に対応した<code>FileElementViewModel</code>を作成し、上記差分情報もその中に含めています。<br>
ただのDataGridにBindingするなら、これを<code>ObservableCollection</code>などに入れればよいのですが、並び替えや行フィルタ処理に対応するためには<code>ICollectionView</code>に変換する必要があります。<br>
変換自体は<code>CollectionViewSource.GetDefaultView()</code>を呼ぶだけでよいですが、行フィルタを使用する場合は<code>ICollectionViewer</code>の<code>Filter</code>プロパティに表示判定用コールバックを指定して、行フィルタ基準が変わるたびに<code>Refresh()</code>メソッドを呼ぶ必要があります。<br>
実際のコードのうち関係する部分を抜き出すと以下のようになります。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">FileElementsGridViewModel.cs(部分）</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// ファイル情報コレクションのDataGrid用のICollectionView</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">public</span> <span class="n">ReadOnlyReactivePropertySlim</span><span class="p">&lt;</span><span class="n">ICollectionView</span><span class="p">&gt;</span> <span class="n">CViewFileElementVMs</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 置換前後で差があったファイルのみ表示するか</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">public</span> <span class="n">ReactivePropertySlim</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="n">IsVisibleReplacedOnly</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReactivePropertySlim</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;(</span><span class="k">false</span><span class="p">);</span>

<span class="k">public</span> <span class="nf">FileElementsGridViewModel</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="n">CViewFileElementVMs</span> <span class="p">=</span> <span class="n">model</span>
        <span class="p">.</span><span class="nf">ObserveProperty</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">FileElementModels</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="nf">CreateFilePathVMs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="p">.</span><span class="nf">ObserveOnUIDispatcher</span><span class="p">()</span>
        <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="nf">CreateCollectionViewFilePathVMs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="p">.</span><span class="nf">ToReadOnlyReactivePropertySlim</span><span class="p">();</span>

    <span class="c1">//表示基準に変更があったら、表示判定対象に変更があったら、CollectionViewの表示を更新する</span>
    <span class="k">new</span><span class="p">[]</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">IsVisibleReplacedOnly</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">}</span>
    <span class="p">.</span><span class="nf">CombineLatest</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Throttle</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromMilliseconds</span><span class="p">(</span><span class="m">100</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">ObserveOnUIDispatcher</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span> <span class="nf">RefleshCollectionViewSafe</span><span class="p">());</span>
<span class="p">}</span>

<span class="k">private</span> <span class="n">ICollectionView</span> <span class="nf">CreateCollectionViewFilePathVMs</span><span class="p">(</span><span class="n">ObservableCollection</span><span class="p">&lt;</span><span class="n">FileElementViewModel</span><span class="p">&gt;</span> <span class="n">fVMs</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">cView</span> <span class="p">=</span> <span class="n">CollectionViewSource</span><span class="p">.</span><span class="nf">GetDefaultView</span><span class="p">(</span><span class="n">fVMs</span><span class="p">);</span>
    <span class="n">cView</span><span class="p">.</span><span class="n">Filter</span> <span class="p">=</span> <span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="nf">GetVisibleRow</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">cView</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 2つの表示切り替えプロパティと、各行の値に応じて、その行の表示状態を決定する</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="row"&gt;行VM&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;表示状態&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">bool</span> <span class="nf">GetVisibleRow</span><span class="p">(</span><span class="kt">object</span> <span class="n">row</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(!(</span><span class="n">row</span> <span class="k">is</span> <span class="n">FileElementViewModel</span> <span class="n">pathVM</span><span class="p">))</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">replacedVisible</span> <span class="p">=</span> <span class="p">!</span><span class="n">IsVisibleReplacedOnly</span><span class="p">.</span><span class="n">Value</span> <span class="p">||</span> <span class="n">pathVM</span><span class="p">.</span><span class="n">IsReplaced</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">conflictedVisible</span> <span class="p">=</span> <span class="p">!</span><span class="n">IsVisibleConflictedOnly</span><span class="p">.</span><span class="n">Value</span> <span class="p">||</span> <span class="n">pathVM</span><span class="p">.</span><span class="n">IsConflicted</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">replacedVisible</span> <span class="p">&amp;&amp;</span> <span class="n">conflictedVisible</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">RefleshCollectionViewSafe</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(!(</span><span class="n">CViewFileElementVMs</span><span class="p">?.</span><span class="n">Value</span> <span class="k">is</span> <span class="n">ListCollectionView</span> <span class="n">currentView</span><span class="p">))</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="c1">//なぜかCollectionViewが追加中・編集中のことがある。</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">currentView</span><span class="p">.</span><span class="n">IsAddingNew</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LogTo</span><span class="p">.</span><span class="nf">Warning</span><span class="p">(</span><span class="s">"CollectionView is Adding"</span><span class="p">);</span>
        <span class="n">currentView</span><span class="p">.</span><span class="nf">CancelNew</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">currentView</span><span class="p">.</span><span class="n">IsEditingItem</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LogTo</span><span class="p">.</span><span class="nf">Warning</span><span class="p">(</span><span class="s">"CollectionView is Editing"</span><span class="p">);</span>
        <span class="n">currentView</span><span class="p">.</span><span class="nf">CommitEdit</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">currentView</span><span class="p">.</span><span class="nf">Refresh</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h1>
<span id="view" class="fragment"></span><a href="#view"><i class="fa fa-link"></i></a>View</h1>

<h4>
<span id="mahappsとmaterialdesignthemes" class="fragment"></span><a href="#mahapps%E3%81%A8materialdesignthemes"><i class="fa fa-link"></i></a>MahAppsとMaterialDesignThemes</h4>

<p>MahAppsとMaterialDesignThemesという2つのライブラリを使用して、見た目をカッチョイイ感じにします。<br>
MahAppsはウインドウのタイトル部分とウインドウの周りにボヤッとした色をつける機能 <code>GlowBrush</code> を使用しています。</p>

<p><a href="https://camo.qiitausercontent.com/bd143294af492a74746e8b07944fabbda18ceb96/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f36636466323565632d643164302d333963312d626332642d6465313833353130363235352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F6cdf25ec-d1d0-39c1-bc2d-de1835106255.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8fc8ab8a27b2c09c7cd3b33ec38d37e1" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/6cdf25ec-d1d0-39c1-bc2d-de1835106255.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F6cdf25ec-d1d0-39c1-bc2d-de1835106255.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=35f7c17559958ff4d1fb2c233689f8a5 1x" loading="lazy"></a></p>

<p>ウインドウの周りがちょっと青いのがわかりますでしょうか。<br>
それ以外のコントロールはMaterialDesignThemesのテーマが適用されています。</p>

<p>今回はプリセット色は使わず、すべてカラーコードを指定したかったので、プリセットの色に上書きします。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">App.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Color</span> <span class="na">x:Key=</span><span class="s">"Primary900"</span><span class="nt">&gt;</span>#1A537C<span class="nt">&lt;/Color&gt;</span>
<span class="nt">&lt;Color</span> <span class="na">x:Key=</span><span class="s">"Primary800"</span><span class="nt">&gt;</span>#286591<span class="nt">&lt;/Color&gt;</span>
...
<span class="nt">&lt;Color</span> <span class="na">x:Key=</span><span class="s">"Primary50"</span><span class="nt">&gt;</span>#E8EFF4<span class="nt">&lt;/Color&gt;</span>
</code></pre></div>
</div>

<p>MaterialDesignThemesの詳しい内容は # 参考 を参照してください。</p>

<h4>
<span id="テーマ変更" class="fragment"></span><a href="#%E3%83%86%E3%83%BC%E3%83%9E%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>テーマ変更</h4>

<p>Ligth/Darkテーマ切り替えをやってみたかったので、作ってみました。<br>
MaterialDesignThemesの<code>PaletteHelper</code>を使ってデフォルトのテーマをGet、変更後にSetします。<br>
メイン色と前景色のペアで設定します。両者はある程度の明暗差がないと見づらいです。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">App.xaml.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ChangeTheme</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">paletteHelper</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PaletteHelper</span><span class="p">();</span>
    <span class="kt">var</span> <span class="n">theme</span> <span class="p">=</span> <span class="n">paletteHelper</span><span class="p">.</span><span class="nf">GetTheme</span><span class="p">();</span>

    <span class="kt">bool</span> <span class="n">isDark</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">Setting</span><span class="p">.</span><span class="n">IsAppDarkTheme</span><span class="p">;</span>
    <span class="n">theme</span><span class="p">.</span><span class="nf">SetBaseTheme</span><span class="p">(</span>
        <span class="n">isDark</span>
            <span class="p">?</span> <span class="n">Theme</span><span class="p">.</span><span class="n">Dark</span>
            <span class="p">:</span> <span class="n">Theme</span><span class="p">.</span><span class="n">Light</span><span class="p">);</span>

    <span class="n">theme</span><span class="p">.</span><span class="n">PrimaryDark</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ColorPair</span><span class="p">((</span><span class="n">Color</span><span class="p">)</span><span class="n">Current</span><span class="p">.</span><span class="n">Resources</span><span class="p">[</span><span class="s">"Primary700"</span><span class="p">],</span> <span class="n">Colors</span><span class="p">.</span><span class="n">White</span><span class="p">);</span>
    <span class="n">theme</span><span class="p">.</span><span class="n">PrimaryMid</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ColorPair</span><span class="p">((</span><span class="n">Color</span><span class="p">)</span><span class="n">Current</span><span class="p">.</span><span class="n">Resources</span><span class="p">[</span><span class="s">"Primary500"</span><span class="p">],</span> <span class="n">Colors</span><span class="p">.</span><span class="n">White</span><span class="p">);</span>
    <span class="n">theme</span><span class="p">.</span><span class="n">PrimaryLight</span> <span class="p">=</span> <span class="p">(</span><span class="n">Color</span><span class="p">)</span><span class="n">Current</span><span class="p">.</span><span class="n">Resources</span><span class="p">[</span><span class="s">"Primary300"</span><span class="p">];</span>
    <span class="n">theme</span><span class="p">.</span><span class="n">Paper</span> <span class="p">=</span> <span class="n">AppExtention</span><span class="p">.</span><span class="nf">ToColorOrDefault</span><span class="p">(</span><span class="n">isDark</span>
        <span class="p">?</span> <span class="s">"#272E33"</span>
        <span class="p">:</span> <span class="s">"#E6EDF2"</span><span class="p">);</span>

    <span class="c1">//ベース色とのコントラストが</span>
    <span class="n">Current</span><span class="p">.</span><span class="n">Resources</span><span class="p">[</span><span class="s">"HighContrastBrush"</span><span class="p">]</span> <span class="p">=</span>
        <span class="p">(</span><span class="n">isDark</span> <span class="p">?</span> <span class="n">theme</span><span class="p">.</span><span class="n">PrimaryLight</span> <span class="p">:</span> <span class="n">theme</span><span class="p">.</span><span class="n">PrimaryDark</span><span class="p">)</span>
        <span class="p">.</span><span class="n">Color</span><span class="p">.</span><span class="nf">ToSolidColorBrush</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>

    <span class="n">paletteHelper</span><span class="p">.</span><span class="nf">SetTheme</span><span class="p">(</span><span class="n">theme</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>ただし、各種色やBrushはStaticResourceで指定されているので、再起動後に反映されます。</p>

<h4>
<span id="ファイル情報datagrid差分以外" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%83%85%E5%A0%B1datagrid%E5%B7%AE%E5%88%86%E4%BB%A5%E5%A4%96"><i class="fa fa-link"></i></a>ファイル情報DataGrid（差分以外）</h4>

<p>ViewModelのファイル情報クラス<code>FileElementViewModel</code>を含んだICollectionViewをDataGridにBindingしています。</p>

<p>重複判定とリネーム有無の表示列のヘッダにはカウント数と行フィルタを切り替えるToggleSwitchを配置しておきます。<br>
<a href="https://camo.qiitausercontent.com/5d0661916d1051a5f49eaa606bb4b631174162c0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f63653639393937642d616234302d356666632d383930642d3866323136333234353262352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fce69997d-ab40-5ffc-890d-8f21632452b5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=cf9e2144936d89d65dd727930e50ec41" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/ce69997d-ab40-5ffc-890d-8f21632452b5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fce69997d-ab40-5ffc-890d-8f21632452b5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bc0388d7fde277209f1b35a95a09456e 1x" loading="lazy"></a></p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">FileElementGrid.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;DataGridTemplateColumn.Header&gt;</span>
   <span class="nt">&lt;materialDesign:Badged</span>
      <span class="na">BadgeColorZoneMode=</span><span class="s">"PrimaryMid"</span>
      <span class="na">DataContext=</span><span class="s">"{Binding DataContext, ElementName=rootObj}"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;materialDesign:Badged.Badge&gt;</span>
         <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">"{Binding DataContext.CountReplaced.Value, ElementName=rootObj}"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/materialDesign:Badged.Badge&gt;</span>
      <span class="nt">&lt;ToggleButton</span> <span class="na">IsChecked=</span><span class="s">"{Binding IsVisibleReplacedOnly.Value}"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;materialDesign:PackIcon</span> <span class="na">Kind=</span><span class="s">"CheckBold"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/ToggleButton&gt;</span>
   <span class="nt">&lt;/materialDesign:Badged&gt;</span>
<span class="nt">&lt;/DataGridTemplateColumn.Header&gt;</span>
</code></pre></div>
</div>

<p>ディレクトリ表示列は中身をButtonにして、クリックされたらエクスプローラーで開くようにします。特定のファイルだけ手修正したい場合などに使用します。<br>
<a href="https://camo.qiitausercontent.com/d102a0aaaf7fb68d6752aaac91d6abb920f60cde/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f30386333316264612d353936642d633335332d313232362d3738643261356235356532372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F08c31bda-596d-c353-1226-78d2a5b55e27.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8b8ad73eefbe9eea713644d83a20dd3c" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/08c31bda-596d-c353-1226-78d2a5b55e27.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F08c31bda-596d-c353-1226-78d2a5b55e27.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a1b6058a04da706a7afac2887d78d7f2 1x" loading="lazy"></a></p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">FileElementGrid.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;DataGridTemplateColumn&gt;</span>
   <span class="nt">&lt;DataGridTemplateColumn.CellTemplate&gt;</span>
      <span class="nt">&lt;DataTemplate&gt;</span>
         <span class="nt">&lt;Button</span>
         <span class="na">Command=</span><span class="s">"{Binding OpenInExploreCommand, Mode=OneTime}"</span>
         <span class="na">Style=</span><span class="s">"{StaticResource MaterialDesignFlatButton}"</span>
         <span class="na">ToolTip=</span><span class="s">"{Binding DirectoryPath, Mode=OneTime}"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;materialDesign:PackIcon</span> <span class="na">Kind=</span><span class="s">"FolderEditOutline"</span> <span class="nt">/&gt;</span>
               <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">"{Binding DirectoryPath, Mode=OneTime}"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/StackPanel&gt;</span>
         <span class="nt">&lt;/Button&gt;</span>
      <span class="nt">&lt;/DataTemplate&gt;</span>
   <span class="nt">&lt;/DataGridTemplateColumn.CellTemplate&gt;</span>
<span class="nt">&lt;/DataGridTemplateColumn&gt;</span>
</code></pre></div>
</div>

<p>DataGridで使用している細かい技術は以前の記事を参照ください。<br>
<a href="https://qiita.com/soi/items/d94c052fd962354c2500" id="reference-68cceb4ea46c95a58fe4">DataGridやListBox内でクリックされたら自身の行を上下に移動するButton</a><br>
<a href="https://qiita.com/soi/items/94b652850e5ad5394330" id="reference-6c8ac9d16608a18ba3dd">DataGridやListBox内でクリックされたら自身の行を削除するButton</a><br>
<a href="https://qiita.com/soi/items/11a5c232d47585a3f83e" id="reference-ba8c68ee6475d535000f">C#のColor関連の便利拡張メソッド＋α 24選（HSV色空間への変換も）</a></p>

<h4>
<span id="差分表示-1" class="fragment"></span><a href="#%E5%B7%AE%E5%88%86%E8%A1%A8%E7%A4%BA-1"><i class="fa fa-link"></i></a>差分表示</h4>

<p><a href="https://camo.qiitausercontent.com/4c9f24b018c086e9cf552dc3e506015bce5ed7d0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f37353235363033622d383636652d613835612d376134342d3035656331633733643437302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F7525603b-866e-a85a-7a44-05ec1c73d470.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4f818ae53377a5a512508ba2820f6f79" alt="screenshot2.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/7525603b-866e-a85a-7a44-05ec1c73d470.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F7525603b-866e-a85a-7a44-05ec1c73d470.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b9e0d45b9573e132dd099aac911e91c6 1x" loading="lazy"></a><br>
ViewModel内のDiffPlexで作成した差分情報をDataGrid内のRichTextBoxにBindingしています。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">FileElementGrid.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;DataGridTemplateColumn</span> <span class="na">Header=</span><span class="s">"{x:Static properties:Resources.Grid_OldText}"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;DataGridTemplateColumn.CellTemplate&gt;</span>
      <span class="nt">&lt;DataTemplate&gt;</span>
         <span class="nt">&lt;RichTextBox</span> <span class="na">v:RichTextBoxHelper.Document=</span><span class="s">"{Binding Diff.Value.OldText, Converter={StaticResource DiffPaneModelToFlowDocumentConverter}}"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/DataTemplate&gt;</span>
   <span class="nt">&lt;/DataGridTemplateColumn.CellTemplate&gt;</span>
<span class="nt">&lt;/DataGridTemplateColumn&gt;</span>
</code></pre></div>
</div>

<p>独自のConverterを使用して、DiffPlexの差分情報からRichTextBoxの中身のFlowDocumentに変換しています。<br>
差分情報内のワード境界ごとに無変更・削除(Deleted)・挿入(Inserted)・挿入前(Imaginary)・修正(Modified)のどれかに判定されます。ただし1行単位で比較していないため、挿入前・修正は実際には使われないようです。<br>
削除の場合はピンク、挿入の場合は黄緑色を指定しています。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">DiffPaneModelToFlowDocumentConverter.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">DiffPaneModelToFlowDocumentConverter</span> <span class="p">:</span> <span class="n">IValueConverter</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Brush</span> <span class="n">unchangeBrush</span> <span class="p">=</span> <span class="n">Colors</span><span class="p">.</span><span class="n">Transparent</span><span class="p">.</span><span class="nf">ToSolidColorBrush</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Brush</span> <span class="n">deletedBrush</span> <span class="p">=</span> <span class="n">AppExtention</span><span class="p">.</span><span class="nf">ToColorOrDefault</span><span class="p">(</span><span class="s">$"#FFAFD1"</span><span class="p">).</span><span class="nf">ToSolidColorBrush</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Brush</span> <span class="n">insertedBrush</span> <span class="p">=</span> <span class="n">AppExtention</span><span class="p">.</span><span class="nf">ToColorOrDefault</span><span class="p">(</span><span class="s">$"#88E6A7"</span><span class="p">).</span><span class="nf">ToSolidColorBrush</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Brush</span> <span class="n">imaginaryBrush</span> <span class="p">=</span> <span class="n">Colors</span><span class="p">.</span><span class="n">SkyBlue</span><span class="p">.</span><span class="nf">ToSolidColorBrush</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Brush</span> <span class="n">modifiedBrush</span> <span class="p">=</span> <span class="n">Colors</span><span class="p">.</span><span class="n">Orange</span><span class="p">.</span><span class="nf">ToSolidColorBrush</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Brush</span> <span class="n">changedTextBrush</span> <span class="p">=</span> <span class="n">Colors</span><span class="p">.</span><span class="n">Black</span><span class="p">.</span><span class="nf">ToSolidColorBrush</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Brush</span> <span class="n">normalTextBrush</span> <span class="p">=</span> <span class="p">(</span><span class="n">SolidColorBrush</span><span class="p">)</span><span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Resources</span><span class="p">[</span><span class="s">"MaterialDesignBody"</span><span class="p">];</span>

    <span class="k">public</span> <span class="kt">object</span> <span class="nf">Convert</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">,</span> <span class="n">Type</span> <span class="n">targetType</span><span class="p">,</span> <span class="kt">object</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Globalization</span><span class="p">.</span><span class="n">CultureInfo</span> <span class="n">culture</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(!(</span><span class="k">value</span> <span class="k">is</span> <span class="n">DiffPaneModel</span> <span class="n">diffVM</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Binding</span><span class="p">.</span><span class="n">DoNothing</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(!</span><span class="n">diffVM</span><span class="p">.</span><span class="n">Lines</span><span class="p">.</span><span class="nf">Any</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">Binding</span><span class="p">.</span><span class="n">DoNothing</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">diffVM</span><span class="p">.</span><span class="n">Lines</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">1</span><span class="p">)</span>
            <span class="n">LogTo</span><span class="p">.</span><span class="nf">Warning</span><span class="p">(</span><span class="s">"Lines Count is over. {@LinesCount}"</span><span class="p">,</span> <span class="n">diffVM</span><span class="p">.</span><span class="n">Lines</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>

        <span class="n">List</span><span class="p">&lt;</span><span class="n">Run</span><span class="p">&gt;</span> <span class="n">lineView</span> <span class="p">=</span> <span class="nf">ConvertLinveVmToRuns</span><span class="p">(</span><span class="n">diffVM</span><span class="p">.</span><span class="n">Lines</span><span class="p">.</span><span class="nf">First</span><span class="p">());</span>

        <span class="kt">var</span> <span class="n">paragraph</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Paragraph</span><span class="p">();</span>
        <span class="n">paragraph</span><span class="p">.</span><span class="n">Inlines</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">lineView</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">FlowDocument</span><span class="p">(</span><span class="n">paragraph</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">static</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Run</span><span class="p">&gt;</span> <span class="nf">ConvertLinveVmToRuns</span><span class="p">(</span><span class="n">DiffPiece</span> <span class="n">lineVM</span><span class="p">)</span> <span class="p">=&gt;</span>
        <span class="n">lineVM</span><span class="p">.</span><span class="n">Type</span> <span class="k">switch</span>
        <span class="p">{</span>
            <span class="c1">//ChangeType.Modifiedだったら変更された部分だけハイライトしたいのでSubPieceからいろいろやる</span>
            <span class="n">ChangeType</span><span class="p">.</span><span class="n">Modified</span> <span class="p">=&gt;</span> <span class="n">lineVM</span>
                <span class="p">.</span><span class="n">SubPieces</span>
                <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="nf">ConvertPieceVmToRun</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="p">.</span><span class="nf">ToList</span><span class="p">(),</span>

            <span class="c1">//ChangeType.Modified以外は行全体で同じ書式</span>
            <span class="n">_</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Run</span><span class="p">&gt;</span> <span class="p">{</span> <span class="nf">ConvertPieceVmToRun</span><span class="p">(</span><span class="n">lineVM</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">};</span>

    <span class="k">private</span> <span class="k">static</span> <span class="n">Run</span> <span class="nf">ConvertPieceVmToRun</span><span class="p">(</span><span class="n">DiffPiece</span> <span class="n">pieceVM</span><span class="p">)</span> <span class="p">=&gt;</span>
        <span class="k">new</span> <span class="n">Run</span>
        <span class="p">{</span>
            <span class="n">Text</span> <span class="p">=</span> <span class="n">pieceVM</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span>
            <span class="n">Foreground</span> <span class="p">=</span> <span class="p">(</span><span class="n">pieceVM</span><span class="p">.</span><span class="n">Type</span> <span class="p">==</span> <span class="n">ChangeType</span><span class="p">.</span><span class="n">Unchanged</span><span class="p">)</span>
                <span class="p">?</span> <span class="n">normalTextBrush</span>
                <span class="p">:</span> <span class="n">changedTextBrush</span><span class="p">,</span>
            <span class="c1">//差分タイプによって、背景色を決定</span>
            <span class="n">Background</span> <span class="p">=</span> <span class="p">(</span><span class="n">pieceVM</span><span class="p">.</span><span class="n">Type</span> <span class="k">switch</span>
            <span class="p">{</span>
                <span class="n">ChangeType</span><span class="p">.</span><span class="n">Deleted</span> <span class="p">=&gt;</span> <span class="n">deletedBrush</span><span class="p">,</span>
                <span class="n">ChangeType</span><span class="p">.</span><span class="n">Inserted</span> <span class="p">=&gt;</span> <span class="n">insertedBrush</span><span class="p">,</span>
                <span class="n">ChangeType</span><span class="p">.</span><span class="n">Imaginary</span> <span class="p">=&gt;</span> <span class="n">imaginaryBrush</span><span class="p">,</span>
                <span class="n">ChangeType</span><span class="p">.</span><span class="n">Modified</span> <span class="p">=&gt;</span> <span class="n">modifiedBrush</span><span class="p">,</span>
                <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">unchangeBrush</span>
            <span class="p">}),</span>
        <span class="p">};</span>

    <span class="k">public</span> <span class="kt">object</span> <span class="nf">ConvertBack</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">,</span> <span class="n">Type</span> <span class="n">targetType</span><span class="p">,</span> <span class="kt">object</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Globalization</span><span class="p">.</span><span class="n">CultureInfo</span> <span class="n">culture</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">LogTo</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">"Not Implemented"</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">Binding</span><span class="p">.</span><span class="n">DoNothing</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>RichTextBoxにFlowDocumentをBindingする方法は過去記事を参照ください。<br>
<a href="https://qiita.com/soi/items/ac970626af21aa5a362f" id="reference-3e9ee857ccffc509b6a8">WPFのRichTextBoxにBindingする</a></p>

<h4>
<span id="ファイルダイアログ" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0"><i class="fa fa-link"></i></a>ファイルダイアログ</h4>

<p>Livet.Extensionsを使用しています。<br>
ButtonのTriggerに設定することで、Viewだけでダイアログ処理を完結することができます。<br>
ViewModelにはユーザーが指定したファイルパス等の必要な情報だけが伝わります。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">MainWindow.xaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;Button</span> <span class="na">Style=</span><span class="s">"{StaticResource MaterialDesignRaisedButton}"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;behaviors:Interaction.Triggers&gt;</span>
      <span class="nt">&lt;behaviors:EventTrigger</span> <span class="na">EventName=</span><span class="s">"Click"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;l:FolderBrowserDialogInteractionMessageAction&gt;</span>
            <span class="nt">&lt;l:DirectInteractionMessage</span> <span class="na">CallbackCommand=</span><span class="s">"{Binding LoadFilesFromDialogCommand, Mode=OneTime}"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;l:FolderSelectionMessage</span>
                  <span class="na">Description=</span><span class="s">"Select Target Folder"</span>
                  <span class="na">DialogPreference=</span><span class="s">"None"</span>
                  <span class="na">SelectedPath=</span><span class="s">"{Binding SettingVM.Value.SearchFilePath.Value}"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/l:DirectInteractionMessage&gt;</span>
         <span class="nt">&lt;/l:FolderBrowserDialogInteractionMessageAction&gt;</span>
      <span class="nt">&lt;/behaviors:EventTrigger&gt;</span>
   <span class="nt">&lt;/behaviors:Interaction.Triggers&gt;</span>
   <span class="nt">&lt;materialDesign:PackIcon</span> <span class="na">Kind=</span><span class="s">"FolderOpen"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/Button&gt;</span>
</code></pre></div>
</div>

<h4>
<span id="多言語対応" class="fragment"></span><a href="#%E5%A4%9A%E8%A8%80%E8%AA%9E%E5%AF%BE%E5%BF%9C"><i class="fa fa-link"></i></a>多言語対応</h4>

<p>ResX Resource Managerを使用しました。<br>
各言語を横に並べて入力できるので便利です。<br>
<a href="https://camo.qiitausercontent.com/fe429348a8c70c5b442d909435c980a781218026/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f61326130393465362d343039302d343963382d366131662d6662343136336236633735622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fa2a094e6-4090-49c8-6a1f-fb4163b6c75b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=aaf8df82220c97cce785d54c1f1bf8c0" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/a2a094e6-4090-49c8-6a1f-fb4163b6c75b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fa2a094e6-4090-49c8-6a1f-fb4163b6c75b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=90f8b76419b2451b6d5b922f47fe6d03 1x" loading="lazy"></a></p>

<p>デフォルトの言語はOSに合わせて変わります。ただし、日本語OS以外は持っていないので検証できていません。<br>
設定メニューから変更することもできます。ただし、リソース文字列は<code>x:Static</code>で取得しているので再起動後でないと反映されないです。</p>

<h4>
<span id="markdown表示" class="fragment"></span><a href="#markdown%E8%A1%A8%E7%A4%BA"><i class="fa fa-link"></i></a>Markdown表示</h4>

<p>アプリケーション情報ページではMarkdownを表示しています。<br>
サードパーティライセンスのMarkdownファイルをリソースとして追加した上で、MarkDigライブラリで表示しています。<br>
MarkDigの詳しい解説は以前の記事を参照ください。<br>
<a href="https://qiita.com/soi/items/a149eec9228bd6d54054" id="reference-95f34b11de33ae0696b0">C#でMarkdownを表示するライブラリMarkDigの紹介</a> </p>

<h1>
<span id="ログ" class="fragment"></span><a href="#%E3%83%AD%E3%82%B0"><i class="fa fa-link"></i></a>ログ</h1>

<p>ロギングはSerilogを使用しています。<br>
メッセージテンプレートを使用して、以下の内容を保存しています。<br>
現在時刻、ログレベル、スレッドID・名称、メッセージ本文、呼び出し元名前空間＋クラス名、呼び出し元メソッドシグネチャ、行番号、使用メモリ量、(あれば例外)</p>

<p>より詳しくは過去記事を参照ください。<br>
<a href="https://qiita.com/soi/items/e74918a924c02e3a3097" id="reference-0d7b141494317adbcc26">C#でSerilogとFody.Anotarを使って、全部盛りのログをとる</a><br>
エラー時のログなどをMicrosoftStoreに送ったりも出来るらしいですが、やり方がわかっていません。</p>

<h1>
<span id="アイコン" class="fragment"></span><a href="#%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3"><i class="fa fa-link"></i></a>アイコン</h1>

<p>パワーポイントでがんばりました。</p>

<h1>
<span id="デプロイ" class="fragment"></span><a href="#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4"><i class="fa fa-link"></i></a>デプロイ</h1>

<h3>
<span id="release" class="fragment"></span><a href="#release"><i class="fa fa-link"></i></a>Release</h3>

<p>単一ファイルかつ、自己完結型で生成しました。<br>
これにより、エンドユーザーは.NET Coreを事前にインストールする必要がありません。</p>

<h3>
<span id="store配布" class="fragment"></span><a href="#store%E9%85%8D%E5%B8%83"><i class="fa fa-link"></i></a>Store配布</h3>

<p>Microsoft Storeにアプリケーションを登録しました。<br>
意外と簡単にできて、コストも2000円弱を初回に払うだけです。<br>
有料アプリの場合は売上から割合で取るようです。</p>

<p>詳しい内容は過去記事、、、ではなくてそのうち書く記事を参考にしてください（もはや登録方法を忘れつつある）。</p>

<h1>
<span id="環境" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>環境</h1>

<p>VisualStudio 2019<br>
C# 8<br>
.NET Core 3.1</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">FileRenamerDiff.csproj</span></div>
<div class="highlight"><pre class="with-code"><code><span class="nt">&lt;ItemGroup&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"DiffPlex"</span> <span class="na">Version=</span><span class="s">"1.6.3"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"LivetCask"</span> <span class="na">Version=</span><span class="s">"3.2.3.1"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"LivetExtensions"</span> <span class="na">Version=</span><span class="s">"3.2.3.1"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"MahApps.Metro"</span> <span class="na">Version=</span><span class="s">"2.1.1"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Markdig"</span> <span class="na">Version=</span><span class="s">"0.18.0"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Markdig.Wpf"</span> <span class="na">Version=</span><span class="s">"0.3.1"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"MaterialDesignColors"</span> <span class="na">Version=</span><span class="s">"1.2.6"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"MaterialDesignThemes"</span> <span class="na">Version=</span><span class="s">"3.1.3"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"MaterialDesignThemes.MahApps"</span> <span class="na">Version=</span><span class="s">"0.1.4"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"ReactiveProperty"</span> <span class="na">Version=</span><span class="s">"6.2.0"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"System.Interactive"</span> <span class="na">Version=</span><span class="s">"4.1.1"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"System.Reactive.Compatibility"</span> <span class="na">Version=</span><span class="s">"4.4.1"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Anotar.Serilog.Fody"</span> <span class="na">Version=</span><span class="s">"5.1.3"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Serilog"</span> <span class="na">Version=</span><span class="s">"2.9.0"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Serilog.Enrichers.Memory"</span> <span class="na">Version=</span><span class="s">"1.0.4"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Serilog.Enrichers.Thread"</span> <span class="na">Version=</span><span class="s">"3.1.0"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Serilog.Exceptions"</span> <span class="na">Version=</span><span class="s">"5.6.0"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Serilog.Formatting.Compact"</span> <span class="na">Version=</span><span class="s">"1.1.0"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Serilog.Sinks.Debug"</span> <span class="na">Version=</span><span class="s">"1.0.1"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Serilog.Sinks.File"</span> <span class="na">Version=</span><span class="s">"4.1.0"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Utf8Json"</span> <span class="na">Version=</span><span class="s">"1.3.7"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ItemGroup&gt;</span>
</code></pre></div>
</div>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<p><a href="https://blog.okazuki.jp/entry/2015/02/22/212827" rel="nofollow noopener" target="_blank">MVVMとリアクティブプログラミングを支援するライブラリ「ReactiveProperty v2.0」オーバービュー</a><br>
<a href="https://github.com/runceel/Livet/blob/master/README.md" rel="nofollow noopener" target="_blank"> Livet/README.md </a><br>
<a href="https://docs.microsoft.com/ja-jp/dotnet/framework/wpf/controls/how-to-group-sort-and-filter-data-in-the-datagrid-control" rel="nofollow noopener" target="_blank">方法: DataGrid コントロールでデータをグループ化、並べ替え、およびフィルター処理する - WPF | Microsoft Docs</a><br>
<a href="https://docs.microsoft.com/ja-jp/dotnet/core/deploying/trim-self-contained" rel="nofollow noopener" target="_blank">自己完結型アプリケーションのトリミング - .NET Core | Microsoft Docs</a><br>
<a href="https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit/blob/master/README.md" rel="nofollow noopener" target="_blank">MaterialDesignInXamlToolkit/README.md</a></p>

<h1>
<span id="余談" class="fragment"></span><a href="#%E4%BD%99%E8%AB%87"><i class="fa fa-link"></i></a>余談</h1>

<p>クラス図のBindingの書き方はこれで良いか、あまり自信ありません。クラス図には書かないほうがよいのかな？でも書かないとViewとViewModelの対応関係わからんしな。<br>
UML詳しい人いたら教えてほしいです。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fsoi%2Fitems%2Faa82eb68577d339dd6af&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fsoi%2Fitems%2Faa82eb68577d339dd6af&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/soi/items/aa82eb68577d339dd6af/likers" class="css-1iupg5d">6</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">10</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/aa82eb68577d339dd6af/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/soi/items/aa82eb68577d339dd6af/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/soi/items/aa82eb68577d339dd6af/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/soi/items/aa82eb68577d339dd6af/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/soi/items/aa82eb68577d339dd6af.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-4465c91c-1c8d-425d-93c3-b22630955524">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-f09e11c2-5446-45fa-9267-60452a40e0e5"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-f09e11c2-5446-45fa-9267-60452a40e0e5">{}</script>
      
<div id="LoginModal-react-component-4f0e934f-9a16-4a7b-9cd6-8feacab2398a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-4f0e934f-9a16-4a7b-9cd6-8feacab2398a">{}</script>
      
<div id="StockModal-react-component-2ac43205-4136-4fbe-9afc-672a69831b6f"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-2ac43205-4136-4fbe-9afc-672a69831b6f">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;pJ1D1MNNArTj8uJTvcLKTCDjh1xzHHtEF56DqPucdY6guNWFOWjmRs9YA3IzRnPZ5YjRcuF4U3ZB7+qDwRrZAQ==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"概要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e概要\u003c/h1\u003e\n\n\u003cp\u003e2020年にもなってファイル名変更ソフトを新しく作りました。名前はFileRenamerDiffです。\u003cbr\u003e\nこの記事では、ソフトウェアの記述解説をします。\u003c/p\u003e\n\n\u003cp\u003eソフトウェアの内容やスクリーンショットは\u003ca href=\"https://qiita.com/soi/items/b03cdfadb9cab8edaf88\" id=\"reference-208698646830d4ac87c1\"\u003e前回の記事\u003c/a\u003eを参照ください。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c909411662837b6d96b7a1ef6654dce16693c227/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f66646366613465332d663162612d613563362d373032622d3265306332363335663834302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Ffdcfa4e3-f1ba-a5c6-702b-2e0c2635f840.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3f10a41d27939bed275f4015c9b3268f\" alt=\"screenshot_ja.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/fdcfa4e3-f1ba-a5c6-702b-2e0c2635f840.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Ffdcfa4e3-f1ba-a5c6-702b-2e0c2635f840.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=19a7ea7825671704bf7ad4fa3f523c1a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eざっくりいうと、WPF on .NET Core by C#です。\u003cbr\u003e\nMVVMライブラリはLivetとReactivePropertyを使用しています。\u003cbr\u003e\nソースコード全体は\u003ca href=\"https://github.com/soi013/FileRenamerDiff\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGitHub\u003c/a\u003eにあります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"使用している主なライブラリ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E4%B8%BB%E3%81%AA%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e使用している主なライブラリ\u003c/h1\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eライブラリ名\u003c/th\u003e\n\u003cth\u003e使用目的\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eReactiveProperty\u003c/td\u003e\n\u003ctd\u003eMVVMライブラリとして、主にViewModelで使用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eLivet\u003c/td\u003e\n\u003ctd\u003eMVVMライブラリとして、ViewとViewModelの連携やINotifyPropertyChanged実装基底クラスなど\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDiffPlex\u003c/td\u003e\n\u003ctd\u003e差分表示、ViewModelで使用。ViewではDataGrid内のRichTextBoxにBindingされます。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMahApps\u003c/td\u003e\n\u003ctd\u003eViewのデザインライブラリ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMaterialDesignThemes\u003c/td\u003e\n\u003ctd\u003eViewのデザインライブラリ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMarkdig\u003c/td\u003e\n\u003ctd\u003eViewのライセンス表記などのMarkdownの表示\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUtf8Json\u003c/td\u003e\n\u003ctd\u003eJSON設定ファイルの読込／保存\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSerilog\u003c/td\u003e\n\u003ctd\u003eロギング\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"全体構成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%A8%E4%BD%93%E6%A7%8B%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e全体構成\u003c/h1\u003e\n\n\u003cp\u003eMVVMパターンですので、Model-ViewModel-Viewの3層に分割して、ViewとViewModelの間はBindingによってつながっています。\u003c/p\u003e\n\n\u003cp\u003eメインとなるクラスだけ抜き出したクラス図は以下のようになっています。PlantUMLで書きました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/058d1a6cc726f170b2913d9503fb58eab3a827ae/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f30643966323161392d613530302d336432662d316130382d6365346663386639666334302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F0d9f21a9-a500-3d2f-1a08-ce4fc8f9fc40.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ef4f5e62041c5b15c505c90dff0d981c\" alt=\"FileRenamerDiff.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/0d9f21a9-a500-3d2f-1a08-ce4fc8f9fc40.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F0d9f21a9-a500-3d2f-1a08-ce4fc8f9fc40.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c90af4db0393ef0a327377d05780a35f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e各層ごとに解説します。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"model\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#model\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eModel\u003c/h1\u003e\n\n\u003cp\u003eModel層ではファイルの探索、正規表現を使ったリネーム、リネーム保存、設定ファイル読み書きといったことを行っています。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ファイル探索\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%8E%A2%E7%B4%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイル探索\u003c/h4\u003e\n\n\u003cp\u003e指定されたパス以下のファイルパスを取得します。このとき設定によって、隠しファイルやフォルダ・（狭義の）ファイルの両方か片方だけリストにするか切り替えます。\u003cbr\u003e\n探索されたファイルの情報を\u003ccode\u003eFileElementModel\u003c/code\u003eにまとめて、そこにリネーム後のファイル名もあとで加えます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"リネーム処理プレビュー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%E5%87%A6%E7%90%86%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eリネーム処理（プレビュー）\u003c/h4\u003e\n\n\u003cp\u003e設定は\u003ccode\u003eSettingAppModel\u003c/code\u003eにまとめてあり、このクラス全体をJSONにシリアライズして設定ファイルとして保存しています。設定には探索対象ディレクトリや複数の削除パターン・置換パターンが含まれています。\u003c/p\u003e\n\n\u003cp\u003eリネームの実行は.NETの\u003ccode\u003eRegex\u003c/code\u003eに置換後の文字列を加えた\u003ccode\u003eReplaceRegex\u003c/code\u003eクラスで行います。複数のファイル名に対して行うのを想定しているので、\u003ccode\u003eRegexOption\u003c/code\u003eは\u003ccode\u003eCompiled\u003c/code\u003eにしておきます。\u003cbr\u003e\nソフトウェアの設定では削除パターンと置換パターンで2種類がありますが、Regexを生成する際には、この削除パターンは全て\u003ccode\u003e|\u003c/code\u003eで結合した1つのRegexにし、置換後の文字列は\u003ccode\u003e\"\"\u003c/code\u003eにしておきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e例）\"a\"、\"b\"、\"c\"、を削除\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"a1b2c3\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"(a|b|c)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//結果\"123\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"重複判定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%87%8D%E8%A4%87%E5%88%A4%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e重複判定\u003c/h4\u003e\n\n\u003cp\u003eリネーム処理後に同じファイルパスが含まれていた場合、ファイルパスが重複しているとみなし、リネーム保存を禁止しています。なお、Windowsは大文字・小文字は同じとみなします。\u003cbr\u003e\nリネーム後のファイルパスだけでなく、リネーム前のファイルパスとも重複していないかを判定しています。これは保存の順番によっては失敗する場合があるためです。\u003cbr\u003e\n例）\"A.txt\", \"B.txt\"というファイル名が同じディレクトリにあり、\"A\"を\"b\"に、\"B\"を\"c\"に置き換えるリネームをした場合、先に\"A.txt\"→\"b.txt\"が保存されると既存の\"B.txt\"と重複して失敗してしまいます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"リネーム保存\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%E4%BF%9D%E5%AD%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eリネーム保存\u003c/h4\u003e\n\n\u003cp\u003eリネーム保存時は深い階層のファイルから保存します。フォルダもリネームする場合、保存前のファイルが移動したことになり失敗してしまいます。\u003cbr\u003e\n例）\"/Main/Sub/\"という階層のフォルダがあり、\"/Main\"と\"/Sub\"をリネームする場合、\"/Main\"を先にリネーム保存してしまうと、\"/Main/Sub\"が見つからなくなります。\u003c/p\u003e\n\n\u003cp\u003eまた、リネーム処理自体もファイルかフォルダかで処理が微妙に異なります。これは過去記事を参照ください。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/18d5b10b20f5e221efca\" id=\"reference-88c44b4aefdb679081c1\"\u003eC#で確実にファイル名を変更する\u003c/a\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"reactivepropertymodel\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#reactivepropertymodel\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eReactiveProperty（Model）\u003c/h4\u003e\n\n\u003cp\u003eシリアライズされる\u003ccode\u003eSettingAppModel\u003c/code\u003eクラス以外はViewModelから参照される可変プロパティはだいたいReactivePropertyにしてあります。\u003cbr\u003e\nこれにより、Modelでの変更がRxなストリームとしてViewModel・Viewに伝わります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"viewmodel\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#viewmodel\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eViewModel\u003c/h1\u003e\n\n\u003cp\u003e基本的にはModelの上記機能を呼び出すためのReactiveCommandとModelの状態を反映するReactivePropertyがメインです。\u003cbr\u003e\nViewModelはなるべく薄く作るべきなのですが、差分表示(DiffPlex)やDataGrid用のCollectionViewなどで、ふくらんでいます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"reactivepropertyviewmodel\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#reactivepropertyviewmodel\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eReactiveProperty（ViewModel）\u003c/h4\u003e\n\n\u003cp\u003eリネーム保存などの時間のかかる処理は非同期で行うべきですが、ViewにBindingされるプロパティはUIスレッド以外から変更すると例外が発生してしまいます。\u003cbr\u003e\nこういった事情もReactivePropertyのSchedulerやRxの\u003ccode\u003eObserveOnUIDispatcher()\u003c/code\u003eを使うと解決できます。\u003c/p\u003e\n\n\u003cp\u003e例えば、Modelでの非同期処理の結果、リネームファイル数プロパティ\u003ccode\u003eCountReplaced\u003c/code\u003eが変更になり、それをViewにも表示するためViewModelで同名のプロパティを作る場合はこうします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eFileElementsGridViewModel.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//プロパティ宣言\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIReadOnlyReactiveProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCountConflicted\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//コンストラクタ内で\u003c/span\u003e\n\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCountReplaced\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCountReplaced\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eObserveOnUIDispatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eToReadOnlyReactivePropertySlim\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれにより、Modelのプロパティ変更時のスレッドに関係なく、ViewModelのプロパティ変更はUIスレッドから行われます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"差分表示\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%B7%AE%E5%88%86%E8%A1%A8%E7%A4%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e差分表示\u003c/h4\u003e\n\n\u003cp\u003eDiffPlexというライブラリを使用して、リネーム前後のファイル名の差分情報を生成します。\u003c/p\u003e\n\n\u003cp\u003eDiffPlexの詳しい解説は過去記事を参照ください。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/ae880d73377b13322ec7\" id=\"reference-6909e9579c6819ccb582\"\u003eWPFでGitのDiffっぽい差分表示をするDiffPlexライブラリ。～あるいは、あるジェダイの変遷\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eファイル名の性質上、1行全体のハイライトをしても意味がないので、ワード境界を細かく区切りました。\u003cbr\u003e\nデフォルトの差分表示時のワード境界が全角文字などに対応していなかったので、追加しました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eSideBySideDiffModel\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateDiff\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003einputText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eoutText\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ewordSeparaters\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"sc\"\u003e' '\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'\\t'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'.'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'('\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e')'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'{'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'}'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e','\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'!'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'?'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e';'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e//MarkDiffデフォルトからコピー\u003c/span\u003e\n        \u003cspan class=\"sc\"\u003e'_'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'-'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'['\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e']'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'~'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'+'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'='\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'^'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e    \u003cspan class=\"c1\"\u003e//半角系\u003c/span\u003e\n        \u003cspan class=\"sc\"\u003e'　'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'、'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'。'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'「'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'」'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'（'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'）'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'｛'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'｝'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'・'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'！'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'？'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'；'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'：'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'＿'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'ー'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'－'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'～'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'‐'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'＋'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'＊'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'／'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'＝'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"sc\"\u003e'＾'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e    \u003cspan class=\"c1\"\u003e//全角系\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ediff\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSideBySideDiffBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDiffer\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003ewordSeparaters\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ediff\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eBuildDiffModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einputText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eoutText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれにより、どこが変更されたかが分かりやすくなります。\u003cbr\u003e\n$\\style{background-color:pink;}{報告書「最終版」}$.txt \u003cbr\u003e\n→　$\\style{background-color:LightGreen;}{報告書「最終手前版」}$.txt\u003cbr\u003e\n👇\u003cbr\u003e\n報告書「$\\style{background-color:pink;}{最終版}$」.txt \u003cbr\u003e\n→ 報告書「$\\style{background-color:LightGreen;}{最終手前版}$」.txt\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ファイル情報datagrid用viewmodel\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%83%85%E5%A0%B1datagrid%E7%94%A8viewmodel\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイル情報DataGrid用ViewModel\u003c/h4\u003e\n\n\u003cp\u003eModelでのファイル情報クラス\u003ccode\u003eFileElementModel\u003c/code\u003eに対応した\u003ccode\u003eFileElementViewModel\u003c/code\u003eを作成し、上記差分情報もその中に含めています。\u003cbr\u003e\nただのDataGridにBindingするなら、これを\u003ccode\u003eObservableCollection\u003c/code\u003eなどに入れればよいのですが、並び替えや行フィルタ処理に対応するためには\u003ccode\u003eICollectionView\u003c/code\u003eに変換する必要があります。\u003cbr\u003e\n変換自体は\u003ccode\u003eCollectionViewSource.GetDefaultView()\u003c/code\u003eを呼ぶだけでよいですが、行フィルタを使用する場合は\u003ccode\u003eICollectionViewer\u003c/code\u003eの\u003ccode\u003eFilter\u003c/code\u003eプロパティに表示判定用コールバックを指定して、行フィルタ基準が変わるたびに\u003ccode\u003eRefresh()\u003c/code\u003eメソッドを呼ぶ必要があります。\u003cbr\u003e\n実際のコードのうち関係する部分を抜き出すと以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eFileElementsGridViewModel.cs(部分）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// ファイル情報コレクションのDataGrid用のICollectionView\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eReadOnlyReactivePropertySlim\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eICollectionView\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCViewFileElementVMs\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 置換前後で差があったファイルのみ表示するか\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eReactivePropertySlim\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebool\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eIsVisibleReplacedOnly\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eReactivePropertySlim\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003ebool\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eFileElementsGridViewModel\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCViewFileElementVMs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eObserveProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileElementModels\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateFilePathVMs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eObserveOnUIDispatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateCollectionViewFilePathVMs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToReadOnlyReactivePropertySlim\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//表示基準に変更があったら、表示判定対象に変更があったら、CollectionViewの表示を更新する\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsVisibleReplacedOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCombineLatest\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eThrottle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromMilliseconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eObserveOnUIDispatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubscribe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eRefleshCollectionViewSafe\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eICollectionView\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateCollectionViewFilePathVMs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eObservableCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eFileElementViewModel\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003efVMs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecView\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCollectionViewSource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDefaultView\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efVMs\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecView\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetVisibleRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ecView\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 2つの表示切り替えプロパティと、各行の値に応じて、その行の表示状態を決定する\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"row\"\u0026gt;行VM\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;表示状態\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetVisibleRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!(\u003c/span\u003e\u003cspan class=\"n\"\u003erow\u003c/span\u003e \u003cspan class=\"k\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eFileElementViewModel\u003c/span\u003e \u003cspan class=\"n\"\u003epathVM\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ereplacedVisible\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eIsVisibleReplacedOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003epathVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsReplaced\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econflictedVisible\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eIsVisibleConflictedOnly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003epathVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsConflicted\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ereplacedVisible\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003econflictedVisible\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRefleshCollectionViewSafe\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!(\u003c/span\u003e\u003cspan class=\"n\"\u003eCViewFileElementVMs\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"k\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eListCollectionView\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrentView\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//なぜかCollectionViewが追加中・編集中のことがある。\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentView\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsAddingNew\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLogTo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CollectionView is Adding\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ecurrentView\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCancelNew\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentView\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEditingItem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLogTo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CollectionView is Editing\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ecurrentView\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCommitEdit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ecurrentView\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRefresh\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"view\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#view\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eView\u003c/h1\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"mahappsとmaterialdesignthemes\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mahapps%E3%81%A8materialdesignthemes\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMahAppsとMaterialDesignThemes\u003c/h4\u003e\n\n\u003cp\u003eMahAppsとMaterialDesignThemesという2つのライブラリを使用して、見た目をカッチョイイ感じにします。\u003cbr\u003e\nMahAppsはウインドウのタイトル部分とウインドウの周りにボヤッとした色をつける機能 \u003ccode\u003eGlowBrush\u003c/code\u003e を使用しています。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/bd143294af492a74746e8b07944fabbda18ceb96/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f36636466323565632d643164302d333963312d626332642d6465313833353130363235352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F6cdf25ec-d1d0-39c1-bc2d-de1835106255.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8fc8ab8a27b2c09c7cd3b33ec38d37e1\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/6cdf25ec-d1d0-39c1-bc2d-de1835106255.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F6cdf25ec-d1d0-39c1-bc2d-de1835106255.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=35f7c17559958ff4d1fb2c233689f8a5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eウインドウの周りがちょっと青いのがわかりますでしょうか。\u003cbr\u003e\nそれ以外のコントロールはMaterialDesignThemesのテーマが適用されています。\u003c/p\u003e\n\n\u003cp\u003e今回はプリセット色は使わず、すべてカラーコードを指定したかったので、プリセットの色に上書きします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eApp.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Color\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Key=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Primary900\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e#1A537C\u003cspan class=\"nt\"\u003e\u0026lt;/Color\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;Color\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Key=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Primary800\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e#286591\u003cspan class=\"nt\"\u003e\u0026lt;/Color\u0026gt;\u003c/span\u003e\n...\n\u003cspan class=\"nt\"\u003e\u0026lt;Color\u003c/span\u003e \u003cspan class=\"na\"\u003ex:Key=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Primary50\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e#E8EFF4\u003cspan class=\"nt\"\u003e\u0026lt;/Color\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eMaterialDesignThemesの詳しい内容は # 参考 を参照してください。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"テーマ変更\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%83%BC%E3%83%9E%E5%A4%89%E6%9B%B4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテーマ変更\u003c/h4\u003e\n\n\u003cp\u003eLigth/Darkテーマ切り替えをやってみたかったので、作ってみました。\u003cbr\u003e\nMaterialDesignThemesの\u003ccode\u003ePaletteHelper\u003c/code\u003eを使ってデフォルトのテーマをGet、変更後にSetします。\u003cbr\u003e\nメイン色と前景色のペアで設定します。両者はある程度の明暗差がないと見づらいです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eApp.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eChangeTheme\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epaletteHelper\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePaletteHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etheme\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epaletteHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetTheme\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisDark\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSetting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsAppDarkTheme\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetBaseTheme\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eisDark\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003eTheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDark\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eTheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryDark\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eColorPair\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Primary700\"\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eColors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryMid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eColorPair\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Primary500\"\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eColors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhite\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryLight\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Primary300\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePaper\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAppExtention\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToColorOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisDark\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"s\"\u003e\"#272E33\"\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"#E6EDF2\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//ベース色とのコントラストが\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"HighContrastBrush\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisDark\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryLight\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryDark\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003epaletteHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetTheme\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etheme\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eただし、各種色やBrushはStaticResourceで指定されているので、再起動後に反映されます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ファイル情報datagrid差分以外\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%83%85%E5%A0%B1datagrid%E5%B7%AE%E5%88%86%E4%BB%A5%E5%A4%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイル情報DataGrid（差分以外）\u003c/h4\u003e\n\n\u003cp\u003eViewModelのファイル情報クラス\u003ccode\u003eFileElementViewModel\u003c/code\u003eを含んだICollectionViewをDataGridにBindingしています。\u003c/p\u003e\n\n\u003cp\u003e重複判定とリネーム有無の表示列のヘッダにはカウント数と行フィルタを切り替えるToggleSwitchを配置しておきます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/5d0661916d1051a5f49eaa606bb4b631174162c0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f63653639393937642d616234302d356666632d383930642d3866323136333234353262352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fce69997d-ab40-5ffc-890d-8f21632452b5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=cf9e2144936d89d65dd727930e50ec41\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/ce69997d-ab40-5ffc-890d-8f21632452b5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fce69997d-ab40-5ffc-890d-8f21632452b5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bc0388d7fde277209f1b35a95a09456e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eFileElementGrid.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;DataGridTemplateColumn.Header\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;materialDesign:Badged\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eBadgeColorZoneMode=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PrimaryMid\"\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eDataContext=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding DataContext, ElementName=rootObj}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;materialDesign:Badged.Badge\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;TextBlock\u003c/span\u003e \u003cspan class=\"na\"\u003eText=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding DataContext.CountReplaced.Value, ElementName=rootObj}\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/materialDesign:Badged.Badge\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;ToggleButton\u003c/span\u003e \u003cspan class=\"na\"\u003eIsChecked=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding IsVisibleReplacedOnly.Value}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;materialDesign:PackIcon\u003c/span\u003e \u003cspan class=\"na\"\u003eKind=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CheckBold\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/ToggleButton\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;/materialDesign:Badged\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/DataGridTemplateColumn.Header\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eディレクトリ表示列は中身をButtonにして、クリックされたらエクスプローラーで開くようにします。特定のファイルだけ手修正したい場合などに使用します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d102a0aaaf7fb68d6752aaac91d6abb920f60cde/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f30386333316264612d353936642d633335332d313232362d3738643261356235356532372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F08c31bda-596d-c353-1226-78d2a5b55e27.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8b8ad73eefbe9eea713644d83a20dd3c\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/08c31bda-596d-c353-1226-78d2a5b55e27.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F08c31bda-596d-c353-1226-78d2a5b55e27.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a1b6058a04da706a7afac2887d78d7f2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eFileElementGrid.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;DataGridTemplateColumn\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;DataGridTemplateColumn.CellTemplate\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;DataTemplate\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e\n         \u003cspan class=\"na\"\u003eCommand=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding OpenInExploreCommand, Mode=OneTime}\"\u003c/span\u003e\n         \u003cspan class=\"na\"\u003eStyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{StaticResource MaterialDesignFlatButton}\"\u003c/span\u003e\n         \u003cspan class=\"na\"\u003eToolTip=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding DirectoryPath, Mode=OneTime}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;StackPanel\u003c/span\u003e \u003cspan class=\"na\"\u003eOrientation=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Horizontal\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n               \u003cspan class=\"nt\"\u003e\u0026lt;materialDesign:PackIcon\u003c/span\u003e \u003cspan class=\"na\"\u003eKind=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"FolderEditOutline\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n               \u003cspan class=\"nt\"\u003e\u0026lt;TextBlock\u003c/span\u003e \u003cspan class=\"na\"\u003eText=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding DirectoryPath, Mode=OneTime}\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;/StackPanel\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;/Button\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/DataTemplate\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;/DataGridTemplateColumn.CellTemplate\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/DataGridTemplateColumn\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eDataGridで使用している細かい技術は以前の記事を参照ください。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/d94c052fd962354c2500\" id=\"reference-68cceb4ea46c95a58fe4\"\u003eDataGridやListBox内でクリックされたら自身の行を上下に移動するButton\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/94b652850e5ad5394330\" id=\"reference-6c8ac9d16608a18ba3dd\"\u003eDataGridやListBox内でクリックされたら自身の行を削除するButton\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/11a5c232d47585a3f83e\" id=\"reference-ba8c68ee6475d535000f\"\u003eC#のColor関連の便利拡張メソッド＋α 24選（HSV色空間への変換も）\u003c/a\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"差分表示-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%B7%AE%E5%88%86%E8%A1%A8%E7%A4%BA-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e差分表示\u003c/h4\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4c9f24b018c086e9cf552dc3e506015bce5ed7d0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f37353235363033622d383636652d613835612d376134342d3035656331633733643437302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F7525603b-866e-a85a-7a44-05ec1c73d470.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4f818ae53377a5a512508ba2820f6f79\" alt=\"screenshot2.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/7525603b-866e-a85a-7a44-05ec1c73d470.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2F7525603b-866e-a85a-7a44-05ec1c73d470.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b9e0d45b9573e132dd099aac911e91c6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nViewModel内のDiffPlexで作成した差分情報をDataGrid内のRichTextBoxにBindingしています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eFileElementGrid.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;DataGridTemplateColumn\u003c/span\u003e \u003cspan class=\"na\"\u003eHeader=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{x:Static properties:Resources.Grid_OldText}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;DataGridTemplateColumn.CellTemplate\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;DataTemplate\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;RichTextBox\u003c/span\u003e \u003cspan class=\"na\"\u003ev:RichTextBoxHelper.Document=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding Diff.Value.OldText, Converter={StaticResource DiffPaneModelToFlowDocumentConverter}}\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/DataTemplate\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;/DataGridTemplateColumn.CellTemplate\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/DataGridTemplateColumn\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e独自のConverterを使用して、DiffPlexの差分情報からRichTextBoxの中身のFlowDocumentに変換しています。\u003cbr\u003e\n差分情報内のワード境界ごとに無変更・削除(Deleted)・挿入(Inserted)・挿入前(Imaginary)・修正(Modified)のどれかに判定されます。ただし1行単位で比較していないため、挿入前・修正は実際には使われないようです。\u003cbr\u003e\n削除の場合はピンク、挿入の場合は黄緑色を指定しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eDiffPaneModelToFlowDocumentConverter.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDiffPaneModelToFlowDocumentConverter\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIValueConverter\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eBrush\u003c/span\u003e \u003cspan class=\"n\"\u003eunchangeBrush\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eColors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTransparent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eBrush\u003c/span\u003e \u003cspan class=\"n\"\u003edeletedBrush\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAppExtention\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToColorOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"#FFAFD1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eBrush\u003c/span\u003e \u003cspan class=\"n\"\u003einsertedBrush\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAppExtention\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToColorOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"#88E6A7\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eBrush\u003c/span\u003e \u003cspan class=\"n\"\u003eimaginaryBrush\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eColors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSkyBlue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eBrush\u003c/span\u003e \u003cspan class=\"n\"\u003emodifiedBrush\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eColors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eBrush\u003c/span\u003e \u003cspan class=\"n\"\u003echangedTextBrush\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eColors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBlack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eBrush\u003c/span\u003e \u003cspan class=\"n\"\u003enormalTextBrush\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSolidColorBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResources\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MaterialDesignBody\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"n\"\u003etargetType\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003eparameter\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGlobalization\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInfo\u003c/span\u003e \u003cspan class=\"n\"\u003eculture\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!(\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"k\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eDiffPaneModel\u003c/span\u003e \u003cspan class=\"n\"\u003ediffVM\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDoNothing\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003ediffVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLines\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDoNothing\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ediffVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLines\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eLogTo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Lines Count is over. {@LinesCount}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ediffVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLines\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elineView\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertLinveVmToRuns\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ediffVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLines\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eparagraph\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eParagraph\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eparagraph\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInlines\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elineView\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eFlowDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparagraph\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertLinveVmToRuns\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDiffPiece\u003c/span\u003e \u003cspan class=\"n\"\u003elineVM\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elineVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//ChangeType.Modifiedだったら変更された部分だけハイライトしたいのでSubPieceからいろいろやる\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eChangeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eModified\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elineVM\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSubPieces\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertPieceVmToRun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToList\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//ChangeType.Modified以外は行全体で同じ書式\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertPieceVmToRun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elineVM\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eRun\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertPieceVmToRun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDiffPiece\u003c/span\u003e \u003cspan class=\"n\"\u003epieceVM\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eRun\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epieceVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eForeground\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epieceVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eChangeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUnchanged\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003enormalTextBrush\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003echangedTextBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//差分タイプによって、背景色を決定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eBackground\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epieceVM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eChangeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeleted\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edeletedBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eChangeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInserted\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003einsertedBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eChangeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eImaginary\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eimaginaryBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eChangeType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eModified\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003emodifiedBrush\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eunchangeBrush\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertBack\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"n\"\u003etargetType\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003eparameter\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGlobalization\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInfo\u003c/span\u003e \u003cspan class=\"n\"\u003eculture\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLogTo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Not Implemented\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDoNothing\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eRichTextBoxにFlowDocumentをBindingする方法は過去記事を参照ください。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/ac970626af21aa5a362f\" id=\"reference-3e9ee857ccffc509b6a8\"\u003eWPFのRichTextBoxにBindingする\u003c/a\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ファイルダイアログ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイルダイアログ\u003c/h4\u003e\n\n\u003cp\u003eLivet.Extensionsを使用しています。\u003cbr\u003e\nButtonのTriggerに設定することで、Viewだけでダイアログ処理を完結することができます。\u003cbr\u003e\nViewModelにはユーザーが指定したファイルパス等の必要な情報だけが伝わります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainWindow.xaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e \u003cspan class=\"na\"\u003eStyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{StaticResource MaterialDesignRaisedButton}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;behaviors:Interaction.Triggers\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;behaviors:EventTrigger\u003c/span\u003e \u003cspan class=\"na\"\u003eEventName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Click\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;l:FolderBrowserDialogInteractionMessageAction\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;l:DirectInteractionMessage\u003c/span\u003e \u003cspan class=\"na\"\u003eCallbackCommand=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding LoadFilesFromDialogCommand, Mode=OneTime}\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n               \u003cspan class=\"nt\"\u003e\u0026lt;l:FolderSelectionMessage\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eDescription=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Select Target Folder\"\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eDialogPreference=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"None\"\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eSelectedPath=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding SettingVM.Value.SearchFilePath.Value}\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;/l:DirectInteractionMessage\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;/l:FolderBrowserDialogInteractionMessageAction\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/behaviors:EventTrigger\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;/behaviors:Interaction.Triggers\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;materialDesign:PackIcon\u003c/span\u003e \u003cspan class=\"na\"\u003eKind=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"FolderOpen\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/Button\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"多言語対応\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%A4%9A%E8%A8%80%E8%AA%9E%E5%AF%BE%E5%BF%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e多言語対応\u003c/h4\u003e\n\n\u003cp\u003eResX Resource Managerを使用しました。\u003cbr\u003e\n各言語を横に並べて入力できるので便利です。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/fe429348a8c70c5b442d909435c980a781218026/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3132303037372f61326130393465362d343039302d343963382d366131662d6662343136336236633735622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fa2a094e6-4090-49c8-6a1f-fb4163b6c75b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=aaf8df82220c97cce785d54c1f1bf8c0\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/120077/a2a094e6-4090-49c8-6a1f-fb4163b6c75b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F120077%2Fa2a094e6-4090-49c8-6a1f-fb4163b6c75b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=90f8b76419b2451b6d5b922f47fe6d03 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eデフォルトの言語はOSに合わせて変わります。ただし、日本語OS以外は持っていないので検証できていません。\u003cbr\u003e\n設定メニューから変更することもできます。ただし、リソース文字列は\u003ccode\u003ex:Static\u003c/code\u003eで取得しているので再起動後でないと反映されないです。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"markdown表示\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#markdown%E8%A1%A8%E7%A4%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMarkdown表示\u003c/h4\u003e\n\n\u003cp\u003eアプリケーション情報ページではMarkdownを表示しています。\u003cbr\u003e\nサードパーティライセンスのMarkdownファイルをリソースとして追加した上で、MarkDigライブラリで表示しています。\u003cbr\u003e\nMarkDigの詳しい解説は以前の記事を参照ください。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/a149eec9228bd6d54054\" id=\"reference-95f34b11de33ae0696b0\"\u003eC#でMarkdownを表示するライブラリMarkDigの紹介\u003c/a\u003e \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ログ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AD%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eログ\u003c/h1\u003e\n\n\u003cp\u003eロギングはSerilogを使用しています。\u003cbr\u003e\nメッセージテンプレートを使用して、以下の内容を保存しています。\u003cbr\u003e\n現在時刻、ログレベル、スレッドID・名称、メッセージ本文、呼び出し元名前空間＋クラス名、呼び出し元メソッドシグネチャ、行番号、使用メモリ量、(あれば例外)\u003c/p\u003e\n\n\u003cp\u003eより詳しくは過去記事を参照ください。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/soi/items/e74918a924c02e3a3097\" id=\"reference-0d7b141494317adbcc26\"\u003eC#でSerilogとFody.Anotarを使って、全部盛りのログをとる\u003c/a\u003e\u003cbr\u003e\nエラー時のログなどをMicrosoftStoreに送ったりも出来るらしいですが、やり方がわかっていません。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"アイコン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアイコン\u003c/h1\u003e\n\n\u003cp\u003eパワーポイントでがんばりました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"デプロイ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデプロイ\u003c/h1\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"release\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#release\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRelease\u003c/h3\u003e\n\n\u003cp\u003e単一ファイルかつ、自己完結型で生成しました。\u003cbr\u003e\nこれにより、エンドユーザーは.NET Coreを事前にインストールする必要がありません。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"store配布\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#store%E9%85%8D%E5%B8%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eStore配布\u003c/h3\u003e\n\n\u003cp\u003eMicrosoft Storeにアプリケーションを登録しました。\u003cbr\u003e\n意外と簡単にできて、コストも2000円弱を初回に払うだけです。\u003cbr\u003e\n有料アプリの場合は売上から割合で取るようです。\u003c/p\u003e\n\n\u003cp\u003e詳しい内容は過去記事、、、ではなくてそのうち書く記事を参考にしてください（もはや登録方法を忘れつつある）。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e環境\u003c/h1\u003e\n\n\u003cp\u003eVisualStudio 2019\u003cbr\u003e\nC# 8\u003cbr\u003e\n.NET Core 3.1\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eFileRenamerDiff.csproj\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;ItemGroup\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"DiffPlex\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1.6.3\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"LivetCask\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"3.2.3.1\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"LivetExtensions\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"3.2.3.1\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MahApps.Metro\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"2.1.1\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Markdig\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"0.18.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Markdig.Wpf\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"0.3.1\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MaterialDesignColors\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1.2.6\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MaterialDesignThemes\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"3.1.3\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MaterialDesignThemes.MahApps\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"0.1.4\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ReactiveProperty\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"6.2.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"System.Interactive\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"4.1.1\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"System.Reactive.Compatibility\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"4.4.1\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Anotar.Serilog.Fody\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5.1.3\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Serilog\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"2.9.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Serilog.Enrichers.Memory\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1.0.4\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Serilog.Enrichers.Thread\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"3.1.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Serilog.Exceptions\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"5.6.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Serilog.Formatting.Compact\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1.1.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Serilog.Sinks.Debug\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1.0.1\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Serilog.Sinks.File\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"4.1.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;PackageReference\u003c/span\u003e \u003cspan class=\"na\"\u003eInclude=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Utf8Json\"\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1.3.7\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/ItemGroup\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://blog.okazuki.jp/entry/2015/02/22/212827\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMVVMとリアクティブプログラミングを支援するライブラリ「ReactiveProperty v2.0」オーバービュー\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://github.com/runceel/Livet/blob/master/README.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003e Livet/README.md \u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/framework/wpf/controls/how-to-group-sort-and-filter-data-in-the-datagrid-control\" rel=\"nofollow noopener\" target=\"_blank\"\u003e方法: DataGrid コントロールでデータをグループ化、並べ替え、およびフィルター処理する - WPF | Microsoft Docs\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/core/deploying/trim-self-contained\" rel=\"nofollow noopener\" target=\"_blank\"\u003e自己完結型アプリケーションのトリミング - .NET Core | Microsoft Docs\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit/blob/master/README.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMaterialDesignInXamlToolkit/README.md\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"余談\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%99%E8%AB%87\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e余談\u003c/h1\u003e\n\n\u003cp\u003eクラス図のBindingの書き方はこれで良いか、あまり自信ありません。クラス図には書かないほうがよいのかな？でも書かないとViewとViewModelの対応関係わからんしな。\u003cbr\u003e\nUML詳しい人いたら教えてほしいです。\u003c/p\u003e\n","createdAt":"2020-07-21T22:50:57Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"JzECF6zIaJSkVisCY4MxOa6aK31QSANwmg==--T27Q+S+zCTwFsP8f--8npm43KRrLV1SoevcaT0gg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-07-22T12:39:59Z","likesCount":6,"linkUrl":"https://qiita.com/soi/items/aa82eb68577d339dd6af","organization":null,"originalId":1268838,"stockedCount":10,"title":"C#のみを使って、変更前後の差分表示のできる、ファイル名変更ソフトの作り方","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e概要\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E4%B8%BB%E3%81%AA%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"\u003e使用している主なライブラリ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%A8%E4%BD%93%E6%A7%8B%E6%88%90\"\u003e全体構成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#model\"\u003eModel\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%8E%A2%E7%B4%A2\"\u003eファイル探索\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%E5%87%A6%E7%90%86%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC\"\u003eリネーム処理（プレビュー）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%87%8D%E8%A4%87%E5%88%A4%E5%AE%9A\"\u003e重複判定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%E4%BF%9D%E5%AD%98\"\u003eリネーム保存\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#reactivepropertymodel\"\u003eReactiveProperty（Model）\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\n\u003cli\u003e\n\u003ca href=\"#viewmodel\"\u003eViewModel\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#reactivepropertyviewmodel\"\u003eReactiveProperty（ViewModel）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%B7%AE%E5%88%86%E8%A1%A8%E7%A4%BA\"\u003e差分表示\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%83%85%E5%A0%B1datagrid%E7%94%A8viewmodel\"\u003eファイル情報DataGrid用ViewModel\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\n\n\u003cli\u003e\n\u003ca href=\"#view\"\u003eView\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#mahapps%E3%81%A8materialdesignthemes\"\u003eMahAppsとMaterialDesignThemes\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%83%BC%E3%83%9E%E5%A4%89%E6%9B%B4\"\u003eテーマ変更\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%83%85%E5%A0%B1datagrid%E5%B7%AE%E5%88%86%E4%BB%A5%E5%A4%96\"\u003eファイル情報DataGrid（差分以外）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%B7%AE%E5%88%86%E8%A1%A8%E7%A4%BA-1\"\u003e差分表示\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0\"\u003eファイルダイアログ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%A4%9A%E8%A8%80%E8%AA%9E%E5%AF%BE%E5%BF%9C\"\u003e多言語対応\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#markdown%E8%A1%A8%E7%A4%BA\"\u003eMarkdown表示\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\n\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AD%E3%82%B0\"\u003eログ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3\"\u003eアイコン\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\"\u003eデプロイ\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#release\"\u003eRelease\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#store%E9%85%8D%E5%B8%83\"\u003eStore配布\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%99%E8%AB%87\"\u003e余談\u003c/a\u003e\n\u003c/li\u003e\n\n","totalPv":1784,"uuid":"aa82eb68577d339dd6af","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"ka4srKqtzC46j/KyMpD/bVZUvvdm--rbQFPj6jEay+tAdE--xV1kTC+cocjEQ/ADuxm2Vw==","originalId":120077,"description":"ソフトウェアエンジニア\r\nC#, Xaml チョットワカル","facebookUrl":null,"githubUrl":"https://github.com/soi013","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/120077/profile-images/1473714466","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F120077%2Fprofile-images%2F1473714466?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=6f7ba83906b324468b29567d27c7dee0","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F120077%2Fprofile-images%2F1473714466?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e5a35cbc09752410b5c78938fa1e1273","urlName":"soi","websiteUrl":"","twitterUrl":"https://twitter.com/soi2flatline","twitterUrlName":"soi2flatline","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":".NET","urlName":".net"},{"name":"WPF","urlName":"wpf"},{"name":"ReactiveProperty","urlName":"reactiveproperty"},{"name":"個人開発","urlName":"%e5%80%8b%e4%ba%ba%e9%96%8b%e7%99%ba"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
