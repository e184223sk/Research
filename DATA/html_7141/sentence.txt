アプリにヘルプファイルがあるとユーザーにとっては便利です。
他にも以下のような条件を満たしたいです。そこでMarkdownでヘルプを書いて、変換したローカルhtmlファイルをアプリに組み込み、ヘルプファイルとして使用する方法を説明します。サンプルはWPFで書きましたが、WinFormsでもUWPでも同じようにできます。こんなアプリがあったとして、どうやって使うのか？という時に、中央のHELP!!ボタンを押すと、ローカルHTMLファイルが呼び出され、ヘルプがブラウザで表示されます。
これで中央の🍪を押せばクッキーが焼けることが分かります。ヘルプファイルの元となるMarkdownを好きなエディタで書きます。私はTyporaを愛用しています。Markdownの先頭部分に タイトル・著者名・日時を書くとhtmlファイルのHeadに反映されます。Pandocをインストールします。
ToCの付いたテンプレートとGithub風のcssを指定して、単一htmlファイルを生成します。詳しくは以下のリンクを参照ください。pandocでmarkdownを1ファイルのhtmlに変換する - chocolattips
Pandocメモ - jou4のブログビルド前イベントでPowerShellスクリプトを呼び出し、pandocでhtmlファイルへの変換を行います。
ビルド前なのは生成したhtmlファイルをアプリのコンテンツファイルとして組み込むためです。
pandocの作業は結構時間がかかるため、ビルドのたびに動かしたくありません。そこでMarkdownファイルとhtmlファイルの更新日時を比較して、必要な場合だけ生成するようにします。ビルド前イベントでPowerShellスクリプトを呼びますPowerShellが出来た時点で一度ビルドします。するとプロジェクト＞Resourcesフォルダにhtmlファイルが生成されます。
VisualStudio上でこれのプロパティをコンテンツ、新しい場合はコピーするにしておきます。
またコード管理を使用している場合は生成したhtmlファイルは管理対象から除外しておきます。
ここでもう一度ビルドすると実行フォルダにResourcesフォルダができ、その中にhtmlファイルが配置されます。アプリから、上記で生成して実行フォルダに配置されたhtmlファイルを呼び出します。
これでブラウザでhtmlファイルが表示されます。全体コードを以下の場所においておきます。
https://github.com/soi013/HelpHtmlTestVisualStudio 2019 Version 16.8.4
.NET 5
C# 9
PowerShell Version 5.1.19041.610


