More than 1 year has passed since last update.エクセルのリボンに自作のタブを追加し、ファイルを開いたときにアクティブなシートに対応したタブをアクティブにしたい。
例）アクティブシートがAの時はタブAを、Bの時はタブBをアクティブにするスレッドを使って非同期にウェイトをいれた後、対応するタブをアクティブにする関連しそうなイベントとしては、
- ThisWorkbook#Open
- Ribbon#Load
- WorkSheet#Activate
があった。「WorkSheet#Activate」は、ファイルのオープン時にはそもそも発生しないので除外。
「ThisWorkbook#Open」発生時はリボンがまだ登録されていないのでダメ。
「Ribbon#Load」がよさそうですが、このタイミングでもまだリボンが生成されていないようで失敗。
リボンのLoadが完了したときに発生するイベントがあればいいのだけど、どうもないみたい。しょうがないので、非同期で、登録が終わったころに目的のタブをアクティブにするようにしたところ、無事動いた。


