More than 3 years have passed since last update.今日はいつもにもまして自分用 Tips. PDFのドキュメントを作成する必要があって、ライブラリを調査してみた。今の希望は、特定のフォーマットの文章を簡単に作る事。ゼロからPDFをがっつりレイアウトして作れる。にだいたい書いている。サンプル書いてみた。コードは見ての通りで、ゴリゴリに座標を指定して、テキストとかラインとかを置いていく感じ。難しくないけど、相当ゴリゴリ。わからなかったは、PDFの座標をどう考えるか？このページに解説があった 1pt ≒ 0.352777mm のポイント単位で計算。A4 の場合、約 595x842 pt ⇔ 210x297 mm出来た。めんどい。ざっくりとしたのを作りたいだけなのに、座標の指定とかフォントの指定とか面倒すぎる。ちなみに、私は、あるプロジェクトの検証用になんでもいいからPDFを生成するサンプルを書きたかっただけだ。もっと楽なアプローチはないだろうか？そうだ、誰かがレイアウトをしてくれたらいいじゃないの？ということは、MDから、PDFに変換してくれるようなものがあれば最高じゃね？と思って調べたのがこちら。流石に一発変換では無理だけど、MD -&gt; HTML, HTML -&gt; PDF ならイケるとわかった。スパイクなので冗長なコードが入っているけど、こいつで、MD-&gt; HTML変換。しかもこのライブラリは昔あったライブラリよりずっと高速らしい。これで、HTML -&gt; PDF 変換。これは楽すぎる。これは楽だ。これでいいんじゃない？私はサンプルだから、こんなもんでいいけど、ガチだと、例えば、同じMD でも、GitHub みたいなもうちょっとカッコよいレイアウトにしたいとか思いそう。その場合は、wikiに書いてあったけど、HtmlFormatter.csを継承して、好きな部分をオーバーライドしてあげればいいみたい。HTMLに一旦変換してからやると、世界は広がって楽になった！　ちなみに、HTMLからPDFのライブラリは、C#ネイティブでなくてよければ、wkhtmltopdfというのがあるらしい。ちなみに、印刷の実行に関しては PrinterSettings クラスで可能っぽい。サンプルがついている。


