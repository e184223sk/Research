関数ポインタを受け取る関数をpinvokeでC#から使うときのお作法をメモしておきたい。下記の流れでおこなう。具体的には、下記のような感じ。C++側はdll。
1秒おきに関数ポインタで登録した関数を呼ぶ。
登録と秒数カウント開始のための関数と、カウント停止のための関数を持っておく。C#側はコンソールアプリ。
C++がエクスポートしてる関数をpinvokeで呼ぶ。
カウント開始のための関数を呼ぶ際、ラムダでメソッドを記述し、登録する。C++のプロジェクトをビルドするとき、「pch.hをインクルードしましたか？」みたいなエラーがでるので、プロジェクトの設定で「プリコンパイル済みヘッダーを使用しない」にして、stdafx.hのincludeを削除する必要あり。
dllのPJは、できたdllをC#のPJの出力フォルダにビルド後イベントでコピーしてやらないといけない。
copy /y $(TargetPath) $(SolutionDir)PInvokeTest_deleate_CsApp\bin\$(Platform)\$(Configuration)\
のような感じでコピーする。


