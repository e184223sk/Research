More than 1 year has passed since last update.AppStoreに有料AddInを公開する場合に使える、購入済みユーザーかどうかを確認する仕組みをAutodeskが提供しています。それをEntitlement APIと呼びます。
実際にcodeを書くにあたっての注意点をまとめます。権限確認は、次のフローで行います。このIDは、AppStoreに登録すると発行されます。多くの場合は、このIDをAddInにハードコードすることでしょう。
「登録するAddInに『登録すると発行されるID』をハードコードするなら、デッドロック(鶏と卵)じゃないか!」と思われた方は、正しいです。
厳密には、登録完了しなくても、下書き状態でIDが発行されるので、それを組み込んで提出してください。

上図の赤枠で囲った部分が、Application IDです。ステータスが不完全でも発行されています。Autodesk Accountのユーザー名は後から変更される可能性があるので、Autodesk内では一意のUserIdがAccountに対して割り当てられているようです。
AutodeskにServerに権限確認するには、このUserIdが必要なので、CWebServicesManagerを使って取得します。が実体です。非常に残念なことに、AddinNETFramework.AdWebServicesWrapper.dllは署名されていません。ですので、AddIn自体に署名するならば、参照することが出来ません。
(署名されたアセンブリから、署名がないアセンブリを参照できない)こういった場合は、次の2つの解決方法があります。
1. 自分で勝手に署名する。
2. 実行時にDLLを指定して動的Loadする。
(3. 開発元に署名してもらう)もちろん3.がお勧めなのですが、現実的ではないので「2つの解決方法」としました。
ここでは、2.の方法を取ります。実行時にLoadすると、署名されてなくても警告もでないので、この方法で行きます。Load済みのDLLを再Load(重複Load)すると異常な挙動を取らないか心配でしたが、これは問題がありませんでした。
実際のcodeは以下の通りです。注意点として、Autodesk AccountにLoginしていない状態では、GetUserId()が空文字列を返すことです。ですので、本当に取得できたかどうかはUserIdの中身を確認する必要があります。この内容は、RESTfulやjsonで検索すると優秀な情報があるでしょうから、最終codeを示しておきます。SetResult()は結果を保存するための自作関数です。排他制御が必要だったため、直接メンバ変数を変更せずに、関数経由で結果を保存しています。
その他にも名前しか出てこない変数がありますが、適宜調整してください。Autodesk Inventor API Hacking (概略)


