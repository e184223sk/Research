<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#のパーサコンビネータライブラリSpracheでML風言語のインタプリタを実装する - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/yuchiki1000yen/items/12a90e6fc728b900b376" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="VCJvvDX/WkPMrx6atCKCDs6V187awN4ejjMQRbZK6QAfs7bNVEp/PFLXDq8WpWyrccOE3+F1at1FraFj6gvdSQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@yuchiki1000yen" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#のパーサコンビネータライブラリSpracheでML風言語のインタプリタを実装する - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amc1SGpnN3pqZ3JYamdyUGpnN1BqZzVQamc0M2pnN3pqZ3Jfamc2bmpncVRqZzViamc2bmpnNnBUY0hKaFkyaGw0NEduVFV6cG9xam9xSURvcXA3amdhN2pncVRqZzdQamdyX2pnNWZqZzZyamdyX2pncExscnBfb280WGpnWm5qZ29zJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTc4N2ZkZDY5YWQ2ODFiNWU4YTE3ZmQ3NDkyM2M5OGJi&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGwxWTJocGEya3hNREF3ZVdWdSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTUwNmVkZDYxZmQ0NWU5NWE0MGUzZTQ4NDQ3ZWQzNzM0&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=898464c54a39c74668a61ab17a178db4"><meta property="og:description" content="C#の Spracheというパーサーコンビネータライブラリの紹介記事です。


Sprache とは

C#のパーサーコンビネータライブラリです。Spracheを使うとパーサーコンビネータ方式で簡単にパーサーを作ることができます。今回..."><meta content="https://qiita.com/yuchiki1000yen/items/12a90e6fc728b900b376" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,パーサーコンビネータ,Sprache,パーサー,自作" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-6b5ad5ac-d26d-4f98-9863-36266fc12032"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fyuchiki1000yen%2Fitems%2F12a90e6fc728b900b376">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fyuchiki1000yen%2Fitems%2F12a90e6fc728b900b376">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-6b5ad5ac-d26d-4f98-9863-36266fc12032">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-12-30T23:16:52.000+09:00","dateModified":"2018-12-30T23:55:20.000+09:00","headline":"C#のパーサコンビネータライブラリSpracheでML風言語のインタプリタを実装する","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E3amc1SGpnN3pqZ3JYamdyUGpnN1BqZzVQamc0M2pnN3pqZ3Jfamc2bmpncVRqZzViamc2bmpnNnBUY0hKaFkyaGw0NEduVFV6cG9xam9xSURvcXA3amdhN2pncVRqZzdQamdyX2pnNWZqZzZyamdyX2pncExscnBfb280WGpnWm5qZ29zJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTc4N2ZkZDY5YWQ2ODFiNWU4YTE3ZmQ3NDkyM2M5OGJi\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGwxWTJocGEya3hNREF3ZVdWdSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTUwNmVkZDYxZmQ0NWU5NWE0MGUzZTQ4NDQ3ZWQzNzM0\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=898464c54a39c74668a61ab17a178db4","mainEntityOfPage":"https://qiita.com/yuchiki1000yen/items/12a90e6fc728b900b376","author":{"@type":"Person","address":"","email":null,"identifier":"yuchiki1000yen","name":"yuchiki1000yen","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F211640%2Fprofile-images%2F1546179543?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=beb404d862a1bf416d64865d7534f20d","url":"https://qiita.com/yuchiki1000yen","description":"はてなブログ： http://yuchiki1000yen.hatenablog.com/\r\n\r\nC#や型理論、形式検証に興味があります","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yuchiki1000yen","type":"items","id":"12a90e6fc728b900b376"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yuchiki1000yen","type":"items","id":"12a90e6fc728b900b376"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yuchiki1000yen","type":"items","id":"12a90e6fc728b900b376"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/yuchiki1000yen/items/12a90e6fc728b900b376","location":"/yuchiki1000yen/items/12a90e6fc728b900b376","scheme":"https","host":"qiita.com","port":null,"pathname":"/yuchiki1000yen/items/12a90e6fc728b900b376","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"TZ9xDMHRWeGPn1yabEHOxAjbgf8aatC5YfSLKDwL9CkGDqh9oGR8nhHnTK/OxiBht43S7iHfZHqqajoOYErAYA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-cd3385dc-13a3-48aa-aad4-aa53585f4ced"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/likers" class="css-1iupg5d">24</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">15</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/12a90e6fc728b900b376/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yuchiki1000yen/items/12a90e6fc728b900b376.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/yuchiki1000yen"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/211640/profile-images/1546179543" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/yuchiki1000yen" class="css-10ougpm">@<!-- -->yuchiki1000yen</a><div class="css-1ay9vb9"><span><meta content="2018-12-30T14:16:52Z"/><time dateTime="2018-12-30T14:55:20Z" class="css-m19uds">updated at 2018-12-30</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#のパーサコンビネータライブラリSpracheでML風言語のインタプリタを実装する</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e3%83%91%e3%83%bc%e3%82%b5%e3%83%bc%e3%82%b3%e3%83%b3%e3%83%93%e3%83%8d%e3%83%bc%e3%82%bf" class="css-4czcte">パーサーコンビネータ</a><a href="/tags/sprache" class="css-4czcte">Sprache</a><a href="/tags/%e3%83%91%e3%83%bc%e3%82%b5%e3%83%bc" class="css-4czcte">パーサー</a><a href="/tags/%e8%87%aa%e4%bd%9c" class="css-4czcte">自作</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>C#の <a href="https://github.com/sprache/Sprache/blob/develop/README.md" rel="nofollow noopener" target="_blank">Sprache</a>というパーサーコンビネータライブラリの紹介記事です。</p>

<h1>
<span id="sprache-とは" class="fragment"></span><a href="#sprache-%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>Sprache とは</h1>

<p>C#のパーサーコンビネータライブラリです。Spracheを使うとパーサーコンビネータ方式で簡単にパーサーを作ることができます。今回はSpracheを使ってML風言語のパーサーを実際に作ってみました。今回実装したソースコードは<a href="https://github.com/yuchiki/YuchiKaml" rel="nofollow noopener" target="_blank">こちら</a>です。<br>
ちなみにSpracheという単語は「ことば」を意味するドイツ語で、ʃpʁaːxə（シュプラーヘ/シュプラーハ）と読みます。</p>

<h2>
<span id="パーサーとは" class="fragment"></span><a href="#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>パーサーとは？</h2>

<p>文字列を受け取って構文解析した結果を返すプログラムです。<br>
たとえば、<code>1+x*3</code> という５文字の文字列を受け取り、 </p>

<p>トップ... +<br>
トップ左... 定数1<br>
トップ右... *<br>
トップ右の*の左...変数x<br>
トップ右の*の右...定数3</p>

<p>といったような分析をします。</p>

<h2>
<span id="パーサーコンビネータとは" class="fragment"></span><a href="#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%93%E3%83%8D%E3%83%BC%E3%82%BF%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>パーサーコンビネータとは？</h2>

<p>パースすべき式の仕様が大きくなるにつれて、式全体をパースするパーサーを書くことは困難になっていきます。そこで、大きなパーサーを作る手法として、小さなパーサーを組み合わせて作るパーサーコンビネータという仕組みがあります。</p>

<h3>
<span id="例" class="fragment"></span><a href="#%E4%BE%8B"><i class="fa fa-link"></i></a>例</h3>

<p>整数をパースするパーサーIntParserと、booleanをパースするパーサーBoolParserと、変数をパースするVarParserが書けているとします。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">IntParser</span> <span class="p">=</span> <span class="p">...;</span>
<span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">BoolParser</span> <span class="p">=</span> <span class="p">...;</span>
<span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">VarParser</span> <span class="p">=</span> <span class="p">...;</span>
</code></pre></div></div>

<p>Spracheにおいて、パーサーの型は<code>Parser&lt;T&gt;</code>です。<code>Parse&lt;T&gt;</code>型のパーサーは、文字列を受け取ってそれをパースした結果のT型の値を返すParseメソッドを備えています。<br>
今、整数定数かbool定数か変数のいずれかが起こりうる式Primaryが定義されているとします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>Primary p ::= n | b | x
</code></pre></div></div>

<p>PrimaryのパーサーはIntParser, BoolParser, VarParserを使って次のように書けます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">PrimaryParser</span> <span class="p">=</span> <span class="n">IntParser</span><span class="p">.</span><span class="nf">Or</span><span class="p">(</span><span class="n">BoolParser</span><span class="p">.</span><span class="nf">Or</span><span class="p">(</span><span class="n">VarParser</span><span class="p">));</span>

</code></pre></div></div>

<p>さらに、この Primaryを踏まえてexprが次の用に定義されているとします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>expr e ::= if p then p else p 
</code></pre></div></div>

<p>このexprのパーサーは、先ほど定義したPrimaryParserを用いて次のように書けます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">IfParser</span> <span class="p">=</span>
    <span class="k">from</span> <span class="n">ifToken</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">"if"</span><span class="p">).</span><span class="nf">Token</span><span class="p">()</span>
    <span class="k">from</span> <span class="n">p1</span> <span class="k">in</span> <span class="n">PrimaryParser</span>
    <span class="k">from</span> <span class="n">thenToken</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">"then"</span><span class="p">).</span><span class="nf">Token</span><span class="p">()</span>
    <span class="k">from</span> <span class="n">p2</span> <span class="k">in</span> <span class="n">PrimaryParser</span>
    <span class="k">from</span> <span class="n">elseToken</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="s">"else"</span><span class="p">).</span><span class="n">Token</span>
    <span class="k">from</span> <span class="n">p3</span> <span class="k">in</span> <span class="n">PrimaryParser</span>
    <span class="k">select</span> <span class="k">new</span> <span class="nf">IfExpr</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span>
</code></pre></div></div>

<p>このように、より小さい単位のパーサーを組み合わせてより大きい単位のパーサーを作れる仕組みがパーサーコンビネータです。</p>

<h1>
<span id="ml言語風言語の実例" class="fragment"></span><a href="#ml%E8%A8%80%E8%AA%9E%E9%A2%A8%E8%A8%80%E8%AA%9E%E3%81%AE%E5%AE%9F%E4%BE%8B"><i class="fa fa-link"></i></a>ML言語風言語の実例</h1>

<p>試しにSpracheを使って自作ML言語風トイ言語、<a href="https://github.com/yuchiki/YuchiKaml" rel="nofollow noopener" target="_blank">YuchiKaml</a> のインタプリタを作ってみました。</p>

<h2>
<span id="どんな言語" class="fragment"></span><a href="#%E3%81%A9%E3%82%93%E3%81%AA%E8%A8%80%E8%AA%9E"><i class="fa fa-link"></i></a>どんな言語？</h2>

<p>YuchiKamlの式は以下のBNFで定義します。</p>

<p><a href="https://camo.qiitausercontent.com/1a9590b82833777ac103ad950952198627676815/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3231313634302f38396438633132322d353032362d643733392d383536302d3931343037333433353233652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F211640%2F89d8c122-5026-d739-8560-91407343523e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=434c97e9c543dc7ab16f1ae7ddd539d4" alt="Screenshot from 2018-12-30 13-08-52.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/211640/89d8c122-5026-d739-8560-91407343523e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F211640%2F89d8c122-5026-d739-8560-91407343523e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=408945cf943408531c7fefe3a776c388 1x" loading="lazy"></a></p>

<p>上の<code>x</code>は変数を、<code>n</code>は整数を表します。文法の詳細はこの記事の本質ではないのでここでは詳しく語りませんが、気になる人のために<a href="https://github.com/yuchiki/YuchiKaml_Document/blob/master/document.pdf" rel="nofollow noopener" target="_blank">こちら</a>のpdfに文法の詳細を記しました。</p>

<h2>
<span id="cによる式の表現" class="fragment"></span><a href="#c%E3%81%AB%E3%82%88%E3%82%8B%E5%BC%8F%E3%81%AE%E8%A1%A8%E7%8F%BE"><i class="fa fa-link"></i></a>C#による式の表現</h2>

<p>YuchiKamlの式をC#でどう表現しましょう？<br>
式は式でも、その実はbool定数であったり、整数定数であったり、式+式、式-式の形であったり、 様々です。この色々な形をひっくるめて式として扱うために、継承を使います。<br>
まず、式全体を表す抽象クラスExprを定義します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Expr</span> <span class="p">{}</span>
</code></pre></div></div>

<p>次に、それぞれの形をExprの子クラスとして定義します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
    <span class="k">class</span> <span class="nc">CBool</span> <span class="p">:</span> <span class="n">Expr</span> <span class="p">{</span> <span class="c1">//bool定数を表す</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">Value</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="nf">CInt</span><span class="p">(</span><span class="kt">bool</span> <span class="k">value</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">CInt</span> <span class="p">:</span> <span class="n">Expr</span> <span class="p">{</span> <span class="c1">//整数定数を表す</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Value</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="nf">CInt</span><span class="p">(</span><span class="kt">int</span> <span class="k">value</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">class</span> <span class="nc">Add</span> <span class="p">:</span> <span class="n">Expr</span> <span class="p">{</span> <span class="c1">// 式+式を表す</span>
        <span class="k">public</span> <span class="n">Expr</span> <span class="n">Left</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="n">Expr</span> <span class="n">Right</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> 
        <span class="k">public</span> <span class="nf">Add</span><span class="p">(</span><span class="n">Expr</span> <span class="n">left</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">right</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">Left</span><span class="p">,</span> <span class="n">Right</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Sub</span> <span class="p">:</span> <span class="n">Expr</span> <span class="p">{</span> <span class="c1">// 式-式を表す</span>
        <span class="k">public</span> <span class="n">Expr</span> <span class="n">Left</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="n">Expr</span> <span class="n">Right</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> 
        <span class="k">public</span> <span class="nf">Sub</span><span class="p">(</span><span class="n">Expr</span> <span class="n">left</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">right</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">Left</span><span class="p">,</span> <span class="n">Right</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="p">....</span>
</code></pre></div></div>

<p>これで様々な形を式として扱えるようになりました。<br>
式全体の定義は<a href="https://github.com/yuchiki/YuchiKaml/blob/master/Syntax.cs" rel="nofollow noopener" target="_blank">こちら</a>にあります。ソースコード中では、プリティプリントの関係や二項演算子の定義の共通化などの関係で、上に示した形と少し形が異なっています。</p>

<h2>
<span id="パーサーの定義" class="fragment"></span><a href="#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%81%AE%E5%AE%9A%E7%BE%A9"><i class="fa fa-link"></i></a>パーサーの定義</h2>

<p>Spracheを使ってパーサーを作ります。SpracheのAPIと実装は<a href="https://github.com/sprache/Sprache/blob/develop/src/Sprache/Parse.cs" rel="nofollow noopener" target="_blank">ここ</a>から確認できます。<br>
整数定数をパースするパーサーを例に取ります。</p>

<h3>
<span id="整数定数のパーサー" class="fragment"></span><a href="#%E6%95%B4%E6%95%B0%E5%AE%9A%E6%95%B0%E3%81%AE%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC"><i class="fa fa-link"></i></a>整数定数のパーサー</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">private</span> <span class="k">static</span> <span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">IntParser</span> <span class="p">=</span>
    <span class="k">from</span> <span class="n">digits</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="n">Digit</span><span class="p">.</span><span class="nf">AtLeastOnce</span><span class="p">().</span><span class="nf">Text</span><span class="p">().</span><span class="nf">Token</span><span class="p">()</span>
    <span class="k">select</span> <span class="k">new</span> <span class="nf">CInt</span><span class="p">(</span><span class="kt">int</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">n</span><span class="p">)</span> <span class="p">?</span> <span class="n">n</span> <span class="p">:</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>
</code></pre></div></div>

<p>まず、クエリ構文一行目の<code>in</code>の右側を解説します。<br>
上に出てくる<code>Parse.Digit</code>は、0から9の数字一文字を得るパーサーです。<br>
その他の拡張メソッドは、引数のパーサーから別のパーサーを作るメソッドです。</p>

<table>
<thead>
<tr>
<th style="text-align: left">名前</th>
<th style="text-align: left">引数のパーサー</th>
<th style="text-align: left">戻り値のパーサー</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><code>AtLeastOnce&lt;T&gt;()</code></td>
<td style="text-align: left">Parser型</td>
<td style="text-align: left">引数のパーサーを一回以上繰り返し適用</td>
</tr>
<tr>
<td style="text-align: left"><code>Text()</code></td>
<td style="text-align: left">
<code>Parser&lt;IEnumerable&lt;char&gt;&gt;</code>型</td>
<td style="text-align: left">結果の文字の列を結合</td>
</tr>
<tr>
<td style="text-align: left"><code>Token&lt;T&gt;()</code></td>
<td style="text-align: left">Parser型</td>
<td style="text-align: left">前後の空白を無視</td>
</tr>
</tbody>
</table>

<p>すなわち、上の例の<code>from</code>の右側のパーサーは以下のようなパーサーになります。</p>

<table>
<thead>
<tr>
<th style="text-align: left">パーサー</th>
<th style="text-align: left">型</th>
<th style="text-align: left">パース結果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">Parse.Digit</td>
<td style="text-align: left"><code>Parser&lt;char&gt;</code></td>
<td style="text-align: left">0から9の数字一文字</td>
</tr>
<tr>
<td style="text-align: left">Parse.Digit.AtLeastOnce()</td>
<td style="text-align: left"><code>Parser&lt;IEnumerable&lt;char&gt;&gt;</code></td>
<td style="text-align: left">数字を表す文字型の値の列</td>
</tr>
<tr>
<td style="text-align: left">Parse.Digit.AtLeastOnce().Text()</td>
<td style="text-align: left"><code>Parser&lt;string&gt;</code></td>
<td style="text-align: left">数字を表す文字列型の値</td>
</tr>
<tr>
<td style="text-align: left">Parse.Digit.AtLeastOnce().Text().Token()</td>
<td style="text-align: left"><code>Parser&lt;string&gt;</code></td>
<td style="text-align: left">空白を読み飛ばした、数字を表す文字列型の値</td>
</tr>
</tbody>
</table>

<p>クエリ構文<code>from t in P</code>では、tはパーサーPのパース結果を表しています。<br>
すなわち、以下のdigitsは数字列を表す文字列です。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">from</span> <span class="n">digits</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="n">Digit</span><span class="p">.</span><span class="nf">AtLeastOnce</span><span class="p">().</span><span class="nf">Text</span><span class="p">().</span><span class="nf">Token</span><span class="p">()</span>
</code></pre></div></div>

<p>この次の行の</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">select</span> <span class="k">new</span> <span class="nf">CInt</span><span class="p">(</span><span class="kt">int</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">n</span><span class="p">)</span> <span class="p">?</span> <span class="n">n</span> <span class="p">:</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>
</code></pre></div></div>

<p>では、<code>digits</code>を<code>int</code>型に変換し、 更に <code>new CInt()</code>で 整数定数を表す式に変換したものを<code>select</code>しています。<br>
クエリ式全体では、<code>CInt</code>型の値を得るパーサー、<code>Parser&lt;CInt&gt;</code>になっています。<br>
<code>CInt</code>は<code>Expr</code>の子クラスなので、<code>Parser&lt;CInt&gt;</code>型の値は<code>Parser&lt;Expr&gt;</code>型の変数 <code>IntParser</code>に格納できます。</p>

<h3>
<span id="カッコの中の式のパーサー" class="fragment"></span><a href="#%E3%82%AB%E3%83%83%E3%82%B3%E3%81%AE%E4%B8%AD%E3%81%AE%E5%BC%8F%E3%81%AE%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC"><i class="fa fa-link"></i></a>カッコの中の式のパーサー</h3>

<p>式全体をパースするパーサーMainParserを定義したとき、<br>
<code>(e)</code>を読むパーサーは次のように書けます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">parenParserInner</span> <span class="p">=</span>
    <span class="k">from</span> <span class="n">lParen</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="nf">Char</span><span class="p">(</span><span class="sc">'('</span><span class="p">)</span>
    <span class="k">from</span> <span class="n">e</span> <span class="k">in</span> <span class="n">MainParser</span>
    <span class="k">from</span> <span class="n">rParen</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="nf">Char</span><span class="p">(</span><span class="sc">')'</span><span class="p">)</span>
    <span class="k">select</span> <span class="n">e</span><span class="p">;</span>
</code></pre></div></div>

<p>開きカッコと閉じカッコを読まれはするものの無視され、単純に中身の式を結果とするパーサーになっています。</p>

<h3>
<span id="二項演算子" class="fragment"></span><a href="#%E4%BA%8C%E9%A0%85%E6%BC%94%E7%AE%97%E5%AD%90"><i class="fa fa-link"></i></a>二項演算子</h3>

<p>補助関数BinOpParserを定義し、以下のようにパーサーを作成しました。<br>
<code>Expr.Foo</code>は引数を２つ受け取りFoo型の式を作る関数です。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">BinaryOperatorsParser</span> <span class="p">=</span>
    <span class="nf">BinOpParser</span><span class="p">(</span><span class="n">UnaryParser</span><span class="p">,</span> <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[][]</span> <span class="p">{</span>
        <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[]</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">"*"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Mul</span><span class="p">),</span> <span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Div</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[]</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">"+"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Add</span><span class="p">),</span> <span class="p">(</span><span class="s">"-"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Sub</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[]</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">"&lt;="</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Leq</span><span class="p">),</span> <span class="p">(</span><span class="s">"&lt;"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Lt</span><span class="p">),</span> <span class="p">(</span><span class="s">"&gt;="</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Geq</span><span class="p">),</span> <span class="p">(</span><span class="s">"&gt;"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Gt</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[]</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">"=="</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Eq</span><span class="p">),</span> <span class="p">(</span><span class="s">"!="</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Neq</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[]</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">"&amp;&amp;"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">And</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[]</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">"||"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="n">Or</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">[]</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">"|&gt;"</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">Expr</span><span class="p">.</span><span class="nf">App</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">)),</span>
            <span class="p">(</span><span class="s">"&gt;&gt;"</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">Expr</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="nf">App</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="nf">App</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">Expr</span><span class="p">.</span><span class="nf">Var</span><span class="p">(</span><span class="s">"x"</span><span class="p">)))))</span>
        <span class="p">}</span>
    <span class="p">});</span>
</code></pre></div></div>

<p>補助関数BinOpParserは<a href="https://ja.wikipedia.org/wiki/%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%AE%E5%84%AA%E5%85%88%E9%A0%86%E4%BD%8D" rel="nofollow noopener" target="_blank">演算子の優先順位</a>に気を付けつつ、<a href="https://ja.wikipedia.org/wiki/%E5%B7%A6%E5%86%8D%E5%B8%B0" rel="nofollow noopener" target="_blank">左再帰除去</a>をしつつ、二項演算子たちのパーサーをまとめて構築する関数です。<br>
まず、同一優先順位の演算子たちについて左再帰除去をしたパーサーを組み立てる補助関数BinOpParserを定義します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">private</span> <span class="k">static</span> <span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="nf">BinOpParser</span><span class="p">(</span><span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">elemParser</span><span class="p">,</span> <span class="n">IEnumerable</span> <span class="p">&lt;</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">&gt;</span> <span class="n">operators</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Parser</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">,</span> <span class="n">Expr</span><span class="p">&gt;&gt;</span> <span class="n">restParser</span> <span class="p">=</span>
        <span class="n">operators</span>
        <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="k">from</span> <span class="n">_</span> <span class="k">in</span> <span class="n">Parse</span><span class="p">.</span><span class="nf">String</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">Item1</span><span class="p">).</span><span class="nf">Token</span><span class="p">()</span> <span class="k">from</span> <span class="n">elem</span> <span class="k">in</span> <span class="n">elemParser</span> <span class="k">select</span> <span class="k">new</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">,</span> <span class="n">Expr</span><span class="p">&gt;(</span><span class="n">l</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">Item2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">elem</span><span class="p">)))</span>
        <span class="p">.</span><span class="nf">Aggregate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">Or</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>
    <span class="k">return</span>
        <span class="k">from</span> <span class="n">elem</span> <span class="k">in</span> <span class="n">elemParser</span>
        <span class="k">from</span> <span class="n">rest</span> <span class="k">in</span> <span class="n">restParser</span><span class="p">.</span><span class="nf">Many</span><span class="p">()</span>
        <span class="k">select</span> <span class="n">rest</span><span class="p">.</span><span class="nf">Aggregate</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nf">f</span><span class="p">(</span><span class="n">acc</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>上の補助関数BinOpParserをオーバーロードし、複数の優先順位の演算子に対応した補助関数BinOpParserを定義します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="k">private</span> <span class="k">static</span> <span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="nf">BinOpParser</span><span class="p">(</span><span class="n">Parser</span><span class="p">&lt;</span><span class="n">Expr</span><span class="p">&gt;</span> <span class="n">elemParser</span><span class="p">,</span> <span class="n">IEnumerable</span> <span class="p">&lt;</span> <span class="n">IEnumerable</span> <span class="p">&lt;</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="n">OperatorCreator</span><span class="p">)</span> <span class="p">&gt;&gt;</span> <span class="n">operators</span><span class="p">)</span>
    <span class="p">=&gt;</span> <span class="n">operators</span><span class="p">.</span><span class="nf">Aggregate</span><span class="p">(</span><span class="n">elemParser</span><span class="p">,</span> <span class="n">BinOpParser</span><span class="p">);</span>
</code></pre></div></div>

<p>これを用いて、左結合の二項演算子のパーサーをまとめて定義しています。<br>
補助関数を用いることによりボイラープレートを減らせています。</p>

<h2>
<span id="コード例" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E4%BE%8B"><i class="fa fa-link"></i></a>コード例</h2>

<p>今回のパーサーに<a href="https://github.com/yuchiki/YuchiKaml/blob/master/Syntax.cs" rel="nofollow noopener" target="_blank">インタプリタ</a>＋数個の<a href="https://github.com/yuchiki/YuchiKaml/blob/master/BuiltIns.cs" rel="nofollow noopener" target="_blank">組み込み関数</a>を組み合わせ以下のようなコードが実行できるようになりました。</p>

<h3>
<span id="gcd" class="fragment"></span><a href="#gcd"><i class="fa fa-link"></i></a>GCD</h3>

<p>gcdは２数の最大公約数を求める関数です。</p>

<div class="code-frame" data-lang="ocaml"><div class="highlight"><pre class="with-code"><code>
<span class="k">let</span> <span class="k">rec</span> <span class="n">gcd</span> <span class="n">m</span> <span class="n">n</span> <span class="o">=</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="k">then</span> <span class="n">gcd</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="n">n</span>
    <span class="k">else</span> <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="k">then</span> <span class="n">gcd</span> <span class="n">m</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">else</span> <span class="n">m</span>
<span class="k">in</span> <span class="n">gcd</span> <span class="mi">120</span> <span class="mi">45</span>
</code></pre></div></div>

<h3>
<span id="abc114-a問題" class="fragment"></span><a href="#abc114-a%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>ABC114 A問題</h3>

<p>競技プログラミングのコンテスト、<a href="https://atcoder.jp/contests/abc114/tasks/abc114_a" rel="nofollow noopener" target="_blank">第114回AtCoder Beginer's ContestのA問題</a>の解答プログラムです。</p>

<div class="code-frame" data-lang="ocaml"><div class="highlight"><pre class="with-code"><code><span class="o">#</span><span class="k">include</span><span class="o">&lt;</span><span class="nc">IO</span><span class="o">&gt;</span>

<span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="n">read_num</span> <span class="bp">()</span> <span class="k">in</span>
<span class="k">let</span> <span class="n">ans</span> <span class="o">=</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">3</span> <span class="o">||</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">5</span> <span class="o">||</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">7</span> <span class="k">then</span> <span class="s2">"YES"</span> <span class="k">else</span> <span class="s2">"NO"</span> <span class="k">in</span>
<span class="n">print_endline</span> <span class="n">ans</span>
</code></pre></div></div>

<h3>
<span id="abc114-b問題" class="fragment"></span><a href="#abc114-b%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>ABC114 B問題</h3>

<p>競技プログラミングのコンテスト、<a href="https://atcoder.jp/contests/abc114/tasks/abc114_b" rel="nofollow noopener" target="_blank">第114回AtCoder Beginer's ContestのB問題</a>の解答プログラムです。</p>

<div class="code-frame" data-lang="ocaml"><div class="highlight"><pre class="with-code"><code>
<span class="o">#</span><span class="k">include</span><span class="o">&lt;</span><span class="n">basic</span><span class="o">&gt;</span>
<span class="o">#</span><span class="k">include</span><span class="o">&lt;</span><span class="nc">IO</span><span class="o">&gt;</span>
<span class="o">#</span><span class="k">include</span><span class="o">&lt;</span><span class="kt">list</span><span class="o">&gt;</span>
<span class="o">#</span><span class="k">include</span><span class="o">&lt;</span><span class="n">math</span><span class="o">&gt;</span>

<span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="n">read_line</span> <span class="bp">()</span> <span class="o">|&gt;</span> <span class="n">chars_of_string</span> <span class="k">in</span>
<span class="n">map</span> <span class="p">(</span><span class="n">flip</span> <span class="n">drop</span> <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">take</span> <span class="mi">3</span> <span class="o">&gt;&gt;</span> <span class="n">concat_strings</span> <span class="o">&gt;&gt;</span> <span class="n">num_of_string</span><span class="p">)</span> <span class="p">(</span><span class="n">range</span> <span class="mi">0</span> <span class="p">(</span><span class="n">length</span> <span class="n">s</span> <span class="o">-</span> <span class="mi">3</span><span class="p">))</span>
    <span class="o">|&gt;</span> <span class="n">map</span> <span class="p">(</span><span class="n">subt</span> <span class="mi">753</span> <span class="o">&gt;&gt;</span> <span class="n">abs</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="n">fold</span> <span class="mi">100000</span> <span class="n">min</span>
    <span class="o">|&gt;</span> <span class="n">print_endline</span>

</code></pre></div></div>

<h2>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h2>

<p>Spracheは今回初めて使ったのですが、非常に直感的で使いやすかったです。<br>
みなさんもぜひ使ってみてください。</p>

<p>他にもSpracheの紹介をしている記事はいくつかありますので紹介いたします。</p>

<ul>
<li>
<p><a href="https://qiita.com/ousttrue/items/0a970d1a1f13d98b686a" id="reference-417a0510d8d97f60f85f">C#のパーサコンビネータライブラリSpracheを使ってみる</a></p>

<p>Spracheを使ったパーサー開発の流れがよくわかる記事です。</p>
</li>
<li>
<p><a href="https://qiita.com/ousttrue/items/1cd2fadc1af8bc5882e2" id="reference-ac1bef38f8d485ee92db">Spracheでコメントを飛ばしてパースしてみる</a></p>

<p>コメントの読み飛ばしもしてくれるToken関数を作成しています。<br>
Spracheには<a href="https://github.com/sprache/Sprache/blob/develop/src/Sprache/CommentParser.cs" rel="nofollow noopener" target="_blank">CommentParser</a>もあるので、この記事の手法と組み合わせればかなり楽にコメントを扱えそうです。</p>
</li>
<li>
<p><a href="https://qiita.com/fum1h1ro/items/98fae35ef475cba7462c">例のキヨシチェックを Sprache で書いてみる</a></p>

<p>ズン・ズン・ズン・ズン・ドコの並びを検知する遊びが流行った頃の記事のようです。<br>
ズンとドコの並びをパーサーで検出する面白い記事です。</p>
</li>
<li>
<p><a href="https://qiita.com/myzktkyk/items/b702d31ee7fb5f9b69d4" id="reference-6f5fb39d041ee92bf816">Sprache 使って Parser 書いたけどすごく戸惑ったって話</a></p>

<p>そう！Spracheの公式サンプルって結構読むのが難しいんですよ！<br>
こちらの記事では公式サンプルにわかりやすいコメントを入れてくださっています。</p>
</li>
</ul>

<p>よろしかったら是非いいねを押してくださいませ！</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fyuchiki1000yen%2Fitems%2F12a90e6fc728b900b376&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fyuchiki1000yen%2Fitems%2F12a90e6fc728b900b376&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/likers" class="css-1iupg5d">24</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">15</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/12a90e6fc728b900b376/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yuchiki1000yen/items/12a90e6fc728b900b376/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yuchiki1000yen/items/12a90e6fc728b900b376.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-cd3385dc-13a3-48aa-aad4-aa53585f4ced">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-6d4a7ac2-b626-47dc-a001-d1cde1769052"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-6d4a7ac2-b626-47dc-a001-d1cde1769052">{}</script>
      
<div id="LoginModal-react-component-53d910a3-d0f8-481f-8d45-772026223e5c"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-53d910a3-d0f8-481f-8d45-772026223e5c">{}</script>
      
<div id="StockModal-react-component-e908b0e2-1966-4efe-91a9-5110e15ef1dc"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-e908b0e2-1966-4efe-91a9-5110e15ef1dc">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;uZrbLVZr9ibRVJr7NPvIS9nlffn+KFkeSIGaJNccvPPyCwJcN97TWU8sis6WfCbuZrMu6MWd7d2DHysCi12Iug==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eC#の \u003ca href=\"https://github.com/sprache/Sprache/blob/develop/README.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSprache\u003c/a\u003eというパーサーコンビネータライブラリの紹介記事です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"sprache-とは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sprache-%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSprache とは\u003c/h1\u003e\n\n\u003cp\u003eC#のパーサーコンビネータライブラリです。Spracheを使うとパーサーコンビネータ方式で簡単にパーサーを作ることができます。今回はSpracheを使ってML風言語のパーサーを実際に作ってみました。今回実装したソースコードは\u003ca href=\"https://github.com/yuchiki/YuchiKaml\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eです。\u003cbr\u003e\nちなみにSpracheという単語は「ことば」を意味するドイツ語で、ʃpʁaːxə（シュプラーヘ/シュプラーハ）と読みます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"パーサーとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパーサーとは？\u003c/h2\u003e\n\n\u003cp\u003e文字列を受け取って構文解析した結果を返すプログラムです。\u003cbr\u003e\nたとえば、\u003ccode\u003e1+x*3\u003c/code\u003e という５文字の文字列を受け取り、 \u003c/p\u003e\n\n\u003cp\u003eトップ... +\u003cbr\u003e\nトップ左... 定数1\u003cbr\u003e\nトップ右... *\u003cbr\u003e\nトップ右の*の左...変数x\u003cbr\u003e\nトップ右の*の右...定数3\u003c/p\u003e\n\n\u003cp\u003eといったような分析をします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"パーサーコンビネータとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%93%E3%83%8D%E3%83%BC%E3%82%BF%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパーサーコンビネータとは？\u003c/h2\u003e\n\n\u003cp\u003eパースすべき式の仕様が大きくなるにつれて、式全体をパースするパーサーを書くことは困難になっていきます。そこで、大きなパーサーを作る手法として、小さなパーサーを組み合わせて作るパーサーコンビネータという仕組みがあります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e例\u003c/h3\u003e\n\n\u003cp\u003e整数をパースするパーサーIntParserと、booleanをパースするパーサーBoolParserと、変数をパースするVarParserが書けているとします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eIntParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e...;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eBoolParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e...;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eVarParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e...;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eSpracheにおいて、パーサーの型は\u003ccode\u003eParser\u0026lt;T\u0026gt;\u003c/code\u003eです。\u003ccode\u003eParse\u0026lt;T\u0026gt;\u003c/code\u003e型のパーサーは、文字列を受け取ってそれをパースした結果のT型の値を返すParseメソッドを備えています。\u003cbr\u003e\n今、整数定数かbool定数か変数のいずれかが起こりうる式Primaryが定義されているとします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003ePrimary p ::= n | b | x\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003ePrimaryのパーサーはIntParser, BoolParser, VarParserを使って次のように書けます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ePrimaryParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eIntParser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBoolParser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVarParser\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eさらに、この Primaryを踏まえてexprが次の用に定義されているとします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eexpr e ::= if p then p else p \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのexprのパーサーは、先ほど定義したPrimaryParserを用いて次のように書けます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eIfParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003eifToken\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"if\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToken\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003ep1\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ePrimaryParser\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003ethenToken\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"then\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToken\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003ep2\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ePrimaryParser\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003eelseToken\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"else\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eToken\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003ep3\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ePrimaryParser\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eselect\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eIfExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep3\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのように、より小さい単位のパーサーを組み合わせてより大きい単位のパーサーを作れる仕組みがパーサーコンビネータです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ml言語風言語の実例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ml%E8%A8%80%E8%AA%9E%E9%A2%A8%E8%A8%80%E8%AA%9E%E3%81%AE%E5%AE%9F%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eML言語風言語の実例\u003c/h1\u003e\n\n\u003cp\u003e試しにSpracheを使って自作ML言語風トイ言語、\u003ca href=\"https://github.com/yuchiki/YuchiKaml\" rel=\"nofollow noopener\" target=\"_blank\"\u003eYuchiKaml\u003c/a\u003e のインタプリタを作ってみました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"どんな言語\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%82%93%E3%81%AA%E8%A8%80%E8%AA%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどんな言語？\u003c/h2\u003e\n\n\u003cp\u003eYuchiKamlの式は以下のBNFで定義します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1a9590b82833777ac103ad950952198627676815/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3231313634302f38396438633132322d353032362d643733392d383536302d3931343037333433353233652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F211640%2F89d8c122-5026-d739-8560-91407343523e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=434c97e9c543dc7ab16f1ae7ddd539d4\" alt=\"Screenshot from 2018-12-30 13-08-52.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/211640/89d8c122-5026-d739-8560-91407343523e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F211640%2F89d8c122-5026-d739-8560-91407343523e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=408945cf943408531c7fefe3a776c388 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e上の\u003ccode\u003ex\u003c/code\u003eは変数を、\u003ccode\u003en\u003c/code\u003eは整数を表します。文法の詳細はこの記事の本質ではないのでここでは詳しく語りませんが、気になる人のために\u003ca href=\"https://github.com/yuchiki/YuchiKaml_Document/blob/master/document.pdf\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eのpdfに文法の詳細を記しました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"cによる式の表現\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#c%E3%81%AB%E3%82%88%E3%82%8B%E5%BC%8F%E3%81%AE%E8%A1%A8%E7%8F%BE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eC#による式の表現\u003c/h2\u003e\n\n\u003cp\u003eYuchiKamlの式をC#でどう表現しましょう？\u003cbr\u003e\n式は式でも、その実はbool定数であったり、整数定数であったり、式+式、式-式の形であったり、 様々です。この色々な形をひっくるめて式として扱うために、継承を使います。\u003cbr\u003e\nまず、式全体を表す抽象クラスExprを定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExpr\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次に、それぞれの形をExprの子クラスとして定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCBool\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e//bool定数を表す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eCInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCInt\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e//整数定数を表す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eCInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAdd\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 式+式を表す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eLeft\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eRight\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLeft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRight\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSub\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 式-式を表す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eLeft\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eRight\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eSub\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLeft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRight\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e....\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれで様々な形を式として扱えるようになりました。\u003cbr\u003e\n式全体の定義は\u003ca href=\"https://github.com/yuchiki/YuchiKaml/blob/master/Syntax.cs\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eにあります。ソースコード中では、プリティプリントの関係や二項演算子の定義の共通化などの関係で、上に示した形と少し形が異なっています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"パーサーの定義\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%81%AE%E5%AE%9A%E7%BE%A9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパーサーの定義\u003c/h2\u003e\n\n\u003cp\u003eSpracheを使ってパーサーを作ります。SpracheのAPIと実装は\u003ca href=\"https://github.com/sprache/Sprache/blob/develop/src/Sprache/Parse.cs\" rel=\"nofollow noopener\" target=\"_blank\"\u003eここ\u003c/a\u003eから確認できます。\u003cbr\u003e\n整数定数をパースするパーサーを例に取ります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"整数定数のパーサー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%95%B4%E6%95%B0%E5%AE%9A%E6%95%B0%E3%81%AE%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e整数定数のパーサー\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eIntParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003edigits\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDigit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAtLeastOnce\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eToken\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eselect\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTryParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edigits\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまず、クエリ構文一行目の\u003ccode\u003ein\u003c/code\u003eの右側を解説します。\u003cbr\u003e\n上に出てくる\u003ccode\u003eParse.Digit\u003c/code\u003eは、0から9の数字一文字を得るパーサーです。\u003cbr\u003e\nその他の拡張メソッドは、引数のパーサーから別のパーサーを作るメソッドです。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e名前\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e引数のパーサー\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e戻り値のパーサー\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eAtLeastOnce\u0026lt;T\u0026gt;()\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eParser型\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e引数のパーサーを一回以上繰り返し適用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eText()\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e\n\u003ccode\u003eParser\u0026lt;IEnumerable\u0026lt;char\u0026gt;\u0026gt;\u003c/code\u003e型\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e結果の文字の列を結合\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eToken\u0026lt;T\u0026gt;()\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eParser型\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e前後の空白を無視\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eすなわち、上の例の\u003ccode\u003efrom\u003c/code\u003eの右側のパーサーは以下のようなパーサーになります。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003eパーサー\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e型\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003eパース結果\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eParse.Digit\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eParser\u0026lt;char\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e0から9の数字一文字\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eParse.Digit.AtLeastOnce()\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eParser\u0026lt;IEnumerable\u0026lt;char\u0026gt;\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e数字を表す文字型の値の列\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eParse.Digit.AtLeastOnce().Text()\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eParser\u0026lt;string\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e数字を表す文字列型の値\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eParse.Digit.AtLeastOnce().Text().Token()\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eParser\u0026lt;string\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e空白を読み飛ばした、数字を表す文字列型の値\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eクエリ構文\u003ccode\u003efrom t in P\u003c/code\u003eでは、tはパーサーPのパース結果を表しています。\u003cbr\u003e\nすなわち、以下のdigitsは数字列を表す文字列です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003edigits\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDigit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAtLeastOnce\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eToken\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこの次の行の\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eselect\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTryParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edigits\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eでは、\u003ccode\u003edigits\u003c/code\u003eを\u003ccode\u003eint\u003c/code\u003e型に変換し、 更に \u003ccode\u003enew CInt()\u003c/code\u003eで 整数定数を表す式に変換したものを\u003ccode\u003eselect\u003c/code\u003eしています。\u003cbr\u003e\nクエリ式全体では、\u003ccode\u003eCInt\u003c/code\u003e型の値を得るパーサー、\u003ccode\u003eParser\u0026lt;CInt\u0026gt;\u003c/code\u003eになっています。\u003cbr\u003e\n\u003ccode\u003eCInt\u003c/code\u003eは\u003ccode\u003eExpr\u003c/code\u003eの子クラスなので、\u003ccode\u003eParser\u0026lt;CInt\u0026gt;\u003c/code\u003e型の値は\u003ccode\u003eParser\u0026lt;Expr\u0026gt;\u003c/code\u003e型の変数 \u003ccode\u003eIntParser\u003c/code\u003eに格納できます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"カッコの中の式のパーサー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AB%E3%83%83%E3%82%B3%E3%81%AE%E4%B8%AD%E3%81%AE%E5%BC%8F%E3%81%AE%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eカッコの中の式のパーサー\u003c/h3\u003e\n\n\u003cp\u003e式全体をパースするパーサーMainParserを定義したとき、\u003cbr\u003e\n\u003ccode\u003e(e)\u003c/code\u003eを読むパーサーは次のように書けます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eparenParserInner\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003elParen\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eChar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sc\"\u003e'('\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eMainParser\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003erParen\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eChar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sc\"\u003e')'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eselect\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e開きカッコと閉じカッコを読まれはするものの無視され、単純に中身の式を結果とするパーサーになっています。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"二項演算子\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BA%8C%E9%A0%85%E6%BC%94%E7%AE%97%E5%AD%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e二項演算子\u003c/h3\u003e\n\n\u003cp\u003e補助関数BinOpParserを定義し、以下のようにパーサーを作成しました。\u003cbr\u003e\n\u003ccode\u003eExpr.Foo\u003c/code\u003eは引数を２つ受け取りFoo型の式を作る関数です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eBinaryOperatorsParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eBinOpParser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eUnaryParser\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[][]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"*\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMul\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDiv\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"+\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"-\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSub\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;=\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLeq\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLt\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026gt;=\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGeq\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"==\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEq\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"!=\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNeq\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026amp;\u0026amp;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAnd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"||\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"|\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eApp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026gt;\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAbs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"x\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eApp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eApp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"x\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)))))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e補助関数BinOpParserは\u003ca href=\"https://ja.wikipedia.org/wiki/%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%AE%E5%84%AA%E5%85%88%E9%A0%86%E4%BD%8D\" rel=\"nofollow noopener\" target=\"_blank\"\u003e演算子の優先順位\u003c/a\u003eに気を付けつつ、\u003ca href=\"https://ja.wikipedia.org/wiki/%E5%B7%A6%E5%86%8D%E5%B8%B0\" rel=\"nofollow noopener\" target=\"_blank\"\u003e左再帰除去\u003c/a\u003eをしつつ、二項演算子たちのパーサーをまとめて構築する関数です。\u003cbr\u003e\nまず、同一優先順位の演算子たちについて左再帰除去をしたパーサーを組み立てる補助関数BinOpParserを定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eBinOpParser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eelemParser\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eoperators\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003erestParser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoperators\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToken\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003eelem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eelemParser\u003c/span\u003e \u003cspan class=\"k\"\u003eselect\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003el\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eItem2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003el\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eelem\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAggregate\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003eelem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eelemParser\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003erest\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003erestParser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMany\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eselect\u003c/span\u003e \u003cspan class=\"n\"\u003erest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAggregate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelem\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eacc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eacc\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e上の補助関数BinOpParserをオーバーロードし、複数の優先順位の演算子に対応した補助関数BinOpParserを定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eBinOpParser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eParser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eExpr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eelemParser\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOperatorCreator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eoperators\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eoperators\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAggregate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelemParser\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBinOpParser\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれを用いて、左結合の二項演算子のパーサーをまとめて定義しています。\u003cbr\u003e\n補助関数を用いることによりボイラープレートを減らせています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コード例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコード例\u003c/h2\u003e\n\n\u003cp\u003e今回のパーサーに\u003ca href=\"https://github.com/yuchiki/YuchiKaml/blob/master/Syntax.cs\" rel=\"nofollow noopener\" target=\"_blank\"\u003eインタプリタ\u003c/a\u003e＋数個の\u003ca href=\"https://github.com/yuchiki/YuchiKaml/blob/master/BuiltIns.cs\" rel=\"nofollow noopener\" target=\"_blank\"\u003e組み込み関数\u003c/a\u003eを組み合わせ以下のようなコードが実行できるようになりました。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"gcd\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#gcd\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eGCD\u003c/h3\u003e\n\n\u003cp\u003egcdは２数の最大公約数を求める関数です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ocaml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"k\"\u003erec\u003c/span\u003e \u003cspan class=\"n\"\u003egcd\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\u003c/span\u003e \u003cspan class=\"n\"\u003egcd\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\u003c/span\u003e \u003cspan class=\"n\"\u003egcd\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e\n\u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003egcd\u003c/span\u003e \u003cspan class=\"mi\"\u003e120\u003c/span\u003e \u003cspan class=\"mi\"\u003e45\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"abc114-a問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#abc114-a%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eABC114 A問題\u003c/h3\u003e\n\n\u003cp\u003e競技プログラミングのコンテスト、\u003ca href=\"https://atcoder.jp/contests/abc114/tasks/abc114_a\" rel=\"nofollow noopener\" target=\"_blank\"\u003e第114回AtCoder Beginer's ContestのA問題\u003c/a\u003eの解答プログラムです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ocaml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"o\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003einclude\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eIO\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eread_num\u003c/span\u003e \u003cspan class=\"bp\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e\n\u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003eans\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"YES\"\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"NO\"\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e\n\u003cspan class=\"n\"\u003eprint_endline\u003c/span\u003e \u003cspan class=\"n\"\u003eans\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"abc114-b問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#abc114-b%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eABC114 B問題\u003c/h3\u003e\n\n\u003cp\u003e競技プログラミングのコンテスト、\u003ca href=\"https://atcoder.jp/contests/abc114/tasks/abc114_b\" rel=\"nofollow noopener\" target=\"_blank\"\u003e第114回AtCoder Beginer's ContestのB問題\u003c/a\u003eの解答プログラムです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ocaml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"o\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003einclude\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ebasic\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003einclude\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eIO\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003einclude\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003elist\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003einclude\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003emath\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eread_line\u003c/span\u003e \u003cspan class=\"bp\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003echars_of_string\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e\n\u003cspan class=\"n\"\u003emap\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eflip\u003c/span\u003e \u003cspan class=\"n\"\u003edrop\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etake\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003econcat_strings\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003enum_of_string\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erange\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e|\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003emap\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubt\u003c/span\u003e \u003cspan class=\"mi\"\u003e753\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eabs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e|\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003efold\u003c/span\u003e \u003cspan class=\"mi\"\u003e100000\u003c/span\u003e \u003cspan class=\"n\"\u003emin\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e|\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eprint_endline\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eSpracheは今回初めて使ったのですが、非常に直感的で使いやすかったです。\u003cbr\u003e\nみなさんもぜひ使ってみてください。\u003c/p\u003e\n\n\u003cp\u003e他にもSpracheの紹介をしている記事はいくつかありますので紹介いたします。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://qiita.com/ousttrue/items/0a970d1a1f13d98b686a\" id=\"reference-417a0510d8d97f60f85f\"\u003eC#のパーサコンビネータライブラリSpracheを使ってみる\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSpracheを使ったパーサー開発の流れがよくわかる記事です。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://qiita.com/ousttrue/items/1cd2fadc1af8bc5882e2\" id=\"reference-ac1bef38f8d485ee92db\"\u003eSpracheでコメントを飛ばしてパースしてみる\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eコメントの読み飛ばしもしてくれるToken関数を作成しています。\u003cbr\u003e\nSpracheには\u003ca href=\"https://github.com/sprache/Sprache/blob/develop/src/Sprache/CommentParser.cs\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCommentParser\u003c/a\u003eもあるので、この記事の手法と組み合わせればかなり楽にコメントを扱えそうです。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://qiita.com/fum1h1ro/items/98fae35ef475cba7462c\"\u003e例のキヨシチェックを Sprache で書いてみる\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eズン・ズン・ズン・ズン・ドコの並びを検知する遊びが流行った頃の記事のようです。\u003cbr\u003e\nズンとドコの並びをパーサーで検出する面白い記事です。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://qiita.com/myzktkyk/items/b702d31ee7fb5f9b69d4\" id=\"reference-6f5fb39d041ee92bf816\"\u003eSprache 使って Parser 書いたけどすごく戸惑ったって話\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそう！Spracheの公式サンプルって結構読むのが難しいんですよ！\u003cbr\u003e\nこちらの記事では公式サンプルにわかりやすいコメントを入れてくださっています。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eよろしかったら是非いいねを押してくださいませ！\u003c/p\u003e\n","createdAt":"2018-12-30T14:16:52Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"urELt1wFBMA6+vu7KVJfyDnzdZpPXWpP--p9q5oYYl2jBMJiJ+--Dbtj8LxF6X4KhRAgsij+8Q==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2018-12-30T14:55:20Z","likesCount":24,"linkUrl":"https://qiita.com/yuchiki1000yen/items/12a90e6fc728b900b376","organization":null,"originalId":753249,"stockedCount":15,"title":"C#のパーサコンビネータライブラリSpracheでML風言語のインタプリタを実装する","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#sprache-%E3%81%A8%E3%81%AF\"\u003eSprache とは\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%81%A8%E3%81%AF\"\u003eパーサーとは？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%93%E3%83%8D%E3%83%BC%E3%82%BF%E3%81%A8%E3%81%AF\"\u003eパーサーコンビネータとは？\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BE%8B\"\u003e例\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ml%E8%A8%80%E8%AA%9E%E9%A2%A8%E8%A8%80%E8%AA%9E%E3%81%AE%E5%AE%9F%E4%BE%8B\"\u003eML言語風言語の実例\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%82%93%E3%81%AA%E8%A8%80%E8%AA%9E\"\u003eどんな言語？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#c%E3%81%AB%E3%82%88%E3%82%8B%E5%BC%8F%E3%81%AE%E8%A1%A8%E7%8F%BE\"\u003eC#による式の表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC%E3%81%AE%E5%AE%9A%E7%BE%A9\"\u003eパーサーの定義\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%95%B4%E6%95%B0%E5%AE%9A%E6%95%B0%E3%81%AE%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC\"\u003e整数定数のパーサー\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AB%E3%83%83%E3%82%B3%E3%81%AE%E4%B8%AD%E3%81%AE%E5%BC%8F%E3%81%AE%E3%83%91%E3%83%BC%E3%82%B5%E3%83%BC\"\u003eカッコの中の式のパーサー\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BA%8C%E9%A0%85%E6%BC%94%E7%AE%97%E5%AD%90\"\u003e二項演算子\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E4%BE%8B\"\u003eコード例\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#gcd\"\u003eGCD\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#abc114-a%E5%95%8F%E9%A1%8C\"\u003eABC114 A問題\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#abc114-b%E5%95%8F%E9%A1%8C\"\u003eABC114 B問題\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":4866,"uuid":"12a90e6fc728b900b376","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"UzEBOTFBQWZTnT2y2l9wgqExg/xf--J+4FWU/3CyTjbk5F--EZ/zQZvcIaOtEjoobz4W4Q==","originalId":211640,"description":"はてなブログ： http://yuchiki1000yen.hatenablog.com/\r\n\r\nC#や型理論、形式検証に興味があります","facebookUrl":null,"githubUrl":"https://github.com/yuchiki","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"ゆーちき","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/211640/profile-images/1546179543","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F211640%2Fprofile-images%2F1546179543?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=a02693e362ee63492f000e904795a3e2","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F211640%2Fprofile-images%2F1546179543?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=beb404d862a1bf416d64865d7534f20d","urlName":"yuchiki1000yen","websiteUrl":"","twitterUrl":"https://twitter.com/yuchiki1000yen","twitterUrlName":"yuchiki1000yen","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"パーサーコンビネータ","urlName":"%e3%83%91%e3%83%bc%e3%82%b5%e3%83%bc%e3%82%b3%e3%83%b3%e3%83%93%e3%83%8d%e3%83%bc%e3%82%bf"},{"name":"Sprache","urlName":"sprache"},{"name":"パーサー","urlName":"%e3%83%91%e3%83%bc%e3%82%b5%e3%83%bc"},{"name":"自作","urlName":"%e8%87%aa%e4%bd%9c"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
