LeapMotionを手に入れたので、せっかくなのでTilt Brushのような空中に絵が描けるアプリケーションを作ってみようと思い立ちました。
こんな感じのものができました最近、オープンソースになりましたね。
それではさっそくやっていきましょう！まずは公式のチュートリアルを見たりググったりしてLeapMotionのセットアップを終わらせましょう。
セットアップが終わってもチュートリアル画面が一切出なかったのは私だけですか
次にこのページをもとにunityにCoreというアセットを導入します。
ここまで来たらとりあえずサンプルを実行してみましょう。
Assets&gt;Plugins&gt;LeapMotion&gt;Core&gt;Examplesにたくさんサンプルがあります。
正直それぞれのサンプル間の違いはよく分かりませんさてサンプルまで動かせたところで本題に入っていきます。すでに手のモデルが動かせる状態のCapsule Hands(Desktop)を改造していきます。
いきなりプログラムを書く前に空中に絵を描けるようになるまでに必要なステップを洗い出します。この2つが達成できればとりあえず目的は果たせそうです。こちらは簡単です。
人差し指の先をペンに見立てたいので、HandModels&gt;RigidRoundHand_R&gt;index&gt;bone3をそのままペン先の座標として取得してしまいます。
他の指をペン先にしたい場合はそっちの指のboneの座標を取得してください。問題はこちらです。線を描画するComponentとしてまず思いつくのはLine Rendererです。
ということでこれを使って2を実現していきます。
まずはLineRendereを生成するprefabを作ります。
空のゲームオブジェクトを生成して、Line Rendererを追加して名前をLineObjectとしてprefab化します。
次にこれをインスタンス化して絵を描くためのスクリプトを書きます。毎フレームインクが描画されてしまうと困るため、スペースキーを押している間だけインクが描画されるようにしています。
さてこのスクリプトを、右手の人差し指のbone3にアタッチして先ほど作ったLineObj
ectをアタッチします。
恐る恐る実行ボタンを押してみると、スペースキーを押している間、指先からインクが描画されてました。やったね！
とりあえず当初の目的は達成されました。
しかしインクの色がdefault materialなので地味な灰色にしかなりません。
次にインクの色を変えられるようにしてみましょう。インクの色を変えるために新しくChangeMaterialColorというスクリプトを作りLineObjectにアタッチします。
そして以下のようなコードを書きます。書き間違えた時に線を消せるような機能も入れています。
そして新しくマテリアルを作ってLineRendererのMaterialsと今さっき書いたスクリプトの両方にアタッチしています。
R,G,B成分を設定することによってペンを任意の色に変えることができます。
(本当はカラーピッカーを使って色を指定したかったんですがやり方がよくわからなかったので誰かわかる方がいらっしゃったら教えてください。)インクの色を変えられた後、カメラも動かせるようにしたんですが、あまりうまく制御できていないので割愛します。
実は掲載しているコードは実はフルスクラッチではなく、ネット上にあったoculusQuestとコントローラで空中に絵が描けるものの解説記事をLeapMotion仕様に書き換えて色々と手を加えたものなんですが、その参考にした記事が（おそらくGoogle君の検索アルゴリズムのせいで）見つかりませんでした。元記事様がなかったらこれは作れていませんでした。もしどの記事か心当たりがある方は教えてくれると助かります。
LeapMotionの記事の本数はリリース周辺と2018年前後を除いて記事の本数が少ないけど大丈夫なのかな。最近特にLeapMotion界隈が下火になっていそうな気がする質問コメント訂正お気軽にどうぞ。


