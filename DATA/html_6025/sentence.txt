More than 1 year has passed since last update.この記事は、クラス図に関連端名を付けようとしているけれど、いま一つ違和感のある人向けです。
よく目にする変な関連端名のパターンを紹介し、同様の間違いをしないような考えかたについて触れます。関連端名を付けようとして、なんてつければ良いか分からず、
「対象○○」と命名された関連端名を見かけることがよくあります。
上図が、その一例です。
これのどこがおかしいのでしょうか？そもそも、関連端名は「関連端の反対側のクラスから見たときの役割名のこと」です。
例えば、私はPCを2台持っていますが、一台は自分用で、もう一台は家族用です。
関連端名で書くと、こうなります。
コードのほうが分かりやすい人のためにコードにすると、こんな感じになります。クラス名「PC」と関連端名「自分用PC」を読み下すと、
「このPCは、自分用PCである」
と読めます。
コードの例でみても、
「自分用PCを電源ONする」というコードは、何をしたいのか分かりやすいです。それに対し、先ほどの図を読み下すと、
「この設定データは、対象データである」
となります。
何かおかしいですよね。初めに挙げたおかしな関連端名の例を、コードにすると、こんな感じになり、
function()の中だけを読んでも、何のことだか分かりづらくなります。おかしな関連端名の例のモデルを、自然になるように直してみると、
「このデータは、設定データである」
や
「この調整パラメータは、最新設定パラメータである」
「この調整パラメータは、前回設定パラメータである」
といったものでしょう。
図にすると、

や

です。仮に「この設定パラメータは、、、」の方をコードにしてみると、このような感じになり、読みやすくなります。この違いが、不具合の埋め込みやすさに影響することは、ごく自然なことではないでしょうか。先ほどの「設定データは、対象データである」がおかしいと気づきやすいポイントは、
実は「設定データ」が役割を示しているかも知れない、という点です。「この設定データは、対象データである」と読み下して、
おかしい！と感じたら、
「設定データ」というクラス名を、関連端名に移動して、
「この〇〇は、設定データである」
と読み下しし直してみましょう。
腑に落ちる”〇〇”が見つかり、
それで自然に読み下せる文になったら、
それをクラス名と関連端名として、クラス図を書いてみましょう。
スムーズに読み下せるようになれば、適切になった可能性があります。私自身と周囲の人の間違えから推測すると、「関連端名とは関連端の反対側のクラスから見たときの役割名のこと」
と教えられているので、
先に出してしまったクラスの名前を見ながら、「これってどんな役割なんだろう？」と自問自答してしまい、
結果として、やや無理やりな関連端名を思いついてしまうのかも知れません。つまり、
「「調整データ」という名前がモノの名前だと思い込んでしまい、役割の名前だと気づけなくなる」ことが、
あるのではないでしょうか。

この思い込みを防いだり、思い込みから抜け出す方法が、先ほどの「読み下し」です。
読み下した時の違和感を大事にし、違和感のない自然な言葉を見つけると良いと思います。では、類似のケースでクラス名と関連端名が同じケースについては、どう考えればよいのでしょうか？

たとえば、「担任」というクラスの役割（＝関連端名）は、「担任」と書いてみます。
前述の「対象データ」の例に比べると、それほど違和感を感じませんね。では、読み下してみましょう。
「この担任は、担任である」
......
やや、変ですね。モデルは、コミュニケーションをとるための言語ですから、
読み下しておかしければ、見直したほうがベターです。実は、モデルの文脈によっては、同一でも良いケースもあるのですが、
それは、また今度書きたいと思います。


