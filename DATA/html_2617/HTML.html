<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Javaで作った画面をWindowsで自動操作する方法 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/mima_ita/items/702fdbdee30346b5738e" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Eli2HyiFSwnB9QXPzpscyeSKvXnkTmbiIc/ac7UMnw1IkRI8ff70a8igiJUb1Q49irSzPAbyxl11mn1CNZkgew==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="Javaで作った画面をWindowsで自動操作する方法 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1TbUYyWWVPQnAtUzluT09Cby1PQm4tZVV1LW1kb3VPQ2tsZHBibVJ2ZDNQamdhZm9oNnJsaTVYbWs0M2t2WnpqZ1puamdvdm1scm5tczVVJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWZjNTYwZmVlMTBlYTkzZWFjOTIyMzE4N2U0NzIyMWRk&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFwYldGZmFYUmgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz04OTA4M2RmMzNmOWExYmQyY2FiZTYxOTAyYzkzYzIxNg&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=0e2241e56617237fac7fb09991e964eb"><meta property="og:description" content="

まえがき

たいていのWindowsの画面の自動操作は以下で紹介した方法で可能になっています。

RPA九人衆による「ｱｶﾈﾁｬﾝｶﾜｲｲﾔｯﾀ」の自動化
https://qiita.com/mima_ita/items/d465..."><meta content="https://qiita.com/mima_ita/items/702fdbdee30346b5738e" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="Java,C#,PowerShell,自動化,UiPath" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-8aae6642-2c47-4f0a-b9fc-eac6aba8f3ad"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fmima_ita%2Fitems%2F702fdbdee30346b5738e">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fmima_ita%2Fitems%2F702fdbdee30346b5738e">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-8aae6642-2c47-4f0a-b9fc-eac6aba8f3ad">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/java","name":"Java"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-10-16T01:10:29.000+09:00","dateModified":"2019-10-16T10:17:50.000+09:00","headline":"Javaで作った画面をWindowsで自動操作する方法","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1TbUYyWWVPQnAtUzluT09Cby1PQm4tZVV1LW1kb3VPQ2tsZHBibVJ2ZDNQamdhZm9oNnJsaTVYbWs0M2t2WnpqZ1puamdvdm1scm5tczVVJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWZjNTYwZmVlMTBlYTkzZWFjOTIyMzE4N2U0NzIyMWRk\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFwYldGZmFYUmgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz04OTA4M2RmMzNmOWExYmQyY2FiZTYxOTAyYzkzYzIxNg\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=0e2241e56617237fac7fb09991e964eb","mainEntityOfPage":"https://qiita.com/mima_ita/items/702fdbdee30346b5738e","author":{"@type":"Person","address":"","email":null,"identifier":"mima_ita","name":"mima_ita","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F47856%2F0bc42d42eada368803d4098295f823130ecc5364%2Flarge.png%3F1571128517?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=aaca39e8c7ebef06bbfb64132a188a53","url":"https://qiita.com/mima_ita","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mima_ita","type":"items","id":"702fdbdee30346b5738e"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mima_ita","type":"items","id":"702fdbdee30346b5738e"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mima_ita","type":"items","id":"702fdbdee30346b5738e"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/mima_ita/items/702fdbdee30346b5738e","location":"/mima_ita/items/702fdbdee30346b5738e","scheme":"https","host":"qiita.com","port":null,"pathname":"/mima_ita/items/702fdbdee30346b5738e","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"5VyUW3JGdkr9QCZ88x0vZ6PYxFEYI05x/VLrLIKe4T6/lTB4Jz3JKPQVqyYmUz2TzebKFPqf7s6pB0wdAgteSA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-1b31f3ce-0195-4805-9224-14ab50713422"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mima_ita/items/702fdbdee30346b5738e/likers" class="css-1iupg5d">15</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">18</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/702fdbdee30346b5738e/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mima_ita/items/702fdbdee30346b5738e/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mima_ita/items/702fdbdee30346b5738e/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mima_ita/items/702fdbdee30346b5738e/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mima_ita/items/702fdbdee30346b5738e.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/mima_ita"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/47856/0bc42d42eada368803d4098295f823130ecc5364/large.png?1571128517" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/mima_ita" class="css-10ougpm">@<!-- -->mima_ita</a><div class="css-1ay9vb9"><span><meta content="2019-10-15T16:10:29Z"/><time dateTime="2019-10-16T01:17:50Z" class="css-m19uds">updated at 2019-10-16</time></span></div></div></div></div></div><h1 class="css-cgzq40">Javaで作った画面をWindowsで自動操作する方法</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/java" class="css-4czcte">Java</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/powershell" class="css-4czcte">PowerShell</a><a href="/tags/%e8%87%aa%e5%8b%95%e5%8c%96" class="css-4czcte">自動化</a><a href="/tags/uipath" class="css-4czcte">UiPath</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="まえがき" class="fragment"></span><a href="#%E3%81%BE%E3%81%88%E3%81%8C%E3%81%8D"><i class="fa fa-link"></i></a>まえがき</h1>

<p>たいていのWindowsの画面の自動操作は以下で紹介した方法で可能になっています。</p>

<p><strong>RPA九人衆による「ｱｶﾈﾁｬﾝｶﾜｲｲﾔｯﾀ」の自動化</strong><br>
<a href="https://qiita.com/mima_ita/items/d4655de865f30bb51c65" class="autolink" id="reference-b4e51e0a60c3c2944a99">https://qiita.com/mima_ita/items/d4655de865f30bb51c65</a></p>

<p>実は厄介なケースがあって、それはJavaで画面を作っているケースです。<br>
今回はJavaで作られた画面を例に自動操作が可能かどうか検討してみましょう。</p>

<p><strong>実験環境</strong><br>
Windows10 Home<br>
Java 8<br>
Visual Studio 2019<br>
PowerShell 5.1<br>
UiPath 2019.10.0-beta 111</p>

<h1>
<span id="javaの画面の作成方法" class="fragment"></span><a href="#java%E3%81%AE%E7%94%BB%E9%9D%A2%E3%81%AE%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>Javaの画面の作成方法</h1>

<p>Javaで画面を作成する主な方法としてSwingを使用する場合と、JavaFxを使用する場合があります。</p>

<h2>
<span id="swingで作成した画面" class="fragment"></span><a href="#swing%E3%81%A7%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2"><i class="fa fa-link"></i></a>Swingで作成した画面</h2>

<p>下記のページを参考に簡単なSwingの画面を作成します。</p>

<ul>
<li><a href="https://www.atmarkit.co.jp/ait/articles/0605/31/news125.html" rel="nofollow noopener" target="_blank">SwingのキホンJFrameを使う</a></li>
</ul>

<p><a href="https://camo.qiitausercontent.com/325697cb46128dc525997d90814a285c9249ee74/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f64316334653833652d366465622d373435332d313562642d3039623065613930323031652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd1c4e83e-6deb-7453-15bd-09b0ea90201e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e882f65a52a421336be0af7fc62c86cc" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/d1c4e83e-6deb-7453-15bd-09b0ea90201e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd1c4e83e-6deb-7453-15bd-09b0ea90201e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bfbcee4939daa74d22a77ec31a7c9a73 1x" loading="lazy"></a></p>

<div class="code-frame" data-lang="java">
<div class="code-lang"><span class="bold">ToDoListPane.java</span></div>
<div class="highlight"><pre class="with-code"><code><span class="kn">package</span> <span class="nn">SwingSample</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.BorderLayout</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.event.ActionEvent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.event.ActionListener</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.swing.DefaultListModel</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JButton</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JPanel</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JScrollPane</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JTextField</span><span class="o">;</span>
<span class="cm">/**
* ToDoリスト
* 以下参考
* https://www.atmarkit.co.jp/ait/articles/0609/23/news027.html
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToDoListPane</span> <span class="kd">extends</span> <span class="nc">JPanel</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">JList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">toDoList</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">DefaultListModel</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">toDoListModel</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">JTextField</span> <span class="n">toDoInputField</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">JButton</span> <span class="n">addButton</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">ToDoListPane</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">(</span><span class="k">new</span> <span class="nc">BorderLayout</span><span class="o">());</span>
                <span class="c1">// 一覧を生成</span>
                <span class="n">toDoListModel</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DefaultListModel</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
                <span class="n">toDoList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span><span class="n">toDoListModel</span><span class="o">);</span>
                <span class="nc">JScrollPane</span> <span class="n">listScrollPane</span> <span class="o">=</span> <span class="k">new</span>   <span class="nc">JScrollPane</span><span class="o">(</span><span class="n">toDoList</span><span class="o">);</span>
                <span class="c1">// ToDo追加用テキストフィールドの生成</span>
                <span class="n">toDoInputField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JTextField</span><span class="o">();</span>
                <span class="c1">// 各ボタンの生成</span>
                <span class="nc">JPanel</span> <span class="n">buttonPanel</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPanel</span><span class="o">();</span>
                <span class="n">addButton</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JButton</span><span class="o">(</span><span class="s">"追加"</span><span class="o">);</span>
                <span class="c1">// ボタンにリスナを設定</span>
                <span class="n">addButton</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">new</span>    <span class="nc">AddActionHandler</span><span class="o">());</span>
                <span class="n">buttonPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">addButton</span><span class="o">);</span>
                <span class="n">add</span><span class="o">(</span><span class="n">listScrollPane</span><span class="o">,</span> <span class="nc">BorderLayout</span><span class="o">.</span><span class="na">NORTH</span><span class="o">);</span>
                <span class="n">add</span><span class="o">(</span><span class="n">toDoInputField</span><span class="o">,</span> <span class="nc">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
                <span class="n">add</span><span class="o">(</span><span class="n">buttonPanel</span><span class="o">,</span> <span class="nc">BorderLayout</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="cm">/**
        * 追加ボタンアクションのハンドラ
        */</span>
        <span class="kd">private</span> <span class="kd">class</span> <span class="nc">AddActionHandler</span> <span class="kd">implements</span> <span class="nc">ActionListener</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="nc">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="c1">// テキストフィールドの内容をリストモデルに追加</span>
                        <span class="n">toDoListModel</span><span class="o">.</span><span class="na">addElement</span>
                        <span class="o">(</span><span class="n">toDoInputField</span><span class="o">.</span><span class="na">getText</span><span class="o">());</span>
                <span class="o">}</span>
        <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
</div>

<p>すべてのコードは以下にあります。<br>
<a href="https://github.com/mima3/testjavagui/tree/master/java/Swing001" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/mima3/testjavagui/tree/master/java/Swing001</a></p>

<h2>
<span id="javafxで作成した画面" class="fragment"></span><a href="#javafx%E3%81%A7%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2"><i class="fa fa-link"></i></a>JavaFxで作成した画面</h2>

<p>JavaFxでも単純な画面を作成します。<br>
<a href="https://camo.qiitausercontent.com/7aea5952c8675f0d90505c5080900b70542ab95f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f32396262643263642d356534622d393230362d633832352d3364333564613063376431642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F29bbd2cd-5e4b-9206-c825-3d35da0c7d1d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d2a4a9bfd3586eb04c3f4699ae0d7733" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/29bbd2cd-5e4b-9206-c825-3d35da0c7d1d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F29bbd2cd-5e4b-9206-c825-3d35da0c7d1d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8ff77694192734bd9dde5e5d4e65f5b3 1x" loading="lazy"></a></p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">Main.fxml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>

<span class="cp">&lt;?import java.lang.*?&gt;</span>
<span class="cp">&lt;?import javafx.scene.control.*?&gt;</span>
<span class="cp">&lt;?import javafx.scene.layout.*?&gt;</span>
<span class="cp">&lt;?import javafx.scene.layout.AnchorPane?&gt;</span>

<span class="nt">&lt;AnchorPane</span> <span class="na">xmlns:fx=</span><span class="s">"http://javafx.com/fxml/1"</span> <span class="na">xmlns=</span><span class="s">"http://javafx.com/javafx/2.2"</span> <span class="na">fx:controller=</span><span class="s">"ctrl.Controller"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- TODO Add Nodes --&gt;</span>
  <span class="nt">&lt;children&gt;</span>
    <span class="nt">&lt;Pane</span> <span class="na">layoutX=</span><span class="s">"0.0"</span> <span class="na">layoutY=</span><span class="s">"-14.0"</span> <span class="na">prefHeight=</span><span class="s">"297.0"</span> <span class="na">prefWidth=</span><span class="s">"345.0"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;children&gt;</span>
        <span class="nt">&lt;Label</span> <span class="na">layoutX=</span><span class="s">"14.0"</span> <span class="na">layoutY=</span><span class="s">"14.0"</span> <span class="na">text=</span><span class="s">"リスト"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;ListView</span> <span class="na">id=</span><span class="s">""</span> <span class="na">fx:id=</span><span class="s">"list"</span> <span class="na">layoutX=</span><span class="s">"14.0"</span> <span class="na">layoutY=</span><span class="s">"30.0"</span> <span class="na">prefHeight=</span><span class="s">"198.0"</span> <span class="na">prefWidth=</span><span class="s">"317.0"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Button</span> <span class="na">id=</span><span class="s">""</span> <span class="na">fx:id=</span><span class="s">"btnAdd"</span> <span class="na">layoutX=</span><span class="s">"14.0"</span> <span class="na">layoutY=</span><span class="s">"262.0"</span> <span class="na">mnemonicParsing=</span><span class="s">"false"</span> <span class="na">onAction=</span><span class="s">"#onAddButtonClicked"</span> <span class="na">text=</span><span class="s">"追加"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;TextField</span> <span class="na">id=</span><span class="s">""</span> <span class="na">fx:id=</span><span class="s">"textBox"</span> <span class="na">layoutX=</span><span class="s">"14.0"</span> <span class="na">layoutY=</span><span class="s">"228.0"</span> <span class="na">prefHeight=</span><span class="s">"15.9609375"</span> <span class="na">prefWidth=</span><span class="s">"317.0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/children&gt;</span>
    <span class="nt">&lt;/Pane&gt;</span>
  <span class="nt">&lt;/children&gt;</span>
<span class="nt">&lt;/AnchorPane&gt;</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="java">
<div class="code-lang"><span class="bold">Controler.java</span></div>
<div class="highlight"><pre class="with-code"><code><span class="kn">package</span> <span class="nn">ctrl</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ResourceBundle</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javafx.event.ActionEvent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.fxml.FXML</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.fxml.Initializable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.Button</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.ListView</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.TextField</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Controller</span> <span class="kd">implements</span> <span class="nc">Initializable</span> <span class="o">{</span>
    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="nc">TextField</span> <span class="n">textBox</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">btnAdd</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="nc">ListView</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="no">URL</span> <span class="n">location</span><span class="o">,</span> <span class="nc">ResourceBundle</span> <span class="n">resources</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// TODO 自動生成されたメソッド・スタブ</span>
        <span class="n">textBox</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">"値を入力してください。"</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="nd">@FXML</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onAddButtonClicked</span><span class="o">(</span><span class="nc">ActionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// テキストボックスに文字列をセットする</span>
        <span class="n">list</span><span class="o">.</span><span class="na">getItems</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">textBox</span><span class="o">.</span><span class="na">getText</span><span class="o">());</span>
        <span class="n">textBox</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
</div>

<p>すべてのコードは以下にあります。<br>
<a href="https://github.com/mima3/testjavagui/tree/master/java/Java8Fx001" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/mima3/testjavagui/tree/master/java/Java8Fx001</a></p>

<h3>
<span id="java11でjavafxの画面を作る場合の注意" class="fragment"></span><a href="#java11%E3%81%A7javafx%E3%81%AE%E7%94%BB%E9%9D%A2%E3%82%92%E4%BD%9C%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AE%E6%B3%A8%E6%84%8F"><i class="fa fa-link"></i></a>Java11でJavaFxの画面を作る場合の注意</h3>

<p>JavaFXはJDK 11以降、Oracle JDKから分離されます。そのためJavaFxの画面を作る場合、以下のような手順が必要になります。</p>

<p>(1)JavaFXをダウンロードする。<br>
<a href="https://gluonhq.com/products/javafx/" class="autolink" rel="nofollow noopener" target="_blank">https://gluonhq.com/products/javafx/</a></p>

<p>(2)ダウンロードしたフォルダ中のlibの中のjarをプロジェクトの参照ライブラリに追加する。<br>
<a href="https://camo.qiitausercontent.com/cf9f7839dfcbe0a146b05760d9d62a2c993a95d9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f30633665323562382d383832362d616262352d303934332d3936336561313438643764302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F0c6e25b8-8826-abb5-0943-963ea148d7d0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=43da4c17593009f7829d1a50b546a373" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/0c6e25b8-8826-abb5-0943-963ea148d7d0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F0c6e25b8-8826-abb5-0943-963ea148d7d0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=642dc6d2f638199f73a3f5ecb6e69c21 1x" loading="lazy"></a></p>

<p>(3)実行時<br>
<strong>コマンドラインから実行する場合</strong></p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C:\pleiades201904\java\11\bin\java --module-path=C:\tool\lib\javafx-sdk-11.0.2\lib\ --add-modules=javafx.controls --add-modules=javafx.swing --add-modules=javafx.base --add-modules=javafx.fxml --add-modules=javafx.media --add-modules=javafx.web -jar Java11Fx.jar
</code></pre></div></div>

<p><strong>Eclipseで実行する場合の実行構成</strong><br>
<a href="https://camo.qiitausercontent.com/c8284f44f40cf4701a8d51dff3d780c22cce273f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f64373961303633352d353634382d613736612d393432302d3466313132396462633363362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd79a0635-5648-a76a-9420-4f1129dbc3c6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=86846fe2dc8207e96139deaff176a473" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/d79a0635-5648-a76a-9420-4f1129dbc3c6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd79a0635-5648-a76a-9420-4f1129dbc3c6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=80afa8a4debe7041f3de5995a8dc75c8 1x" loading="lazy"></a></p>

<h1>
<span id="uiautomationの自動操作" class="fragment"></span><a href="#uiautomation%E3%81%AE%E8%87%AA%E5%8B%95%E6%93%8D%E4%BD%9C"><i class="fa fa-link"></i></a>UIAutomationの自動操作</h1>

<p>作成したJavaの画面を<a href="https://docs.microsoft.com/en-us/windows/win32/winauto/inspect-objects" rel="nofollow noopener" target="_blank">inspect.exe</a>を使用してUIAutomation経由で操作できるかを確認します。</p>

<h2>
<span id="swingの場合" class="fragment"></span><a href="#swing%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>Swingの場合：</h2>

<p><a href="https://camo.qiitausercontent.com/4eb4483cfc023879cac8762eecb55df1c82683d5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f37636535333435342d386664632d306364302d393237662d3264333438623432353231392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F7ce53454-8fdc-0cd0-927f-2d348b425219.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2fa0b5c567812b1bcb272d7e1e782b10" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/7ce53454-8fdc-0cd0-927f-2d348b425219.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F7ce53454-8fdc-0cd0-927f-2d348b425219.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b7e849baa2c73c9d52dc806d27291980 1x" loading="lazy"></a></p>

<p>UIAutomationでコントロールの情報が取得されていないことが確認できます。つまり<strong>Swingで作成したアプリケーションはUIAutomation経由で操作が不可能です</strong>。</p>

<h2>
<span id="javafxの場合" class="fragment"></span><a href="#javafx%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>JavaFxの場合：</h2>

<p><a href="https://camo.qiitausercontent.com/353ff2fc4e010dbac38795db380e4b616375b54f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f61666130646564302d326564392d313561382d616336632d3262306339653633316333342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fafa0ded0-2ed9-15a8-ac6c-2b0c9e631c34.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0b572823086683e20728aff8c98e1538" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/afa0ded0-2ed9-15a8-ac6c-2b0c9e631c34.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fafa0ded0-2ed9-15a8-ac6c-2b0c9e631c34.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3ad6bf38a78885e7d99eb98625a0bb98 1x" loading="lazy"></a></p>

<p>UIAutomationの要素が取得されており、ControlTypeも適切に設定されていることが確認できます。<br>
実際にPowerShellを使用して自動操作をしてみましょう。</p>

<div class="code-frame" data-lang="powershell"><div class="highlight"><pre class="with-code"><code><span class="n">Add-Type</span><span class="w"> </span><span class="nt">-AssemblyName</span><span class="w"> </span><span class="nx">UIAutomationClient</span><span class="w">
</span><span class="n">Add-Type</span><span class="w"> </span><span class="nt">-AssemblyName</span><span class="w"> </span><span class="nx">UIAutomationTypes</span><span class="w">
</span><span class="n">Add-type</span><span class="w"> </span><span class="nt">-AssemblyName</span><span class="w"> </span><span class="nx">System.Windows.Forms</span><span class="w">

</span><span class="nv">$source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sh">@"
using System;
using System.Windows.Automation;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using System.Drawing;

public class AutomationHelper
{
    // https://culage.hatenablog.com/entry/20130611/1370876400
    [DllImport("user32.dll")]
    extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);

    [StructLayout(LayoutKind.Sequential)]
    struct INPUT
    {
        public int type;
        public MOUSEINPUT mi;
    }

    [StructLayout(LayoutKind.Sequential)]
    struct MOUSEINPUT
    {
        public int dx;
        public int dy;
        public int mouseData;
        public int dwFlags;
        public int time;
        public IntPtr dwExtraInfo;
    }

    const int MOUSEEVENTF_LEFTDOWN = 0x0002;
    const int MOUSEEVENTF_LEFTUP = 0x0004;
    static public void Click()
    {
        //struct 配列の宣言
        INPUT[] input = new INPUT[2];
        //左ボタン Down
        input[0].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;
        //左ボタン Up
        input[1].mi.dwFlags = MOUSEEVENTF_LEFTUP;
        //イベントの一括生成
        SendInput(2, input, Marshal.SizeOf(input[0]));
    }
    static public void MouseMove(int x, int y)
    {
        var pt = new System.Drawing.Point(x, y);
        System.Windows.Forms.Cursor.Position = pt;
    }
    static public void SendKeys(string key) 
    {
        System.Windows.Forms.SendKeys.SendWait(key);
    }
    public static AutomationElement RootElement
    {
        get
        {
            return AutomationElement.RootElement;
        }
    }

    public static AutomationElement GetMainWindowByTitle(string title) {
        PropertyCondition cond = new PropertyCondition(AutomationElement.NameProperty, title);
        return RootElement.FindFirst(TreeScope.Children, cond);
    }

    public static AutomationElement ChildWindowByTitle(AutomationElement parent , string title) {
        try {
            PropertyCondition cond = new PropertyCondition(AutomationElement.NameProperty, title);
            return parent.FindFirst(TreeScope.Children, cond);
        } catch {
            return null;
        }
    }

    public static AutomationElement WaitChildWindowByTitle(AutomationElement parent, string title, int timeout = 10) {
        DateTime start = DateTime.Now;
        while (true) {
            AutomationElement ret = ChildWindowByTitle(parent, title);
            if (ret != null) {
                return ret;
            }
            TimeSpan ts = DateTime.Now - start;
            if (ts.TotalSeconds &gt; timeout) {
               return null;
            }
            System.Threading.Thread.Sleep(100);
        }
    }
}
"@</span><span class="w">
</span><span class="n">Add-Type</span><span class="w"> </span><span class="nt">-TypeDefinition</span><span class="w"> </span><span class="nv">$source</span><span class="w"> </span><span class="nt">-ReferencedAssemblies</span><span class="p">(</span><span class="s2">"UIAutomationClient"</span><span class="p">,</span><span class="w"> </span><span class="s2">"UIAutomationTypes"</span><span class="p">,</span><span class="w"> </span><span class="s2">"System.Windows.Forms"</span><span class="p">,</span><span class="w">  </span><span class="s2">"System.Drawing"</span><span class="p">)</span><span class="w">

</span><span class="c"># 5.0以降ならusingで記載した方が楽。</span><span class="w">
</span><span class="nv">$autoElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.AutomationElement</span><span class="p">]</span><span class="w">

</span><span class="c"># ウィンドウ以下で指定の条件に当てはまるコントロールを全て列挙</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">findAllElements</span><span class="p">(</span><span class="nv">$form</span><span class="p">,</span><span class="w"> </span><span class="nv">$condProp</span><span class="p">,</span><span class="w"> </span><span class="nv">$condValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$cond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-TypeName</span><span class="w"> </span><span class="nx">System.Windows.Automation.PropertyCondition</span><span class="p">(</span><span class="nv">$condProp</span><span class="p">,</span><span class="w"> </span><span class="nv">$condValue</span><span class="p">)</span><span class="w">
    </span><span class="kr">return</span><span class="w"> </span><span class="nv">$form</span><span class="o">.</span><span class="nf">FindAll</span><span class="p">([</span><span class="n">System.Windows.Automation.TreeScope</span><span class="p">]::</span><span class="nx">Element</span><span class="w"> </span><span class="o">-bor</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.TreeScope</span><span class="p">]::</span><span class="nx">Descendants</span><span class="p">,</span><span class="w"> </span><span class="nv">$cond</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># ウィンドウ以下で指定の条件に当てはまるコントロールを１つ取得</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">findFirstElement</span><span class="p">(</span><span class="nv">$form</span><span class="p">,</span><span class="w"> </span><span class="nv">$condProp</span><span class="p">,</span><span class="w"> </span><span class="nv">$condValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$cond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-TypeName</span><span class="w"> </span><span class="nx">System.Windows.Automation.PropertyCondition</span><span class="p">(</span><span class="nv">$condProp</span><span class="p">,</span><span class="w"> </span><span class="nv">$condValue</span><span class="p">)</span><span class="w">
    </span><span class="kr">return</span><span class="w"> </span><span class="nv">$form</span><span class="o">.</span><span class="nf">FindFirst</span><span class="p">([</span><span class="n">System.Windows.Automation.TreeScope</span><span class="p">]::</span><span class="nx">Element</span><span class="w"> </span><span class="o">-bor</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.TreeScope</span><span class="p">]::</span><span class="nx">Descendants</span><span class="p">,</span><span class="w"> </span><span class="nv">$cond</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># 要素をValuePatternに変換</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">convertValuePattern</span><span class="p">(</span><span class="nv">$elem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">return</span><span class="w"> </span><span class="nv">$elem</span><span class="o">.</span><span class="nf">GetCurrentPattern</span><span class="p">([</span><span class="n">System.Windows.Automation.ValuePattern</span><span class="p">]::</span><span class="nx">Pattern</span><span class="p">)</span><span class="w"> </span><span class="o">-as</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.ValuePattern</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">convertSelectionItemPattern</span><span class="p">(</span><span class="nv">$elem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">return</span><span class="w"> </span><span class="nv">$elem</span><span class="o">.</span><span class="nf">GetCurrentPattern</span><span class="p">([</span><span class="n">System.Windows.Automation.SelectionItemPattern</span><span class="p">]::</span><span class="nx">Pattern</span><span class="p">)</span><span class="w"> </span><span class="o">-as</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.SelectionItemPattern</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># 要素にテキストを入力</span><span class="w">
</span><span class="c"># Java8だとtxtValuePtn.SetValueが正常に動作しないための代替</span><span class="w">
</span><span class="kr">function</span><span class="w"> </span><span class="nf">sendTextValue</span><span class="p">(</span><span class="nv">$textCtrl</span><span class="p">,</span><span class="w"> </span><span class="nv">$message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">[</span><span class="n">AutomationHelper</span><span class="p">]::</span><span class="n">MouseMove</span><span class="p">(</span><span class="nv">$textCtrl</span><span class="o">.</span><span class="nf">Current</span><span class="o">.</span><span class="nf">BoundingRectangle</span><span class="o">.</span><span class="nf">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nv">$textCtrl</span><span class="o">.</span><span class="nf">Current</span><span class="o">.</span><span class="nf">BoundingRectangle</span><span class="o">.</span><span class="nf">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">
    </span><span class="p">[</span><span class="n">AutomationHelper</span><span class="p">]::</span><span class="n">Click</span><span class="p">()</span><span class="w">
    </span><span class="p">[</span><span class="n">AutomationHelper</span><span class="p">]::</span><span class="n">SendKeys</span><span class="p">(</span><span class="s2">"^(a)"</span><span class="p">)</span><span class="w">
    </span><span class="p">[</span><span class="n">AutomationHelper</span><span class="p">]::</span><span class="n">SendKeys</span><span class="p">(</span><span class="s2">"{DEL}"</span><span class="p">)</span><span class="w">
    </span><span class="p">[</span><span class="n">AutomationHelper</span><span class="p">]::</span><span class="n">SendKeys</span><span class="p">(</span><span class="nv">$message</span><span class="p">)</span><span class="w">
    </span><span class="n">Start-Sleep</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># メイン処理</span><span class="w">
</span><span class="nv">$mainForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">AutomationHelper</span><span class="p">]::</span><span class="n">GetMainWindowByTitle</span><span class="p">(</span><span class="s2">"TODOリスト"</span><span class="p">)</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$mainForm</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="bp">$null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Error</span><span class="w"> </span><span class="s2">"Java Fxの画面を起動してください"</span><span class="w">
    </span><span class="kr">exit</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="nv">$mainForm</span><span class="o">.</span><span class="nf">SetFocus</span><span class="p">()</span><span class="w">
</span><span class="nv">$editType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.ControlType</span><span class="p">]::</span><span class="n">Edit</span><span class="w">
</span><span class="nv">$textCtrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findFirstElement</span><span class="w"> </span><span class="nv">$mainForm</span><span class="w"> </span><span class="nv">$autoElem</span><span class="p">::</span><span class="nx">ControlTypeProperty</span><span class="w"> </span><span class="nv">$editType</span><span class="w">

</span><span class="c"># Java8の場合ValuePatternのSetValueでエラーとなる</span><span class="w">
</span><span class="c">#$txtValuePtn = convertValuePattern $textCtrl</span><span class="w">
</span><span class="c">#$txtGetValue = $txtValuePtn.Current.Value</span><span class="w">
</span><span class="c">#Write-Host "変更前：$txtGetValue"</span><span class="w">
</span><span class="c">#$txtValuePtn.SetValue("わふる");</span><span class="w">

</span><span class="n">sendTextValue</span><span class="w"> </span><span class="nv">$textCtrl</span><span class="w"> </span><span class="s2">"わっふる"</span><span class="w">

</span><span class="nv">$btnCtrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findFirstElement</span><span class="w"> </span><span class="nv">$mainForm</span><span class="w"> </span><span class="nv">$autoElem</span><span class="p">::</span><span class="nx">NameProperty</span><span class="w"> </span><span class="s2">"追加"</span><span class="w">
</span><span class="nv">$btnInvoke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$btnCtrl</span><span class="o">.</span><span class="nf">GetCurrentPattern</span><span class="p">([</span><span class="n">System.Windows.Automation.InvokePattern</span><span class="p">]::</span><span class="nx">Pattern</span><span class="p">)</span><span class="w"> </span><span class="o">-as</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.InvokePattern</span><span class="p">]</span><span class="w">
</span><span class="nv">$btnInvoke</span><span class="o">.</span><span class="nf">Invoke</span><span class="p">()</span><span class="w">

</span><span class="c"># 2文字目</span><span class="w">
</span><span class="n">sendTextValue</span><span class="w"> </span><span class="nv">$textCtrl</span><span class="w"> </span><span class="s2">"猫"</span><span class="w">
</span><span class="nv">$btnInvoke</span><span class="o">.</span><span class="nf">Invoke</span><span class="p">()</span><span class="w">

</span><span class="c"># 3文字目</span><span class="w">
</span><span class="n">sendTextValue</span><span class="w"> </span><span class="nv">$textCtrl</span><span class="w"> </span><span class="s2">"犬"</span><span class="w">
</span><span class="nv">$btnInvoke</span><span class="o">.</span><span class="nf">Invoke</span><span class="p">()</span><span class="w">

</span><span class="c"># リスト選択</span><span class="w">
</span><span class="nv">$listitemType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Automation.ControlType</span><span class="p">]::</span><span class="n">ListItem</span><span class="w">
</span><span class="nv">$listitems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findAllElements</span><span class="w"> </span><span class="nv">$mainForm</span><span class="w"> </span><span class="nv">$autoElem</span><span class="p">::</span><span class="nx">ControlTypeProperty</span><span class="w"> </span><span class="nv">$listitemType</span><span class="w">
</span><span class="nv">$listPtn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertSelectionItemPattern</span><span class="w"> </span><span class="nv">$listitems</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">
</span><span class="nv">$listPtn</span><span class="o">.</span><span class="nf">Select</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><strong>実行結果</strong><br>
<a href="https://camo.qiitausercontent.com/e027a593a567271fb382e99171f804c3b2a76f63/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f61653038666566312d383365362d613632652d333333322d3831653037346638323235312e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fae08fef1-83e6-a62e-3332-81e074f82251.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5f24d2b24f7933f3520dd47ba5092cde" alt="auto4.gif" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/ae08fef1-83e6-a62e-3332-81e074f82251.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fae08fef1-83e6-a62e-3332-81e074f82251.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1afbd196a7c1bebe61f41ff05257e5a7 1x" loading="lazy"></a></p>

<p>これを実行するとJava11のJavaFxを使用した画面は正常に完了しますが、Java8のJavaFxを使用した画面は下記のエラーを出力します。</p>

<h3>
<span id="javafxをuiautomationでの操作時のエラー" class="fragment"></span><a href="#javafx%E3%82%92uiautomation%E3%81%A7%E3%81%AE%E6%93%8D%E4%BD%9C%E6%99%82%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC"><i class="fa fa-link"></i></a>JavaFxをUIAutomationでの操作時のエラー</h3>

<p>Java8で作成したJavaFxに対してUiAutomationのValuePatternで値を設定すると下記のエラーが出ます。</p>

<p><strong>PowerShell側</strong></p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>"1" 個の引数を指定して "SetValue" を呼び出し中に例外が発生しました: ""
発生場所 C:\dev\testjavagui\out\javafx_auto_err.ps1:146 文字:1
+ $txtValuePtn.SetValue("わふる");
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : COMException
</code></pre></div></div>

<p><strong>Java側</strong></p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>Exception in thread "JavaFX Application Thread" java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer
        at javafx.scene.control.TextInputControl.executeAccessibleAction(TextInputControl.java:1590)
        at javafx.scene.Node$19.executeAction(Node.java:9649)
        at com.sun.glass.ui.Accessible$ExecuteAction.run(Accessible.java:177)
        at com.sun.glass.ui.Accessible$ExecuteAction.run(Accessible.java:173)
        at java.security.AccessController.doPrivileged(Native Method)
        at com.sun.glass.ui.Accessible.lambda$executeAction$5(Accessible.java:190)
        at com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:389)
        at com.sun.glass.ui.Accessible.executeAction(Accessible.java:187)
        at com.sun.glass.ui.win.WinAccessible.SetValueString(WinAccessible.java:1262)
        at com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
        at com.sun.glass.ui.win.WinApplication.lambda$null$152(WinApplication.java:177)
        at java.lang.Thread.run(Thread.java:748)
</code></pre></div></div>

<p>このエラーはJava11で作成したJavaFxの場合は発生しません。</p>

<h1>
<span id="java-access-bridgeを使用した自動操作" class="fragment"></span><a href="#java-access-bridge%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E8%87%AA%E5%8B%95%E6%93%8D%E4%BD%9C"><i class="fa fa-link"></i></a>Java Access Bridgeを使用した自動操作</h1>

<p><a href="https://docs.oracle.com/javase/10/access/java-access-bridge-architecture.htm#JSACC-GUID-FAFC50E6-DEFD-4808-9E04-65AD717F33D6" rel="nofollow noopener" target="_blank">Java Access Bridge</a>を使用することでWindowsはJavaのGUIを操作することが可能になります。</p>

<p>JavaやJava Access Bridgeを使用するプロセスが32bitか64bitかは意識して使用するようにしてください。</p>

<h2>
<span id="java-access-bridgeを使用したgui要素の探索" class="fragment"></span><a href="#java-access-bridge%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9Fgui%E8%A6%81%E7%B4%A0%E3%81%AE%E6%8E%A2%E7%B4%A2"><i class="fa fa-link"></i></a>Java Access Bridgeを使用したGUI要素の探索</h2>

<p>最初にJava Access Bridgeを使用したGUI要素の探索ツールである<a href="https://github.com/google/access-bridge-explorer" rel="nofollow noopener" target="_blank">Access Bridge Explorer</a>の使用方法について説明します。</p>

<p>(1)Java Access Bridgeを有効にする</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>%JRE_HOME%\bin\jabswitch -enable
</code></pre></div></div>

<p>(2)%JRE_HOME%\jre\binにWindowsAccessBridge-64.dllが存在することを確認し、環境変数PATHに %JRE_HOME%\jre\binを追加する。<br>
古いバージョンだときは下記からダウンロードする必要がある。<br>
<a href="https://www.oracle.com/technetwork/java/javase/tech/index-jsp-136191.html" class="autolink" rel="nofollow noopener" target="_blank">https://www.oracle.com/technetwork/java/javase/tech/index-jsp-136191.html</a></p>

<p>(3)下記からAccess Bridge Explorerをダウンロードする。<br>
<a href="https://github.com/google/access-bridge-explorer/releases" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/google/access-bridge-explorer/releases</a></p>

<p>(4)Access Bridge Explorerを起動する。<br>
<a href="https://camo.qiitausercontent.com/d4d0aeb6ab51d4a83acc7085dd2f1c043478f869/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f61356639326162642d323038382d636135352d636564382d3837336634636630666632642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fa5f92abd-2088-ca55-ced8-873f4cf0ff2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5d2c0bb46e419eeb3adff7586128ddbe" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/a5f92abd-2088-ca55-ced8-873f4cf0ff2d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fa5f92abd-2088-ca55-ced8-873f4cf0ff2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=81ace4d679f6c003cf17e9f230de5e7f 1x" loading="lazy"></a></p>

<p>※Java Access BridgeではSwingで作成した画面しか操作できません。JavaFxで作成した画面を操作することは不可能です。</p>

<h2>
<span id="netからのjava-access-bridgeの操作" class="fragment"></span><a href="#net%E3%81%8B%E3%82%89%E3%81%AEjava-access-bridge%E3%81%AE%E6%93%8D%E4%BD%9C"><i class="fa fa-link"></i></a>.NETからのJava Access Bridgeの操作</h2>

<p>.NETからJava Access Bridgeを操作するサンプルは下記に公開されていました。<br>
<a href="https://github.com/jdog3/JavaAccessBridge.Net-Sample" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/jdog3/JavaAccessBridge.Net-Sample</a></p>

<p>上記を基にクリック操作やコンソールアプリからの操作を可能したサンプルが以下になります。<br>
<a href="https://github.com/mima3/testjavagui/tree/master/cs" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/mima3/testjavagui/tree/master/cs</a></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">JabApiLib.JavaAccessBridge</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">JabApiCsharpSample</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//JabApi.Windows_run();</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">Init</span><span class="p">();</span>
            <span class="kt">int</span> <span class="n">vmID</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="n">AccessibleTreeItem</span> <span class="n">javaTree</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
            <span class="n">javaTree</span> <span class="p">=</span> <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">GetComponentTreeByTitle</span><span class="p">(</span><span class="s">"ToDoリスト"</span><span class="p">,</span> <span class="k">out</span> <span class="n">vmID</span><span class="p">);</span>

            <span class="c1">// テキスト設定</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="n">AccessibleTreeItem</span> <span class="n">txt</span> <span class="p">=</span> <span class="n">javaTree</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
            <span class="n">JabApi</span><span class="p">.</span><span class="nf">setTextContents</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">txt</span><span class="p">.</span><span class="n">acPtr</span><span class="p">,</span> <span class="s">"わろすわろす"</span><span class="p">);</span>

            <span class="n">JabHelpers</span><span class="p">.</span><span class="n">AccessibleTreeItem</span> <span class="n">button</span> <span class="p">=</span> <span class="n">javaTree</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">2</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
            <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">actionList</span> <span class="p">=</span> <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">GetAccessibleActionsList</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">button</span><span class="p">.</span><span class="n">acPtr</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"操作可能なアクション-------------"</span><span class="p">);</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">a</span> <span class="k">in</span> <span class="n">actionList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="c1">// クリック実行</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">DoAccessibleActions</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">button</span><span class="p">.</span><span class="n">acPtr</span><span class="p">,</span> <span class="s">"クリック"</span><span class="p">);</span>

            <span class="c1">//</span>
            <span class="n">JabApi</span><span class="p">.</span><span class="nf">setTextContents</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">txt</span><span class="p">.</span><span class="n">acPtr</span><span class="p">,</span> <span class="s">"いろはにほへと"</span><span class="p">);</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">DoAccessibleActions</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">button</span><span class="p">.</span><span class="n">acPtr</span><span class="p">,</span> <span class="s">"クリック"</span><span class="p">);</span>

            <span class="c1">//</span>
            <span class="n">JabApi</span><span class="p">.</span><span class="nf">setTextContents</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">txt</span><span class="p">.</span><span class="n">acPtr</span><span class="p">,</span> <span class="s">"ちりぬるお"</span><span class="p">);</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">DoAccessibleActions</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">button</span><span class="p">.</span><span class="n">acPtr</span><span class="p">,</span> <span class="s">"クリック"</span><span class="p">);</span>

            <span class="c1">// リストの内容</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"リスト一覧-------------"</span><span class="p">);</span>
            <span class="n">javaTree</span> <span class="p">=</span> <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">GetComponentTreeByTitle</span><span class="p">(</span><span class="s">"ToDoリスト"</span><span class="p">,</span> <span class="k">out</span> <span class="n">vmID</span><span class="p">);</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="n">AccessibleTreeItem</span> <span class="n">list</span> <span class="p">=</span> <span class="n">javaTree</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">children</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="n">JabHelpers</span><span class="p">.</span><span class="n">AccessibleTreeItem</span> <span class="n">listitem</span> <span class="k">in</span> <span class="n">list</span><span class="p">.</span><span class="n">children</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">listitem</span><span class="p">.</span><span class="n">name</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="n">JabHelpers</span><span class="p">.</span><span class="nf">DoAccessibleActions</span><span class="p">(</span><span class="n">vmID</span><span class="p">,</span> <span class="n">list</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">acPtr</span><span class="p">,</span> <span class="s">"クリック"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>DoAccessibleActionsで実行可能な操作はコントロール毎にことなり、なにができるかは、GetAccessibleActionsで調べることができます。<br>
JabApiでは<a href="https://docs.oracle.com/javase/10/access/java-access-bridge-api.htm#JSACC-GUID-FC888323-9E9D-4032-8A10-7E8DEC3061E0" rel="nofollow noopener" target="_blank">Java Access BridgeのAPI</a>を呼び出す関数を纏めて実装してあります。<br>
今回は64ビットで動作していることを前提としているので必要に応じてJabApi.csの下記の行を変更してください。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">JabApi</span>
    <span class="p">{</span>

        <span class="k">public</span> <span class="k">const</span> <span class="n">String</span> <span class="n">WinAccessBridgeDll</span> <span class="p">=</span> <span class="s">@"WindowsAccessBridge-64.dll"</span><span class="p">;</span>
</code></pre></div></div>

<p>なお、Java Access Bridgeの初期処理にあたるWindows_runはメッセージポンプを必要としており、メッセージが処理されないと後続の処理が正常に動作しません。<br>
大元になった<a href="https://github.com/jdog3/JavaAccessBridge.Net-Sample" rel="nofollow noopener" target="_blank">.NETからJava Access Bridge操作サンプル</a>でFormLoad時にWindows_runを入れなければならいと言っているのはこのためです。<br>
今回はコンソールで動作するように以下のようにWindows_run後にDoEventsを実行するようにしました。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>        <span class="c1">// Windows_runはメッセージポンプが必要</span>
        <span class="c1">// https://stackoverflow.com/questions/50582769/windowsaccessbridge-for-java-automation-using-c-sharp</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Init</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">JabApi</span><span class="p">.</span><span class="nf">Windows_run</span><span class="p">();</span>
            <span class="nf">DoEvents</span><span class="p">();</span>
        <span class="p">}</span>
</code></pre></div></div>

<p><strong>実行結果</strong><br>
<a href="https://camo.qiitausercontent.com/be77a257b1d7bb8165b9aeca0808df127bb772fa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f64363363363236372d333862332d383331622d343566612d6232396362393162663134392e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd63c6267-38b3-831b-45fa-b29cb91bf149.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b1ad8b55dec1edbc4c5e9598b127c7e9" alt="auto5.gif" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/d63c6267-38b3-831b-45fa-b29cb91bf149.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd63c6267-38b3-831b-45fa-b29cb91bf149.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=475ae7b80545435cdaf7a347cc96ee12 1x" loading="lazy"></a></p>

<h3>
<span id="powershellでの例" class="fragment"></span><a href="#powershell%E3%81%A7%E3%81%AE%E4%BE%8B"><i class="fa fa-link"></i></a>PowerShellでの例</h3>

<p>C#を基にPowerShellでも同じ操作を行うスクリプトが記述できます。<br>
使用しているJabApi.dllは<a href="https://github.com/mima3/testjavagui/blob/master/out/JabApi.dll" rel="nofollow noopener" target="_blank">ダウンロード</a>するか<a href="https://github.com/mima3/testjavagui/tree/master/cs" rel="nofollow noopener" target="_blank">ソースコード</a>からコンパイルしてください。<br>
GitHubに挙げたDLLは64bit+.NET2.0なので環境によっては使用できません。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code># 64bit前提
$dllPath = Split-Path $MyInvocation.MyCommand.Path
Set-Item Env:Path "$Env:Path;$dllPath"
Add-Type -Path "$dllPath\JabApi.dll"
[JabApiLib.JavaAccessBridge.JabHelpers]::init()
$vmID = 0
$javaTree = [JabApiLib.JavaAccessBridge.JabHelpers]::GetComponentTreeByTitle("ToDoリスト",[ref]$vmID)
$txt = $javaTree.children[0].children[1].children[0].children[0].children[1]
[JabApiLib.JavaAccessBridge.JabApi]::setTextContents($vmID, $txt.acPtr, "わろすわろす")

# クリック
$button = $javaTree.children[0].children[1].children[0].children[0].children[2].children[0]
[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $button.acPtr, "クリック")

#
[JabApiLib.JavaAccessBridge.JabApi]::setTextContents($vmID, $txt.acPtr, "あああああ")
[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $button.acPtr, "クリック")

#
[JabApiLib.JavaAccessBridge.JabApi]::setTextContents($vmID, $txt.acPtr, "いいいいい")
[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $button.acPtr, "クリック") 

# 更新の確認
$javaTree = [JabApiLib.JavaAccessBridge.JabHelpers]::GetComponentTreeByTitle("ToDoリスト",[ref]$vmID)
$list = $javaTree.children[0].children[1].children[0].children[0].children[0].children[0].children[0]
foreach($item in $list.children) {
  Write-Host $item.name
}
[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $list.children[1].acPtr, "クリック") 

</code></pre></div></div>

<h1>
<span id="uipathの場合" class="fragment"></span><a href="#uipath%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>UIPathの場合</h1>

<p>ツールからJava拡張機能をインストールすることでJavaのGUI操作が可能になります。<br>
<a href="https://camo.qiitausercontent.com/cb11dac34e2c77a912c4bb9859c21533458755f7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f33316165613435362d396266312d386465312d383836392d6433373835383132623463642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F31aea456-9bf1-8de1-8869-d3785812b4cd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3ffdf3d2277b86612c67ad3fa9f7913f" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/31aea456-9bf1-8de1-8869-d3785812b4cd.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F31aea456-9bf1-8de1-8869-d3785812b4cd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1e71c445cf2b3e6eb1330e6330beec21 1x" loading="lazy"></a><br>
拡張機能をインストールすると「%JRE_HOME%\bin\」にUiPathJavaBridgeV8_x64.dllが、格納されます。</p>

<p>拡張機能をインストールすると、いつも通りに画面が作成できるようになります。<br>
<a href="https://camo.qiitausercontent.com/9ff76e866b730eabd6f79e4fce4a4d48f804991c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f31363834383333612d666236342d623135352d653531322d6662396230663334333430332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F1684833a-fb64-b155-e512-fb9b0f343403.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e743d3d9bb3a440c6bffe84f54ce65dc" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/1684833a-fb64-b155-e512-fb9b0f343403.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F1684833a-fb64-b155-e512-fb9b0f343403.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0fc276d04c6cf18e89d2352beea891c1 1x" loading="lazy"></a></p>

<p><strong>実行結果</strong><br>
<a href="https://camo.qiitausercontent.com/7fced5e0aebdc8cb1ef5629f42208a084bbbb828/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f63623063663837642d663536642d333931342d356237312d6331626338613562363930392e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/cb0cf87d-f56d-3914-5b71-c1bc8a5b6909.gif" alt="auto6.gif" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/cb0cf87d-f56d-3914-5b71-c1bc8a5b6909.gif" loading="lazy"></a></p>

<h1>
<span id="その他の選択肢" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E9%81%B8%E6%8A%9E%E8%82%A2"><i class="fa fa-link"></i></a>その他の選択肢</h1>

<p>GUIのテストフレームワークを利用して自動操作がおこなえるかもしれません。<br>
今回の目的と違っていたので、詳しくは調べていません。</p>

<h2>
<span id="automation" class="fragment"></span><a href="#automation"><i class="fa fa-link"></i></a>Automation</h2>

<p><a href="https://github.com/renatoathaydes/Automaton" rel="nofollow noopener" target="_blank">Automation</a>はSwingとJavaFxのGUIを簡単にテストできるフレームワークです。</p>

<p>Javaで記載することもできますが、下記のようなGroovyのスクリプトで記載することも可能です。</p>

<div class="code-frame" data-lang="groovy"><div class="highlight"><pre class="with-code"><code><span class="n">clickOn</span> <span class="s1">'text:Some Button'</span>
<span class="n">doubleClickOn</span> <span class="s1">'username-input'</span>
<span class="n">type</span> <span class="s1">'my-username'</span>
<span class="n">clickOn</span> <span class="s1">'text:Login'</span>
</code></pre></div></div>

<h2>
<span id="testfx" class="fragment"></span><a href="#testfx"><i class="fa fa-link"></i></a>TestFX</h2>

<p>JavaFXのシンプルでクリーンなテストフレームワークです。<br>
<a href="https://github.com/TestFX/TestFX" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/TestFX/TestFX</a></p>

<h2>
<span id="assertj-swing" class="fragment"></span><a href="#assertj-swing"><i class="fa fa-link"></i></a>AssertJ Swing</h2>

<p><a href="http://joel-costigliola.github.io/assertj/assertj-swing.html" rel="nofollow noopener" target="_blank">AssertJ Swing</a>はSwingのGUIのテストが可能のようです。<br>
今はFest Swingをフォークしたものになります。</p>

<p><strong>Java Swing UI test driver replacement for Fest [closed]</strong><br>
<a href="https://stackoverflow.com/questions/31168990/java-swing-ui-test-driver-replacement-for-fest" class="autolink" rel="nofollow noopener" target="_blank">https://stackoverflow.com/questions/31168990/java-swing-ui-test-driver-replacement-for-fest</a></p>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<ul>
<li><a href="https://www.atmarkit.co.jp/ait/articles/0605/31/news125.html" rel="nofollow noopener" target="_blank">SwingのキホンJFrameを使う</a></li>
<li><a href="https://stackoverflow.com/questions/32700005/javafx-listview-add-and-edit-element" rel="nofollow noopener" target="_blank">Javafx Listview Add and edit element</a></li>
<li><a href="https://stackoverflow.com/questions/52013505/how-do-i-use-javafx-11-in-eclipse" rel="nofollow noopener" target="_blank">How do I use JavaFX 11 in Eclipse?</a></li>
<li><a href="https://skrb.hatenablog.com/entry/2018/05/29/210000" rel="nofollow noopener" target="_blank">OpenJFX + OpenJDK で JavaFX を動かす</a></li>
<li><a href="https://qiita.com/todu/items/bed6f733ca9df0cbec75" id="reference-b00fe448ee611d6a665f">Ubuntu18.4でjava11とjavaFxの環境を整える</a></li>
<li><a href="https://qiita.com/tarosa0001/items/05ac653a091b7d1290f9" id="reference-c7e4e2a3a40a5ea1885a">【超初心者向け】JavaFX超入門</a></li>
<li><a href="https://docs.oracle.com/javase/10/access/java-access-bridge-architecture.htm#JSACC-GUID-FAFC50E6-DEFD-4808-9E04-65AD717F33D6" rel="nofollow noopener" target="_blank">Java Access Bridge Architecture</a></li>
<li><a href="https://stackoverflow.com/questions/31168990/java-swing-ui-test-driver-replacement-for-fest" rel="nofollow noopener" target="_blank">Java Swing UI test driver replacement for Fest [closed]</a></li>
<li><a href="https://github.com/renatoathaydes/Automaton" rel="nofollow noopener" target="_blank">Automation</a></li>
<li><a href="https://sites.google.com/a/athaydes.com/renato-athaydes/posts/twosimpletoolstoletyoutestyourswingjavafxapplicationseasily" rel="nofollow noopener" target="_blank">Two simple tools to let you test your Swing/JavaFX applications easily</a></li>
<li><a href="https://github.com/TestFX/TestFX" rel="nofollow noopener" target="_blank">TestFx</a></li>
<li><a href="https://stackoverflow.com/questions/50582769/windowsaccessbridge-for-java-automation-using-c-sharp" rel="nofollow noopener" target="_blank">WindowsAccessBridge for Java Automation using C#</a></li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fmima_ita%2Fitems%2F702fdbdee30346b5738e&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fmima_ita%2Fitems%2F702fdbdee30346b5738e&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mima_ita/items/702fdbdee30346b5738e/likers" class="css-1iupg5d">15</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">18</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/702fdbdee30346b5738e/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mima_ita/items/702fdbdee30346b5738e/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mima_ita/items/702fdbdee30346b5738e/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mima_ita/items/702fdbdee30346b5738e/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mima_ita/items/702fdbdee30346b5738e.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-1b31f3ce-0195-4805-9224-14ab50713422">{"authorAnalyticsTrackingId":"UA-52996017-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-e2fe95e7-1ad8-46a8-9026-0b75072b4f4d"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-e2fe95e7-1ad8-46a8-9026-0b75072b4f4d">{}</script>
      
<div id="LoginModal-react-component-e7112eb3-e2b2-4869-a447-fc83a861c5ab"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-e7112eb3-e2b2-4869-a447-fc83a861c5ab">{}</script>
      
<div id="StockModal-react-component-ecc47e82-244d-45da-b220-a444a1186b40"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-ecc47e82-244d-45da-b220-a444a1186b40">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;20zjtGz4oryZqwrHnaOCkKzYfen8PhtfXrmA6r8YZDiBhUeXOYMd3pD+h51I7ZBkwuZzrB6Cu+AK7CfbP43bTg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"まえがき\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%88%E3%81%8C%E3%81%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまえがき\u003c/h1\u003e\n\n\u003cp\u003eたいていのWindowsの画面の自動操作は以下で紹介した方法で可能になっています。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRPA九人衆による「ｱｶﾈﾁｬﾝｶﾜｲｲﾔｯﾀ」の自動化\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/mima_ita/items/d4655de865f30bb51c65\" class=\"autolink\" id=\"reference-b4e51e0a60c3c2944a99\"\u003ehttps://qiita.com/mima_ita/items/d4655de865f30bb51c65\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e実は厄介なケースがあって、それはJavaで画面を作っているケースです。\u003cbr\u003e\n今回はJavaで作られた画面を例に自動操作が可能かどうか検討してみましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e実験環境\u003c/strong\u003e\u003cbr\u003e\nWindows10 Home\u003cbr\u003e\nJava 8\u003cbr\u003e\nVisual Studio 2019\u003cbr\u003e\nPowerShell 5.1\u003cbr\u003e\nUiPath 2019.10.0-beta 111\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"javaの画面の作成方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#java%E3%81%AE%E7%94%BB%E9%9D%A2%E3%81%AE%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJavaの画面の作成方法\u003c/h1\u003e\n\n\u003cp\u003eJavaで画面を作成する主な方法としてSwingを使用する場合と、JavaFxを使用する場合があります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"swingで作成した画面\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#swing%E3%81%A7%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSwingで作成した画面\u003c/h2\u003e\n\n\u003cp\u003e下記のページを参考に簡単なSwingの画面を作成します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.atmarkit.co.jp/ait/articles/0605/31/news125.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSwingのキホンJFrameを使う\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/325697cb46128dc525997d90814a285c9249ee74/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f64316334653833652d366465622d373435332d313562642d3039623065613930323031652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd1c4e83e-6deb-7453-15bd-09b0ea90201e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e882f65a52a421336be0af7fc62c86cc\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/d1c4e83e-6deb-7453-15bd-09b0ea90201e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd1c4e83e-6deb-7453-15bd-09b0ea90201e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bfbcee4939daa74d22a77ec31a7c9a73 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"java\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eToDoListPane.java\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nn\"\u003eSwingSample\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejava.awt.BorderLayout\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejava.awt.event.ActionEvent\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejava.awt.event.ActionListener\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavax.swing.DefaultListModel\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavax.swing.JButton\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavax.swing.JList\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavax.swing.JPanel\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavax.swing.JScrollPane\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavax.swing.JTextField\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"cm\"\u003e/**\n* ToDoリスト\n* 以下参考\n* https://www.atmarkit.co.jp/ait/articles/0609/23/news027.html\n*/\u003c/span\u003e\n\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eToDoListPane\u003c/span\u003e \u003cspan class=\"kd\"\u003eextends\u003c/span\u003e \u003cspan class=\"nc\"\u003eJPanel\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eJList\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etoDoList\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eDefaultListModel\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etoDoListModel\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eJTextField\u003c/span\u003e \u003cspan class=\"n\"\u003etoDoInputField\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eJButton\u003c/span\u003e \u003cspan class=\"n\"\u003eaddButton\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eToDoListPane\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003esuper\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eBorderLayout\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 一覧を生成\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etoDoListModel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eDefaultListModel\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etoDoList\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJList\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003etoDoListModel\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"nc\"\u003eJScrollPane\u003c/span\u003e \u003cspan class=\"n\"\u003elistScrollPane\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e   \u003cspan class=\"nc\"\u003eJScrollPane\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etoDoList\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// ToDo追加用テキストフィールドの生成\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etoDoInputField\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJTextField\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 各ボタンの生成\u003c/span\u003e\n                \u003cspan class=\"nc\"\u003eJPanel\u003c/span\u003e \u003cspan class=\"n\"\u003ebuttonPanel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJPanel\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eaddButton\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJButton\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"追加\"\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// ボタンにリスナを設定\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eaddButton\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eaddActionListener\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e    \u003cspan class=\"nc\"\u003eAddActionHandler\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ebuttonPanel\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaddButton\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elistScrollPane\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eBorderLayout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNORTH\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etoDoInputField\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eBorderLayout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eCENTER\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuttonPanel\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eBorderLayout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eSOUTH\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"cm\"\u003e/**\n        * 追加ボタンアクションのハンドラ\n        */\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAddActionHandler\u003c/span\u003e \u003cspan class=\"kd\"\u003eimplements\u003c/span\u003e \u003cspan class=\"nc\"\u003eActionListener\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eactionPerformed\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eActionEvent\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"c1\"\u003e// テキストフィールドの内容をリストモデルに追加\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003etoDoListModel\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eaddElement\u003c/span\u003e\n                        \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etoDoInputField\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetText\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n                \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eすべてのコードは以下にあります。\u003cbr\u003e\n\u003ca href=\"https://github.com/mima3/testjavagui/tree/master/java/Swing001\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/mima3/testjavagui/tree/master/java/Swing001\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"javafxで作成した画面\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#javafx%E3%81%A7%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJavaFxで作成した画面\u003c/h2\u003e\n\n\u003cp\u003eJavaFxでも単純な画面を作成します。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/7aea5952c8675f0d90505c5080900b70542ab95f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f32396262643263642d356534622d393230362d633832352d3364333564613063376431642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F29bbd2cd-5e4b-9206-c825-3d35da0c7d1d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d2a4a9bfd3586eb04c3f4699ae0d7733\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/29bbd2cd-5e4b-9206-c825-3d35da0c7d1d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F29bbd2cd-5e4b-9206-c825-3d35da0c7d1d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8ff77694192734bd9dde5e5d4e65f5b3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMain.fxml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\"1.0\" encoding=\"UTF-8\"?\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"cp\"\u003e\u0026lt;?import java.lang.*?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;?import javafx.scene.control.*?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;?import javafx.scene.layout.*?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;?import javafx.scene.layout.AnchorPane?\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;AnchorPane\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:fx=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://javafx.com/fxml/1\"\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://javafx.com/javafx/2.2\"\u003c/span\u003e \u003cspan class=\"na\"\u003efx:controller=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ctrl.Controller\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- TODO Add Nodes --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;children\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;Pane\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutX=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"0.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutY=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"-14.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003eprefHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"297.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003eprefWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"345.0\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;children\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;Label\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutX=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"14.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutY=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"14.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003etext=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"リスト\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;ListView\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"na\"\u003efx:id=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"list\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutX=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"14.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutY=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"30.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003eprefHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"198.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003eprefWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"317.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"na\"\u003efx:id=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"btnAdd\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutX=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"14.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutY=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"262.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003emnemonicParsing=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"false\"\u003c/span\u003e \u003cspan class=\"na\"\u003eonAction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"#onAddButtonClicked\"\u003c/span\u003e \u003cspan class=\"na\"\u003etext=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"追加\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;TextField\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"na\"\u003efx:id=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"textBox\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutX=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"14.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003elayoutY=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"228.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003eprefHeight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"15.9609375\"\u003c/span\u003e \u003cspan class=\"na\"\u003eprefWidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"317.0\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/children\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/Pane\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/children\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/AnchorPane\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"java\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eControler.java\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nn\"\u003ectrl\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejava.net.URL\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejava.util.ResourceBundle\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavafx.event.ActionEvent\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavafx.fxml.FXML\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavafx.fxml.Initializable\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavafx.scene.control.Button\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavafx.scene.control.ListView\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejavafx.scene.control.TextField\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n\n\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eController\u003c/span\u003e \u003cspan class=\"kd\"\u003eimplements\u003c/span\u003e \u003cspan class=\"nc\"\u003eInitializable\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nd\"\u003e@FXML\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eTextField\u003c/span\u003e \u003cspan class=\"n\"\u003etextBox\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"nd\"\u003e@FXML\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eButton\u003c/span\u003e \u003cspan class=\"n\"\u003ebtnAdd\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"nd\"\u003e@FXML\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eListView\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"nd\"\u003e@Override\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003elocation\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eResourceBundle\u003c/span\u003e \u003cspan class=\"n\"\u003eresources\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// TODO 自動生成されたメソッド・スタブ\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etextBox\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetText\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"値を入力してください。\"\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"nd\"\u003e@FXML\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eonAddButtonClicked\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eActionEvent\u003c/span\u003e \u003cspan class=\"n\"\u003eevent\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// テキストボックスに文字列をセットする\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetItems\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etextBox\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetText\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etextBox\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetText\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eすべてのコードは以下にあります。\u003cbr\u003e\n\u003ca href=\"https://github.com/mima3/testjavagui/tree/master/java/Java8Fx001\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/mima3/testjavagui/tree/master/java/Java8Fx001\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"java11でjavafxの画面を作る場合の注意\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#java11%E3%81%A7javafx%E3%81%AE%E7%94%BB%E9%9D%A2%E3%82%92%E4%BD%9C%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AE%E6%B3%A8%E6%84%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJava11でJavaFxの画面を作る場合の注意\u003c/h3\u003e\n\n\u003cp\u003eJavaFXはJDK 11以降、Oracle JDKから分離されます。そのためJavaFxの画面を作る場合、以下のような手順が必要になります。\u003c/p\u003e\n\n\u003cp\u003e(1)JavaFXをダウンロードする。\u003cbr\u003e\n\u003ca href=\"https://gluonhq.com/products/javafx/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://gluonhq.com/products/javafx/\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(2)ダウンロードしたフォルダ中のlibの中のjarをプロジェクトの参照ライブラリに追加する。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/cf9f7839dfcbe0a146b05760d9d62a2c993a95d9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f30633665323562382d383832362d616262352d303934332d3936336561313438643764302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F0c6e25b8-8826-abb5-0943-963ea148d7d0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=43da4c17593009f7829d1a50b546a373\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/0c6e25b8-8826-abb5-0943-963ea148d7d0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F0c6e25b8-8826-abb5-0943-963ea148d7d0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=642dc6d2f638199f73a3f5ecb6e69c21 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(3)実行時\u003cbr\u003e\n\u003cstrong\u003eコマンドラインから実行する場合\u003c/strong\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC:\\pleiades201904\\java\\11\\bin\\java --module-path=C:\\tool\\lib\\javafx-sdk-11.0.2\\lib\\ --add-modules=javafx.controls --add-modules=javafx.swing --add-modules=javafx.base --add-modules=javafx.fxml --add-modules=javafx.media --add-modules=javafx.web -jar Java11Fx.jar\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eEclipseで実行する場合の実行構成\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/c8284f44f40cf4701a8d51dff3d780c22cce273f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f64373961303633352d353634382d613736612d393432302d3466313132396462633363362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd79a0635-5648-a76a-9420-4f1129dbc3c6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=86846fe2dc8207e96139deaff176a473\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/d79a0635-5648-a76a-9420-4f1129dbc3c6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd79a0635-5648-a76a-9420-4f1129dbc3c6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=80afa8a4debe7041f3de5995a8dc75c8 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"uiautomationの自動操作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#uiautomation%E3%81%AE%E8%87%AA%E5%8B%95%E6%93%8D%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUIAutomationの自動操作\u003c/h1\u003e\n\n\u003cp\u003e作成したJavaの画面を\u003ca href=\"https://docs.microsoft.com/en-us/windows/win32/winauto/inspect-objects\" rel=\"nofollow noopener\" target=\"_blank\"\u003einspect.exe\u003c/a\u003eを使用してUIAutomation経由で操作できるかを確認します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"swingの場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#swing%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSwingの場合：\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4eb4483cfc023879cac8762eecb55df1c82683d5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f37636535333435342d386664632d306364302d393237662d3264333438623432353231392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F7ce53454-8fdc-0cd0-927f-2d348b425219.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2fa0b5c567812b1bcb272d7e1e782b10\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/7ce53454-8fdc-0cd0-927f-2d348b425219.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F7ce53454-8fdc-0cd0-927f-2d348b425219.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b7e849baa2c73c9d52dc806d27291980 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eUIAutomationでコントロールの情報が取得されていないことが確認できます。つまり\u003cstrong\u003eSwingで作成したアプリケーションはUIAutomation経由で操作が不可能です\u003c/strong\u003e。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"javafxの場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#javafx%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJavaFxの場合：\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/353ff2fc4e010dbac38795db380e4b616375b54f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f61666130646564302d326564392d313561382d616336632d3262306339653633316333342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fafa0ded0-2ed9-15a8-ac6c-2b0c9e631c34.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0b572823086683e20728aff8c98e1538\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/afa0ded0-2ed9-15a8-ac6c-2b0c9e631c34.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fafa0ded0-2ed9-15a8-ac6c-2b0c9e631c34.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3ad6bf38a78885e7d99eb98625a0bb98 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eUIAutomationの要素が取得されており、ControlTypeも適切に設定されていることが確認できます。\u003cbr\u003e\n実際にPowerShellを使用して自動操作をしてみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"powershell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eAdd-Type\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003e-AssemblyName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eUIAutomationClient\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd-Type\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003e-AssemblyName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eUIAutomationTypes\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd-type\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003e-AssemblyName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eSystem.Windows.Forms\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$source\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"sh\"\u003e@\"\nusing System;\nusing System.Windows.Automation;\nusing System.Runtime.InteropServices;\nusing System.Windows.Forms;\nusing System.Drawing;\n\npublic class AutomationHelper\n{\n    // https://culage.hatenablog.com/entry/20130611/1370876400\n    [DllImport(\"user32.dll\")]\n    extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);\n\n    [StructLayout(LayoutKind.Sequential)]\n    struct INPUT\n    {\n        public int type;\n        public MOUSEINPUT mi;\n    }\n\n    [StructLayout(LayoutKind.Sequential)]\n    struct MOUSEINPUT\n    {\n        public int dx;\n        public int dy;\n        public int mouseData;\n        public int dwFlags;\n        public int time;\n        public IntPtr dwExtraInfo;\n    }\n\n    const int MOUSEEVENTF_LEFTDOWN = 0x0002;\n    const int MOUSEEVENTF_LEFTUP = 0x0004;\n    static public void Click()\n    {\n        //struct 配列の宣言\n        INPUT[] input = new INPUT[2];\n        //左ボタン Down\n        input[0].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;\n        //左ボタン Up\n        input[1].mi.dwFlags = MOUSEEVENTF_LEFTUP;\n        //イベントの一括生成\n        SendInput(2, input, Marshal.SizeOf(input[0]));\n    }\n    static public void MouseMove(int x, int y)\n    {\n        var pt = new System.Drawing.Point(x, y);\n        System.Windows.Forms.Cursor.Position = pt;\n    }\n    static public void SendKeys(string key) \n    {\n        System.Windows.Forms.SendKeys.SendWait(key);\n    }\n    public static AutomationElement RootElement\n    {\n        get\n        {\n            return AutomationElement.RootElement;\n        }\n    }\n\n    public static AutomationElement GetMainWindowByTitle(string title) {\n        PropertyCondition cond = new PropertyCondition(AutomationElement.NameProperty, title);\n        return RootElement.FindFirst(TreeScope.Children, cond);\n    }\n\n    public static AutomationElement ChildWindowByTitle(AutomationElement parent , string title) {\n        try {\n            PropertyCondition cond = new PropertyCondition(AutomationElement.NameProperty, title);\n            return parent.FindFirst(TreeScope.Children, cond);\n        } catch {\n            return null;\n        }\n    }\n\n    public static AutomationElement WaitChildWindowByTitle(AutomationElement parent, string title, int timeout = 10) {\n        DateTime start = DateTime.Now;\n        while (true) {\n            AutomationElement ret = ChildWindowByTitle(parent, title);\n            if (ret != null) {\n                return ret;\n            }\n            TimeSpan ts = DateTime.Now - start;\n            if (ts.TotalSeconds \u0026gt; timeout) {\n               return null;\n            }\n            System.Threading.Thread.Sleep(100);\n        }\n    }\n}\n\"@\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd-Type\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003e-TypeDefinition\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$source\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003e-ReferencedAssemblies\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"UIAutomationClient\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"UIAutomationTypes\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"System.Windows.Forms\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"System.Drawing\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# 5.0以降ならusingで記載した方が楽。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$autoElem\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.AutomationElement\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# ウィンドウ以下で指定の条件に当てはまるコントロールを全て列挙\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"kr\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003efindAllElements\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$form\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$condProp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$condValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nv\"\u003e$cond\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eNew-Object\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003e-TypeName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eSystem.Windows.Automation.PropertyCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$condProp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$condValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$form\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindAll\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.TreeScope\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"nx\"\u003eElement\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-bor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.TreeScope\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"nx\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$cond\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# ウィンドウ以下で指定の条件に当てはまるコントロールを１つ取得\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"kr\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003efindFirstElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$form\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$condProp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$condValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nv\"\u003e$cond\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eNew-Object\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003e-TypeName\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eSystem.Windows.Automation.PropertyCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$condProp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$condValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$form\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFindFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.TreeScope\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"nx\"\u003eElement\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-bor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.TreeScope\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"nx\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$cond\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# 要素をValuePatternに変換\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"kr\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003econvertValuePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$elem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$elem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCurrentPattern\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.ValuePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"nx\"\u003ePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-as\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.ValuePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"kr\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003econvertSelectionItemPattern\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$elem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$elem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCurrentPattern\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.SelectionItemPattern\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"nx\"\u003ePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-as\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.SelectionItemPattern\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# 要素にテキストを入力\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# Java8だとtxtValuePtn.SetValueが正常に動作しないための代替\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"kr\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003esendTextValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$textCtrl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$message\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAutomationHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eMouseMove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$textCtrl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eBoundingRectangle\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eX\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$textCtrl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eBoundingRectangle\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAutomationHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eClick\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAutomationHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"^(a)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAutomationHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"{DEL}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAutomationHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eSendKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$message\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"n\"\u003eStart-Sleep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# メイン処理\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$mainForm\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAutomationHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetMainWindowByTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"TODOリスト\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"kr\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$mainForm\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-eq\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"bp\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"n\"\u003eWrite-Error\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Java Fxの画面を起動してください\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"kr\"\u003eexit\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$mainForm\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetFocus\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$editType\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.ControlType\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eEdit\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$textCtrl\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efindFirstElement\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$mainForm\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$autoElem\u003c/span\u003e\u003cspan class=\"p\"\u003e::\u003c/span\u003e\u003cspan class=\"nx\"\u003eControlTypeProperty\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$editType\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# Java8の場合ValuePatternのSetValueでエラーとなる\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#$txtValuePtn = convertValuePattern $textCtrl\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#$txtGetValue = $txtValuePtn.Current.Value\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#Write-Host \"変更前：$txtGetValue\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#$txtValuePtn.SetValue(\"わふる\");\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"n\"\u003esendTextValue\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$textCtrl\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"わっふる\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$btnCtrl\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efindFirstElement\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$mainForm\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$autoElem\u003c/span\u003e\u003cspan class=\"p\"\u003e::\u003c/span\u003e\u003cspan class=\"nx\"\u003eNameProperty\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"追加\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$btnInvoke\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$btnCtrl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCurrentPattern\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.InvokePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"nx\"\u003ePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-as\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.InvokePattern\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$btnInvoke\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# 2文字目\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003esendTextValue\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$textCtrl\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"猫\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$btnInvoke\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# 3文字目\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003esendTextValue\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$textCtrl\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"犬\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$btnInvoke\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# リスト選択\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$listitemType\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem.Windows.Automation.ControlType\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eListItem\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$listitems\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efindAllElements\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$mainForm\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$autoElem\u003c/span\u003e\u003cspan class=\"p\"\u003e::\u003c/span\u003e\u003cspan class=\"nx\"\u003eControlTypeProperty\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$listitemType\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$listPtn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econvertSelectionItemPattern\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$listitems\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nv\"\u003e$listPtn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003e実行結果\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/e027a593a567271fb382e99171f804c3b2a76f63/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f61653038666566312d383365362d613632652d333333322d3831653037346638323235312e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fae08fef1-83e6-a62e-3332-81e074f82251.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5f24d2b24f7933f3520dd47ba5092cde\" alt=\"auto4.gif\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/ae08fef1-83e6-a62e-3332-81e074f82251.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fae08fef1-83e6-a62e-3332-81e074f82251.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1afbd196a7c1bebe61f41ff05257e5a7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれを実行するとJava11のJavaFxを使用した画面は正常に完了しますが、Java8のJavaFxを使用した画面は下記のエラーを出力します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"javafxをuiautomationでの操作時のエラー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#javafx%E3%82%92uiautomation%E3%81%A7%E3%81%AE%E6%93%8D%E4%BD%9C%E6%99%82%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJavaFxをUIAutomationでの操作時のエラー\u003c/h3\u003e\n\n\u003cp\u003eJava8で作成したJavaFxに対してUiAutomationのValuePatternで値を設定すると下記のエラーが出ます。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePowerShell側\u003c/strong\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\"1\" 個の引数を指定して \"SetValue\" を呼び出し中に例外が発生しました: \"\"\n発生場所 C:\\dev\\testjavagui\\out\\javafx_auto_err.ps1:146 文字:1\n+ $txtValuePtn.SetValue(\"わふる\");\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\n    + FullyQualifiedErrorId : COMException\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eJava側\u003c/strong\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eException in thread \"JavaFX Application Thread\" java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer\n        at javafx.scene.control.TextInputControl.executeAccessibleAction(TextInputControl.java:1590)\n        at javafx.scene.Node$19.executeAction(Node.java:9649)\n        at com.sun.glass.ui.Accessible$ExecuteAction.run(Accessible.java:177)\n        at com.sun.glass.ui.Accessible$ExecuteAction.run(Accessible.java:173)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at com.sun.glass.ui.Accessible.lambda$executeAction$5(Accessible.java:190)\n        at com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:389)\n        at com.sun.glass.ui.Accessible.executeAction(Accessible.java:187)\n        at com.sun.glass.ui.win.WinAccessible.SetValueString(WinAccessible.java:1262)\n        at com.sun.glass.ui.win.WinApplication._runLoop(Native Method)\n        at com.sun.glass.ui.win.WinApplication.lambda$null$152(WinApplication.java:177)\n        at java.lang.Thread.run(Thread.java:748)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのエラーはJava11で作成したJavaFxの場合は発生しません。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"java-access-bridgeを使用した自動操作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#java-access-bridge%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E8%87%AA%E5%8B%95%E6%93%8D%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJava Access Bridgeを使用した自動操作\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://docs.oracle.com/javase/10/access/java-access-bridge-architecture.htm#JSACC-GUID-FAFC50E6-DEFD-4808-9E04-65AD717F33D6\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJava Access Bridge\u003c/a\u003eを使用することでWindowsはJavaのGUIを操作することが可能になります。\u003c/p\u003e\n\n\u003cp\u003eJavaやJava Access Bridgeを使用するプロセスが32bitか64bitかは意識して使用するようにしてください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"java-access-bridgeを使用したgui要素の探索\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#java-access-bridge%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9Fgui%E8%A6%81%E7%B4%A0%E3%81%AE%E6%8E%A2%E7%B4%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJava Access Bridgeを使用したGUI要素の探索\u003c/h2\u003e\n\n\u003cp\u003e最初にJava Access Bridgeを使用したGUI要素の探索ツールである\u003ca href=\"https://github.com/google/access-bridge-explorer\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAccess Bridge Explorer\u003c/a\u003eの使用方法について説明します。\u003c/p\u003e\n\n\u003cp\u003e(1)Java Access Bridgeを有効にする\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e%JRE_HOME%\\bin\\jabswitch -enable\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e(2)%JRE_HOME%\\jre\\binにWindowsAccessBridge-64.dllが存在することを確認し、環境変数PATHに %JRE_HOME%\\jre\\binを追加する。\u003cbr\u003e\n古いバージョンだときは下記からダウンロードする必要がある。\u003cbr\u003e\n\u003ca href=\"https://www.oracle.com/technetwork/java/javase/tech/index-jsp-136191.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.oracle.com/technetwork/java/javase/tech/index-jsp-136191.html\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(3)下記からAccess Bridge Explorerをダウンロードする。\u003cbr\u003e\n\u003ca href=\"https://github.com/google/access-bridge-explorer/releases\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/google/access-bridge-explorer/releases\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(4)Access Bridge Explorerを起動する。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d4d0aeb6ab51d4a83acc7085dd2f1c043478f869/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f61356639326162642d323038382d636135352d636564382d3837336634636630666632642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fa5f92abd-2088-ca55-ced8-873f4cf0ff2d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5d2c0bb46e419eeb3adff7586128ddbe\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/a5f92abd-2088-ca55-ced8-873f4cf0ff2d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fa5f92abd-2088-ca55-ced8-873f4cf0ff2d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=81ace4d679f6c003cf17e9f230de5e7f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e※Java Access BridgeではSwingで作成した画面しか操作できません。JavaFxで作成した画面を操作することは不可能です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"netからのjava-access-bridgeの操作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#net%E3%81%8B%E3%82%89%E3%81%AEjava-access-bridge%E3%81%AE%E6%93%8D%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e.NETからのJava Access Bridgeの操作\u003c/h2\u003e\n\n\u003cp\u003e.NETからJava Access Bridgeを操作するサンプルは下記に公開されていました。\u003cbr\u003e\n\u003ca href=\"https://github.com/jdog3/JavaAccessBridge.Net-Sample\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/jdog3/JavaAccessBridge.Net-Sample\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e上記を基にクリック操作やコンソールアプリからの操作を可能したサンプルが以下になります。\u003cbr\u003e\n\u003ca href=\"https://github.com/mima3/testjavagui/tree/master/cs\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/mima3/testjavagui/tree/master/cs\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eJabApiLib.JavaAccessBridge\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eJabApiCsharpSample\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eProgram\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//JabApi.Windows_run();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003evmID\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAccessibleTreeItem\u003c/span\u003e \u003cspan class=\"n\"\u003ejavaTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ejavaTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetComponentTreeByTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ToDoリスト\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// テキスト設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAccessibleTreeItem\u003c/span\u003e \u003cspan class=\"n\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ejavaTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabApi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esetTextContents\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etxt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"わろすわろす\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAccessibleTreeItem\u003c/span\u003e \u003cspan class=\"n\"\u003ebutton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ejavaTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eactionList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAccessibleActionsList\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebutton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"操作可能なアクション-------------\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eactionList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// クリック実行\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDoAccessibleActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebutton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"クリック\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabApi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esetTextContents\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etxt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"いろはにほへと\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDoAccessibleActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebutton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"クリック\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabApi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esetTextContents\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etxt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ちりぬるお\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDoAccessibleActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebutton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"クリック\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// リストの内容\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"リスト一覧-------------\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ejavaTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetComponentTreeByTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ToDoリスト\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAccessibleTreeItem\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ejavaTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAccessibleTreeItem\u003c/span\u003e \u003cspan class=\"n\"\u003elistitem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elistitem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDoAccessibleActions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evmID\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003echildren\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eacPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"クリック\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadLine\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eDoAccessibleActionsで実行可能な操作はコントロール毎にことなり、なにができるかは、GetAccessibleActionsで調べることができます。\u003cbr\u003e\nJabApiでは\u003ca href=\"https://docs.oracle.com/javase/10/access/java-access-bridge-api.htm#JSACC-GUID-FC888323-9E9D-4032-8A10-7E8DEC3061E0\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJava Access BridgeのAPI\u003c/a\u003eを呼び出す関数を纏めて実装してあります。\u003cbr\u003e\n今回は64ビットで動作していることを前提としているので必要に応じてJabApi.csの下記の行を変更してください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eJabApi\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"n\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003eWinAccessBridgeDll\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"WindowsAccessBridge-64.dll\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eなお、Java Access Bridgeの初期処理にあたるWindows_runはメッセージポンプを必要としており、メッセージが処理されないと後続の処理が正常に動作しません。\u003cbr\u003e\n大元になった\u003ca href=\"https://github.com/jdog3/JavaAccessBridge.Net-Sample\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NETからJava Access Bridge操作サンプル\u003c/a\u003eでFormLoad時にWindows_runを入れなければならいと言っているのはこのためです。\u003cbr\u003e\n今回はコンソールで動作するように以下のようにWindows_run後にDoEventsを実行するようにしました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e// Windows_runはメッセージポンプが必要\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// https://stackoverflow.com/questions/50582769/windowsaccessbridge-for-java-automation-using-c-sharp\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eJabApi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWindows_run\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eDoEvents\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003e実行結果\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/be77a257b1d7bb8165b9aeca0808df127bb772fa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f64363363363236372d333862332d383331622d343566612d6232396362393162663134392e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd63c6267-38b3-831b-45fa-b29cb91bf149.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b1ad8b55dec1edbc4c5e9598b127c7e9\" alt=\"auto5.gif\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/d63c6267-38b3-831b-45fa-b29cb91bf149.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2Fd63c6267-38b3-831b-45fa-b29cb91bf149.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=475ae7b80545435cdaf7a347cc96ee12 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"powershellでの例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#powershell%E3%81%A7%E3%81%AE%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePowerShellでの例\u003c/h3\u003e\n\n\u003cp\u003eC#を基にPowerShellでも同じ操作を行うスクリプトが記述できます。\u003cbr\u003e\n使用しているJabApi.dllは\u003ca href=\"https://github.com/mima3/testjavagui/blob/master/out/JabApi.dll\" rel=\"nofollow noopener\" target=\"_blank\"\u003eダウンロード\u003c/a\u003eするか\u003ca href=\"https://github.com/mima3/testjavagui/tree/master/cs\" rel=\"nofollow noopener\" target=\"_blank\"\u003eソースコード\u003c/a\u003eからコンパイルしてください。\u003cbr\u003e\nGitHubに挙げたDLLは64bit+.NET2.0なので環境によっては使用できません。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e# 64bit前提\n$dllPath = Split-Path $MyInvocation.MyCommand.Path\nSet-Item Env:Path \"$Env:Path;$dllPath\"\nAdd-Type -Path \"$dllPath\\JabApi.dll\"\n[JabApiLib.JavaAccessBridge.JabHelpers]::init()\n$vmID = 0\n$javaTree = [JabApiLib.JavaAccessBridge.JabHelpers]::GetComponentTreeByTitle(\"ToDoリスト\",[ref]$vmID)\n$txt = $javaTree.children[0].children[1].children[0].children[0].children[1]\n[JabApiLib.JavaAccessBridge.JabApi]::setTextContents($vmID, $txt.acPtr, \"わろすわろす\")\n\n# クリック\n$button = $javaTree.children[0].children[1].children[0].children[0].children[2].children[0]\n[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $button.acPtr, \"クリック\")\n\n#\n[JabApiLib.JavaAccessBridge.JabApi]::setTextContents($vmID, $txt.acPtr, \"あああああ\")\n[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $button.acPtr, \"クリック\")\n\n#\n[JabApiLib.JavaAccessBridge.JabApi]::setTextContents($vmID, $txt.acPtr, \"いいいいい\")\n[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $button.acPtr, \"クリック\") \n\n# 更新の確認\n$javaTree = [JabApiLib.JavaAccessBridge.JabHelpers]::GetComponentTreeByTitle(\"ToDoリスト\",[ref]$vmID)\n$list = $javaTree.children[0].children[1].children[0].children[0].children[0].children[0].children[0]\nforeach($item in $list.children) {\n  Write-Host $item.name\n}\n[JabApiLib.JavaAccessBridge.JabHelpers]::DoAccessibleActions($vmID, $list.children[1].acPtr, \"クリック\") \n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"uipathの場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#uipath%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUIPathの場合\u003c/h1\u003e\n\n\u003cp\u003eツールからJava拡張機能をインストールすることでJavaのGUI操作が可能になります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/cb11dac34e2c77a912c4bb9859c21533458755f7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f33316165613435362d396266312d386465312d383836392d6433373835383132623463642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F31aea456-9bf1-8de1-8869-d3785812b4cd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3ffdf3d2277b86612c67ad3fa9f7913f\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/31aea456-9bf1-8de1-8869-d3785812b4cd.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F31aea456-9bf1-8de1-8869-d3785812b4cd.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1e71c445cf2b3e6eb1330e6330beec21 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n拡張機能をインストールすると「%JRE_HOME%\\bin\\」にUiPathJavaBridgeV8_x64.dllが、格納されます。\u003c/p\u003e\n\n\u003cp\u003e拡張機能をインストールすると、いつも通りに画面が作成できるようになります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/9ff76e866b730eabd6f79e4fce4a4d48f804991c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f31363834383333612d666236342d623135352d653531322d6662396230663334333430332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F1684833a-fb64-b155-e512-fb9b0f343403.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e743d3d9bb3a440c6bffe84f54ce65dc\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/1684833a-fb64-b155-e512-fb9b0f343403.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F47856%2F1684833a-fb64-b155-e512-fb9b0f343403.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0fc276d04c6cf18e89d2352beea891c1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e実行結果\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/7fced5e0aebdc8cb1ef5629f42208a084bbbb828/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f34373835362f63623063663837642d663536642d333931342d356237312d6331626338613562363930392e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/cb0cf87d-f56d-3914-5b71-c1bc8a5b6909.gif\" alt=\"auto6.gif\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/47856/cb0cf87d-f56d-3914-5b71-c1bc8a5b6909.gif\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"その他の選択肢\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E9%81%B8%E6%8A%9E%E8%82%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその他の選択肢\u003c/h1\u003e\n\n\u003cp\u003eGUIのテストフレームワークを利用して自動操作がおこなえるかもしれません。\u003cbr\u003e\n今回の目的と違っていたので、詳しくは調べていません。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"automation\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#automation\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAutomation\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/renatoathaydes/Automaton\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAutomation\u003c/a\u003eはSwingとJavaFxのGUIを簡単にテストできるフレームワークです。\u003c/p\u003e\n\n\u003cp\u003eJavaで記載することもできますが、下記のようなGroovyのスクリプトで記載することも可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"groovy\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eclickOn\u003c/span\u003e \u003cspan class=\"s1\"\u003e'text:Some Button'\u003c/span\u003e\n\u003cspan class=\"n\"\u003edoubleClickOn\u003c/span\u003e \u003cspan class=\"s1\"\u003e'username-input'\u003c/span\u003e\n\u003cspan class=\"n\"\u003etype\u003c/span\u003e \u003cspan class=\"s1\"\u003e'my-username'\u003c/span\u003e\n\u003cspan class=\"n\"\u003eclickOn\u003c/span\u003e \u003cspan class=\"s1\"\u003e'text:Login'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"testfx\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#testfx\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTestFX\u003c/h2\u003e\n\n\u003cp\u003eJavaFXのシンプルでクリーンなテストフレームワークです。\u003cbr\u003e\n\u003ca href=\"https://github.com/TestFX/TestFX\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/TestFX/TestFX\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"assertj-swing\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assertj-swing\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssertJ Swing\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"http://joel-costigliola.github.io/assertj/assertj-swing.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAssertJ Swing\u003c/a\u003eはSwingのGUIのテストが可能のようです。\u003cbr\u003e\n今はFest Swingをフォークしたものになります。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eJava Swing UI test driver replacement for Fest [closed]\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"https://stackoverflow.com/questions/31168990/java-swing-ui-test-driver-replacement-for-fest\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://stackoverflow.com/questions/31168990/java-swing-ui-test-driver-replacement-for-fest\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.atmarkit.co.jp/ait/articles/0605/31/news125.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSwingのキホンJFrameを使う\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/32700005/javafx-listview-add-and-edit-element\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJavafx Listview Add and edit element\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/52013505/how-do-i-use-javafx-11-in-eclipse\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHow do I use JavaFX 11 in Eclipse?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://skrb.hatenablog.com/entry/2018/05/29/210000\" rel=\"nofollow noopener\" target=\"_blank\"\u003eOpenJFX + OpenJDK で JavaFX を動かす\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/todu/items/bed6f733ca9df0cbec75\" id=\"reference-b00fe448ee611d6a665f\"\u003eUbuntu18.4でjava11とjavaFxの環境を整える\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/tarosa0001/items/05ac653a091b7d1290f9\" id=\"reference-c7e4e2a3a40a5ea1885a\"\u003e【超初心者向け】JavaFX超入門\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.oracle.com/javase/10/access/java-access-bridge-architecture.htm#JSACC-GUID-FAFC50E6-DEFD-4808-9E04-65AD717F33D6\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJava Access Bridge Architecture\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/31168990/java-swing-ui-test-driver-replacement-for-fest\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJava Swing UI test driver replacement for Fest [closed]\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/renatoathaydes/Automaton\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAutomation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://sites.google.com/a/athaydes.com/renato-athaydes/posts/twosimpletoolstoletyoutestyourswingjavafxapplicationseasily\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTwo simple tools to let you test your Swing/JavaFX applications easily\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/TestFX/TestFX\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTestFx\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/50582769/windowsaccessbridge-for-java-automation-using-c-sharp\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWindowsAccessBridge for Java Automation using C#\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2019-10-15T16:10:29Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"v0huVDkSheBlKX0qMAEccMBzxnpX0pvO4A==--iVhWbp7rqohRuO5f--Cq3/t29p1Zs+UDw84E2caQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-10-16T01:17:50Z","likesCount":15,"linkUrl":"https://qiita.com/mima_ita/items/702fdbdee30346b5738e","organization":null,"originalId":1048699,"stockedCount":18,"title":"Javaで作った画面をWindowsで自動操作する方法","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%88%E3%81%8C%E3%81%8D\"\u003eまえがき\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#java%E3%81%AE%E7%94%BB%E9%9D%A2%E3%81%AE%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95\"\u003eJavaの画面の作成方法\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#swing%E3%81%A7%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2\"\u003eSwingで作成した画面\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#javafx%E3%81%A7%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E7%94%BB%E9%9D%A2\"\u003eJavaFxで作成した画面\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#java11%E3%81%A7javafx%E3%81%AE%E7%94%BB%E9%9D%A2%E3%82%92%E4%BD%9C%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AE%E6%B3%A8%E6%84%8F\"\u003eJava11でJavaFxの画面を作る場合の注意\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#uiautomation%E3%81%AE%E8%87%AA%E5%8B%95%E6%93%8D%E4%BD%9C\"\u003eUIAutomationの自動操作\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#swing%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eSwingの場合：\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#javafx%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eJavaFxの場合：\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#javafx%E3%82%92uiautomation%E3%81%A7%E3%81%AE%E6%93%8D%E4%BD%9C%E6%99%82%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC\"\u003eJavaFxをUIAutomationでの操作時のエラー\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#java-access-bridge%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E8%87%AA%E5%8B%95%E6%93%8D%E4%BD%9C\"\u003eJava Access Bridgeを使用した自動操作\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#java-access-bridge%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9Fgui%E8%A6%81%E7%B4%A0%E3%81%AE%E6%8E%A2%E7%B4%A2\"\u003eJava Access Bridgeを使用したGUI要素の探索\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#net%E3%81%8B%E3%82%89%E3%81%AEjava-access-bridge%E3%81%AE%E6%93%8D%E4%BD%9C\"\u003e.NETからのJava Access Bridgeの操作\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#powershell%E3%81%A7%E3%81%AE%E4%BE%8B\"\u003ePowerShellでの例\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#uipath%E3%81%AE%E5%A0%B4%E5%90%88\"\u003eUIPathの場合\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E9%81%B8%E6%8A%9E%E8%82%A2\"\u003eその他の選択肢\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#automation\"\u003eAutomation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#testfx\"\u003eTestFX\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#assertj-swing\"\u003eAssertJ Swing\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":9608,"uuid":"702fdbdee30346b5738e","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"y9Dpcdj83yu/JCQ98Wp/o4DiR9M=--hGpafj0gzrLcXzM0--1aFSMrZY+Vp3rqEz77m5Jw==","originalId":47856,"description":"","facebookUrl":null,"githubUrl":"https://github.com/mima3","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/47856/0bc42d42eada368803d4098295f823130ecc5364/large.png?1571128517","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F47856%2F0bc42d42eada368803d4098295f823130ecc5364%2Flarge.png%3F1571128517?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=70713a14624753789e86c81ae02cf59f","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F47856%2F0bc42d42eada368803d4098295f823130ecc5364%2Flarge.png%3F1571128517?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=aaca39e8c7ebef06bbfb64132a188a53","urlName":"mima_ita","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"Java","urlName":"java"},{"name":"C#","urlName":"csharp"},{"name":"PowerShell","urlName":"powershell"},{"name":"自動化","urlName":"%e8%87%aa%e5%8b%95%e5%8c%96"},{"name":"UiPath","urlName":"uipath"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
