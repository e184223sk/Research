<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#でビルドタスクが書けるnukebuildについて - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/skitoy4321/items/6fe3714206d0bdbc9ddf" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="RTgUEOCTDj/ibKW8VRlxjnb0Wxls2Vczp0Q8xXMW+9StwE7nmfqeBKcEHLKbMFgKiNJ7ZrwYv40cmTk5ZmVATQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@skitoy4321" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#でビルドタスクが書けるnukebuildについて - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2Fmamc1UGpnNnZqZzRuamdyX2pncm5qZ3FfamdZem1tN2pqZ1pIamdvdHVkV3RsWW5WcGJHVGpnYXZqZ2FUamdZVGpnYVkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9OTNjMTNkOGVjNzM2OTQ4NmIzOTAwNjIzYTM5MjY2NmU&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE5yYVhSdmVUUXpNakUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1jY2M1MmMxZWFiYjkwYjFjMmY5ZTYyZjVkZDk3ZmU4Zg&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=5a2308e7ee4649a3bec642c112abdc1c"><meta property="og:description" content="

はじめに

以前CakeBuildについて記事を書いたが、同種のフレームワークとしてnukebuildというものを試したので、とりあえず入門的な記事を書く。

なお、本当の名前は&quot;nuke&quot;だが、同音異義語が世に溢れているため、こ..."><meta content="https://qiita.com/skitoy4321/items/6fe3714206d0bdbc9ddf" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Build,nukebuild" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-e8f4b4d4-0600-428f-af93-53ca5a905656"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fskitoy4321%2Fitems%2F6fe3714206d0bdbc9ddf">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fskitoy4321%2Fitems%2F6fe3714206d0bdbc9ddf">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-e8f4b4d4-0600-428f-af93-53ca5a905656">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-07-03T01:23:50.000+09:00","dateModified":"2020-07-07T19:49:31.000+09:00","headline":"C#でビルドタスクが書けるnukebuildについて","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2Fmamc1UGpnNnZqZzRuamdyX2pncm5qZ3FfamdZem1tN2pqZ1pIamdvdHVkV3RsWW5WcGJHVGpnYXZqZ2FUamdZVGpnYVkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9OTNjMTNkOGVjNzM2OTQ4NmIzOTAwNjIzYTM5MjY2NmU\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE5yYVhSdmVUUXpNakUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1jY2M1MmMxZWFiYjkwYjFjMmY5ZTYyZjVkZDk3ZmU4Zg\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=5a2308e7ee4649a3bec642c112abdc1c","mainEntityOfPage":"https://qiita.com/skitoy4321/items/6fe3714206d0bdbc9ddf","author":{"@type":"Person","address":"","email":null,"identifier":"skitoy4321","name":"skitoy4321","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F103253%2Fprofile-images%2F1526359222?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=9623ed561bd61ca207da0cb6419ba01d","url":"https://qiita.com/skitoy4321","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita&amp;utm_medium=header-banner">常にメンバーが開発しやすい環境を作るNewsPicksの組織作りとは</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"skitoy4321","type":"items","id":"6fe3714206d0bdbc9ddf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"常にメンバーが開発しやすい環境を作るNewsPicksの組織作りとは","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"skitoy4321","type":"items","id":"6fe3714206d0bdbc9ddf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"常にメンバーが開発しやすい環境を作るNewsPicksの組織作りとは","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"skitoy4321","type":"items","id":"6fe3714206d0bdbc9ddf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"常にメンバーが開発しやすい環境を作るNewsPicksの組織作りとは","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/skitoy4321/items/6fe3714206d0bdbc9ddf","location":"/skitoy4321/items/6fe3714206d0bdbc9ddf","scheme":"https","host":"qiita.com","port":null,"pathname":"/skitoy4321/items/6fe3714206d0bdbc9ddf","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"osqFqMj76mJvCAKwslGKONu0v66KdxRWa5fobrPeZI5KMt9fsZJ6WSpgu758eKO8JZKf0Vq2/OjQSu2Spq3fFw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-aedbee07-d8a5-4055-a75e-1d7428772d58"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/likers" class="css-1iupg5d">7</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">6</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6fe3714206d0bdbc9ddf/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/skitoy4321"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/103253/profile-images/1526359222" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/skitoy4321" class="css-10ougpm">@<!-- -->skitoy4321</a><div class="css-1ay9vb9"><span><meta content="2020-07-02T16:23:50Z"/><time dateTime="2020-07-07T10:49:31Z" class="css-m19uds">updated at 2020-07-07</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#でビルドタスクが書けるnukebuildについて</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/build" class="css-4czcte">Build</a><a href="/tags/nukebuild" class="css-4czcte">nukebuild</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>以前<a href="https://qiita.com/skitoy4321/items/e76b178dd7fca1fbbd8f" id="reference-06f7883b5f52998ec3ba">CakeBuild</a>について記事を書いたが、同種のフレームワークとして<a href="https://nuke.build/" rel="nofollow noopener" target="_blank">nukebuild</a>というものを試したので、とりあえず入門的な記事を書く。</p>

<p>なお、本当の名前は"nuke"だが、同音異義語が世に溢れているため、ここでは"nukebuild"と呼称する(<a href="https://www.dnnsoftware.com/" rel="nofollow noopener" target="_blank">dotnet nukeも既に存在してるし</a>)。</p>

<h1>
<span id="これは何か" class="fragment"></span><a href="#%E3%81%93%E3%82%8C%E3%81%AF%E4%BD%95%E3%81%8B"><i class="fa fa-link"></i></a>これは何か?</h1>

<p>CakeBuildのように、主にビルド用途に最適化された、指定したタスクを実行してくれるもの。<br>
nukebuildの本体はdotnetのライブラリであり、最終的にタスクを実行するのは普通のコンソールアプリである。<br>
つまり、特殊なプラグイン等を必要とせずに、<strong>既存のdotnet系に対する言語サポート(デバッグ、補完、nugetパッケージ)が受けられるということになる。</strong><br>
ただし、タスクの実行部分は専用のプラグインが存在する。</p>

<h1>
<span id="最初の実行" class="fragment"></span><a href="#%E6%9C%80%E5%88%9D%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>最初の実行</h1>

<p>まずは何もないディレクトリに移動し、下記を実行してみる</p>

<ol>
<li>
<code>dotnet tool install -g Nuke.GlobalTool</code>

<ul>
<li>"nuke"というコマンドが使えるようになる(使えない場合は、PATHに<code>$HOME/.dotnet/tools</code>を追加する)</li>
</ul>
</li>
<li>
<code>nuke</code>

<ul>
<li>下記のような質問を聞かれるので、答えていく

<ol>
<li>
<code>Could not find .nuke file. Do you want to setup a build? [y/n]</code>

<ul>
<li>ひな形を作るかの確認。<code>y</code>を入力してエンターして次へ</li>
</ul>
</li>
<li>Where should the build project be located?

<ul>
<li>どこにビルドタスクを記述するプロジェクトを作成するか。デフォルトでは<code>build</code>以下に作られる</li>
</ul>
</li>
<li>Which NUKE version should be used?

<ul>
<li>使用するnukebuildライブラリのバージョンを決める</li>
<li>特に何もなければ安定最新版を選ぶ</li>
</ul>
</li>
<li>Which solution should be the default?

<ul>
<li>タスク内で参照できるソリューションファイルがどこにあるか</li>
<li>存在しなければ"None"で問題ない</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
<li>
<code>nuke</code>

<ul>
<li>タスクが実行される</li>
<li>windowsで文字化けする場合は、ターミナルのコードページを"65001"に変更して実行する(出力にユニコード文字を使用しているため)</li>
</ul>
</li>
</ol>

<p>ひな形を作るかどうかは、カレントディレクトリに<code>.nuke</code>と<code>build.ps1</code>または<code>build.sh</code>いうファイルがあるかどうかで確認しているので、あれば質問は聞かれず、タスクを実行しようとする。</p>

<h2>
<span id="nukeglobaltool" class="fragment"></span><a href="#nukeglobaltool"><i class="fa fa-link"></i></a><a href="https://www.nuget.org/packages/Nuke.GlobalTool/0.24.11" rel="nofollow noopener" target="_blank">Nuke.GlobalTool</a>
</h2>

<p>nukebuildの実行を補助する <a href="https://docs.microsoft.com/ja-jp/dotnet/core/tools/global-tools" rel="nofollow noopener" target="_blank">dotnet global tool</a><br>
機能としては、</p>

<ul>
<li>テンプレートプロジェクトとブートストラッパーの作成</li>
<li>タスクの実行を行う

<ul>
<li>カレントディレクトリと上位ディレクトリを順番に見てbuild.ps1を探し、それを実行している</li>
</ul>
</li>
</ul>

<p>実は<strong>ひな形さえ作れば以後は無くても良い</strong></p>

<h2>
<span id="構成ファイル" class="fragment"></span><a href="#%E6%A7%8B%E6%88%90%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB"><i class="fa fa-link"></i></a>構成ファイル</h2>

<p>ひな形作成で作られるファイルには以下のようなものがある。</p>

<ul>
<li>.nuke

<ul>
<li>nukebuildを実行する時のルートディレクトリに置く</li>
<li>nukebuildはこのファイルがある場所をルートディレクトリと判断する</li>
</ul>
</li>
<li>build.ps1,build.sh

<ul>
<li>タスクを実行するためのブートストラッパー</li>
<li>build.ps1はpowershell用、build.shはbash用となる</li>
<li>dotnet sdkが無い場合はダウンロードを行って、そこからタスクを実行しようとする</li>
<li><strong>ひな形作成時に、タスクプロジェクトのcsprojへのパスがハードコードされるので、構成を変えるときは注意</strong></li>
<li>動作的には以下の事をしている

<ol>
<li>dotnet sdkが無ければDLして<code>.tmp</code>に展開</li>
<li>ハードコードされたcsprojをビルド</li>
<li>ビルドされたプロジェクトを実行</li>
</ol>
</li>
</ul>
</li>
<li>build/*

<ul>
<li>タスクプロジェクト(デフォルトだとこのパス)</li>
<li>中身は<a href="https://www.nuget.org/packages/Nuke.Common/" rel="nofollow noopener" target="_blank">Nuke.Common</a>を参照している</li>
<li>
<code>Nuke.Common.NukeBuild</code>を継承したクラス<code>Build</code>が作られているので、このクラス内にタスクを記述していく</li>
<li>一つのクラスにメンバーを追加していくことになるので、大規模になるならばpartialクラスにした方が良い</li>
</ul>
</li>
</ul>

<h1>
<span id="タスクの記述" class="fragment"></span><a href="#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E8%A8%98%E8%BF%B0"><i class="fa fa-link"></i></a>タスクの記述</h1>

<p>タスクはタスクプロジェクトのBuildクラス内に、<a href="https://www.nuke.build/api/Nuke.Common/Nuke.Common.Target.html" rel="nofollow noopener" target="_blank"><code>Nuke.Common.Target</code></a>のインスタンスを追加していって記述する。<br>
このTargetは定義としては <code>public delegate ITargetDefinition Target(ITargetDefinition definition)</code>というデリゲートなので、以下のようにTargetのインスタンスを記述する。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Build_MyTask.cs</span></div>
<div class="highlight"><pre><code><span class="c1">// 大元のBuildクラスをpartialクラスにしている前提</span>
<span class="k">using</span> <span class="nn">Nuke.Common</span><span class="p">;</span>
<span class="k">partial</span> <span class="k">class</span> <span class="nc">Build</span>
<span class="p">{</span>
    <span class="c1">// Executesの中の処理を実行する</span>
    <span class="c1">// Executesは必須ではなく、何もしないタスクを作ることも可能</span>
    <span class="n">Target</span> <span class="n">MyTask</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span>
        <span class="p">.</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"MyTask"</span><span class="p">));</span>
    <span class="c1">// 分解すると、以下のような意味になる</span>
    <span class="n">Target</span> <span class="n">MyTask2</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="n">Target</span> <span class="n">ret</span> <span class="p">=</span> <span class="p">(</span><span class="n">ITargetDefinition</span> <span class="n">t</span><span class="p">)</span> <span class="p">=&gt;</span>
            <span class="p">{</span> <span class="k">return</span> <span class="n">t</span><span class="p">.</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"MyTask"</span><span class="p">));</span> <span class="p">};</span>
            <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="タスクの実行" class="fragment"></span><a href="#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>タスクの実行</h2>

<p>タスクを記述した後、ブートストラッパー、あるいはビルドプロジェクトを実行すれば、タスクが実行される。デフォルトでは、Main関数に記述されているFuncで指定したタスクが実行される。</p>

<p>ヘルプを表示させたい場合は、コマンドライン引数に<code>--help</code>を指定すればOK<br>
ターゲットを指定する場合は、<code>--target [TargetA] [TargetB]</code>のように指定する。<br>
また、そのほかにも独自の引数を指定することができるが、それは後述する</p>

<h2>
<span id="タスクの依存関係" class="fragment"></span><a href="#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%BE%9D%E5%AD%98%E9%96%A2%E4%BF%82"><i class="fa fa-link"></i></a>タスクの依存関係</h2>

<p>例えば"Build"の前には"Restore"を成功させてほしい、"Publish"は"Build"が実行されていなくてもいいけど、必ず後に実行したい、等、タスクの実行順序と依存関係を制御したい場合は、Targetの定義時にITargetDefinitionで以下の操作を行う</p>

<h3>
<span id="itargetdefinition-dependsonparams-target-t" class="fragment"></span><a href="#itargetdefinition-dependsonparams-target-t"><i class="fa fa-link"></i></a><code>ITargetDefinition DependsOn(params Target[] t)</code>
</h3>

<p>指定したタスクを依存しているタスクとして登録する。こうすると、"t"が事前に実行されるようになり、かつ成功しない限り、そのタスクは実行されなくなる。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">DependsOn.cs</span></div>
<div class="highlight"><pre><code><span class="n">Target</span> <span class="n">TaskA</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskA"</span><span class="p">));</span>
<span class="n">Target</span> <span class="n">TaskB</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">DependsOn</span><span class="p">(</span><span class="n">TaskA</span><span class="p">).</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskB"</span><span class="p">));</span>
</code></pre></div>
</div>

<p>この状態でTaskBを実行しようとすると、かならずその前にTaskAが実行されるようになる。</p>

<h3>
<span id="itargetdefinition-dependentforparams-target-t" class="fragment"></span><a href="#itargetdefinition-dependentforparams-target-t"><i class="fa fa-link"></i></a><code>ITargetDefinition DependentFor(params Target[] t)</code>
</h3>

<p><code>DependsOn()</code>とは逆に、指定したタスクが自分に依存しているという登録を行う。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">DependentFor.cs</span></div>
<div class="highlight"><pre><code><span class="n">Target</span> <span class="n">TaskA</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskA"</span><span class="p">));</span>
<span class="n">Target</span> <span class="n">TaskB</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">DependentFor</span><span class="p">(</span><span class="n">TaskA</span><span class="p">).</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskB"</span><span class="p">));</span>
</code></pre></div>
</div>

<p>この状態でTaskBを実行してもTaskAは実行されないが、TaskAを実行しようとすると、必ずその前にTaskBが実行されるようになる</p>

<h3>
<span id="itargetdefinition-beforeparams-target-t" class="fragment"></span><a href="#itargetdefinition-beforeparams-target-t"><i class="fa fa-link"></i></a><code>ITargetDefinition Before(params Target[] t)</code>
</h3>

<p>指定したタスクに対して、依存関係は作成されないが、必ず引数指定したタスクよりも前に実行されることが保証されるようになる</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Before.cs</span></div>
<div class="highlight"><pre><code><span class="n">Target</span> <span class="n">TaskA</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskA"</span><span class="p">));</span>
<span class="n">Target</span> <span class="n">TaskB</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">Before</span><span class="p">(</span><span class="n">TaskA</span><span class="p">).</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskB"</span><span class="p">));</span>
</code></pre></div>
</div>

<p>この状態でTaskAを単独で実行してもTaskBは実行されないが、TaskAとTaskBを同時に実行しようとすると、必ずTaskBが先に実行されるようになる</p>

<h3>
<span id="itargetdefinition-afterparams-target-t" class="fragment"></span><a href="#itargetdefinition-afterparams-target-t"><i class="fa fa-link"></i></a><code>ITargetDefinition After(params Target[] t)</code>
</h3>

<p><code>Before()</code>とは逆に、指定したタスクに対して、依存関係は作成されないが、必ず引数指定したタスクよりも後に実行されることが保証されるようになる</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Before.cs</span></div>
<div class="highlight"><pre><code><span class="n">Target</span> <span class="n">TaskA</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskA"</span><span class="p">));</span>
<span class="n">Target</span> <span class="n">TaskB</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">After</span><span class="p">(</span><span class="n">TaskB</span><span class="p">).</span><span class="nf">Executes</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"TaskB"</span><span class="p">));</span>
</code></pre></div>
</div>

<p>この状態でTaskAを単独で実行してもTaskBは実行されないが、TaskAとTaskBを同時に実行しようとすると、必ずTaskAが先に実行されるようになる</p>

<h2>
<span id="必要条件の記述" class="fragment"></span><a href="#%E5%BF%85%E8%A6%81%E6%9D%A1%E4%BB%B6%E3%81%AE%E8%A8%98%E8%BF%B0"><i class="fa fa-link"></i></a>必要条件の記述</h2>

<p>あるタスクを実行する時、条件を満たしていないとエラーとして扱いたい場合、<code>ITargetDefinition Requires(params Expression&lt;Func&lt;bool&gt;&gt;[] conditions)</code>が使える。<br>
引数に指定した条件式はタスク実行前に評価され、falseならばエラーとして処理される</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Requires.cs</span></div>
<div class="highlight"><pre><code><span class="p">[</span><span class="nf">Parameter</span><span class="p">(</span><span class="s">"Hoge"</span><span class="p">)]</span>
<span class="k">readonly</span> <span class="kt">string</span> <span class="n">Hoge</span><span class="p">;</span>
<span class="n">Target</span> <span class="n">TaskA</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">Requires</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">Hoge</span><span class="p">));</span>
</code></pre></div>
</div>

<p>上記でパラメーター無しでTaskAを実行しようとすると、Hogeが空なのでエラーで終わる。</p>

<h2>
<span id="特定の条件の時のみの実行" class="fragment"></span><a href="#%E7%89%B9%E5%AE%9A%E3%81%AE%E6%9D%A1%E4%BB%B6%E3%81%AE%E6%99%82%E3%81%AE%E3%81%BF%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>特定の条件の時のみの実行</h2>

<p>ある条件を満たした時のみタスクを実行したい場合、<code>ITargetDefinition OnlyWhenStatic(params Expression&lt;Func&lt;bool&gt;&gt;[] conditions)</code>または<code>ITargetDefinition OnlyWhenStatic(params Expression&lt;Func&lt;bool&gt;&gt;[] conditions)</code>が使用できる。</p>

<p>見た目はほぼ同じだが、OnlyWhenDynamicは、該当タスク実行直前に評価され、OnlyWhenStaticは、全てのタスク実行の前に一回だけ評価される。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">OnlyWhen.cs</span></div>
<div class="highlight"><pre><code><span class="p">[</span><span class="nf">Parameter</span><span class="p">(</span><span class="s">"Hoge"</span><span class="p">)]</span>
<span class="kt">string</span> <span class="n">Hoge</span><span class="p">;</span>
<span class="n">Target</span> <span class="n">TaskA</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">OnlyWhenDynamic</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">Hoge</span><span class="p">));</span>
<span class="n">Target</span> <span class="n">TaskB</span> <span class="p">=&gt;</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">_</span><span class="p">.</span><span class="nf">OnlyWhenStatic</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">Hoge</span><span class="p">));</span>
</code></pre></div>
</div>

<p>上記でパラメーター無しでTaskBを実行しようとすると、TaskBの実行はスキップされる。<br>
TaskAの場合は、TaskAより前に実行される他のタスクで値が設定された場合、実行はスキップされない。</p>

<h2>
<span id="イベントのフック" class="fragment"></span><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%83%95%E3%83%83%E3%82%AF"><i class="fa fa-link"></i></a>イベントのフック</h2>

<p>初期化やクリーンアップ等、ターゲット実行の前や後に処理を割り込ませたい場合は、イベントのフック機能を使う。<br>
基本的にBuildクラスの中で各種イベントをオーバーライドすればOK。<br>
実際よく使うのは、OnBuildInitialized(コマンドライン引数の解釈、各種タスクのセットアップが完了した後に一回実行される)、OnBuildFinished(全ての処理の後に実行される)だと思う。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Event.cs</span></div>
<div class="highlight"><pre><code><span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnBuildInitialized</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"on build initialized"</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnBuildFinished</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Logger</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"on build finished"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="パラメーターの追加" class="fragment"></span><a href="#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AE%E8%BF%BD%E5%8A%A0"><i class="fa fa-link"></i></a>パラメーターの追加</h2>

<p>コマンドライン引数にはデフォルトで指定できるもの(<code>--target</code>,<code>--help</code>等)があるが、さらに追加で指定することも可能。<br>
やり方としては、Buildクラスのメンバーに、<code>Nuke.Common.ParameterAttribute</code>を持ったプロパティまたはフィールドを追加すること。<br>
ひな形にも記述があるが、以下のようにする。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Parameter.cs</span></div>
<div class="highlight"><pre><code><span class="p">[</span><span class="nf">Parameter</span><span class="p">(</span><span class="s">"--helpで表示される文章の記述"</span><span class="p">)]</span>
<span class="k">readonly</span> <span class="kt">string</span> <span class="n">MyParameter1</span> <span class="p">=</span> <span class="s">"デフォルト値"</span><span class="p">;</span> <span class="c1">// デフォルト値が無ければdefault(T)が使われる</span>
</code></pre></div>
</div>

<p>サポートされる型は、デフォルトではstring、プリミティブ型と、その配列型、nullable型をカバーしている。独自型のサポートは後述。<br>
パラメーターの名前は、基本的にプロパティ/フィールド名をもとに決定されるが、CamelCaseを名前に指定した場合は、kebab-caseに自動的に変換される。<br>
つまり、上記の場合は、パラメーター名が<code>--my-parameter1</code>となる。<br>
なお、大文字小文字は区別しない。</p>

<p>配列を渡したい場合は、受け取るパラメーター型を配列型にして、該当引数の後に複数の値を渡せばOK。<br>
nukebuildでは、次のパラメーター指定が始まるまで、以降の引数全てをパラメーターの引数と解釈するようになっている。</p>

<p>例えば <code>[Parameter("")]readonly int[] MyParameter1 = new int[0];</code>のように指定して、<code>--my-parameter1 1 2 3</code>のように指定すると、MyParameter1には1,2,3の値が入る</p>

<h3>
<span id="独自パラメーター型の追加" class="fragment"></span><a href="#%E7%8B%AC%E8%87%AA%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%9E%8B%E3%81%AE%E8%BF%BD%E5%8A%A0"><i class="fa fa-link"></i></a>独自パラメーター型の追加</h3>

<p>パラメーターに独自の型をサポートしたい場合、その型を<code>System.ComponentModel.TypeConverter</code>を使って、stringから型変換可能にしておく必要がある。</p>

<p>独自型の宣言では以下のように実装する</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">TypeConverter.cs</span></div>
<div class="highlight"><pre><code><span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="c1">// この属性を追加して、型変換の時は指定のTypeConverterを使うようにする</span>
<span class="p">[</span><span class="nf">TypeConverter</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">MyParameterType</span><span class="p">.</span><span class="n">MyTypeConverter</span><span class="p">))]</span>
<span class="k">class</span> <span class="nc">MyParameterType</span>
<span class="p">{</span>
    <span class="c1">// System.ComponentModel.TypeConverterを継承したクラスを作成する</span>
    <span class="k">class</span> <span class="nc">MyTypeConverter</span> <span class="p">:</span> <span class="n">TypeConverter</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">CanConvertFrom</span><span class="p">(</span><span class="n">ITypeDescriptorContext</span> <span class="n">context</span><span class="p">,</span> <span class="n">Type</span> <span class="n">sourceType</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// string型の変換を受け付けられるようにしておく</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sourceType</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="kt">string</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="k">override</span> <span class="kt">object</span> <span class="nf">ConvertFrom</span><span class="p">(</span><span class="n">ITypeDescriptorContext</span> <span class="n">context</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Globalization</span><span class="p">.</span><span class="n">CultureInfo</span> <span class="n">culture</span><span class="p">,</span> <span class="kt">object</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 実際の変換処理</span>
            <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="k">value</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">ret</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MyParameterType</span><span class="p">();</span>
            <span class="n">ret</span><span class="p">.</span><span class="n">Hoge</span> <span class="p">=</span> <span class="n">str</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Hoge</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>後は、パラメーターの型に指定した値を入れるだけでOK。</p>

<h2>
<span id="ファイルパスの構築" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%91%E3%82%B9%E3%81%AE%E6%A7%8B%E7%AF%89"><i class="fa fa-link"></i></a>ファイルパスの構築</h2>

<p>ファイルパスの構築は、<a href="https://nuke.build/api/Nuke.Common/Nuke.Common.IO.AbsolutePath.html?q=AbsolutePath" rel="nofollow noopener" target="_blank">AbolutePath</a>または<a href="https://nuke.build/api/Nuke.Common/Nuke.Common.IO.RelativePath.html?q=RelativePath" rel="nofollow noopener" target="_blank">RelativePath</a>を使用する。<br>
どちらも'/'をオーバーロードしているため、'/'で繋げてパス構築が可能。<br>
文字列に出力する際に、プラットフォーム固有の区切り文字へ変更してくれる。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code><span class="c1">// 使用する際はnewではなくstringからのキャストを使用する</span>
<span class="kt">var</span> <span class="n">rootpath</span> <span class="p">=</span> <span class="p">(</span><span class="n">AbsolutePath</span><span class="p">)</span><span class="s">"c:/"</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">path_a</span> <span class="p">=</span> <span class="n">rootpath</span> <span class="p">/</span> <span class="s">"a"</span><span class="p">;</span> <span class="c1">// c:\a</span>
<span class="kt">var</span> <span class="n">path_b</span> <span class="p">=</span> <span class="n">path_a</span> <span class="p">/</span> <span class="s">"b"</span><span class="p">;</span> <span class="c1">// c:\a\b</span>
</code></pre></div></div>

<p>デフォルトでは、<code>AbsolutePath RootDirectory</code>というプロパティがBuildクラスで使用できるので、各種タスクの起点をここに設定するといいと思う。</p>

<h1>
<span id="よく使う機能" class="fragment"></span><a href="#%E3%82%88%E3%81%8F%E4%BD%BF%E3%81%86%E6%A9%9F%E8%83%BD"><i class="fa fa-link"></i></a>よく使う機能</h1>

<h2>
<span id="filesystemtasks" class="fragment"></span><a href="#filesystemtasks"><i class="fa fa-link"></i></a><a href="https://nuke.build/api/Nuke.Common/Nuke.Common.IO.FileSystemTasks.html" rel="nofollow noopener" target="_blank">FileSystemTasks</a>
</h2>

<p>ファイルコピー、作成、移動のユーティリティ。<br>
なお、ファイル検索に関しては<a href="https://nuke.build/api/Nuke.Common/Nuke.Common.IO.PathConstruction.html" rel="nofollow noopener" target="_blank">PathConstruction</a>のGlobFiles等を使用する。</p>

<h2>
<span id="processtasks" class="fragment"></span><a href="#processtasks"><i class="fa fa-link"></i></a><a href="https://nuke.build/api/Nuke.Common/Nuke.Common.Tooling.ProcessTasks.html" rel="nofollow noopener" target="_blank">ProcessTasks</a>
</h2>

<p>プロセス起動等のユーティリティ。<br>
<code>ToolSettings</code>は直接インスタンス化できないので、基本的には引数が沢山あるバージョンを使うことになる。<br>
<strong>実行時のワーキングディレクトリはRootDirectoryと一致しない場合があるので、workingDirectoryの指定はしておいた方が良い。</strong></p>

<h2>
<span id="msbuildtasks" class="fragment"></span><a href="#msbuildtasks"><i class="fa fa-link"></i></a><a href="https://nuke.build/api/Nuke.Common/Nuke.Common.Tools.MSBuild.MSBuildTasks.html" rel="nofollow noopener" target="_blank">MSBuildTasks</a>
</h2>

<p>MSBuildを実行するための補助を行う。ここで使用するMSBuildは、VisualStudioあるいはmonoが持つものであり、dotnet sdkとは異なるものになることに注意。<br>
実行パターンは複数あるが、最もよく使うのは<code>MSBuild(Configure&lt;MSBuildSettings&gt; configure)</code>だろうか。<br>
<code>Configure&lt;MSBuildSettings&gt;</code>とは、要するに<code>Func&lt;MSBuildSettings, MSBuildSettings&gt;</code>のようなものである。<br>
とりあえず<code>SetProjectFile(string)</code>は必須で、さらに使用するVSのバージョンを限定したい場合は、<code>SetMSBuildVersion()</code>、ビルドアーキテクチャを指定したい場合は、<code>SetTargetPlatform()</code>を実行することになる。</p>

<h2>
<span id="compressiontasks" class="fragment"></span><a href="#compressiontasks"><i class="fa fa-link"></i></a><a href="https://nuke.build/api/Nuke.Common/Nuke.Common.IO.CompressionTasks.html" rel="nofollow noopener" target="_blank">CompressionTasks</a>
</h2>

<p>zip,tar,gz,bz2等、圧縮・伸長等を行うユーティリティ。<br>
xzや7zに関してはサポートしていないので、別途処理を用意する必要がある。</p>

<h1>
<span id="終わりに" class="fragment"></span><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>終わりに</h1>

<p>とりあえずここまで書けば、基本的なタスクというのは書けると思う。<br>
公式ドキュメントを参考にしながら記述すること。ここで紹介していない便利機能もあるので、<br>
一回は見てみると良い。</p>

<p>本当はcakebuildとの比較を書きたかったが、この記事が長くなってしまったので宿題とする。</p>

<h2>
<span id="参考リンク" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E3%83%AA%E3%83%B3%E3%82%AF"><i class="fa fa-link"></i></a>参考リンク</h2>

<ul>
<li><a href="https://nuke.build" rel="nofollow noopener" target="_blank">公式サイト</a></li>
<li><a href="https://nuke.build/docs/getting-started/philosophy.html" rel="nofollow noopener" target="_blank">ドキュメント</a></li>
<li><a href="https://nuke.build/api/Nuke.Common/Nuke.Common.ControlFlow.html" rel="nofollow noopener" target="_blank">APIリファレンス</a></li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fskitoy4321%2Fitems%2F6fe3714206d0bdbc9ddf&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fskitoy4321%2Fitems%2F6fe3714206d0bdbc9ddf&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/likers" class="css-1iupg5d">7</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">6</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/6fe3714206d0bdbc9ddf/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/skitoy4321/items/6fe3714206d0bdbc9ddf.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-aedbee07-d8a5-4055-a75e-1d7428772d58">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-f0967708-002b-4888-b3ce-ffe516dc0995"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-f0967708-002b-4888-b3ce-ffe516dc0995">{}</script>
      
<div id="LoginModal-react-component-abd9a6f4-1956-47cf-bd0a-b9ae1cebd0e4"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-abd9a6f4-1956-47cf-bd0a-b9ae1cebd0e4">{}</script>
      
<div id="StockModal-react-component-fc08b538-9fdb-4420-b0c3-151d961d1496"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-fc08b538-9fdb-4420-b0c3-151d961d1496">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;MWwSyRAna0aQ8aNeivnVhdEp40nvU5TqqYgpBkjpDlfZlEg+aU77fdWZGlBE0PwBLw/DNj+SfFQSVSz6XZq1zg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e以前\u003ca href=\"https://qiita.com/skitoy4321/items/e76b178dd7fca1fbbd8f\" id=\"reference-06f7883b5f52998ec3ba\"\u003eCakeBuild\u003c/a\u003eについて記事を書いたが、同種のフレームワークとして\u003ca href=\"https://nuke.build/\" rel=\"nofollow noopener\" target=\"_blank\"\u003enukebuild\u003c/a\u003eというものを試したので、とりあえず入門的な記事を書く。\u003c/p\u003e\n\n\u003cp\u003eなお、本当の名前は\"nuke\"だが、同音異義語が世に溢れているため、ここでは\"nukebuild\"と呼称する(\u003ca href=\"https://www.dnnsoftware.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003edotnet nukeも既に存在してるし\u003c/a\u003e)。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"これは何か\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%93%E3%82%8C%E3%81%AF%E4%BD%95%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eこれは何か?\u003c/h1\u003e\n\n\u003cp\u003eCakeBuildのように、主にビルド用途に最適化された、指定したタスクを実行してくれるもの。\u003cbr\u003e\nnukebuildの本体はdotnetのライブラリであり、最終的にタスクを実行するのは普通のコンソールアプリである。\u003cbr\u003e\nつまり、特殊なプラグイン等を必要とせずに、\u003cstrong\u003e既存のdotnet系に対する言語サポート(デバッグ、補完、nugetパッケージ)が受けられるということになる。\u003c/strong\u003e\u003cbr\u003e\nただし、タスクの実行部分は専用のプラグインが存在する。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"最初の実行\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%88%9D%E3%81%AE%E5%AE%9F%E8%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最初の実行\u003c/h1\u003e\n\n\u003cp\u003eまずは何もないディレクトリに移動し、下記を実行してみる\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003edotnet tool install -g Nuke.GlobalTool\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e\"nuke\"というコマンドが使えるようになる(使えない場合は、PATHに\u003ccode\u003e$HOME/.dotnet/tools\u003c/code\u003eを追加する)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003enuke\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e下記のような質問を聞かれるので、答えていく\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003eCould not find .nuke file. Do you want to setup a build? [y/n]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eひな形を作るかの確認。\u003ccode\u003ey\u003c/code\u003eを入力してエンターして次へ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWhere should the build project be located?\n\n\u003cul\u003e\n\u003cli\u003eどこにビルドタスクを記述するプロジェクトを作成するか。デフォルトでは\u003ccode\u003ebuild\u003c/code\u003e以下に作られる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWhich NUKE version should be used?\n\n\u003cul\u003e\n\u003cli\u003e使用するnukebuildライブラリのバージョンを決める\u003c/li\u003e\n\u003cli\u003e特に何もなければ安定最新版を選ぶ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWhich solution should be the default?\n\n\u003cul\u003e\n\u003cli\u003eタスク内で参照できるソリューションファイルがどこにあるか\u003c/li\u003e\n\u003cli\u003e存在しなければ\"None\"で問題ない\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003enuke\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eタスクが実行される\u003c/li\u003e\n\u003cli\u003ewindowsで文字化けする場合は、ターミナルのコードページを\"65001\"に変更して実行する(出力にユニコード文字を使用しているため)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eひな形を作るかどうかは、カレントディレクトリに\u003ccode\u003e.nuke\u003c/code\u003eと\u003ccode\u003ebuild.ps1\u003c/code\u003eまたは\u003ccode\u003ebuild.sh\u003c/code\u003eいうファイルがあるかどうかで確認しているので、あれば質問は聞かれず、タスクを実行しようとする。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"nukeglobaltool\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#nukeglobaltool\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://www.nuget.org/packages/Nuke.GlobalTool/0.24.11\" rel=\"nofollow noopener\" target=\"_blank\"\u003eNuke.GlobalTool\u003c/a\u003e\n\u003c/h2\u003e\n\n\u003cp\u003enukebuildの実行を補助する \u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/core/tools/global-tools\" rel=\"nofollow noopener\" target=\"_blank\"\u003edotnet global tool\u003c/a\u003e\u003cbr\u003e\n機能としては、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eテンプレートプロジェクトとブートストラッパーの作成\u003c/li\u003e\n\u003cli\u003eタスクの実行を行う\n\n\u003cul\u003e\n\u003cli\u003eカレントディレクトリと上位ディレクトリを順番に見てbuild.ps1を探し、それを実行している\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e実は\u003cstrong\u003eひな形さえ作れば以後は無くても良い\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"構成ファイル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A7%8B%E6%88%90%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e構成ファイル\u003c/h2\u003e\n\n\u003cp\u003eひな形作成で作られるファイルには以下のようなものがある。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e.nuke\n\n\u003cul\u003e\n\u003cli\u003enukebuildを実行する時のルートディレクトリに置く\u003c/li\u003e\n\u003cli\u003enukebuildはこのファイルがある場所をルートディレクトリと判断する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ebuild.ps1,build.sh\n\n\u003cul\u003e\n\u003cli\u003eタスクを実行するためのブートストラッパー\u003c/li\u003e\n\u003cli\u003ebuild.ps1はpowershell用、build.shはbash用となる\u003c/li\u003e\n\u003cli\u003edotnet sdkが無い場合はダウンロードを行って、そこからタスクを実行しようとする\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eひな形作成時に、タスクプロジェクトのcsprojへのパスがハードコードされるので、構成を変えるときは注意\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e動作的には以下の事をしている\n\n\u003col\u003e\n\u003cli\u003edotnet sdkが無ければDLして\u003ccode\u003e.tmp\u003c/code\u003eに展開\u003c/li\u003e\n\u003cli\u003eハードコードされたcsprojをビルド\u003c/li\u003e\n\u003cli\u003eビルドされたプロジェクトを実行\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ebuild/*\n\n\u003cul\u003e\n\u003cli\u003eタスクプロジェクト(デフォルトだとこのパス)\u003c/li\u003e\n\u003cli\u003e中身は\u003ca href=\"https://www.nuget.org/packages/Nuke.Common/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eNuke.Common\u003c/a\u003eを参照している\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eNuke.Common.NukeBuild\u003c/code\u003eを継承したクラス\u003ccode\u003eBuild\u003c/code\u003eが作られているので、このクラス内にタスクを記述していく\u003c/li\u003e\n\u003cli\u003e一つのクラスにメンバーを追加していくことになるので、大規模になるならばpartialクラスにした方が良い\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"タスクの記述\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E8%A8%98%E8%BF%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタスクの記述\u003c/h1\u003e\n\n\u003cp\u003eタスクはタスクプロジェクトのBuildクラス内に、\u003ca href=\"https://www.nuke.build/api/Nuke.Common/Nuke.Common.Target.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003ccode\u003eNuke.Common.Target\u003c/code\u003e\u003c/a\u003eのインスタンスを追加していって記述する。\u003cbr\u003e\nこのTargetは定義としては \u003ccode\u003epublic delegate ITargetDefinition Target(ITargetDefinition definition)\u003c/code\u003eというデリゲートなので、以下のようにTargetのインスタンスを記述する。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eBuild_MyTask.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 大元のBuildクラスをpartialクラスにしている前提\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eNuke.Common\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBuild\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Executesの中の処理を実行する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Executesは必須ではなく、何もしないタスクを作ることも可能\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eMyTask\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MyTask\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 分解すると、以下のような意味になる\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eMyTask2\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eget\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eITargetDefinition\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MyTask\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"タスクの実行\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E5%AE%9F%E8%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタスクの実行\u003c/h2\u003e\n\n\u003cp\u003eタスクを記述した後、ブートストラッパー、あるいはビルドプロジェクトを実行すれば、タスクが実行される。デフォルトでは、Main関数に記述されているFuncで指定したタスクが実行される。\u003c/p\u003e\n\n\u003cp\u003eヘルプを表示させたい場合は、コマンドライン引数に\u003ccode\u003e--help\u003c/code\u003eを指定すればOK\u003cbr\u003e\nターゲットを指定する場合は、\u003ccode\u003e--target [TargetA] [TargetB]\u003c/code\u003eのように指定する。\u003cbr\u003e\nまた、そのほかにも独自の引数を指定することができるが、それは後述する\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"タスクの依存関係\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%BE%9D%E5%AD%98%E9%96%A2%E4%BF%82\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタスクの依存関係\u003c/h2\u003e\n\n\u003cp\u003e例えば\"Build\"の前には\"Restore\"を成功させてほしい、\"Publish\"は\"Build\"が実行されていなくてもいいけど、必ず後に実行したい、等、タスクの実行順序と依存関係を制御したい場合は、Targetの定義時にITargetDefinitionで以下の操作を行う\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"itargetdefinition-dependsonparams-target-t\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#itargetdefinition-dependsonparams-target-t\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eITargetDefinition DependsOn(params Target[] t)\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e指定したタスクを依存しているタスクとして登録する。こうすると、\"t\"が事前に実行されるようになり、かつ成功しない限り、そのタスクは実行されなくなる。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eDependsOn.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskA\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskB\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDependsOn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskB\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこの状態でTaskBを実行しようとすると、かならずその前にTaskAが実行されるようになる。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"itargetdefinition-dependentforparams-target-t\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#itargetdefinition-dependentforparams-target-t\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eITargetDefinition DependentFor(params Target[] t)\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eDependsOn()\u003c/code\u003eとは逆に、指定したタスクが自分に依存しているという登録を行う。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eDependentFor.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskA\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskB\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDependentFor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskB\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこの状態でTaskBを実行してもTaskAは実行されないが、TaskAを実行しようとすると、必ずその前にTaskBが実行されるようになる\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"itargetdefinition-beforeparams-target-t\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#itargetdefinition-beforeparams-target-t\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eITargetDefinition Before(params Target[] t)\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e指定したタスクに対して、依存関係は作成されないが、必ず引数指定したタスクよりも前に実行されることが保証されるようになる\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eBefore.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskA\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskB\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eBefore\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskB\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこの状態でTaskAを単独で実行してもTaskBは実行されないが、TaskAとTaskBを同時に実行しようとすると、必ずTaskBが先に実行されるようになる\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"itargetdefinition-afterparams-target-t\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#itargetdefinition-afterparams-target-t\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eITargetDefinition After(params Target[] t)\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eBefore()\u003c/code\u003eとは逆に、指定したタスクに対して、依存関係は作成されないが、必ず引数指定したタスクよりも後に実行されることが保証されるようになる\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eBefore.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskA\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskB\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAfter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTaskB\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eExecutes\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"TaskB\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこの状態でTaskAを単独で実行してもTaskBは実行されないが、TaskAとTaskBを同時に実行しようとすると、必ずTaskAが先に実行されるようになる\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"必要条件の記述\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BF%85%E8%A6%81%E6%9D%A1%E4%BB%B6%E3%81%AE%E8%A8%98%E8%BF%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e必要条件の記述\u003c/h2\u003e\n\n\u003cp\u003eあるタスクを実行する時、条件を満たしていないとエラーとして扱いたい場合、\u003ccode\u003eITargetDefinition Requires(params Expression\u0026lt;Func\u0026lt;bool\u0026gt;\u0026gt;[] conditions)\u003c/code\u003eが使える。\u003cbr\u003e\n引数に指定した条件式はタスク実行前に評価され、falseならばエラーとして処理される\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eRequires.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Hoge\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n\u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRequires\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e上記でパラメーター無しでTaskAを実行しようとすると、Hogeが空なのでエラーで終わる。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"特定の条件の時のみの実行\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%89%B9%E5%AE%9A%E3%81%AE%E6%9D%A1%E4%BB%B6%E3%81%AE%E6%99%82%E3%81%AE%E3%81%BF%E3%81%AE%E5%AE%9F%E8%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e特定の条件の時のみの実行\u003c/h2\u003e\n\n\u003cp\u003eある条件を満たした時のみタスクを実行したい場合、\u003ccode\u003eITargetDefinition OnlyWhenStatic(params Expression\u0026lt;Func\u0026lt;bool\u0026gt;\u0026gt;[] conditions)\u003c/code\u003eまたは\u003ccode\u003eITargetDefinition OnlyWhenStatic(params Expression\u0026lt;Func\u0026lt;bool\u0026gt;\u0026gt;[] conditions)\u003c/code\u003eが使用できる。\u003c/p\u003e\n\n\u003cp\u003e見た目はほぼ同じだが、OnlyWhenDynamicは、該当タスク実行直前に評価され、OnlyWhenStaticは、全てのタスク実行の前に一回だけ評価される。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eOnlyWhen.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Hoge\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskA\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnlyWhenDynamic\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e \u003cspan class=\"n\"\u003eTaskB\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnlyWhenStatic\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e上記でパラメーター無しでTaskBを実行しようとすると、TaskBの実行はスキップされる。\u003cbr\u003e\nTaskAの場合は、TaskAより前に実行される他のタスクで値が設定された場合、実行はスキップされない。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"イベントのフック\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%83%95%E3%83%83%E3%82%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eイベントのフック\u003c/h2\u003e\n\n\u003cp\u003e初期化やクリーンアップ等、ターゲット実行の前や後に処理を割り込ませたい場合は、イベントのフック機能を使う。\u003cbr\u003e\n基本的にBuildクラスの中で各種イベントをオーバーライドすればOK。\u003cbr\u003e\n実際よく使うのは、OnBuildInitialized(コマンドライン引数の解釈、各種タスクのセットアップが完了した後に一回実行される)、OnBuildFinished(全ての処理の後に実行される)だと思う。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eEvent.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnBuildInitialized\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"on build initialized\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnBuildFinished\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"on build finished\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"パラメーターの追加\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AE%E8%BF%BD%E5%8A%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパラメーターの追加\u003c/h2\u003e\n\n\u003cp\u003eコマンドライン引数にはデフォルトで指定できるもの(\u003ccode\u003e--target\u003c/code\u003e,\u003ccode\u003e--help\u003c/code\u003e等)があるが、さらに追加で指定することも可能。\u003cbr\u003e\nやり方としては、Buildクラスのメンバーに、\u003ccode\u003eNuke.Common.ParameterAttribute\u003c/code\u003eを持ったプロパティまたはフィールドを追加すること。\u003cbr\u003e\nひな形にも記述があるが、以下のようにする。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eParameter.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"--helpで表示される文章の記述\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n\u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eMyParameter1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"デフォルト値\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// デフォルト値が無ければdefault(T)が使われる\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eサポートされる型は、デフォルトではstring、プリミティブ型と、その配列型、nullable型をカバーしている。独自型のサポートは後述。\u003cbr\u003e\nパラメーターの名前は、基本的にプロパティ/フィールド名をもとに決定されるが、CamelCaseを名前に指定した場合は、kebab-caseに自動的に変換される。\u003cbr\u003e\nつまり、上記の場合は、パラメーター名が\u003ccode\u003e--my-parameter1\u003c/code\u003eとなる。\u003cbr\u003e\nなお、大文字小文字は区別しない。\u003c/p\u003e\n\n\u003cp\u003e配列を渡したい場合は、受け取るパラメーター型を配列型にして、該当引数の後に複数の値を渡せばOK。\u003cbr\u003e\nnukebuildでは、次のパラメーター指定が始まるまで、以降の引数全てをパラメーターの引数と解釈するようになっている。\u003c/p\u003e\n\n\u003cp\u003e例えば \u003ccode\u003e[Parameter(\"\")]readonly int[] MyParameter1 = new int[0];\u003c/code\u003eのように指定して、\u003ccode\u003e--my-parameter1 1 2 3\u003c/code\u003eのように指定すると、MyParameter1には1,2,3の値が入る\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"独自パラメーター型の追加\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%8B%AC%E8%87%AA%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%9E%8B%E3%81%AE%E8%BF%BD%E5%8A%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e独自パラメーター型の追加\u003c/h3\u003e\n\n\u003cp\u003eパラメーターに独自の型をサポートしたい場合、その型を\u003ccode\u003eSystem.ComponentModel.TypeConverter\u003c/code\u003eを使って、stringから型変換可能にしておく必要がある。\u003c/p\u003e\n\n\u003cp\u003e独自型の宣言では以下のように実装する\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eTypeConverter.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.ComponentModel\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// この属性を追加して、型変換の時は指定のTypeConverterを使うようにする\u003c/span\u003e\n\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eTypeConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etypeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMyParameterType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMyTypeConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e))]\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyParameterType\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// System.ComponentModel.TypeConverterを継承したクラスを作成する\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyTypeConverter\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eTypeConverter\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eCanConvertFrom\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eITypeDescriptorContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"n\"\u003esourceType\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// string型の変換を受け付けられるようにしておく\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esourceType\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003etypeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertFrom\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eITypeDescriptorContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGlobalization\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInfo\u003c/span\u003e \u003cspan class=\"n\"\u003eculture\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 実際の変換処理\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMyParameterType\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHoge\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e後は、パラメーターの型に指定した値を入れるだけでOK。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ファイルパスの構築\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%91%E3%82%B9%E3%81%AE%E6%A7%8B%E7%AF%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイルパスの構築\u003c/h2\u003e\n\n\u003cp\u003eファイルパスの構築は、\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.IO.AbsolutePath.html?q=AbsolutePath\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAbolutePath\u003c/a\u003eまたは\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.IO.RelativePath.html?q=RelativePath\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRelativePath\u003c/a\u003eを使用する。\u003cbr\u003e\nどちらも'/'をオーバーロードしているため、'/'で繋げてパス構築が可能。\u003cbr\u003e\n文字列に出力する際に、プラットフォーム固有の区切り文字へ変更してくれる。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 使用する際はnewではなくstringからのキャストを使用する\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erootpath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAbsolutePath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"s\"\u003e\"c:/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epath_a\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erootpath\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"s\"\u003e\"a\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// c:\\a\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epath_b\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epath_a\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"s\"\u003e\"b\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// c:\\a\\b\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eデフォルトでは、\u003ccode\u003eAbsolutePath RootDirectory\u003c/code\u003eというプロパティがBuildクラスで使用できるので、各種タスクの起点をここに設定するといいと思う。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"よく使う機能\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%88%E3%81%8F%E4%BD%BF%E3%81%86%E6%A9%9F%E8%83%BD\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eよく使う機能\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"filesystemtasks\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#filesystemtasks\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.IO.FileSystemTasks.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eFileSystemTasks\u003c/a\u003e\n\u003c/h2\u003e\n\n\u003cp\u003eファイルコピー、作成、移動のユーティリティ。\u003cbr\u003e\nなお、ファイル検索に関しては\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.IO.PathConstruction.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePathConstruction\u003c/a\u003eのGlobFiles等を使用する。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"processtasks\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#processtasks\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.Tooling.ProcessTasks.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eProcessTasks\u003c/a\u003e\n\u003c/h2\u003e\n\n\u003cp\u003eプロセス起動等のユーティリティ。\u003cbr\u003e\n\u003ccode\u003eToolSettings\u003c/code\u003eは直接インスタンス化できないので、基本的には引数が沢山あるバージョンを使うことになる。\u003cbr\u003e\n\u003cstrong\u003e実行時のワーキングディレクトリはRootDirectoryと一致しない場合があるので、workingDirectoryの指定はしておいた方が良い。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"msbuildtasks\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#msbuildtasks\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.Tools.MSBuild.MSBuildTasks.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMSBuildTasks\u003c/a\u003e\n\u003c/h2\u003e\n\n\u003cp\u003eMSBuildを実行するための補助を行う。ここで使用するMSBuildは、VisualStudioあるいはmonoが持つものであり、dotnet sdkとは異なるものになることに注意。\u003cbr\u003e\n実行パターンは複数あるが、最もよく使うのは\u003ccode\u003eMSBuild(Configure\u0026lt;MSBuildSettings\u0026gt; configure)\u003c/code\u003eだろうか。\u003cbr\u003e\n\u003ccode\u003eConfigure\u0026lt;MSBuildSettings\u0026gt;\u003c/code\u003eとは、要するに\u003ccode\u003eFunc\u0026lt;MSBuildSettings, MSBuildSettings\u0026gt;\u003c/code\u003eのようなものである。\u003cbr\u003e\nとりあえず\u003ccode\u003eSetProjectFile(string)\u003c/code\u003eは必須で、さらに使用するVSのバージョンを限定したい場合は、\u003ccode\u003eSetMSBuildVersion()\u003c/code\u003e、ビルドアーキテクチャを指定したい場合は、\u003ccode\u003eSetTargetPlatform()\u003c/code\u003eを実行することになる。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"compressiontasks\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#compressiontasks\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.IO.CompressionTasks.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCompressionTasks\u003c/a\u003e\n\u003c/h2\u003e\n\n\u003cp\u003ezip,tar,gz,bz2等、圧縮・伸長等を行うユーティリティ。\u003cbr\u003e\nxzや7zに関してはサポートしていないので、別途処理を用意する必要がある。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"終わりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e終わりに\u003c/h1\u003e\n\n\u003cp\u003eとりあえずここまで書けば、基本的なタスクというのは書けると思う。\u003cbr\u003e\n公式ドキュメントを参考にしながら記述すること。ここで紹介していない便利機能もあるので、\u003cbr\u003e\n一回は見てみると良い。\u003c/p\u003e\n\n\u003cp\u003e本当はcakebuildとの比較を書きたかったが、この記事が長くなってしまったので宿題とする。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考リンク\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E3%83%AA%E3%83%B3%E3%82%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考リンク\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://nuke.build\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式サイト\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://nuke.build/docs/getting-started/philosophy.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eドキュメント\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://nuke.build/api/Nuke.Common/Nuke.Common.ControlFlow.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAPIリファレンス\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2020-07-02T16:23:50Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"B72OZ/VJOt7bLh3ols8lRVysOD5AWkQyPw==--pop2ctNspSkTKQhn--HIYPrzjV9q52qAoEp8iEpQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-07-07T10:49:31Z","likesCount":7,"linkUrl":"https://qiita.com/skitoy4321/items/6fe3714206d0bdbc9ddf","organization":null,"originalId":1256950,"stockedCount":6,"title":"C#でビルドタスクが書けるnukebuildについて","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%93%E3%82%8C%E3%81%AF%E4%BD%95%E3%81%8B\"\u003eこれは何か?\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E5%88%9D%E3%81%AE%E5%AE%9F%E8%A1%8C\"\u003e最初の実行\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#nukeglobaltool\"\u003eNuke.GlobalTool\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A7%8B%E6%88%90%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB\"\u003e構成ファイル\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E8%A8%98%E8%BF%B0\"\u003eタスクの記述\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E5%AE%9F%E8%A1%8C\"\u003eタスクの実行\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%BE%9D%E5%AD%98%E9%96%A2%E4%BF%82\"\u003eタスクの依存関係\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#itargetdefinition-dependsonparams-target-t\"\u003eITargetDefinition DependsOn(params Target[] t)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#itargetdefinition-dependentforparams-target-t\"\u003eITargetDefinition DependentFor(params Target[] t)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#itargetdefinition-beforeparams-target-t\"\u003eITargetDefinition Before(params Target[] t)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#itargetdefinition-afterparams-target-t\"\u003eITargetDefinition After(params Target[] t)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BF%85%E8%A6%81%E6%9D%A1%E4%BB%B6%E3%81%AE%E8%A8%98%E8%BF%B0\"\u003e必要条件の記述\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%89%B9%E5%AE%9A%E3%81%AE%E6%9D%A1%E4%BB%B6%E3%81%AE%E6%99%82%E3%81%AE%E3%81%BF%E3%81%AE%E5%AE%9F%E8%A1%8C\"\u003e特定の条件の時のみの実行\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E3%83%95%E3%83%83%E3%82%AF\"\u003eイベントのフック\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AE%E8%BF%BD%E5%8A%A0\"\u003eパラメーターの追加\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%8B%AC%E8%87%AA%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%9E%8B%E3%81%AE%E8%BF%BD%E5%8A%A0\"\u003e独自パラメーター型の追加\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%91%E3%82%B9%E3%81%AE%E6%A7%8B%E7%AF%89\"\u003eファイルパスの構築\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%88%E3%81%8F%E4%BD%BF%E3%81%86%E6%A9%9F%E8%83%BD\"\u003eよく使う機能\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#filesystemtasks\"\u003eFileSystemTasks\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#processtasks\"\u003eProcessTasks\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#msbuildtasks\"\u003eMSBuildTasks\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#compressiontasks\"\u003eCompressionTasks\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e終わりに\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E3%83%AA%E3%83%B3%E3%82%AF\"\u003e参考リンク\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":644,"uuid":"6fe3714206d0bdbc9ddf","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"Ar5ikcOXfpTfWEkGGBopkfcxnMAY--5yypjIyo69BlvUxD--A3Uk8hBclF+GQ2x8M8gkaQ==","originalId":103253,"description":"","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/103253/profile-images/1526359222","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F103253%2Fprofile-images%2F1526359222?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=a7dce827dc16582e1b8e9c7a52216638","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F103253%2Fprofile-images%2F1526359222?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=9623ed561bd61ca207da0cb6419ba01d","urlName":"skitoy4321","websiteUrl":"","twitterUrl":"https://twitter.com/skitoy4321","twitterUrlName":"skitoy4321","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Build","urlName":"build"},{"name":"nukebuild","urlName":"nukebuild"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
