More than 3 years have passed since last update.Google TakeoutとかでGMailのデータを取得すると、拡張子がmboxのファイルとして落ちてきます。
このmboxファイルは、電子メールのデータ(emlファイル)をそのままつなげたような構造になっていて、プログラムから簡単に読むことができます。
そうは言っても、自分でパースするのはめんどくさいので、MimeKitを使います。MimeKitはNuGetからインストールできます。
検索すると何種類か出てきますが、今回は、mboxファイルをパースするだけなので、MimeKitLiteで足ります。
Liteじゃ足りないこともしたいとか、大は小を兼ねると思っている人は、フルセットを入れておくのもよいでしょう。入れてしまえば、あとは公式のドキュメントに書いてあること(Parsing messages)と同じ感じですが、一応、コマンドライン引数で受け取ったファイルから読み込んで情報を表示するコードを置いておきます。


