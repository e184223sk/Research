More than 1 year has passed since last update.本日はShopifyが提供するMultipass APIを理解するため情報をまとめました。すでに会員管理システムをもつオーナーさんからするとShopoify用（自社EC用）のIDとパスワードを別にもつことはユーザー体験的にもいけてないし管理も煩雑になってしまいます。これを解決してくれるのがMultipass APIです。 概念図はこんな感じです。では、具体的にどのようによう活用するか見ていきましょう。チェックアウトページへ移動します
/admin/settings/checkoutここで、「アカウントを任意とする」または「アカウントを必要とする」を選択します。Shopify Plusを契約しているアカウント限定ですが、下記のように Multipassを有効かするボタンがあります。ここでシークレットコードを取得します。既存会員DBより下記のようなデータを用意します。created_at にはこのjsonデータを生成した時間をいれます。ここで生成できるデータタイプはこちらを参照ください。
https://shopify.dev/docs/admin-api/rest/reference/plus/userメールアドレスをキーとしない場合はidentifierは必須となりますので指定してください。本家資料ではRubyとPHPでのサンプルがありますが、C#だとすでにライブラリーがあり、このあたりの処理をすべて自動で行ってくれます。利用したライブラリーは下記です。
https://github.com/uoc1691/ShopifyMultipassTokenGenerator下記が実際に使ったコードです上記のコードを生成するとShopへのURLが表示されます。そのURLをブラウザー上にコピペすると動作を確認することができます。下記のURLが生成されましたこのURLをブラザーにそのままコピペしてみます。そうすると、同じメールアドレスをもったユーザーのアカウントに遷移することができました。本家資料はこちらを参照ください。
https://shopify.dev/docs/admin-api/rest/reference/plus/multipass


