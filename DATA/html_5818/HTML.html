<!DOCTYPE html><html><head><meta charset="utf-8" /><title>【雑】Unityの雑多な話 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/nicolai_twi/items/65383d9da529ba7b7c9d" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="JRAM9+Mh0G3mr6Cknk9JDgAJCYv4FqN/itnfnVMi9iokvWywNe6Z8PGLFDmB2RtbqCr0nKNbsEKfdi1PtQd2GQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@nicolai_twi" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="【雑】Unityの雑多な話 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRNlp1UjQ0Q1JWVzVwZEhuamdhN3BtNUhscEpyamdhcm9xYkUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9MzZiYWM1ZDcwNTAxYWNkZTMxOTY2YzBiOTEzZTMwNWY&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzVwWTI5c1lXbGZkSGRwJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9OGFmMThiNmQ5ZDdlZTA3Njk4YjBhZTE2NjM5YjA0Njg&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=bedca9cbefd04d11a40b0ac3046ee20e"><meta property="og:description" content="

この記事は？

※この記事は CCS Advent Calender 2017 3日目の記事です。
前記事: 完成度をワンランク上げるデジ絵加工技術


はじめに

こんにちは、CCS OBあるいはエンドレスシラフのNicolai..."><meta content="https://qiita.com/nicolai_twi/items/65383d9da529ba7b7c9d" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,ネイティブプラグイン,CCS,アドベントカレンダー2017" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-b409f66f-611b-467e-b2da-9d0e14500d1c"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fnicolai_twi%2Fitems%2F65383d9da529ba7b7c9d">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fnicolai_twi%2Fitems%2F65383d9da529ba7b7c9d">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-b409f66f-611b-467e-b2da-9d0e14500d1c">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-12-02T19:18:36.000+09:00","dateModified":"2017-12-03T00:32:32.000+09:00","headline":"【雑】Unityの雑多な話","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRNlp1UjQ0Q1JWVzVwZEhuamdhN3BtNUhscEpyamdhcm9xYkUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9MzZiYWM1ZDcwNTAxYWNkZTMxOTY2YzBiOTEzZTMwNWY\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzVwWTI5c1lXbGZkSGRwJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9OGFmMThiNmQ5ZDdlZTA3Njk4YjBhZTE2NjM5YjA0Njg\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=bedca9cbefd04d11a40b0ac3046ee20e","mainEntityOfPage":"https://qiita.com/nicolai_twi/items/65383d9da529ba7b7c9d","author":{"@type":"Person","address":"千葉","email":null,"identifier":"nicolai_twi","name":"nicolai_twi","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fprofile-images%2F1473685643?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=460fd24af33305774f478b2c438a7837","url":"https://qiita.com/nicolai_twi","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"nicolai_twi","type":"items","id":"65383d9da529ba7b7c9d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"nicolai_twi","type":"items","id":"65383d9da529ba7b7c9d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"nicolai_twi","type":"items","id":"65383d9da529ba7b7c9d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/nicolai_twi/items/65383d9da529ba7b7c9d","location":"/nicolai_twi/items/65383d9da529ba7b7c9d","scheme":"https","host":"qiita.com","port":null,"pathname":"/nicolai_twi/items/65383d9da529ba7b7c9d","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"ZlRoH41uWeBLqQs5ey5WP10PlctlSf8qth29mbyM+PVn+QhYW6EQfVyNv6RkuARq9Sxo3D4E7Bejsk9LWql4xg==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-bcf3ecf8-5648-43ac-b425-9f4c466300e1"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/likers" class="css-1iupg5d">25</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">23</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/65383d9da529ba7b7c9d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/nicolai_twi/items/65383d9da529ba7b7c9d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/nicolai_twi"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/31206/profile-images/1473685643" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/nicolai_twi" class="css-10ougpm">@<!-- -->nicolai_twi</a><div class="css-1ay9vb9"><span><meta content="2017-12-02T10:18:36Z"/><time dateTime="2017-12-02T15:32:32Z" class="css-m19uds">updated at 2017-12-02</time></span></div></div></div></div></div><h1 class="css-cgzq40">【雑】Unityの雑多な話</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/%e3%83%8d%e3%82%a4%e3%83%86%e3%82%a3%e3%83%96%e3%83%97%e3%83%a9%e3%82%b0%e3%82%a4%e3%83%b3" class="css-4czcte">ネイティブプラグイン</a><a href="/tags/ccs" class="css-4czcte">CCS</a><a href="/tags/%e3%82%a2%e3%83%89%e3%83%99%e3%83%b3%e3%83%88%e3%82%ab%e3%83%ac%e3%83%b3%e3%83%80%e3%83%bc2017" class="css-4czcte">アドベントカレンダー2017</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="この記事は" class="fragment"></span><a href="#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AF"><i class="fa fa-link"></i></a>この記事は？</h1>

<p>※この記事は <strong><a href="https://adventar.org/calendars/2551" rel="nofollow noopener" target="_blank">CCS Advent Calender 2017</a></strong> 3日目の記事です。<br>
<strong>前記事:</strong> <a href="http://saho-london.hatenablog.com/entry/2017/12/02/000000" rel="nofollow noopener" target="_blank">完成度をワンランク上げるデジ絵加工技術</a></p>

<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>こんにちは、CCS OBあるいは<strong><a href="http://endless-shirafu.com/" rel="nofollow noopener" target="_blank">エンドレスシラフ</a></strong>のNicolaiです。<br><br>
<a href="https://www.evernote.com/shard/s491/sh/9797a34c-38ce-4f7f-a10d-b35702294f51/7545eeedf9ac24203849a627cc6478e2" rel="nofollow noopener" target="_blank">昨年のアドベントカレンダーで書いた記事</a>が非常にポエムだったので、<br>
よ～しまた愚にもつかねえポエム書くぞ～書くぞ～と思っていましたが、<br>
謎のポエマーだと思われるのも正直きついものがあるのでやめました。</p>

<p>その代わり今回は割と実用寄りというか、<br>
<strong><a href="http://endless-shirafu.com/endless_shirafu/akashicforce/akashicforce-web/index.html" rel="nofollow noopener" target="_blank">エンドレスシラフの「∀kashicforce」というゲーム</a>で実際に使われた技術</strong>について取り留めなくお話します。<br>
どういうゲームなのかは上のリンクを見てください。<br>
<iframe width="100%" height="315" src="https://www.youtube.com/embed/jzKOl7b0_wI" frameborder="0" allowfullscreen></iframe></p>

<p>上記ゲームはUnityを使って作られてるので、Unityメインの話です。<br>
あとワークアラウンド的技術や運用で回避する方法、一時しのぎなどのよくない話とか諸々…</p>

<p>タイトルに<strong>【雑】</strong>と書いた通りかなり雑な記事です。<br>
解説でソースコードが出てくる箇所がありますが、全部載せると分量がやばいので<br>
エッセンス部分だけに抽出して載せるに留めます。<br>
かなりとっ散らかってるけど許してね。</p>

<h3>
<span id="追記" class="fragment"></span><a href="#%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>追記：</h3>

<p>重要なことを書き忘れてた。<br>
基本的に∀kashicforceはWindows向けの同人ゲームなので、<strong>WindowsのStandalone Playerビルド前提の話になります。</strong><br>
モバイルとかWebGLとか向けビルドの話は知見がないので知りません！！！！！注意！！！！</p>

<h1>
<span id="一読の前に注意" class="fragment"></span><a href="#%E4%B8%80%E8%AA%AD%E3%81%AE%E5%89%8D%E3%81%AB%E6%B3%A8%E6%84%8F"><i class="fa fa-link"></i></a>【一読の前に注意】</h1>

<p>この記事中で言及する「Unity」は、特に記載がない限り<br>
<strong>「Unity5.0.0f4」というクッソ古いversion</strong>のことを指します。<br>
なんでそんな古いバージョンについて言及するかというと、上記のバージョンが<br>
∀kashicforceで使ってたバージョンのUnityだからです。<br>
<strong>開発始めた当時は最新版だったんだよ！！！</strong></p>

<p>何が言いたいかというと、記事中で「Unityここがダメ！！！」みたいな話が出てきたら、<br>
それは<strong>最新版のUnityでは直ってる可能性がある</strong>ということです。<br>
そういう直ってる箇所あったら教えてください。</p>

<h1>
<span id="自動アップデータの実装" class="fragment"></span><a href="#%E8%87%AA%E5%8B%95%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>自動アップデータの実装</h1>

<p>∀kashicforceでは、ゲーム起動時に更新差分があった場合に<br>
<strong>自動で差分パッチをダウンロードしてくる仕組み</strong>があります。<br>
仕組み自体はかなり単純で、以下のような感じで動作しています。</p>

<hr>

<ul>
<li>
<a href="http://www.vector.co.jp/soft/winnt/util/se284327.html" rel="nofollow noopener" target="_blank">udm差分ファイル作成ツール</a> などを用いて差分パッチを作成し、<br>
差分パッチの名前にバージョン番号をつけて自前サーバのどこかに上げておく。

<ul>
<li>例：Akashicforce_patch_v110.exe</li>
</ul>
</li>
<li>自前サーバのどこかに、最新版のバージョン番号が書かれたテキストを上げておく。</li>
<li>ゲームのローカルディレクトリに、バージョン番号の書かれたテキストを配置する</li>
<li>ゲーム起動時のスクリプトで、バージョン番号テキストをサーバから読み取ってくる。</li>
</ul>

<p>C#では以下のような感じ(適当にコードのエッセンス部分だけ載せる)</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">readtext_from_server</span></div>
<div class="highlight"><pre class="with-code"><code><span class="n">WebClient</span> <span class="n">wc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebClient</span><span class="p">();</span>
<span class="n">Stream</span> <span class="n">st</span><span class="p">;</span>
<span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">ServerName</span> <span class="p">+</span> <span class="n">FileName</span><span class="p">;</span>
<span class="k">try</span>
<span class="p">{</span>
    <span class="n">st</span> <span class="p">=</span> <span class="n">wc</span><span class="p">.</span><span class="nf">OpenRead</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span><span class="n">WebException</span> <span class="n">exc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">Encoding</span> <span class="n">enc</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"Shift_JIS"</span><span class="p">);</span>
<span class="n">StreamReader</span> <span class="n">sr</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">enc</span><span class="p">);</span>
<span class="kt">string</span> <span class="n">new_version</span> <span class="p">=</span> <span class="n">sr</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
<span class="n">sr</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
<span class="n">st</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
<span class="k">return</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">new_version</span><span class="p">);</span>
</code></pre></div>
</div>

<ul>
<li>同様にローカル側のバージョンを読み取り、サーバ側から読み取った最新バージョン番号と比較。<br>
ローカルよりもサーバ側バージョンが新しいならば、サーバからパッチをDLする。<br>
<strong>DLするパッチの名前はのようにバージョン番号のついた名前で特定</strong>する。<br>

<ul>
<li>例：ローカルバージョンがver1.01、サーバ側最新バージョンがver1.03ならば、ver1.02とver1.03をDLする。<br>
名前は例えばAkashicforce_patch_v102.exeとかつけておくと特定できる。</li>
</ul>
</li>
<li>DLしてきたパッチを起動し、<code>Application.Quit</code>でゲームを終了する。<br>
起動するのはバージョン番号の一番若いパッチ。</li>
</ul>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">process_start</span></div>
<div class="highlight"><pre class="with-code"><code><span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">dataPath</span> <span class="p">+</span> <span class="s">"/../"</span> <span class="p">+</span> <span class="n">exe_name</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">exProcess</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Process</span><span class="p">();</span>
<span class="n">exProcess</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="n">path</span><span class="p">;</span>
<span class="c1">//外部のプロセスを実行する</span>
<span class="n">exProcess</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
<span class="n">Application</span><span class="p">.</span><span class="nf">Quit</span><span class="p">();</span> <span class="c1">// ゲーム終了</span>
</code></pre></div>
</div>

<p>↓ゲーム起動直後にこんな感じの表示を行う<br>
<a href="https://camo.qiitausercontent.com/f5e91f6d27d272cf8cf562946e5d9991559e69c9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f39623432633263322d653762332d306638362d646561392d3335363463336261306132652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F9b42c2c2-e7b3-0f86-dea9-3564c3ba0a2e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=71aefe26782757b327f54653de1be6ea" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/31206/9b42c2c2-e7b3-0f86-dea9-3564c3ba0a2e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F9b42c2c2-e7b3-0f86-dea9-3564c3ba0a2e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bf1387f47664916cce69fd42652591e5 1x" loading="lazy"></a></p>

<ul>
<li><p>差分パッチが実行されるので、更新時テキストとかでどこのフォルダにパッチを適用すればいいかなどをフォロー  。<br>
下は差分パッチ実行時の表示。<br>
<a href="https://camo.qiitausercontent.com/3784808bd56a81d54d12e22360b517c02921bb5e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f35393932333230392d373836302d633538342d353334612d6237396234346562663832662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F59923209-7860-c584-534a-b79b44ebf82f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=bf15af47bc53bcf606231a523ad50b78" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/31206/59923209-7860-c584-534a-b79b44ebf82f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F59923209-7860-c584-534a-b79b44ebf82f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b6ef168ceaf96f7fcbb8f474281735e6 1x" loading="lazy"></a></p></li>
<li><p>udm差分ファイル作成ツールは<strong>「差分適用後に実行するコマンド」</strong>という設定項目が存在するため、<br>
それを用いて<strong>次のバージョン番号のパッチを連鎖的に起動</strong>する。<br>
ちなみに指定した名前のコマンドやファイルが存在しない場合には何も行わないという仕様らしい。</p></li>
</ul>

<hr>

<p>ざっとこんな感じの流れです。<br>
ちなみに<strong>ネットワーク接続自体がない場合にはバージョン確認などを行わず、そのまま起動する</strong>ようにします。</p>

<p>最後のパッチ適用のあたりをもっと効率化できるとほんとうはいいんですけどね。<br>
例えば差分適用も裏で勝手にやってくれるとか。<br>
そこまではちょっと力量不足とかいろいろあってやってません。</p>

<h1>
<span id="開発中はunityのバージョンは固定しよう" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E4%B8%AD%E3%81%AFunity%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AF%E5%9B%BA%E5%AE%9A%E3%81%97%E3%82%88%E3%81%86"><i class="fa fa-link"></i></a>開発中はUnityのバージョンは固定しよう</h1>

<p>ワークアラウンドみたいな話です。<br>
開発中にUnityのバージョンを変えるのはお勧めしません。</p>

<p>というのも<strong>Unityのプロジェクトコンバータにバグがあり、</strong><br>
大きめのUnityプロジェクトをアップコンバートしようとすると<br>
<code>Invalid AABB aabb</code>という謎のエラーが出まくったり、<code>IsFinite(outDistanceAlongView)</code>というエラーが出たり、<br>
バグが修正されたパッチリリースをインストールしようとしたら<br>
別のところでエンバグしていたとかいう実績があるからです。<br>
詳しくは↓とか。</p>

<p>参考: <br>
<a href="https://gamedev.stackexchange.com/questions/105921/invalid-aabb-aabb" class="autolink" rel="nofollow noopener" target="_blank">https://gamedev.stackexchange.com/questions/105921/invalid-aabb-aabb</a><br>
<a href="http://cdecrement.blog.fc2.com/blog-entry-205.html" class="autolink" rel="nofollow noopener" target="_blank">http://cdecrement.blog.fc2.com/blog-entry-205.html</a><br>
<a href="https://issuetracker.unity3d.com/issues/game-object-transform-dot-position-is-incorrect-after-object-dot-instantiate-after-awake-function-call" class="autolink" rel="nofollow noopener" target="_blank">https://issuetracker.unity3d.com/issues/game-object-transform-dot-position-is-incorrect-after-object-dot-instantiate-after-awake-function-call</a></p>

<p>まあ上の現象自体はもう解消されている話なのかもしれませんが、<br>
このような<strong>ユーザーレベルでは解消不能の不具合に出くわす可能性がある</strong><br>
ということは頭に留めておくべきかと思います。</p>

<p><strong>「新機能を追加することは、バグを埋め込むこと」</strong>という格言（？）もあります。<br>
安易に魅力的な新機能に釣られてホイホイバージョンを変更するのは、特に開発中真っただ中のプロジェクトにおいては大きなリスクがあることは意識しましょう。<br>
<strong>これは何もUnityに限った話ではなく、使用しているアセットやミドルウェア、ツールなどすべてにおいて言える</strong>ことです。</p>

<p>ただし、テスト環境が潤沢にそろっており、<strong>テストを全てパスすることで品質を担保できる</strong>場合は上記の限りではありません。<br>
また、モックアップの作成時や、～1か月程度で完成する規模のプロジェクトの場合、<br>
<strong>むしろ新しい機能を積極的に試していく</strong>ことの方が重要だと考えます。</p>

<h3>
<span id="ちなみに" class="fragment"></span><a href="#%E3%81%A1%E3%81%AA%E3%81%BF%E3%81%AB"><i class="fa fa-link"></i></a>ちなみに</h3>

<p>∀kashicforceの場合、Unity5.0.0f4を使用して作成していましたが、<br>
途中でバージョンを上げようとして全然ダメだった記憶があります<br>
(たしか5.1へのコンバートは成功して5.2へコンバートしたらダメだったような気がする)</p>

<h1>
<span id="streamingassets以下のファイルを暗号化せよ" class="fragment"></span><a href="#streamingassets%E4%BB%A5%E4%B8%8B%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%9B%E3%82%88"><i class="fa fa-link"></i></a>StreamingAssets以下のファイルを暗号化せよ</h1>

<p>Unityで外部リソースを用意したい場合、<strong>StreamingAssetsディレクトリ</strong>を用意して、<br>
その中のファイルを参照するという手段を取ることがあります。<br><br>
参考: <a href="https://docs.unity3d.com/jp/540/Manual/StreamingAssets.html" class="autolink" rel="nofollow noopener" target="_blank">https://docs.unity3d.com/jp/540/Manual/StreamingAssets.html</a></p>

<p>例えば、∀kashicforceではムービーファイルや内部設定データをStreamingAssetsに配置しています。<br>
しかし、<strong>StreamingAssetsディレクトリに配置したファイルは全く暗号化とか何もされない</strong>ため、<br>
ユーザーがデータを書き換え放題という問題があります。<br>
最悪のケース、ゲームのシナリオデータをStreamingAssetsに平文で配置してしまったらもはや目も当てられません…</p>

<p>そこで、前もって<strong>暗号化ツールでStreamingAssetsディレクトリ以下のデータを暗号化</strong>しておき、<br>
ゲーム側でデータを読み込む際に復号してから使用するというアプローチをとります。</p>

<p>手っ取り早いのは<strong>AES暗号化方式</strong>で暗号化してしまうことです。<br>
詳しくは以下のブログの暗号化そのまんまでいいんじゃないでしょうか。</p>

<p>参考: <a href="http://developer.wonderpla.net/entry/entry/blog/engineer/AESwithUnity/" rel="nofollow noopener" target="_blank">【Unity】AESでデータを暗号化</a></p>

<p><strong>初期化ベクトルだけ変えておく</strong>のを忘れないようにNE！（ユーザーの復号防止のため）</p>

<p>まあ、一番いいのは<strong>StreamingAssetsにそういう危険なデータを置かない</strong>ことなんですが…。<br>
実際、後からテキスト類を差し替えたい場合とかに結構重宝するので捨てがたいんですよね～</p>

<h1>
<span id="nullの判定にnull合体演算子を使用してはいけない" class="fragment"></span><a href="#null%E3%81%AE%E5%88%A4%E5%AE%9A%E3%81%ABnull%E5%90%88%E4%BD%93%E6%BC%94%E7%AE%97%E5%AD%90%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%AF%E3%81%84%E3%81%91%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>nullの判定にnull合体演算子(??)を使用してはいけない</h1>

<p>ワークアラウンド話です。<br>
Unityの<code>UnityEngine.GameObject</code>を<code>Destroy</code>すると1フレーム後に参照がnullになりますが、<br>
こいつは<strong>nullを自称しているnullではないObjectである</strong>ことが知られています。<br>
そして上記のObjectは<strong>==演算子でnullと比較するとtrueが返りますが、??演算子での比較結果はtrueが返りません。</strong><br>
(??演算子が適切にオーバーライドされてないらしい？)<br>
?.演算子は試してません。</p>

<p>つまり、nullチェックのつもりでnull合体演算子を用いると思わぬところでバグったり、<br>
意図しない挙動を起こす可能性があります。<br>
例えば<strong>nullチェックしてnullならば新しいGameObjectを<code>Instantiate</code>する</strong>というケースにnull合体演算子を用いる場合ですね。<br>
いつまで経ってもnullにならないので、いつまで経っても<code>Instantiate</code>されません。<br>
要注意です。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">null_coalescing</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">// やばい</span>
<span class="n">cache_obj</span> <span class="p">=</span> <span class="n">instantiated_obj</span> <span class="p">??</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">Instantiate</span><span class="p">(</span><span class="n">orig_obj</span><span class="p">);</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">null_check</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">// 冗長だがOK</span>
<span class="k">if</span> <span class="p">(</span><span class="n">instantiated_obj</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">cache_obj</span> <span class="p">=</span> <span class="n">instantiated_obj</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="n">cache_obj</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">Instantiate</span><span class="p">(</span><span class="n">orig_obj</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>あと、∀kashicforceで引っかかったわけではないですが、<br>
<strong><code>System.Object</code>にキャストしたオブジェクトをnullチェック</strong>する場合にも罠があるようです。</p>

<p>参照: <a href="https://qiita.com/satanabe1@github/items/e896303859be5d42c188" id="reference-e7c98689720550160df3">Unityのnullはnullじゃないかもしれない</a></p>

<h1>
<span id="oncollisionenterが呼ばれない問題" class="fragment"></span><a href="#oncollisionenter%E3%81%8C%E5%91%BC%E3%81%B0%E3%82%8C%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>OnCollisionEnterが呼ばれない問題</h1>

<p><strong>よくある問題一覧：</strong></p>

<ul>
<li>
<code>Collision</code>と<code>Collider</code>は違うんだよ！</li>
<li>
<code>Collision2D</code>と<code>Collider2D</code>と<code>Collision</code>と<code>Collider</code>は全部違うものなんだよ！</li>
<li>関数ごとに必要な引数型が全部違うんだよ！</li>
<li>関数の引数型が違っててもUnityは警告を出してくれないんだよ！</li>
<li>
<code>OnTriggerEnter</code>を呼ぶときは<code>IsTriggered</code>にチェックしてなくちゃいけないし<br>
<code>OnCollisionEnter</code>を呼ぶときは<code>IsTriggered</code>は未チェックじゃなければいけないんだよ！</li>
<li>3Dの衝突の時には<code>rigidbody</code>、2Dの衝突の時には<code>rigidbody2D</code>がアタッチされていないといけないんだよ！</li>
<li>勿論関数名をタイポしてたりしても警告は出ないんだよ！</li>
</ul>

<p>と、<strong>めちゃくちゃたくさん罠がある</strong>ので注意！<br>
あと<code>rigidbody</code>は<code>Collider</code>より先にアタッチしとかないと動作しないとかそういうなんかがあったような…。<br>
（よく思い出せない）</p>

<h1>
<span id="itweenを1つのオブジェクトに対して複数同時に使うとなんか挙動がおかしくなるんだが" class="fragment"></span><a href="#itween%E3%82%921%E3%81%A4%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AB%E5%AF%BE%E3%81%97%E3%81%A6%E8%A4%87%E6%95%B0%E5%90%8C%E6%99%82%E3%81%AB%E4%BD%BF%E3%81%86%E3%81%A8%E3%81%AA%E3%82%93%E3%81%8B%E6%8C%99%E5%8B%95%E3%81%8C%E3%81%8A%E3%81%8B%E3%81%97%E3%81%8F%E3%81%AA%E3%82%8B%E3%82%93%E3%81%A0%E3%81%8C"><i class="fa fa-link"></i></a>iTweenを1つのオブジェクトに対して複数同時に使うとなんか挙動がおかしくなるんだが？</h1>

<p><a href="https://www.assetstore.unity3d.com/jp/#!/content/27676" rel="nofollow noopener" target="_blank">DOTween使えばおｋ</a></p>

<h1>
<span id="ポーズ画面の実装" class="fragment"></span><a href="#%E3%83%9D%E3%83%BC%E3%82%BA%E7%94%BB%E9%9D%A2%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>ポーズ画面の実装</h1>

<ul>
<li>
<a href="https://www.assetstore.unity3d.com/jp/#!/content/27676" rel="nofollow noopener" target="_blank">DOTween</a>をUnityにインストールします</li>
<li>ポーズしたい時に<code>Time.timeScale = 0f</code>にします</li>
<li>
<code>Time.deltaTime</code>とか<code>Time.fixedDeltaTime</code>などの値が0になります</li>
<li>上記の値を使用して動き制御しているオブジェクトが停止します</li>
<li>逆に言うと<code>Time.deltaTime</code>に依存しないで移動するオブジェクトの動きを止めることはできません<br>
ただ、大抵そういうのは<strong>意図していない挙動であることが圧倒的に多い</strong>ため、
意図したものでない限り<code>Time.deltaTime</code>を掛けて制御しましょう</li>
<li>Unity上部「Tools→DOTween Utility Panel」を開きます。
ユーティリティパネル上部の「Preference」をクリックし、「TimeScale Independent」のチェック設定を有効にします。<br>
<a href="https://camo.qiitausercontent.com/8fb021a0363984bb75216ea44166181b31579904/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f62386535383365612d336462392d323339652d373130362d3137656330643362353665632e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fb8e583ea-3db9-239e-7106-17ec0d3b56ec.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a3349c02f8f85e36e807eedd97a8eee9" alt="DOTween.gif" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/31206/b8e583ea-3db9-239e-7106-17ec0d3b56ec.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fb8e583ea-3db9-239e-7106-17ec0d3b56ec.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=94044cb76af4a3bc3a250ade68ccdf46 1x" loading="lazy"></a>
</li>
<li>これで、DOTweenを使用した制御は<code>Time.timeScale</code>に依存しなくなります。<br>
つまりポーズ画面で、<strong>通常のキャラクターは動かないけど、<br>
メニュー画面のUIとかカーソルだけDOTweenを使って動かす</strong>ということが実現できます。<br>
</li>
</ul>

<p>下のような感じ<br>
<a href="https://camo.qiitausercontent.com/1e6188a685e80d39f40a3ea32a79b90a7407e521/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f66663333323331392d333537612d376265302d643239372d3836343135633365623137322e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fff332319-357a-7be0-d297-86415c3eb172.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d2c18ffb262f140234f5304120f0e838" alt="pause.gif" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/31206/ff332319-357a-7be0-d297-86415c3eb172.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fff332319-357a-7be0-d297-86415c3eb172.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=94099ff1cd203b2851a7d65cc895f491 1x" loading="lazy"></a><br>
「suspended」が表示されている間(ポーズ画面中)は、カーソルとUI以外は動いていません。<br>
解除するとオブジェクトが動き出します。<br>
当たり前ですがDOTweenを使って動かしてるオブジェクトは容赦なくポーズ中も動くので注意しましょう。</p>

<h1>
<span id="timetimescale--0f-の時のコルーチンの中断の挙動" class="fragment"></span><a href="#timetimescale--0f-%E3%81%AE%E6%99%82%E3%81%AE%E3%82%B3%E3%83%AB%E3%83%BC%E3%83%81%E3%83%B3%E3%81%AE%E4%B8%AD%E6%96%AD%E3%81%AE%E6%8C%99%E5%8B%95"><i class="fa fa-link"></i></a><code>Time.timeScale = 0f;</code> の時のコルーチンの中断の挙動</h1>

<p>Time.timeScale=0の時に、コルーチンの中断方法によって止まる止まらないの挙動が変わります。</p>

<ul>
<li>
<code>yield return null</code> → 止まらない</li>
<li>
<code>WaitForSeconds</code> →止まる</li>
<li>
<code>WaitForFixedUpdate</code> →止まる</li>
<li>
<code>WaitForEndOfFrame</code> →止まらない</li>
</ul>

<p>つまり、上の項のようなやり方でポーズを実装した場合、<br>
<strong>ポーズ中に<code>yield return null</code>と<code>WaitForEndOfFrame</code>で動作制御しているオブジェクトは停止しません。</strong><br>
別途コルーチン内で<code>Time.timeScale</code>の値を見て制御しましょう。</p>

<h1>
<span id="成果物をリリースビルドする前にunityのキャッシュをクリアせよ" class="fragment"></span><a href="#%E6%88%90%E6%9E%9C%E7%89%A9%E3%82%92%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E3%83%93%E3%83%AB%E3%83%89%E3%81%99%E3%82%8B%E5%89%8D%E3%81%ABunity%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%82%92%E3%82%AF%E3%83%AA%E3%82%A2%E3%81%9B%E3%82%88"><i class="fa fa-link"></i></a>成果物をリリースビルドする前にUnityのキャッシュをクリアせよ</h1>

<p>Unityは内部で素材キャッシュのような仕組みを持っているらしく、<br>
<strong>しかもそのキャッシュのデータがビルド時に優先的に使用されてしまう</strong>という問題があります。</p>

<p>大抵は問題ないのですが、<strong>エクスプローラから直にUnityプロジェクト内の素材ファイルなどの差し替えを行った</strong>場合、<br>
「プロジェクト内の素材自体は差し変わっているが<br>
<strong>実際のゲーム画面、およびビルド成果物には差し替え前のファイルが使われ続ける</strong>」という現象が発生します。<br>
つまり、意図しないファイルがビルド成果物に含まれることがあるということですね。<br>
大問題です。</p>

<p>解決法ですが、割と単純ですべてのアセットを再インポートすると解決します。<br>
ただし再インポートはめちゃめちゃ時間かかるので注意しましょう。<br>
<a href="https://camo.qiitausercontent.com/d003dcf67e8ba3b8e53291b43fc0366f5383c284/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f63613132353339302d396364322d653666622d623832322d3030386663393139353433612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fca125390-9cd2-e6fb-b822-008fc919543a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7e2c2f1592b7c98c38a92f0bef2b34c2" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/31206/ca125390-9cd2-e6fb-b822-008fc919543a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fca125390-9cd2-e6fb-b822-008fc919543a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8a77e5acdd6e55788f831f139f85c83e 1x" loading="lazy"></a></p>

<h1>
<span id="systemtextencodingでshift-jisを使用するとエラーになる" class="fragment"></span><a href="#systemtextencoding%E3%81%A7shift-jis%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8B"><i class="fa fa-link"></i></a>System.Text.EncodingでShift-JISを使用するとエラーになる</h1>

<p>参考: <a href="https://helpdesk.unity3d.co.jp/hc/ja/articles/204694010-System-Text-Encoding-%E3%81%A7-Shift-JIS-%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%84" rel="nofollow noopener" target="_blank">System.Text.Encoding で Shift JIS を使いたい</a></p>

<p>ざっくり言うとUnity本体のインストールディレクトリの<code>/Mono/lib/mono/2.0/</code>にある<code>I18*.*.DLL</code>を<br>
Assetディレクトリにインポートすると解決します。</p>

<p>直接関係ないですが、リソースを内部でzip化しておいて、<code>Ionic.Zip.dll</code>を使用して<br>
ゲーム実行時に動的に解凍する場合にも同様の問題が発生します。<br>
(この場合<code>Encoding name 'IBM437' not supported.</code>とかいう一見意味不明のエラーが発生してめっちゃ焦る)<br>
この場合も同じようにI18*.*.DLLを配置しましょう。<br>
参考: <a href="https://qiita.com/satotin/items/39af44667c86db1e4069" id="reference-2eefb30491490b6fb23b">Unity C# Zip化したアセットバンドル(ファイル)を解凍</a></p>

<h1>
<span id="ネイティブプラグイン" class="fragment"></span><a href="#%E3%83%8D%E3%82%A4%E3%83%86%E3%82%A3%E3%83%96%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3"><i class="fa fa-link"></i></a>ネイティブプラグイン</h1>

<p>C#から利用できない、あるいは利用しづらい機能(例えば生ポインタなど、メモリをそのまま扱いたいケース)や、<br>
既存のC/C++言語のライブラリをC#で利用したい場合は、<strong>ネイティブプラグイン</strong>の仕組みを利用します。<br>
まあこれは実際は、ほとんどUnityとは関係ないC &lt;--&gt; C#間の一般的なマーシャリング(P/Invoke)の話ですが…。</p>

<p>∀kashicforceでは、ムービーのデコードにネイティブプラグインを使用しています。<br>
TCP/IP通信のコア部分もネイティブプラグイン化していますが、こちらは結局未使用です…。</p>

<p>ちなみにムービプラグインの内部では<strong>libvpxを使用したリアルタイムVP9デコード</strong>を行っていますが、<br>
<strong>∀kashicforce開発時点ではVP9をUnity上でデコードしてテクスチャにバインドするのは<br>
ある意味世界初の技術だったと言えます</strong>(ドヤアアア<br>
<em>なお現在はどうなのか知らない。多分公式のMovieTextureとかがVP9サポートしてるやろ（ホジ</em></p>

<p><strong>ネイティブプラグインとムービ再生の話は正直言ってかなり踏み込んだ話なので、ザラっと流しで要点だけ書きます。</strong><br>
雑な記事で書くには割と重めなので…。<br>
<em>詳しくはググるか私に聞いてください。というかどっか別の機会で踏み込んだ記事書きます多分</em></p>

<h2>
<span id="マーシャリング" class="fragment"></span><a href="#%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>マーシャリング</h2>

<p>以下のように、C#側とC/C++側で共有したい構造体/クラスについて<br>
<code>[StructLayout(LayoutKind.Sequential)]</code>で構造体のレイアウトをそろえる必要があります。<br>
C#のクラスではメンバが宣言した順でメモリ的に連続に並ぶとは限りません。<br>
(コンパイラ依存で並べ替えが発生する可能性がある)<br>
構造体だとデフォルトでSequentialだった気がするのですが、<br>
C#の場合構造体/クラスは値型と参照型になってるため使い分けが異なり、<br>
今回はクラスを用いたいため明示的に指定しています。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">C#側共有クラス</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Sequential</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ESMoviePlugin_MovieInfo</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">width</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">height</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">stride</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">now_frame</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">databuf_size</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">float</span> <span class="n">fps</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">DECODE_STATUS</span> <span class="n">status</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Sequential</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ESMoviePlugin_FrameBuffer</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">IntPtr</span> <span class="n">frame_y</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">IntPtr</span> <span class="n">frame_u</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">IntPtr</span> <span class="n">frame_v</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">num_frame</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">is_used</span><span class="p">;</span>
    <span class="p">};</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="cpp">
<div class="code-lang"><span class="bold">C/C++側共有構造体</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="k">typedef</span> <span class="k">struct</span> <span class="nc">ESMoviePlugin_MovieInfo</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">width</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">height</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">stride</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">now_frame</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">databuf_size</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">fps</span><span class="p">;</span>
        <span class="n">DECODE_STATUS</span> <span class="n">status</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">typedef</span> <span class="k">struct</span> <span class="nc">ESMoviePlugin_FrameBuffer</span>
    <span class="p">{</span>
        <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">frame_y</span><span class="p">;</span>
        <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">frame_u</span><span class="p">;</span>
        <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">frame_v</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">num_frame</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="n">is_used</span><span class="p">;</span>
    <span class="p">};</span>
</code></pre></div>
</div>

<p><code>DECODE_STATUS</code>はenumなのであまり気にしないでください。<br>
で、<code>Marshal.StructurePtr()</code>で<code>IntPtr</code>にしてネイティブ側に受け渡しします。<br>
参考: <a href="https://msdn.microsoft.com/ja-jp/library/2zhzfk83(v=vs.110).aspx" class="autolink" rel="nofollow noopener" target="_blank">https://msdn.microsoft.com/ja-jp/library/2zhzfk83(v=vs.110).aspx</a></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="n">decode_intptr</span> <span class="p">=</span> <span class="n">Marshal</span><span class="p">.</span><span class="nf">AllocHGlobal</span><span class="p">(</span><span class="n">Marshal</span><span class="p">.</span><span class="nf">SizeOf</span><span class="p">(</span><span class="n">decode_framebuf</span><span class="p">));</span>
    <span class="n">Marshal</span><span class="p">.</span><span class="nf">StructureToPtr</span><span class="p">(</span><span class="n">decode_framebuf</span><span class="p">,</span> <span class="n">decode_intptr</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</code></pre></div></div>

<p><code>Marshal.AllocHGlobal</code>だとコピーになるじゃん…という人は大人しく<code>GCHandle</code>（下の方参照）使いましょう。</p>

<p><code>IntPtr</code>ですが、ネイティブ側では普通に構造体型のポインタ(<code>ESMoviePlugin_MovieInfo*</code>)で受け取ってよいです。<br>
もっといいやり方(<code>dllexport</code>した公開関数に<code>InAttribute/OutAttribute</code>をつける)があるけど、<br>
どうせ受け渡すのは連続メモリ領域なんだからポインタで扱った方が早いよね！（えー</p>

<p>勿論ですが、C#側に公開しなくていい構造体についてはマーシャリングする必要性はありません。</p>

<h2>
<span id="生ポインタを取り扱う" class="fragment"></span><a href="#%E7%94%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%82%92%E5%8F%96%E3%82%8A%E6%89%B1%E3%81%86"><i class="fa fa-link"></i></a>生ポインタを取り扱う</h2>

<p>ネイティブ側との生ポインタの扱いは<code>IntPtr</code>経由で取り扱います。<br>
C#側で確保したメモリをC/C++側でいじる場合、GCの対象から外したいため、以下のように<code>PinnedMemory</code>化します。<br>
今回のケースではデコーダが読み書きするメモリ(つまりテクスチャの領域)ですね。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">GC対象から外したメモリ領域を作成(かなり端折っている)</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="k">public</span> <span class="nf">ESMovie_DecodePtr</span><span class="p">(</span><span class="kt">int</span> <span class="n">size</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// YUVテクスチャのため注意</span>
        <span class="n">decode_buf</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="n">size</span><span class="p">];</span>
        <span class="c1">// GCHandleでbyte配列のポインタを取得</span>
        <span class="n">decode_hn</span> <span class="p">=</span> <span class="n">GCHandle</span><span class="p">.</span><span class="nf">Alloc</span><span class="p">(</span><span class="n">decode_buf</span><span class="p">,</span> <span class="n">GCHandleType</span><span class="p">.</span><span class="n">Pinned</span><span class="p">);</span>
        <span class="n">decode_ptr</span> <span class="p">=</span> <span class="n">decode_hn</span><span class="p">.</span><span class="nf">AddrOfPinnedObject</span><span class="p">();</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<p><code>AddrOfPinnedObject</code>で実際のアドレスが<code>IntPtr</code>で取れます。<br>
ちなみに<code>ToIntPtr</code>メソッドは用途が全然違い、<code>GCHandle.Alloc</code>したハンドルのアドレスしか取得できません。<br>
ムービ再生プラグインでは、マーシャリングした<code>ESMoviePlugin_FrameBuffer</code>構造体の<code>frame_y</code>,<code>frame_u</code>,<code>frame_v</code>メンバに<br>
それぞれY,U,Vテクスチャとして使用するメモリを割り当てています。<br>
もちろん使わなくなったらちゃんと破棄しましょうねー</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="k">public</span> <span class="k">void</span> <span class="nf">DestroyPtr</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">decode_buf</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="n">decode_hn</span><span class="p">.</span><span class="nf">Free</span><span class="p">();</span>
        <span class="n">decode_ptr</span> <span class="p">=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>デコードしたデータは<code>Texture2D</code>の<code>LoadRawTextureData</code>で読み込ませます。<br>
その名の通りRawなバイト列を何も考えずに読み込めるので超便利です。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">テクスチャへ適用</span></div>
<div class="highlight"><pre class="with-code"><code><span class="n">tex_Y</span><span class="p">.</span><span class="nf">LoadRawTextureData</span><span class="p">(</span><span class="n">decode_Y</span><span class="p">.</span><span class="n">decode_buf</span><span class="p">);</span>
<span class="n">tex_U</span><span class="p">.</span><span class="nf">LoadRawTextureData</span><span class="p">(</span><span class="n">decode_U</span><span class="p">.</span><span class="n">decode_buf</span><span class="p">);</span>
<span class="n">tex_V</span><span class="p">.</span><span class="nf">LoadRawTextureData</span><span class="p">(</span><span class="n">decode_V</span><span class="p">.</span><span class="n">decode_buf</span><span class="p">);</span>
<span class="n">tex_Y</span><span class="p">.</span><span class="nf">Apply</span><span class="p">();</span>
<span class="n">tex_U</span><span class="p">.</span><span class="nf">Apply</span><span class="p">();</span>
<span class="n">tex_V</span><span class="p">.</span><span class="nf">Apply</span><span class="p">();</span>
</code></pre></div>
</div>

<h1>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p><strong>他にもなんか色々書くことあるけど気力と時間が無くなりました（雑）</strong><br>
他に書いた方がよかったかもしれない話リスト</p>

<ul>
<li>Mercurial + TortoiseHGによるUnityプロジェクトのバージョン管理</li>
<li>ADX2LEを利用したループ・フェードイン・フェードアウトなどの管理 / ネットワーク経由での効果音同期再生</li>
<li>LoadScene時にアニメーションを使う</li>
<li>使ってるアセットについての話</li>
<li>etcetc...</li>
</ul>

<p>今回の∀kashicforceは色々知見が得られたので、雑メモじゃなくてちゃんとまとめたいところですね…。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fnicolai_twi%2Fitems%2F65383d9da529ba7b7c9d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fnicolai_twi%2Fitems%2F65383d9da529ba7b7c9d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/likers" class="css-1iupg5d">25</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">23</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/65383d9da529ba7b7c9d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/nicolai_twi/items/65383d9da529ba7b7c9d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/nicolai_twi/items/65383d9da529ba7b7c9d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-bcf3ecf8-5648-43ac-b425-9f4c466300e1">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-81afb056-19a6-46ee-bcf3-c8f3c9177f99"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-81afb056-19a6-46ee-bcf3-c8f3c9177f99">{}</script>
      
<div id="LoginModal-react-component-0e27115d-7fed-424f-b42b-a0607788e83a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-0e27115d-7fed-424f-b42b-a0607788e83a">{}</script>
      
<div id="StockModal-react-component-c99d2d3e-923c-4c7a-8798-b1d66cd1038e"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-c99d2d3e-923c-4c7a-8798-b1d66cd1038e">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;quAS5+SI/Fu12yKjFrl3A9SbJ7ULwB537o8Mu7TCTkGrTXKgMke1xqL/lj4JLyVWfLjaolCNDUr7IP5pUufOcg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"この記事は\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eこの記事は？\u003c/h1\u003e\n\n\u003cp\u003e※この記事は \u003cstrong\u003e\u003ca href=\"https://adventar.org/calendars/2551\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCCS Advent Calender 2017\u003c/a\u003e\u003c/strong\u003e 3日目の記事です。\u003cbr\u003e\n\u003cstrong\u003e前記事:\u003c/strong\u003e \u003ca href=\"http://saho-london.hatenablog.com/entry/2017/12/02/000000\" rel=\"nofollow noopener\" target=\"_blank\"\u003e完成度をワンランク上げるデジ絵加工技術\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eこんにちは、CCS OBあるいは\u003cstrong\u003e\u003ca href=\"http://endless-shirafu.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eエンドレスシラフ\u003c/a\u003e\u003c/strong\u003eのNicolaiです。\u003cbr\u003e\u003cbr\u003e\n\u003ca href=\"https://www.evernote.com/shard/s491/sh/9797a34c-38ce-4f7f-a10d-b35702294f51/7545eeedf9ac24203849a627cc6478e2\" rel=\"nofollow noopener\" target=\"_blank\"\u003e昨年のアドベントカレンダーで書いた記事\u003c/a\u003eが非常にポエムだったので、\u003cbr\u003e\nよ～しまた愚にもつかねえポエム書くぞ～書くぞ～と思っていましたが、\u003cbr\u003e\n謎のポエマーだと思われるのも正直きついものがあるのでやめました。\u003c/p\u003e\n\n\u003cp\u003eその代わり今回は割と実用寄りというか、\u003cbr\u003e\n\u003cstrong\u003e\u003ca href=\"http://endless-shirafu.com/endless_shirafu/akashicforce/akashicforce-web/index.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eエンドレスシラフの「∀kashicforce」というゲーム\u003c/a\u003eで実際に使われた技術\u003c/strong\u003eについて取り留めなくお話します。\u003cbr\u003e\nどういうゲームなのかは上のリンクを見てください。\u003cbr\u003e\n\u003ciframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/jzKOl7b0_wI\" frameborder=\"0\" allowfullscreen\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003e上記ゲームはUnityを使って作られてるので、Unityメインの話です。\u003cbr\u003e\nあとワークアラウンド的技術や運用で回避する方法、一時しのぎなどのよくない話とか諸々…\u003c/p\u003e\n\n\u003cp\u003eタイトルに\u003cstrong\u003e【雑】\u003c/strong\u003eと書いた通りかなり雑な記事です。\u003cbr\u003e\n解説でソースコードが出てくる箇所がありますが、全部載せると分量がやばいので\u003cbr\u003e\nエッセンス部分だけに抽出して載せるに留めます。\u003cbr\u003e\nかなりとっ散らかってるけど許してね。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e追記：\u003c/h3\u003e\n\n\u003cp\u003e重要なことを書き忘れてた。\u003cbr\u003e\n基本的に∀kashicforceはWindows向けの同人ゲームなので、\u003cstrong\u003eWindowsのStandalone Playerビルド前提の話になります。\u003c/strong\u003e\u003cbr\u003e\nモバイルとかWebGLとか向けビルドの話は知見がないので知りません！！！！！注意！！！！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"一読の前に注意\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%B8%80%E8%AA%AD%E3%81%AE%E5%89%8D%E3%81%AB%E6%B3%A8%E6%84%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e【一読の前に注意】\u003c/h1\u003e\n\n\u003cp\u003eこの記事中で言及する「Unity」は、特に記載がない限り\u003cbr\u003e\n\u003cstrong\u003e「Unity5.0.0f4」というクッソ古いversion\u003c/strong\u003eのことを指します。\u003cbr\u003e\nなんでそんな古いバージョンについて言及するかというと、上記のバージョンが\u003cbr\u003e\n∀kashicforceで使ってたバージョンのUnityだからです。\u003cbr\u003e\n\u003cstrong\u003e開発始めた当時は最新版だったんだよ！！！\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e何が言いたいかというと、記事中で「Unityここがダメ！！！」みたいな話が出てきたら、\u003cbr\u003e\nそれは\u003cstrong\u003e最新版のUnityでは直ってる可能性がある\u003c/strong\u003eということです。\u003cbr\u003e\nそういう直ってる箇所あったら教えてください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"自動アップデータの実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%87%AA%E5%8B%95%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e自動アップデータの実装\u003c/h1\u003e\n\n\u003cp\u003e∀kashicforceでは、ゲーム起動時に更新差分があった場合に\u003cbr\u003e\n\u003cstrong\u003e自動で差分パッチをダウンロードしてくる仕組み\u003c/strong\u003eがあります。\u003cbr\u003e\n仕組み自体はかなり単純で、以下のような感じで動作しています。\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"http://www.vector.co.jp/soft/winnt/util/se284327.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eudm差分ファイル作成ツール\u003c/a\u003e などを用いて差分パッチを作成し、\u003cbr\u003e\n差分パッチの名前にバージョン番号をつけて自前サーバのどこかに上げておく。\n\n\u003cul\u003e\n\u003cli\u003e例：Akashicforce_patch_v110.exe\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e自前サーバのどこかに、最新版のバージョン番号が書かれたテキストを上げておく。\u003c/li\u003e\n\u003cli\u003eゲームのローカルディレクトリに、バージョン番号の書かれたテキストを配置する\u003c/li\u003e\n\u003cli\u003eゲーム起動時のスクリプトで、バージョン番号テキストをサーバから読み取ってくる。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eC#では以下のような感じ(適当にコードのエッセンス部分だけ載せる)\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ereadtext_from_server\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eWebClient\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWebClient\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eStream\u003c/span\u003e \u003cspan class=\"n\"\u003est\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eServerName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eFileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003etry\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003est\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpenRead\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWebException\u003c/span\u003e \u003cspan class=\"n\"\u003eexc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e \u003cspan class=\"n\"\u003eenc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Shift_JIS\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003eStreamReader\u003c/span\u003e \u003cspan class=\"n\"\u003esr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStreamReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003est\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eenc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003enew_version\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadToEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003esr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003est\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enew_version\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003e同様にローカル側のバージョンを読み取り、サーバ側から読み取った最新バージョン番号と比較。\u003cbr\u003e\nローカルよりもサーバ側バージョンが新しいならば、サーバからパッチをDLする。\u003cbr\u003e\n\u003cstrong\u003eDLするパッチの名前はのようにバージョン番号のついた名前で特定\u003c/strong\u003eする。\u003cbr\u003e\n\n\u003cul\u003e\n\u003cli\u003e例：ローカルバージョンがver1.01、サーバ側最新バージョンがver1.03ならば、ver1.02とver1.03をDLする。\u003cbr\u003e\n名前は例えばAkashicforce_patch_v102.exeとかつけておくと特定できる。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eDLしてきたパッチを起動し、\u003ccode\u003eApplication.Quit\u003c/code\u003eでゲームを終了する。\u003cbr\u003e\n起動するのはバージョン番号の一番若いパッチ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eprocess_start\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edataPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/../\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eexe_name\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eexProcess\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eProcess\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eexProcess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStartInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//外部のプロセスを実行する\u003c/span\u003e\n\u003cspan class=\"n\"\u003eexProcess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eQuit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ゲーム終了\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e↓ゲーム起動直後にこんな感じの表示を行う\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/f5e91f6d27d272cf8cf562946e5d9991559e69c9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f39623432633263322d653762332d306638362d646561392d3335363463336261306132652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F9b42c2c2-e7b3-0f86-dea9-3564c3ba0a2e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=71aefe26782757b327f54653de1be6ea\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/31206/9b42c2c2-e7b3-0f86-dea9-3564c3ba0a2e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F9b42c2c2-e7b3-0f86-dea9-3564c3ba0a2e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bf1387f47664916cce69fd42652591e5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e差分パッチが実行されるので、更新時テキストとかでどこのフォルダにパッチを適用すればいいかなどをフォロー  。\u003cbr\u003e\n下は差分パッチ実行時の表示。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/3784808bd56a81d54d12e22360b517c02921bb5e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f35393932333230392d373836302d633538342d353334612d6237396234346562663832662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F59923209-7860-c584-534a-b79b44ebf82f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=bf15af47bc53bcf606231a523ad50b78\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/31206/59923209-7860-c584-534a-b79b44ebf82f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2F59923209-7860-c584-534a-b79b44ebf82f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b6ef168ceaf96f7fcbb8f474281735e6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eudm差分ファイル作成ツールは\u003cstrong\u003e「差分適用後に実行するコマンド」\u003c/strong\u003eという設定項目が存在するため、\u003cbr\u003e\nそれを用いて\u003cstrong\u003e次のバージョン番号のパッチを連鎖的に起動\u003c/strong\u003eする。\u003cbr\u003e\nちなみに指定した名前のコマンドやファイルが存在しない場合には何も行わないという仕様らしい。\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eざっとこんな感じの流れです。\u003cbr\u003e\nちなみに\u003cstrong\u003eネットワーク接続自体がない場合にはバージョン確認などを行わず、そのまま起動する\u003c/strong\u003eようにします。\u003c/p\u003e\n\n\u003cp\u003e最後のパッチ適用のあたりをもっと効率化できるとほんとうはいいんですけどね。\u003cbr\u003e\n例えば差分適用も裏で勝手にやってくれるとか。\u003cbr\u003e\nそこまではちょっと力量不足とかいろいろあってやってません。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"開発中はunityのバージョンは固定しよう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%8B%E7%99%BA%E4%B8%AD%E3%81%AFunity%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AF%E5%9B%BA%E5%AE%9A%E3%81%97%E3%82%88%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e開発中はUnityのバージョンは固定しよう\u003c/h1\u003e\n\n\u003cp\u003eワークアラウンドみたいな話です。\u003cbr\u003e\n開発中にUnityのバージョンを変えるのはお勧めしません。\u003c/p\u003e\n\n\u003cp\u003eというのも\u003cstrong\u003eUnityのプロジェクトコンバータにバグがあり、\u003c/strong\u003e\u003cbr\u003e\n大きめのUnityプロジェクトをアップコンバートしようとすると\u003cbr\u003e\n\u003ccode\u003eInvalid AABB aabb\u003c/code\u003eという謎のエラーが出まくったり、\u003ccode\u003eIsFinite(outDistanceAlongView)\u003c/code\u003eというエラーが出たり、\u003cbr\u003e\nバグが修正されたパッチリリースをインストールしようとしたら\u003cbr\u003e\n別のところでエンバグしていたとかいう実績があるからです。\u003cbr\u003e\n詳しくは↓とか。\u003c/p\u003e\n\n\u003cp\u003e参考: \u003cbr\u003e\n\u003ca href=\"https://gamedev.stackexchange.com/questions/105921/invalid-aabb-aabb\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://gamedev.stackexchange.com/questions/105921/invalid-aabb-aabb\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://cdecrement.blog.fc2.com/blog-entry-205.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://cdecrement.blog.fc2.com/blog-entry-205.html\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://issuetracker.unity3d.com/issues/game-object-transform-dot-position-is-incorrect-after-object-dot-instantiate-after-awake-function-call\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://issuetracker.unity3d.com/issues/game-object-transform-dot-position-is-incorrect-after-object-dot-instantiate-after-awake-function-call\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eまあ上の現象自体はもう解消されている話なのかもしれませんが、\u003cbr\u003e\nこのような\u003cstrong\u003eユーザーレベルでは解消不能の不具合に出くわす可能性がある\u003c/strong\u003e\u003cbr\u003e\nということは頭に留めておくべきかと思います。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e「新機能を追加することは、バグを埋め込むこと」\u003c/strong\u003eという格言（？）もあります。\u003cbr\u003e\n安易に魅力的な新機能に釣られてホイホイバージョンを変更するのは、特に開発中真っただ中のプロジェクトにおいては大きなリスクがあることは意識しましょう。\u003cbr\u003e\n\u003cstrong\u003eこれは何もUnityに限った話ではなく、使用しているアセットやミドルウェア、ツールなどすべてにおいて言える\u003c/strong\u003eことです。\u003c/p\u003e\n\n\u003cp\u003eただし、テスト環境が潤沢にそろっており、\u003cstrong\u003eテストを全てパスすることで品質を担保できる\u003c/strong\u003e場合は上記の限りではありません。\u003cbr\u003e\nまた、モックアップの作成時や、～1か月程度で完成する規模のプロジェクトの場合、\u003cbr\u003e\n\u003cstrong\u003eむしろ新しい機能を積極的に試していく\u003c/strong\u003eことの方が重要だと考えます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ちなみに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A1%E3%81%AA%E3%81%BF%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eちなみに\u003c/h3\u003e\n\n\u003cp\u003e∀kashicforceの場合、Unity5.0.0f4を使用して作成していましたが、\u003cbr\u003e\n途中でバージョンを上げようとして全然ダメだった記憶があります\u003cbr\u003e\n(たしか5.1へのコンバートは成功して5.2へコンバートしたらダメだったような気がする)\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"streamingassets以下のファイルを暗号化せよ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#streamingassets%E4%BB%A5%E4%B8%8B%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%9B%E3%82%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eStreamingAssets以下のファイルを暗号化せよ\u003c/h1\u003e\n\n\u003cp\u003eUnityで外部リソースを用意したい場合、\u003cstrong\u003eStreamingAssetsディレクトリ\u003c/strong\u003eを用意して、\u003cbr\u003e\nその中のファイルを参照するという手段を取ることがあります。\u003cbr\u003e\u003cbr\u003e\n参考: \u003ca href=\"https://docs.unity3d.com/jp/540/Manual/StreamingAssets.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.unity3d.com/jp/540/Manual/StreamingAssets.html\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e例えば、∀kashicforceではムービーファイルや内部設定データをStreamingAssetsに配置しています。\u003cbr\u003e\nしかし、\u003cstrong\u003eStreamingAssetsディレクトリに配置したファイルは全く暗号化とか何もされない\u003c/strong\u003eため、\u003cbr\u003e\nユーザーがデータを書き換え放題という問題があります。\u003cbr\u003e\n最悪のケース、ゲームのシナリオデータをStreamingAssetsに平文で配置してしまったらもはや目も当てられません…\u003c/p\u003e\n\n\u003cp\u003eそこで、前もって\u003cstrong\u003e暗号化ツールでStreamingAssetsディレクトリ以下のデータを暗号化\u003c/strong\u003eしておき、\u003cbr\u003e\nゲーム側でデータを読み込む際に復号してから使用するというアプローチをとります。\u003c/p\u003e\n\n\u003cp\u003e手っ取り早いのは\u003cstrong\u003eAES暗号化方式\u003c/strong\u003eで暗号化してしまうことです。\u003cbr\u003e\n詳しくは以下のブログの暗号化そのまんまでいいんじゃないでしょうか。\u003c/p\u003e\n\n\u003cp\u003e参考: \u003ca href=\"http://developer.wonderpla.net/entry/entry/blog/engineer/AESwithUnity/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e【Unity】AESでデータを暗号化\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e初期化ベクトルだけ変えておく\u003c/strong\u003eのを忘れないようにNE！（ユーザーの復号防止のため）\u003c/p\u003e\n\n\u003cp\u003eまあ、一番いいのは\u003cstrong\u003eStreamingAssetsにそういう危険なデータを置かない\u003c/strong\u003eことなんですが…。\u003cbr\u003e\n実際、後からテキスト類を差し替えたい場合とかに結構重宝するので捨てがたいんですよね～\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"nullの判定にnull合体演算子を使用してはいけない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#null%E3%81%AE%E5%88%A4%E5%AE%9A%E3%81%ABnull%E5%90%88%E4%BD%93%E6%BC%94%E7%AE%97%E5%AD%90%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%AF%E3%81%84%E3%81%91%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003enullの判定にnull合体演算子(??)を使用してはいけない\u003c/h1\u003e\n\n\u003cp\u003eワークアラウンド話です。\u003cbr\u003e\nUnityの\u003ccode\u003eUnityEngine.GameObject\u003c/code\u003eを\u003ccode\u003eDestroy\u003c/code\u003eすると1フレーム後に参照がnullになりますが、\u003cbr\u003e\nこいつは\u003cstrong\u003enullを自称しているnullではないObjectである\u003c/strong\u003eことが知られています。\u003cbr\u003e\nそして上記のObjectは\u003cstrong\u003e==演算子でnullと比較するとtrueが返りますが、??演算子での比較結果はtrueが返りません。\u003c/strong\u003e\u003cbr\u003e\n(??演算子が適切にオーバーライドされてないらしい？)\u003cbr\u003e\n?.演算子は試してません。\u003c/p\u003e\n\n\u003cp\u003eつまり、nullチェックのつもりでnull合体演算子を用いると思わぬところでバグったり、\u003cbr\u003e\n意図しない挙動を起こす可能性があります。\u003cbr\u003e\n例えば\u003cstrong\u003enullチェックしてnullならば新しいGameObjectを\u003ccode\u003eInstantiate\u003c/code\u003eする\u003c/strong\u003eというケースにnull合体演算子を用いる場合ですね。\u003cbr\u003e\nいつまで経ってもnullにならないので、いつまで経っても\u003ccode\u003eInstantiate\u003c/code\u003eされません。\u003cbr\u003e\n要注意です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003enull_coalescing\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// やばい\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecache_obj\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003einstantiated_obj\u003c/span\u003e \u003cspan class=\"p\"\u003e??\u003c/span\u003e \u003cspan class=\"n\"\u003eGameObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInstantiate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eorig_obj\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003enull_check\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 冗長だがOK\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einstantiated_obj\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n   \u003cspan class=\"n\"\u003ecache_obj\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003einstantiated_obj\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n   \u003cspan class=\"n\"\u003ecache_obj\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGameObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInstantiate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eorig_obj\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあと、∀kashicforceで引っかかったわけではないですが、\u003cbr\u003e\n\u003cstrong\u003e\u003ccode\u003eSystem.Object\u003c/code\u003eにキャストしたオブジェクトをnullチェック\u003c/strong\u003eする場合にも罠があるようです。\u003c/p\u003e\n\n\u003cp\u003e参照: \u003ca href=\"https://qiita.com/satanabe1@github/items/e896303859be5d42c188\" id=\"reference-e7c98689720550160df3\"\u003eUnityのnullはnullじゃないかもしれない\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"oncollisionenterが呼ばれない問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#oncollisionenter%E3%81%8C%E5%91%BC%E3%81%B0%E3%82%8C%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eOnCollisionEnterが呼ばれない問題\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003eよくある問題一覧：\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eCollision\u003c/code\u003eと\u003ccode\u003eCollider\u003c/code\u003eは違うんだよ！\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eCollision2D\u003c/code\u003eと\u003ccode\u003eCollider2D\u003c/code\u003eと\u003ccode\u003eCollision\u003c/code\u003eと\u003ccode\u003eCollider\u003c/code\u003eは全部違うものなんだよ！\u003c/li\u003e\n\u003cli\u003e関数ごとに必要な引数型が全部違うんだよ！\u003c/li\u003e\n\u003cli\u003e関数の引数型が違っててもUnityは警告を出してくれないんだよ！\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eOnTriggerEnter\u003c/code\u003eを呼ぶときは\u003ccode\u003eIsTriggered\u003c/code\u003eにチェックしてなくちゃいけないし\u003cbr\u003e\n\u003ccode\u003eOnCollisionEnter\u003c/code\u003eを呼ぶときは\u003ccode\u003eIsTriggered\u003c/code\u003eは未チェックじゃなければいけないんだよ！\u003c/li\u003e\n\u003cli\u003e3Dの衝突の時には\u003ccode\u003erigidbody\u003c/code\u003e、2Dの衝突の時には\u003ccode\u003erigidbody2D\u003c/code\u003eがアタッチされていないといけないんだよ！\u003c/li\u003e\n\u003cli\u003e勿論関数名をタイポしてたりしても警告は出ないんだよ！\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eと、\u003cstrong\u003eめちゃくちゃたくさん罠がある\u003c/strong\u003eので注意！\u003cbr\u003e\nあと\u003ccode\u003erigidbody\u003c/code\u003eは\u003ccode\u003eCollider\u003c/code\u003eより先にアタッチしとかないと動作しないとかそういうなんかがあったような…。\u003cbr\u003e\n（よく思い出せない）\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"itweenを1つのオブジェクトに対して複数同時に使うとなんか挙動がおかしくなるんだが\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#itween%E3%82%921%E3%81%A4%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AB%E5%AF%BE%E3%81%97%E3%81%A6%E8%A4%87%E6%95%B0%E5%90%8C%E6%99%82%E3%81%AB%E4%BD%BF%E3%81%86%E3%81%A8%E3%81%AA%E3%82%93%E3%81%8B%E6%8C%99%E5%8B%95%E3%81%8C%E3%81%8A%E3%81%8B%E3%81%97%E3%81%8F%E3%81%AA%E3%82%8B%E3%82%93%E3%81%A0%E3%81%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eiTweenを1つのオブジェクトに対して複数同時に使うとなんか挙動がおかしくなるんだが？\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.assetstore.unity3d.com/jp/#!/content/27676\" rel=\"nofollow noopener\" target=\"_blank\"\u003eDOTween使えばおｋ\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ポーズ画面の実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9D%E3%83%BC%E3%82%BA%E7%94%BB%E9%9D%A2%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eポーズ画面の実装\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://www.assetstore.unity3d.com/jp/#!/content/27676\" rel=\"nofollow noopener\" target=\"_blank\"\u003eDOTween\u003c/a\u003eをUnityにインストールします\u003c/li\u003e\n\u003cli\u003eポーズしたい時に\u003ccode\u003eTime.timeScale = 0f\u003c/code\u003eにします\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eTime.deltaTime\u003c/code\u003eとか\u003ccode\u003eTime.fixedDeltaTime\u003c/code\u003eなどの値が0になります\u003c/li\u003e\n\u003cli\u003e上記の値を使用して動き制御しているオブジェクトが停止します\u003c/li\u003e\n\u003cli\u003e逆に言うと\u003ccode\u003eTime.deltaTime\u003c/code\u003eに依存しないで移動するオブジェクトの動きを止めることはできません\u003cbr\u003e\nただ、大抵そういうのは\u003cstrong\u003e意図していない挙動であることが圧倒的に多い\u003c/strong\u003eため、\n意図したものでない限り\u003ccode\u003eTime.deltaTime\u003c/code\u003eを掛けて制御しましょう\u003c/li\u003e\n\u003cli\u003eUnity上部「Tools→DOTween Utility Panel」を開きます。\nユーティリティパネル上部の「Preference」をクリックし、「TimeScale Independent」のチェック設定を有効にします。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/8fb021a0363984bb75216ea44166181b31579904/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f62386535383365612d336462392d323339652d373130362d3137656330643362353665632e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fb8e583ea-3db9-239e-7106-17ec0d3b56ec.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a3349c02f8f85e36e807eedd97a8eee9\" alt=\"DOTween.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/31206/b8e583ea-3db9-239e-7106-17ec0d3b56ec.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fb8e583ea-3db9-239e-7106-17ec0d3b56ec.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=94044cb76af4a3bc3a250ade68ccdf46 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eこれで、DOTweenを使用した制御は\u003ccode\u003eTime.timeScale\u003c/code\u003eに依存しなくなります。\u003cbr\u003e\nつまりポーズ画面で、\u003cstrong\u003e通常のキャラクターは動かないけど、\u003cbr\u003e\nメニュー画面のUIとかカーソルだけDOTweenを使って動かす\u003c/strong\u003eということが実現できます。\u003cbr\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e下のような感じ\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/1e6188a685e80d39f40a3ea32a79b90a7407e521/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f66663333323331392d333537612d376265302d643239372d3836343135633365623137322e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fff332319-357a-7be0-d297-86415c3eb172.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d2c18ffb262f140234f5304120f0e838\" alt=\"pause.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/31206/ff332319-357a-7be0-d297-86415c3eb172.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fff332319-357a-7be0-d297-86415c3eb172.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=94099ff1cd203b2851a7d65cc895f491 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n「suspended」が表示されている間(ポーズ画面中)は、カーソルとUI以外は動いていません。\u003cbr\u003e\n解除するとオブジェクトが動き出します。\u003cbr\u003e\n当たり前ですがDOTweenを使って動かしてるオブジェクトは容赦なくポーズ中も動くので注意しましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"timetimescale--0f-の時のコルーチンの中断の挙動\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#timetimescale--0f-%E3%81%AE%E6%99%82%E3%81%AE%E3%82%B3%E3%83%AB%E3%83%BC%E3%83%81%E3%83%B3%E3%81%AE%E4%B8%AD%E6%96%AD%E3%81%AE%E6%8C%99%E5%8B%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eTime.timeScale = 0f;\u003c/code\u003e の時のコルーチンの中断の挙動\u003c/h1\u003e\n\n\u003cp\u003eTime.timeScale=0の時に、コルーチンの中断方法によって止まる止まらないの挙動が変わります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eyield return null\u003c/code\u003e → 止まらない\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eWaitForSeconds\u003c/code\u003e →止まる\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eWaitForFixedUpdate\u003c/code\u003e →止まる\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eWaitForEndOfFrame\u003c/code\u003e →止まらない\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eつまり、上の項のようなやり方でポーズを実装した場合、\u003cbr\u003e\n\u003cstrong\u003eポーズ中に\u003ccode\u003eyield return null\u003c/code\u003eと\u003ccode\u003eWaitForEndOfFrame\u003c/code\u003eで動作制御しているオブジェクトは停止しません。\u003c/strong\u003e\u003cbr\u003e\n別途コルーチン内で\u003ccode\u003eTime.timeScale\u003c/code\u003eの値を見て制御しましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"成果物をリリースビルドする前にunityのキャッシュをクリアせよ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%88%90%E6%9E%9C%E7%89%A9%E3%82%92%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E3%83%93%E3%83%AB%E3%83%89%E3%81%99%E3%82%8B%E5%89%8D%E3%81%ABunity%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%82%92%E3%82%AF%E3%83%AA%E3%82%A2%E3%81%9B%E3%82%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e成果物をリリースビルドする前にUnityのキャッシュをクリアせよ\u003c/h1\u003e\n\n\u003cp\u003eUnityは内部で素材キャッシュのような仕組みを持っているらしく、\u003cbr\u003e\n\u003cstrong\u003eしかもそのキャッシュのデータがビルド時に優先的に使用されてしまう\u003c/strong\u003eという問題があります。\u003c/p\u003e\n\n\u003cp\u003e大抵は問題ないのですが、\u003cstrong\u003eエクスプローラから直にUnityプロジェクト内の素材ファイルなどの差し替えを行った\u003c/strong\u003e場合、\u003cbr\u003e\n「プロジェクト内の素材自体は差し変わっているが\u003cbr\u003e\n\u003cstrong\u003e実際のゲーム画面、およびビルド成果物には差し替え前のファイルが使われ続ける\u003c/strong\u003e」という現象が発生します。\u003cbr\u003e\nつまり、意図しないファイルがビルド成果物に含まれることがあるということですね。\u003cbr\u003e\n大問題です。\u003c/p\u003e\n\n\u003cp\u003e解決法ですが、割と単純ですべてのアセットを再インポートすると解決します。\u003cbr\u003e\nただし再インポートはめちゃめちゃ時間かかるので注意しましょう。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/d003dcf67e8ba3b8e53291b43fc0366f5383c284/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f33313230362f63613132353339302d396364322d653666622d623832322d3030386663393139353433612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fca125390-9cd2-e6fb-b822-008fc919543a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7e2c2f1592b7c98c38a92f0bef2b34c2\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/31206/ca125390-9cd2-e6fb-b822-008fc919543a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fca125390-9cd2-e6fb-b822-008fc919543a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8a77e5acdd6e55788f831f139f85c83e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"systemtextencodingでshift-jisを使用するとエラーになる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#systemtextencoding%E3%81%A7shift-jis%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSystem.Text.EncodingでShift-JISを使用するとエラーになる\u003c/h1\u003e\n\n\u003cp\u003e参考: \u003ca href=\"https://helpdesk.unity3d.co.jp/hc/ja/articles/204694010-System-Text-Encoding-%E3%81%A7-Shift-JIS-%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%84\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSystem.Text.Encoding で Shift JIS を使いたい\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eざっくり言うとUnity本体のインストールディレクトリの\u003ccode\u003e/Mono/lib/mono/2.0/\u003c/code\u003eにある\u003ccode\u003eI18*.*.DLL\u003c/code\u003eを\u003cbr\u003e\nAssetディレクトリにインポートすると解決します。\u003c/p\u003e\n\n\u003cp\u003e直接関係ないですが、リソースを内部でzip化しておいて、\u003ccode\u003eIonic.Zip.dll\u003c/code\u003eを使用して\u003cbr\u003e\nゲーム実行時に動的に解凍する場合にも同様の問題が発生します。\u003cbr\u003e\n(この場合\u003ccode\u003eEncoding name 'IBM437' not supported.\u003c/code\u003eとかいう一見意味不明のエラーが発生してめっちゃ焦る)\u003cbr\u003e\nこの場合も同じようにI18*.*.DLLを配置しましょう。\u003cbr\u003e\n参考: \u003ca href=\"https://qiita.com/satotin/items/39af44667c86db1e4069\" id=\"reference-2eefb30491490b6fb23b\"\u003eUnity C# Zip化したアセットバンドル(ファイル)を解凍\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ネイティブプラグイン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%8D%E3%82%A4%E3%83%86%E3%82%A3%E3%83%96%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eネイティブプラグイン\u003c/h1\u003e\n\n\u003cp\u003eC#から利用できない、あるいは利用しづらい機能(例えば生ポインタなど、メモリをそのまま扱いたいケース)や、\u003cbr\u003e\n既存のC/C++言語のライブラリをC#で利用したい場合は、\u003cstrong\u003eネイティブプラグイン\u003c/strong\u003eの仕組みを利用します。\u003cbr\u003e\nまあこれは実際は、ほとんどUnityとは関係ないC \u0026lt;--\u0026gt; C#間の一般的なマーシャリング(P/Invoke)の話ですが…。\u003c/p\u003e\n\n\u003cp\u003e∀kashicforceでは、ムービーのデコードにネイティブプラグインを使用しています。\u003cbr\u003e\nTCP/IP通信のコア部分もネイティブプラグイン化していますが、こちらは結局未使用です…。\u003c/p\u003e\n\n\u003cp\u003eちなみにムービプラグインの内部では\u003cstrong\u003elibvpxを使用したリアルタイムVP9デコード\u003c/strong\u003eを行っていますが、\u003cbr\u003e\n\u003cstrong\u003e∀kashicforce開発時点ではVP9をUnity上でデコードしてテクスチャにバインドするのは\u003cbr\u003e\nある意味世界初の技術だったと言えます\u003c/strong\u003e(ドヤアアア\u003cbr\u003e\n\u003cem\u003eなお現在はどうなのか知らない。多分公式のMovieTextureとかがVP9サポートしてるやろ（ホジ\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eネイティブプラグインとムービ再生の話は正直言ってかなり踏み込んだ話なので、ザラっと流しで要点だけ書きます。\u003c/strong\u003e\u003cbr\u003e\n雑な記事で書くには割と重めなので…。\u003cbr\u003e\n\u003cem\u003e詳しくはググるか私に聞いてください。というかどっか別の機会で踏み込んだ記事書きます多分\u003c/em\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"マーシャリング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマーシャリング\u003c/h2\u003e\n\n\u003cp\u003e以下のように、C#側とC/C++側で共有したい構造体/クラスについて\u003cbr\u003e\n\u003ccode\u003e[StructLayout(LayoutKind.Sequential)]\u003c/code\u003eで構造体のレイアウトをそろえる必要があります。\u003cbr\u003e\nC#のクラスではメンバが宣言した順でメモリ的に連続に並ぶとは限りません。\u003cbr\u003e\n(コンパイラ依存で並べ替えが発生する可能性がある)\u003cbr\u003e\n構造体だとデフォルトでSequentialだった気がするのですが、\u003cbr\u003e\nC#の場合構造体/クラスは値型と参照型になってるため使い分けが異なり、\u003cbr\u003e\n今回はクラスを用いたいため明示的に指定しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eC#側共有クラス\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eStructLayout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLayoutKind\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSequential\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eESMoviePlugin_MovieInfo\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003estride\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enow_frame\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003edatabuf_size\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003efps\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDECODE_STATUS\u003c/span\u003e \u003cspan class=\"n\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eStructLayout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLayoutKind\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSequential\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eESMoviePlugin_FrameBuffer\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003eframe_y\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003eframe_u\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003eframe_v\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enum_frame\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eis_used\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cpp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eC/C++側共有構造体\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003etypedef\u003c/span\u003e \u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eESMoviePlugin_MovieInfo\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003estride\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enow_frame\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003edatabuf_size\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003efps\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDECODE_STATUS\u003c/span\u003e \u003cspan class=\"n\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003etypedef\u003c/span\u003e \u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eESMoviePlugin_FrameBuffer\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eframe_y\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eframe_u\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eframe_v\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enum_frame\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eis_used\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eDECODE_STATUS\u003c/code\u003eはenumなのであまり気にしないでください。\u003cbr\u003e\nで、\u003ccode\u003eMarshal.StructurePtr()\u003c/code\u003eで\u003ccode\u003eIntPtr\u003c/code\u003eにしてネイティブ側に受け渡しします。\u003cbr\u003e\n参考: \u003ca href=\"https://msdn.microsoft.com/ja-jp/library/2zhzfk83(v=vs.110).aspx\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://msdn.microsoft.com/ja-jp/library/2zhzfk83(v=vs.110).aspx\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"n\"\u003edecode_intptr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAllocHGlobal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSizeOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_framebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMarshal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStructureToPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_framebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edecode_intptr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eMarshal.AllocHGlobal\u003c/code\u003eだとコピーになるじゃん…という人は大人しく\u003ccode\u003eGCHandle\u003c/code\u003e（下の方参照）使いましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eIntPtr\u003c/code\u003eですが、ネイティブ側では普通に構造体型のポインタ(\u003ccode\u003eESMoviePlugin_MovieInfo*\u003c/code\u003e)で受け取ってよいです。\u003cbr\u003e\nもっといいやり方(\u003ccode\u003edllexport\u003c/code\u003eした公開関数に\u003ccode\u003eInAttribute/OutAttribute\u003c/code\u003eをつける)があるけど、\u003cbr\u003e\nどうせ受け渡すのは連続メモリ領域なんだからポインタで扱った方が早いよね！（えー\u003c/p\u003e\n\n\u003cp\u003e勿論ですが、C#側に公開しなくていい構造体についてはマーシャリングする必要性はありません。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"生ポインタを取り扱う\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%94%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%82%92%E5%8F%96%E3%82%8A%E6%89%B1%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e生ポインタを取り扱う\u003c/h2\u003e\n\n\u003cp\u003eネイティブ側との生ポインタの扱いは\u003ccode\u003eIntPtr\u003c/code\u003e経由で取り扱います。\u003cbr\u003e\nC#側で確保したメモリをC/C++側でいじる場合、GCの対象から外したいため、以下のように\u003ccode\u003ePinnedMemory\u003c/code\u003e化します。\u003cbr\u003e\n今回のケースではデコーダが読み書きするメモリ(つまりテクスチャの領域)ですね。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGC対象から外したメモリ領域を作成(かなり端折っている)\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eESMovie_DecodePtr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// YUVテクスチャのため注意\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edecode_buf\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// GCHandleでbyte配列のポインタを取得\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edecode_hn\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGCHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAlloc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_buf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eGCHandleType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePinned\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edecode_ptr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edecode_hn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddrOfPinnedObject\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eAddrOfPinnedObject\u003c/code\u003eで実際のアドレスが\u003ccode\u003eIntPtr\u003c/code\u003eで取れます。\u003cbr\u003e\nちなみに\u003ccode\u003eToIntPtr\u003c/code\u003eメソッドは用途が全然違い、\u003ccode\u003eGCHandle.Alloc\u003c/code\u003eしたハンドルのアドレスしか取得できません。\u003cbr\u003e\nムービ再生プラグインでは、マーシャリングした\u003ccode\u003eESMoviePlugin_FrameBuffer\u003c/code\u003e構造体の\u003ccode\u003eframe_y\u003c/code\u003e,\u003ccode\u003eframe_u\u003c/code\u003e,\u003ccode\u003eframe_v\u003c/code\u003eメンバに\u003cbr\u003e\nそれぞれY,U,Vテクスチャとして使用するメモリを割り当てています。\u003cbr\u003e\nもちろん使わなくなったらちゃんと破棄しましょうねー\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDestroyPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edecode_buf\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edecode_hn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edecode_ptr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eデコードしたデータは\u003ccode\u003eTexture2D\u003c/code\u003eの\u003ccode\u003eLoadRawTextureData\u003c/code\u003eで読み込ませます。\u003cbr\u003e\nその名の通りRawなバイト列を何も考えずに読み込めるので超便利です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eテクスチャへ適用\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003etex_Y\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadRawTextureData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_Y\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_buf\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003etex_U\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadRawTextureData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_U\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_buf\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003etex_V\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadRawTextureData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_V\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode_buf\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003etex_Y\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eApply\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003etex_U\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eApply\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003etex_V\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eApply\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003e他にもなんか色々書くことあるけど気力と時間が無くなりました（雑）\u003c/strong\u003e\u003cbr\u003e\n他に書いた方がよかったかもしれない話リスト\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eMercurial + TortoiseHGによるUnityプロジェクトのバージョン管理\u003c/li\u003e\n\u003cli\u003eADX2LEを利用したループ・フェードイン・フェードアウトなどの管理 / ネットワーク経由での効果音同期再生\u003c/li\u003e\n\u003cli\u003eLoadScene時にアニメーションを使う\u003c/li\u003e\n\u003cli\u003e使ってるアセットについての話\u003c/li\u003e\n\u003cli\u003eetcetc...\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e今回の∀kashicforceは色々知見が得られたので、雑メモじゃなくてちゃんとまとめたいところですね…。\u003c/p\u003e\n","createdAt":"2017-12-02T10:18:36Z","elapsedYearsFromLastModifiedAt":3,"encryptedId":"pZPprpabWl4PE6UtBmQKhkgqcVollhu4--7v/QxEtlGx6OLVTc--Y44Zr250NvUr0y+JLkEAaw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2017-12-02T15:32:32Z","likesCount":25,"linkUrl":"https://qiita.com/nicolai_twi/items/65383d9da529ba7b7c9d","organization":null,"originalId":565562,"stockedCount":23,"title":"【雑】Unityの雑多な話","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AF\"\u003eこの記事は？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%BF%BD%E8%A8%98\"\u003e追記：\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cli\u003e\n\u003ca href=\"#%E4%B8%80%E8%AA%AD%E3%81%AE%E5%89%8D%E3%81%AB%E6%B3%A8%E6%84%8F\"\u003e【一読の前に注意】\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%87%AA%E5%8B%95%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e自動アップデータの実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%8B%E7%99%BA%E4%B8%AD%E3%81%AFunity%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AF%E5%9B%BA%E5%AE%9A%E3%81%97%E3%82%88%E3%81%86\"\u003e開発中はUnityのバージョンは固定しよう\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A1%E3%81%AA%E3%81%BF%E3%81%AB\"\u003eちなみに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#streamingassets%E4%BB%A5%E4%B8%8B%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%9B%E3%82%88\"\u003eStreamingAssets以下のファイルを暗号化せよ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#null%E3%81%AE%E5%88%A4%E5%AE%9A%E3%81%ABnull%E5%90%88%E4%BD%93%E6%BC%94%E7%AE%97%E5%AD%90%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%AF%E3%81%84%E3%81%91%E3%81%AA%E3%81%84\"\u003enullの判定にnull合体演算子(??)を使用してはいけない\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#oncollisionenter%E3%81%8C%E5%91%BC%E3%81%B0%E3%82%8C%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C\"\u003eOnCollisionEnterが呼ばれない問題\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#itween%E3%82%921%E3%81%A4%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AB%E5%AF%BE%E3%81%97%E3%81%A6%E8%A4%87%E6%95%B0%E5%90%8C%E6%99%82%E3%81%AB%E4%BD%BF%E3%81%86%E3%81%A8%E3%81%AA%E3%82%93%E3%81%8B%E6%8C%99%E5%8B%95%E3%81%8C%E3%81%8A%E3%81%8B%E3%81%97%E3%81%8F%E3%81%AA%E3%82%8B%E3%82%93%E3%81%A0%E3%81%8C\"\u003eiTweenを1つのオブジェクトに対して複数同時に使うとなんか挙動がおかしくなるんだが？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9D%E3%83%BC%E3%82%BA%E7%94%BB%E9%9D%A2%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003eポーズ画面の実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#timetimescale--0f-%E3%81%AE%E6%99%82%E3%81%AE%E3%82%B3%E3%83%AB%E3%83%BC%E3%83%81%E3%83%B3%E3%81%AE%E4%B8%AD%E6%96%AD%E3%81%AE%E6%8C%99%E5%8B%95\"\u003eTime.timeScale = 0f; の時のコルーチンの中断の挙動\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%88%90%E6%9E%9C%E7%89%A9%E3%82%92%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E3%83%93%E3%83%AB%E3%83%89%E3%81%99%E3%82%8B%E5%89%8D%E3%81%ABunity%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%82%92%E3%82%AF%E3%83%AA%E3%82%A2%E3%81%9B%E3%82%88\"\u003e成果物をリリースビルドする前にUnityのキャッシュをクリアせよ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#systemtextencoding%E3%81%A7shift-jis%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8B\"\u003eSystem.Text.EncodingでShift-JISを使用するとエラーになる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%8D%E3%82%A4%E3%83%86%E3%82%A3%E3%83%96%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3\"\u003eネイティブプラグイン\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0\"\u003eマーシャリング\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%94%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%82%92%E5%8F%96%E3%82%8A%E6%89%B1%E3%81%86\"\u003e生ポインタを取り扱う\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\n","totalPv":7303,"uuid":"65383d9da529ba7b7c9d","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"Zt5BAt33vObjHRmXSRpuRSS1dMk=--ZN3QeL1zOf43b5Hg--BzV49V95fIksguUCg0u9wg==","originalId":31206,"description":"","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"Nicolai Souvlaki","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/31206/profile-images/1473685643","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fprofile-images%2F1473685643?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=dfa73f5c9f508528db985ce033e8c203","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F31206%2Fprofile-images%2F1473685643?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=460fd24af33305774f478b2c438a7837","urlName":"nicolai_twi","websiteUrl":"","twitterUrl":"https://twitter.com/nicolai_twi","twitterUrlName":"nicolai_twi","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"ネイティブプラグイン","urlName":"%e3%83%8d%e3%82%a4%e3%83%86%e3%82%a3%e3%83%96%e3%83%97%e3%83%a9%e3%82%b0%e3%82%a4%e3%83%b3"},{"name":"CCS","urlName":"ccs"},{"name":"アドベントカレンダー2017","urlName":"%e3%82%a2%e3%83%89%e3%83%99%e3%83%b3%e3%83%88%e3%82%ab%e3%83%ac%e3%83%b3%e3%83%80%e3%83%bc2017"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
