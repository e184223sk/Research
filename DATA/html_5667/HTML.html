<!DOCTYPE html><html><head><meta charset="utf-8" /><title>【.NET】UTF-8対応Iniファイルの読み込みと書き込み - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/yaju/items/4fa6c5f52c12b4943426" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="8LFN19nxFN0FMA86l7kmfhgjkSOcUMeLVl5Y6hnd+sMc9Zo61PRO0Q/hQel47JvTsdXB/sumDfAIobqYfM1MMw==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@yaju" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="【.NET】UTF-8対応Iniファイルの読み込みと書き込み - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRTGs1RlZPT0FrVlZVUmkwNDVhLS01Yi1jU1c1cDQ0T1Y0NEtoNDRLazQ0T3I0NEd1NktxdDQ0R182TDY4NDRHXzQ0R281cHU0NDRHTjZMNjg0NEdfJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTMxYjU1NzQ0OTBiZmE4MWVjYjkyODBmMmJkMDI1NjNj&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGxoYW5VJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9Y2EyYzE1OTdmYTM5M2RhOTgyMzBiNjg4ZWRlNTZjN2U&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=e9b77425e706631a2e295fb34c8fc781"><meta property="og:description" content="

はじめに

これは、Visual Basic Advent Calendar 2017の24日目の記事となります。

設定ファイルをxml形式で作成したところ、ユーザーからIni形式で慣れているので変更して欲しいという要望がありま..."><meta content="https://qiita.com/yaju/items/4fa6c5f52c12b4943426" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,ini,VisualBasic" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-246c5223-62c9-4745-8f11-d8afb97ab499"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fyaju%2Fitems%2F4fa6c5f52c12b4943426">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fyaju%2Fitems%2F4fa6c5f52c12b4943426">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-246c5223-62c9-4745-8f11-d8afb97ab499">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-12-24T23:50:28.000+09:00","dateModified":"2019-05-31T21:10:03.000+09:00","headline":"【.NET】UTF-8対応Iniファイルの読み込みと書き込み","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRTGs1RlZPT0FrVlZVUmkwNDVhLS01Yi1jU1c1cDQ0T1Y0NEtoNDRLazQ0T3I0NEd1NktxdDQ0R182TDY4NDRHXzQ0R281cHU0NDRHTjZMNjg0NEdfJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTMxYjU1NzQ0OTBiZmE4MWVjYjkyODBmMmJkMDI1NjNj\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGxoYW5VJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9Y2EyYzE1OTdmYTM5M2RhOTgyMzBiNjg4ZWRlNTZjN2U\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=e9b77425e706631a2e295fb34c8fc781","mainEntityOfPage":"https://qiita.com/yaju/items/4fa6c5f52c12b4943426","author":{"@type":"Person","address":"Shizuoka,Japan","email":null,"identifier":"yaju","name":"yaju","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fprofile-images%2F1473683162?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=136b8707be81c2c47a1fbee1976f4e70","url":"https://qiita.com/yaju","description":"静岡県島田市在住ののシニアSE（元Microsoft MVP 2010-2012）がコンピューター、機械学習、Unity、数学について考える。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yaju","type":"items","id":"4fa6c5f52c12b4943426"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yaju","type":"items","id":"4fa6c5f52c12b4943426"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yaju","type":"items","id":"4fa6c5f52c12b4943426"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/yaju/items/4fa6c5f52c12b4943426","location":"/yaju/items/4fa6c5f52c12b4943426","scheme":"https","host":"qiita.com","port":null,"pathname":"/yaju/items/4fa6c5f52c12b4943426","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"LyY2IakR7kVThNWr3CecGZ2t8LY17KT7llneMEIzDyHDYuHMpBS0SVlVm3gzciG0NFuga2IaboDIpjxCJyO50Q==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-fa1ca52b-5f9c-4fb0-97c2-7936f105d84d"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yaju/items/4fa6c5f52c12b4943426/likers" class="css-1iupg5d">5</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">12</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/4fa6c5f52c12b4943426/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yaju/items/4fa6c5f52c12b4943426/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yaju/items/4fa6c5f52c12b4943426/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yaju/items/4fa6c5f52c12b4943426/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yaju/items/4fa6c5f52c12b4943426.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2017/vb" class="it-AdcalRibbon_title">Visual Basic<!-- --> Advent Calendar<!-- --> <!-- -->2017</a>Day 24</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/yaju"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/14053/profile-images/1473683162" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/yaju" class="css-10ougpm">@<!-- -->yaju</a><div class="css-1ay9vb9"><span><meta content="2017-12-24T14:50:28Z"/><time dateTime="2019-05-31T12:10:03Z" class="css-m19uds">updated at 2019-05-31</time></span></div></div></div></div></div><h1 class="css-cgzq40">【.NET】UTF-8対応Iniファイルの読み込みと書き込み</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/ini" class="css-4czcte">ini</a><a href="/tags/visualbasic" class="css-4czcte">VisualBasic</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>これは、<a href="https://qiita.com/advent-calendar/2017/vb">Visual Basic Advent Calendar 2017</a>の24日目の記事となります。</p>

<p>設定ファイルをxml形式で作成したところ、ユーザーからIni形式で慣れているので変更して欲しいという要望がありました。<br>
既に本体プログラムはReadXmlでDataSet型にして設定を読み込むようになっていたため、本体プログラムに出来るだけ影響しないようにIni形式をDataSet型に変換するクラスを作成しました。</p>

<h1>
<span id="説明" class="fragment"></span><a href="#%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>説明</h1>

<p>下記のようなiniファイルがあった場合、Dictionary型およびDataSet型にして取得できます。<br>
特徴として、セクション名が同じで末尾数字が違った場合、同一グループとして扱います。また、キー名も同様で末尾数字が同じなら同一グループになります。<br>
iniファイルのパースはAPIを使わず独自に行っているため、UTF-8に対応しています。<br>
また、読み込みだけでなく書き込みも出来ます。</p>

<p>※内部ではini形式をXML形式に変換してDataSetのReadXmlメソッドを読んでいます。</p>

<div class="code-frame" data-lang="ini">
<div class="code-lang"><span class="bold">Sample.ini</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c">; データベース
</span><span class="nn">[DATABASE]</span>
<span class="py">Host</span> <span class="p">=</span> <span class="s">192.168.0.1</span>
<span class="py">User</span> <span class="p">=</span> <span class="s">username</span>
<span class="py">Pass</span> <span class="p">=</span> <span class="s">password</span>

<span class="c">; 文字コード
</span><span class="nn">[ENCODING]</span>
<span class="py">enc</span> <span class="p">=</span> <span class="s">SJIS</span>

<span class="c">; フォント情報
</span><span class="nn">[FONT1]</span>
<span class="py">FontType</span> <span class="p">=</span> <span class="s">Meiryo UI</span>
<span class="py">FontSize</span> <span class="p">=</span> <span class="s">36</span>
<span class="py">FontColor</span> <span class="p">=</span> <span class="s">white</span>
<span class="nn">[FONT2]</span>
<span class="py">FontType</span> <span class="p">=</span> <span class="s">ＭＳ ゴシック</span>
<span class="py">FontSize</span> <span class="p">=</span> <span class="s">24</span>
<span class="py">FontColor</span> <span class="p">=</span> <span class="s">red</span>
<span class="nn">[FONT3]</span>
<span class="py">FontType</span> <span class="p">=</span> <span class="s">Century Gothic</span>
<span class="py">FontSize</span> <span class="p">=</span> <span class="s">12</span>
<span class="py">FontColor</span> <span class="p">=</span> <span class="s">green</span>

<span class="c">; データ
</span><span class="nn">[DATA1]</span>
<span class="py">Code1</span> <span class="p">=</span> <span class="s">100</span>
<span class="py">Str1</span> <span class="p">=</span> <span class="s">Hoge</span>
<span class="py">Code2</span> <span class="p">=</span> <span class="s">101</span>
<span class="py">Str2</span> <span class="p">=</span> <span class="s">Fuga</span>
<span class="nn">[DATA2]</span>
<span class="py">Code1</span> <span class="p">=</span> <span class="s">200</span>
<span class="py">Str1</span> <span class="p">=</span> <span class="s">Hoge2</span>
<span class="py">Code2</span> <span class="p">=</span> <span class="s">201</span>
<span class="py">Str2</span> <span class="p">=</span> <span class="s">Fuga2</span>
</code></pre></div>
</div>

<h2>
<span id="読み込み" class="fragment"></span><a href="#%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF"><i class="fa fa-link"></i></a>読み込み</h2>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">Sample.vb</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">Dim</span> <span class="nv">path</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"Sample.ini"</span>
<span class="k">Dim</span> <span class="nv">iniManager</span> <span class="ow">As</span> <span class="n">IniManager</span> <span class="o">=</span> <span class="k">New</span> <span class="n">IniManager</span><span class="p">()</span>

<span class="c1">' 文字コードをUTF-8とする。</span>
<span class="n">iniManager</span><span class="p">.</span><span class="n">Encording</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span>
<span class="c1">' Iniファイルの読み込み。FalseはDictionary型のみ、TrueならDataSet型にも変換する。</span>
<span class="n">iniManager</span><span class="p">.</span><span class="n">ReadIni</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="k">True</span><span class="p">)</span>

<span class="c1">' Dictionary型による取得</span>
<span class="k">Dim</span> <span class="nv">host</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">iniManager</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="s">"DATABASE"</span><span class="p">,</span> <span class="s">"Host"</span><span class="p">)</span>

<span class="c1">' DataSet型による取得</span>
<span class="k">Dim</span> <span class="nv">ds</span> <span class="ow">As</span> <span class="n">DataSet</span> <span class="o">=</span> <span class="n">iniManager</span><span class="p">.</span><span class="n">SectionDataSet</span>
<span class="k">Dim</span> <span class="nv">dtFont</span> <span class="ow">As</span> <span class="n">DataTable</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="n">Tables</span><span class="p">(</span><span class="s">"FONT"</span><span class="p">)</span>
<span class="k">Dim</span> <span class="nv">dtData</span> <span class="ow">As</span> <span class="n">DataTable</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="n">Tables</span><span class="p">(</span><span class="s">"DATA"</span><span class="p">)</span>
</code></pre></div>
</div>

<p>セクション名(DATABASE)のDictionary型の内容<br>
<a href="https://camo.qiitausercontent.com/09cfda9b12722531d96d0f5537fe8dc9e100c1a1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f63633737363735312d623030322d623433392d646565612d3734396431386664626231362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fcc776751-b002-b439-deea-749d18fdbb16.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=208a1773885a719061f78a6ab7a6a4e2" alt="IniDic.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/14053/cc776751-b002-b439-deea-749d18fdbb16.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fcc776751-b002-b439-deea-749d18fdbb16.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a6b6790a240df804c572830becde9077 1x" loading="lazy"></a></p>

<p>セクション名(DATABASE)のDataTable型の内容<br>
<a href="https://camo.qiitausercontent.com/9861ff07cc50a65422197aadf188f899d448c404/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f38386634663763652d393035332d383335612d353339652d6530633838356663626233342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F88f4f7ce-9053-835a-539e-e0c885fcbb34.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4a2ed598cc8cb2e9f3c0f7241d2e61ee" alt="IniDataSet1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/14053/88f4f7ce-9053-835a-539e-e0c885fcbb34.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F88f4f7ce-9053-835a-539e-e0c885fcbb34.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b04769a0bbce2b15ee4140894581a109 1x" loading="lazy"></a></p>

<p>セクション名(ENCODING)のDataTable型の内容<br>
<a href="https://camo.qiitausercontent.com/9e84522d57a815794a51e6d30414e6fabac5218a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f61366666616266392d333130362d613834392d636138322d3233613232653033356335642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fa6ffabf9-3106-a849-ca82-23a22e035c5d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d882e110961d41f733aa2796b57499b9" alt="IniDataSet2.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/14053/a6ffabf9-3106-a849-ca82-23a22e035c5d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fa6ffabf9-3106-a849-ca82-23a22e035c5d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=73b84501ae37d12dab328a058f1d7998 1x" loading="lazy"></a></p>

<p>セクション名(FONT1,FONT2,FONT3)のDataTable型の内容<br>
同一セクション名(FONT)でまとめています。Grpの列が自動で追加され末尾数字がセットされます。末尾数字が無い場合、0 になります。<br>
<a href="https://camo.qiitausercontent.com/fb9987a9f09ce6ae8ed075d50f3c1ab0145c711c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f62363837353538372d383364662d363464362d626237392d3037653330393966323939362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fb6875587-83df-64d6-bb79-07e3099f2996.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=78d674b477a67e9b19eaa0d8362219c0" alt="IniDataSet3.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/14053/b6875587-83df-64d6-bb79-07e3099f2996.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fb6875587-83df-64d6-bb79-07e3099f2996.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d96ed0d3bc25660615da604b31bb253b 1x" loading="lazy"></a></p>

<p>セクション名(DATA1,DATA2)のDataTable型の内容<br>
同一セクション名(DATA)と同一キー名(Code,Str)でまとめています。GrpとIdxの列が自動で追加され末尾数字がセットされます。<br>
<a href="https://camo.qiitausercontent.com/38b763d7bf3ac6f4485aef85eca3c8afb9c02ed9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f33333730333539362d333965662d363431352d313937622d6561633132386361633663622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F33703596-39ef-6415-197b-eac128cac6cb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e7af5b1082e822c307781701797600d5" alt="IniDataSet4.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/14053/33703596-39ef-6415-197b-eac128cac6cb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F33703596-39ef-6415-197b-eac128cac6cb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f3d2315ce5719f47d747ef2503d5cb01 1x" loading="lazy"></a></p>

<h2>
<span id="書き込み" class="fragment"></span><a href="#%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF"><i class="fa fa-link"></i></a>書き込み</h2>

<h3>
<span id="dictionary型を指定" class="fragment"></span><a href="#dictionary%E5%9E%8B%E3%82%92%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a>Dictionary型を指定</h3>

<p>SetStringメソッドでセクション、キー、値をセットするとSectionDicプロパティを書き換えます。<br>
また、SectionDicプロパティを使わず、書き換える部分のみのDictionary型を作成して指定することも出来ます。</p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">Sample.vb</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">' hostを1920.168.0.1から127.0.0.1に変更する。</span>
<span class="n">iniManager</span><span class="p">.</span><span class="n">SetString</span><span class="p">(</span><span class="s">"DATABASE"</span><span class="p">,</span> <span class="s">"Host"</span><span class="p">,</span> <span class="s">"127.0.0.1"</span><span class="p">)</span>
<span class="c1">' encをSJISからUTF-8に変更する。</span>
<span class="n">iniManager</span><span class="p">.</span><span class="n">SetString</span><span class="p">(</span><span class="s">"ENCODING"</span><span class="p">,</span> <span class="s">"enc"</span><span class="p">,</span> <span class="s">"UTF-8"</span><span class="p">)</span>
<span class="c1">' 書き込み</span>
<span class="n">iniManager</span><span class="p">.</span><span class="n">WriteIni</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">iniManager</span><span class="p">.</span><span class="n">SectionDic</span><span class="p">)</span>
</code></pre></div>
</div>

<p><a href="https://camo.qiitausercontent.com/75395464d42bbaed55ecb0a3758e6f0c82aa50e1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f34336639306336362d633433342d313834312d373066382d3230363364643930623639662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F43f90c66-c434-1841-70f8-2063dd90b69f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0b99f54db6eebe4434a2631f1801879b" alt="WriteIni3.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/14053/43f90c66-c434-1841-70f8-2063dd90b69f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F43f90c66-c434-1841-70f8-2063dd90b69f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2bdb699fb47adecdabf002b648a0ebc9 1x" loading="lazy"></a></p>

<h3>
<span id="datatable型を指定" class="fragment"></span><a href="#datatable%E5%9E%8B%E3%82%92%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a>DataTable型を指定</h3>

<p>例ではDataTable型を指定して2回に分けて書き込みしていますが、DataSet型で一度に書き込むことが出来ます。</p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">Sample.vb</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">' データテーブルで書き換える</span>
<span class="c1">' FONT2のFontColorをredからblueに書き込える</span>
<span class="n">dtFont</span><span class="p">.</span><span class="n">Rows</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Item</span><span class="p">(</span><span class="s">"FontColor"</span><span class="p">)</span> <span class="o">=</span> <span class="s">"blue"</span>
<span class="n">iniManager</span><span class="p">.</span><span class="n">WriteIni</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dtFont</span><span class="p">)</span>
<span class="c1">' DATA2のStr2のHoge2をHellowに書き込み</span>
<span class="n">dtData</span><span class="p">.</span><span class="n">Rows</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Item</span><span class="p">(</span><span class="s">"Str"</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Hellow"</span>
<span class="n">iniManager</span><span class="p">.</span><span class="n">WriteIni</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dtData</span><span class="p">)</span>
</code></pre></div>
</div>

<p><a href="https://camo.qiitausercontent.com/b87fe9d774648b5600a2020a10ffcbc4ddd23fd8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f39656663633238322d643136612d666265372d353537362d3935386538333532326431362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F9efcc282-d16a-fbe7-5576-958e83522d16.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=239edccf28b6170551095d7e401b1866" alt="WriteIni4.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/14053/9efcc282-d16a-fbe7-5576-958e83522d16.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F9efcc282-d16a-fbe7-5576-958e83522d16.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9ad0fe125dbd0d027b819e03ab6a6751 1x" loading="lazy"></a></p>

<h1>
<span id="ソースコード" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>ソースコード</h1>

<p>IniManagerクラスを作成しています。</p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">IniManager.vb</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">Imports</span> <span class="nn">System.IO</span>
<span class="k">Imports</span> <span class="nn">System.Text</span>
<span class="k">Imports</span> <span class="nn">System.Text.RegularExpressions</span>

<span class="k">Public</span> <span class="k">Class</span> <span class="nc">IniManager</span>
    <span class="c1">' Iniファイル情報格納(OrderedDictionary型)</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">SectionDic</span><span class="p">()</span> <span class="ow">As</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))</span>
    <span class="c1">' Iniファイル情報格納(DataSet型)</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">SectionDataSet</span><span class="p">()</span> <span class="ow">As</span> <span class="n">DataSet</span>

    <span class="c1">' エンコーディング</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">Encording</span><span class="p">()</span> <span class="ow">As</span> <span class="n">Encoding</span>

    <span class="c1">' セクション番号区切り文字</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">SectionSeparator</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">' キー番号区切り文字</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">KeySeparator</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">' セクションと値の間の空白</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">InsertSpace</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">' ルート名</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">RootName</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>

    <span class="c1">' セクショングループ用属性値</span>
    <span class="k">Public</span> <span class="k">Const</span> <span class="nv">SECTION_GROUP_ATTR</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"Grp"</span>
    <span class="c1">' パラメーターグループ用属性値</span>
    <span class="k">Public</span> <span class="k">Const</span> <span class="nv">PARAMETER_INDEX_ATTR</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"Idx"</span>

    <span class="c1">' XML用ルート名</span>
    <span class="k">Public</span> <span class="k">Const</span> <span class="nv">DEFAULT_ROOT_NAMER</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"Root"</span>

    <span class="c1">' セクション用正規表現パターン</span>
    <span class="k">Const</span> <span class="nv">SECTION_PATTERN</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"^\s*\[(?&lt;section&gt;[^\]]+)\].*$"</span>
    <span class="c1">' パラメーター用正規表現パターン</span>
    <span class="k">Const</span> <span class="nv">PARAMETER_PATTERN</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"^\s*(?&lt;name&gt;[^=]+)=(?&lt;value&gt;.*?)(\s+;(?&lt;comment&gt;.*))?$"</span>

    <span class="c1">' コンストラクタ</span>
    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">New</span><span class="p">()</span>
        <span class="n">Encording</span> <span class="o">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span>
        <span class="n">SectionSeparator</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">KeySeparator</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">InsertSpace</span> <span class="o">=</span> <span class="s">" "</span>
        <span class="n">RootName</span> <span class="o">=</span> <span class="n">DEFAULT_ROOT_NAMER</span>
    <span class="k">End</span> <span class="k">Sub</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' 設定値を取得する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="section"&gt;セクション名&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="keyname"&gt;キー名&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt; 設定値&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetString</span><span class="p">(</span><span class="n">section</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">keyname</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">If</span> <span class="k">Not</span> <span class="n">SectionDic</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">section</span><span class="p">)</span> <span class="ow">OrElse</span> <span class="k">Not</span> <span class="n">SectionDic</span><span class="p">(</span><span class="n">section</span><span class="p">).</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">keyname</span><span class="p">)</span> <span class="k">Then</span> <span class="k">Return</span> <span class="s">""</span>

        <span class="k">Return</span> <span class="n">SectionDic</span><span class="p">(</span><span class="n">section</span><span class="p">)(</span><span class="n">keyname</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' 設定値を取得する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="keyname"&gt;キー名&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;設定値&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetString</span><span class="p">(</span><span class="n">keyname</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">Return</span> <span class="n">GetString</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">keyname</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' 設定情報を取得する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="tableName"&gt;テーブル名&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;設定情報&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetTable</span><span class="p">(</span><span class="n">tableName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">DataTable</span>
        <span class="k">Return</span> <span class="n">SectionDataSet</span><span class="p">.</span><span class="n">Tables</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' 設定値を更新する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="section"&gt;セクション名&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="keyname"&gt;キー名&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="value"&gt;設定値&lt;/param&gt;</span>
    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">SetString</span><span class="p">(</span><span class="n">section</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">keyname</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">value</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
        <span class="n">SectionDic</span><span class="p">(</span><span class="n">section</span><span class="p">)(</span><span class="n">keyname</span><span class="p">)</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">End</span> <span class="k">Sub</span>


    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' Iniファイル読み込み</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">ReadIni</span><span class="p">(</span><span class="n">filePath</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">Optional</span> <span class="n">isDataSet</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>

        <span class="c1">' Ini情報のセット</span>
        <span class="n">SectionDic</span> <span class="o">=</span> <span class="n">GetSections</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>

        <span class="c1">' DataSet型に変換</span>
        <span class="k">If</span> <span class="n">isDataSet</span> <span class="k">Then</span> <span class="k">Return</span> <span class="n">ToDataSet</span><span class="p">()</span>

        <span class="k">Return</span> <span class="k">True</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' DataSet型に変換する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">ToDataSet</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="n">SectionDataSet</span> <span class="o">=</span> <span class="k">New</span> <span class="n">DataSet</span><span class="p">()</span>

        <span class="c1">' XMLデータに変換する</span>
        <span class="k">Dim</span> <span class="nv">xml</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">ConvertDicToXML</span><span class="p">()</span>
        <span class="k">If</span> <span class="n">xml</span> <span class="o">=</span> <span class="s">""</span> <span class="k">Then</span> <span class="k">Return</span> <span class="k">False</span>

        <span class="c1">' DataSet型に変換する</span>
        <span class="k">Using</span> <span class="n">reader</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">StringReader</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>
            <span class="n">SectionDataSet</span><span class="p">.</span><span class="n">ReadXml</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">Using</span>

        <span class="k">Return</span> <span class="k">True</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' Iniファイル情報を取得する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetSections</span><span class="p">(</span><span class="n">filePath</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))</span>
        <span class="k">Using</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">New</span> <span class="n">StreamReader</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">Encording</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">sections</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))(</span><span class="n">StringComparer</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">regexSection</span> <span class="o">=</span> <span class="k">New</span> <span class="n">Regex</span><span class="p">(</span><span class="n">SECTION_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="ow">Or</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">regexNameValue</span> <span class="o">=</span> <span class="k">New</span> <span class="n">Regex</span><span class="p">(</span><span class="n">PARAMETER_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="ow">Or</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">currentSection</span> <span class="o">=</span> <span class="kt">String</span><span class="p">.</span><span class="n">Empty</span>

            <span class="c1">' セクション名が明示されていない先頭部分のセクション名を""として扱う</span>
            <span class="n">sections</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">)</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>

            <span class="k">While</span> <span class="k">True</span>
                <span class="k">Dim</span> <span class="nv">line</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">()</span>

                <span class="k">If</span> <span class="n">line</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span> <span class="k">Exit</span> <span class="k">While</span>

                <span class="c1">' 空行は読み飛ばす</span>
                <span class="k">If</span> <span class="n">IsBlank</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">Then</span> <span class="k">Continue</span> <span class="k">While</span>

                <span class="c1">' コメント行は読み飛ばす</span>
                <span class="k">If</span> <span class="n">line</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s">";"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="k">Continue</span> <span class="k">While</span>
                <span class="k">ElseIf</span> <span class="n">line</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s">"#"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="k">Continue</span> <span class="k">While</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="k">Dim</span> <span class="nv">matchNameValue</span> <span class="o">=</span> <span class="n">regexNameValue</span><span class="p">.</span><span class="n">Match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

                <span class="k">If</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Success</span> <span class="k">Then</span>
                    <span class="c1">' name=valueの行</span>
                    <span class="n">sections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">)(</span><span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">(</span><span class="s">"name"</span><span class="p">).</span><span class="n">Value</span><span class="p">.</span><span class="n">Trim</span><span class="p">())</span> <span class="o">=</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">(</span><span class="s">"value"</span><span class="p">).</span><span class="n">Value</span><span class="p">.</span><span class="n">Trim</span><span class="p">()</span>
                    <span class="k">Continue</span> <span class="k">While</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="k">Dim</span> <span class="nv">matchSection</span> <span class="o">=</span> <span class="n">regexSection</span><span class="p">.</span><span class="n">Match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

                <span class="k">If</span> <span class="n">matchSection</span><span class="p">.</span><span class="n">Success</span> <span class="k">Then</span>
                    <span class="c1">' [section]の行</span>
                    <span class="n">currentSection</span> <span class="o">=</span> <span class="n">matchSection</span><span class="p">.</span><span class="n">Groups</span><span class="p">(</span><span class="s">"section"</span><span class="p">).</span><span class="n">Value</span>

                    <span class="k">If</span> <span class="k">Not</span> <span class="n">sections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">currentSection</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">sections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">)</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>
                    <span class="k">End</span> <span class="k">If</span>

                    <span class="k">Continue</span> <span class="k">While</span>
                <span class="k">End</span> <span class="k">If</span>
            <span class="k">End</span> <span class="k">While</span>

            <span class="k">Return</span> <span class="n">sections</span>
        <span class="k">End</span> <span class="k">Using</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' Iniファイルの書き込み</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="sections"&gt;更新情報&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="n">filePath</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">sections</span> <span class="ow">As</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)))</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>

        <span class="c1">' Iniファイル情報を取得する</span>
        <span class="k">Dim</span> <span class="nv">dic</span> <span class="o">=</span> <span class="n">GetSections</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>

        <span class="c1">' 並び替えた情報を格納</span>
        <span class="k">Dim</span> <span class="nv">sortSections</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))(</span><span class="n">StringComparer</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">)</span>

        <span class="k">For</span> <span class="k">Each</span> <span class="n">sec</span> <span class="ow">In</span> <span class="n">dic</span>
            <span class="k">For</span> <span class="k">Each</span> <span class="n">pair</span> <span class="ow">In</span> <span class="n">sec</span><span class="p">.</span><span class="n">Value</span>
                <span class="k">If</span> <span class="n">sections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="ow">AndAlso</span> <span class="n">sections</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">).</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="k">If</span> <span class="k">Not</span> <span class="n">sortSections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">sortSections</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>
                    <span class="k">End</span> <span class="k">If</span>

                    <span class="n">sortSections</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="o">=</span> <span class="n">sections</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span>
                <span class="k">End</span> <span class="k">If</span>
            <span class="k">Next</span>
        <span class="k">Next</span>

        <span class="c1">' 存在しなかったら追記</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">sec</span> <span class="ow">In</span> <span class="n">sections</span>
            <span class="k">For</span> <span class="k">Each</span> <span class="n">pair</span> <span class="ow">In</span> <span class="n">sec</span><span class="p">.</span><span class="n">Value</span>
                <span class="c1">' 既に登録済みなら何もしない</span>
                <span class="k">If</span> <span class="n">sortSections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="ow">AndAlso</span> <span class="n">sortSections</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">).</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="k">Continue</span> <span class="k">For</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="c1">' 未登録なら追加する</span>
                <span class="k">If</span> <span class="k">Not</span> <span class="n">sortSections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="n">sortSections</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="n">sortSections</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="o">=</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span>
            <span class="k">Next</span>
        <span class="k">Next</span>


        <span class="c1">' セクションの最終キーを格納</span>
        <span class="k">Dim</span> <span class="nv">lastdic</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Dictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">sec</span> <span class="ow">In</span> <span class="n">dic</span>
            <span class="k">If</span> <span class="n">dic</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">).</span><span class="n">Count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
                <span class="k">Dim</span> <span class="nv">pair</span> <span class="o">=</span> <span class="n">dic</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">).</span><span class="n">Last</span><span class="p">()</span>
                <span class="n">lastdic</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">Write</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sortSections</span><span class="p">,</span> <span class="n">lastdic</span><span class="p">)</span>

        <span class="k">Return</span> <span class="n">result</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' iniファイルの書き込み</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="sectionName"&gt;セクション名&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="keyName"&gt;キー名&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="value"&gt;値&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="n">filePath</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">sectionName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">keyName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">value</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="k">Dim</span> <span class="nv">sections</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))()</span>

        <span class="n">sections</span><span class="p">(</span><span class="n">sectionName</span><span class="p">)</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>
        <span class="n">sections</span><span class="p">(</span><span class="n">sectionName</span><span class="p">)(</span><span class="n">keyName</span><span class="p">)</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">Return</span> <span class="n">WriteIni</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sections</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' Iniファイルの書き込み</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="dsSections"&gt;セクション情報&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="n">filePath</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">dsSections</span> <span class="ow">As</span> <span class="n">DataSet</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="k">Dim</span> <span class="nv">sections</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))()</span>

        <span class="k">For</span> <span class="k">Each</span> <span class="n">dt</span> <span class="ow">As</span> <span class="n">DataTable</span> <span class="ow">In</span> <span class="n">dsSections</span><span class="p">.</span><span class="n">Tables</span>
            <span class="n">ToDictionary</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">sections</span><span class="p">)</span>
        <span class="k">Next</span>

        <span class="k">Return</span> <span class="n">WriteIni</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sections</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' Iniファイルの書き込み</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="filePath"&gt;&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="dtSections"&gt;&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="n">filePath</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">dtSections</span> <span class="ow">As</span> <span class="n">DataTable</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="k">If</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Count</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span> <span class="k">Return</span> <span class="k">False</span>

        <span class="k">Dim</span> <span class="nv">sections</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))()</span>
        <span class="n">ToDictionary</span><span class="p">(</span><span class="n">dtSections</span><span class="p">,</span> <span class="n">sections</span><span class="p">)</span>

        <span class="k">Return</span> <span class="n">WriteIni</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sections</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' Dictionary型に変換する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="dtSections"&gt;セクション情報&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="sections"&gt;更新セクション情報&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">ToDictionary</span><span class="p">(</span><span class="n">dtSections</span> <span class="ow">As</span> <span class="n">DataTable</span><span class="p">,</span> <span class="k">ByRef</span> <span class="n">sections</span> <span class="ow">As</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)))</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">dr</span> <span class="ow">As</span> <span class="n">DataRow</span> <span class="ow">In</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">Rows</span>
            <span class="k">Dim</span> <span class="nv">groupNo</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span>
            <span class="k">If</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">SECTION_GROUP_ATTR</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">groupNo</span> <span class="o">=</span> <span class="n">dr</span><span class="p">(</span><span class="n">SECTION_GROUP_ATTR</span><span class="p">).</span><span class="n">ToString</span><span class="p">()</span>
                <span class="k">If</span> <span class="n">groupNo</span> <span class="o">=</span> <span class="s">"0"</span> <span class="k">Then</span> <span class="n">groupNo</span> <span class="o">=</span> <span class="s">""</span>
            <span class="k">End</span> <span class="k">If</span>

            <span class="k">Dim</span> <span class="nv">sectionName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">TableName</span> <span class="o">&amp;</span> <span class="n">SectionSeparator</span> <span class="o">&amp;</span> <span class="n">groupNo</span>
            <span class="k">If</span> <span class="n">sectionName</span> <span class="o">=</span> <span class="n">RootName</span> <span class="k">Then</span> <span class="n">sectionName</span> <span class="o">=</span> <span class="s">""</span>
            <span class="k">If</span> <span class="k">Not</span> <span class="n">sections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">sectionName</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">sections</span><span class="p">(</span><span class="n">sectionName</span><span class="p">)</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>
            <span class="k">End</span> <span class="k">If</span>

            <span class="k">Dim</span> <span class="nv">indexNo</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span>
            <span class="k">If</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">PARAMETER_INDEX_ATTR</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">indexNo</span> <span class="o">=</span> <span class="n">dr</span><span class="p">(</span><span class="n">PARAMETER_INDEX_ATTR</span><span class="p">).</span><span class="n">ToString</span><span class="p">()</span>
            <span class="k">End</span> <span class="k">If</span>

            <span class="k">For</span> <span class="k">Each</span> <span class="n">column</span> <span class="ow">As</span> <span class="n">DataColumn</span> <span class="ow">In</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">Columns</span>
                <span class="k">If</span> <span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="o">=</span> <span class="n">SECTION_GROUP_ATTR</span> <span class="ow">OrElse</span> <span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="o">=</span> <span class="n">PARAMETER_INDEX_ATTR</span> <span class="ow">OrElse</span> <span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="o">=</span> <span class="n">RootName</span> <span class="o">&amp;</span> <span class="s">"_Id"</span> <span class="k">Then</span>
                    <span class="k">Continue</span> <span class="k">For</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="k">Dim</span> <span class="nv">keyName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="o">&amp;</span> <span class="n">KeySeparator</span> <span class="o">&amp;</span> <span class="n">indexNo</span>
                <span class="k">Dim</span> <span class="nv">keyName2</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">keyName</span>
                <span class="k">If</span> <span class="n">indexNo</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
                    <span class="k">Dim</span> <span class="nv">keyno</span> <span class="o">=</span> <span class="n">GetKeyAndNo</span><span class="p">(</span><span class="n">keyName</span><span class="p">,</span> <span class="n">KeySeparator</span><span class="p">)</span>
                    <span class="n">keyName2</span> <span class="o">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="n">sections</span><span class="p">(</span><span class="n">sectionName</span><span class="p">)(</span><span class="n">keyName</span><span class="p">)</span> <span class="o">=</span> <span class="n">dr</span><span class="p">(</span><span class="n">keyName2</span><span class="p">).</span><span class="n">ToString</span><span class="p">()</span>
            <span class="k">Next</span>
        <span class="k">Next</span>

        <span class="k">Return</span> <span class="k">True</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' iniファイルの書き込みメイン処理</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="sortSections"&gt;ソート済更新情報&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="lastdic"&gt;最終パラメーター情報&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">Write</span><span class="p">(</span><span class="n">filePath</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">sortSections</span> <span class="ow">As</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)),</span> <span class="n">lastdic</span> <span class="ow">As</span> <span class="n">Dictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="k">Dim</span> <span class="nv">isSave</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>
        <span class="k">Dim</span> <span class="nv">isWrite</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>
        <span class="k">Dim</span> <span class="nv">sb</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">StringBuilder</span><span class="p">()</span>
        <span class="k">Dim</span> <span class="nv">isExistsSection</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>

        <span class="k">Using</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">New</span> <span class="n">StreamReader</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">Encording</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">sections</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">))(</span><span class="n">StringComparer</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">regexSection</span> <span class="o">=</span> <span class="k">New</span> <span class="n">Regex</span><span class="p">(</span><span class="n">SECTION_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="ow">Or</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">regexNameValue</span> <span class="o">=</span> <span class="k">New</span> <span class="n">Regex</span><span class="p">(</span><span class="n">PARAMETER_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="ow">Or</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">currentSection</span> <span class="o">=</span> <span class="kt">String</span><span class="p">.</span><span class="n">Empty</span>

            <span class="c1">' セクション名が明示されていない先頭部分のセクション名を""として扱う</span>
            <span class="n">sections</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">)</span> <span class="o">=</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">String</span><span class="p">)()</span>

            <span class="k">While</span> <span class="k">True</span>
                <span class="k">Dim</span> <span class="nv">line</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">()</span>

                <span class="k">If</span> <span class="n">line</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span> <span class="k">Exit</span> <span class="k">While</span>

                <span class="c1">' 空行は読み飛ばす</span>
                <span class="k">Dim</span> <span class="nv">isContinue</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="n">IsBlank</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">If</span> <span class="k">Not</span> <span class="n">isContinue</span> <span class="k">Then</span>
                    <span class="c1">' コメント行は読み飛ばす</span>
                    <span class="k">If</span> <span class="n">line</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s">";"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">isContinue</span> <span class="o">=</span> <span class="k">True</span>
                    <span class="k">ElseIf</span> <span class="n">line</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s">"#"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">isContinue</span> <span class="o">=</span> <span class="k">True</span>
                    <span class="k">End</span> <span class="k">If</span>

                    <span class="c1">' 全て終わった</span>
                    <span class="k">If</span> <span class="n">sortSections</span><span class="p">.</span><span class="n">Count</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span> <span class="n">isContinue</span> <span class="o">=</span> <span class="k">True</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="k">If</span> <span class="n">isContinue</span> <span class="k">Then</span>
                    <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="k">Continue</span> <span class="k">While</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="c1">' 存在しなかったら追記</span>
                <span class="k">Dim</span> <span class="nv">matchNameValue</span> <span class="o">=</span> <span class="n">regexNameValue</span><span class="p">.</span><span class="n">Match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">If</span> <span class="n">sortSections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="ow">AndAlso</span> <span class="n">currentSection</span> <span class="o">=</span> <span class="s">""</span> <span class="k">Then</span>
                    <span class="n">isExistsSection</span> <span class="o">=</span> <span class="k">True</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="k">If</span> <span class="n">isExistsSection</span> <span class="ow">AndAlso</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Success</span> <span class="k">Then</span>
                    <span class="k">Dim</span> <span class="nv">newline</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">line</span>
                    <span class="c1">' name=valueの行</span>
                    <span class="k">Dim</span> <span class="nv">keyName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">(</span><span class="s">"name"</span><span class="p">).</span><span class="n">Value</span><span class="p">.</span><span class="n">Trim</span><span class="p">()</span>
                    <span class="k">If</span> <span class="n">sortSections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">).</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">keyName</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">isWrite</span> <span class="o">=</span> <span class="k">True</span>

                        <span class="k">Dim</span> <span class="nv">value</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">sortSections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">)(</span><span class="n">keyName</span><span class="p">)</span>
                        <span class="n">sortSections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">).</span><span class="n">Remove</span><span class="p">(</span><span class="n">keyName</span><span class="p">)</span>

                        <span class="k">Dim</span> <span class="nv">curvalue</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">(</span><span class="s">"value"</span><span class="p">).</span><span class="n">Value</span><span class="p">.</span><span class="n">Trim</span><span class="p">()</span>
                        <span class="k">If</span> <span class="n">curvalue</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
                            <span class="k">If</span> <span class="n">curvalue</span> <span class="o">&lt;&gt;</span> <span class="n">value</span> <span class="k">Then</span>
                                <span class="c1">' 現在値があるなら置換する</span>
                                <span class="k">If</span> <span class="n">curvalue</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span> <span class="k">Then</span>
                                    <span class="c1">' 現在値に空白が含まれていた場合、単純な置換(キーやコメントなども置換される可能性がある) </span>
                                    <span class="n">newline</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">curvalue</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                                <span class="k">Else</span>
                                    <span class="c1">' 現在値に空白が含まれていない場合、値のみ置換 </span>
                                    <span class="n">newline</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s">"(=\s+|=)([^;|\s]+)(\s+;.*|)"</span><span class="p">,</span> <span class="s">"${1}"</span> <span class="o">&amp;</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="s">"${3}"</span><span class="p">)</span>
                                <span class="k">End</span> <span class="k">If</span>
                                <span class="c1">' 現在値と違う値なら保存する</span>
                                <span class="n">isSave</span> <span class="o">=</span> <span class="k">True</span>
                            <span class="k">End</span> <span class="k">If</span>
                        <span class="k">Else</span>
                            <span class="c1">' = の位置に半角スペースを1つ空けて値をセット</span>
                            <span class="n">newline</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s">"(=)(\s[^;].*)"</span><span class="p">,</span> <span class="s">"${1}"</span> <span class="o">&amp;</span>
<span class="n">InsertSpace</span> <span class="o">&amp;</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="s">"${2}"</span><span class="p">)</span>
                            <span class="k">If</span> <span class="n">value</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="ow">AndAlso</span> <span class="n">newline</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">Then</span>
                                <span class="n">newline</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s">"(=)"</span><span class="p">,</span> <span class="s">"${1}"</span> <span class="o">&amp;</span>
<span class="n">InsertSpace</span> <span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
                            <span class="k">End</span> <span class="k">If</span>
                            <span class="c1">' 現在値と違う値なら保存する</span>
                            <span class="k">If</span> <span class="n">newline</span> <span class="o">=</span> <span class="n">line</span> <span class="k">Then</span> <span class="n">isSave</span> <span class="o">=</span> <span class="k">True</span>
                        <span class="k">End</span> <span class="k">If</span>
                    <span class="k">End</span> <span class="k">If</span>

                    <span class="c1">' 書き換え行のセット</span>
                    <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="n">newline</span><span class="p">)</span>

                    <span class="c1">' 新規パラメーターがあれば最終キー後に追記する</span>
                    <span class="k">If</span> <span class="n">lastdic</span><span class="p">(</span><span class="n">currentSection</span><span class="p">)</span> <span class="o">=</span> <span class="n">keyName</span> <span class="k">Then</span>
                        <span class="k">For</span> <span class="k">Each</span> <span class="n">s</span> <span class="ow">In</span> <span class="n">sortSections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">)</span>
                            <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"{0}"</span> <span class="o">&amp;</span> <span class="n">InsertSpace</span> <span class="o">&amp;</span> <span class="s">"="</span> <span class="o">&amp;</span> <span class="n">InsertSpace</span> <span class="o">&amp;</span> <span class="s">"{1}"</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">Value</span><span class="p">))</span>
                        <span class="k">Next</span>
                        <span class="n">sortSections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">).</span><span class="n">Clear</span><span class="p">()</span>
                    <span class="k">End</span> <span class="k">If</span>

                    <span class="c1">' セクション内のパラメーターが存在しない</span>
                    <span class="k">If</span> <span class="n">sortSections</span><span class="p">(</span><span class="n">currentSection</span><span class="p">).</span><span class="n">Count</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span>
                        <span class="c1">' セクションを削除する</span>
                        <span class="n">sortSections</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="n">currentSection</span><span class="p">)</span>
                    <span class="k">End</span> <span class="k">If</span>
                    <span class="k">Continue</span> <span class="k">While</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="n">isExistsSection</span> <span class="o">=</span> <span class="k">False</span>
                <span class="k">Dim</span> <span class="nv">matchSection</span> <span class="o">=</span> <span class="n">regexSection</span><span class="p">.</span><span class="n">Match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">If</span> <span class="n">matchSection</span><span class="p">.</span><span class="n">Success</span> <span class="k">Then</span>
                    <span class="k">Dim</span> <span class="nv">sectionName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">matchSection</span><span class="p">.</span><span class="n">Groups</span><span class="p">(</span><span class="s">"section"</span><span class="p">).</span><span class="n">Value</span><span class="p">.</span><span class="n">Trim</span><span class="p">()</span>
                    <span class="k">If</span> <span class="n">sortSections</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">sectionName</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">currentSection</span> <span class="o">=</span> <span class="n">sectionName</span>
                        <span class="c1">' 対象のセクション行が存在</span>
                        <span class="n">isExistsSection</span> <span class="o">=</span> <span class="k">True</span>
                    <span class="k">End</span> <span class="k">If</span>
                <span class="k">End</span> <span class="k">If</span>

                <span class="c1">' 行のセット</span>
                <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">While</span>
        <span class="k">End</span> <span class="k">Using</span>

        <span class="c1">' 新規セクションとパラメーターを追記する</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">sec</span> <span class="ow">In</span> <span class="n">sortSections</span>
            <span class="c1">' 未登録のセクションを追加する(一行空行)</span>
            <span class="k">If</span> <span class="n">sb</span><span class="p">.</span><span class="n">Length</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="k">Then</span> <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
            <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"[{0}]"</span><span class="p">,</span> <span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">))</span>
            <span class="n">isWrite</span> <span class="o">=</span> <span class="k">True</span>
            <span class="n">isSave</span> <span class="o">=</span> <span class="k">True</span>
            <span class="k">For</span> <span class="k">Each</span> <span class="n">pair</span> <span class="ow">In</span> <span class="n">sec</span><span class="p">.</span><span class="n">Value</span>
                <span class="c1">' パラメーターを追加する</span>
                <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"{0}"</span> <span class="o">&amp;</span> <span class="n">InsertSpace</span> <span class="o">&amp;</span> <span class="s">"="</span> <span class="o">&amp;</span> <span class="n">InsertSpace</span> <span class="o">&amp;</span> <span class="s">"{1}"</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span><span class="p">))</span>
            <span class="k">Next</span>
        <span class="k">Next</span>

        <span class="c1">' 保存処理</span>
        <span class="k">If</span> <span class="n">isWrite</span> <span class="ow">AndAlso</span> <span class="n">isSave</span> <span class="k">Then</span>
            <span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sb</span><span class="p">.</span><span class="n">ToString</span><span class="p">(),</span> <span class="n">Encording</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>

        <span class="k">Return</span> <span class="k">True</span>
    <span class="k">End</span> <span class="k">Function</span>


    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' 末尾数値分割処理</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="value"&gt;対象キー&lt;/param&gt;</span>
    <span class="c1">''' &lt;param name="separator"&gt;区切り文字&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;分割情報&lt;/returns&gt;</span>
    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">GetKeyAndNo</span><span class="p">(</span><span class="n">value</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">separator</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">Tuple</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)</span>
        <span class="k">If</span> <span class="n">Regex</span><span class="p">.</span><span class="n">IsMatch</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">"[0-9]$"</span><span class="p">)</span> <span class="k">Then</span>
            <span class="k">Dim</span> <span class="nv">pattern</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"(?&lt;Key&gt;.*\D)(?&lt;No&gt;\d+$)"</span>
            <span class="k">If</span> <span class="n">separator</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"(?&lt;Key&gt;.*){0}(?&lt;No&gt;\d+$)"</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>

            <span class="k">Dim</span> <span class="nv">reg</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">mat</span> <span class="ow">As</span> <span class="n">Match</span> <span class="o">=</span> <span class="n">reg</span><span class="p">.</span><span class="n">Match</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">key</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">Result</span><span class="p">(</span><span class="s">"${Key}"</span><span class="p">)</span>
            <span class="k">Dim</span> <span class="nv">no</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">mat</span><span class="p">.</span><span class="n">Result</span><span class="p">(</span><span class="s">"${No}"</span><span class="p">)</span>

            <span class="k">Return</span> <span class="k">New</span> <span class="n">Tuple</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)(</span><span class="n">key</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">no</span><span class="p">))</span>
        <span class="k">Else</span>
            <span class="k">Return</span> <span class="k">Nothing</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' セクショングループ件数を取得する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;returns&gt;セクショングループ件数&lt;/returns&gt;</span>
    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">GetSectionGroupCount</span><span class="p">()</span> <span class="ow">As</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="nv">secCount</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)()</span>

        <span class="k">For</span> <span class="k">Each</span> <span class="n">section</span> <span class="ow">In</span> <span class="n">SectionDic</span>
            <span class="k">If</span> <span class="n">section</span><span class="p">.</span><span class="n">Key</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
                <span class="k">Dim</span> <span class="nv">key</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">Key</span>
                <span class="k">Dim</span> <span class="nv">keyno</span> <span class="o">=</span> <span class="n">GetKeyAndNo</span><span class="p">(</span><span class="n">section</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">SectionSeparator</span><span class="p">)</span>
                <span class="k">Dim</span> <span class="nv">cnt</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">If</span> <span class="n">keyno</span> <span class="ow">IsNot</span> <span class="k">Nothing</span> <span class="k">Then</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span>
                    <span class="k">If</span> <span class="n">secCount</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">Then</span>
                        <span class="n">cnt</span> <span class="o">=</span> <span class="n">secCount</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">End</span> <span class="k">If</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="n">secCount</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">=</span> <span class="n">cnt</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>

        <span class="k">Return</span> <span class="n">secCount</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' XMLデータに変換する</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;returns&gt;XMLデータ&lt;/returns&gt;</span>
    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">ConvertDicToXML</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">If</span> <span class="n">SectionDic</span><span class="p">.</span><span class="n">Count</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span> <span class="k">Return</span> <span class="s">""</span>

        <span class="k">Dim</span> <span class="nv">sb</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">StringBuilder</span><span class="p">()</span>

        <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="s">"&lt;?xml version = '1.0' encoding = 'utf-8' ?&gt;"</span><span class="p">)</span>
        <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="err">[</span><span class="kt">String</span><span class="err">]</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"&lt;{0}&gt;"</span><span class="p">,</span> <span class="n">RootName</span><span class="p">))</span>

        <span class="c1">' 同一名カウントチェック</span>
        <span class="k">Dim</span> <span class="nv">secCount</span> <span class="ow">As</span> <span class="n">OrderedDictionary</span><span class="p">(</span><span class="k">Of</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetSectionGroupCount</span><span class="p">()</span>

        <span class="c1">' XMLデータ生成</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">section</span> <span class="ow">In</span> <span class="n">SectionDic</span>
            <span class="k">Dim</span> <span class="nv">grpno</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">Dim</span> <span class="nv">key</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">Key</span>
            <span class="k">Dim</span> <span class="nv">keyno</span> <span class="o">=</span> <span class="n">GetKeyAndNo</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">SectionSeparator</span><span class="p">)</span>
            <span class="k">If</span> <span class="n">keyno</span> <span class="ow">IsNot</span> <span class="k">Nothing</span> <span class="k">Then</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span>
                <span class="n">grpno</span> <span class="o">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item2</span>
            <span class="k">End</span> <span class="k">If</span>
            <span class="c1">' 複数存在するならグループ扱い</span>
            <span class="k">If</span> <span class="n">grpno</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">AndAlso</span> <span class="n">key</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="ow">AndAlso</span> <span class="n">secCount</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">Then</span> <span class="n">grpno</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1">' パラメーターが連番のみかチェック</span>
            <span class="k">Dim</span> <span class="nv">isDataGrp</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">True</span>
            <span class="k">For</span> <span class="k">Each</span> <span class="n">pair</span> <span class="ow">In</span> <span class="n">section</span><span class="p">.</span><span class="n">Value</span>
                <span class="k">If</span> <span class="k">Not</span> <span class="n">Regex</span><span class="p">.</span><span class="n">IsMatch</span><span class="p">(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="s">"[0-9]$"</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="n">isDataGrp</span> <span class="o">=</span> <span class="k">False</span>
                    <span class="k">Exit</span> <span class="k">For</span>
                <span class="k">End</span> <span class="k">If</span>
            <span class="k">Next</span>

            <span class="k">Dim</span> <span class="nv">grp</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="k">If</span><span class="p">(</span><span class="n">grpno</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">" {0}='{1}'"</span><span class="p">,</span> <span class="n">SECTION_GROUP_ATTR</span><span class="p">,</span> <span class="n">grpno</span><span class="p">),</span> <span class="s">""</span><span class="p">)</span>
            <span class="k">If</span> <span class="n">key</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span> <span class="n">sb</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"&lt;{0}{1}"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">grp</span><span class="p">))</span>

            <span class="k">Dim</span> <span class="nv">no</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">Dim</span> <span class="nv">oldNo</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">Dim</span> <span class="nv">pkey</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span>
            <span class="k">Dim</span> <span class="nv">isFirst</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>
            <span class="k">For</span> <span class="k">Each</span> <span class="n">pair</span> <span class="ow">In</span> <span class="n">section</span><span class="p">.</span><span class="n">Value</span>
                <span class="n">pkey</span> <span class="o">=</span> <span class="n">pair</span><span class="p">.</span><span class="n">Key</span>
                <span class="k">If</span> <span class="n">key</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
                    <span class="k">If</span> <span class="n">isDataGrp</span> <span class="k">Then</span>
                        <span class="n">keyno</span> <span class="o">=</span> <span class="n">GetKeyAndNo</span><span class="p">(</span><span class="n">pkey</span><span class="p">,</span> <span class="n">KeySeparator</span><span class="p">)</span>
                        <span class="k">If</span> <span class="n">keyno</span> <span class="ow">IsNot</span> <span class="k">Nothing</span> <span class="k">Then</span>
                            <span class="n">pkey</span> <span class="o">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span>
                            <span class="n">no</span> <span class="o">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item2</span>
                        <span class="k">End</span> <span class="k">If</span>
                        <span class="k">If</span> <span class="n">no</span> <span class="o">&lt;&gt;</span> <span class="n">oldNo</span> <span class="ow">AndAlso</span> <span class="n">no</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
                            <span class="k">If</span> <span class="n">isFirst</span> <span class="k">Then</span>
                                <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="s">" /&gt;"</span><span class="p">)</span>
                                <span class="n">sb</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"&lt;{0}{1}"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">grp</span><span class="p">))</span>
                            <span class="k">End</span> <span class="k">If</span>
                            <span class="n">sb</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">" {0}='{1}'"</span><span class="p">,</span> <span class="n">PARAMETER_INDEX_ATTR</span><span class="p">,</span> <span class="n">no</span><span class="p">))</span>
                        <span class="k">End</span> <span class="k">If</span>
                        <span class="n">oldNo</span> <span class="o">=</span> <span class="n">no</span>
                        <span class="n">isFirst</span> <span class="o">=</span> <span class="k">True</span>
                    <span class="k">End</span> <span class="k">If</span>
                    <span class="n">sb</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">" {0}='{1}'"</span><span class="p">,</span> <span class="n">pkey</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span><span class="p">))</span>
                <span class="k">Else</span>
                    <span class="c1">' セクションが無い場合</span>
                    <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="kt">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"&lt;{0}&gt;{1}&lt;/{0}&gt;"</span><span class="p">,</span> <span class="n">pkey</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span><span class="p">))</span>
                <span class="k">End</span> <span class="k">If</span>
            <span class="k">Next</span>
            <span class="k">If</span> <span class="n">key</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
                <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="s">" /&gt;"</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>
        <span class="n">sb</span><span class="p">.</span><span class="n">AppendLine</span><span class="p">(</span><span class="err">[</span><span class="kt">String</span><span class="err">]</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"&lt;/{0}&gt;"</span><span class="p">,</span> <span class="n">RootName</span><span class="p">))</span>

        <span class="k">Return</span> <span class="n">sb</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span>
    <span class="k">End</span> <span class="k">Function</span>

    <span class="c1">''' &lt;summary&gt;</span>
    <span class="c1">''' 空行判定</span>
    <span class="c1">''' &lt;/summary&gt;</span>
    <span class="c1">''' &lt;param name="line"&gt;対象文字列&lt;/param&gt;</span>
    <span class="c1">''' &lt;returns&gt;true:空行 / false:空行以外&lt;/returns&gt;</span>
    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">IsBlank</span><span class="p">(</span><span class="n">str</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="c1">' 空行(全角スペース、タブ、半角スペースのみを対象にする)</span>
        <span class="k">Dim</span> <span class="nv">re</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Regex</span><span class="p">(</span><span class="s">"\s"</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="nv">blankline</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>

        <span class="k">Return</span> <span class="p">(</span><span class="n">blankline</span><span class="p">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Function</span>
<span class="k">End</span> <span class="k">Class</span>
</code></pre></div>
</div>

<p>【2018/06/22追記】C#を追加しました。<br>
【2018/08/25追記】VB版とC#版が違うのに気が付きました。C#版が古かった。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">IniManager.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text.RegularExpressions</span><span class="p">;</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">IniManager</span>
<span class="p">{</span>
    <span class="c1">// Iniファイル情報格納(OrderedDictionary型)</span>
    <span class="k">public</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">SectionDic</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="c1">// Iniファイル情報格納(DataSet型)</span>
    <span class="k">public</span> <span class="n">DataSet</span> <span class="n">SectionDataSet</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// エンコーディング</span>
    <span class="k">public</span> <span class="n">Encoding</span> <span class="n">Encording</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// セクション番号区切り文字</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">SectionSeparator</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="c1">// キー番号区切り文字</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">KeySeparator</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="c1">// セクションと値の間の空白</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">InsertSpace</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// XML用ルート名</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">RootName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// セクショングループ用属性値</span>
    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">SECTION_GROUP_ATTR</span> <span class="p">=</span> <span class="s">"Grp"</span><span class="p">;</span>
    <span class="c1">// パラメーターグループ用属性値</span>
    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">PARAMETER_INDEX_ATTR</span> <span class="p">=</span> <span class="s">"Idx"</span><span class="p">;</span>
    <span class="c1">// XML用ルート名</span>
    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">DEFAULT_ROOT_NAMER</span> <span class="p">=</span> <span class="s">"Root"</span><span class="p">;</span>

    <span class="c1">// セクション用正規表現パターン</span>
    <span class="k">const</span> <span class="kt">string</span> <span class="n">SECTION_PATTERN</span> <span class="p">=</span> <span class="s">@"^\s*\[(?&lt;section&gt;[^\]]+)\].*$"</span><span class="p">;</span>
    <span class="c1">// パラメーター用正規表現パターン</span>
    <span class="k">const</span> <span class="kt">string</span> <span class="n">PARAMETER_PATTERN</span> <span class="p">=</span> <span class="s">@"^\s*(?&lt;name&gt;[^=]+)=(?&lt;value&gt;.*?)(\s+;(?&lt;comment&gt;.*))?$"</span><span class="p">;</span>

    <span class="c1">// コンストラクタ</span>
    <span class="k">public</span> <span class="nf">IniManager</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Encording</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">;</span>
        <span class="n">SectionSeparator</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
        <span class="n">KeySeparator</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
        <span class="n">InsertSpace</span> <span class="p">=</span> <span class="s">" "</span><span class="p">;</span>
        <span class="n">RootName</span> <span class="p">=</span> <span class="n">DEFAULT_ROOT_NAMER</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 設定値を取得する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="section"&gt;セクション名&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="keyname"&gt;キー名&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">GetString</span><span class="p">(</span><span class="kt">string</span> <span class="n">section</span><span class="p">,</span> <span class="kt">string</span> <span class="n">keyname</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(!</span><span class="n">SectionDic</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">section</span><span class="p">)</span> <span class="p">||</span>
            <span class="p">!</span><span class="n">SectionDic</span><span class="p">[</span><span class="n">section</span><span class="p">].</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">keyname</span><span class="p">))</span> <span class="k">return</span> <span class="s">""</span><span class="p">;</span>

        <span class="k">return</span> <span class="n">SectionDic</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="n">keyname</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 設定値を取得する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="section"&gt;セクション名&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">GetString</span><span class="p">(</span><span class="kt">string</span> <span class="n">keyname</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">GetString</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">keyname</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 設定情報を取得する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="tableName"&gt;テーブル名&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="n">DataTable</span> <span class="nf">GetTable</span><span class="p">(</span><span class="kt">string</span> <span class="n">tableName</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">SectionDataSet</span><span class="p">.</span><span class="n">Tables</span><span class="p">[</span><span class="n">tableName</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 設定値を更新する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="section"&gt;セクション名&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="keyname"&gt;キー名&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="value"&gt;設定値&lt;/param&gt;</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">SetString</span><span class="p">(</span><span class="kt">string</span> <span class="n">section</span><span class="p">,</span> <span class="kt">string</span> <span class="n">keyname</span><span class="p">,</span> <span class="kt">string</span> <span class="k">value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">SectionDic</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="n">keyname</span><span class="p">]</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Iniファイル読み込み</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">ReadIni</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isDataSet</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
    <span class="p">{</span>

        <span class="c1">// Ini情報のセット</span>
        <span class="n">SectionDic</span> <span class="p">=</span> <span class="nf">GetSections</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>

        <span class="c1">// DataSet型に変換</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isDataSet</span><span class="p">)</span> <span class="k">return</span> <span class="nf">ToDataSet</span><span class="p">();</span>

        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// DataSet型に変換する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">ToDataSet</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">SectionDataSet</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DataSet</span><span class="p">();</span>

        <span class="c1">// XMLデータに変換する</span>
        <span class="kt">string</span> <span class="n">xml</span> <span class="p">=</span> <span class="nf">ConvertDicToXML</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">xml</span> <span class="p">==</span> <span class="s">""</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

        <span class="c1">// DataSet型に変換する</span>
        <span class="k">using</span> <span class="p">(</span><span class="n">StringReader</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringReader</span><span class="p">(</span><span class="n">xml</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">SectionDataSet</span><span class="p">.</span><span class="nf">ReadXml</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Iniファイル情報を取得する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="nf">GetSections</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">Encording</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">sections</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;(</span><span class="n">StringComparer</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">regexSection</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Regex</span><span class="p">(</span><span class="n">SECTION_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="p">|</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">regexNameValue</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Regex</span><span class="p">(</span><span class="n">PARAMETER_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="p">|</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">currentSection</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

            <span class="c1">// セクション名が明示されていない先頭部分のセクション名を""として扱う</span>
            <span class="n">sections</span><span class="p">[</span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

            <span class="k">for</span> <span class="p">(;;)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">line</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">line</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                    <span class="k">break</span><span class="p">;</span>

                <span class="c1">// 空行は読み飛ばす</span>
                <span class="k">if</span> <span class="p">(</span><span class="nf">IsBlank</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
                    <span class="k">continue</span><span class="p">;</span>

                <span class="c1">// コメント行は読み飛ばす</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="nf">StartsWith</span><span class="p">(</span><span class="s">";"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">))</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="nf">StartsWith</span><span class="p">(</span><span class="s">"#"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">))</span>
                    <span class="k">continue</span><span class="p">;</span>

                <span class="kt">var</span> <span class="n">matchNameValue</span> <span class="p">=</span> <span class="n">regexNameValue</span><span class="p">.</span><span class="nf">Match</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">matchNameValue</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">// name=valueの行</span>
                    <span class="n">sections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">][</span><span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">[</span><span class="s">"name"</span><span class="p">].</span><span class="n">Value</span><span class="p">.</span><span class="nf">Trim</span><span class="p">()]</span> <span class="p">=</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">[</span><span class="s">"value"</span><span class="p">].</span><span class="n">Value</span><span class="p">.</span><span class="nf">Trim</span><span class="p">();</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="kt">var</span> <span class="n">matchSection</span> <span class="p">=</span> <span class="n">regexSection</span><span class="p">.</span><span class="nf">Match</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">matchSection</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">// [section]の行</span>
                    <span class="n">currentSection</span> <span class="p">=</span> <span class="n">matchSection</span><span class="p">.</span><span class="n">Groups</span><span class="p">[</span><span class="s">"section"</span><span class="p">].</span><span class="n">Value</span><span class="p">;</span>

                    <span class="k">if</span> <span class="p">(!</span><span class="n">sections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">currentSection</span><span class="p">))</span>
                        <span class="n">sections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">sections</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Iniファイルの書き込み</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="secyions"&gt;更新情報&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">sections</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">result</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>

        <span class="c1">// Iniファイル情報を取得する</span>
        <span class="kt">var</span> <span class="n">dic</span> <span class="p">=</span> <span class="nf">GetSections</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>

        <span class="c1">// 並び替えた情報を格納</span>
        <span class="kt">var</span> <span class="n">sortSections</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;(</span><span class="n">StringComparer</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">);</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sec</span> <span class="k">in</span> <span class="n">dic</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">pair</span> <span class="k">in</span> <span class="n">sec</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">sections</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">].</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(!</span><span class="n">sortSections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">))</span>
                        <span class="n">sortSections</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

                    <span class="n">sortSections</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">][</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">]</span> <span class="p">=</span> <span class="n">sections</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">][</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 存在しなかったら追記</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sec</span> <span class="k">in</span> <span class="n">sections</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">pair</span> <span class="k">in</span> <span class="n">sec</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// 既に登録済みなら何もしない</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sortSections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">sortSections</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">].</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">))</span>
                    <span class="k">continue</span><span class="p">;</span>

                <span class="c1">// 未登録なら追加する</span>
                <span class="k">if</span> <span class="p">(!</span><span class="n">sortSections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">))</span>
                    <span class="n">sortSections</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

                <span class="n">sortSections</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">][</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">]</span> <span class="p">=</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>


        <span class="c1">// セクションの最終キーを格納</span>
        <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">lastdic</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sec</span> <span class="k">in</span> <span class="n">dic</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">].</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">pair</span> <span class="p">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">].</span><span class="nf">Last</span><span class="p">();</span>
                <span class="n">lastdic</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//result = WriteIni(section.Key, pair.Key, pair.Value, filePath);</span>
        <span class="c1">//if (!result) return false;</span>

        <span class="n">result</span> <span class="p">=</span> <span class="nf">Write</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sortSections</span><span class="p">,</span> <span class="n">lastdic</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// iniファイルの書き込み</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="sectionName"&gt;セクション名&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="keyName"&gt;キー名&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="value"&gt;値&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">,</span> <span class="kt">string</span> <span class="n">sectionName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">keyName</span><span class="p">,</span> <span class="kt">string</span> <span class="k">value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">sections</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;();</span>

        <span class="n">sections</span><span class="p">[</span><span class="n">sectionName</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
        <span class="n">sections</span><span class="p">[</span><span class="n">sectionName</span><span class="p">][</span><span class="n">keyName</span><span class="p">]</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>

        <span class="k">return</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sections</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Iniファイルの書き込み</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="dsSections"&gt;セクション情報&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">DataSet</span> <span class="n">dsSections</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">sections</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;();</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="n">DataTable</span> <span class="n">dt</span> <span class="k">in</span> <span class="n">dsSections</span><span class="p">.</span><span class="n">Tables</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">ToDictionary</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="k">ref</span> <span class="n">sections</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sections</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Iniファイルの書き込み</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="filePath"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="dtSections"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">DataTable</span> <span class="n">dtSections</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dtSections</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

        <span class="kt">var</span> <span class="n">sections</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;();</span>
        <span class="nf">ToDictionary</span><span class="p">(</span><span class="n">dtSections</span><span class="p">,</span> <span class="k">ref</span> <span class="n">sections</span><span class="p">);</span>

        <span class="k">return</span> <span class="nf">WriteIni</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sections</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Dictionary型に変換する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="dtSections"&gt;セクション情報&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="sections"&gt;更新セクション情報&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">ToDictionary</span><span class="p">(</span><span class="n">DataTable</span> <span class="n">dtSections</span><span class="p">,</span> <span class="k">ref</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">sections</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="n">DataRow</span> <span class="n">dr</span> <span class="k">in</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">Rows</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">groupNo</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dtSections</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">SECTION_GROUP_ATTR</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">groupNo</span> <span class="p">=</span> <span class="n">dr</span><span class="p">[</span><span class="n">SECTION_GROUP_ATTR</span><span class="p">].</span><span class="nf">ToString</span><span class="p">();</span>
                <span class="k">if</span><span class="p">(</span><span class="n">groupNo</span> <span class="p">==</span> <span class="s">"0"</span><span class="p">)</span> <span class="n">groupNo</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kt">string</span> <span class="n">sectionName</span> <span class="p">=</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">TableName</span> <span class="p">+</span> <span class="n">SectionSeparator</span> <span class="p">+</span> <span class="n">groupNo</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sectionName</span> <span class="p">==</span> <span class="n">RootName</span><span class="p">)</span> <span class="n">sectionName</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(!</span><span class="n">sections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">sectionName</span><span class="p">))</span>
                <span class="n">sections</span><span class="p">[</span><span class="n">sectionName</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

            <span class="kt">string</span> <span class="n">indexNo</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dtSections</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">PARAMETER_INDEX_ATTR</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">indexNo</span> <span class="p">=</span> <span class="n">dr</span><span class="p">[</span><span class="n">PARAMETER_INDEX_ATTR</span><span class="p">].</span><span class="nf">ToString</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="n">DataColumn</span> <span class="n">column</span> <span class="k">in</span> <span class="n">dtSections</span><span class="p">.</span><span class="n">Columns</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="p">==</span> <span class="n">SECTION_GROUP_ATTR</span> <span class="p">||</span>
                    <span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="p">==</span> <span class="n">PARAMETER_INDEX_ATTR</span> <span class="p">||</span>
                    <span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="p">==</span> <span class="n">RootName</span> <span class="p">+</span> <span class="s">"_Id"</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>

                <span class="kt">string</span> <span class="n">keyName</span> <span class="p">=</span> <span class="n">column</span><span class="p">.</span><span class="n">ColumnName</span> <span class="p">+</span> <span class="n">KeySeparator</span> <span class="p">+</span> <span class="n">indexNo</span><span class="p">;</span>
                <span class="kt">string</span> <span class="n">keyName2</span> <span class="p">=</span> <span class="n">keyName</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">indexNo</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="kt">var</span> <span class="n">keyno</span> <span class="p">=</span> <span class="nf">GetKeyAndNo</span><span class="p">(</span><span class="n">keyName</span><span class="p">,</span> <span class="n">KeySeparator</span><span class="p">);</span>
                    <span class="n">keyName2</span> <span class="p">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">sections</span><span class="p">[</span><span class="n">sectionName</span><span class="p">][</span><span class="n">keyName</span><span class="p">]</span> <span class="p">=</span> <span class="n">dr</span><span class="p">[</span><span class="n">keyName2</span><span class="p">].</span><span class="nf">ToString</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// iniファイルの書き込みメイン処理</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="sortSections"&gt;ソート済更新情報&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="lastdic"&gt;最終パラメーター情報&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true : 正常 / false : 異常&lt;/returns&gt;</span>
    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">Write</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">sortSections</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">lastdic</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">isSave</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="n">isWrite</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>
        <span class="kt">bool</span> <span class="n">isExistsSection</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>

        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">Encording</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">sections</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;(</span><span class="n">StringComparer</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">regexSection</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Regex</span><span class="p">(</span><span class="n">SECTION_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="p">|</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">regexNameValue</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Regex</span><span class="p">(</span><span class="n">PARAMETER_PATTERN</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Singleline</span> <span class="p">|</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">CultureInvariant</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">currentSection</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

            <span class="c1">// セクション名が明示されていない先頭部分のセクション名を""として扱う</span>
            <span class="n">sections</span><span class="p">[</span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

            <span class="k">for</span> <span class="p">(;;)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">line</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">line</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                    <span class="k">break</span><span class="p">;</span>

                <span class="c1">// 空行は読み飛ばす</span>
                <span class="kt">bool</span> <span class="n">isContinue</span> <span class="p">=</span> <span class="nf">IsBlank</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(!</span><span class="n">isContinue</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">// コメント行は読み飛ばす</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="nf">StartsWith</span><span class="p">(</span><span class="s">";"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">))</span>
                        <span class="n">isContinue</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="nf">StartsWith</span><span class="p">(</span><span class="s">"#"</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">Ordinal</span><span class="p">))</span>
                        <span class="n">isContinue</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

                    <span class="c1">// 全て終わった</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sortSections</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
                        <span class="n">isContinue</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">isContinue</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="c1">// 存在しなかったら追記</span>
                <span class="kt">var</span> <span class="n">matchNameValue</span> <span class="p">=</span> <span class="n">regexNameValue</span><span class="p">.</span><span class="nf">Match</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sortSections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">currentSection</span> <span class="p">==</span> <span class="s">""</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">isExistsSection</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">isExistsSection</span> <span class="p">&amp;&amp;</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="kt">string</span> <span class="n">newline</span> <span class="p">=</span> <span class="n">line</span><span class="p">;</span>
                    <span class="c1">// name=valueの行</span>
                    <span class="kt">string</span> <span class="n">keyName</span> <span class="p">=</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">[</span><span class="s">"name"</span><span class="p">].</span><span class="n">Value</span><span class="p">.</span><span class="nf">Trim</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sortSections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">].</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">keyName</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">isWrite</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

                        <span class="kt">string</span> <span class="k">value</span> <span class="p">=</span> <span class="n">sortSections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">][</span><span class="n">keyName</span><span class="p">];</span>
                        <span class="n">sortSections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">].</span><span class="nf">Remove</span><span class="p">(</span><span class="n">keyName</span><span class="p">);</span>

                        <span class="kt">string</span> <span class="n">curvalue</span> <span class="p">=</span> <span class="n">matchNameValue</span><span class="p">.</span><span class="n">Groups</span><span class="p">[</span><span class="s">"value"</span><span class="p">].</span><span class="n">Value</span><span class="p">.</span><span class="nf">Trim</span><span class="p">();</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">curvalue</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">curvalue</span> <span class="p">!=</span> <span class="k">value</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="c1">// 現在値があるなら置換する</span>
                                <span class="k">if</span><span class="p">(</span><span class="n">curvalue</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">" "</span><span class="p">))</span>
                                <span class="p">{</span>
                                    <span class="c1">// 現在値に空白が含まれていた場合、単純な置換(キーやコメントなども置換される可能性がある)</span>
                                    <span class="n">newline</span> <span class="p">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="n">curvalue</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span>
                                <span class="p">}</span>
                                <span class="k">else</span>
                                <span class="p">{</span>
                                    <span class="c1">// 現在値に空白が含まれていない場合、値のみ置換</span>
                                    <span class="n">newline</span> <span class="p">=</span> <span class="n">Regex</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s">@"(=\s+|=)([^;|\s]+)(\s+;.*|)"</span><span class="p">,</span> <span class="s">"${1}"</span> <span class="p">+</span> <span class="k">value</span> <span class="p">+</span> <span class="s">"${3}"</span><span class="p">);</span>
                                <span class="p">}</span>
                                <span class="c1">// 現在値と違う値なら保存する</span>
                                <span class="n">isSave</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="k">else</span>
                        <span class="p">{</span>
                            <span class="c1">// = の位置に半角スペースを1つ空けて値をセット</span>
                            <span class="n">newline</span> <span class="p">=</span> <span class="n">Regex</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s">@"(=)(\s[^;].*)"</span><span class="p">,</span> <span class="s">"${1}"</span> <span class="p">+</span> <span class="n">InsertSpace</span> <span class="p">+</span> <span class="k">value</span> <span class="p">+</span> <span class="s">"${2}"</span><span class="p">);</span>
                            <span class="k">if</span><span class="p">(</span><span class="k">value</span> <span class="p">!=</span> <span class="s">""</span> <span class="p">&amp;&amp;</span> <span class="n">newline</span><span class="p">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="k">value</span><span class="p">)</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="n">newline</span> <span class="p">=</span> <span class="n">Regex</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s">@"(=)"</span><span class="p">,</span> <span class="s">"${1}"</span> <span class="p">+</span> <span class="n">InsertSpace</span> <span class="p">+</span> <span class="k">value</span><span class="p">);</span>
                            <span class="p">}</span>
                            <span class="c1">// 現在値と違う値なら保存する</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">newline</span> <span class="p">!=</span> <span class="n">line</span><span class="p">)</span> <span class="n">isSave</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>

                    <span class="c1">// 書き換え行のセット</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="n">newline</span><span class="p">);</span>

                    <span class="c1">// 新規パラメーターがあれば最終キー後に追記する</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">lastdic</span><span class="p">[</span><span class="n">currentSection</span><span class="p">]</span> <span class="p">==</span> <span class="n">keyName</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">s</span> <span class="k">in</span> <span class="n">sortSections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">])</span>
                        <span class="p">{</span>
                            <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0}"</span> <span class="p">+</span> <span class="n">InsertSpace</span> <span class="p">+</span> <span class="s">"="</span> <span class="p">+</span> <span class="n">InsertSpace</span> <span class="p">+</span> <span class="s">"{1}"</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">Value</span><span class="p">));</span>
                        <span class="p">}</span>
                        <span class="n">sortSections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">].</span><span class="nf">Clear</span><span class="p">();</span>
                    <span class="p">}</span>

                    <span class="c1">// セクション内のパラメーターが存在しない</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sortSections</span><span class="p">[</span><span class="n">currentSection</span><span class="p">].</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="c1">// セクションを削除する</span>
                        <span class="n">sortSections</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">currentSection</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="n">isExistsSection</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="kt">var</span> <span class="n">matchSection</span> <span class="p">=</span> <span class="n">regexSection</span><span class="p">.</span><span class="nf">Match</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">matchSection</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="kt">string</span> <span class="n">sectionName</span> <span class="p">=</span> <span class="n">matchSection</span><span class="p">.</span><span class="n">Groups</span><span class="p">[</span><span class="s">"section"</span><span class="p">].</span><span class="n">Value</span><span class="p">.</span><span class="nf">Trim</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">sortSections</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">sectionName</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">currentSection</span> <span class="p">=</span> <span class="n">sectionName</span><span class="p">;</span>
                        <span class="c1">// 対象のセクション行が存在</span>
                        <span class="n">isExistsSection</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="c1">// 行のセット</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 新規セクションとパラメーターを追記する</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sec</span> <span class="k">in</span> <span class="n">sortSections</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 未登録のセクションを追加する(一行空行)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="n">Length</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span> <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>
            <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"[{0}]"</span><span class="p">,</span> <span class="n">sec</span><span class="p">.</span><span class="n">Key</span><span class="p">));</span>
            <span class="n">isWrite</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">isSave</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">pair</span> <span class="k">in</span> <span class="n">sec</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// パラメーターを追加する</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0}"</span> <span class="p">+</span> <span class="n">InsertSpace</span> <span class="p">+</span> <span class="s">"="</span> <span class="p">+</span> <span class="n">InsertSpace</span> <span class="p">+</span> <span class="s">"{1}"</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 保存処理</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isWrite</span> <span class="p">&amp;&amp;</span> <span class="n">isSave</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">File</span><span class="p">.</span><span class="nf">WriteAllText</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(),</span> <span class="n">Encording</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 末尾数値分割処理</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="value"&gt;対象キー&lt;/param&gt;</span>
    <span class="c1">/// &lt;param name="separator"&gt;区切り文字&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;分割情報&lt;/returns&gt;</span>
    <span class="k">private</span> <span class="n">Tuple</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span> <span class="nf">GetKeyAndNo</span><span class="p">(</span><span class="kt">string</span> <span class="k">value</span><span class="p">,</span> <span class="kt">string</span> <span class="n">separator</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Regex</span><span class="p">.</span><span class="nf">IsMatch</span><span class="p">(</span><span class="k">value</span><span class="p">,</span> <span class="s">@"[0-9]$"</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">pattern</span> <span class="p">=</span> <span class="s">@"(?&lt;Key&gt;.*\D)(?&lt;No&gt;\d+$)"</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">separator</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span>
                <span class="n">pattern</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">@"(?&lt;Key&gt;.*){0}(?&lt;No&gt;\d+$)"</span><span class="p">,</span> <span class="n">separator</span><span class="p">);</span>

            <span class="n">Regex</span> <span class="n">reg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">);</span>
            <span class="n">Match</span> <span class="n">mat</span> <span class="p">=</span> <span class="n">reg</span><span class="p">.</span><span class="nf">Match</span><span class="p">(</span><span class="k">value</span><span class="p">);</span>
            <span class="kt">string</span> <span class="n">key</span> <span class="p">=</span> <span class="n">mat</span><span class="p">.</span><span class="nf">Result</span><span class="p">(</span><span class="s">"${Key}"</span><span class="p">);</span>
            <span class="kt">string</span> <span class="n">no</span> <span class="p">=</span> <span class="n">mat</span><span class="p">.</span><span class="nf">Result</span><span class="p">(</span><span class="s">"${No}"</span><span class="p">);</span>

            <span class="k">return</span> <span class="k">new</span> <span class="n">Tuple</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;(</span><span class="n">key</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">no</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">else</span>
            <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// セクショングループ件数を取得する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;returns&gt;セクショングループ件数&lt;/returns&gt;</span>
    <span class="k">private</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span> <span class="nf">GetSectionGroupCount</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span> <span class="n">secCount</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;();</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">section</span> <span class="k">in</span> <span class="n">SectionDic</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">section</span><span class="p">.</span><span class="n">Key</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">key</span> <span class="p">=</span> <span class="n">section</span><span class="p">.</span><span class="n">Key</span><span class="p">;</span>
                <span class="kt">var</span> <span class="n">keyno</span> <span class="p">=</span> <span class="nf">GetKeyAndNo</span><span class="p">(</span><span class="n">section</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">SectionSeparator</span><span class="p">);</span>
                <span class="kt">int</span> <span class="n">cnt</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">keyno</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">key</span> <span class="p">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">secCount</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">cnt</span> <span class="p">=</span> <span class="n">secCount</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
                        <span class="n">cnt</span><span class="p">++;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">secCount</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">=</span> <span class="n">cnt</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">secCount</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// XMLデータに変換する</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;returns&gt;XMLデータ&lt;/returns&gt;</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nf">ConvertDicToXML</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">SectionDic</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span> <span class="s">""</span><span class="p">;</span>

        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

        <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="s">"&lt;?xml version = '1.0' encoding = 'utf-8' ?&gt;"</span><span class="p">);</span>
        <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"&lt;{0}&gt;"</span><span class="p">,</span> <span class="n">RootName</span><span class="p">));</span>

        <span class="c1">// 同一名カウントチェック</span>
        <span class="n">OrderedDictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span> <span class="n">secCount</span> <span class="p">=</span> <span class="nf">GetSectionGroupCount</span><span class="p">();</span>

        <span class="c1">// XMLデータ生成</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">section</span> <span class="k">in</span> <span class="n">SectionDic</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">grpno</span> <span class="p">=</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">key</span> <span class="p">=</span> <span class="n">section</span><span class="p">.</span><span class="n">Key</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">keyno</span> <span class="p">=</span> <span class="nf">GetKeyAndNo</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">SectionSeparator</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">keyno</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">key</span> <span class="p">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
                <span class="n">grpno</span> <span class="p">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item2</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="c1">// 複数存在するならグループ扱い</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">grpno</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span> <span class="p">&amp;&amp;</span> <span class="n">key</span> <span class="p">!=</span> <span class="s">""</span> <span class="p">&amp;&amp;</span> <span class="n">secCount</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="n">grpno</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

            <span class="c1">// パラメーターが連番のみかチェック</span>
            <span class="kt">bool</span> <span class="n">isDataGrp</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">pair</span> <span class="k">in</span> <span class="n">section</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(!</span><span class="n">Regex</span><span class="p">.</span><span class="nf">IsMatch</span><span class="p">(</span><span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="s">@"[0-9]$"</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="n">isDataGrp</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="kt">string</span> <span class="n">grp</span> <span class="p">=</span> <span class="n">grpno</span> <span class="p">&gt;</span> <span class="p">-</span><span class="m">1</span> <span class="p">?</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">" {0}='{1}'"</span><span class="p">,</span> <span class="n">SECTION_GROUP_ATTR</span> <span class="p">,</span> <span class="n">grpno</span><span class="p">)</span> <span class="p">:</span> <span class="s">""</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span> <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"&lt;{0}{1}"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">grp</span><span class="p">));</span>

            <span class="kt">int</span> <span class="n">no</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">oldNo</span> <span class="p">=</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">pkey</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="kt">bool</span> <span class="n">isFirst</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">pair</span> <span class="k">in</span> <span class="n">section</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">pkey</span> <span class="p">=</span> <span class="n">pair</span><span class="p">.</span><span class="n">Key</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">isDataGrp</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">keyno</span> <span class="p">=</span> <span class="nf">GetKeyAndNo</span><span class="p">(</span><span class="n">pkey</span><span class="p">,</span> <span class="n">KeySeparator</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">keyno</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="n">pkey</span> <span class="p">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
                            <span class="n">no</span> <span class="p">=</span> <span class="n">keyno</span><span class="p">.</span><span class="n">Item2</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">no</span> <span class="p">!=</span> <span class="n">oldNo</span> <span class="p">&amp;&amp;</span> <span class="n">no</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">isFirst</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="s">" /&gt;"</span><span class="p">);</span>
                                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"&lt;{0}{1}"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">grp</span><span class="p">));</span>
                            <span class="p">}</span>
                            <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">" {0}='{1}'"</span><span class="p">,</span> <span class="n">PARAMETER_INDEX_ATTR</span><span class="p">,</span> <span class="n">no</span><span class="p">));</span>
                        <span class="p">}</span>
                        <span class="n">oldNo</span> <span class="p">=</span> <span class="n">no</span><span class="p">;</span>
                        <span class="n">isFirst</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">" {0}='{1}'"</span><span class="p">,</span> <span class="n">pkey</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span><span class="p">));</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="c1">// セクションが無い場合</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"&lt;{0}&gt;{1}&lt;/{0}&gt;"</span><span class="p">,</span> <span class="n">pkey</span><span class="p">,</span> <span class="n">pair</span><span class="p">.</span><span class="n">Value</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="s">""</span><span class="p">)</span> <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="s">" /&gt;"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">sb</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"&lt;/{0}&gt;"</span><span class="p">,</span> <span class="n">RootName</span><span class="p">));</span>

        <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 空行判定</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="line"&gt;対象文字列&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;true:空行 / false:空行以外&lt;/returns&gt;</span>
    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">IsBlank</span><span class="p">(</span><span class="kt">string</span> <span class="n">str</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 空行(全角スペース、タブ、半角スペースのみを対象にする)</span>
        <span class="n">Regex</span> <span class="n">re</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Regex</span><span class="p">(</span><span class="s">@"\s"</span><span class="p">);</span>
        <span class="kt">string</span> <span class="n">blankline</span> <span class="p">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">blankline</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="m">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="ordereddictionary型について" class="fragment"></span><a href="#ordereddictionary%E5%9E%8B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>OrderedDictionary型について</h2>

<p>IniManagerクラスの中で、次サイトの「ジェネリック版OrderedDictionary」を使用しています。読み込みだけならDictionary型で充分だったのですが、書き込みする上ではOrderedDictionaryのように順序の保証が必要でした。<br>
<a href="http://smdn.jp/programming/netfx/tips/generic_ordereddictionary/" rel="nofollow noopener" target="_blank">ジェネリック版OrderedDictionary - smdn</a></p>

<p>このジェネリック版OrderedDictionaryは、C#版しか公開されていないのですが、<a href="http://www.icsharpcode.net/OpenSource/SD/Download/Default.aspx" rel="nofollow noopener" target="_blank">SharpDevelop Ver 4.4</a>のC#からVB.NETへのコンバート機能を使用しました。ちなみに最新版のSharpDevelop Ver 5には変換機能がつかなくなりました。</p>

<p>正しく変換されなかったところは次のように修正しました。</p>

<div class="code-frame" data-lang="bat">
<div class="code-lang"><span class="bold">OrderedDictionary.vb</span></div>
<div class="highlight"><pre class="with-code"><code>#degine <span class="kd">ENABLE_KEYS_VALUES</span>
↓
#Const <span class="kd">ENABLE_KEYS_VALUES</span> <span class="o">=</span> <span class="kd">True</span>

<span class="kd">Public</span> <span class="kd">Overloads</span> <span class="kd">Function</span> <span class="kd">Remove</span><span class="o">(</span><span class="kd">key</span> <span class="kd">As</span> <span class="kd">TKey</span><span class="o">)</span> <span class="kd">As</span> <span class="kd">Boolean</span> <span class="kd">Implements</span> <span class="kd">IDictionary</span><span class="o">(</span><span class="kd">Of</span> <span class="kd">TKey</span><span class="o">,</span> <span class="kd">TValue</span><span class="o">)</span>.Remove<span class="o">,</span> <span class="kd">ICollection</span><span class="o">(</span><span class="kd">Of</span> <span class="kd">KeyValuePair</span><span class="o">(</span><span class="kd">Of</span> <span class="kd">TKey</span><span class="o">,</span> <span class="kd">TValue</span><span class="o">))</span>.Remove
↓
<span class="kd">Public</span> <span class="kd">Overloads</span> <span class="kd">Function</span> <span class="kd">Remove</span><span class="o">(</span><span class="kd">key</span> <span class="kd">As</span> <span class="kd">TKey</span><span class="o">)</span> <span class="kd">As</span> <span class="kd">Boolean</span> <span class="kd">Implements</span> <span class="kd">IDictionary</span><span class="o">(</span><span class="kd">Of</span> <span class="kd">TKey</span><span class="o">,</span> <span class="kd">TValue</span><span class="o">)</span>.Remove

<span class="kd">Me</span><span class="o">(</span><span class="kd">index</span><span class="o">)</span>.Value
↓
<span class="kd">Me</span>.Items<span class="o">(</span><span class="kd">index</span><span class="o">)</span>.Value
</code></pre></div>
</div>

<h1>
<span id="ライセンスっぽいこと" class="fragment"></span><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%A3%E3%81%BD%E3%81%84%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>ライセンスっぽいこと</h1>

<p>コード改変や配布は自由です。<br>
このツールによる義務／責任を何ら負いません。</p>

<p>但し、<a href="http://smdn.jp/programming/netfx/tips/generic_ordereddictionary/" rel="nofollow noopener" target="_blank">ジェネリック版OrderedDictionary - smdn</a>はMITライセンスとなっています。</p>

<h1>
<span id="最後に" class="fragment"></span><a href="#%E6%9C%80%E5%BE%8C%E3%81%AB"><i class="fa fa-link"></i></a>最後に</h1>

<p>え、C#版が欲しいって、これはVisual Basic Advent Calendarなんですよ。<br>
ウソです、もともとC#で作成したのを、この記事用にVisual Basic用に書き換えました。<del>そのうち、GitHubに公開します。</del></p>

<h1>
<span id="改良と不具合修正" class="fragment"></span><a href="#%E6%94%B9%E8%89%AF%E3%81%A8%E4%B8%8D%E5%85%B7%E5%90%88%E4%BF%AE%E6%AD%A3"><i class="fa fa-link"></i></a>改良と不具合修正</h1>

<p>【2018/08/25追記】<br>
C#版がVB版と比べて古かったのを修正。<br>
初期値が存在しない場合に値変更が反映されない不具合を修正しました。<br>
InsertSpaceプロパティを追加(デフォルトは半角スペース1つ)、値書込時にセクションと値の間の半角スペース1つ固定を可変にしました。これで、半角スペース無しが設定可能です。</p>

<p>【2018/09/07追記】<br>
タブのみの行があった際に別セクション扱いになってしまう不具合があり、空行判定(半角スペース、全角スペース、タブ等)を正規表現の"\s"で空文字に置換して長さ 0 なら空行扱いとするように修正しました。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fyaju%2Fitems%2F4fa6c5f52c12b4943426&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fyaju%2Fitems%2F4fa6c5f52c12b4943426&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yaju/items/4fa6c5f52c12b4943426/likers" class="css-1iupg5d">5</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">12</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/4fa6c5f52c12b4943426/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yaju/items/4fa6c5f52c12b4943426/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yaju/items/4fa6c5f52c12b4943426/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yaju/items/4fa6c5f52c12b4943426/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yaju/items/4fa6c5f52c12b4943426.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-fa1ca52b-5f9c-4fb0-97c2-7936f105d84d">{"authorAnalyticsTrackingId":"UA-46720329-2","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-a9f7ba6e-0b75-43f7-8c5b-5336cf32ca14"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-a9f7ba6e-0b75-43f7-8c5b-5336cf32ca14">{}</script>
      
<div id="LoginModal-react-component-a26a8180-0eb5-4fb6-89b2-b84357d44705"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-a26a8180-0eb5-4fb6-89b2-b84357d44705">{}</script>
      
<div id="StockModal-react-component-b80f121e-6bd9-4516-967c-ad39ac7f1a43"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-b80f121e-6bd9-4516-967c-ad39ac7f1a43">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;NWRGVddt5SZ3s9MrZyJwg3fwnyfcrkee0sYyiEcozoPZIJG42mi/Kn1infiId80u3gbP+otYjeWMOdD6Ijh4cw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eこれは、\u003ca href=\"https://qiita.com/advent-calendar/2017/vb\"\u003eVisual Basic Advent Calendar 2017\u003c/a\u003eの24日目の記事となります。\u003c/p\u003e\n\n\u003cp\u003e設定ファイルをxml形式で作成したところ、ユーザーからIni形式で慣れているので変更して欲しいという要望がありました。\u003cbr\u003e\n既に本体プログラムはReadXmlでDataSet型にして設定を読み込むようになっていたため、本体プログラムに出来るだけ影響しないようにIni形式をDataSet型に変換するクラスを作成しました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"説明\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AA%AC%E6%98%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e説明\u003c/h1\u003e\n\n\u003cp\u003e下記のようなiniファイルがあった場合、Dictionary型およびDataSet型にして取得できます。\u003cbr\u003e\n特徴として、セクション名が同じで末尾数字が違った場合、同一グループとして扱います。また、キー名も同様で末尾数字が同じなら同一グループになります。\u003cbr\u003e\niniファイルのパースはAPIを使わず独自に行っているため、UTF-8に対応しています。\u003cbr\u003e\nまた、読み込みだけでなく書き込みも出来ます。\u003c/p\u003e\n\n\u003cp\u003e※内部ではini形式をXML形式に変換してDataSetのReadXmlメソッドを読んでいます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ini\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eSample.ini\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e; データベース\n\u003c/span\u003e\u003cspan class=\"nn\"\u003e[DATABASE]\u003c/span\u003e\n\u003cspan class=\"py\"\u003eHost\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e192.168.0.1\u003c/span\u003e\n\u003cspan class=\"py\"\u003eUser\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eusername\u003c/span\u003e\n\u003cspan class=\"py\"\u003ePass\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003epassword\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e; 文字コード\n\u003c/span\u003e\u003cspan class=\"nn\"\u003e[ENCODING]\u003c/span\u003e\n\u003cspan class=\"py\"\u003eenc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eSJIS\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e; フォント情報\n\u003c/span\u003e\u003cspan class=\"nn\"\u003e[FONT1]\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eMeiryo UI\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e36\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontColor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003ewhite\u003c/span\u003e\n\u003cspan class=\"nn\"\u003e[FONT2]\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eＭＳ ゴシック\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e24\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontColor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003ered\u003c/span\u003e\n\u003cspan class=\"nn\"\u003e[FONT3]\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eCentury Gothic\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e12\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFontColor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003egreen\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e; データ\n\u003c/span\u003e\u003cspan class=\"nn\"\u003e[DATA1]\u003c/span\u003e\n\u003cspan class=\"py\"\u003eCode1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e100\u003c/span\u003e\n\u003cspan class=\"py\"\u003eStr1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eHoge\u003c/span\u003e\n\u003cspan class=\"py\"\u003eCode2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e101\u003c/span\u003e\n\u003cspan class=\"py\"\u003eStr2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eFuga\u003c/span\u003e\n\u003cspan class=\"nn\"\u003e[DATA2]\u003c/span\u003e\n\u003cspan class=\"py\"\u003eCode1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e200\u003c/span\u003e\n\u003cspan class=\"py\"\u003eStr1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eHoge2\u003c/span\u003e\n\u003cspan class=\"py\"\u003eCode2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e201\u003c/span\u003e\n\u003cspan class=\"py\"\u003eStr2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eFuga2\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"読み込み\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e読み込み\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eSample.vb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003epath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Sample.ini\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003einiManager\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eIniManager\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eIniManager\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e' 文字コードをUTF-8とする。\u003c/span\u003e\n\u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncording\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e' Iniファイルの読み込み。FalseはDictionary型のみ、TrueならDataSet型にも変換する。\u003c/span\u003e\n\u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReadIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e' Dictionary型による取得\u003c/span\u003e\n\u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ehost\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"DATABASE\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Host\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e' DataSet型による取得\u003c/span\u003e\n\u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eds\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataSet\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e\n\u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003edtFont\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTables\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"FONT\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003edtData\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTables\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"DATA\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eセクション名(DATABASE)のDictionary型の内容\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/09cfda9b12722531d96d0f5537fe8dc9e100c1a1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f63633737363735312d623030322d623433392d646565612d3734396431386664626231362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fcc776751-b002-b439-deea-749d18fdbb16.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=208a1773885a719061f78a6ab7a6a4e2\" alt=\"IniDic.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/14053/cc776751-b002-b439-deea-749d18fdbb16.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fcc776751-b002-b439-deea-749d18fdbb16.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a6b6790a240df804c572830becde9077 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eセクション名(DATABASE)のDataTable型の内容\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/9861ff07cc50a65422197aadf188f899d448c404/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f38386634663763652d393035332d383335612d353339652d6530633838356663626233342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F88f4f7ce-9053-835a-539e-e0c885fcbb34.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4a2ed598cc8cb2e9f3c0f7241d2e61ee\" alt=\"IniDataSet1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/14053/88f4f7ce-9053-835a-539e-e0c885fcbb34.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F88f4f7ce-9053-835a-539e-e0c885fcbb34.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b04769a0bbce2b15ee4140894581a109 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eセクション名(ENCODING)のDataTable型の内容\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/9e84522d57a815794a51e6d30414e6fabac5218a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f61366666616266392d333130362d613834392d636138322d3233613232653033356335642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fa6ffabf9-3106-a849-ca82-23a22e035c5d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d882e110961d41f733aa2796b57499b9\" alt=\"IniDataSet2.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/14053/a6ffabf9-3106-a849-ca82-23a22e035c5d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fa6ffabf9-3106-a849-ca82-23a22e035c5d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=73b84501ae37d12dab328a058f1d7998 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eセクション名(FONT1,FONT2,FONT3)のDataTable型の内容\u003cbr\u003e\n同一セクション名(FONT)でまとめています。Grpの列が自動で追加され末尾数字がセットされます。末尾数字が無い場合、0 になります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/fb9987a9f09ce6ae8ed075d50f3c1ab0145c711c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f62363837353538372d383364662d363464362d626237392d3037653330393966323939362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fb6875587-83df-64d6-bb79-07e3099f2996.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=78d674b477a67e9b19eaa0d8362219c0\" alt=\"IniDataSet3.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/14053/b6875587-83df-64d6-bb79-07e3099f2996.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fb6875587-83df-64d6-bb79-07e3099f2996.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d96ed0d3bc25660615da604b31bb253b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eセクション名(DATA1,DATA2)のDataTable型の内容\u003cbr\u003e\n同一セクション名(DATA)と同一キー名(Code,Str)でまとめています。GrpとIdxの列が自動で追加され末尾数字がセットされます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/38b763d7bf3ac6f4485aef85eca3c8afb9c02ed9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f33333730333539362d333965662d363431352d313937622d6561633132386361633663622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F33703596-39ef-6415-197b-eac128cac6cb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e7af5b1082e822c307781701797600d5\" alt=\"IniDataSet4.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/14053/33703596-39ef-6415-197b-eac128cac6cb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F33703596-39ef-6415-197b-eac128cac6cb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f3d2315ce5719f47d747ef2503d5cb01 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"書き込み\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e書き込み\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"dictionary型を指定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#dictionary%E5%9E%8B%E3%82%92%E6%8C%87%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eDictionary型を指定\u003c/h3\u003e\n\n\u003cp\u003eSetStringメソッドでセクション、キー、値をセットするとSectionDicプロパティを書き換えます。\u003cbr\u003e\nまた、SectionDicプロパティを使わず、書き換える部分のみのDictionary型を作成して指定することも出来ます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eSample.vb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e' hostを1920.168.0.1から127.0.0.1に変更する。\u003c/span\u003e\n\u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"DATABASE\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Host\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"127.0.0.1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e' encをSJISからUTF-8に変更する。\u003c/span\u003e\n\u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ENCODING\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"enc\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"UTF-8\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e' 書き込み\u003c/span\u003e\n\u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/75395464d42bbaed55ecb0a3758e6f0c82aa50e1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f34336639306336362d633433342d313834312d373066382d3230363364643930623639662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F43f90c66-c434-1841-70f8-2063dd90b69f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0b99f54db6eebe4434a2631f1801879b\" alt=\"WriteIni3.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/14053/43f90c66-c434-1841-70f8-2063dd90b69f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F43f90c66-c434-1841-70f8-2063dd90b69f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2bdb699fb47adecdabf002b648a0ebc9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"datatable型を指定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#datatable%E5%9E%8B%E3%82%92%E6%8C%87%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eDataTable型を指定\u003c/h3\u003e\n\n\u003cp\u003e例ではDataTable型を指定して2回に分けて書き込みしていますが、DataSet型で一度に書き込むことが出来ます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eSample.vb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e' データテーブルで書き換える\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e' FONT2のFontColorをredからblueに書き込える\u003c/span\u003e\n\u003cspan class=\"n\"\u003edtFont\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRows\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"FontColor\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"blue\"\u003c/span\u003e\n\u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edtFont\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e' DATA2のStr2のHoge2をHellowに書き込み\u003c/span\u003e\n\u003cspan class=\"n\"\u003edtData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRows\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Str\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Hellow\"\u003c/span\u003e\n\u003cspan class=\"n\"\u003einiManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edtData\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b87fe9d774648b5600a2020a10ffcbc4ddd23fd8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31343035332f39656663633238322d643136612d666265372d353537362d3935386538333532326431362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F9efcc282-d16a-fbe7-5576-958e83522d16.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=239edccf28b6170551095d7e401b1866\" alt=\"WriteIni4.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/14053/9efcc282-d16a-fbe7-5576-958e83522d16.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2F9efcc282-d16a-fbe7-5576-958e83522d16.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9ad0fe125dbd0d027b819e03ab6a6751 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ソースコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースコード\u003c/h1\u003e\n\n\u003cp\u003eIniManagerクラスを作成しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eIniManager.vb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eImports\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\n\u003cspan class=\"k\"\u003eImports\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\n\u003cspan class=\"k\"\u003eImports\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text.RegularExpressions\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eClass\u003c/span\u003e \u003cspan class=\"nc\"\u003eIniManager\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e' Iniファイル情報格納(OrderedDictionary型)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eProperty\u003c/span\u003e \u003cspan class=\"nf\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e' Iniファイル情報格納(DataSet型)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eProperty\u003c/span\u003e \u003cspan class=\"nf\"\u003eSectionDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataSet\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e' エンコーディング\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eProperty\u003c/span\u003e \u003cspan class=\"nf\"\u003eEncording\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e' セクション番号区切り文字\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eProperty\u003c/span\u003e \u003cspan class=\"nf\"\u003eSectionSeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e' キー番号区切り文字\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eProperty\u003c/span\u003e \u003cspan class=\"nf\"\u003eKeySeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e' セクションと値の間の空白\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eProperty\u003c/span\u003e \u003cspan class=\"nf\"\u003eInsertSpace\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e' ルート名\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eProperty\u003c/span\u003e \u003cspan class=\"nf\"\u003eRootName\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e' セクショングループ用属性値\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eConst\u003c/span\u003e \u003cspan class=\"nv\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Grp\"\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e' パラメーターグループ用属性値\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eConst\u003c/span\u003e \u003cspan class=\"nv\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Idx\"\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e' XML用ルート名\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eConst\u003c/span\u003e \u003cspan class=\"nv\"\u003eDEFAULT_ROOT_NAMER\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Root\"\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e' セクション用正規表現パターン\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eConst\u003c/span\u003e \u003cspan class=\"nv\"\u003eSECTION_PATTERN\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^\\s*\\[(?\u0026lt;section\u0026gt;[^\\]]+)\\].*$\"\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e' パラメーター用正規表現パターン\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eConst\u003c/span\u003e \u003cspan class=\"nv\"\u003ePARAMETER_PATTERN\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"^\\s*(?\u0026lt;name\u0026gt;[^=]+)=(?\u0026lt;value\u0026gt;.*?)(\\s+;(?\u0026lt;comment\u0026gt;.*))?$\"\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e' コンストラクタ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eSub\u003c/span\u003e \u003cspan class=\"nf\"\u003eNew\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDEFAULT_ROOT_NAMER\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eSub\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' 設定値を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"section\"\u0026gt;セクション名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"keyname\"\u0026gt;キー名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt; 設定値\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eOrElse\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' 設定値を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"keyname\"\u0026gt;キー名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;設定値\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' 設定情報を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"tableName\"\u0026gt;テーブル名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;設定情報\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetTable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etableName\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTables\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etableName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' 設定値を更新する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"section\"\u0026gt;セクション名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"keyname\"\u0026gt;キー名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"value\"\u0026gt;設定値\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eSub\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eSub\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' Iniファイル読み込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eOptional\u003c/span\u003e \u003cspan class=\"n\"\u003eisDataSet\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' Ini情報のセット\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' DataSet型に変換\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eisDataSet\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eToDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' DataSet型に変換する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eToDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' XMLデータに変換する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003exml\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eConvertDicToXML\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003exml\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' DataSet型に変換する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eUsing\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eStringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exml\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReadXml\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereader\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eUsing\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' Iniファイル情報を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eUsing\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eStreamReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esections\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))(\u003c/span\u003e\u003cspan class=\"n\"\u003eStringComparer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eregexSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"ow\"\u003eOr\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eregexNameValue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"ow\"\u003eOr\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e' セクション名が明示されていない先頭部分のセクション名を\"\"として扱う\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReadLine\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"ow\"\u003eIs\u003c/span\u003e \u003cspan class=\"k\"\u003eNothing\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eExit\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e' 空行は読み飛ばす\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eIsBlank\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e' コメント行は読み飛ばす\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\";\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eElseIf\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"#\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ematchNameValue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e' name=valueの行\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ematchSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e' [section]の行\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"section\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eUsing\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' Iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"sections\"\u0026gt;更新情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eresult\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' Iniファイル情報を取得する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003edic\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' 並び替えた情報を格納\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esortSections\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))(\u003c/span\u003e\u003cspan class=\"n\"\u003eStringComparer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                    \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' 存在しなかったら追記\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e' 既に登録済みなら何もしない\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eFor\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e' 未登録なら追加する\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n\n        \u003cspan class=\"c1\"\u003e' セクションの最終キーを格納\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003elastdic\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003epair\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eLast\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"sectionName\"\u0026gt;セクション名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"keyName\"\u0026gt;キー名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"value\"\u0026gt;値\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esections\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))()\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' Iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"dsSections\"\u0026gt;セクション情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edsSections\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esections\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))()\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003edt\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003edsSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTables\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eToDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' Iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"filePath\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"dtSections\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePublic\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esections\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eToDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' Dictionary型に変換する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"dtSections\"\u0026gt;セクション情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"sections\"\u0026gt;更新セクション情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePrivate\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eToDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edtSections\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eByRef\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataRow\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRows\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumns\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esectionName\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTableName\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eindexNo\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumns\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eindexNo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDataColumn\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumns\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e \u003cspan class=\"ow\"\u003eOrElse\u003c/span\u003e \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e \u003cspan class=\"ow\"\u003eOrElse\u003c/span\u003e \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"_Id\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eFor\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekeyName\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eindexNo\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekeyName2\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eindexNo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ekeyName2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName2\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' iniファイルの書き込みメイン処理\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"sortSections\"\u0026gt;ソート済更新情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"lastdic\"\u0026gt;最終パラメーター情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePrivate\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eisSave\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esb\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eUsing\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eStreamReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esections\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e))(\u003c/span\u003e\u003cspan class=\"n\"\u003eStringComparer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eregexSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"ow\"\u003eOr\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eregexNameValue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"ow\"\u003eOr\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e' セクション名が明示されていない先頭部分のセクション名を\"\"として扱う\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReadLine\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"ow\"\u003eIs\u003c/span\u003e \u003cspan class=\"k\"\u003eNothing\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eExit\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e' 空行は読み飛ばす\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eIsBlank\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e' コメント行は読み飛ばす\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\";\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eElseIf\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"#\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e' 全て終わった\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e' 存在しなかったら追記\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ematchNameValue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003enewline\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e' name=valueの行\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekeyName\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n\n                        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003evalue\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eRemove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n                        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ecurvalue\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                                \u003cspan class=\"c1\"\u003e' 現在値があるなら置換する\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                                    \u003cspan class=\"c1\"\u003e' 現在値に空白が含まれていた場合、単純な置換(キーやコメントなども置換される可能性がある) \u003c/span\u003e\n                                    \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eElse\u003c/span\u003e\n                                    \u003cspan class=\"c1\"\u003e' 現在値に空白が含まれていない場合、値のみ置換 \u003c/span\u003e\n                                    \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"(=\\s+|=)([^;|\\s]+)(\\s+;.*|)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${1}\"\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${3}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                                \u003cspan class=\"c1\"\u003e' 現在値と違う値なら保存する\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eElse\u003c/span\u003e\n                            \u003cspan class=\"c1\"\u003e' = の位置に半角スペースを1つ空けて値をセット\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"(=)(\\s[^;].*)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${1}\"\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${2}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003enewline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"(=)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${1}\"\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                            \u003cspan class=\"c1\"\u003e' 現在値と違う値なら保存する\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e' 書き換え行のセット\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enewline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e' 新規パラメーターがあれば最終キー後に追記する\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{0}\"\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"=\"\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e' セクション内のパラメーターが存在しない\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"c1\"\u003e' セクションを削除する\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRemove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eContinue\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ematchSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esectionName\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"section\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\n                        \u003cspan class=\"c1\"\u003e' 対象のセクション行が存在\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e' 行のセット\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eWhile\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eUsing\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' 新規セクションとパラメーターを追記する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e' 未登録のセクションを追加する(一行空行)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"[{0}]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e' パラメーターを追加する\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{0}\"\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"=\"\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' 保存処理\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWriteAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' 末尾数値分割処理\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"value\"\u0026gt;対象キー\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"separator\"\u0026gt;区切り文字\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;分割情報\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePrivate\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eseparator\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"[0-9]$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003epattern\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"(?\u0026lt;Key\u0026gt;.*\\D)(?\u0026lt;No\u0026gt;\\d+$)\"\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eseparator\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epattern\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"(?\u0026lt;Key\u0026gt;.*){0}(?\u0026lt;No\u0026gt;\\d+$)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eseparator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ereg\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epattern\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003emat\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eMatch\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekey\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"${Key}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eno\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"${No}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eElse\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"k\"\u003eNothing\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' セクショングループ件数を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;セクショングループ件数\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePrivate\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetSectionGroupCount\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esecCount\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekey\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ecnt\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"ow\"\u003eIsNot\u003c/span\u003e \u003cspan class=\"k\"\u003eNothing\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' XMLデータに変換する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;XMLデータ\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePrivate\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertDicToXML\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esb\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;?xml version = '1.0' encoding = 'utf-8' ?\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"err\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' 同一名カウントチェック\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esecCount\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetSectionGroupCount\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e' XMLデータ生成\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003egrpno\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekey\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"ow\"\u003eIsNot\u003c/span\u003e \u003cspan class=\"k\"\u003eNothing\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\n                \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem2\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e' 複数存在するならグループ扱い\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e' パラメーターが連番のみかチェック\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eisDataGrp\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"k\"\u003eNot\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"[0-9]$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eisDataGrp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eExit\u003c/span\u003e \u003cspan class=\"k\"\u003eFor\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003egrp\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" {0}='{1}'\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egrp\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eno\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eoldNo\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003epkey\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eisFirst\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"k\"\u003eEach\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"ow\"\u003eIn\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epkey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eisDataGrp\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epkey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"ow\"\u003eIsNot\u003c/span\u003e \u003cspan class=\"k\"\u003eNothing\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003epkey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem2\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eoldNo\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eisFirst\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" /\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egrp\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" {0}='{1}'\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eoldNo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisFirst\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" {0}='{1}'\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epkey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eElse\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e' セクションが無い場合\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}\u0026gt;{1}\u0026lt;/{0}\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epkey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" /\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"err\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;/{0}\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' 空行判定\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;param name=\"line\"\u0026gt;対象文字列\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e''' \u0026lt;returns\u0026gt;true:空行 / false:空行以外\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ePrivate\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eIsBlank\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eBoolean\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e' 空行(全角スペース、タブ、半角スペースのみを対象にする)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ere\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\\s\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eblankline\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eReturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eblankline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\n\u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eClass\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e【2018/06/22追記】C#を追加しました。\u003cbr\u003e\n【2018/08/25追記】VB版とC#版が違うのに気が付きました。C#版が古かった。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eIniManager.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text.RegularExpressions\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eIniManager\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Iniファイル情報格納(OrderedDictionary型)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Iniファイル情報格納(DataSet型)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDataSet\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// エンコーディング\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// セクション番号区切り文字\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// キー番号区切り文字\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// セクションと値の間の空白\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// XML用ルート名\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// セクショングループ用属性値\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Grp\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// パラメーターグループ用属性値\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Idx\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// XML用ルート名\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eDEFAULT_ROOT_NAMER\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Root\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// セクション用正規表現パターン\u003c/span\u003e\n    \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eSECTION_PATTERN\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"^\\s*\\[(?\u0026lt;section\u0026gt;[^\\]]+)\\].*$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// パラメーター用正規表現パターン\u003c/span\u003e\n    \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ePARAMETER_PATTERN\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"^\\s*(?\u0026lt;name\u0026gt;[^=]+)=(?\u0026lt;value\u0026gt;.*?)(\\s+;(?\u0026lt;comment\u0026gt;.*))?$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// コンストラクタ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eIniManager\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDEFAULT_ROOT_NAMER\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 設定値を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"section\"\u0026gt;セクション名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"keyname\"\u0026gt;キー名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 設定値を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"section\"\u0026gt;セクション名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 設定情報を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"tableName\"\u0026gt;テーブル名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetTable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etableName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTables\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003etableName\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 設定値を更新する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"section\"\u0026gt;セクション名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"keyname\"\u0026gt;キー名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"value\"\u0026gt;設定値\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyname\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// Iniファイル読み込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisDataSet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Ini情報のセット\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// DataSet型に変換\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eToDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// DataSet型に変換する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eToDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// XMLデータに変換する\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003exml\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertDicToXML\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exml\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// DataSet型に変換する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eStringReader\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003exml\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eSectionDataSet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadXml\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereader\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// Iniファイル情報を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStreamReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eStringComparer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eregexSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eregexNameValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// セクション名が明示されていない先頭部分のセクション名を\"\"として扱う\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(;;)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadLine\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 空行は読み飛ばす\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsBlank\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// コメント行は読み飛ばす\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\";\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"#\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// name=valueの行\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e()]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// [section]の行\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"section\"\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// Iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"secyions\"\u0026gt;更新情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Iniファイル情報を取得する\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetSections\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 並び替えた情報を格納\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eStringComparer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n                    \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 存在しなかったら追記\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 既に登録済みなら何もしない\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 未登録なら追加する\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"c1\"\u003e// セクションの最終キーを格納\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edic\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eLast\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//result = WriteIni(section.Key, pair.Key, pair.Value, filePath);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//if (!result) return false;\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sectionName\"\u0026gt;セクション名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"keyName\"\u0026gt;キー名\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"value\"\u0026gt;値\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;();\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// Iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"dsSections\"\u0026gt;セクション情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDataSet\u003c/span\u003e \u003cspan class=\"n\"\u003edsSections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;();\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e \u003cspan class=\"n\"\u003edt\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edsSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTables\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eToDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// Iniファイルの書き込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"filePath\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"dtSections\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eToDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteIni\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// Dictionary型に変換する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"dtSections\"\u0026gt;セクション情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sections\"\u0026gt;更新セクション情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eToDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDataTable\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDataRow\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRows\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumns\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTableName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003egroupNo\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eindexNo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumns\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eindexNo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDataColumn\u003c/span\u003e \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edtSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumns\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"_Id\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eColumnName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eindexNo\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindexNo\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ekeyName2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName2\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// iniファイルの書き込みメイン処理\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"filePath\"\u0026gt;ファイルパス\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"sortSections\"\u0026gt;ソート済更新情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"lastdic\"\u0026gt;最終パラメーター情報\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true : 正常 / false : 異常\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elastdic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStreamReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esections\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eStringComparer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eregexSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSECTION_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eregexNameValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARAMETER_PATTERN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSingleline\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eRegexOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCultureInvariant\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// セクション名が明示されていない先頭部分のセクション名を\"\"として扱う\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(;;)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadLine\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 空行は読み飛ばす\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eIsBlank\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// コメント行は読み飛ばす\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\";\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartsWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"#\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStringComparison\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOrdinal\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e// 全て終わった\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisContinue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 存在しなかったら追記\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// name=valueの行\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eRemove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchNameValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                \u003cspan class=\"c1\"\u003e// 現在値があるなら置換する\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                    \u003cspan class=\"c1\"\u003e// 現在値に空白が含まれていた場合、単純な置換(キーやコメントなども置換される可能性がある)\u003c/span\u003e\n                                    \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurvalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                    \u003cspan class=\"c1\"\u003e// 現在値に空白が含まれていない場合、値のみ置換\u003c/span\u003e\n                                    \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"(=\\s+|=)([^;|\\s]+)(\\s+;.*|)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${1}\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${3}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                                \u003cspan class=\"c1\"\u003e// 現在値と違う値なら保存する\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"c1\"\u003e// = の位置に半角スペースを1つ空けて値をセット\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"(=)(\\s[^;].*)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${1}\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${2}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003enewline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"(=)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"${1}\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                            \u003cspan class=\"c1\"\u003e// 現在値と違う値なら保存する\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enewline\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e// 書き換え行のセット\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enewline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e// 新規パラメーターがあれば最終キー後に追記する\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elastdic\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{0}\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"=\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                    \u003cspan class=\"c1\"\u003e// セクション内のパラメーターが存在しない\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"c1\"\u003e// セクションを削除する\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRemove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eregexSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ematchSection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"section\"\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ecurrentSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"c1\"\u003e// 対象のセクション行が存在\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisExistsSection\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 行のセット\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 新規セクションとパラメーターを追記する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esortSections\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 未登録のセクションを追加する(一行空行)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"[{0}]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// パラメーターを追加する\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{0}\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"=\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eInsertSpace\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 保存処理\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisWrite\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eisSave\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003eEncording\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 末尾数値分割処理\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"value\"\u0026gt;対象キー\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"separator\"\u0026gt;区切り文字\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;分割情報\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eseparator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"[0-9]$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epattern\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"(?\u0026lt;Key\u0026gt;.*\\D)(?\u0026lt;No\u0026gt;\\d+$)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eseparator\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epattern\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e@\"(?\u0026lt;Key\u0026gt;.*){0}(?\u0026lt;No\u0026gt;\\d+$)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eseparator\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e \u003cspan class=\"n\"\u003ereg\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epattern\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eMatch\u003c/span\u003e \u003cspan class=\"n\"\u003emat\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"${Key}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"${No}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// セクショングループ件数を取得する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;セクショングループ件数\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetSectionGroupCount\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e\u003cspan class=\"p\"\u003e++;\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// XMLデータに変換する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;XMLデータ\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eConvertDicToXML\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;?xml version = '1.0' encoding = 'utf-8' ?\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 同一名カウントチェック\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eOrderedDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetSectionGroupCount\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// XMLデータ生成\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionDic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSectionSeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 複数存在するならグループ扱い\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003esecCount\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// パラメーターが連番のみかチェック\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisDataGrp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsMatch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"[0-9]$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eisDataGrp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003egrp\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" {0}='{1}'\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSECTION_GROUP_ATTR\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egrpno\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egrp\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eoldNo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epkey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisFirst\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epkey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKey\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisDataGrp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetKeyAndNo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epkey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eKeySeparator\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003epkey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eoldNo\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eisFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" /\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}{1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egrp\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" {0}='{1}'\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePARAMETER_INDEX_ATTR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eoldNo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003eisFirst\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" {0}='{1}'\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epkey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// セクションが無い場合\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;{0}\u0026gt;{1}\u0026lt;/{0}\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epkey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" /\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAppendLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;/{0}\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRootName\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 空行判定\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"line\"\u0026gt;対象文字列\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;true:空行 / false:空行以外\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eIsBlank\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 空行(全角スペース、タブ、半角スペースのみを対象にする)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eRegex\u003c/span\u003e \u003cspan class=\"n\"\u003ere\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e@\"\\s\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eblankline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eblankline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ordereddictionary型について\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ordereddictionary%E5%9E%8B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eOrderedDictionary型について\u003c/h2\u003e\n\n\u003cp\u003eIniManagerクラスの中で、次サイトの「ジェネリック版OrderedDictionary」を使用しています。読み込みだけならDictionary型で充分だったのですが、書き込みする上ではOrderedDictionaryのように順序の保証が必要でした。\u003cbr\u003e\n\u003ca href=\"http://smdn.jp/programming/netfx/tips/generic_ordereddictionary/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eジェネリック版OrderedDictionary - smdn\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこのジェネリック版OrderedDictionaryは、C#版しか公開されていないのですが、\u003ca href=\"http://www.icsharpcode.net/OpenSource/SD/Download/Default.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSharpDevelop Ver 4.4\u003c/a\u003eのC#からVB.NETへのコンバート機能を使用しました。ちなみに最新版のSharpDevelop Ver 5には変換機能がつかなくなりました。\u003c/p\u003e\n\n\u003cp\u003e正しく変換されなかったところは次のように修正しました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bat\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eOrderedDictionary.vb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e#degine \u003cspan class=\"kd\"\u003eENABLE_KEYS_VALUES\u003c/span\u003e\n↓\n#Const \u003cspan class=\"kd\"\u003eENABLE_KEYS_VALUES\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003eTrue\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003ePublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eOverloads\u003c/span\u003e \u003cspan class=\"kd\"\u003eFunction\u003c/span\u003e \u003cspan class=\"kd\"\u003eRemove\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003ekey\u003c/span\u003e \u003cspan class=\"kd\"\u003eAs\u003c/span\u003e \u003cspan class=\"kd\"\u003eTKey\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"kd\"\u003eAs\u003c/span\u003e \u003cspan class=\"kd\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"kd\"\u003eImplements\u003c/span\u003e \u003cspan class=\"kd\"\u003eIDictionary\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003eOf\u003c/span\u003e \u003cspan class=\"kd\"\u003eTKey\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003eTValue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e.Remove\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003eICollection\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003eOf\u003c/span\u003e \u003cspan class=\"kd\"\u003eKeyValuePair\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003eOf\u003c/span\u003e \u003cspan class=\"kd\"\u003eTKey\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003eTValue\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e.Remove\n↓\n\u003cspan class=\"kd\"\u003ePublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eOverloads\u003c/span\u003e \u003cspan class=\"kd\"\u003eFunction\u003c/span\u003e \u003cspan class=\"kd\"\u003eRemove\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003ekey\u003c/span\u003e \u003cspan class=\"kd\"\u003eAs\u003c/span\u003e \u003cspan class=\"kd\"\u003eTKey\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"kd\"\u003eAs\u003c/span\u003e \u003cspan class=\"kd\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"kd\"\u003eImplements\u003c/span\u003e \u003cspan class=\"kd\"\u003eIDictionary\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003eOf\u003c/span\u003e \u003cspan class=\"kd\"\u003eTKey\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003eTValue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e.Remove\n\n\u003cspan class=\"kd\"\u003eMe\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003eindex\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e.Value\n↓\n\u003cspan class=\"kd\"\u003eMe\u003c/span\u003e.Items\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003eindex\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e.Value\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ライセンスっぽいこと\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%A3%E3%81%BD%E3%81%84%E3%81%93%E3%81%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eライセンスっぽいこと\u003c/h1\u003e\n\n\u003cp\u003eコード改変や配布は自由です。\u003cbr\u003e\nこのツールによる義務／責任を何ら負いません。\u003c/p\u003e\n\n\u003cp\u003e但し、\u003ca href=\"http://smdn.jp/programming/netfx/tips/generic_ordereddictionary/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eジェネリック版OrderedDictionary - smdn\u003c/a\u003eはMITライセンスとなっています。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"最後に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最後に\u003c/h1\u003e\n\n\u003cp\u003eえ、C#版が欲しいって、これはVisual Basic Advent Calendarなんですよ。\u003cbr\u003e\nウソです、もともとC#で作成したのを、この記事用にVisual Basic用に書き換えました。\u003cdel\u003eそのうち、GitHubに公開します。\u003c/del\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"改良と不具合修正\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%94%B9%E8%89%AF%E3%81%A8%E4%B8%8D%E5%85%B7%E5%90%88%E4%BF%AE%E6%AD%A3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e改良と不具合修正\u003c/h1\u003e\n\n\u003cp\u003e【2018/08/25追記】\u003cbr\u003e\nC#版がVB版と比べて古かったのを修正。\u003cbr\u003e\n初期値が存在しない場合に値変更が反映されない不具合を修正しました。\u003cbr\u003e\nInsertSpaceプロパティを追加(デフォルトは半角スペース1つ)、値書込時にセクションと値の間の半角スペース1つ固定を可変にしました。これで、半角スペース無しが設定可能です。\u003c/p\u003e\n\n\u003cp\u003e【2018/09/07追記】\u003cbr\u003e\nタブのみの行があった際に別セクション扱いになってしまう不具合があり、空行判定(半角スペース、全角スペース、タブ等)を正規表現の\"\\s\"で空文字に置換して長さ 0 なら空行扱いとするように修正しました。\u003c/p\u003e\n","createdAt":"2017-12-24T14:50:28Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"QlA9CvDFN0mnwcUO+BDsEyhMOJ8PR4hU--eS+mj5MOB3sf1CGd--VEoRfdvVvotDaeSRYi2hzw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-05-31T12:10:03Z","likesCount":5,"linkUrl":"https://qiita.com/yaju/items/4fa6c5f52c12b4943426","organization":null,"originalId":593772,"stockedCount":12,"title":"【.NET】UTF-8対応Iniファイルの読み込みと書き込み","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AA%AC%E6%98%8E\"\u003e説明\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF\"\u003e読み込み\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF\"\u003e書き込み\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#dictionary%E5%9E%8B%E3%82%92%E6%8C%87%E5%AE%9A\"\u003eDictionary型を指定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#datatable%E5%9E%8B%E3%82%92%E6%8C%87%E5%AE%9A\"\u003eDataTable型を指定\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003eソースコード\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#ordereddictionary%E5%9E%8B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003eOrderedDictionary型について\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%A3%E3%81%BD%E3%81%84%E3%81%93%E3%81%A8\"\u003eライセンスっぽいこと\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e最後に\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%94%B9%E8%89%AF%E3%81%A8%E4%B8%8D%E5%85%B7%E5%90%88%E4%BF%AE%E6%AD%A3\"\u003e改良と不具合修正\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":25089,"uuid":"4fa6c5f52c12b4943426","banReason":null,"adventCalendarItem":{"day":24,"calendar":{"name":"Visual Basic","urlName":"vb","year":2017,"organization":null}},"author":{"encryptedId":"13dU4rWelnLdLuZRjOSjPZyvVpk=--gw/vKyj4LTPnxuW/--kZodPSz5hw0Z1uYXakTmfA==","originalId":14053,"description":"静岡県島田市在住ののシニアSE（元Microsoft MVP 2010-2012）がコンピューター、機械学習、Unity、数学について考える。","facebookUrl":"https://facebook.com/yasuhito.hiraguchi","githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"やじゅ","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/14053/profile-images/1473683162","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fprofile-images%2F1473683162?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=e8f332c4ab4195584754b9e28b9d6458","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F14053%2Fprofile-images%2F1473683162?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=136b8707be81c2c47a1fbee1976f4e70","urlName":"yaju","websiteUrl":"http://yaju3d.hatenablog.jp/","twitterUrl":"https://twitter.com/yaju","twitterUrlName":"yaju","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"ini","urlName":"ini"},{"name":"VisualBasic","urlName":"visualbasic"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
