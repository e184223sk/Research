<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#におけるドメイン層での表現方法を考えてみる - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/kawakawa/items/995d31ce8db97ce5cf04" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="OJTs4LFB0bh1RjfHDHK3LvGSt/IBiW8isX7wKx69yyLJcnU3jxtVBvA0PjBmk1//TrW/l7vFxobCmS2QQlSr0Q==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@kawakawa" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#におけるドメイン層での表現方法を考えてみる - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2F2amdZcmpnWkhqZ292amc0bmpnNkhqZ3FUamc3UGxzYVRqZ2FmamdhN29vYWpuajc3bWxybm1zNVhqZ3BMb2dJUGpnWWpqZ2FiamdiX2pnb3MmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9OWRhNDNkMzkxYWY0NjIzOWEwODc2NzBkNDI0ZGNjY2I&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RoZDJGcllYZGgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz0yODFkYzg5YTk1YzlkY2U3YTUxZWVlYTQwY2I1MmVkNw&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=657bf9bb357f47367d7ccf1c7c262dcc"><meta property="og:description" content="

前提

DDDでは、モデルとコード（実装）を深く結びつけることでできる動くモデルを使ってドメインエキスパート（以下、エキスパート）と開発者が共に理解を深めながら、開発をすすめていきます。 


参照：エリック・エヴァンスのドメイン..."><meta content="https://qiita.com/kawakawa/items/995d31ce8db97ce5cf04" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,DDD,ドメイン駆動設計" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-31118fa0-141b-49ba-bb84-d21dc1ea5f25"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fkawakawa%2Fitems%2F995d31ce8db97ce5cf04">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fkawakawa%2Fitems%2F995d31ce8db97ce5cf04">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-31118fa0-141b-49ba-bb84-d21dc1ea5f25">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-02-10T06:10:07.000+09:00","dateModified":"2017-07-25T09:54:07.000+09:00","headline":"C#におけるドメイン層での表現方法を考えてみる","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2F2amdZcmpnWkhqZ292amc0bmpnNkhqZ3FUamc3UGxzYVRqZ2FmamdhN29vYWpuajc3bWxybm1zNVhqZ3BMb2dJUGpnWWpqZ2FiamdiX2pnb3MmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9OWRhNDNkMzkxYWY0NjIzOWEwODc2NzBkNDI0ZGNjY2I\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RoZDJGcllYZGgmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz0yODFkYzg5YTk1YzlkY2U3YTUxZWVlYTQwY2I1MmVkNw\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=657bf9bb357f47367d7ccf1c7c262dcc","mainEntityOfPage":"https://qiita.com/kawakawa/items/995d31ce8db97ce5cf04","author":{"@type":"Person","address":"","email":null,"identifier":"kawakawa","name":"kawakawa","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2Fprofile-images%2F1481095403?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13e9791470ce6a7d6713b0a2843ad4d4","url":"https://qiita.com/kawakawa","description":"Twitter: @kawakawa","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kawakawa","type":"items","id":"995d31ce8db97ce5cf04"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kawakawa","type":"items","id":"995d31ce8db97ce5cf04"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kawakawa","type":"items","id":"995d31ce8db97ce5cf04"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"LINEグループの成長を担うLINE Growth Technologyのこれまでとこれから","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/kawakawa/items/995d31ce8db97ce5cf04","location":"/kawakawa/items/995d31ce8db97ce5cf04","scheme":"https","host":"qiita.com","port":null,"pathname":"/kawakawa/items/995d31ce8db97ce5cf04","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"Y0HDz+syPbjZ6ZBNjmeVElTAbGyeeurfB8FSGfQu+p6Sp1oY1Wi5Blybmbrkhn3D6+dkCSQ2Q3t0Jo+iqMeabQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-ea273a0f-73c0-4c6b-9ae3-b57953c56102"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kawakawa/items/995d31ce8db97ce5cf04/likers" class="css-1iupg5d">39</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">38</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/995d31ce8db97ce5cf04/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kawakawa/items/995d31ce8db97ce5cf04/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kawakawa/items/995d31ce8db97ce5cf04/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kawakawa/items/995d31ce8db97ce5cf04/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kawakawa/items/995d31ce8db97ce5cf04.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/kawakawa"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/6728/profile-images/1481095403" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/kawakawa" class="css-10ougpm">@<!-- -->kawakawa</a><div class="css-1ay9vb9"><span><meta content="2017-02-09T21:10:07Z"/><time dateTime="2017-07-25T00:54:07Z" class="css-m19uds">updated at 2017-07-25</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#におけるドメイン層での表現方法を考えてみる</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/ddd" class="css-4czcte">DDD</a><a href="/tags/%e3%83%89%e3%83%a1%e3%82%a4%e3%83%b3%e9%a7%86%e5%8b%95%e8%a8%ad%e8%a8%88" class="css-4czcte">ドメイン駆動設計</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="前提" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90"><i class="fa fa-link"></i></a>前提</h1>

<p>DDDでは、モデルとコード（実装）を深く結びつけることでできる動くモデルを使ってドメインエキスパート（以下、エキスパート）と開発者が共に理解を深めながら、開発をすすめていきます。 </p>

<blockquote>
<p><em>参照：エリック・エヴァンスのドメイン駆動設計</em> <br>
 <em>モデルと設計の核心が相互に形成し合う。</em><br>
 <em>モデルと実装が密接に結びつくことによって、モデルはドメインと深く関連したものになり、モデルに対する分析が、最終成果物である実際に動くプログラムに適用されることが保証される。</em> <br>
 <em>このモデルと実装の結びつきは、保守や継続的開発においても有効だが、それは、モデルの理解に基づいてコードを解釈できるからである</em> </p>
</blockquote>

<p>開発していく中でいつも悩むのは、モデリングとコードを結びつける為にどう実装するかです。<br>
今回はコードの実装、モデルとコードの結び付けを一番強く意識づけられているドメイン層について、C#ではどのような表現をすれば判り易く、かつ時間経過にともなう変更に強くなれるのか考えてみたいと思います。 <br>
（モデリングではなく、モデルの表現方法についての考察となります。） </p>

<h2>
<span id="判り易いコードとは" class="fragment"></span><a href="#%E5%88%A4%E3%82%8A%E6%98%93%E3%81%84%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>判り易いコードとは？</h2>

<p>開発者にとって、判り易いコードというだけではありません。 <br>
エキスパートにとっても判り易い、コードの意図が把握できるというのが大事となります。 </p>

<p>書籍：実践ドメイン駆動設計に判り易い例が載っています。 <br>
「ナースが患者に、インフルエンザワクチンを適量投与する」をコードで表してみましょう。 <br>
（※変数・メソッドを書籍から多少変換しています） </p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>
//例１
患者.set注射種別(種別.インフルエンザワクチン); 
患者.set投与量(適量); 
患者.set投与者(ナース); 

//例２
患者.giveインフルエンザワクチン(); 

//例３ 
var インフルエンザワクチン= ワクチン.インフルエンザワクチン成人適量(); 
ナース.注射投与(患者, インフルエンザワクチン); 
</code></pre></div></div>

<p>どのコードが、行いたい意図をコードで表現出来ていると思われますか？ </p>

<p>私が思うエキスパートがコードを読める事の一番のメリットは、エキスパートとコード（ユビキタス言語）を使ってコミュニケーションが取れるという点です。実装がモデルに即していないときの指摘が、画面・帳票を確認してからよりも早い段階でフィードバックを貰うことができます。<br>
また、仕様変更でモデルのどこが変わるのか、エキスパートから開発者に具体的どの箇所がどのように変化するのか伝えてもらうことができます。 </p>

<p>副次的な変化として、コードの性質が変わってきたように感じます。 <br>
DDDを実践する前は、コードは開発者のモノという認識があり、「どのように実装するか」に注力を傾けていたのですが、今では「何を作るのか」を強く意識するコードを書くようになりました。 </p>

<h2>
<span id="時間経過による変更に強くするには" class="fragment"></span><a href="#%E6%99%82%E9%96%93%E7%B5%8C%E9%81%8E%E3%81%AB%E3%82%88%E3%82%8B%E5%A4%89%E6%9B%B4%E3%81%AB%E5%BC%B7%E3%81%8F%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF"><i class="fa fa-link"></i></a>時間経過による変更に強くするには？</h2>

<p>「時の試練に耐える」と表現されるように、コードのライフサイクルが長くなれば、必ず遭遇する変更要望にどれ位容易に追随できるのか、何を許可して何に制限するのか。 <br>
柔軟性と堅牢性のトレードオフを如何にC#で表現できるかという事になります。 </p>

<h2>
<span id="その他もろもろ" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E3%82%82%E3%82%8D%E3%82%82%E3%82%8D"><i class="fa fa-link"></i></a>その他もろもろ</h2>

<p>そもそもDDDに向いてる向いていないプロジェクト、エキスパートの協力度合、DDD実践にともなう費用対効果などの話も今回の対象外となります <br>
今回はC#で表現方法を考察していますが、Javaでは異なる表現方法になりますし、オブジェクト指向・関数型、静的言語、動的言語、使用するフレームワークなど状況によって表現方法は大きく変わってきます。書籍：実践プログラミングDSLではその点を詳しく紹介されています。<br>
大事なのは、<strong>モデルの意図を損なう事なくコードで表現可能かどうか</strong>です。 </p>

<h1>
<span id="コードの臭い" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84"><i class="fa fa-link"></i></a>コードの臭い</h1>

<p>エキスパートも読めるようにするとなると、ユビキタス言語に伴わないC#固有の文字・構文はノイズとなってしまうため、可能な限り除外するようにします。 <br>
そこでC#でよく現れるnew、null、try catchについて考えてみたいと思います。 </p>

<h2>
<span id="new-から漂うコードの臭い" class="fragment"></span><a href="#new-%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84"><i class="fa fa-link"></i></a>new から漂うコードの臭い</h2>

<p><code>var 材料 = new 材料();</code><br>
このコードは材料Classのインスタンスを生成を行っているのですが、モデル的には何を意味しているのでしょうか？ <br>
モデルの世界とは、newをすれば、目の前に材料が突然現れるような便利な世界でよいのでしょうか？ </p>

<p>現実世界では材料を用意するために、何処からか購入したり、材料Aと材料Bを組み合わせて新しい材料として精製したりなど、何かしらの作業が発生します。 <code>new 材料()</code> にそのような意図を込める必要はないのでしょうか。 <br>
今はスコープ外だとして、モデルに表現する必要はなくても、材料生成時に何らかのビジネスルールが必要になる可能性は十分に考えられます。 </p>

<p>DDD本ではFactoryパターン、Repositoryパターンが紹介されています。 <br>
直接newするのではなく、newにかかわる処理を上手く切り出すことで、モデルの振舞を記する場所を用意します。 <br>
（ドメイン層から直接DBを参照させたくないが為だけに有るパターンの訳ではありません。） </p>

<p>また容易にnewできてしまうと、行儀の悪いプログラマーがつい近道をしようとコンテキストを越えてnewしてしまうかもしれません。 容易にnewを行えないようにする制限をかけておくことを忘れないようにしておくことも大事です。（Builderパターンに近いですね） <br>
ドメイン層にnewが現れた場合、それがモデルの何を表しているのか一度考えてみてください。 </p>

<h2>
<span id="nullから漂うコードの臭い" class="fragment"></span><a href="#null%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84"><i class="fa fa-link"></i></a>nullから漂うコードの臭い</h2>

<p>nullもモデルにおいて存在無しを示す表現ではありません。 <br>
nullの多くは<code>if（●● != null)</code>や<code>IsNull（●●）</code>、演算子としては??演算子、Null条件演算子（?.)などの形でコードに現れます。これらもユビキタス言語からみるとノイズとなり、エキスパートに余計な読解能力を求めてしまいます。 <br>
それに、null時にどのような振る舞うのかコードで表現する必要性が残ってしまい可読性は下がります。 </p>

<p>NullObjectパターンを使用するのがユビキタス言語に自然に適応できますし、null対応としては効果が高いと思います。（注：null許容型ではないですよ） <br>
NullObjectパターンの使用を強いることで、開発者が過剰防衛（なんでもnullチェックをつける）をしてしまう心理的圧迫を緩和することができます。 </p>

<h2>
<span id="try-catch-から漂うコードの臭い" class="fragment"></span><a href="#try-catch-%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84"><i class="fa fa-link"></i></a>try catch から漂うコードの臭い</h2>

<p>ドメイン層における例外エラーとは何を示すのでしょうか。 <br>
個人的な考えになりますが、ドメイン層においてtry catchは、極力ないほうが望ましいと考えています。 <br>
モデルにおいて例外エラーと呼ばれる事象は、try catchではなくコードで振る舞いを記述します。（<a href="https://ja.wikipedia.org/wiki/%E5%A5%91%E7%B4%84%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0" rel="nofollow noopener" target="_blank">契約による設計</a>）<br>
そもそも実装を伴わないドメイン層が原因となる例外は実行前の解析で、事前に対応されているべきという考えであり、実装をともなうアプリケーション層、インフラ層での例外は、発生した層で処理を行い、他層は結果だけを受け取るべきだという考えです。 </p>

<p>しかし、ドメイン層で例外がまったく発生しないという訳ではありません。 <br>
自分が遭遇したドメイン層における例外は、ドメイン層をDLLにして分けていたのですが、バージョン管理を間違え依存関係が破たんしたとき、ドメイン層で例外が発生しました。 <br>
月並みですが、過剰防衛を行うのではなく、ドメイン層を守るための適切なtry catchを設定すべきと言えます。 </p>

<h1>
<span id="日本語プログラム" class="fragment"></span><a href="#%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0"><i class="fa fa-link"></i></a>日本語プログラム</h1>

<p>ユビキタス言語で必ず話題に挙がるのが、日本語問題。 <br>
私はエキスパートが普段使っている日本語ユビキタス言語は大いに活用すべきだと思っています。 </p>

<p>問題となるのは、開発者やツールの問題をどうクリアするかになります。 <br>
開発者が、日本語の混じるプログラムを読み書きするには慣れが必要ですし、IntelliSenseが使いづらくなりますので作業効率は下がります。開発メンバーへの同意は必ず得ておく必要があります。 <br>
また静的解析ツールなど、使用されるツールが2Byte文字がNGの場合、その対応が必要となります。 Qittaではコードの色分けが英語・日本語の混合ですと余計に見にくくなってしまいますね（汗</p>

<h1>
<span id="名前付き引数で可読性向上" class="fragment"></span><a href="#%E5%90%8D%E5%89%8D%E4%BB%98%E3%81%8D%E5%BC%95%E6%95%B0%E3%81%A7%E5%8F%AF%E8%AA%AD%E6%80%A7%E5%90%91%E4%B8%8A"><i class="fa fa-link"></i></a>名前付き引数で可読性向上</h1>

<p>名前付き引数を通常使う場合、定数指定されている省略可能引数がある時や、どの引数を使用するのか明示的に指定するときに使用しますが、可読性向上のために使用することもできます。 </p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//メソッド定義</span>
<span class="k">public</span> <span class="k">static</span> <span class="n">Schedule</span> <span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="err">タイトル</span><span class="p">,</span>
                           <span class="n">Date</span> <span class="err">日付</span><span class="p">,</span>
                           <span class="n">time</span> <span class="err">開始時間</span><span class="p">,</span>
                           <span class="n">TimeSpan</span> <span class="err">期間</span><span class="p">,</span>
                           <span class="kt">string</span> <span class="err">場所</span><span class="p">,</span>
                           <span class="n">Member</span> <span class="err">同行者</span><span class="p">)</span>
                           <span class="p">{</span>
                             <span class="c1">//省略</span>
                           <span class="p">}</span>

<span class="c1">//メソッド使用時、名前付き引数で可読性をあげる</span>
<span class="kt">var</span> <span class="n">schedule</span><span class="p">=</span><span class="n">Schedule</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span> 
          <span class="err">タイトル</span><span class="p">:</span> <span class="s">"買い物"</span><span class="p">,</span> 
          <span class="err">日付</span><span class="p">:</span> <span class="k">new</span> <span class="nf">Date</span><span class="p">(</span><span class="m">2017</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> 
          <span class="err">開始時間</span><span class="p">:</span> <span class="m">10</span><span class="p">:</span><span class="m">00</span><span class="p">,</span> 
          <span class="err">期間</span><span class="p">:</span> <span class="k">new</span> <span class="nf">TimeSpan</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> 
          <span class="err">場所</span><span class="p">:</span> <span class="s">"大阪"</span><span class="p">,</span> 
          <span class="err">同行者</span><span class="p">:</span><span class="s">"友人A"</span> 
         <span class="p">);</span> 
</code></pre></div></div>

<h1>
<span id="getとsetを分ける" class="fragment"></span><a href="#get%E3%81%A8set%E3%82%92%E5%88%86%E3%81%91%E3%82%8B"><i class="fa fa-link"></i></a>GetとSetを分ける</h1>

<p>モデルを表現するときに大切な事のひとつに、関連の方向性があります。 <br>
モデル図からコードを起こす場合、関連・集約・依存・・・関係性は注意されていると思いますが、もっと単純にデータの読み書きについても、可能な限り制限を課すことで、責務が判りやすくなります。 </p>

<p>単純な実現方法として、interfaceで読み書きを別けて、必要な機能だけ継承させる方法があります。 </p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//読み取りInterface</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IReader</span> 
<span class="p">{</span>
    <span class="kt">string</span> <span class="nf">GetValue</span><span class="p">();</span> 
<span class="p">}</span> 

<span class="c1">//書き込みInterface</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IWriter</span> 
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">SetValue</span><span class="p">(</span><span class="kt">string</span> <span class="k">value</span><span class="p">);</span> 
<span class="p">}</span> 

<span class="c1">//設定ファイル：読込のみ </span>
<span class="k">class</span> <span class="nc">ConfigReader</span> <span class="p">:</span> <span class="n">IReader</span> 
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">ReadValue</span><span class="p">()</span> 
    <span class="p">{</span> 
        <span class="kt">var</span> <span class="n">data</span> <span class="p">=</span> <span class="n">ConfigManager</span><span class="p">.</span><span class="nf">Get</span><span class="p">();</span> 
        <span class="c1">//何らかの処理（省略） </span>
    <span class="p">}</span> 
<span class="p">}</span> 

<span class="c1">//設定ファイル：読込と書込 </span>
<span class="k">class</span> <span class="nc">ConfigWriter</span> <span class="p">:</span> <span class="n">IReader</span><span class="p">,</span><span class="n">IWriter</span> 
<span class="p">{</span> 
    <span class="k">private</span> <span class="kt">string</span> <span class="n">_data</span><span class="p">;</span> 
    <span class="k">public</span> <span class="k">void</span> <span class="nf">ReadValue</span><span class="p">()</span> 
    <span class="p">{</span> 
        <span class="n">_data</span> <span class="p">=</span> <span class="n">ConfigManager</span><span class="p">.</span><span class="nf">Get</span><span class="p">();</span>
        <span class="c1">//何らかの処理（省略）</span>
    <span class="p">}</span> 
    <span class="k">public</span> <span class="k">void</span> <span class="nf">WriteValue</span><span class="p">()</span> 
    <span class="p">{</span> 
        <span class="n">ConfigManager</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="n">_data</span><span class="p">);</span> 
    <span class="p">}</span> 
<span class="p">}</span> 
</code></pre></div></div>

<p>GetとSetを分けることを意識することは、コマンド／クエリの分離（CQS）への考えにもつながります。 <br>
コマンド投げて結果を受け取るのではなく、コマンドとクエリにモデル的な違いが無いか考えるようにしてみて下さい。 <br>
コマンドとクエリは、モデル変化度合にも違いが出やすい箇所になります。変わりそうなところを切り分けておくというのも一つの戦略だと思います。 </p>

<h1>
<span id="適切なモデルサイズにそろえる" class="fragment"></span><a href="#%E9%81%A9%E5%88%87%E3%81%AA%E3%83%A2%E3%83%87%E3%83%AB%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%AB%E3%81%9D%E3%82%8D%E3%81%88%E3%82%8B"><i class="fa fa-link"></i></a>適切なモデルサイズにそろえる</h1>

<p>ドメイン層で使用する型はファーストクラスコレクションとして、モデルが表現したい形に即しているかが焦点となります。 <br>
この時注意したいのが、表現力が足りているかのチェックとともに、逆に過剰表現になっていないかのチェックです。 </p>

<p>例えば、モデルは日付で表現しているのに、コードでDatetimeのように「日付＋時刻」の精度をつけてしまうと思わぬ不具合を生むことになります。 <br>
もし期間指定の最終日を設定する場合、「日付＋時刻」では、「日付＋23:59:59」または「（日付＋1日）＋0:00:00」として、モデルで取り扱う粒度を超えた表現をしなくてはなりません。 <br>
モデルを表現するときは、その精度も気に掛ける必要があります。 </p>

<h1>
<span id="バブルワードbubble-word" class="fragment"></span><a href="#%E3%83%90%E3%83%96%E3%83%AB%E3%83%AF%E3%83%BC%E3%83%89bubble-word"><i class="fa fa-link"></i></a>バブルワード（bubble word）</h1>

<p>プログラミングを読みやすくするためだけに追加されるメソッドで、処理には一切影響しないのですが、可読性を向上させる方法として有効な場合があります。 </p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">static</span> <span class="k">class</span> <span class="nc">String</span> 
<span class="p">{</span> 
    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Info</span><span class="p">(</span><span class="k">this</span> <span class="kt">string</span> <span class="n">str</span><span class="p">,</span><span class="kt">string</span> <span class="n">information</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="n">str</span><span class="p">;</span> 
    <span class="p">}</span> 
    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Is</span><span class="p">(</span><span class="k">this</span> <span class="kt">string</span> <span class="n">str</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">str</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> 

<span class="c1">//例１ infoメッセージ</span>
<span class="kt">var</span> <span class="n">length</span> <span class="p">=</span> <span class="s">"かくかくしかじか"</span><span class="p">.</span><span class="nf">Info</span><span class="p">(</span><span class="s">"文字数取得"</span><span class="p">).</span><span class="n">Length</span><span class="p">;</span> 

<span class="c1">//例２　Is</span>
<span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="s">"ポチ"</span><span class="p">.</span><span class="nf">Is</span><span class="p">()+</span><span class="s">"犬です。"</span>
</code></pre></div></div>

<p>また可読性向上以外にも、使用用途は色々あります。<br>
- 処理の備忘録として<br>
- 将来ビジネスルールが変わりそうなところの目印として<br>
モデル意図を伝える有効な手法となりえます。</p>

<h1>
<span id="流れるようなインターフェース-fluent-interface" class="fragment"></span><a href="#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9-fluent-interface"><i class="fa fa-link"></i></a>流れるようなインターフェース （Fluent Interface）</h1>

<p>2つのプログラムがあります。 </p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//例１</span>
      <span class="kt">var</span> <span class="n">schedule</span><span class="p">=</span><span class="n">Schedule</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span> 
                <span class="err">タイトル</span><span class="p">:</span> <span class="s">"買い物"</span><span class="p">,</span> 
                <span class="err">日付</span><span class="p">:</span> <span class="k">new</span> <span class="nf">Date</span><span class="p">(</span><span class="m">2017</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> 
                <span class="err">開始時間</span><span class="p">:</span> <span class="m">10</span><span class="p">:</span><span class="m">00</span><span class="p">,</span> 
                <span class="err">期間</span><span class="p">:</span> <span class="k">new</span> <span class="nf">TimeSpan</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> 
                <span class="err">場所</span><span class="p">:</span> <span class="s">"大阪"</span><span class="p">,</span> 
                <span class="err">同行者</span><span class="p">:</span><span class="s">"友人A"</span> 
             <span class="p">);</span> 

<span class="c1">//例２ </span>
<span class="kt">var</span> <span class="n">schedule</span><span class="p">=</span><span class="n">Schedule</span><span class="p">.</span><span class="nf">Create</span><span class="p">()</span> 
                <span class="p">.</span><span class="err">タイトル</span><span class="p">(</span><span class="s">"買い物"</span><span class="p">)</span> 
                <span class="p">.</span><span class="err">日付</span><span class="p">(</span><span class="k">new</span> <span class="nf">Date</span><span class="p">(</span><span class="m">2017</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> 
                <span class="p">.</span><span class="err">開始時間</span><span class="p">(</span><span class="m">10</span><span class="p">:</span><span class="m">00</span><span class="p">)</span> 
                <span class="p">.</span><span class="err">期間</span><span class="p">(</span><span class="k">new</span> <span class="nf">TimeSpan</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span> 
                <span class="p">.</span><span class="err">場所</span><span class="p">(</span><span class="s">"大阪"</span><span class="p">)</span> 
                <span class="p">.</span><span class="err">同行者</span><span class="p">(</span><span class="s">"友人A"</span><span class="p">);</span> 

</code></pre></div></div>

<p>例1はよくある引数で値を指定するメソッドの形なので、開発者は理解しやすいと思います。 <br>
例2はメソッドチェーン形式ですが、メソッドを何らかの処理と考えると違和感を感じる方は多いと思われます。 <br>
この２つの表現方法の違いが、どのような効果に現れるのか考えてみたいと思います。 </p>

<p>例2の書き方は、「流れるようなインターフェース」と呼ばれるもので、エリック・エヴァンス氏とマーティン・ファウラー氏が命名したスタイルです。 <br>
<a href="http://bliki-ja.github.io/FluentInterface/" rel="nofollow noopener" target="_blank">http://bliki-ja.github.io/FluentInterface/</a></p>

<p>メソッドチェーンを使い、処理の流れをわかりやすく示す手法といえます。 <br>
上手く使うとモデルを表現する強力な武器になります。 </p>

<p>違う例で、「流れるようなインターフェース」をもう一度見てみましょう。 <br>
例ばカレーのレシピです。 </p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>var curry = Curry.Create() 
    .Add肉("牛肉") 
    .炒める() 
    .Add野菜("じゃがいも") 
    .Add野菜("ニンジン") 
    .Add野菜("玉ねぎ") 
    .炒める() 
    .Add水("1リットル") 
    .沸騰() 
    .Addルー("市販のルー") 
    .Addライス("大盛") 
    .盛り付け(); 
</code></pre></div></div>

<p>カレーのレシピのように処理の流れを表現したい場合、メソッドに引数を渡すだけでは表現できませんが、「流れるようなインタフェース」を使うことで直観的に判り易い表現を記載することができます。<br>
しかし、「流れるようなインターフェース」の問題点として、市販のルーを加えるのを忘れたり、逆に2回以上加えてしまわないように、チェック機能を考慮する必要があります。 </p>

<p>どちらが優れているという問題ではなく、それぞれの特性を考慮して、モデルをどう表現したいか、変更容易性をどこに求めるかが大事になります。 </p>

<p>ちなみに例２のソースはこのような形になります。 <br>
（単純に自身のインスタンスを返しているだけです） </p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//例２（再掲） </span>
<span class="kt">var</span> <span class="n">schedule</span><span class="p">=</span><span class="n">Schedule</span><span class="p">.</span><span class="nf">Create</span><span class="p">()</span> 
                <span class="p">.</span><span class="err">タイトル</span><span class="p">(</span><span class="s">"買い物"</span><span class="p">)</span> 
                <span class="p">.</span><span class="err">日付</span><span class="p">(</span><span class="k">new</span> <span class="nf">Date</span><span class="p">(</span><span class="m">2017</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> 
                <span class="p">.</span><span class="err">開始時間</span><span class="p">(</span><span class="m">10</span><span class="p">:</span><span class="m">00</span><span class="p">)</span> 
                <span class="p">.</span><span class="err">期間</span><span class="p">(</span><span class="k">new</span> <span class="nf">TimeSpan</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span> 
                <span class="p">.</span><span class="err">場所</span><span class="p">(</span><span class="s">"大阪"</span><span class="p">)</span> 
                <span class="p">.</span><span class="err">同行者</span><span class="p">(</span><span class="s">"友人A"</span><span class="p">);</span> 



<span class="k">public</span> <span class="k">class</span> <span class="nc">Schedule</span> 
<span class="p">{</span> 
    <span class="k">public</span> <span class="k">static</span> <span class="n">Schedule</span> <span class="nf">Create</span><span class="p">()</span> 
    <span class="p">{</span> 
        <span class="c1">//スケジュール作成時の処理（省略） </span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Schedule</span><span class="p">();</span> 
    <span class="p">}</span> 
    <span class="k">public</span> <span class="n">Schedule</span> <span class="err">タイトル</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="c1">//タイトル追加の処理（省略） </span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 
    <span class="k">public</span> <span class="n">Schedule</span> <span class="err">日付</span><span class="p">(</span><span class="n">Date</span> <span class="n">date</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="c1">//日付追加の処理（省略） </span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 
    <span class="k">public</span> <span class="n">Schedule</span> <span class="err">開始時間</span><span class="p">(</span><span class="n">time</span> <span class="n">startTime</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="c1">//開始時間追加の処理（省略） </span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 
    <span class="k">public</span> <span class="n">Schedule</span> <span class="err">期間</span><span class="p">(</span><span class="n">TimeSpan</span> <span class="n">duration</span><span class="p">)</span> 
    <span class="p">{</span> 
       <span class="c1">//期間追加の処理（省略）</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 
    <span class="k">public</span> <span class="n">Schedule</span> <span class="err">場所</span><span class="p">(</span><span class="kt">string</span> <span class="n">area</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="c1">//場所追加の処理（省略） </span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 
    <span class="k">public</span> <span class="n">Schedule</span> <span class="err">同行者</span><span class="p">(</span><span class="n">Member</span> <span class="n">member</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="c1">//同行者追加の処理（省略） </span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 
<span class="p">}</span> 

</code></pre></div></div>

<h1>
<span id="処理の流れを制限する" class="fragment"></span><a href="#%E5%87%A6%E7%90%86%E3%81%AE%E6%B5%81%E3%82%8C%E3%82%92%E5%88%B6%E9%99%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>処理の流れを制限する</h1>

<p>処理の流れに順番を指定したい場合、Taskを使うと、 </p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code> var task = Task.Run(() =&gt; 処理A()) 
                .ContinueWith(t =&gt; 処理B(t.Result)) 
                .ContinueWith(t =&gt; 処理C(t.Result)) 
                .ContinueWith(t =&gt; 処理D(t.Result)); 

</code></pre></div></div>

<p>のように順送りの表現ができますが、「進行用インターフェース」という手法を使うことで、より細かい処理順序の指定や、処理回数の制限を規定することができます。 </p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="c1">//例：処理は順番に1回だけ行いたい場合 </span>

<span class="c1">//タイトル追加Interface</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IScheduleAdd</span> 
<span class="p">{</span> 
    <span class="n">IScheduleDay</span> <span class="n">Add</span><span class="err">タイトル</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">);</span> 
<span class="p">}</span> 

<span class="c1">//日付追加Interface</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IScheduleDay</span> 
<span class="p">{</span> 
    <span class="n">IScheduleFrom</span> <span class="err">日付</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">date</span><span class="p">);</span> 
<span class="p">}</span> 

<span class="c1">//開始時刻追加Interface</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IScheduleFrom</span> 
<span class="p">{</span> 
    <span class="n">IScheduleDuration</span> <span class="err">開始時間</span><span class="p">(</span><span class="kt">string</span> <span class="n">startTime</span><span class="p">);</span> 
<span class="p">}</span> 

<span class="c1">//期間追加Interface</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IScheduleDuration</span> 
<span class="p">{</span> 
    <span class="n">IScheduleAt</span> <span class="err">期間</span><span class="p">(</span><span class="n">TimeSpan</span> <span class="n">duration</span><span class="p">);</span> 
<span class="p">}</span> 

<span class="c1">//場所追加Interface</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IScheduleAt</span> 
<span class="p">{</span> 
    <span class="n">IScheduleAdd</span> <span class="err">場所</span><span class="p">(</span><span class="kt">string</span> <span class="n">area</span><span class="p">);</span> 
<span class="p">}</span> 

<span class="c1">//スケジュールクラス</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Schedule</span><span class="p">:</span> <span class="n">IScheduleAdd</span><span class="p">,</span> <span class="n">IScheduleDay</span><span class="p">,</span> <span class="n">IScheduleFrom</span><span class="p">,</span> <span class="n">IScheduleDuration</span><span class="p">,</span> <span class="n">IScheduleAt</span> 
<span class="p">{</span> 
    <span class="k">public</span> <span class="k">static</span> <span class="n">IScheduleAdd</span> <span class="nf">Create</span><span class="p">()</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Schedule</span><span class="p">();</span> 
    <span class="p">}</span> 

    <span class="k">public</span> <span class="n">IScheduleDay</span> <span class="n">Add</span><span class="err">タイトル</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 

    <span class="k">public</span> <span class="n">IScheduleFrom</span> <span class="err">日付</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">date</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 

    <span class="k">public</span> <span class="n">IScheduleDuration</span> <span class="err">開始時間</span><span class="p">(</span><span class="kt">string</span> <span class="n">startTime</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 

    <span class="k">public</span> <span class="n">IScheduleAt</span> <span class="err">期間</span><span class="p">(</span><span class="n">TimeSpan</span> <span class="n">duration</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 

    <span class="k">public</span> <span class="n">IScheduleAdd</span> <span class="err">場所</span><span class="p">(</span><span class="kt">string</span> <span class="n">area</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 
<span class="p">}</span> 
</code></pre></div></div>

<p>こうすることで、Addタイトルは１回しか選択できず、Addタイトル後には必ず日付しか選択できなくなります。 </p>

<p>例：Addタイトル後は日付しか選択できない状態<br>
 <a href="https://camo.qiitausercontent.com/e4d7ae8218711a4e638cb1da5567e179468affef/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f363732382f35653135383163382d323939322d616463332d303266332d6234396634653538396239622e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F5e1581c8-2992-adc3-02f3-b49f4e589b9b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=92a4d700d91ab2d22e24a8a82db02b6f" alt="img1.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/6728/5e1581c8-2992-adc3-02f3-b49f4e589b9b.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F5e1581c8-2992-adc3-02f3-b49f4e589b9b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fb6fdd1d7ec5411ba701bf40caba5b0b 1x" loading="lazy"></a></p>

<p>またの下記のように書き換えた場合は、Addタイトルの後は、日付、開始時刻のどちらかを選択させることができます。 </p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">interface</span> <span class="nc">IScheduleDay</span><span class="p">:</span> <span class="n">IScheduleFrom</span> 
<span class="p">{</span> 
    <span class="n">IScheduleFrom</span> <span class="err">日付</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">date</span><span class="p">);</span> 
<span class="p">}</span> 
</code></pre></div></div>

<p>例：Addタイトル後は、日付・開始時刻のどちらかが選択可能<br>
<a href="https://camo.qiitausercontent.com/2427ae8892de7253defaa94100248ace6d2a5e0a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f363732382f31313364303036642d386632312d326535312d656565632d6264393737656637386335622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F113d006d-8f21-2e51-eeec-bd977ef78c5b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3dd48ace481851898f2eb78b217275a0" alt="img2.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/6728/113d006d-8f21-2e51-eeec-bd977ef78c5b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F113d006d-8f21-2e51-eeec-bd977ef78c5b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=23e1136def91dd4cf85af81888f1c423 1x" loading="lazy"></a></p>

<p>コードの書き方によって、処理流れをコントロールすることができます。 </p>

<h1>
<span id="流れるようなインターフェースの応用" class="fragment"></span><a href="#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%AE%E5%BF%9C%E7%94%A8"><i class="fa fa-link"></i></a>流れるようなインターフェースの応用</h1>

<p>流れるようなインターフェースを応用して、メソッド内だけで完結する作業・振る舞いを明示的に記述することも出来ます。 </p>

<p>下記例では、洋服試着は試着室が空いている場合のみ行えることを示していますが、大筋からは隠蔽させています。 </p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="c1">//Shoppingクラス</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Shopping</span> 
<span class="p">{</span> 
    <span class="c1">//買い物開始</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">Shopping</span> <span class="nf">Start</span><span class="p">(){</span> 
      <span class="k">return</span> <span class="k">new</span> <span class="nf">Shopping</span><span class="p">();</span>         
    <span class="p">}</span> 

    <span class="c1">//商品選択</span>
    <span class="k">public</span> <span class="n">Shopping</span> <span class="nf">SelectItem</span><span class="p">(</span><span class="kt">string</span> <span class="n">items</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 

    <span class="c1">//商品試着</span>
    <span class="k">public</span> <span class="n">Shopping</span> <span class="err">試着</span><span class="p">(</span><span class="n">Action</span><span class="p">&lt;</span><span class="n">Fitting</span><span class="p">&gt;</span> <span class="n">action</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="err">試着室</span> <span class="p">=</span> <span class="n">FittingRoom</span><span class="p">.</span><span class="nf">Prepare</span><span class="p">())</span> 
        <span class="p">{</span> 
            <span class="k">if</span><span class="p">(</span><span class="err">試着室</span><span class="p">.</span><span class="nf">CanUse</span><span class="p">())</span> 
                <span class="nf">action</span><span class="p">(</span><span class="k">new</span> <span class="nf">Fitting</span><span class="p">());</span> 
        <span class="p">}</span> 
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> 
    <span class="p">}</span> 

    <span class="c1">//商品購入</span>
    <span class="k">public</span> <span class="k">void</span> <span class="err">購入</span><span class="p">()</span> 
    <span class="p">{</span> 
    <span class="p">}</span> 
<span class="p">}</span> 

<span class="c1">//試着クラス</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Fitting</span> 
<span class="p">{</span> 
    <span class="c1">//スタッフの補助あり </span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">WithHelp</span><span class="p">(</span><span class="kt">string</span> <span class="n">item</span><span class="p">)</span> 
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="c1">//スタッフの補助なし </span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Self</span><span class="p">(</span><span class="kt">string</span> <span class="n">item</span><span class="p">)</span> 
    <span class="p">{</span>
    <span class="p">}</span> 
<span class="p">}</span> 

<span class="c1">//試着室クラス</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">FittingRoom</span> <span class="p">:</span> <span class="n">IDisposable</span> 
<span class="p">{</span> 
    <span class="k">public</span> <span class="k">static</span> <span class="n">FittingRoom</span> <span class="nf">Prepare</span><span class="p">()</span> 
    <span class="p">{</span> 
        <span class="k">return</span> <span class="k">new</span> <span class="nf">FittingRoom</span><span class="p">();</span> 
    <span class="p">}</span> 

    <span class="c1">//試着室が使えるかチェック </span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">CanUse</span><span class="p">()</span> 
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
    <span class="p">}</span> 

     <span class="c1">//試着室解放  </span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span> 
    <span class="p">{</span>
    <span class="p">}</span> 
<span class="p">}</span> 


<span class="c1">//大筋からは試着室の事は隠ぺいし、モデルの俯瞰図的な使用をおこなっている </span>
<span class="kt">var</span> <span class="n">shopping</span> <span class="p">=</span> <span class="n">Shopping</span><span class="p">.</span><span class="nf">Start</span><span class="p">()</span> 
        <span class="p">.</span><span class="nf">SelectItem</span><span class="p">(</span><span class="s">"洋服A"</span><span class="p">)</span> 
        <span class="p">.</span><span class="nf">SelectItem</span><span class="p">(</span><span class="s">"洋服B"</span><span class="p">)</span> 
        <span class="p">.</span><span class="err">試着</span><span class="p">(</span><span class="n">fittingt</span> <span class="p">=&gt;</span> 
        <span class="p">{</span> 
            <span class="n">fittingt</span><span class="p">.</span><span class="nf">WithHelp</span><span class="p">(</span><span class="s">"洋服C"</span><span class="p">);</span> 
        <span class="p">})</span> 
        <span class="p">.</span><span class="nf">SelectItem</span><span class="p">(</span><span class="s">"洋服C"</span><span class="p">)</span> 
        <span class="p">.</span><span class="err">購入</span><span class="p">();</span> 

</code></pre></div></div>

<p>コードの書き方によっては、処理の流れを分岐させるなど、より複雑な表現が可能となります。 </p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>
<span class="kt">var</span> <span class="n">shopping</span> <span class="p">=</span> <span class="n">Shopping</span><span class="p">.</span><span class="nf">Start</span><span class="p">()</span> 
        <span class="p">.</span><span class="nf">IfSelect</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span> 
        <span class="p">{</span> 
            <span class="n">t</span><span class="p">.</span><span class="nf">SelectItem</span><span class="p">(</span><span class="s">"洋服Ａ"</span><span class="p">)</span> 
             <span class="p">.</span><span class="nf">SelectItem</span><span class="p">(</span><span class="s">"洋服Ｃ"</span><span class="p">)</span> 
             <span class="p">.</span><span class="err">購入</span><span class="p">()</span> 
        <span class="p">})</span> 
        <span class="p">.</span><span class="nf">IfSelect</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span> 
        <span class="p">{</span> 
            <span class="n">t</span><span class="p">.</span><span class="nf">SelectItem</span><span class="p">(</span><span class="s">"洋服Ｂ"</span><span class="p">)</span> 
             <span class="p">.</span><span class="nf">SelectItem</span><span class="p">(</span><span class="s">"洋服Ｃ"</span><span class="p">)</span> 
             <span class="p">.</span><span class="err">購入</span><span class="p">()</span> 
        <span class="p">})</span> 
</code></pre></div></div>

<h1>
<span id="流れるようなインターフェースの問題点" class="fragment"></span><a href="#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9"><i class="fa fa-link"></i></a>流れるようなインターフェースの問題点</h1>

<p>「流れるようなインターフェース」は処理の流れをそのまま表現でき、表現力は強力ですが、時にはその表現力が悪い方に働く事があります。 <br>
モデルが複雑になってくると、インタフェースも同様に複雑になっていき、どんどん流れるようなインターフェースとは呼べない状態になってしまいます。つまり、複雑なトランザクションスクリプトと同じ状態になり、<strong>ドメインモデル貧血症</strong>に陥ってしまうのです。  </p>

<p>書籍：実践プログラミングDSLには、従うべき指針として下記３つを挙げられています。 </p>

<blockquote>
<p><strong>複雑さ最小の原則の遵守</strong> <br>
ホスト言語で使えるイディオムのうち、解決モデルに適合するものの中で最も単純なものを選択して下さい。 </p>

<p><strong>最適な表現力の尊重</strong> <br>
DSLの表現力を考え得る最高のレベルにまで高めようとすると、実装の複雑さは保証不可能なレベルに至ってしまいます。言語の表現力は、ユーザが必要とするレベルに留めておいてください。 </p>

<p><strong>入念に設計された抽象の原則を弱めない</strong> <br>
読みやすさを狙って言語にバブルワードを追加するとカプセル化のレベルが下がりますし、実装の内部が露出してしまいやくなります。（省略）言語の設計とは常にトレードオフと妥協のせめぎあいだということを忘れてはなりません。抽象の設計にあたっては、何を決断し、何を妥協すべきかを、常に批判的に評価してください。設計の原則がDSLユーザの利用用途と合っているか、常に意識する必要があります。 </p>
</blockquote>

<h1>
<span id="コードにおける表現方法について色々" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E8%A1%A8%E7%8F%BE%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E8%89%B2%E3%80%85"><i class="fa fa-link"></i></a>コードにおける表現方法について色々</h1>

<p>モデルの表現方法として、ドメイン特化型言語（DSL）を参考にさせていただきましたが、表現に関する議論は古くからあり、1976年にはデイビッド・パーナスがプログラムファミリの概念を示しており、1986年にはジョン ベントリーが、プログラミングとは特定問題を解決する「リトル言語」だと述べられています。 </p>

<p>また、文脈を損なわずにプログラム言語に落としこむ手法で有名なところをでは、 <br>
 ドナルド・クヌースが提唱している「<a href="https://ja.wikipedia.org/wiki/%E6%96%87%E8%8A%B8%E7%9A%84%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0" rel="nofollow noopener" target="_blank">文芸的プログラミング</a>」<br>
ウォード・カニンガムの<a href="http://c2.com/w4/wikibase/wiki.cgi?WikiInHyperPerl" rel="nofollow noopener" target="_blank">WikiBase</a>などがあります。 <br>
興味があるかたはこちらも御覧ください。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fkawakawa%2Fitems%2F995d31ce8db97ce5cf04&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fkawakawa%2Fitems%2F995d31ce8db97ce5cf04&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kawakawa/items/995d31ce8db97ce5cf04/likers" class="css-1iupg5d">39</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">38</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/995d31ce8db97ce5cf04/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kawakawa/items/995d31ce8db97ce5cf04/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kawakawa/items/995d31ce8db97ce5cf04/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kawakawa/items/995d31ce8db97ce5cf04/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kawakawa/items/995d31ce8db97ce5cf04.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-ea273a0f-73c0-4c6b-9ae3-b57953c56102">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-51a4f125-c01a-4a4b-b00e-faf95e6d9ec6"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-51a4f125-c01a-4a4b-b00e-faf95e6d9ec6">{}</script>
      
<div id="LoginModal-react-component-4e5925f2-d49e-41d9-b184-9afce28fb7d4"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-4e5925f2-d49e-41d9-b184-9afce28fb7d4">{}</script>
      
<div id="StockModal-react-component-7bc0dd91-8ccf-4c90-8f30-1ce2ea4c9638"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-7bc0dd91-8ccf-4c90-8f30-1ce2ea4c9638">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;dxGcYYq0VQJhSNhyumSmWT3p1Xv5u9Ilp258LcnKxH6G9wW2tO7RvOQ60YXQhU6Igs7dHkP3e4HUiaGWlSOkjQ==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"前提\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提\u003c/h1\u003e\n\n\u003cp\u003eDDDでは、モデルとコード（実装）を深く結びつけることでできる動くモデルを使ってドメインエキスパート（以下、エキスパート）と開発者が共に理解を深めながら、開発をすすめていきます。 \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cem\u003e参照：エリック・エヴァンスのドメイン駆動設計\u003c/em\u003e \u003cbr\u003e\n \u003cem\u003eモデルと設計の核心が相互に形成し合う。\u003c/em\u003e\u003cbr\u003e\n \u003cem\u003eモデルと実装が密接に結びつくことによって、モデルはドメインと深く関連したものになり、モデルに対する分析が、最終成果物である実際に動くプログラムに適用されることが保証される。\u003c/em\u003e \u003cbr\u003e\n \u003cem\u003eこのモデルと実装の結びつきは、保守や継続的開発においても有効だが、それは、モデルの理解に基づいてコードを解釈できるからである\u003c/em\u003e \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e開発していく中でいつも悩むのは、モデリングとコードを結びつける為にどう実装するかです。\u003cbr\u003e\n今回はコードの実装、モデルとコードの結び付けを一番強く意識づけられているドメイン層について、C#ではどのような表現をすれば判り易く、かつ時間経過にともなう変更に強くなれるのか考えてみたいと思います。 \u003cbr\u003e\n（モデリングではなく、モデルの表現方法についての考察となります。） \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"判り易いコードとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%A4%E3%82%8A%E6%98%93%E3%81%84%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e判り易いコードとは？\u003c/h2\u003e\n\n\u003cp\u003e開発者にとって、判り易いコードというだけではありません。 \u003cbr\u003e\nエキスパートにとっても判り易い、コードの意図が把握できるというのが大事となります。 \u003c/p\u003e\n\n\u003cp\u003e書籍：実践ドメイン駆動設計に判り易い例が載っています。 \u003cbr\u003e\n「ナースが患者に、インフルエンザワクチンを適量投与する」をコードで表してみましょう。 \u003cbr\u003e\n（※変数・メソッドを書籍から多少変換しています） \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n//例１\n患者.set注射種別(種別.インフルエンザワクチン); \n患者.set投与量(適量); \n患者.set投与者(ナース); \n\n//例２\n患者.giveインフルエンザワクチン(); \n\n//例３ \nvar インフルエンザワクチン= ワクチン.インフルエンザワクチン成人適量(); \nナース.注射投与(患者, インフルエンザワクチン); \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eどのコードが、行いたい意図をコードで表現出来ていると思われますか？ \u003c/p\u003e\n\n\u003cp\u003e私が思うエキスパートがコードを読める事の一番のメリットは、エキスパートとコード（ユビキタス言語）を使ってコミュニケーションが取れるという点です。実装がモデルに即していないときの指摘が、画面・帳票を確認してからよりも早い段階でフィードバックを貰うことができます。\u003cbr\u003e\nまた、仕様変更でモデルのどこが変わるのか、エキスパートから開発者に具体的どの箇所がどのように変化するのか伝えてもらうことができます。 \u003c/p\u003e\n\n\u003cp\u003e副次的な変化として、コードの性質が変わってきたように感じます。 \u003cbr\u003e\nDDDを実践する前は、コードは開発者のモノという認識があり、「どのように実装するか」に注力を傾けていたのですが、今では「何を作るのか」を強く意識するコードを書くようになりました。 \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"時間経過による変更に強くするには\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%99%82%E9%96%93%E7%B5%8C%E9%81%8E%E3%81%AB%E3%82%88%E3%82%8B%E5%A4%89%E6%9B%B4%E3%81%AB%E5%BC%B7%E3%81%8F%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e時間経過による変更に強くするには？\u003c/h2\u003e\n\n\u003cp\u003e「時の試練に耐える」と表現されるように、コードのライフサイクルが長くなれば、必ず遭遇する変更要望にどれ位容易に追随できるのか、何を許可して何に制限するのか。 \u003cbr\u003e\n柔軟性と堅牢性のトレードオフを如何にC#で表現できるかという事になります。 \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"その他もろもろ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%82%82%E3%82%8D%E3%82%82%E3%82%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその他もろもろ\u003c/h2\u003e\n\n\u003cp\u003eそもそもDDDに向いてる向いていないプロジェクト、エキスパートの協力度合、DDD実践にともなう費用対効果などの話も今回の対象外となります \u003cbr\u003e\n今回はC#で表現方法を考察していますが、Javaでは異なる表現方法になりますし、オブジェクト指向・関数型、静的言語、動的言語、使用するフレームワークなど状況によって表現方法は大きく変わってきます。書籍：実践プログラミングDSLではその点を詳しく紹介されています。\u003cbr\u003e\n大事なのは、\u003cstrong\u003eモデルの意図を損なう事なくコードで表現可能かどうか\u003c/strong\u003eです。 \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コードの臭い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコードの臭い\u003c/h1\u003e\n\n\u003cp\u003eエキスパートも読めるようにするとなると、ユビキタス言語に伴わないC#固有の文字・構文はノイズとなってしまうため、可能な限り除外するようにします。 \u003cbr\u003e\nそこでC#でよく現れるnew、null、try catchについて考えてみたいと思います。 \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"new-から漂うコードの臭い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#new-%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003enew から漂うコードの臭い\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003evar 材料 = new 材料();\u003c/code\u003e\u003cbr\u003e\nこのコードは材料Classのインスタンスを生成を行っているのですが、モデル的には何を意味しているのでしょうか？ \u003cbr\u003e\nモデルの世界とは、newをすれば、目の前に材料が突然現れるような便利な世界でよいのでしょうか？ \u003c/p\u003e\n\n\u003cp\u003e現実世界では材料を用意するために、何処からか購入したり、材料Aと材料Bを組み合わせて新しい材料として精製したりなど、何かしらの作業が発生します。 \u003ccode\u003enew 材料()\u003c/code\u003e にそのような意図を込める必要はないのでしょうか。 \u003cbr\u003e\n今はスコープ外だとして、モデルに表現する必要はなくても、材料生成時に何らかのビジネスルールが必要になる可能性は十分に考えられます。 \u003c/p\u003e\n\n\u003cp\u003eDDD本ではFactoryパターン、Repositoryパターンが紹介されています。 \u003cbr\u003e\n直接newするのではなく、newにかかわる処理を上手く切り出すことで、モデルの振舞を記する場所を用意します。 \u003cbr\u003e\n（ドメイン層から直接DBを参照させたくないが為だけに有るパターンの訳ではありません。） \u003c/p\u003e\n\n\u003cp\u003eまた容易にnewできてしまうと、行儀の悪いプログラマーがつい近道をしようとコンテキストを越えてnewしてしまうかもしれません。 容易にnewを行えないようにする制限をかけておくことを忘れないようにしておくことも大事です。（Builderパターンに近いですね） \u003cbr\u003e\nドメイン層にnewが現れた場合、それがモデルの何を表しているのか一度考えてみてください。 \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"nullから漂うコードの臭い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#null%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003enullから漂うコードの臭い\u003c/h2\u003e\n\n\u003cp\u003enullもモデルにおいて存在無しを示す表現ではありません。 \u003cbr\u003e\nnullの多くは\u003ccode\u003eif（●● != null)\u003c/code\u003eや\u003ccode\u003eIsNull（●●）\u003c/code\u003e、演算子としては??演算子、Null条件演算子（?.)などの形でコードに現れます。これらもユビキタス言語からみるとノイズとなり、エキスパートに余計な読解能力を求めてしまいます。 \u003cbr\u003e\nそれに、null時にどのような振る舞うのかコードで表現する必要性が残ってしまい可読性は下がります。 \u003c/p\u003e\n\n\u003cp\u003eNullObjectパターンを使用するのがユビキタス言語に自然に適応できますし、null対応としては効果が高いと思います。（注：null許容型ではないですよ） \u003cbr\u003e\nNullObjectパターンの使用を強いることで、開発者が過剰防衛（なんでもnullチェックをつける）をしてしまう心理的圧迫を緩和することができます。 \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"try-catch-から漂うコードの臭い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#try-catch-%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003etry catch から漂うコードの臭い\u003c/h2\u003e\n\n\u003cp\u003eドメイン層における例外エラーとは何を示すのでしょうか。 \u003cbr\u003e\n個人的な考えになりますが、ドメイン層においてtry catchは、極力ないほうが望ましいと考えています。 \u003cbr\u003e\nモデルにおいて例外エラーと呼ばれる事象は、try catchではなくコードで振る舞いを記述します。（\u003ca href=\"https://ja.wikipedia.org/wiki/%E5%A5%91%E7%B4%84%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0\" rel=\"nofollow noopener\" target=\"_blank\"\u003e契約による設計\u003c/a\u003e）\u003cbr\u003e\nそもそも実装を伴わないドメイン層が原因となる例外は実行前の解析で、事前に対応されているべきという考えであり、実装をともなうアプリケーション層、インフラ層での例外は、発生した層で処理を行い、他層は結果だけを受け取るべきだという考えです。 \u003c/p\u003e\n\n\u003cp\u003eしかし、ドメイン層で例外がまったく発生しないという訳ではありません。 \u003cbr\u003e\n自分が遭遇したドメイン層における例外は、ドメイン層をDLLにして分けていたのですが、バージョン管理を間違え依存関係が破たんしたとき、ドメイン層で例外が発生しました。 \u003cbr\u003e\n月並みですが、過剰防衛を行うのではなく、ドメイン層を守るための適切なtry catchを設定すべきと言えます。 \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"日本語プログラム\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e日本語プログラム\u003c/h1\u003e\n\n\u003cp\u003eユビキタス言語で必ず話題に挙がるのが、日本語問題。 \u003cbr\u003e\n私はエキスパートが普段使っている日本語ユビキタス言語は大いに活用すべきだと思っています。 \u003c/p\u003e\n\n\u003cp\u003e問題となるのは、開発者やツールの問題をどうクリアするかになります。 \u003cbr\u003e\n開発者が、日本語の混じるプログラムを読み書きするには慣れが必要ですし、IntelliSenseが使いづらくなりますので作業効率は下がります。開発メンバーへの同意は必ず得ておく必要があります。 \u003cbr\u003e\nまた静的解析ツールなど、使用されるツールが2Byte文字がNGの場合、その対応が必要となります。 Qittaではコードの色分けが英語・日本語の混合ですと余計に見にくくなってしまいますね（汗\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"名前付き引数で可読性向上\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%90%8D%E5%89%8D%E4%BB%98%E3%81%8D%E5%BC%95%E6%95%B0%E3%81%A7%E5%8F%AF%E8%AA%AD%E6%80%A7%E5%90%91%E4%B8%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e名前付き引数で可読性向上\u003c/h1\u003e\n\n\u003cp\u003e名前付き引数を通常使う場合、定数指定されている省略可能引数がある時や、どの引数を使用するのか明示的に指定するときに使用しますが、可読性向上のために使用することもできます。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//メソッド定義\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                           \u003cspan class=\"n\"\u003eDate\u003c/span\u003e \u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                           \u003cspan class=\"n\"\u003etime\u003c/span\u003e \u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                           \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                           \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                           \u003cspan class=\"n\"\u003eMember\u003c/span\u003e \u003cspan class=\"err\"\u003e同行者\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                             \u003cspan class=\"c1\"\u003e//省略\u003c/span\u003e\n                           \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//メソッド使用時、名前付き引数で可読性をあげる\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eschedule\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \n          \u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"買い物\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n          \u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2017\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \n          \u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n          \u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \n          \u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"大阪\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n          \u003cspan class=\"err\"\u003e同行者\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s\"\u003e\"友人A\"\u003c/span\u003e \n         \u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"getとsetを分ける\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#get%E3%81%A8set%E3%82%92%E5%88%86%E3%81%91%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eGetとSetを分ける\u003c/h1\u003e\n\n\u003cp\u003eモデルを表現するときに大切な事のひとつに、関連の方向性があります。 \u003cbr\u003e\nモデル図からコードを起こす場合、関連・集約・依存・・・関係性は注意されていると思いますが、もっと単純にデータの読み書きについても、可能な限り制限を課すことで、責務が判りやすくなります。 \u003c/p\u003e\n\n\u003cp\u003e単純な実現方法として、interfaceで読み書きを別けて、必要な機能だけ継承させる方法があります。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//読み取りInterface\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIReader\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//書き込みInterface\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIWriter\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//設定ファイル：読込のみ \u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eConfigReader\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIReader\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadValue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eConfigManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n        \u003cspan class=\"c1\"\u003e//何らかの処理（省略） \u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//設定ファイル：読込と書込 \u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eConfigWriter\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIReader\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003eIWriter\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_data\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadValue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"n\"\u003e_data\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eConfigManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//何らかの処理（省略）\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWriteValue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"n\"\u003eConfigManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_data\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eGetとSetを分けることを意識することは、コマンド／クエリの分離（CQS）への考えにもつながります。 \u003cbr\u003e\nコマンド投げて結果を受け取るのではなく、コマンドとクエリにモデル的な違いが無いか考えるようにしてみて下さい。 \u003cbr\u003e\nコマンドとクエリは、モデル変化度合にも違いが出やすい箇所になります。変わりそうなところを切り分けておくというのも一つの戦略だと思います。 \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"適切なモデルサイズにそろえる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%81%A9%E5%88%87%E3%81%AA%E3%83%A2%E3%83%87%E3%83%AB%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%AB%E3%81%9D%E3%82%8D%E3%81%88%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e適切なモデルサイズにそろえる\u003c/h1\u003e\n\n\u003cp\u003eドメイン層で使用する型はファーストクラスコレクションとして、モデルが表現したい形に即しているかが焦点となります。 \u003cbr\u003e\nこの時注意したいのが、表現力が足りているかのチェックとともに、逆に過剰表現になっていないかのチェックです。 \u003c/p\u003e\n\n\u003cp\u003e例えば、モデルは日付で表現しているのに、コードでDatetimeのように「日付＋時刻」の精度をつけてしまうと思わぬ不具合を生むことになります。 \u003cbr\u003e\nもし期間指定の最終日を設定する場合、「日付＋時刻」では、「日付＋23:59:59」または「（日付＋1日）＋0:00:00」として、モデルで取り扱う粒度を超えた表現をしなくてはなりません。 \u003cbr\u003e\nモデルを表現するときは、その精度も気に掛ける必要があります。 \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"バブルワードbubble-word\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%90%E3%83%96%E3%83%AB%E3%83%AF%E3%83%BC%E3%83%89bubble-word\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eバブルワード（bubble word）\u003c/h1\u003e\n\n\u003cp\u003eプログラミングを読みやすくするためだけに追加されるメソッドで、処理には一切影響しないのですが、可読性を向上させる方法として有効な場合があります。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003einformation\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eIs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//例１ infoメッセージ\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"かくかくしかじか\"\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"文字数取得\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//例２　Is\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ポチ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIs\u003c/span\u003e\u003cspan class=\"p\"\u003e()+\u003c/span\u003e\u003cspan class=\"s\"\u003e\"犬です。\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまた可読性向上以外にも、使用用途は色々あります。\u003cbr\u003e\n- 処理の備忘録として\u003cbr\u003e\n- 将来ビジネスルールが変わりそうなところの目印として\u003cbr\u003e\nモデル意図を伝える有効な手法となりえます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"流れるようなインターフェース-fluent-interface\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9-fluent-interface\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e流れるようなインターフェース （Fluent Interface）\u003c/h1\u003e\n\n\u003cp\u003e2つのプログラムがあります。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//例１\u003c/span\u003e\n      \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eschedule\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \n                \u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"買い物\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n                \u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2017\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \n                \u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n                \u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \n                \u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"大阪\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n                \u003cspan class=\"err\"\u003e同行者\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s\"\u003e\"友人A\"\u003c/span\u003e \n             \u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//例２ \u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eschedule\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"買い物\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2017\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e00\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"大阪\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e同行者\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"友人A\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e例1はよくある引数で値を指定するメソッドの形なので、開発者は理解しやすいと思います。 \u003cbr\u003e\n例2はメソッドチェーン形式ですが、メソッドを何らかの処理と考えると違和感を感じる方は多いと思われます。 \u003cbr\u003e\nこの２つの表現方法の違いが、どのような効果に現れるのか考えてみたいと思います。 \u003c/p\u003e\n\n\u003cp\u003e例2の書き方は、「流れるようなインターフェース」と呼ばれるもので、エリック・エヴァンス氏とマーティン・ファウラー氏が命名したスタイルです。 \u003cbr\u003e\n\u003ca href=\"http://bliki-ja.github.io/FluentInterface/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://bliki-ja.github.io/FluentInterface/\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eメソッドチェーンを使い、処理の流れをわかりやすく示す手法といえます。 \u003cbr\u003e\n上手く使うとモデルを表現する強力な武器になります。 \u003c/p\u003e\n\n\u003cp\u003e違う例で、「流れるようなインターフェース」をもう一度見てみましょう。 \u003cbr\u003e\n例ばカレーのレシピです。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003evar curry = Curry.Create() \n    .Add肉(\"牛肉\") \n    .炒める() \n    .Add野菜(\"じゃがいも\") \n    .Add野菜(\"ニンジン\") \n    .Add野菜(\"玉ねぎ\") \n    .炒める() \n    .Add水(\"1リットル\") \n    .沸騰() \n    .Addルー(\"市販のルー\") \n    .Addライス(\"大盛\") \n    .盛り付け(); \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eカレーのレシピのように処理の流れを表現したい場合、メソッドに引数を渡すだけでは表現できませんが、「流れるようなインタフェース」を使うことで直観的に判り易い表現を記載することができます。\u003cbr\u003e\nしかし、「流れるようなインターフェース」の問題点として、市販のルーを加えるのを忘れたり、逆に2回以上加えてしまわないように、チェック機能を考慮する必要があります。 \u003c/p\u003e\n\n\u003cp\u003eどちらが優れているという問題ではなく、それぞれの特性を考慮して、モデルをどう表現したいか、変更容易性をどこに求めるかが大事になります。 \u003c/p\u003e\n\n\u003cp\u003eちなみに例２のソースはこのような形になります。 \u003cbr\u003e\n（単純に自身のインスタンスを返しているだけです） \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//例２（再掲） \u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eschedule\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"買い物\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2017\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e00\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"大阪\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e同行者\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"友人A\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\n\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSchedule\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"c1\"\u003e//スケジュール作成時の処理（省略） \u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSchedule\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"c1\"\u003e//タイトル追加の処理（省略） \u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e \u003cspan class=\"n\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"c1\"\u003e//日付追加の処理（省略） \u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e \u003cspan class=\"n\"\u003estartTime\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"c1\"\u003e//開始時間追加の処理（省略） \u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003eduration\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n       \u003cspan class=\"c1\"\u003e//期間追加の処理（省略）\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003earea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"c1\"\u003e//場所追加の処理（省略） \u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eSchedule\u003c/span\u003e \u003cspan class=\"err\"\u003e同行者\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMember\u003c/span\u003e \u003cspan class=\"n\"\u003emember\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"c1\"\u003e//同行者追加の処理（省略） \u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"処理の流れを制限する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%87%A6%E7%90%86%E3%81%AE%E6%B5%81%E3%82%8C%E3%82%92%E5%88%B6%E9%99%90%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e処理の流れを制限する\u003c/h1\u003e\n\n\u003cp\u003e処理の流れに順番を指定したい場合、Taskを使うと、 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e var task = Task.Run(() =\u0026gt; 処理A()) \n                .ContinueWith(t =\u0026gt; 処理B(t.Result)) \n                .ContinueWith(t =\u0026gt; 処理C(t.Result)) \n                .ContinueWith(t =\u0026gt; 処理D(t.Result)); \n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eのように順送りの表現ができますが、「進行用インターフェース」という手法を使うことで、より細かい処理順序の指定や、処理回数の制限を規定することができます。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"c1\"\u003e//例：処理は順番に1回だけ行いたい場合 \u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//タイトル追加Interface\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIScheduleAdd\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eIScheduleDay\u003c/span\u003e \u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//日付追加Interface\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIScheduleDay\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eIScheduleFrom\u003c/span\u003e \u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//開始時刻追加Interface\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIScheduleFrom\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eIScheduleDuration\u003c/span\u003e \u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estartTime\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//期間追加Interface\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIScheduleDuration\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eIScheduleAt\u003c/span\u003e \u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003eduration\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//場所追加Interface\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIScheduleAt\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eIScheduleAdd\u003c/span\u003e \u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003earea\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//スケジュールクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSchedule\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleDay\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleFrom\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleDuration\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleAt\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleAdd\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSchedule\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleDay\u003c/span\u003e \u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"err\"\u003eタイトル\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleFrom\u003c/span\u003e \u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleDuration\u003c/span\u003e \u003cspan class=\"err\"\u003e開始時間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estartTime\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleAt\u003c/span\u003e \u003cspan class=\"err\"\u003e期間\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003eduration\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleAdd\u003c/span\u003e \u003cspan class=\"err\"\u003e場所\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003earea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこうすることで、Addタイトルは１回しか選択できず、Addタイトル後には必ず日付しか選択できなくなります。 \u003c/p\u003e\n\n\u003cp\u003e例：Addタイトル後は日付しか選択できない状態\u003cbr\u003e\n \u003ca href=\"https://camo.qiitausercontent.com/e4d7ae8218711a4e638cb1da5567e179468affef/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f363732382f35653135383163382d323939322d616463332d303266332d6234396634653538396239622e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F5e1581c8-2992-adc3-02f3-b49f4e589b9b.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=92a4d700d91ab2d22e24a8a82db02b6f\" alt=\"img1.jpg\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/6728/5e1581c8-2992-adc3-02f3-b49f4e589b9b.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F5e1581c8-2992-adc3-02f3-b49f4e589b9b.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fb6fdd1d7ec5411ba701bf40caba5b0b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eまたの下記のように書き換えた場合は、Addタイトルの後は、日付、開始時刻のどちらかを選択させることができます。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIScheduleDay\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIScheduleFrom\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eIScheduleFrom\u003c/span\u003e \u003cspan class=\"err\"\u003e日付\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e例：Addタイトル後は、日付・開始時刻のどちらかが選択可能\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/2427ae8892de7253defaa94100248ace6d2a5e0a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f363732382f31313364303036642d386632312d326535312d656565632d6264393737656637386335622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F113d006d-8f21-2e51-eeec-bd977ef78c5b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3dd48ace481851898f2eb78b217275a0\" alt=\"img2.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/6728/113d006d-8f21-2e51-eeec-bd977ef78c5b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2F113d006d-8f21-2e51-eeec-bd977ef78c5b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=23e1136def91dd4cf85af81888f1c423 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eコードの書き方によって、処理流れをコントロールすることができます。 \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"流れるようなインターフェースの応用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%AE%E5%BF%9C%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e流れるようなインターフェースの応用\u003c/h1\u003e\n\n\u003cp\u003e流れるようなインターフェースを応用して、メソッド内だけで完結する作業・振る舞いを明示的に記述することも出来ます。 \u003c/p\u003e\n\n\u003cp\u003e下記例では、洋服試着は試着室が空いている場合のみ行えることを示していますが、大筋からは隠蔽させています。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"c1\"\u003e//Shoppingクラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eShopping\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"c1\"\u003e//買い物開始\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eShopping\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e \n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eShopping\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e         \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"c1\"\u003e//商品選択\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eShopping\u003c/span\u003e \u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"c1\"\u003e//商品試着\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eShopping\u003c/span\u003e \u003cspan class=\"err\"\u003e試着\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAction\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eFitting\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eaction\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"err\"\u003e試着室\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eFittingRoom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrepare\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e試着室\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCanUse\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \n                \u003cspan class=\"nf\"\u003eaction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eFitting\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"c1\"\u003e//商品購入\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"err\"\u003e購入\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//試着クラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFitting\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"c1\"\u003e//スタッフの補助あり \u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWithHelp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//スタッフの補助なし \u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSelf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\u003cspan class=\"c1\"\u003e//試着室クラス\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFittingRoom\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIDisposable\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eFittingRoom\u003c/span\u003e \u003cspan class=\"nf\"\u003ePrepare\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eFittingRoom\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n    \u003cspan class=\"c1\"\u003e//試着室が使えるかチェック \u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eCanUse\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n     \u003cspan class=\"c1\"\u003e//試着室解放  \u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\n\n\u003cspan class=\"c1\"\u003e//大筋からは試着室の事は隠ぺいし、モデルの俯瞰図的な使用をおこなっている \u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eshopping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eShopping\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服A\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服B\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e試着\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efittingt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n            \u003cspan class=\"n\"\u003efittingt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWithHelp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服C\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e})\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服C\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e購入\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eコードの書き方によっては、処理の流れを分岐させるなど、より複雑な表現が可能となります。 \u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eshopping\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eShopping\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIfSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n            \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服Ａ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服Ｃ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e購入\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e})\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIfSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n            \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服Ｂ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"洋服Ｃ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"err\"\u003e購入\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \n        \u003cspan class=\"p\"\u003e})\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"流れるようなインターフェースの問題点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e流れるようなインターフェースの問題点\u003c/h1\u003e\n\n\u003cp\u003e「流れるようなインターフェース」は処理の流れをそのまま表現でき、表現力は強力ですが、時にはその表現力が悪い方に働く事があります。 \u003cbr\u003e\nモデルが複雑になってくると、インタフェースも同様に複雑になっていき、どんどん流れるようなインターフェースとは呼べない状態になってしまいます。つまり、複雑なトランザクションスクリプトと同じ状態になり、\u003cstrong\u003eドメインモデル貧血症\u003c/strong\u003eに陥ってしまうのです。  \u003c/p\u003e\n\n\u003cp\u003e書籍：実践プログラミングDSLには、従うべき指針として下記３つを挙げられています。 \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e複雑さ最小の原則の遵守\u003c/strong\u003e \u003cbr\u003e\nホスト言語で使えるイディオムのうち、解決モデルに適合するものの中で最も単純なものを選択して下さい。 \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e最適な表現力の尊重\u003c/strong\u003e \u003cbr\u003e\nDSLの表現力を考え得る最高のレベルにまで高めようとすると、実装の複雑さは保証不可能なレベルに至ってしまいます。言語の表現力は、ユーザが必要とするレベルに留めておいてください。 \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e入念に設計された抽象の原則を弱めない\u003c/strong\u003e \u003cbr\u003e\n読みやすさを狙って言語にバブルワードを追加するとカプセル化のレベルが下がりますし、実装の内部が露出してしまいやくなります。（省略）言語の設計とは常にトレードオフと妥協のせめぎあいだということを忘れてはなりません。抽象の設計にあたっては、何を決断し、何を妥協すべきかを、常に批判的に評価してください。設計の原則がDSLユーザの利用用途と合っているか、常に意識する必要があります。 \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コードにおける表現方法について色々\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E8%A1%A8%E7%8F%BE%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E8%89%B2%E3%80%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコードにおける表現方法について色々\u003c/h1\u003e\n\n\u003cp\u003eモデルの表現方法として、ドメイン特化型言語（DSL）を参考にさせていただきましたが、表現に関する議論は古くからあり、1976年にはデイビッド・パーナスがプログラムファミリの概念を示しており、1986年にはジョン ベントリーが、プログラミングとは特定問題を解決する「リトル言語」だと述べられています。 \u003c/p\u003e\n\n\u003cp\u003eまた、文脈を損なわずにプログラム言語に落としこむ手法で有名なところをでは、 \u003cbr\u003e\n ドナルド・クヌースが提唱している「\u003ca href=\"https://ja.wikipedia.org/wiki/%E6%96%87%E8%8A%B8%E7%9A%84%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0\" rel=\"nofollow noopener\" target=\"_blank\"\u003e文芸的プログラミング\u003c/a\u003e」\u003cbr\u003e\nウォード・カニンガムの\u003ca href=\"http://c2.com/w4/wikibase/wiki.cgi?WikiInHyperPerl\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWikiBase\u003c/a\u003eなどがあります。 \u003cbr\u003e\n興味があるかたはこちらも御覧ください。\u003c/p\u003e\n","createdAt":"2017-02-09T21:10:07Z","elapsedYearsFromLastModifiedAt":4,"encryptedId":"W+UH/LvQFoPPY4R7mCYx3nVeyAOOagqg--1wqDrwihzTAOKg1f--cSEssxhwxLo6IX5Uea/kVA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2017-07-25T00:54:07Z","likesCount":39,"linkUrl":"https://qiita.com/kawakawa/items/995d31ce8db97ce5cf04","organization":null,"originalId":467395,"stockedCount":38,"title":"C#におけるドメイン層での表現方法を考えてみる","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%8F%90\"\u003e前提\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%A4%E3%82%8A%E6%98%93%E3%81%84%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E3%81%AF\"\u003e判り易いコードとは？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%99%82%E9%96%93%E7%B5%8C%E9%81%8E%E3%81%AB%E3%82%88%E3%82%8B%E5%A4%89%E6%9B%B4%E3%81%AB%E5%BC%B7%E3%81%8F%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF\"\u003e時間経過による変更に強くするには？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%82%82%E3%82%8D%E3%82%82%E3%82%8D\"\u003eその他もろもろ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003eコードの臭い\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#new-%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003enew から漂うコードの臭い\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#null%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003enullから漂うコードの臭い\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#try-catch-%E3%81%8B%E3%82%89%E6%BC%82%E3%81%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%87%AD%E3%81%84\"\u003etry catch から漂うコードの臭い\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0\"\u003e日本語プログラム\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%90%8D%E5%89%8D%E4%BB%98%E3%81%8D%E5%BC%95%E6%95%B0%E3%81%A7%E5%8F%AF%E8%AA%AD%E6%80%A7%E5%90%91%E4%B8%8A\"\u003e名前付き引数で可読性向上\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#get%E3%81%A8set%E3%82%92%E5%88%86%E3%81%91%E3%82%8B\"\u003eGetとSetを分ける\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%81%A9%E5%88%87%E3%81%AA%E3%83%A2%E3%83%87%E3%83%AB%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%AB%E3%81%9D%E3%82%8D%E3%81%88%E3%82%8B\"\u003e適切なモデルサイズにそろえる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%90%E3%83%96%E3%83%AB%E3%83%AF%E3%83%BC%E3%83%89bubble-word\"\u003eバブルワード（bubble word）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9-fluent-interface\"\u003e流れるようなインターフェース （Fluent Interface）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%87%A6%E7%90%86%E3%81%AE%E6%B5%81%E3%82%8C%E3%82%92%E5%88%B6%E9%99%90%E3%81%99%E3%82%8B\"\u003e処理の流れを制限する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%AE%E5%BF%9C%E7%94%A8\"\u003e流れるようなインターフェースの応用\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B5%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9\"\u003e流れるようなインターフェースの問題点\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E8%A1%A8%E7%8F%BE%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E8%89%B2%E3%80%85\"\u003eコードにおける表現方法について色々\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":6526,"uuid":"995d31ce8db97ce5cf04","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"djMr2JSLxGvb0WSXEcRM2vFxvA==--8NFSJ1r3rUoHSEET--TtNekXit/aKONHM6VrIIrQ==","originalId":6728,"description":"Twitter: @kawakawa","facebookUrl":null,"githubUrl":"https://github.com/kawakawa","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/6728/profile-images/1481095403","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2Fprofile-images%2F1481095403?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=1566d072be34f164fe62b11014176ad4","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6728%2Fprofile-images%2F1481095403?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13e9791470ce6a7d6713b0a2843ad4d4","urlName":"kawakawa","websiteUrl":"","twitterUrl":"https://twitter.com/kawakawa","twitterUrlName":"kawakawa","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"DDD","urlName":"ddd"},{"name":"ドメイン駆動設計","urlName":"%e3%83%89%e3%83%a1%e3%82%a4%e3%83%b3%e9%a7%86%e5%8b%95%e8%a8%ad%e8%a8%88"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
