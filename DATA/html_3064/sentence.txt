More than 1 year has passed since last update.表題の通り
Visual Studio 2019のC#にて、
Visual Studio 2019のC#にて、直接バイナリを叩いて指定ファイルをzipに無圧縮アーカブする。
コードのサンプルでございます。特段、NuGetなどで他のプラグインや
別途外部dllを必要としないようにしています。要は、バイナリを以下のように、直接叩いています。
1.zipのヘッダーを書き込む。
2.ファイルのバイナリを読み込み。
3.そのままファイルバイナリを横流して書き込み。
4.zipの中間の事項と、フッターを書き込む。Javaが無い環境下などで、
とにかく無圧縮でもいいからzipを作成したい場合があり、それに依存しないで、zipをファイルに書き出すことにしたため
作成いたしました。このQiitaに投稿している、
Visual Studio 2019のC#にて、中のxmlを直接叩いてODSを出力する。コードのサンプルです。
でも、
ODSは、実質中身は、zipファイルなので
今回の内容と重複する部分がございます。[zip内部に関しての参考サイト]
・ APPNOTE.TXT - .ZIP File Format Specification
・ZIP書庫ファイル フォーマット - 略して仮。
・The structure of a PKZip file
・自力でzipしてみた - ニコニコ動画
　※└→私が勝手にまとめた動画です。[コードに関しての参考サイト]
・[VBA]CRC-32の計算 言語: VB.NET
・C#实现crc32函数 - 时间是把杀刀猪 - CSDN博客
・A CRC32 implementation in C# - Sanity Free Coding - C#, .NET, PHP例えば、
以下のようなコードで、ファイルを選択して
変換することが出来ます。以上のコードを実行すると
指定したファイルと同じ階層のフォルダに、zipが出力されてあると思います。尚、アーカイブする際の更新日時をうまくして
アーカイブすれば、
アーカイブしたファイルのタイムスタンプが、任意に変えられます。


