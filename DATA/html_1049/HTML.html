<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Windows10でUnityとML-Agentsを使った強化学習 ～自分で新しく環境を作成して学習することろまで～ - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/2019Shun/items/d811bbd470fc9cddcc3d" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="5bwdItgGvgaP97KveJLNGZi4w4gubfSt1+vjyrXyx/0ZPICSGLoBNBmU8pzYv9+PyAOoa4C1re46DMxMDlWiVg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@2020Shun_tech" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="Windows10でUnityとML-Agentsを使った強化学習 ～自分で新しく環境を作成して学習することろまで～ - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WMmx1Wkc5M2N6RXc0NEduVlc1cGRIbmpnYWhOVEMxQloyVnVkSFBqZ3BMa3ZiX2pnYVBqZ1pfbHZMZmxqSmJscmFibnY1SWc3NzJlNkllcTVZaUc0NEduNXBhdzQ0R1g0NEdQNTVLdzVhS0Q0NEtTNUwyYzVvaVE0NEdYNDRHbTVhMm01Ny1TNDRHWjQ0S0w0NEdUNDRHbzQ0S040NEctNDRHbjc3MmUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ZDVkZWJjMzdiOTc1OGUzNzVkOGNkNzM2ODdjYjA2NmU&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RREl3TVRsVGFIVnUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1jMTc3MzFlNjEyOTM0ZjA2MGZmOWNkMDhhOTYzMGUxZA&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=7eaeb1c736ba60b75dd356b45d5b87d9"><meta property="og:description" content="


はじめに

Windows10でUnityとML-Agentsというパッケージを使用して，強化学習を行うやり方を説明します．
基本的にこちらのドキュメントにそって説明を行いたいと思います．

この記事では次のようにボールにAge..."><meta content="https://qiita.com/2019Shun/items/d811bbd470fc9cddcc3d" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,機械学習,強化学習,ML-Agents" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-edaa5271-aff5-4133-a675-71fc8b615039"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2F2019Shun%2Fitems%2Fd811bbd470fc9cddcc3d">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2F2019Shun%2Fitems%2Fd811bbd470fc9cddcc3d">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-edaa5271-aff5-4133-a675-71fc8b615039">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-07-16T10:55:07.000+09:00","dateModified":"2020-09-05T20:48:08.000+09:00","headline":"Windows10でUnityとML-Agentsを使った強化学習 ～自分で新しく環境を作成して学習することろまで～","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WMmx1Wkc5M2N6RXc0NEduVlc1cGRIbmpnYWhOVEMxQloyVnVkSFBqZ3BMa3ZiX2pnYVBqZ1pfbHZMZmxqSmJscmFibnY1SWc3NzJlNkllcTVZaUc0NEduNXBhdzQ0R1g0NEdQNTVLdzVhS0Q0NEtTNUwyYzVvaVE0NEdYNDRHbTVhMm01Ny1TNDRHWjQ0S0w0NEdUNDRHbzQ0S040NEctNDRHbjc3MmUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ZDVkZWJjMzdiOTc1OGUzNzVkOGNkNzM2ODdjYjA2NmU\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RREl3TVRsVGFIVnUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1jMTc3MzFlNjEyOTM0ZjA2MGZmOWNkMDhhOTYzMGUxZA\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=7eaeb1c736ba60b75dd356b45d5b87d9","mainEntityOfPage":"https://qiita.com/2019Shun/items/d811bbd470fc9cddcc3d","author":{"@type":"Person","address":"","email":null,"identifier":"2019Shun","name":"2019Shun","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F427721%2Fprofile-images%2F1603224576?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=408da7ec756c18d6d0caef3659fe54dc","url":"https://qiita.com/2019Shun","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita&amp;utm_medium=header-banner">急成長する「NewsPicks」ブランドの開発思想を探る</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"2019Shun","type":"items","id":"d811bbd470fc9cddcc3d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"急成長する「NewsPicks」ブランドの開発思想を探る","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"2019Shun","type":"items","id":"d811bbd470fc9cddcc3d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"急成長する「NewsPicks」ブランドの開発思想を探る","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"2019Shun","type":"items","id":"d811bbd470fc9cddcc3d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"急成長する「NewsPicks」ブランドの開発思想を探る","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/2019Shun/items/d811bbd470fc9cddcc3d","location":"/2019Shun/items/d811bbd470fc9cddcc3d","scheme":"https","host":"qiita.com","port":null,"pathname":"/2019Shun/items/d811bbd470fc9cddcc3d","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"O/CF8j8EwrGYcYIuWCxrX+N668UE9dACSmlL30bqUYfHcBhC/7h9gw4Swh34AXnJs8GAJqotiUGnjmRZ/U00LA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-3ffada26-0019-438d-8c26-3aed19bcaabb"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/2019Shun/items/d811bbd470fc9cddcc3d/likers" class="css-1iupg5d">57</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">53</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/d811bbd470fc9cddcc3d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/2019Shun/items/d811bbd470fc9cddcc3d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/2019Shun/items/d811bbd470fc9cddcc3d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/2019Shun/items/d811bbd470fc9cddcc3d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/2019Shun/items/d811bbd470fc9cddcc3d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/2019Shun"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/427721/profile-images/1603224576" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/2019Shun" class="css-10ougpm">@<!-- -->2019Shun</a><div class="css-1ay9vb9"><span><meta content="2020-07-16T01:55:07Z"/><time dateTime="2020-09-05T11:48:08Z" class="css-m19uds">updated at 2020-09-05</time></span></div></div></div></div></div><h1 class="css-cgzq40">Windows10でUnityとML-Agentsを使った強化学習 ～自分で新しく環境を作成して学習することろまで～</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/%e6%a9%9f%e6%a2%b0%e5%ad%a6%e7%bf%92" class="css-4czcte">機械学習</a><a href="/tags/%e5%bc%b7%e5%8c%96%e5%ad%a6%e7%bf%92" class="css-4czcte">強化学習</a><a href="/tags/ml-agents" class="css-4czcte">ML-Agents</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><hr>

<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>Windows10でUnityとML-Agentsというパッケージを使用して，強化学習を行うやり方を説明します．<br>
基本的に<a href="https://github.com/Unity-Technologies/ml-agents/blob/release_3_docs/docs/Readme.md" rel="nofollow noopener" target="_blank">こちらのドキュメント</a>にそって説明を行いたいと思います．</p>

<p>この記事では次のようにボールにAgentを搭載し，四角いボックスを追いかけさせるプログラムを0から作成していきます．</p>

<p><a href="https://camo.qiitausercontent.com/0dd877cff58f7a95c09ce2270d6b48e15a9cde1e/68747470733a2f2f692e696d6775722e636f6d2f6b37794e6941762e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fk7yNiAv.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=cc1f895c97fea889ee53e629ad578edb" alt="" data-canonical-src="https://i.imgur.com/k7yNiAv.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fk7yNiAv.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e1778032322106d820bd989aa8fb5fc5 1x" loading="lazy"></a></p>

<h2>
<span id="目次" class="fragment"></span><a href="#%E7%9B%AE%E6%AC%A1"><i class="fa fa-link"></i></a>目次</h2>

<ul>
<li><a href="#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83">実行環境</a></li>
<li>
<a href="#%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89">環境構築</a>

<ul>
<li><a href="#unity%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">Unityのインストール</a></li>
<li><a href="#pythonanaconda3%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">Python(Anaconda3)のインストール</a></li>
<li><a href="#ml-agents-release-3-%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97">ML-Agents Release 3 のセットアップ</a></li>
</ul>
</li>
<li><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E4%BD%9C%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF">サンプルプログラムの動作チェック</a></li>
<li><a href="#%E6%96%B0%E3%81%97%E3%81%84%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92">新しい学習環境の作成と強化学習</a></li>
<li><a href="#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB">さいごに</a></li>
</ul>

<hr>

<hr>

<h1>
<span id="実行環境" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>実行環境</h1>

<table>
<thead>
<tr>
<th></th>
<th>バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows10</td>
<td>1909</td>
</tr>
<tr>
<td>Unity</td>
<td>2019.4.3f1</td>
</tr>
<tr>
<td>Python(Anaconda3)</td>
<td>3.7.6</td>
</tr>
<tr>
<td>ML-Agents</td>
<td>Release 3</td>
</tr>
</tbody>
</table>

<p><strong>ML-Agents</strong>は現在(2020/07/14)で最新である<code>Release 3</code>を使用します．<br>
<code>Release 3</code>ではUnityに関しては<code>2018.04</code>以降，Pythonに関しては<code>3.6.1</code>以上が対応しています．<br>
Pythonの環境にAnacondaを使用する場合は関係ないですが，ML-Agentsのインストールの際に<code>pip3</code>が必要になります．</p>

<hr>

<hr>

<h1>
<span id="環境構築" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89"><i class="fa fa-link"></i></a>環境構築</h1>

<h2>
<span id="unityのインストール" class="fragment"></span><a href="#unity%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Unityのインストール</h2>

<p>次のサイトにアクセスし，<strong>Unity Hub</strong>をダウンロートします．<br>
<strong>Unity Hub</strong>はUnityのバージョン管理をしてくれるソフトウェアです．</p>

<p><qiita-embed-ogp src="https://unity3d.com/get-unity/download"></qiita-embed-ogp></p>

<p><a href="https://camo.qiitausercontent.com/1c5f1b94ecdc95e3b3a125e7e7862e2094e9305b/68747470733a2f2f692e696d6775722e636f6d2f57485478566e622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FWHTxVnb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=356b80c2b707764c9f7c03c1f4306a74" alt="" data-canonical-src="https://i.imgur.com/WHTxVnb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FWHTxVnb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=24cf5e331cfffe350b985532b5c97313 1x" loading="lazy"></a></p>

<p><strong>Unity Hub</strong>のインストールが完了したら，次にアカウントの登録を行います．<br>
Unityのサイトでアカウントを作成し，サインインしてください．</p>

<p><a href="https://camo.qiitausercontent.com/b7e4603893cfdf116de7edbccf9dee0a2ae5a8cf/68747470733a2f2f692e696d6775722e636f6d2f4d4262543773742e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMBbT7st.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b6ed0b7f9e9a0e3283fdd1029d98da88" alt="" data-canonical-src="https://i.imgur.com/MBbT7st.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMBbT7st.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f4ff7b9765243c2c52a02d49664aed72 1x" loading="lazy"></a></p>

<p>次にライセンスの登録を行います．<br>
今回は<strong>Unity Personal</strong>を使用するので次のように選びます．</p>

<p><a href="https://camo.qiitausercontent.com/cc29890fd85fea3659ebefd5a6844de3d9377a50/68747470733a2f2f692e696d6775722e636f6d2f787055734465472e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FxpUsDeG.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c7874ec249d2c87c090d531dc876e263" alt="" data-canonical-src="https://i.imgur.com/xpUsDeG.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FxpUsDeG.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0b0c701e8b8519e7bce244430238505c 1x" loading="lazy"></a></p>

<p>続いてUnity本体のインストールを行います．次の画面から適当なバージョンを選択してインストールしてください．もし<strong>Visual Studio</strong>がない場合，ここで自動的にインストールしてくれます．<br>
インストールに結構時間がかかります．</p>

<p><a href="https://camo.qiitausercontent.com/d993f8b20380abc24119e92fe4d80b655375d444/68747470733a2f2f692e696d6775722e636f6d2f55616e4e4745542e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUanNGET.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=29fdd7afdf5f85163cd10842881dd55b" alt="" data-canonical-src="https://i.imgur.com/UanNGET.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUanNGET.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fce2302ff2a4f28a6e19c3008b8b57a6 1x" loading="lazy"></a></p>

<h2>
<span id="pythonanaconda3のインストール" class="fragment"></span><a href="#pythonanaconda3%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Python(Anaconda3)のインストール</h2>

<p>次のサイトにアクセスし，下の方のPython3.7 64-Bit Graphical Installerをダウンロードします．</p>

<p><a href="https://www.anaconda.com/products/individual#windows" class="autolink" rel="nofollow noopener" target="_blank">https://www.anaconda.com/products/individual#windows</a><br>
<a href="https://camo.qiitausercontent.com/2f3f16c205c4bf8244ff58a3dc7ed60ed0068dc6/68747470733a2f2f692e696d6775722e636f6d2f5638696e5a56302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FV8inZV0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5ca162692ab0bc89e44b035838184e83" alt="" data-canonical-src="https://i.imgur.com/V8inZV0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FV8inZV0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=156a2dca9aa1a44d8b46d4d2e1922d9c 1x" loading="lazy"></a></p>

<p>インストーラーがダウンロードできたら，後は流れでインストールしていきます．</p>

<p>途中にAnaconda3のパスを環境変数に登録するかしないかの確認が入りますが，特になにも無ければ環境変数に登録しても大丈夫だと思います(もうすでにPythonの環境を構築していたり複数のバージョンを管理しているなどがなければ...)が推奨されていないみたいです．</p>

<p>ここのチェックを付けない場合，自分で環境変数を通す必要があります(Anaconda Promptを使う場合は必要ないかも)．<br>
今回は<strong>PowerShell</strong>を使って実行していきます．</p>

<p><a href="https://camo.qiitausercontent.com/5473b442feb02ce760d1f5f8be25fec23f200298/68747470733a2f2f692e696d6775722e636f6d2f625573487430592e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FbUsHt0Y.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f985484a22252d2b34e9ac2d8f1deaed" alt="" data-canonical-src="https://i.imgur.com/bUsHt0Y.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FbUsHt0Y.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c6ca9e16ef32dbb0c7dbca0e4583a8fd 1x" loading="lazy"></a></p>

<h3>
<span id="powershellでanacondaを使用できるようにする" class="fragment"></span><a href="#powershell%E3%81%A7anaconda%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>PowerShellでAnacondaを使用できるようにする</h3>

<p>環境変数にパスが通っているとPowerShellでPythonが実行できるようになります．<br>
しかし，Anacondaで仮想環境を作ってそこでいろいろしたいときに<code>conda activate</code>で仮想環境に入ったりするんですが，デフォルトのPowerShellだと上手く実行できません．</p>

<p>自分はPowerShellが好きなので，なんとしてでもPowerShellで実行したいです．<br>
いろいろ探していたら次の記事でやり方が報告されていたので参考にしました．</p>

<p><a href="https://qiita.com/8128/items/877caf785b20758ba7e0" id="reference-af7ac43f176f10a01470">conda activateでエラーが出る話</a></p>

<p>PowerShellで次のコマンドを実行します．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>conda init powershell
</code></pre></div></div>

<p>ここでPowerShellを再起動したりするとエラーがでるようになると思います．<br>
次に管理者権限でPowerShellを開き，次のコマンドを実行します．<br>
実行しますか～と聞かれるのでYESを選択．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>Set-ExecutionPolicy RemoteSigned
</code></pre></div></div>

<p>PowerShellを再起動して，次のように<code>(base)</code>と表示されたら成功です．</p>

<p><a href="https://camo.qiitausercontent.com/0574883919c0b768a716fd19550836d0d1b6bf98/68747470733a2f2f692e696d6775722e636f6d2f6763744f7a73652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FgctOzse.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9145f879c97dfdfb5ac9bc333c98e0d5" alt="" data-canonical-src="https://i.imgur.com/gctOzse.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FgctOzse.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d6ac73ce082cd7a60badbae4341668ef 1x" loading="lazy"></a></p>

<h3>
<span id="anacondaに強化学習用の仮想環境を作成する" class="fragment"></span><a href="#anaconda%E3%81%AB%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E7%94%A8%E3%81%AE%E4%BB%AE%E6%83%B3%E7%92%B0%E5%A2%83%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Anacondaに強化学習用の仮想環境を作成する</h3>

<p>Anacondaが使えるようになったら，強化学習用の仮想環境を作成します．<br>
仮想環境を作成することで，環境の切り替えや，壊れた際に簡単にやり直すことができます．</p>

<p>次のコマンドで仮想環境を作成します．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>conda create <span class="nt">-n</span> ml-agents <span class="nv">python</span><span class="o">=</span>3.6
</code></pre></div></div>

<p>仮想環境を切り替える際は<code>conda activate &lt;名前&gt;</code>を実行します．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>conda activate ml-agents
</code></pre></div></div>

<p>次のように<code>(ml-agents)</code>を表示されれば成功です．</p>

<p><a href="https://camo.qiitausercontent.com/d29ebd1ebab5f028a2573fe7cdab2e4f38650004/68747470733a2f2f692e696d6775722e636f6d2f766e4c657365592e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FvnLeseY.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9737b5d9ab72e0c0ecaa292b5b304eb6" alt="" data-canonical-src="https://i.imgur.com/vnLeseY.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FvnLeseY.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0cdea75e728bef0d184f7d1917ec3969 1x" loading="lazy"></a></p>

<h2>
<span id="ml-agents-release-3-のセットアップ" class="fragment"></span><a href="#ml-agents-release-3-%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>ML-Agents Release 3 のセットアップ</h2>

<p>次のML-AgentsのReleaseのページから，ソースコードをダウンロードします．</p>

<p><qiita-embed-ogp src="https://github.com/Unity-Technologies/ml-agents/releases/tag/release_3"></qiita-embed-ogp></p>

<p><a href="https://camo.qiitausercontent.com/98c85b68b2d2099f121bdf4ba1f98b7de629e13a/68747470733a2f2f692e696d6775722e636f6d2f55676c4d6e47762e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUglMnGv.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a6d55f96916e906a912f24a4e211bf05" alt="" data-canonical-src="https://i.imgur.com/UglMnGv.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUglMnGv.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6bd6438f926e51ae4f793a9137092ddc 1x" loading="lazy"></a></p>

<p>下の方に行くとボタンがあるので<code>Source code(zip)</code>を選択して，ダウンロードします．<br>
そして，適当なフォルダに解凍してください．</p>

<p><a href="https://camo.qiitausercontent.com/5e532ad6376d07d20ce288c435e02cc56dac65c0/68747470733a2f2f692e696d6775722e636f6d2f42397a6e5453392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FB9znTS9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=07ea2864b31a7e475d45e250f84beabb" alt="" data-canonical-src="https://i.imgur.com/B9znTS9.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FB9znTS9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4a2b0e5de5e69542ab433a2f94249b17 1x" loading="lazy"></a></p>

<p>コマンドラインからGitを実行できる人は以下のコマンドでRelease3をダウンロードすることができます．</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>git clone --branch release_3 https://github.com/Unity-Technologies/ml-agents.git
</code></pre></div></div>

<p>ここからは先程作成した仮想環境<code>(ml-agents)</code>に入った状態おこないます．</p>

<p>次のコマンドでPythonのmlagentsパッケージをインストールします．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>pip3 <span class="nb">install </span>mlagents
</code></pre></div></div>

<p>次に先程GitHubからダウンロードして解凍したフォルダに移動して，PowerShellを開きます．<br>
そして次のコマンドを実行します．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>pip3 <span class="nb">install</span> <span class="nt">-e</span> ./ml-agents-envs
pip3 <span class="nb">install</span> <span class="nt">-e</span> ./ml-agents
</code></pre></div></div>

<hr>

<hr>

<h1>
<span id="サンプルプログラムの動作チェック" class="fragment"></span><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E4%BD%9C%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF"><i class="fa fa-link"></i></a>サンプルプログラムの動作チェック</h1>

<p>ここではML-Agentsのサンプルの1つである<code>3DBall</code>の強化学習を行っていきます．<br>
次のようにボックスが上にボールを乗せている状況を考えます．強化学習を行いボールを落とさないようにボックスにバランスをとらせることが目標です．</p>

<p><a href="https://camo.qiitausercontent.com/53a4710369615b2d1c4d0faf3b9fd755ee3d5a85/68747470733a2f2f692e696d6775722e636f6d2f6c6930477544392e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fli0GuD9.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=45f8fd1d41a2cb0f516a13f8e08a05e8" alt="" data-canonical-src="https://i.imgur.com/li0GuD9.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fli0GuD9.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=47f141edb8c8046f131705483bcef3e3 1x" loading="lazy"></a></p>

<p>それではやっていきましょう．<br>
Unity Hubを開いて，<strong>プロジェクト→リスト</strong>に追加をクリックします．フォルダを開くダイアログがでるので先程ダウンロードした<strong>ml-agents-release_3\Project</strong>を指定します．</p>

<p><a href="https://camo.qiitausercontent.com/090b9a4726fc2458bcebf193ee226b3e935e0cb1/68747470733a2f2f692e696d6775722e636f6d2f366d4a6c50796d2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F6mJlPym.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3bc1a73e8484801dce25ac8c62ba2e6a" alt="" data-canonical-src="https://i.imgur.com/6mJlPym.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F6mJlPym.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=24b01ed073ba916db39db7614e1dfd83 1x" loading="lazy"></a></p>

<p>次にUnityのバージョンを更新します．<strong>Unityバージョン</strong>の欄をクリックして先程インストールしたバージョンを選択します．</p>

<p><a href="https://camo.qiitausercontent.com/38091524e6bf2046aacb9a13599df5956cb084b9/68747470733a2f2f692e696d6775722e636f6d2f39773150664d772e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F9w1PfMw.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=07f6609564785b57c80cc7d1368dc4e5" alt="" data-canonical-src="https://i.imgur.com/9w1PfMw.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F9w1PfMw.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7f55f0dd555ef6059dea003d30fef66e 1x" loading="lazy"></a></p>

<p>その状態で<strong>Project</strong>をクリックするとUnityが開かれるのですが，初回は次のようにプロジェクトをアップグレードしますか？というダイアログがでるので確認をクリックして進みます．</p>

<p><a href="https://camo.qiitausercontent.com/181a75e0d0d21edc9d20ac2f853df394e0653ecf/68747470733a2f2f692e696d6775722e636f6d2f4f4b41703347562e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FOKAp3GV.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2d8bb9d25005a65c3069949e131a188c" alt="" data-canonical-src="https://i.imgur.com/OKAp3GV.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FOKAp3GV.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0d8874bcba02c2c7a2d24f7a8a84ee20 1x" loading="lazy"></a></p>

<p>プロジェクトが開かれたら，次のように<strong>Projectビュー</strong>から<strong>ML-Agents→Examples→3DBall→Scenes</strong>をダブルクリックで開き，<strong>3DBall</strong>というシーンをダブルクリックしてください．</p>

<p><a href="https://camo.qiitausercontent.com/a8d6e33fa3e6ca11c5ea831f2b2f02bd4826be67/68747470733a2f2f692e696d6775722e636f6d2f6c53354735736b2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FlS5G5sk.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=dad313f6f8f32d644fa98286ef14537f" alt="" data-canonical-src="https://i.imgur.com/lS5G5sk.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FlS5G5sk.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=43088af4ddc58264b5753f350ae95f84 1x" loading="lazy"></a></p>

<p>すると，青いボックスが12個並んだシーンが表示されます．こちらのシーンには最初からトレーニング済みの学習モデルがセットされているため，この状態で上の再生(Play)ボタンを押すと，しっかりとバランスを取る動作を行います．</p>

<p>今回は学習を行うので，トレーニング済みの学習モデルを一度プレハブから取り除きます．</p>

<p>取り除く際は下の手順のようにプレハブを操作することで，シーン全体のボックスの内容を変更することができます．</p>

<ol>
<li>Projectビューから<strong>ML-Agents→Examples→3DBall→Prefabs</strong>をダブルクリックで開く</li>
<li>
<strong>3DBallのプレハブを</strong>をダブルクリック．するとHierarchyビューに表示されます．</li>
<li>
<strong>Hierarchyビュー</strong>から<strong>Agent</strong>を選択</li>
<li>
<strong>Inspectorビュー</strong>から<strong>Behabior Parameteresのモデルを選択</strong>
</li>
<li>モデルとして<strong>None</strong>を選択．</li>
</ol>

<p><a href="https://camo.qiitausercontent.com/482b3e98bd82ef6e7b24dd0562d0bcccfe94a27e/68747470733a2f2f692e696d6775722e636f6d2f514f6b6a6161682e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQOkjaah.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=25cf91759827ccb3be8dd78af63ad805" alt="" data-canonical-src="https://i.imgur.com/QOkjaah.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQOkjaah.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d4ec417e6d3b4f2523fa873cb64b71bb 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/7d7eb900b183ce14e3953d58b390731f6b2126fa/68747470733a2f2f692e696d6775722e636f6d2f73484849736e6d2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FsHHIsnm.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=be1742817fd132b5a1653eb199cbe647" alt="" data-canonical-src="https://i.imgur.com/sHHIsnm.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FsHHIsnm.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8d8947ba99351205a5cd77b3d46ccb10 1x" loading="lazy"></a></p>

<p>これで学習済みモデルを引き剥がすことができました．<br>
この状態で，再生(Play)ボタンを押すと，青いボックスを矢印キーで動かすことができるようになります．<br>
試しにやってみます(すべてのボックスが同期して動くので次のGIFでは左上のボックスに注目しています)が結構難しいです．</p>

<p><a href="https://camo.qiitausercontent.com/ab9fa023b10c2e388885cacac66c46a8043898f8/68747470733a2f2f692e696d6775722e636f6d2f7477674f4e62572e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FtwgONbW.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=674f5acc205da3a665574371bcf334e6" alt="" data-canonical-src="https://i.imgur.com/twgONbW.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FtwgONbW.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=02db81d0a62be93ee525c127119bb9d2 1x" loading="lazy"></a></p>

<p>それでは学習を行っていきましょう．<br>
<code>PowerShell</code>でGitHubからダウンロートしてきた<strong>ml-agents-release_3</strong>フォルダを開きます．<br>
そこで次のコマンドを実行します．<br>
<code>run-id</code>は識別子のようなもので重複は許されません．この名前のフォルダに学習モデルが保存されます．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>mlagents-learn config/ppo/3DBall.yaml <span class="nt">--run-id</span><span class="o">=</span>first3DBallRun
</code></pre></div></div>

<p><a href="https://camo.qiitausercontent.com/220e024ff7654f41148042e63690a0d74af3be6b/68747470733a2f2f692e696d6775722e636f6d2f665447466b50672e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FfTGFkPg.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6f306dc08860b7177400123e4482ac71" alt="" data-canonical-src="https://i.imgur.com/fTGFkPg.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FfTGFkPg.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a1ca6104e474a6c599d2556a71367032 1x" loading="lazy"></a></p>

<p>実行して次の画面のようにUnityのロゴが出て，<code>Start training by pressing the Play button in the Unity Editor.</code>という表記がでたら，Unityの画面に戻り，再生(Play)ボタンを押してください．</p>

<p><a href="https://camo.qiitausercontent.com/2f71905954d4f84a9dd3606c32768b23d06f71f8/68747470733a2f2f692e696d6775722e636f6d2f41756f4563434e2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FAuoEcCN.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b348a1b13f62ef94fb0b8be5ccd79d9c" alt="" data-canonical-src="https://i.imgur.com/AuoEcCN.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FAuoEcCN.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d38aff5fb9ded934d9a95e1f39a0c7eb 1x" loading="lazy"></a></p>

<p>すると次のように自動で高速にボックスが動き，学習が始まります．<br>
しばし待ちましょう(10分もしないくらい？)．<br>
もし，途中で終了する場合はUnity側の再生ボタンを再度クリックすることで終了できます(PowerShell側からやると学習結果が消えます)．</p>

<p><a href="https://camo.qiitausercontent.com/fdc0f5c7fafb42fec42a2fe193b24cadf5c29fef/68747470733a2f2f692e696d6775722e636f6d2f6f444f6b4c665a2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FoDOkLfZ.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2d4efe95bf446c16a73b78f8823649f4" alt="" data-canonical-src="https://i.imgur.com/oDOkLfZ.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FoDOkLfZ.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=673cd5ee503663fa359d13b9faa154d8 1x" loading="lazy"></a></p>

<p>正常に終了したら，学習は成功です．<br>
学習結果は<strong>ml-agents-release_3\results\first3DBallRun\3DBall.nn</strong>に保存されます．</p>

<p><a href="https://camo.qiitausercontent.com/018601dc8ad93c9bbdee858c581816938695a166/68747470733a2f2f692e696d6775722e636f6d2f323844345653452e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F28D4VSE.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ba4baaf67684bdfbb00f6a721273c675" alt="" data-canonical-src="https://i.imgur.com/28D4VSE.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F28D4VSE.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=80f8145e10c95e143829343fc979f2ed 1x" loading="lazy"></a></p>

<p>その学習結果を次の画面参考に，Projectビューから<strong>ML-Agents→Examples→3DBall→TFModels</strong>を開き，そこにドラッグ＆ドロップします．</p>

<p><a href="https://camo.qiitausercontent.com/0762cf463abe7adcd4203a7584e650b98dbb6f5a/68747470733a2f2f692e696d6775722e636f6d2f6164714a4a4f752e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FadqJJOu.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=fe62d7cd43d8c622e03095bd7b3ca9e8" alt="" data-canonical-src="https://i.imgur.com/adqJJOu.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FadqJJOu.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ef8e5bfe2f039f484db0531d75b25ec9 1x" loading="lazy"></a></p>

<p>すると次のように<strong>3DBall 1</strong>という名前で保存されます．</p>

<p><a href="https://camo.qiitausercontent.com/e4e4b2624baa7155d748eed8da82940bbb85f549/68747470733a2f2f692e696d6775722e636f6d2f4575496f6b4c612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FEuIokLa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c495fb42a2b76a4d20f0a9c2922525ab" alt="" data-canonical-src="https://i.imgur.com/EuIokLa.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FEuIokLa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=36a21cdf36a6dcf975b84b72e6ae30f0 1x" loading="lazy"></a></p>

<p>後は先程学習モデルを引き剥がしたときと同様にこの学習モデルを割り当てます．</p>

<ol>
<li>Projectビューから<strong>ML-Agents→Examples→3DBall→Prefabs</strong>をダブルクリックで開く</li>
<li>
<strong>3DBallのプレハブを</strong>をダブルクリック．するとHierarchyビューに表示されます．</li>
<li>
<strong>Hierarchyビュー</strong>から<strong>Agent</strong>を選択</li>
<li>
<strong>Inspectorビュー</strong>から<strong>Behabior Parameteresのモデルを選択</strong>
</li>
<li>モデルとして<strong>3DBall 1</strong>を選択．</li>
</ol>

<p><a href="https://camo.qiitausercontent.com/252f2937a1be016eac4852e21ebc8e41b47569fe/68747470733a2f2f692e696d6775722e636f6d2f705438524348692e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FpT8RCHi.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=171f22217e4fafcec257b28feaecf79c" alt="" data-canonical-src="https://i.imgur.com/pT8RCHi.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FpT8RCHi.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6faa8d1290f54d9ed5cbc6837c36de46 1x" loading="lazy"></a></p>

<p>そうしたら，再生ボタンを押して学習したモデルを確認してみましょう．<br>
下のGIFではわかりにくいですが，最初からついていた事前学習済みモデルより，少し動きが荒い気がしましたが，ちゃんとボールを落とさないように学習しています！</p>

<p><a href="https://camo.qiitausercontent.com/5d7f90067893051ee5fb27b7ca8fc63b9c79a0c7/68747470733a2f2f692e696d6775722e636f6d2f4d53546c5353772e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMSTlSSw.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2944e19f1a42af226fe978f22e2502a3" alt="" data-canonical-src="https://i.imgur.com/MSTlSSw.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMSTlSSw.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d1beaf1a077914e7b3b18e8587956a65 1x" loading="lazy"></a></p>

<p>また，訓練の過程をグラフィカルに観察することができます．<br>
学習を開始すると<code>result</code>フォルダが作成されるので，それがあるフォルダで以下のコマンドを実行してください．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>tensorboard <span class="nt">--logdir</span><span class="o">=</span>results <span class="nt">--port</span><span class="o">=</span>6006
</code></pre></div></div>

<p>すると以下のパスで学習過程を見ることができます．</p>

<p><qiita-embed-ogp src="http://localhost:6006/"></qiita-embed-ogp></p>

<p><a href="https://camo.qiitausercontent.com/8c977180763ea85b9bdc3c95d5bd2def0097ad58/68747470733a2f2f692e696d6775722e636f6d2f50455a765257612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FPEZvRWa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d161548644c80d1f13bc6997e0b9ff09" alt="" data-canonical-src="https://i.imgur.com/PEZvRWa.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FPEZvRWa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3521963fd61787709c3fa4f624a5f4aa 1x" loading="lazy"></a></p>

<p>以上でサンプルプログラムの動作チェックは終了です．</p>

<hr>

<hr>

<h1>
<span id="新しい学習環境の作成と強化学習" class="fragment"></span><a href="#%E6%96%B0%E3%81%97%E3%81%84%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92"><i class="fa fa-link"></i></a>新しい学習環境の作成と強化学習</h1>

<p>ここでは強化学習を行うためにUnityのプロジェクトを作るところから自分でやっていこうと思います．</p>

<p>Unity Hubを開いてプロジェクトから新規作成を選択します．</p>

<p><a href="https://camo.qiitausercontent.com/871df8e79b2c5a3138dd356b25ed54907656b263/68747470733a2f2f692e696d6775722e636f6d2f4f327234776a312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FO2r4wj1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=471eb8b1a9390e0ec076b172d9596cc5" alt="" data-canonical-src="https://i.imgur.com/O2r4wj1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FO2r4wj1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f35511916080307a363b0b18fd9a62c3 1x" loading="lazy"></a></p>

<p>プロジェクト名を<strong>RollerBall</strong>にして作成をクリック．</p>

<p><a href="https://camo.qiitausercontent.com/478c519c0dede0990f42db4a33e58e2ce40b17ab/68747470733a2f2f692e696d6775722e636f6d2f37557a385939712e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F7Uz8Y9q.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=229d44fdfbb97119d3a5bff2707459a5" alt="" data-canonical-src="https://i.imgur.com/7Uz8Y9q.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F7Uz8Y9q.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=76f297a16e6b004f3b208d2cda348403 1x" loading="lazy"></a></p>

<p>プロジェクトが作成されたら，最初のシーンの名前が<strong>SampleScene</strong>になっているので下のようにProjectビューから<strong>RollerBall</strong>にリネームします．</p>

<p><a href="https://camo.qiitausercontent.com/66bf51834212eccf9bac7174e6a75f9d6ba48ca3/68747470733a2f2f692e696d6775722e636f6d2f4b394f774236372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FK9OwB67.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=800ddbc1d3c97fd07b8379bcd25c68c3" alt="" data-canonical-src="https://i.imgur.com/K9OwB67.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FK9OwB67.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6e2eb702bd0d827630445e5d49963268 1x" loading="lazy"></a></p>

<p>次にML-AgentsのUnityパッケージをインストールします．<br>
左上のWindowタブから<strong>Package Manager</strong>を選択してください．</p>

<p><a href="https://camo.qiitausercontent.com/0f9cddd72d0ec69d701318628475a43d81e7832a/68747470733a2f2f692e696d6775722e636f6d2f7176316748366a2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fqv1gH6j.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8eee4428bbf40f11d3f8bc7ec0a0cd1d" alt="" data-canonical-src="https://i.imgur.com/qv1gH6j.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fqv1gH6j.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2b4eb043334b90f25cf0177f6a36f135 1x" loading="lazy"></a></p>

<p>Package Managerが開いたら左上の+ボタンから<strong>Add package from disk</strong>を選択してください．</p>

<p><a href="https://camo.qiitausercontent.com/666302ff2894084c0c219fa5f0d6956035a403f1/68747470733a2f2f692e696d6775722e636f6d2f5a744364445a532e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZtCdDZS.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=03b26da17cf473d3575fa350ae3fa796" alt="" data-canonical-src="https://i.imgur.com/ZtCdDZS.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZtCdDZS.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d892abb95355cf0b9ace2865d161257c 1x" loading="lazy"></a></p>

<p>そうしたら<strong>ml-agents-release_3\com.unity.ml-agents\package.json</strong>を開いてください．<br>
インポートに少し時間がかかります．</p>

<p><a href="https://camo.qiitausercontent.com/1977a042b54d83aa21f9b3bfe1a1c3b8882c045c/68747470733a2f2f692e696d6775722e636f6d2f4c494b337274302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FLIK3rt0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e70a49c5b1c009496bd493384f3c25c9" alt="" data-canonical-src="https://i.imgur.com/LIK3rt0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FLIK3rt0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=76a4e6f21dcac44c6a875b15e5880d61 1x" loading="lazy"></a></p>

<p>次にゲームオブジェクトを配置していきます．<br>
Hierarchyビューで右クリックして，まず最初に次のように<strong>Plane</strong>を追加します．<br>
そして名前を<strong>Floor</strong>にリネームしてください．</p>

<p><a href="https://camo.qiitausercontent.com/c10ac08718cb16b07836559cd8370acc064adf6b/68747470733a2f2f692e696d6775722e636f6d2f615432617a66782e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FaT2azfx.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f66c4222bb506f5b7c06cead4b0c831e" alt="" data-canonical-src="https://i.imgur.com/aT2azfx.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FaT2azfx.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ac250b95e11dd1eda630e2c5e182829f 1x" loading="lazy"></a></p>

<p>同様に<strong>Cube</strong>を追加します．</p>

<p><a href="https://camo.qiitausercontent.com/f103887ce73a2d612a459b580b4b7303400d86b6/68747470733a2f2f692e696d6775722e636f6d2f5a57666a456e6d2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZWfjEnm.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d906cafd3d55554ca51c32f23e895e02" alt="" data-canonical-src="https://i.imgur.com/ZWfjEnm.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZWfjEnm.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b758588145e6b931376571d08f4424a9 1x" loading="lazy"></a></p>

<p>そして名前を<strong>Target</strong>にし，Positionを(3,0.5,3)に変更します．<br>
この時のInspectorビューは下のようになります．</p>

<p><a href="https://camo.qiitausercontent.com/7737f471ffd7e7f9388748d0215c6aa51ff61da8/68747470733a2f2f692e696d6775722e636f6d2f6f6a727a6261792e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fojrzbay.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=cf4419d9b3bfd5e7c59a5cddc5ea0ac0" alt="" data-canonical-src="https://i.imgur.com/ojrzbay.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fojrzbay.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=469235f27b09115623b2a5065dcc621f 1x" loading="lazy"></a></p>

<p>同様に<strong>Sphere</strong>を追加します．</p>

<p><a href="https://camo.qiitausercontent.com/bd1c20d1cb0309b33b72a37d81412f07cdab19b0/68747470733a2f2f692e696d6775722e636f6d2f71614f683752392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FqaOh7R9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=251ee9a24008532271bc84639e97a606" alt="" data-canonical-src="https://i.imgur.com/qaOh7R9.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FqaOh7R9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=12f7dbc5283cc8111ea5dc510ea6ead5 1x" loading="lazy"></a></p>

<p>そして名前を<strong>RoolerAgent</strong>にして，positionを(0,0.5,0)に変更します．<br>
この時のInspectorビューは下のようになります．</p>

<p><a href="https://camo.qiitausercontent.com/9b824c83d8e423b73b48c89737a45cad9f53abd9/68747470733a2f2f692e696d6775722e636f6d2f596c58636b354d2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FYlXck5M.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=116e68750a0bd76cefdbe60f45e8a269" alt="" data-canonical-src="https://i.imgur.com/YlXck5M.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FYlXck5M.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3ee5b6a53fe242c112b6061ac182ea96 1x" loading="lazy"></a></p>

<p>次に<strong>RollerAgent</strong>のInspectorビューの下にいくと，<strong>Add Component</strong>というボタンがあるのでクリックして，下の図のように<strong>Rigidbody</strong>を追加してください．</p>

<p><a href="https://camo.qiitausercontent.com/3bb9104f53f1df183c448b14b4a0d305fb761379/68747470733a2f2f692e696d6775722e636f6d2f6b686d51396b6e2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkhmQ9kn.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ba499a47a292012f06deac40d6a9bc95" alt="" data-canonical-src="https://i.imgur.com/khmQ9kn.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkhmQ9kn.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=33e929af6915b0f64884685e3518e359 1x" loading="lazy"></a></p>

<p>これでゲームオブジェクトの追加は終わりで，最後にHierarchyビューで<strong>EmptyなGameObject</strong>を作成し，TrainingAreaとリネームして，そこに先程作成したゲームオブジェクトたちを入れておきます．<br>
このようにすることで，管理が楽になります．</p>

<p><a href="https://camo.qiitausercontent.com/0ca9c6527069db818dba87ea50a8dd3891afcb66/68747470733a2f2f692e696d6775722e636f6d2f4337437245416f2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FC7CrEAo.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=367a9458ccda6562baf68edd29e31d2d" alt="" data-canonical-src="https://i.imgur.com/C7CrEAo.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FC7CrEAo.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=beb73148065d533a3e56947948375c0b 1x" loading="lazy"></a></p>

<p>次にスクリプトの追加を行っていきます．<br>
<strong>RollerAgent</strong>のInspectorビューの下の<strong>Add Component</strong>をクリックし，<strong>New Script</strong>で新しくスクリプトを追加します．<br>
名前を次のように<strong>RollerAgent</strong>としてください．</p>

<p><a href="https://camo.qiitausercontent.com/b77264ba0313595422118201da8a43eaa4e2943b/68747470733a2f2f692e696d6775722e636f6d2f5a45564d5161692e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZEVMQai.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6a147c0dc84c6e329bac1afd28f51c3f" alt="" data-canonical-src="https://i.imgur.com/ZEVMQai.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZEVMQai.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=247de2024650d90d0f4df46b049f2c43 1x" loading="lazy"></a></p>

<p>するとRollerAgentにスクリプトが適用されます．<br>
このスクリプトを編集したいので<strong>Projectビュー</strong>から，<strong>RollerAgent</strong>というスクリプトが追加されていると思うので，ダブルクリックして開いてください．デフォルトだとVisual Studioが起動します．</p>

<p><a href="https://camo.qiitausercontent.com/6ed2d887d0d541ba9c7c033c9b1cff511b7a4340/68747470733a2f2f692e696d6775722e636f6d2f69496a545461692e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FiIjTTai.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7f60465aa88e000e3211ed727bc90f58" alt="" data-canonical-src="https://i.imgur.com/iIjTTai.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FiIjTTai.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=29a190e91a15ff9e340a4867c7af7f39 1x" loading="lazy"></a></p>

<p>Visual Studioが起動したら，全文を以下のスクリプトに書き換えてください．</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">RollerAgent.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Unity.MLAgents</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Unity.MLAgents.Sensors</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">RollerAgent</span> <span class="p">:</span> <span class="n">Agent</span>
<span class="p">{</span>
    <span class="n">Rigidbody</span> <span class="n">rBody</span><span class="p">;</span>
    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">rBody</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody</span><span class="p">&gt;();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">Transform</span> <span class="n">Target</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnEpisodeBegin</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// If the Agent fell, zero its momentum</span>
            <span class="k">this</span><span class="p">.</span><span class="n">rBody</span><span class="p">.</span><span class="n">angularVelocity</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">rBody</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0.5f</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// Move the target to a new spot</span>
        <span class="n">Target</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">Random</span><span class="p">.</span><span class="k">value</span> <span class="p">*</span> <span class="m">8</span> <span class="p">-</span> <span class="m">4</span><span class="p">,</span>
                                           <span class="m">0.5f</span><span class="p">,</span>
                                           <span class="n">Random</span><span class="p">.</span><span class="k">value</span> <span class="p">*</span> <span class="m">8</span> <span class="p">-</span> <span class="m">4</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">CollectObservations</span><span class="p">(</span><span class="n">VectorSensor</span> <span class="n">sensor</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Target and Agent positions</span>
        <span class="n">sensor</span><span class="p">.</span><span class="nf">AddObservation</span><span class="p">(</span><span class="n">Target</span><span class="p">.</span><span class="n">localPosition</span><span class="p">);</span>
        <span class="n">sensor</span><span class="p">.</span><span class="nf">AddObservation</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">);</span>

        <span class="c1">// Agent velocity</span>
        <span class="n">sensor</span><span class="p">.</span><span class="nf">AddObservation</span><span class="p">(</span><span class="n">rBody</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
        <span class="n">sensor</span><span class="p">.</span><span class="nf">AddObservation</span><span class="p">(</span><span class="n">rBody</span><span class="p">.</span><span class="n">velocity</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">float</span> <span class="n">speed</span> <span class="p">=</span> <span class="m">10</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnActionReceived</span><span class="p">(</span><span class="kt">float</span><span class="p">[]</span> <span class="n">vectorAction</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Actions, size = 2</span>
        <span class="n">Vector3</span> <span class="n">controlSignal</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
        <span class="n">controlSignal</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="n">vectorAction</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
        <span class="n">controlSignal</span><span class="p">.</span><span class="n">z</span> <span class="p">=</span> <span class="n">vectorAction</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
        <span class="n">rBody</span><span class="p">.</span><span class="nf">AddForce</span><span class="p">(</span><span class="n">controlSignal</span> <span class="p">*</span> <span class="n">speed</span><span class="p">);</span>

        <span class="c1">// Rewards</span>
        <span class="kt">float</span> <span class="n">distanceToTarget</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="nf">Distance</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">,</span> <span class="n">Target</span><span class="p">.</span><span class="n">localPosition</span><span class="p">);</span>

        <span class="c1">// Reached target</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">distanceToTarget</span> <span class="p">&lt;</span> <span class="m">1.42f</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">SetReward</span><span class="p">(</span><span class="m">1.0f</span><span class="p">);</span>
            <span class="nf">EndEpisode</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">// Fell off platform</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">EndEpisode</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Heuristic</span><span class="p">(</span><span class="kt">float</span><span class="p">[]</span> <span class="n">actionsOut</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">actionsOut</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Horizontal"</span><span class="p">);</span>
        <span class="n">actionsOut</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">=</span> <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Vertical"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>最後に少しだけML-Agentsのコンポーネントを追加して終了です．</p>

<ol>
<li>RollerAgentコンポーネントのInspectorビューの下からAdd Componentをクリックします．</li>
<li>
<code>Decision Requester</code>を検索して追加します．</li>
<li>
<code>Decision Period</code>を10に変更します．</li>
<li>Hierarchyビューから<strong>Targetオブジェクト</strong>をRollerAgentスクリプトのTargetフィールドにドラッグ＆ドロップします．</li>
<li>RollerAgentコンポーネントのInspectorビューの下からAdd Componentから<code>Behavior Parameters</code>を追加します．この時もうすでに追加されている場合があります．</li>
<li>
<code>Behavior Parameters</code>のパラメータを次のように変更します．

<ul>
<li>
<code>Behavior Name</code> to RollerBall</li>
<li>
<code>Vector Observation</code> &gt; <code>Space Size</code> = 8</li>
<li>
<code>Vector Action</code> &gt; <code>Space Type</code> = Continuous</li>
<li>
<code>Vector Action</code> &gt; <code>Space Size</code> = 2</li>
</ul>
</li>
</ol>

<p>以上の変更をしたあとにRollerAgentのInspectorビューが次のようになっていればOKです．</p>

<p><a href="https://camo.qiitausercontent.com/4b3e061ce96e9c7961a8487525daaf181ddd333b/68747470733a2f2f692e696d6775722e636f6d2f6b4a4a41534e6f2e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkJJASNo.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=fb3c00f4a58b50614cf20a49a1819ee8" alt="" data-canonical-src="https://i.imgur.com/kJJASNo.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkJJASNo.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=333b2a33cc56c79349b80baebe715f44 1x" loading="lazy"></a></p>

<p>これでUnity上での作業は終了です．<br>
サンプルプログラム同様に手動でボールを動かすことができます．この状態で再生ボタンを押して矢印キーで動かしてみましょう．結構難しいです．</p>

<p>次に強化学習用のハイパーパラメータ用のConfigファイルを作成します．<br>
UnityのRollerBallプロジェクトのフォルダに<code>config</code>フォルダを作成して，そこに新しく<code>rollerball_config.yaml</code>を作成してください．内容は以下をコピペしてください．</p>

<div class="code-frame" data-lang="yaml">
<div class="code-lang"><span class="bold">rollerball_config.yaml</span></div>
<div class="highlight"><pre class="with-code"><code><span class="na">behaviors</span><span class="pi">:</span>
  <span class="na">RollerBall</span><span class="pi">:</span>
    <span class="na">trainer_type</span><span class="pi">:</span> <span class="s">ppo</span>
    <span class="na">hyperparameters</span><span class="pi">:</span>
      <span class="na">batch_size</span><span class="pi">:</span> <span class="m">10</span>
      <span class="na">buffer_size</span><span class="pi">:</span> <span class="m">100</span>
      <span class="na">learning_rate</span><span class="pi">:</span> <span class="s">3.0e-4</span>
      <span class="na">beta</span><span class="pi">:</span> <span class="s">5.0e-4</span>
      <span class="na">epsilon</span><span class="pi">:</span> <span class="m">0.2</span>
      <span class="na">lambd</span><span class="pi">:</span> <span class="m">0.99</span>
      <span class="na">num_epoch</span><span class="pi">:</span> <span class="m">3</span>
      <span class="na">learning_rate_schedule</span><span class="pi">:</span> <span class="s">linear</span>
    <span class="na">network_settings</span><span class="pi">:</span>
      <span class="na">normalize</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">hidden_units</span><span class="pi">:</span> <span class="m">128</span>
      <span class="na">num_layers</span><span class="pi">:</span> <span class="m">2</span>
    <span class="na">reward_signals</span><span class="pi">:</span>
      <span class="na">extrinsic</span><span class="pi">:</span>
        <span class="na">gamma</span><span class="pi">:</span> <span class="m">0.99</span>
        <span class="na">strength</span><span class="pi">:</span> <span class="m">1.0</span>
    <span class="na">max_steps</span><span class="pi">:</span> <span class="m">500000</span>
    <span class="na">time_horizon</span><span class="pi">:</span> <span class="m">64</span>
    <span class="na">summary_freq</span><span class="pi">:</span> <span class="m">10000</span>
</code></pre></div>
</div>

<p>各ハイパーパラメータについては検索するといろいろ詳細な情報が得られるので検索してみてください．</p>

<p>準備が完了したので早速学習を行っていきましょう．<br>
サンプルプログラムと同様にまずPowerShellを開き先程作成したAnacondaの<code>ml-agens</code>仮想環境に入ります．</p>

<p>そして，次のコマンドを実行したあと，Unity側で再生ボタンを押して学習を開始します．</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre class="with-code"><code>mlagents-learn config/rollerball_config.yaml <span class="nt">--run-id</span><span class="o">=</span>RollerBall
</code></pre></div></div>

<p><a href="https://camo.qiitausercontent.com/6f66060f91737bc0d3c37c5ae1bae9b5b000a7f1/68747470733a2f2f692e696d6775722e636f6d2f443979373765682e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FD9y77eh.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=318986fadddc5c068cc9347540eb97ed" alt="" data-canonical-src="https://i.imgur.com/D9y77eh.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FD9y77eh.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a011191a980e5afa432524e0a36dcfc9 1x" loading="lazy"></a></p>

<p>試行回数が50万回に設定されていますが，ログを見ていたら10万回くらいには平均報酬が収束していたので，途中で学習をやめ，これを学習済みモデルとしました(学習をやめるときはUnity側で停止するようにしましょう)．<br>
下は終了時点での出力です．</p>

<p><a href="https://camo.qiitausercontent.com/f308bf57420cdeaafc65ec08a10dcd1e925c247b/68747470733a2f2f692e696d6775722e636f6d2f437a55714e4b732e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FCzUqNKs.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=bb4850088bafbc885e1d29ddb83c934c" alt="" data-canonical-src="https://i.imgur.com/CzUqNKs.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FCzUqNKs.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=25f0ef03bc98a890c84f4b484f4c7ae7 1x" loading="lazy"></a></p>

<p>resultフォルダに結果が保存されているので，サンプルプログラムを動かしたときと同様にドラッグ＆ドロップでProjectビューの適当なところにインポートします．</p>

<p><a href="https://camo.qiitausercontent.com/1f7d23bf7f171aa32d95915415aa84e4ddb49151/68747470733a2f2f692e696d6775722e636f6d2f514b4c6e4967782e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQKLnIgx.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f85907389551d31a6e23c310ade4877f" alt="" data-canonical-src="https://i.imgur.com/QKLnIgx.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQKLnIgx.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b3579da7b282a0a38868bf057e6ae4be 1x" loading="lazy"></a></p>

<p>学習済みモデルがインポートできたら，これをAgentに適用します．</p>

<ol>
<li>Hierarchyビューから<strong>RollerAgent</strong>を選択する</li>
<li>Inspectorビューから<strong>Behabior Parameter→Model</strong>をクリック</li>
<li>先程追加した<strong>RollerBall</strong>を選択</li>
</ol>

<p><a href="https://camo.qiitausercontent.com/bc763d21fac8fb782c70a3949c63f77db2290ad9/68747470733a2f2f692e696d6775722e636f6d2f6f3835575142732e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fo85WQBs.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=effd16445fcfb3195fbc8cd437a4722f" alt="" data-canonical-src="https://i.imgur.com/o85WQBs.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fo85WQBs.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ac19a2094f1a58e5710defa97bddca5e 1x" loading="lazy"></a></p>

<p>以上の操作をやって再生ボタンを押してみましょう．<br>
はじめに示したように，ボールがボックスを追いかけるAgentを作成することができたでしょうか？</p>

<hr>

<hr>

<h1>
<span id="さいごに" class="fragment"></span><a href="#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB"><i class="fa fa-link"></i></a>さいごに</h1>

<p>UnityとML-Agentsを使って強化学習を行う環境を構築してきました．<br>
シンプルな問題設定の場合，意外と簡単に実行できることがわかりました．<br>
今後はこれらを使って様々なモデルの強化学習を行っていきたいと思います．</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2F2019Shun%2Fitems%2Fd811bbd470fc9cddcc3d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2F2019Shun%2Fitems%2Fd811bbd470fc9cddcc3d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/2019Shun/items/d811bbd470fc9cddcc3d/likers" class="css-1iupg5d">57</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">53</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/d811bbd470fc9cddcc3d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/2019Shun/items/d811bbd470fc9cddcc3d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/2019Shun/items/d811bbd470fc9cddcc3d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/2019Shun/items/d811bbd470fc9cddcc3d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/2019Shun/items/d811bbd470fc9cddcc3d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-3ffada26-0019-438d-8c26-3aed19bcaabb">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-350546af-0c12-4534-b99c-a73216497f66"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-350546af-0c12-4534-b99c-a73216497f66">{}</script>
      
<div id="LoginModal-react-component-ccca9c1a-d532-4a35-a551-e810d5a1ddd4"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-ccca9c1a-d532-4a35-a551-e810d5a1ddd4">{}</script>
      
<div id="StockModal-react-component-e37f92cc-4b9c-4f57-8adb-55899598ccf1"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-e37f92cc-4b9c-4f57-8adb-55899598ccf1">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;wbiE2qqQI6lmu9Kn69E7UuEtFVHrDHUlQKCDjoIoMyA9OBlqaiycm/DYkpRL/CnEsZZ+skXULGatR6wIOY9Wiw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eWindows10でUnityとML-Agentsというパッケージを使用して，強化学習を行うやり方を説明します．\u003cbr\u003e\n基本的に\u003ca href=\"https://github.com/Unity-Technologies/ml-agents/blob/release_3_docs/docs/Readme.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちらのドキュメント\u003c/a\u003eにそって説明を行いたいと思います．\u003c/p\u003e\n\n\u003cp\u003eこの記事では次のようにボールにAgentを搭載し，四角いボックスを追いかけさせるプログラムを0から作成していきます．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0dd877cff58f7a95c09ce2270d6b48e15a9cde1e/68747470733a2f2f692e696d6775722e636f6d2f6b37794e6941762e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fk7yNiAv.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=cc1f895c97fea889ee53e629ad578edb\" alt=\"\" data-canonical-src=\"https://i.imgur.com/k7yNiAv.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fk7yNiAv.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e1778032322106d820bd989aa8fb5fc5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"目次\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%9B%AE%E6%AC%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e目次\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83\"\u003e実行環境\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\"\u003e環境構築\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#unity%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003eUnityのインストール\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#pythonanaconda3%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003ePython(Anaconda3)のインストール\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#ml-agents-release-3-%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\"\u003eML-Agents Release 3 のセットアップ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E4%BD%9C%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF\"\u003eサンプルプログラムの動作チェック\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E6%96%B0%E3%81%97%E3%81%84%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92\"\u003e新しい学習環境の作成と強化学習\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"\u003eさいごに\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003chr\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"実行環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行環境\u003c/h1\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003cth\u003eバージョン\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eWindows10\u003c/td\u003e\n\u003ctd\u003e1909\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnity\u003c/td\u003e\n\u003ctd\u003e2019.4.3f1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePython(Anaconda3)\u003c/td\u003e\n\u003ctd\u003e3.7.6\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eML-Agents\u003c/td\u003e\n\u003ctd\u003eRelease 3\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e\u003cstrong\u003eML-Agents\u003c/strong\u003eは現在(2020/07/14)で最新である\u003ccode\u003eRelease 3\u003c/code\u003eを使用します．\u003cbr\u003e\n\u003ccode\u003eRelease 3\u003c/code\u003eではUnityに関しては\u003ccode\u003e2018.04\u003c/code\u003e以降，Pythonに関しては\u003ccode\u003e3.6.1\u003c/code\u003e以上が対応しています．\u003cbr\u003e\nPythonの環境にAnacondaを使用する場合は関係ないですが，ML-Agentsのインストールの際に\u003ccode\u003epip3\u003c/code\u003eが必要になります．\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"環境構築\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e環境構築\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"unityのインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unity%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUnityのインストール\u003c/h2\u003e\n\n\u003cp\u003e次のサイトにアクセスし，\u003cstrong\u003eUnity Hub\u003c/strong\u003eをダウンロートします．\u003cbr\u003e\n\u003cstrong\u003eUnity Hub\u003c/strong\u003eはUnityのバージョン管理をしてくれるソフトウェアです．\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://unity3d.com/get-unity/download\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1c5f1b94ecdc95e3b3a125e7e7862e2094e9305b/68747470733a2f2f692e696d6775722e636f6d2f57485478566e622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FWHTxVnb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=356b80c2b707764c9f7c03c1f4306a74\" alt=\"\" data-canonical-src=\"https://i.imgur.com/WHTxVnb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FWHTxVnb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=24cf5e331cfffe350b985532b5c97313 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eUnity Hub\u003c/strong\u003eのインストールが完了したら，次にアカウントの登録を行います．\u003cbr\u003e\nUnityのサイトでアカウントを作成し，サインインしてください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b7e4603893cfdf116de7edbccf9dee0a2ae5a8cf/68747470733a2f2f692e696d6775722e636f6d2f4d4262543773742e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMBbT7st.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b6ed0b7f9e9a0e3283fdd1029d98da88\" alt=\"\" data-canonical-src=\"https://i.imgur.com/MBbT7st.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMBbT7st.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f4ff7b9765243c2c52a02d49664aed72 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にライセンスの登録を行います．\u003cbr\u003e\n今回は\u003cstrong\u003eUnity Personal\u003c/strong\u003eを使用するので次のように選びます．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/cc29890fd85fea3659ebefd5a6844de3d9377a50/68747470733a2f2f692e696d6775722e636f6d2f787055734465472e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FxpUsDeG.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c7874ec249d2c87c090d531dc876e263\" alt=\"\" data-canonical-src=\"https://i.imgur.com/xpUsDeG.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FxpUsDeG.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0b0c701e8b8519e7bce244430238505c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e続いてUnity本体のインストールを行います．次の画面から適当なバージョンを選択してインストールしてください．もし\u003cstrong\u003eVisual Studio\u003c/strong\u003eがない場合，ここで自動的にインストールしてくれます．\u003cbr\u003e\nインストールに結構時間がかかります．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d993f8b20380abc24119e92fe4d80b655375d444/68747470733a2f2f692e696d6775722e636f6d2f55616e4e4745542e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUanNGET.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=29fdd7afdf5f85163cd10842881dd55b\" alt=\"\" data-canonical-src=\"https://i.imgur.com/UanNGET.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUanNGET.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fce2302ff2a4f28a6e19c3008b8b57a6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"pythonanaconda3のインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#pythonanaconda3%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePython(Anaconda3)のインストール\u003c/h2\u003e\n\n\u003cp\u003e次のサイトにアクセスし，下の方のPython3.7 64-Bit Graphical Installerをダウンロードします．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.anaconda.com/products/individual#windows\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.anaconda.com/products/individual#windows\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/2f3f16c205c4bf8244ff58a3dc7ed60ed0068dc6/68747470733a2f2f692e696d6775722e636f6d2f5638696e5a56302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FV8inZV0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5ca162692ab0bc89e44b035838184e83\" alt=\"\" data-canonical-src=\"https://i.imgur.com/V8inZV0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FV8inZV0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=156a2dca9aa1a44d8b46d4d2e1922d9c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eインストーラーがダウンロードできたら，後は流れでインストールしていきます．\u003c/p\u003e\n\n\u003cp\u003e途中にAnaconda3のパスを環境変数に登録するかしないかの確認が入りますが，特になにも無ければ環境変数に登録しても大丈夫だと思います(もうすでにPythonの環境を構築していたり複数のバージョンを管理しているなどがなければ...)が推奨されていないみたいです．\u003c/p\u003e\n\n\u003cp\u003eここのチェックを付けない場合，自分で環境変数を通す必要があります(Anaconda Promptを使う場合は必要ないかも)．\u003cbr\u003e\n今回は\u003cstrong\u003ePowerShell\u003c/strong\u003eを使って実行していきます．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/5473b442feb02ce760d1f5f8be25fec23f200298/68747470733a2f2f692e696d6775722e636f6d2f625573487430592e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FbUsHt0Y.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f985484a22252d2b34e9ac2d8f1deaed\" alt=\"\" data-canonical-src=\"https://i.imgur.com/bUsHt0Y.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FbUsHt0Y.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c6ca9e16ef32dbb0c7dbca0e4583a8fd 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"powershellでanacondaを使用できるようにする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#powershell%E3%81%A7anaconda%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePowerShellでAnacondaを使用できるようにする\u003c/h3\u003e\n\n\u003cp\u003e環境変数にパスが通っているとPowerShellでPythonが実行できるようになります．\u003cbr\u003e\nしかし，Anacondaで仮想環境を作ってそこでいろいろしたいときに\u003ccode\u003econda activate\u003c/code\u003eで仮想環境に入ったりするんですが，デフォルトのPowerShellだと上手く実行できません．\u003c/p\u003e\n\n\u003cp\u003e自分はPowerShellが好きなので，なんとしてでもPowerShellで実行したいです．\u003cbr\u003e\nいろいろ探していたら次の記事でやり方が報告されていたので参考にしました．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/8128/items/877caf785b20758ba7e0\" id=\"reference-af7ac43f176f10a01470\"\u003econda activateでエラーが出る話\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePowerShellで次のコマンドを実行します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003econda init powershell\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここでPowerShellを再起動したりするとエラーがでるようになると思います．\u003cbr\u003e\n次に管理者権限でPowerShellを開き，次のコマンドを実行します．\u003cbr\u003e\n実行しますか～と聞かれるのでYESを選択．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eSet-ExecutionPolicy RemoteSigned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003ePowerShellを再起動して，次のように\u003ccode\u003e(base)\u003c/code\u003eと表示されたら成功です．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0574883919c0b768a716fd19550836d0d1b6bf98/68747470733a2f2f692e696d6775722e636f6d2f6763744f7a73652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FgctOzse.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9145f879c97dfdfb5ac9bc333c98e0d5\" alt=\"\" data-canonical-src=\"https://i.imgur.com/gctOzse.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FgctOzse.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d6ac73ce082cd7a60badbae4341668ef 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"anacondaに強化学習用の仮想環境を作成する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#anaconda%E3%81%AB%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E7%94%A8%E3%81%AE%E4%BB%AE%E6%83%B3%E7%92%B0%E5%A2%83%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAnacondaに強化学習用の仮想環境を作成する\u003c/h3\u003e\n\n\u003cp\u003eAnacondaが使えるようになったら，強化学習用の仮想環境を作成します．\u003cbr\u003e\n仮想環境を作成することで，環境の切り替えや，壊れた際に簡単にやり直すことができます．\u003c/p\u003e\n\n\u003cp\u003e次のコマンドで仮想環境を作成します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003econda create \u003cspan class=\"nt\"\u003e-n\u003c/span\u003e ml-agents \u003cspan class=\"nv\"\u003epython\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e3.6\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e仮想環境を切り替える際は\u003ccode\u003econda activate \u0026lt;名前\u0026gt;\u003c/code\u003eを実行します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003econda activate ml-agents\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次のように\u003ccode\u003e(ml-agents)\u003c/code\u003eを表示されれば成功です．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d29ebd1ebab5f028a2573fe7cdab2e4f38650004/68747470733a2f2f692e696d6775722e636f6d2f766e4c657365592e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FvnLeseY.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9737b5d9ab72e0c0ecaa292b5b304eb6\" alt=\"\" data-canonical-src=\"https://i.imgur.com/vnLeseY.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FvnLeseY.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0cdea75e728bef0d184f7d1917ec3969 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ml-agents-release-3-のセットアップ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ml-agents-release-3-%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eML-Agents Release 3 のセットアップ\u003c/h2\u003e\n\n\u003cp\u003e次のML-AgentsのReleaseのページから，ソースコードをダウンロードします．\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://github.com/Unity-Technologies/ml-agents/releases/tag/release_3\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/98c85b68b2d2099f121bdf4ba1f98b7de629e13a/68747470733a2f2f692e696d6775722e636f6d2f55676c4d6e47762e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUglMnGv.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a6d55f96916e906a912f24a4e211bf05\" alt=\"\" data-canonical-src=\"https://i.imgur.com/UglMnGv.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FUglMnGv.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6bd6438f926e51ae4f793a9137092ddc 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e下の方に行くとボタンがあるので\u003ccode\u003eSource code(zip)\u003c/code\u003eを選択して，ダウンロードします．\u003cbr\u003e\nそして，適当なフォルダに解凍してください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/5e532ad6376d07d20ce288c435e02cc56dac65c0/68747470733a2f2f692e696d6775722e636f6d2f42397a6e5453392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FB9znTS9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=07ea2864b31a7e475d45e250f84beabb\" alt=\"\" data-canonical-src=\"https://i.imgur.com/B9znTS9.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FB9znTS9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4a2b0e5de5e69542ab433a2f94249b17 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eコマンドラインからGitを実行できる人は以下のコマンドでRelease3をダウンロードすることができます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003egit clone --branch release_3 https://github.com/Unity-Technologies/ml-agents.git\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここからは先程作成した仮想環境\u003ccode\u003e(ml-agents)\u003c/code\u003eに入った状態おこないます．\u003c/p\u003e\n\n\u003cp\u003e次のコマンドでPythonのmlagentsパッケージをインストールします．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003epip3 \u003cspan class=\"nb\"\u003einstall \u003c/span\u003emlagents\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次に先程GitHubからダウンロードして解凍したフォルダに移動して，PowerShellを開きます．\u003cbr\u003e\nそして次のコマンドを実行します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003epip3 \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e \u003cspan class=\"nt\"\u003e-e\u003c/span\u003e ./ml-agents-envs\npip3 \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e \u003cspan class=\"nt\"\u003e-e\u003c/span\u003e ./ml-agents\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003chr\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"サンプルプログラムの動作チェック\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E4%BD%9C%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサンプルプログラムの動作チェック\u003c/h1\u003e\n\n\u003cp\u003eここではML-Agentsのサンプルの1つである\u003ccode\u003e3DBall\u003c/code\u003eの強化学習を行っていきます．\u003cbr\u003e\n次のようにボックスが上にボールを乗せている状況を考えます．強化学習を行いボールを落とさないようにボックスにバランスをとらせることが目標です．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/53a4710369615b2d1c4d0faf3b9fd755ee3d5a85/68747470733a2f2f692e696d6775722e636f6d2f6c6930477544392e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fli0GuD9.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=45f8fd1d41a2cb0f516a13f8e08a05e8\" alt=\"\" data-canonical-src=\"https://i.imgur.com/li0GuD9.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fli0GuD9.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=47f141edb8c8046f131705483bcef3e3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそれではやっていきましょう．\u003cbr\u003e\nUnity Hubを開いて，\u003cstrong\u003eプロジェクト→リスト\u003c/strong\u003eに追加をクリックします．フォルダを開くダイアログがでるので先程ダウンロードした\u003cstrong\u003eml-agents-release_3\\Project\u003c/strong\u003eを指定します．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/090b9a4726fc2458bcebf193ee226b3e935e0cb1/68747470733a2f2f692e696d6775722e636f6d2f366d4a6c50796d2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F6mJlPym.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3bc1a73e8484801dce25ac8c62ba2e6a\" alt=\"\" data-canonical-src=\"https://i.imgur.com/6mJlPym.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F6mJlPym.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=24b01ed073ba916db39db7614e1dfd83 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にUnityのバージョンを更新します．\u003cstrong\u003eUnityバージョン\u003c/strong\u003eの欄をクリックして先程インストールしたバージョンを選択します．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/38091524e6bf2046aacb9a13599df5956cb084b9/68747470733a2f2f692e696d6775722e636f6d2f39773150664d772e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F9w1PfMw.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=07f6609564785b57c80cc7d1368dc4e5\" alt=\"\" data-canonical-src=\"https://i.imgur.com/9w1PfMw.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F9w1PfMw.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7f55f0dd555ef6059dea003d30fef66e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eその状態で\u003cstrong\u003eProject\u003c/strong\u003eをクリックするとUnityが開かれるのですが，初回は次のようにプロジェクトをアップグレードしますか？というダイアログがでるので確認をクリックして進みます．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/181a75e0d0d21edc9d20ac2f853df394e0653ecf/68747470733a2f2f692e696d6775722e636f6d2f4f4b41703347562e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FOKAp3GV.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2d8bb9d25005a65c3069949e131a188c\" alt=\"\" data-canonical-src=\"https://i.imgur.com/OKAp3GV.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FOKAp3GV.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0d8874bcba02c2c7a2d24f7a8a84ee20 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eプロジェクトが開かれたら，次のように\u003cstrong\u003eProjectビュー\u003c/strong\u003eから\u003cstrong\u003eML-Agents→Examples→3DBall→Scenes\u003c/strong\u003eをダブルクリックで開き，\u003cstrong\u003e3DBall\u003c/strong\u003eというシーンをダブルクリックしてください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a8d6e33fa3e6ca11c5ea831f2b2f02bd4826be67/68747470733a2f2f692e696d6775722e636f6d2f6c53354735736b2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FlS5G5sk.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=dad313f6f8f32d644fa98286ef14537f\" alt=\"\" data-canonical-src=\"https://i.imgur.com/lS5G5sk.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FlS5G5sk.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=43088af4ddc58264b5753f350ae95f84 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eすると，青いボックスが12個並んだシーンが表示されます．こちらのシーンには最初からトレーニング済みの学習モデルがセットされているため，この状態で上の再生(Play)ボタンを押すと，しっかりとバランスを取る動作を行います．\u003c/p\u003e\n\n\u003cp\u003e今回は学習を行うので，トレーニング済みの学習モデルを一度プレハブから取り除きます．\u003c/p\u003e\n\n\u003cp\u003e取り除く際は下の手順のようにプレハブを操作することで，シーン全体のボックスの内容を変更することができます．\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eProjectビューから\u003cstrong\u003eML-Agents→Examples→3DBall→Prefabs\u003c/strong\u003eをダブルクリックで開く\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003e3DBallのプレハブを\u003c/strong\u003eをダブルクリック．するとHierarchyビューに表示されます．\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eHierarchyビュー\u003c/strong\u003eから\u003cstrong\u003eAgent\u003c/strong\u003eを選択\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eInspectorビュー\u003c/strong\u003eから\u003cstrong\u003eBehabior Parameteresのモデルを選択\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eモデルとして\u003cstrong\u003eNone\u003c/strong\u003eを選択．\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/482b3e98bd82ef6e7b24dd0562d0bcccfe94a27e/68747470733a2f2f692e696d6775722e636f6d2f514f6b6a6161682e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQOkjaah.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=25cf91759827ccb3be8dd78af63ad805\" alt=\"\" data-canonical-src=\"https://i.imgur.com/QOkjaah.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQOkjaah.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d4ec417e6d3b4f2523fa873cb64b71bb 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/7d7eb900b183ce14e3953d58b390731f6b2126fa/68747470733a2f2f692e696d6775722e636f6d2f73484849736e6d2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FsHHIsnm.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=be1742817fd132b5a1653eb199cbe647\" alt=\"\" data-canonical-src=\"https://i.imgur.com/sHHIsnm.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FsHHIsnm.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8d8947ba99351205a5cd77b3d46ccb10 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれで学習済みモデルを引き剥がすことができました．\u003cbr\u003e\nこの状態で，再生(Play)ボタンを押すと，青いボックスを矢印キーで動かすことができるようになります．\u003cbr\u003e\n試しにやってみます(すべてのボックスが同期して動くので次のGIFでは左上のボックスに注目しています)が結構難しいです．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ab9fa023b10c2e388885cacac66c46a8043898f8/68747470733a2f2f692e696d6775722e636f6d2f7477674f4e62572e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FtwgONbW.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=674f5acc205da3a665574371bcf334e6\" alt=\"\" data-canonical-src=\"https://i.imgur.com/twgONbW.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FtwgONbW.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=02db81d0a62be93ee525c127119bb9d2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそれでは学習を行っていきましょう．\u003cbr\u003e\n\u003ccode\u003ePowerShell\u003c/code\u003eでGitHubからダウンロートしてきた\u003cstrong\u003eml-agents-release_3\u003c/strong\u003eフォルダを開きます．\u003cbr\u003e\nそこで次のコマンドを実行します．\u003cbr\u003e\n\u003ccode\u003erun-id\u003c/code\u003eは識別子のようなもので重複は許されません．この名前のフォルダに学習モデルが保存されます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003emlagents-learn config/ppo/3DBall.yaml \u003cspan class=\"nt\"\u003e--run-id\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003efirst3DBallRun\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/220e024ff7654f41148042e63690a0d74af3be6b/68747470733a2f2f692e696d6775722e636f6d2f665447466b50672e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FfTGFkPg.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6f306dc08860b7177400123e4482ac71\" alt=\"\" data-canonical-src=\"https://i.imgur.com/fTGFkPg.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FfTGFkPg.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a1ca6104e474a6c599d2556a71367032 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e実行して次の画面のようにUnityのロゴが出て，\u003ccode\u003eStart training by pressing the Play button in the Unity Editor.\u003c/code\u003eという表記がでたら，Unityの画面に戻り，再生(Play)ボタンを押してください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/2f71905954d4f84a9dd3606c32768b23d06f71f8/68747470733a2f2f692e696d6775722e636f6d2f41756f4563434e2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FAuoEcCN.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b348a1b13f62ef94fb0b8be5ccd79d9c\" alt=\"\" data-canonical-src=\"https://i.imgur.com/AuoEcCN.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FAuoEcCN.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d38aff5fb9ded934d9a95e1f39a0c7eb 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eすると次のように自動で高速にボックスが動き，学習が始まります．\u003cbr\u003e\nしばし待ちましょう(10分もしないくらい？)．\u003cbr\u003e\nもし，途中で終了する場合はUnity側の再生ボタンを再度クリックすることで終了できます(PowerShell側からやると学習結果が消えます)．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/fdc0f5c7fafb42fec42a2fe193b24cadf5c29fef/68747470733a2f2f692e696d6775722e636f6d2f6f444f6b4c665a2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FoDOkLfZ.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2d4efe95bf446c16a73b78f8823649f4\" alt=\"\" data-canonical-src=\"https://i.imgur.com/oDOkLfZ.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FoDOkLfZ.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=673cd5ee503663fa359d13b9faa154d8 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e正常に終了したら，学習は成功です．\u003cbr\u003e\n学習結果は\u003cstrong\u003eml-agents-release_3\\results\\first3DBallRun\\3DBall.nn\u003c/strong\u003eに保存されます．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/018601dc8ad93c9bbdee858c581816938695a166/68747470733a2f2f692e696d6775722e636f6d2f323844345653452e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F28D4VSE.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ba4baaf67684bdfbb00f6a721273c675\" alt=\"\" data-canonical-src=\"https://i.imgur.com/28D4VSE.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F28D4VSE.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=80f8145e10c95e143829343fc979f2ed 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eその学習結果を次の画面参考に，Projectビューから\u003cstrong\u003eML-Agents→Examples→3DBall→TFModels\u003c/strong\u003eを開き，そこにドラッグ＆ドロップします．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0762cf463abe7adcd4203a7584e650b98dbb6f5a/68747470733a2f2f692e696d6775722e636f6d2f6164714a4a4f752e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FadqJJOu.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=fe62d7cd43d8c622e03095bd7b3ca9e8\" alt=\"\" data-canonical-src=\"https://i.imgur.com/adqJJOu.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FadqJJOu.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ef8e5bfe2f039f484db0531d75b25ec9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eすると次のように\u003cstrong\u003e3DBall 1\u003c/strong\u003eという名前で保存されます．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e4e4b2624baa7155d748eed8da82940bbb85f549/68747470733a2f2f692e696d6775722e636f6d2f4575496f6b4c612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FEuIokLa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c495fb42a2b76a4d20f0a9c2922525ab\" alt=\"\" data-canonical-src=\"https://i.imgur.com/EuIokLa.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FEuIokLa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=36a21cdf36a6dcf975b84b72e6ae30f0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e後は先程学習モデルを引き剥がしたときと同様にこの学習モデルを割り当てます．\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eProjectビューから\u003cstrong\u003eML-Agents→Examples→3DBall→Prefabs\u003c/strong\u003eをダブルクリックで開く\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003e3DBallのプレハブを\u003c/strong\u003eをダブルクリック．するとHierarchyビューに表示されます．\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eHierarchyビュー\u003c/strong\u003eから\u003cstrong\u003eAgent\u003c/strong\u003eを選択\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eInspectorビュー\u003c/strong\u003eから\u003cstrong\u003eBehabior Parameteresのモデルを選択\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eモデルとして\u003cstrong\u003e3DBall 1\u003c/strong\u003eを選択．\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/252f2937a1be016eac4852e21ebc8e41b47569fe/68747470733a2f2f692e696d6775722e636f6d2f705438524348692e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FpT8RCHi.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=171f22217e4fafcec257b28feaecf79c\" alt=\"\" data-canonical-src=\"https://i.imgur.com/pT8RCHi.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FpT8RCHi.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6faa8d1290f54d9ed5cbc6837c36de46 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそうしたら，再生ボタンを押して学習したモデルを確認してみましょう．\u003cbr\u003e\n下のGIFではわかりにくいですが，最初からついていた事前学習済みモデルより，少し動きが荒い気がしましたが，ちゃんとボールを落とさないように学習しています！\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/5d7f90067893051ee5fb27b7ca8fc63b9c79a0c7/68747470733a2f2f692e696d6775722e636f6d2f4d53546c5353772e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMSTlSSw.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2944e19f1a42af226fe978f22e2502a3\" alt=\"\" data-canonical-src=\"https://i.imgur.com/MSTlSSw.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FMSTlSSw.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d1beaf1a077914e7b3b18e8587956a65 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eまた，訓練の過程をグラフィカルに観察することができます．\u003cbr\u003e\n学習を開始すると\u003ccode\u003eresult\u003c/code\u003eフォルダが作成されるので，それがあるフォルダで以下のコマンドを実行してください．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003etensorboard \u003cspan class=\"nt\"\u003e--logdir\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eresults \u003cspan class=\"nt\"\u003e--port\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e6006\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eすると以下のパスで学習過程を見ることができます．\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"http://localhost:6006/\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/8c977180763ea85b9bdc3c95d5bd2def0097ad58/68747470733a2f2f692e696d6775722e636f6d2f50455a765257612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FPEZvRWa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d161548644c80d1f13bc6997e0b9ff09\" alt=\"\" data-canonical-src=\"https://i.imgur.com/PEZvRWa.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FPEZvRWa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3521963fd61787709c3fa4f624a5f4aa 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e以上でサンプルプログラムの動作チェックは終了です．\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"新しい学習環境の作成と強化学習\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B0%E3%81%97%E3%81%84%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e新しい学習環境の作成と強化学習\u003c/h1\u003e\n\n\u003cp\u003eここでは強化学習を行うためにUnityのプロジェクトを作るところから自分でやっていこうと思います．\u003c/p\u003e\n\n\u003cp\u003eUnity Hubを開いてプロジェクトから新規作成を選択します．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/871df8e79b2c5a3138dd356b25ed54907656b263/68747470733a2f2f692e696d6775722e636f6d2f4f327234776a312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FO2r4wj1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=471eb8b1a9390e0ec076b172d9596cc5\" alt=\"\" data-canonical-src=\"https://i.imgur.com/O2r4wj1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FO2r4wj1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f35511916080307a363b0b18fd9a62c3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eプロジェクト名を\u003cstrong\u003eRollerBall\u003c/strong\u003eにして作成をクリック．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/478c519c0dede0990f42db4a33e58e2ce40b17ab/68747470733a2f2f692e696d6775722e636f6d2f37557a385939712e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F7Uz8Y9q.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=229d44fdfbb97119d3a5bff2707459a5\" alt=\"\" data-canonical-src=\"https://i.imgur.com/7Uz8Y9q.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2F7Uz8Y9q.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=76f297a16e6b004f3b208d2cda348403 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eプロジェクトが作成されたら，最初のシーンの名前が\u003cstrong\u003eSampleScene\u003c/strong\u003eになっているので下のようにProjectビューから\u003cstrong\u003eRollerBall\u003c/strong\u003eにリネームします．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/66bf51834212eccf9bac7174e6a75f9d6ba48ca3/68747470733a2f2f692e696d6775722e636f6d2f4b394f774236372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FK9OwB67.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=800ddbc1d3c97fd07b8379bcd25c68c3\" alt=\"\" data-canonical-src=\"https://i.imgur.com/K9OwB67.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FK9OwB67.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6e2eb702bd0d827630445e5d49963268 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にML-AgentsのUnityパッケージをインストールします．\u003cbr\u003e\n左上のWindowタブから\u003cstrong\u003ePackage Manager\u003c/strong\u003eを選択してください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0f9cddd72d0ec69d701318628475a43d81e7832a/68747470733a2f2f692e696d6775722e636f6d2f7176316748366a2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fqv1gH6j.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8eee4428bbf40f11d3f8bc7ec0a0cd1d\" alt=\"\" data-canonical-src=\"https://i.imgur.com/qv1gH6j.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fqv1gH6j.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2b4eb043334b90f25cf0177f6a36f135 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePackage Managerが開いたら左上の+ボタンから\u003cstrong\u003eAdd package from disk\u003c/strong\u003eを選択してください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/666302ff2894084c0c219fa5f0d6956035a403f1/68747470733a2f2f692e696d6775722e636f6d2f5a744364445a532e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZtCdDZS.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=03b26da17cf473d3575fa350ae3fa796\" alt=\"\" data-canonical-src=\"https://i.imgur.com/ZtCdDZS.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZtCdDZS.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d892abb95355cf0b9ace2865d161257c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそうしたら\u003cstrong\u003eml-agents-release_3\\com.unity.ml-agents\\package.json\u003c/strong\u003eを開いてください．\u003cbr\u003e\nインポートに少し時間がかかります．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1977a042b54d83aa21f9b3bfe1a1c3b8882c045c/68747470733a2f2f692e696d6775722e636f6d2f4c494b337274302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FLIK3rt0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e70a49c5b1c009496bd493384f3c25c9\" alt=\"\" data-canonical-src=\"https://i.imgur.com/LIK3rt0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FLIK3rt0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=76a4e6f21dcac44c6a875b15e5880d61 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にゲームオブジェクトを配置していきます．\u003cbr\u003e\nHierarchyビューで右クリックして，まず最初に次のように\u003cstrong\u003ePlane\u003c/strong\u003eを追加します．\u003cbr\u003e\nそして名前を\u003cstrong\u003eFloor\u003c/strong\u003eにリネームしてください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c10ac08718cb16b07836559cd8370acc064adf6b/68747470733a2f2f692e696d6775722e636f6d2f615432617a66782e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FaT2azfx.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f66c4222bb506f5b7c06cead4b0c831e\" alt=\"\" data-canonical-src=\"https://i.imgur.com/aT2azfx.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FaT2azfx.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ac250b95e11dd1eda630e2c5e182829f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e同様に\u003cstrong\u003eCube\u003c/strong\u003eを追加します．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f103887ce73a2d612a459b580b4b7303400d86b6/68747470733a2f2f692e696d6775722e636f6d2f5a57666a456e6d2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZWfjEnm.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d906cafd3d55554ca51c32f23e895e02\" alt=\"\" data-canonical-src=\"https://i.imgur.com/ZWfjEnm.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZWfjEnm.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b758588145e6b931376571d08f4424a9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそして名前を\u003cstrong\u003eTarget\u003c/strong\u003eにし，Positionを(3,0.5,3)に変更します．\u003cbr\u003e\nこの時のInspectorビューは下のようになります．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/7737f471ffd7e7f9388748d0215c6aa51ff61da8/68747470733a2f2f692e696d6775722e636f6d2f6f6a727a6261792e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fojrzbay.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=cf4419d9b3bfd5e7c59a5cddc5ea0ac0\" alt=\"\" data-canonical-src=\"https://i.imgur.com/ojrzbay.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fojrzbay.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=469235f27b09115623b2a5065dcc621f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e同様に\u003cstrong\u003eSphere\u003c/strong\u003eを追加します．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/bd1c20d1cb0309b33b72a37d81412f07cdab19b0/68747470733a2f2f692e696d6775722e636f6d2f71614f683752392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FqaOh7R9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=251ee9a24008532271bc84639e97a606\" alt=\"\" data-canonical-src=\"https://i.imgur.com/qaOh7R9.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FqaOh7R9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=12f7dbc5283cc8111ea5dc510ea6ead5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそして名前を\u003cstrong\u003eRoolerAgent\u003c/strong\u003eにして，positionを(0,0.5,0)に変更します．\u003cbr\u003e\nこの時のInspectorビューは下のようになります．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/9b824c83d8e423b73b48c89737a45cad9f53abd9/68747470733a2f2f692e696d6775722e636f6d2f596c58636b354d2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FYlXck5M.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=116e68750a0bd76cefdbe60f45e8a269\" alt=\"\" data-canonical-src=\"https://i.imgur.com/YlXck5M.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FYlXck5M.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3ee5b6a53fe242c112b6061ac182ea96 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次に\u003cstrong\u003eRollerAgent\u003c/strong\u003eのInspectorビューの下にいくと，\u003cstrong\u003eAdd Component\u003c/strong\u003eというボタンがあるのでクリックして，下の図のように\u003cstrong\u003eRigidbody\u003c/strong\u003eを追加してください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/3bb9104f53f1df183c448b14b4a0d305fb761379/68747470733a2f2f692e696d6775722e636f6d2f6b686d51396b6e2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkhmQ9kn.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ba499a47a292012f06deac40d6a9bc95\" alt=\"\" data-canonical-src=\"https://i.imgur.com/khmQ9kn.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkhmQ9kn.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=33e929af6915b0f64884685e3518e359 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれでゲームオブジェクトの追加は終わりで，最後にHierarchyビューで\u003cstrong\u003eEmptyなGameObject\u003c/strong\u003eを作成し，TrainingAreaとリネームして，そこに先程作成したゲームオブジェクトたちを入れておきます．\u003cbr\u003e\nこのようにすることで，管理が楽になります．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0ca9c6527069db818dba87ea50a8dd3891afcb66/68747470733a2f2f692e696d6775722e636f6d2f4337437245416f2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FC7CrEAo.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=367a9458ccda6562baf68edd29e31d2d\" alt=\"\" data-canonical-src=\"https://i.imgur.com/C7CrEAo.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FC7CrEAo.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=beb73148065d533a3e56947948375c0b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にスクリプトの追加を行っていきます．\u003cbr\u003e\n\u003cstrong\u003eRollerAgent\u003c/strong\u003eのInspectorビューの下の\u003cstrong\u003eAdd Component\u003c/strong\u003eをクリックし，\u003cstrong\u003eNew Script\u003c/strong\u003eで新しくスクリプトを追加します．\u003cbr\u003e\n名前を次のように\u003cstrong\u003eRollerAgent\u003c/strong\u003eとしてください．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b77264ba0313595422118201da8a43eaa4e2943b/68747470733a2f2f692e696d6775722e636f6d2f5a45564d5161692e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZEVMQai.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6a147c0dc84c6e329bac1afd28f51c3f\" alt=\"\" data-canonical-src=\"https://i.imgur.com/ZEVMQai.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FZEVMQai.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=247de2024650d90d0f4df46b049f2c43 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eするとRollerAgentにスクリプトが適用されます．\u003cbr\u003e\nこのスクリプトを編集したいので\u003cstrong\u003eProjectビュー\u003c/strong\u003eから，\u003cstrong\u003eRollerAgent\u003c/strong\u003eというスクリプトが追加されていると思うので，ダブルクリックして開いてください．デフォルトだとVisual Studioが起動します．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/6ed2d887d0d541ba9c7c033c9b1cff511b7a4340/68747470733a2f2f692e696d6775722e636f6d2f69496a545461692e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FiIjTTai.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7f60465aa88e000e3211ed727bc90f58\" alt=\"\" data-canonical-src=\"https://i.imgur.com/iIjTTai.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FiIjTTai.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=29a190e91a15ff9e340a4867c7af7f39 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVisual Studioが起動したら，全文を以下のスクリプトに書き換えてください．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eRollerAgent.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnity.MLAgents\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnity.MLAgents.Sensors\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eRollerAgent\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eAgent\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eRigidbody\u003c/span\u003e \u003cspan class=\"n\"\u003erBody\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erBody\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eRigidbody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eTransform\u003c/span\u003e \u003cspan class=\"n\"\u003eTarget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnEpisodeBegin\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// If the Agent fell, zero its momentum\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eangularVelocity\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezero\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evelocity\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezero\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.5f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Move the target to a new spot\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eTarget\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eRandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                           \u003cspan class=\"m\"\u003e0.5f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                           \u003cspan class=\"n\"\u003eRandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCollectObservations\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eVectorSensor\u003c/span\u003e \u003cspan class=\"n\"\u003esensor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Target and Agent positions\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esensor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddObservation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTarget\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esensor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddObservation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Agent velocity\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esensor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddObservation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evelocity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esensor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddObservation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evelocity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ez\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003espeed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnActionReceived\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evectorAction\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Actions, size = 2\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eVector3\u003c/span\u003e \u003cspan class=\"n\"\u003econtrolSignal\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezero\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolSignal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evectorAction\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolSignal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ez\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evectorAction\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddForce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtrolSignal\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003espeed\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Rewards\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003edistanceToTarget\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eVector3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTarget\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Reached target\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edistanceToTarget\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1.42f\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eSetReward\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eEndEpisode\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Fell off platform\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eEndEpisode\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eHeuristic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eactionsOut\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eactionsOut\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAxis\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Horizontal\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eactionsOut\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAxis\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Vertical\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e最後に少しだけML-Agentsのコンポーネントを追加して終了です．\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRollerAgentコンポーネントのInspectorビューの下からAdd Componentをクリックします．\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eDecision Requester\u003c/code\u003eを検索して追加します．\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eDecision Period\u003c/code\u003eを10に変更します．\u003c/li\u003e\n\u003cli\u003eHierarchyビューから\u003cstrong\u003eTargetオブジェクト\u003c/strong\u003eをRollerAgentスクリプトのTargetフィールドにドラッグ＆ドロップします．\u003c/li\u003e\n\u003cli\u003eRollerAgentコンポーネントのInspectorビューの下からAdd Componentから\u003ccode\u003eBehavior Parameters\u003c/code\u003eを追加します．この時もうすでに追加されている場合があります．\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eBehavior Parameters\u003c/code\u003eのパラメータを次のように変更します．\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eBehavior Name\u003c/code\u003e to RollerBall\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eVector Observation\u003c/code\u003e \u0026gt; \u003ccode\u003eSpace Size\u003c/code\u003e = 8\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eVector Action\u003c/code\u003e \u0026gt; \u003ccode\u003eSpace Type\u003c/code\u003e = Continuous\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eVector Action\u003c/code\u003e \u0026gt; \u003ccode\u003eSpace Size\u003c/code\u003e = 2\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e以上の変更をしたあとにRollerAgentのInspectorビューが次のようになっていればOKです．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4b3e061ce96e9c7961a8487525daaf181ddd333b/68747470733a2f2f692e696d6775722e636f6d2f6b4a4a41534e6f2e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkJJASNo.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=fb3c00f4a58b50614cf20a49a1819ee8\" alt=\"\" data-canonical-src=\"https://i.imgur.com/kJJASNo.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FkJJASNo.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=333b2a33cc56c79349b80baebe715f44 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれでUnity上での作業は終了です．\u003cbr\u003e\nサンプルプログラム同様に手動でボールを動かすことができます．この状態で再生ボタンを押して矢印キーで動かしてみましょう．結構難しいです．\u003c/p\u003e\n\n\u003cp\u003e次に強化学習用のハイパーパラメータ用のConfigファイルを作成します．\u003cbr\u003e\nUnityのRollerBallプロジェクトのフォルダに\u003ccode\u003econfig\u003c/code\u003eフォルダを作成して，そこに新しく\u003ccode\u003erollerball_config.yaml\u003c/code\u003eを作成してください．内容は以下をコピペしてください．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"yaml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003erollerball_config.yaml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"na\"\u003ebehaviors\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eRollerBall\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003etrainer_type\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eppo\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ehyperparameters\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ebatch_size\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ebuffer_size\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e\n      \u003cspan class=\"na\"\u003elearning_rate\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e3.0e-4\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ebeta\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e5.0e-4\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eepsilon\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e0.2\u003c/span\u003e\n      \u003cspan class=\"na\"\u003elambd\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e0.99\u003c/span\u003e\n      \u003cspan class=\"na\"\u003enum_epoch\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\n      \u003cspan class=\"na\"\u003elearning_rate_schedule\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003elinear\u003c/span\u003e\n    \u003cspan class=\"na\"\u003enetwork_settings\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003enormalize\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ehidden_units\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e128\u003c/span\u003e\n      \u003cspan class=\"na\"\u003enum_layers\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ereward_signals\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eextrinsic\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"na\"\u003egamma\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e0.99\u003c/span\u003e\n        \u003cspan class=\"na\"\u003estrength\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e1.0\u003c/span\u003e\n    \u003cspan class=\"na\"\u003emax_steps\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e500000\u003c/span\u003e\n    \u003cspan class=\"na\"\u003etime_horizon\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e64\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esummary_freq\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e10000\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e各ハイパーパラメータについては検索するといろいろ詳細な情報が得られるので検索してみてください．\u003c/p\u003e\n\n\u003cp\u003e準備が完了したので早速学習を行っていきましょう．\u003cbr\u003e\nサンプルプログラムと同様にまずPowerShellを開き先程作成したAnacondaの\u003ccode\u003eml-agens\u003c/code\u003e仮想環境に入ります．\u003c/p\u003e\n\n\u003cp\u003eそして，次のコマンドを実行したあと，Unity側で再生ボタンを押して学習を開始します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003emlagents-learn config/rollerball_config.yaml \u003cspan class=\"nt\"\u003e--run-id\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eRollerBall\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/6f66060f91737bc0d3c37c5ae1bae9b5b000a7f1/68747470733a2f2f692e696d6775722e636f6d2f443979373765682e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FD9y77eh.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=318986fadddc5c068cc9347540eb97ed\" alt=\"\" data-canonical-src=\"https://i.imgur.com/D9y77eh.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FD9y77eh.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a011191a980e5afa432524e0a36dcfc9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e試行回数が50万回に設定されていますが，ログを見ていたら10万回くらいには平均報酬が収束していたので，途中で学習をやめ，これを学習済みモデルとしました(学習をやめるときはUnity側で停止するようにしましょう)．\u003cbr\u003e\n下は終了時点での出力です．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f308bf57420cdeaafc65ec08a10dcd1e925c247b/68747470733a2f2f692e696d6775722e636f6d2f437a55714e4b732e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FCzUqNKs.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=bb4850088bafbc885e1d29ddb83c934c\" alt=\"\" data-canonical-src=\"https://i.imgur.com/CzUqNKs.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FCzUqNKs.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=25f0ef03bc98a890c84f4b484f4c7ae7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eresultフォルダに結果が保存されているので，サンプルプログラムを動かしたときと同様にドラッグ＆ドロップでProjectビューの適当なところにインポートします．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1f7d23bf7f171aa32d95915415aa84e4ddb49151/68747470733a2f2f692e696d6775722e636f6d2f514b4c6e4967782e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQKLnIgx.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f85907389551d31a6e23c310ade4877f\" alt=\"\" data-canonical-src=\"https://i.imgur.com/QKLnIgx.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2FQKLnIgx.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b3579da7b282a0a38868bf057e6ae4be 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e学習済みモデルがインポートできたら，これをAgentに適用します．\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eHierarchyビューから\u003cstrong\u003eRollerAgent\u003c/strong\u003eを選択する\u003c/li\u003e\n\u003cli\u003eInspectorビューから\u003cstrong\u003eBehabior Parameter→Model\u003c/strong\u003eをクリック\u003c/li\u003e\n\u003cli\u003e先程追加した\u003cstrong\u003eRollerBall\u003c/strong\u003eを選択\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/bc763d21fac8fb782c70a3949c63f77db2290ad9/68747470733a2f2f692e696d6775722e636f6d2f6f3835575142732e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fo85WQBs.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=effd16445fcfb3195fbc8cd437a4722f\" alt=\"\" data-canonical-src=\"https://i.imgur.com/o85WQBs.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fi.imgur.com%2Fo85WQBs.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ac19a2094f1a58e5710defa97bddca5e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e以上の操作をやって再生ボタンを押してみましょう．\u003cbr\u003e\nはじめに示したように，ボールがボックスを追いかけるAgentを作成することができたでしょうか？\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"さいごに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eさいごに\u003c/h1\u003e\n\n\u003cp\u003eUnityとML-Agentsを使って強化学習を行う環境を構築してきました．\u003cbr\u003e\nシンプルな問題設定の場合，意外と簡単に実行できることがわかりました．\u003cbr\u003e\n今後はこれらを使って様々なモデルの強化学習を行っていきたいと思います．\u003c/p\u003e\n","createdAt":"2020-07-16T01:55:07Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"6sBJH2+2CIbdRouxn/+qVc6FYoS0MUDFSg==--/CvvFNqi1zfaYs29--xVffzjON6jftNttkV3Ifbg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-09-05T11:48:08Z","likesCount":57,"linkUrl":"https://qiita.com/2019Shun/items/d811bbd470fc9cddcc3d","organization":null,"originalId":1265467,"stockedCount":53,"title":"Windows10でUnityとML-Agentsを使った強化学習 ～自分で新しく環境を作成して学習することろまで～","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%9B%AE%E6%AC%A1\"\u003e目次\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83\"\u003e実行環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89\"\u003e環境構築\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#unity%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003eUnityのインストール\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pythonanaconda3%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003ePython(Anaconda3)のインストール\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#powershell%E3%81%A7anaconda%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003ePowerShellでAnacondaを使用できるようにする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#anaconda%E3%81%AB%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E7%94%A8%E3%81%AE%E4%BB%AE%E6%83%B3%E7%92%B0%E5%A2%83%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"\u003eAnacondaに強化学習用の仮想環境を作成する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ml-agents-release-3-%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\"\u003eML-Agents Release 3 のセットアップ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E4%BD%9C%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF\"\u003eサンプルプログラムの動作チェック\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%96%B0%E3%81%97%E3%81%84%E5%AD%A6%E7%BF%92%E7%92%B0%E5%A2%83%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92\"\u003e新しい学習環境の作成と強化学習\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"\u003eさいごに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":16984,"uuid":"d811bbd470fc9cddcc3d","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"1bdXoTcZt8rftiI58Y1PSRbJ8hxi--WbqJv/vilT4gpQNu--CESNiHQNM7lTmDzpisZ+cA==","originalId":427721,"description":"","facebookUrl":null,"githubUrl":"https://github.com/2019Shun","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/427721/profile-images/1603224576","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F427721%2Fprofile-images%2F1603224576?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=f39054322c7e47927549e19bb2da3690","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F427721%2Fprofile-images%2F1603224576?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=408da7ec756c18d6d0caef3659fe54dc","urlName":"2019Shun","websiteUrl":"","twitterUrl":"https://twitter.com/2020Shun_tech","twitterUrlName":"2020Shun_tech","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"機械学習","urlName":"%e6%a9%9f%e6%a2%b0%e5%ad%a6%e7%bf%92"},{"name":"強化学習","urlName":"%e5%bc%b7%e5%8c%96%e5%ad%a6%e7%bf%92"},{"name":"ML-Agents","urlName":"ml-agents"}],"followingLikers":{"edges":[]},"comments":{"totalCount":4}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
