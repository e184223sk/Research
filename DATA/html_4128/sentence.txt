本記事は、自分サイトのこの記事と同一内容です。皆さんは、こういう話を聞いたことありますか?これは事実であり、詳細は下記記事に記載されています。
パワーポイント、ワードから画像を取り出す。
でも、いちいちファイルの拡張子を変えて、解凍して、画像を取り出す…というのは面倒!!
そんなわけで、この処理を自動でおこなうC#コードを作りました。ソースコートは下記リンクに貼ってあります。
Program.cs今回のプログラムでは、コマンドライン引数で処理対象ファイルのパスを受け取ります。(fname)
それが実在しないファイルだと困るので、ファイルの存在チェックをします。ファイルが存在しても、処理に非対応のファイルでは困ります。
なので、拡張子でファイルが処理に対応しているか確認します。fnameはzipファイルでなく、コマンドライン引数で受け取ったOfficeのファイルパスです。
解凍元ファイルの拡張子は、zipにせずOfficeのファイルのままでも問題ありません。.netには、フォルダ内の全ファイル・フォルダをコピーする関数がありません。
なので自作する必要があります。
DirectoryUtil.Copyがこれに当たり、このサイトのCopyAndReplace関数と処理は同じです。最後に、解凍したフォルダを削除します。~本当はPDFMergerと同様に実行ファイルを公開したいのですが、Visual Studio Codeで実行ファイルを作成するとどうしても個人情報入りのファイルがないと実行できない状況となり、公開ができません。
どうにかできないかな…~
⇒フレームワークを.net Coreから.net Frameworkに変更したことで、ソフトの公開ができました。
ソフトのDLリンク
抜き出した画像の著作権・肖像権に気を付けつつご利用ください。


