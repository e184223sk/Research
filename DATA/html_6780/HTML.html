<!DOCTYPE html><html><head><meta charset="utf-8" /><title>CocosSharp migration from 1.6 to 1.7 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/ShikaTech/items/498c69d7bc92a7424061" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="wGXnxKgwxTHUHDi/TO2K9/lJOIeUVFPTd3l2DGp268m2ZGGYXzQVa5s9fFt/fvE/a0buaDQ/rizGkE66f8BcMA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@ShikaTech" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="CocosSharp migration from 1.6 to 1.7 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1RMjlqYjNOVGFHRnljQ0J0YVdkeVlYUnBiMjRnWm5KdmJTQXhMallnZEc4Z01TNDMmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ODM4MDhmMDViMWI0YThmZWFlNTg2ZWMzZWMyM2NiMzM&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRk5vYVd0aFZHVmphQSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTdjNmRmZDE5NGU3YjljOTJlMDIwNzAwMTZiNTVkY2Vm&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=87a8c7dd67cb8cd99ffa93bc058e7cf1"><meta property="og:description" content="2016/12/21 追記 イベントが動かなくなる件が解決しました！！



初のAdvent Calendar！
なんとか間に合ったー


事の始まり

私が現在参加しているベンチャー企業では、Xamarinを使ったAndroid/..."><meta content="https://qiita.com/ShikaTech/items/498c69d7bc92a7424061" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Xamarin,CocosSharp" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-f6d107f8-b329-4aaf-82d1-752149db8fa1"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FShikaTech%2Fitems%2F498c69d7bc92a7424061">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FShikaTech%2Fitems%2F498c69d7bc92a7424061">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-f6d107f8-b329-4aaf-82d1-752149db8fa1">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2016-12-16T23:16:20.000+09:00","dateModified":"2016-12-21T21:11:56.000+09:00","headline":"CocosSharp migration from 1.6 to 1.7","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1RMjlqYjNOVGFHRnljQ0J0YVdkeVlYUnBiMjRnWm5KdmJTQXhMallnZEc4Z01TNDMmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ODM4MDhmMDViMWI0YThmZWFlNTg2ZWMzZWMyM2NiMzM\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRk5vYVd0aFZHVmphQSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTdjNmRmZDE5NGU3YjljOTJlMDIwNzAwMTZiNTVkY2Vm\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=87a8c7dd67cb8cd99ffa93bc058e7cf1","mainEntityOfPage":"https://qiita.com/ShikaTech/items/498c69d7bc92a7424061","author":{"@type":"Person","address":"Tokyo, Japan","email":null,"identifier":"ShikaTech","name":"ShikaTech","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F78880%2Fprofile-images%2F1486425343?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=11407fdfd4b8c6afee7b24cd0a66e8a9","url":"https://qiita.com/ShikaTech","description":"いわゆる常駐IT戦士としてWEB系をメインに新卒から約10年。\r\nその後フリーランスとして放浪し、とあるベンチャーにジョインして今に至る。\r\n野望は「世界中から感謝される」こと。\r\n\r\nC#,Python,JavaScript/jQuery/HTML5,Xamarin","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"ShikaTech","type":"items","id":"498c69d7bc92a7424061"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"ShikaTech","type":"items","id":"498c69d7bc92a7424061"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"ShikaTech","type":"items","id":"498c69d7bc92a7424061"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/ShikaTech/items/498c69d7bc92a7424061","location":"/ShikaTech/items/498c69d7bc92a7424061","scheme":"https","host":"qiita.com","port":null,"pathname":"/ShikaTech/items/498c69d7bc92a7424061","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"WrfzCUwjoOq2AOnlQS6RJAXqwAR2Ne8qsISeKUo2ux0stnVVuydwsPkhrQFyversl+UW69ZeEtUBbaafX4AM5A==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-e75fbd0e-d12a-4f2e-91ec-3aab6b52ab2c"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/ShikaTech/items/498c69d7bc92a7424061/likers" class="css-1iupg5d">8</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">1</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/498c69d7bc92a7424061/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/ShikaTech/items/498c69d7bc92a7424061/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/ShikaTech/items/498c69d7bc92a7424061/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/ShikaTech/items/498c69d7bc92a7424061/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/ShikaTech/items/498c69d7bc92a7424061.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2016/xamarin2" class="it-AdcalRibbon_title">Xamarin(その2)<!-- --> Advent Calendar<!-- --> <!-- -->2016</a>Day 16</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/ShikaTech"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/78880/profile-images/1486425343" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/ShikaTech" class="css-10ougpm">@<!-- -->ShikaTech</a><div class="css-1ay9vb9"><span><meta content="2016-12-16T14:16:20Z"/><time dateTime="2016-12-21T12:11:56Z" class="css-m19uds">updated at 2016-12-21</time></span></div></div></div></div></div><h1 class="css-cgzq40">CocosSharp migration from 1.6 to 1.7</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/xamarin" class="css-4czcte">Xamarin</a><a href="/tags/cocossharp" class="css-4czcte">CocosSharp</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><strong>2016/12/21 追記 イベントが動かなくなる件が解決しました！！</strong></p>

<hr>

<p>初のAdvent Calendar！<br>
なんとか間に合ったー</p>

<h1>
<span id="事の始まり" class="fragment"></span><a href="#%E4%BA%8B%E3%81%AE%E5%A7%8B%E3%81%BE%E3%82%8A"><i class="fa fa-link"></i></a>事の始まり</h1>

<p>私が現在参加しているベンチャー企業では、Xamarinを使ったAndroid/iPhone向けのマルチプラットフォームアプリを作成しています。<br>
その中のコンテンツの一つとしてCocosSharpを使ったゲームがあり、<strong>Androidではほぼ完成</strong>していました。<br>
ところで<strong>iOS向けにビルドしたところ、ゲーム終了時にXamarinForms側に戻ってこれない</strong>という事象が発生しました。<br>
　※CCApplication.ExitGameすると画面が真っ暗になって一切の操作を受け付けない状態に<br>
そこでTwitterで助けを求めたところCocosSharp第一人者の<a href="/hiro128_777" class="user-mention js-hovercard" title="hiro128_777" data-hovercard-target-type="user" data-hovercard-target-name="hiro128_777">@hiro128_777</a>さんからアドバイスを頂き、CocosSharpの1.6系から1.7系へと移行する果てしない旅が始まったのです。</p>

<p>その時の魂の叫びと天の助け。<br>
<a href="https://twitter.com/ShikaTech/status/807209104917680128" class="autolink" rel="nofollow noopener" target="_blank">https://twitter.com/ShikaTech/status/807209104917680128</a></p>

<h1>
<span id="いきなりのゴメンナサイ" class="fragment"></span><a href="#%E3%81%84%E3%81%8D%E3%81%AA%E3%82%8A%E3%81%AE%E3%82%B4%E3%83%A1%E3%83%B3%E3%83%8A%E3%82%B5%E3%82%A4"><i class="fa fa-link"></i></a>いきなりのゴメンナサイ</h1>

<p>12/16時点でプロダクトコードの<strong>マイグレーションは未完了</strong>であり、毎日ズブズブと沼にハマっていく有様です。マジ溺れ死ぬ。<br>
本記事ではサンプルコードをネタに1.6から1.7への移行を促しつつ、私が直面した問題を赤裸々に公開したいと思います。</p>

<h1>
<span id="16-to-17" class="fragment"></span><a href="#16-to-17"><i class="fa fa-link"></i></a>1.6 to 1.7</h1>

<p>大前提として、PCL/Android/iOSの組み合わせでプロジェクトを作成し、CocosSharp.PCL 1.6がインストールされているものとします。<br>
また、1.6およびXamarinFormsでの基本的な開発経験があるものとします。<br>
<a href="https://github.com/mono/cocos-sharp-samples" rel="nofollow noopener" target="_blank">CocosSharpの公式サンプルはこちら</a></p>

<h2>
<span id="前準備" class="fragment"></span><a href="#%E5%89%8D%E6%BA%96%E5%82%99"><i class="fa fa-link"></i></a>前準備</h2>

<p>Nugetより、CocosSharp.Formsをインストールしてください。<br>
その過程でCocosSharp（無印）がインストールされます。<br>
さらにその過程で、CocosSharp.PCLがパッケージから消えてなくなるはずです。<br>
　※ただしNugetパッケージマネージャで見ると居る…とりあえず動けばいいので見て見ぬふり。。<br>
また、1.7のGetting Startページも一通り目を通しておくと理解が深まります。<br>
<a href="https://developer.xamarin.com/guides/xamarin-forms/advanced/cocossharp/" rel="nofollow noopener" target="_blank">Using CocosSharp in Xamarin.Forms</a></p>

<p><a href="https://camo.qiitausercontent.com/03ecb065f48f51a9aa7e6c7cbd8cbbdb3fff5055/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f37383838302f61616632383932302d663863312d623265312d343062362d3763353266326438333338642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F78880%2Faaf28920-f8c1-b2e1-40b6-7c52f2d8338d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=946b1b02136bbc073af809428e19805a" alt="image" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/78880/aaf28920-f8c1-b2e1-40b6-7c52f2d8338d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F78880%2Faaf28920-f8c1-b2e1-40b6-7c52f2d8338d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5e1489714aaabbb98b4cb361de3302cb 1x" loading="lazy"></a></p>

<h2>
<span id="起動方法を変更" class="fragment"></span><a href="#%E8%B5%B7%E5%8B%95%E6%96%B9%E6%B3%95%E3%82%92%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>起動方法を変更</h2>

<p>1.6系では<code>CCApplication</code>,<code>CCApplicationDelegate</code>あたりを使っていたと思いますが、これらはなくなりました。<br>
　※IGameは起動終了用のインタフェースと読み替えてください</p>

<h3>
<span id="旧コード" class="fragment"></span><a href="#%E6%97%A7%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>旧コード</h3>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">iOS側開始終了コード</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">Game</span> <span class="p">:</span> <span class="n">IGame</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Device</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="s">"iOS"</span><span class="p">;</span>

        <span class="k">private</span> <span class="n">CCApplication</span> <span class="n">GameApplication</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">GameApplication</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CCApplication</span><span class="p">();</span>
            <span class="n">GameApplication</span><span class="p">.</span><span class="n">ApplicationDelegate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GameDelegate</span><span class="p">();</span>
            <span class="n">GameApplication</span><span class="p">.</span><span class="nf">StartGame</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">End</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">GameApplication</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">GameApplication</span><span class="p">.</span><span class="nf">ExitGame</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Android側開始終了コード</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">GameService</span> <span class="p">:</span> <span class="n">IGame</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Device</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="s">"Droid"</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">End</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">intent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="p">(</span><span class="n">Forms</span><span class="p">.</span><span class="n">Context</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">MainActivity</span><span class="p">));</span>
            <span class="n">intent</span><span class="p">.</span><span class="nf">AddFlags</span><span class="p">(</span><span class="n">ActivityFlags</span><span class="p">.</span><span class="n">ClearTop</span> <span class="p">|</span> <span class="n">ActivityFlags</span><span class="p">.</span><span class="n">PreviousIsTop</span><span class="p">);</span>
            <span class="n">Forms</span><span class="p">.</span><span class="n">Context</span><span class="p">.</span><span class="nf">StartActivity</span><span class="p">(</span><span class="n">intent</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">intent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="p">(</span><span class="n">Forms</span><span class="p">.</span><span class="n">Context</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">GameActivity</span><span class="p">));</span>
            <span class="n">intent</span><span class="p">.</span><span class="nf">AddFlags</span><span class="p">(</span>
                <span class="n">ActivityFlags</span><span class="p">.</span><span class="n">NewTask</span>               <span class="c1">// Activity以外からActivityを呼び出すのに必須</span>
                <span class="p">|</span> <span class="n">ActivityFlags</span><span class="p">.</span><span class="n">NoHistory</span>           <span class="c1">// スタックに登録しない</span>
                <span class="p">|</span> <span class="n">ActivityFlags</span><span class="p">.</span><span class="n">ExcludeFromRecents</span>  <span class="c1">// 最近使ったアプリの一覧に表示しない</span>
            <span class="p">);</span>
            <span class="n">Forms</span><span class="p">.</span><span class="n">Context</span><span class="p">.</span><span class="nf">StartActivity</span><span class="p">(</span><span class="n">intent</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Android側GameActivityクラス</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">GameActivity</span> <span class="p">:</span> <span class="n">AndroidGameActivity</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">CCApplication</span> <span class="n">GmaeApplication</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnCreate</span><span class="p">(</span><span class="n">Bundle</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnCreate</span><span class="p">(</span><span class="n">bundle</span><span class="p">);</span>

            <span class="n">GmaeApplication</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CCApplication</span><span class="p">();</span>
            <span class="n">GmaeApplication</span><span class="p">.</span><span class="n">ApplicationDelegate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GameDelegate</span><span class="p">();</span>
            <span class="nf">SetContentView</span><span class="p">(</span><span class="n">GmaeApplication</span><span class="p">.</span><span class="n">AndroidContentView</span><span class="p">);</span>
            <span class="n">GmaeApplication</span><span class="p">.</span><span class="nf">StartGame</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">GameDelegate.cs</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">GameDelegate</span> <span class="p">:</span> <span class="n">CCApplicationDelegate</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">CCWindow</span> <span class="n">SharedWindow</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ApplicationDidFinishLaunching</span><span class="p">(</span><span class="n">CCApplication</span> <span class="n">application</span><span class="p">,</span> <span class="n">CCWindow</span> <span class="n">mainWindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">application</span><span class="p">.</span><span class="n">ContentRootDirectory</span> <span class="p">=</span> <span class="s">"Content"</span><span class="p">;</span>
            <span class="n">application</span><span class="p">.</span><span class="n">ContentSearchPaths</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"images"</span><span class="p">);</span>

            <span class="c1">//ゲームの起点画面に遷移</span>
            <span class="kt">var</span> <span class="n">scene</span> <span class="p">=</span> <span class="n">Layers</span><span class="p">.</span><span class="n">GameStartLayer</span><span class="p">.</span><span class="nf">GetScene</span><span class="p">(</span><span class="n">mainWindow</span><span class="p">);</span>
            <span class="n">mainWindow</span><span class="p">.</span><span class="nf">RunWithScene</span><span class="p">(</span><span class="n">scene</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="新コード" class="fragment"></span><a href="#%E6%96%B0%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>新コード</h3>

<p>Xamarin.Formsの１ページとして作ったXamlページにCocosSharpViewを配置するイメージ</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">BattlePage.xaml.cs</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">BattlePage</span> <span class="p">:</span> <span class="n">ContentPage</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">BattlePage</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">gameView</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CocosSharpView</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="n">HorizontalOptions</span> <span class="p">=</span> <span class="n">LayoutOptions</span><span class="p">.</span><span class="n">FillAndExpand</span><span class="p">,</span>
                <span class="n">VerticalOptions</span> <span class="p">=</span> <span class="n">LayoutOptions</span><span class="p">.</span><span class="n">FillAndExpand</span><span class="p">,</span>
                <span class="n">ViewCreated</span> <span class="p">=</span> <span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                    <span class="kt">var</span> <span class="n">gv</span> <span class="p">=</span> <span class="n">sender</span> <span class="k">as</span> <span class="n">CCGameView</span><span class="p">;</span>
                    <span class="c1">//Helpersはアプリ内でGlobalに使いまわす自作ヘルパ</span>
                    <span class="n">gv</span><span class="p">.</span><span class="n">DesignResolution</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CCSizeI</span><span class="p">(</span><span class="n">Helpers</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">AppWidth</span><span class="p">,</span> <span class="n">Helpers</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">AppHeight</span><span class="p">);</span>
                    <span class="n">gv</span><span class="p">.</span><span class="n">ResolutionPolicy</span> <span class="p">=</span> <span class="n">CCViewResolutionPolicy</span><span class="p">.</span><span class="n">ShowAll</span><span class="p">;</span>       
                    <span class="n">gv</span><span class="p">.</span><span class="nf">RunWithScene</span><span class="p">(</span><span class="n">GameStartLayer</span><span class="p">.</span><span class="nf">GetScene</span><span class="p">(</span><span class="n">gv</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">};</span>

            <span class="k">this</span><span class="p">.</span><span class="n">Content</span> <span class="p">=</span> <span class="n">gameView</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">OnBackButtonPressed</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//戻るボタン無効化するならfalse</span>
            <span class="k">return</span> <span class="k">base</span><span class="p">.</span><span class="nf">OnBackButtonPressed</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="ccapplicationは死んだccgameviewだ" class="fragment"></span><a href="#ccapplication%E3%81%AF%E6%AD%BB%E3%82%93%E3%81%A0ccgameview%E3%81%A0"><i class="fa fa-link"></i></a>CCApplicationは死んだ！CCGameViewだ！！</h2>

<p>起動方法の変更にある通り、CCApplicationは使わなくなりました。<br>
これは何も考えずに消してOKなので、ガツッとSearch &amp; Destroyしちゃいましょう！</p>

<p>また、各Layerで引数に取るCCWindowがCCGameViewに変更となりますので、こっちもガツッと置換してください。<br>
　<code>GetScene(CCWindow mainWindow</code> → <code>GetScene(CCGameView mainWindow</code><br>
無意識的に使っているであろうプロパティも置換対象です<br>
　<code>.GetScene(Window</code> → <code>.GetScene(GameView</code></p>

<h1>
<span id="困るぜ" class="fragment"></span><a href="#%E5%9B%B0%E3%82%8B%E3%81%9C"><i class="fa fa-link"></i></a>困るぜ！</h1>

<p>ここまでで、ひとまずビルドは通るようになったかと思います！<br>
…が、そうは問屋が卸しません。。</p>

<h2>
<span id="サイズがおかしくなったぜ" class="fragment"></span><a href="#%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%8C%E3%81%8A%E3%81%8B%E3%81%97%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C"><i class="fa fa-link"></i></a>サイズがおかしくなったぜ！</h2>

<p>1.6のCocosSharpでは特に何も考えなくても、AddedToSceneが終わったタイミングの<code>VisibleBoundsWorldspace.Size</code>で表示領域のサイズが取れていました。<br>
例えば開発機であるXperiaZUltraであれば <em>1080x1824</em> としていい感じに使えます。<br>
これが1.7だとデフォルトで <em>640x480</em> になってしまうようです。<br>
仕方ないので以下のコードのようにアプリ起動時に必ず通るページでサイズを取るように変えたところ、<em>540x887</em> が取れました。<br>
Xamarin上のサイズとCocosSharp上のサイズでは何か異なってしまうようです。<br>
見た感じ、ちょうど半分になっていたのでその辺りにカラクリが…？</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">StartUpPage.xaml.cs</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">StartUpPage</span> <span class="p">:</span> <span class="n">ContentPage</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">StartUpPage</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnSizeAllocated</span><span class="p">(</span><span class="kt">double</span> <span class="n">width</span><span class="p">,</span> <span class="kt">double</span> <span class="n">height</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnSizeAllocated</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
            <span class="n">Helpers</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">AppWidth</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">width</span><span class="p">;</span>
            <span class="n">Helpers</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">AppHeight</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">height</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="非同期で動かなくなったぜ" class="fragment"></span><a href="#%E9%9D%9E%E5%90%8C%E6%9C%9F%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C"><i class="fa fa-link"></i></a>非同期で動かなくなったぜ！</h2>

<p>1.6実装時には、あちこちでAsync処理を書いていました。<br>
例えば、各Layerの親となる基底クラスを作り、Baseでヘッダー・フッターのコンテンツ表示処理。<br>
各Layer独自の表示コンテンツはabstractメソッドをAsync呼び出しする形で実装していました。（下記参照）<br>
それらは、動かなくなりました。動かなくなりました！！<br>
　※根本的に問題のあるコードだったのかもしれませんが、1.7に移行する前は動いていたモノです。</p>

<p>↓こんな感じ。どっかでデッドロックしてたんだろうなぁ…</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">BaseLayer.cs</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">BaseLayer</span> <span class="p">:</span> <span class="n">CCLayerColor</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">AddedToScene</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">AddedToScene</span><span class="p">();</span>

            <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="nf">WhenAll</span><span class="p">(</span><span class="nf">InitCommonContentsAsync</span><span class="p">(),</span> <span class="nf">InitLayersContentsAsync</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="n">Task</span> <span class="nf">InitCommonContentsAsync</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">task1</span> <span class="p">=</span> <span class="nf">LoadSpriteAsync</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">task2</span> <span class="p">=</span> <span class="nf">CreateHeaderAsync</span><span class="p">().</span><span class="nf">ContinueWith</span><span class="p">(</span><span class="k">async</span> <span class="n">t</span> <span class="p">=&gt;</span> <span class="n">DisplayHeader</span> <span class="p">=</span> <span class="k">await</span> <span class="n">t</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">task3</span> <span class="p">=</span> <span class="nf">CreateFooterAsync</span><span class="p">().</span><span class="nf">ContinueWith</span><span class="p">(</span><span class="k">async</span> <span class="n">t</span> <span class="p">=&gt;</span> <span class="n">DisplayFooter</span> <span class="p">=</span> <span class="k">await</span> <span class="n">t</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">task4</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Task</span><span class="p">(()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">height</span> <span class="p">=</span> <span class="n">DisplayHeight</span><span class="p">;</span>
                <span class="n">height</span> <span class="p">-=</span> <span class="n">DisplayHeader</span><span class="p">;</span>
                <span class="n">height</span> <span class="p">-=</span> <span class="n">DisplayFooter</span><span class="p">;</span>
                <span class="n">CenteringPosition</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CCPoint</span><span class="p">(</span><span class="n">DisplayCenter</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="n">DisplayFooter</span> <span class="p">+</span> <span class="n">height</span> <span class="p">/</span> <span class="m">2</span><span class="p">);</span>
            <span class="p">});</span>

            <span class="k">return</span> <span class="n">Task</span><span class="p">.</span><span class="nf">WhenAll</span><span class="p">(</span><span class="n">task1</span><span class="p">,</span> <span class="n">task2</span><span class="p">,</span> <span class="n">task3</span><span class="p">).</span><span class="nf">ContinueWith</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span> <span class="n">task4</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">abstract</span> <span class="n">Task</span> <span class="nf">InitLayersContentsAsync</span><span class="p">();</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<p>仕方ないので一旦Async処理を諦め、全て同期コードに書き換えたことで動くようにはなりました。<br>
また、AzureMobileServiceを使っている部分でAsync呼び出ししかサポートしていない場所は、ラッパーを噛ませて同期処理にしています。<br>
<a href="http://gooner.hateblo.jp/entry/2015/10/27/httpclient/" rel="nofollow noopener" target="_blank">同期版のメソッドを実装する</a></p>

<p>上記以外にも、CCSpriteを作る過程でCCTexture2Dのインスタンスを作る部分があったんですが、非同期コードだとそこで止まっちゃうこともありました。<br>
CCTexture2Dのコンストラクタで何やってるかまでは追ってないんですが、闇が深いようです…</p>

<h2>
<span id="なんだかstaticなccspriteが壊れるぜ" class="fragment"></span><a href="#%E3%81%AA%E3%82%93%E3%81%A0%E3%81%8Bstatic%E3%81%AAccsprite%E3%81%8C%E5%A3%8A%E3%82%8C%E3%82%8B%E3%81%9C"><i class="fa fa-link"></i></a>なんだかStaticなCCSpriteが壊れるぜ！</h2>

<p>元々、ゲーム内で使う汎用的なCCSpriteインスタンスは読み込みごとにStaticなメンバに保持し、使い回しをしていました。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">CommonImages.cs</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">CommonImages</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">static</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">CCSprite</span><span class="p">&gt;</span> <span class="n">_CommonImagesCache</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">CCSprite</span><span class="p">&gt;</span> <span class="n">CommonImagesCache</span> <span class="p">=&gt;</span> <span class="n">_CommonImagesCache</span> <span class="p">??</span> <span class="p">(</span><span class="n">_CommonImagesCache</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">CCSprite</span><span class="p">&gt;());</span>

        <span class="k">public</span> <span class="n">CCSprite</span> <span class="nf">Get</span><span class="p">(</span><span class="n">Enum</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">CommonImagesCache</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidOperationException</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">CommonImagesCache</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">ToKey</span><span class="p">()))</span>
                <span class="c1">//GameImageLoader.GetSpriteはAssemblyからpng読み出してCCSpriteインスタンスを作り返すメソッド</span>
                <span class="n">CommonImagesCache</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">ToKey</span><span class="p">(),</span> <span class="n">GameImageLoader</span><span class="p">.</span><span class="nf">GetSprite</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">ToName</span><span class="p">()));</span>

            <span class="k">return</span> <span class="n">CommonImagesCache</span><span class="p">[</span><span class="n">key</span><span class="p">.</span><span class="nf">ToKey</span><span class="p">()];</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<p>これでゲーム内での使い回しはいい感じに動くんですが、Androidの戻るボタンやゲーム終了処理などをしてから再度ゲーム画面を開くと、壊れます。<br>
　※Staticで使いまわすのがベストプラクティスなのか、バッドノウハウなのかはこの際ご勘弁を。。<br>
壊れ方がまた面白いんですが、CCSpriteの配置エリアに全然関係ないCCLabelに設定したTextが白抜きで間延びして入ったりします。<br>
　※プロダクトコードのスクショを見せられないのが実に惜しい可笑しさです<br>
　<br>
で回避作としてゲーム終了時にStaticメンバへNull代入することで二度目の起動時に正しい動作となりました。いいのか？</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">IRelease</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">void</span> <span class="nf">Release</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_CommonImagesCache</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="イベントが効かなくなったぜ" class="fragment"></span><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%8C%E5%8A%B9%E3%81%8B%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C"><i class="fa fa-link"></i></a>イベントが効かなくなったぜ！</h2>

<p>これまた不思議な動きですが、基底クラスに仕込んだTouchイベントが突然動かなくなります。困ります。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">BaseLayer.cs</span></div>
<div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">BaseLayer</span> <span class="p">:</span> <span class="n">CCLayerColor</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="nf">BaseLayer</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Color</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CCColor3B</span><span class="p">(</span><span class="m">236</span><span class="p">,</span> <span class="m">236</span><span class="p">,</span> <span class="m">236</span><span class="p">);</span>
            <span class="n">Opacity</span> <span class="p">=</span> <span class="m">255</span><span class="p">;</span>

            <span class="kt">var</span> <span class="n">touchListener</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CCEventListenerTouchAllAtOnce</span> <span class="p">{</span> <span class="n">OnTouchesEnded</span> <span class="p">=</span> <span class="n">Touch</span> <span class="p">};</span>
            <span class="nf">AddEventListener</span><span class="p">(</span><span class="n">touchListener</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">abstract</span> <span class="k">void</span> <span class="nf">Touch</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">CCTouch</span><span class="p">&gt;</span> <span class="n">touches</span><span class="p">,</span> <span class="n">CCEvent</span> <span class="n">ccevent</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div>
</div>

<p>これ↑で各Layerでのタップ処理を実装していたんですが、数画面遷移すると突然Touchが反応しなくなります。<br>
もちろん上記コードのAddEventListenerが通っていることは確認済み。<br>
現時点で絶賛ハマり中。解決しねぇぇぇぇぇぇ</p>

<p><em>--- 2016/12/21 追記 ここから ---</em><br>
どうやら元々の処理にバグが有り、マイグレーションを行ったことで顕著化したようです。<br>
<code>ReplaceScene</code>メソッドを<code>Schedule</code>メソッドに仕込み、タイムオーバーで自動的に画面遷移する機構を作っていました。<br>
Touchイベントを拾うメソッドが画面遷移の刹那のタイミングで動いたときに、本来入るべきフローではないためNullReが発生し、それが原因で以降のTouchイベントが拾われなくなってしまったようです。<br>
　※正誤問題系の画面で、誤タップは残時間減という仕様のため、早く画面遷移させるために連打していたことで発現<br>
<code>NullReExcep</code>とか<code>UnHandledExcep</code>とか出してくれれば分かりやすいんですが、見た目上は何も出ないんですよね…。<br>
関連するかどうかわからなかったんですが、デバッグログを見ると以下のエラーが出ており、ネットの海によるとUIスレッドと非同期処理と画面描写と～という情報もありました。<br>
　※画面遷移が行われている途中でTouch処理がされて、その中でエラーが起きたから画面描写関連のエラーが発生した…？<br>
　　にしては画面遷移はちゃんと行われていたんだけど…</p>

<div class="code-frame" data-lang="logos">
<div class="code-lang"><span class="bold">出力-デバッグ</span></div>
<div class="highlight"><pre><code>12-21 18:52:09.413 W/Adreno-EGL(19173): &lt;qeglDrvAPI_eglMakeCurrent:3037&gt;: EGL_BAD_ACCESS
12-21 18:52:09.413 E/libEGL  (19173): eglMakeCurrent:792 error 3002 (EGL_BAD_ACCESS)
</code></pre></div>
</div>

<p>いずれにせよ、一旦イベント動かない問題は解決したので先に進む～んだ！<br>
<em>--- 2016/12/21 追記 ここまで ---</em></p>

<h1>
<span id="最後に" class="fragment"></span><a href="#%E6%9C%80%E5%BE%8C%E3%81%AB"><i class="fa fa-link"></i></a>最後に</h1>

<p>これから始める人は、問答無用で1.7にしましょう。<br>
1.6時代のCocosSharp公式サンプルは、<strong>アプリの起動＝ゲームの起動</strong>、<strong>ゲームの終了＝アプリの終了</strong>という前提のようです。<br>
私のようにXamarinFormsと組み合わせてコンテンツの一つとしてゲームを入れ込もうと思うと…（<em>iOS向けには</em>）できません。。<br>
Androidのみであればゲームの終了でActivity殺してIntent発行すればそれっぽく動くので、できないことはないでしょう。<br>
　※が、それってXamarin使った意味あんのって話。</p>

<p>それでは年末まで引き続き楽しいプログラミングライフを！<br>
<del>クリスマスとか関係ないしね</del></p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FShikaTech%2Fitems%2F498c69d7bc92a7424061&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FShikaTech%2Fitems%2F498c69d7bc92a7424061&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/ShikaTech/items/498c69d7bc92a7424061/likers" class="css-1iupg5d">8</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">1</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/498c69d7bc92a7424061/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/ShikaTech/items/498c69d7bc92a7424061/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/ShikaTech/items/498c69d7bc92a7424061/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/ShikaTech/items/498c69d7bc92a7424061/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/ShikaTech/items/498c69d7bc92a7424061.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-e75fbd0e-d12a-4f2e-91ec-3aab6b52ab2c">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-e774adb4-96e2-45ee-9040-2420a22de15b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-e774adb4-96e2-45ee-9040-2420a22de15b">{}</script>
      
<div id="LoginModal-react-component-9f1591ec-548d-4867-b140-01cb23e39d19"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-9f1591ec-548d-4867-b140-01cb23e39d19">{}</script>
      
<div id="StockModal-react-component-3351dbfd-3015-4397-b4bb-9acca25cf6bc"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-3351dbfd-3015-4397-b4bb-9acca25cf6bc">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;j/w624XPg+OO1tjT42/MC7gAA/HbhPpxyS6qkUvcTQ75/byHcstTucH3nDfQ/LfDKg/VHnvvB454x5InXmr69w==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003cstrong\u003e2016/12/21 追記 イベントが動かなくなる件が解決しました！！\u003c/strong\u003e\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e初のAdvent Calendar！\u003cbr\u003e\nなんとか間に合ったー\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"事の始まり\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BA%8B%E3%81%AE%E5%A7%8B%E3%81%BE%E3%82%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e事の始まり\u003c/h1\u003e\n\n\u003cp\u003e私が現在参加しているベンチャー企業では、Xamarinを使ったAndroid/iPhone向けのマルチプラットフォームアプリを作成しています。\u003cbr\u003e\nその中のコンテンツの一つとしてCocosSharpを使ったゲームがあり、\u003cstrong\u003eAndroidではほぼ完成\u003c/strong\u003eしていました。\u003cbr\u003e\nところで\u003cstrong\u003eiOS向けにビルドしたところ、ゲーム終了時にXamarinForms側に戻ってこれない\u003c/strong\u003eという事象が発生しました。\u003cbr\u003e\n　※CCApplication.ExitGameすると画面が真っ暗になって一切の操作を受け付けない状態に\u003cbr\u003e\nそこでTwitterで助けを求めたところCocosSharp第一人者の\u003ca href=\"/hiro128_777\" class=\"user-mention js-hovercard\" title=\"hiro128_777\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"hiro128_777\"\u003e@hiro128_777\u003c/a\u003eさんからアドバイスを頂き、CocosSharpの1.6系から1.7系へと移行する果てしない旅が始まったのです。\u003c/p\u003e\n\n\u003cp\u003eその時の魂の叫びと天の助け。\u003cbr\u003e\n\u003ca href=\"https://twitter.com/ShikaTech/status/807209104917680128\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://twitter.com/ShikaTech/status/807209104917680128\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"いきなりのゴメンナサイ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%84%E3%81%8D%E3%81%AA%E3%82%8A%E3%81%AE%E3%82%B4%E3%83%A1%E3%83%B3%E3%83%8A%E3%82%B5%E3%82%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eいきなりのゴメンナサイ\u003c/h1\u003e\n\n\u003cp\u003e12/16時点でプロダクトコードの\u003cstrong\u003eマイグレーションは未完了\u003c/strong\u003eであり、毎日ズブズブと沼にハマっていく有様です。マジ溺れ死ぬ。\u003cbr\u003e\n本記事ではサンプルコードをネタに1.6から1.7への移行を促しつつ、私が直面した問題を赤裸々に公開したいと思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"16-to-17\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#16-to-17\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1.6 to 1.7\u003c/h1\u003e\n\n\u003cp\u003e大前提として、PCL/Android/iOSの組み合わせでプロジェクトを作成し、CocosSharp.PCL 1.6がインストールされているものとします。\u003cbr\u003e\nまた、1.6およびXamarinFormsでの基本的な開発経験があるものとします。\u003cbr\u003e\n\u003ca href=\"https://github.com/mono/cocos-sharp-samples\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCocosSharpの公式サンプルはこちら\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"前準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前準備\u003c/h2\u003e\n\n\u003cp\u003eNugetより、CocosSharp.Formsをインストールしてください。\u003cbr\u003e\nその過程でCocosSharp（無印）がインストールされます。\u003cbr\u003e\nさらにその過程で、CocosSharp.PCLがパッケージから消えてなくなるはずです。\u003cbr\u003e\n　※ただしNugetパッケージマネージャで見ると居る…とりあえず動けばいいので見て見ぬふり。。\u003cbr\u003e\nまた、1.7のGetting Startページも一通り目を通しておくと理解が深まります。\u003cbr\u003e\n\u003ca href=\"https://developer.xamarin.com/guides/xamarin-forms/advanced/cocossharp/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUsing CocosSharp in Xamarin.Forms\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/03ecb065f48f51a9aa7e6c7cbd8cbbdb3fff5055/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f37383838302f61616632383932302d663863312d623265312d343062362d3763353266326438333338642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F78880%2Faaf28920-f8c1-b2e1-40b6-7c52f2d8338d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=946b1b02136bbc073af809428e19805a\" alt=\"image\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/78880/aaf28920-f8c1-b2e1-40b6-7c52f2d8338d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F78880%2Faaf28920-f8c1-b2e1-40b6-7c52f2d8338d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5e1489714aaabbb98b4cb361de3302cb 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"起動方法を変更\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%B5%B7%E5%8B%95%E6%96%B9%E6%B3%95%E3%82%92%E5%A4%89%E6%9B%B4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e起動方法を変更\u003c/h2\u003e\n\n\u003cp\u003e1.6系では\u003ccode\u003eCCApplication\u003c/code\u003e,\u003ccode\u003eCCApplicationDelegate\u003c/code\u003eあたりを使っていたと思いますが、これらはなくなりました。\u003cbr\u003e\n　※IGameは起動終了用のインタフェースと読み替えてください\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"旧コード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%97%A7%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e旧コード\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eiOS側開始終了コード\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eGame\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIGame\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eDevice\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"iOS\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eCCApplication\u003c/span\u003e \u003cspan class=\"n\"\u003eGameApplication\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGameApplication\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCCApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGameApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplicationDelegate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eGameDelegate\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGameApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartGame\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGameApplication\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eGameApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExitGame\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAndroid側開始終了コード\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eGameService\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIGame\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eDevice\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Droid\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eintent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eIntent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eForms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etypeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMainActivity\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eActivityFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eClearTop\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eActivityFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePreviousIsTop\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eForms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartActivity\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eintent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eIntent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eForms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etypeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGameActivity\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eActivityFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNewTask\u003c/span\u003e               \u003cspan class=\"c1\"\u003e// Activity以外からActivityを呼び出すのに必須\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eActivityFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNoHistory\u003c/span\u003e           \u003cspan class=\"c1\"\u003e// スタックに登録しない\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eActivityFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eExcludeFromRecents\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 最近使ったアプリの一覧に表示しない\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eForms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartActivity\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAndroid側GameActivityクラス\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eGameActivity\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eAndroidGameActivity\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eCCApplication\u003c/span\u003e \u003cspan class=\"n\"\u003eGmaeApplication\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBundle\u003c/span\u003e \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ebase\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eGmaeApplication\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCCApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGmaeApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eApplicationDelegate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eGameDelegate\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eSetContentView\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGmaeApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAndroidContentView\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGmaeApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStartGame\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGameDelegate.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eGameDelegate\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eCCApplicationDelegate\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eCCWindow\u003c/span\u003e \u003cspan class=\"n\"\u003eSharedWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eApplicationDidFinishLaunching\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCCApplication\u003c/span\u003e \u003cspan class=\"n\"\u003eapplication\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCCWindow\u003c/span\u003e \u003cspan class=\"n\"\u003emainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eapplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContentRootDirectory\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Content\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eapplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContentSearchPaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"images\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//ゲームの起点画面に遷移\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003escene\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eLayers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGameStartLayer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetScene\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunWithScene\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003escene\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"新コード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B0%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e新コード\u003c/h3\u003e\n\n\u003cp\u003eXamarin.Formsの１ページとして作ったXamlページにCocosSharpViewを配置するイメージ\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eBattlePage.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBattlePage\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eContentPage\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eBattlePage\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003egameView\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCocosSharpView\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eHorizontalOptions\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eLayoutOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFillAndExpand\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eVerticalOptions\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eLayoutOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFillAndExpand\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eViewCreated\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003egv\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eCCGameView\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e//Helpersはアプリ内でGlobalに使いまわす自作ヘルパ\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003egv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDesignResolution\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCCSizeI\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003egv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResolutionPolicy\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCCViewResolutionPolicy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eShowAll\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e       \n                    \u003cspan class=\"n\"\u003egv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunWithScene\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGameStartLayer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetScene\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egv\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egameView\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnBackButtonPressed\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//戻るボタン無効化するならfalse\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ebase\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnBackButtonPressed\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ccapplicationは死んだccgameviewだ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ccapplication%E3%81%AF%E6%AD%BB%E3%82%93%E3%81%A0ccgameview%E3%81%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCCApplicationは死んだ！CCGameViewだ！！\u003c/h2\u003e\n\n\u003cp\u003e起動方法の変更にある通り、CCApplicationは使わなくなりました。\u003cbr\u003e\nこれは何も考えずに消してOKなので、ガツッとSearch \u0026amp; Destroyしちゃいましょう！\u003c/p\u003e\n\n\u003cp\u003eまた、各Layerで引数に取るCCWindowがCCGameViewに変更となりますので、こっちもガツッと置換してください。\u003cbr\u003e\n　\u003ccode\u003eGetScene(CCWindow mainWindow\u003c/code\u003e → \u003ccode\u003eGetScene(CCGameView mainWindow\u003c/code\u003e\u003cbr\u003e\n無意識的に使っているであろうプロパティも置換対象です\u003cbr\u003e\n　\u003ccode\u003e.GetScene(Window\u003c/code\u003e → \u003ccode\u003e.GetScene(GameView\u003c/code\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"困るぜ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9B%B0%E3%82%8B%E3%81%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e困るぜ！\u003c/h1\u003e\n\n\u003cp\u003eここまでで、ひとまずビルドは通るようになったかと思います！\u003cbr\u003e\n…が、そうは問屋が卸しません。。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サイズがおかしくなったぜ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%8C%E3%81%8A%E3%81%8B%E3%81%97%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサイズがおかしくなったぜ！\u003c/h2\u003e\n\n\u003cp\u003e1.6のCocosSharpでは特に何も考えなくても、AddedToSceneが終わったタイミングの\u003ccode\u003eVisibleBoundsWorldspace.Size\u003c/code\u003eで表示領域のサイズが取れていました。\u003cbr\u003e\n例えば開発機であるXperiaZUltraであれば \u003cem\u003e1080x1824\u003c/em\u003e としていい感じに使えます。\u003cbr\u003e\nこれが1.7だとデフォルトで \u003cem\u003e640x480\u003c/em\u003e になってしまうようです。\u003cbr\u003e\n仕方ないので以下のコードのようにアプリ起動時に必ず通るページでサイズを取るように変えたところ、\u003cem\u003e540x887\u003c/em\u003e が取れました。\u003cbr\u003e\nXamarin上のサイズとCocosSharp上のサイズでは何か異なってしまうようです。\u003cbr\u003e\n見た感じ、ちょうど半分になっていたのでその辺りにカラクリが…？\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eStartUpPage.xaml.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eStartUpPage\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eContentPage\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eStartUpPage\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnSizeAllocated\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003edouble\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003edouble\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ebase\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOnSizeAllocated\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppWidth\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eHelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAppHeight\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"非同期で動かなくなったぜ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%9D%9E%E5%90%8C%E6%9C%9F%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e非同期で動かなくなったぜ！\u003c/h2\u003e\n\n\u003cp\u003e1.6実装時には、あちこちでAsync処理を書いていました。\u003cbr\u003e\n例えば、各Layerの親となる基底クラスを作り、Baseでヘッダー・フッターのコンテンツ表示処理。\u003cbr\u003e\n各Layer独自の表示コンテンツはabstractメソッドをAsync呼び出しする形で実装していました。（下記参照）\u003cbr\u003e\nそれらは、動かなくなりました。動かなくなりました！！\u003cbr\u003e\n　※根本的に問題のあるコードだったのかもしれませんが、1.7に移行する前は動いていたモノです。\u003c/p\u003e\n\n\u003cp\u003e↓こんな感じ。どっかでデッドロックしてたんだろうなぁ…\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eBaseLayer.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBaseLayer\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eCCLayerColor\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddedToScene\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ebase\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddedToScene\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhenAll\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eInitCommonContentsAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitLayersContentsAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitCommonContentsAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etask1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eLoadSpriteAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etask2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateHeaderAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eContinueWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayHeader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etask3\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateFooterAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eContinueWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayFooter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etask4\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eheight\u003c/span\u003e \u003cspan class=\"p\"\u003e-=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayHeader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eheight\u003c/span\u003e \u003cspan class=\"p\"\u003e-=\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayFooter\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eCenteringPosition\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCCPoint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayCenter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDisplayFooter\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhenAll\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etask1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etask2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etask3\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eContinueWith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etask4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitLayersContentsAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e仕方ないので一旦Async処理を諦め、全て同期コードに書き換えたことで動くようにはなりました。\u003cbr\u003e\nまた、AzureMobileServiceを使っている部分でAsync呼び出ししかサポートしていない場所は、ラッパーを噛ませて同期処理にしています。\u003cbr\u003e\n\u003ca href=\"http://gooner.hateblo.jp/entry/2015/10/27/httpclient/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e同期版のメソッドを実装する\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e上記以外にも、CCSpriteを作る過程でCCTexture2Dのインスタンスを作る部分があったんですが、非同期コードだとそこで止まっちゃうこともありました。\u003cbr\u003e\nCCTexture2Dのコンストラクタで何やってるかまでは追ってないんですが、闇が深いようです…\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"なんだかstaticなccspriteが壊れるぜ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AA%E3%82%93%E3%81%A0%E3%81%8Bstatic%E3%81%AAccsprite%E3%81%8C%E5%A3%8A%E3%82%8C%E3%82%8B%E3%81%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eなんだかStaticなCCSpriteが壊れるぜ！\u003c/h2\u003e\n\n\u003cp\u003e元々、ゲーム内で使う汎用的なCCSpriteインスタンスは読み込みごとにStaticなメンバに保持し、使い回しをしていました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eCommonImages.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCommonImages\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCCSprite\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_CommonImagesCache\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCCSprite\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCommonImagesCache\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_CommonImagesCache\u003c/span\u003e \u003cspan class=\"p\"\u003e??\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_CommonImagesCache\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCCSprite\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;());\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eCCSprite\u003c/span\u003e \u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEnum\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCommonImagesCache\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eInvalidOperationException\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"n\"\u003eCommonImagesCache\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToKey\u003c/span\u003e\u003cspan class=\"p\"\u003e()))\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//GameImageLoader.GetSpriteはAssemblyからpng読み出してCCSpriteインスタンスを作り返すメソッド\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eCommonImagesCache\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003eGameImageLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetSprite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToName\u003c/span\u003e\u003cspan class=\"p\"\u003e()));\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eCommonImagesCache\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToKey\u003c/span\u003e\u003cspan class=\"p\"\u003e()];\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれでゲーム内での使い回しはいい感じに動くんですが、Androidの戻るボタンやゲーム終了処理などをしてから再度ゲーム画面を開くと、壊れます。\u003cbr\u003e\n　※Staticで使いまわすのがベストプラクティスなのか、バッドノウハウなのかはこの際ご勘弁を。。\u003cbr\u003e\n壊れ方がまた面白いんですが、CCSpriteの配置エリアに全然関係ないCCLabelに設定したTextが白抜きで間延びして入ったりします。\u003cbr\u003e\n　※プロダクトコードのスクショを見せられないのが実に惜しい可笑しさです\u003cbr\u003e\n　\u003cbr\u003e\nで回避作としてゲーム終了時にStaticメンバへNull代入することで二度目の起動時に正しい動作となりました。いいのか？\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eIRelease\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRelease\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_CommonImagesCache\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"イベントが効かなくなったぜ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%8C%E5%8A%B9%E3%81%8B%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eイベントが効かなくなったぜ！\u003c/h2\u003e\n\n\u003cp\u003eこれまた不思議な動きですが、基底クラスに仕込んだTouchイベントが突然動かなくなります。困ります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eBaseLayer.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBaseLayer\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eCCLayerColor\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nf\"\u003eBaseLayer\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eColor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCCColor3B\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e236\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e236\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e236\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eOpacity\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etouchListener\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eCCEventListenerTouchAllAtOnce\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eOnTouchesEnded\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTouch\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eAddEventListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etouchListener\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTouch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eCCTouch\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etouches\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCCEvent\u003c/span\u003e \u003cspan class=\"n\"\u003eccevent\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれ↑で各Layerでのタップ処理を実装していたんですが、数画面遷移すると突然Touchが反応しなくなります。\u003cbr\u003e\nもちろん上記コードのAddEventListenerが通っていることは確認済み。\u003cbr\u003e\n現時点で絶賛ハマり中。解決しねぇぇぇぇぇぇ\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003e--- 2016/12/21 追記 ここから ---\u003c/em\u003e\u003cbr\u003e\nどうやら元々の処理にバグが有り、マイグレーションを行ったことで顕著化したようです。\u003cbr\u003e\n\u003ccode\u003eReplaceScene\u003c/code\u003eメソッドを\u003ccode\u003eSchedule\u003c/code\u003eメソッドに仕込み、タイムオーバーで自動的に画面遷移する機構を作っていました。\u003cbr\u003e\nTouchイベントを拾うメソッドが画面遷移の刹那のタイミングで動いたときに、本来入るべきフローではないためNullReが発生し、それが原因で以降のTouchイベントが拾われなくなってしまったようです。\u003cbr\u003e\n　※正誤問題系の画面で、誤タップは残時間減という仕様のため、早く画面遷移させるために連打していたことで発現\u003cbr\u003e\n\u003ccode\u003eNullReExcep\u003c/code\u003eとか\u003ccode\u003eUnHandledExcep\u003c/code\u003eとか出してくれれば分かりやすいんですが、見た目上は何も出ないんですよね…。\u003cbr\u003e\n関連するかどうかわからなかったんですが、デバッグログを見ると以下のエラーが出ており、ネットの海によるとUIスレッドと非同期処理と画面描写と～という情報もありました。\u003cbr\u003e\n　※画面遷移が行われている途中でTouch処理がされて、その中でエラーが起きたから画面描写関連のエラーが発生した…？\u003cbr\u003e\n　　にしては画面遷移はちゃんと行われていたんだけど…\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"logos\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e出力-デバッグ\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e12-21 18:52:09.413 W/Adreno-EGL(19173): \u0026lt;qeglDrvAPI_eglMakeCurrent:3037\u0026gt;: EGL_BAD_ACCESS\n12-21 18:52:09.413 E/libEGL  (19173): eglMakeCurrent:792 error 3002 (EGL_BAD_ACCESS)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eいずれにせよ、一旦イベント動かない問題は解決したので先に進む～んだ！\u003cbr\u003e\n\u003cem\u003e--- 2016/12/21 追記 ここまで ---\u003c/em\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"最後に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最後に\u003c/h1\u003e\n\n\u003cp\u003eこれから始める人は、問答無用で1.7にしましょう。\u003cbr\u003e\n1.6時代のCocosSharp公式サンプルは、\u003cstrong\u003eアプリの起動＝ゲームの起動\u003c/strong\u003e、\u003cstrong\u003eゲームの終了＝アプリの終了\u003c/strong\u003eという前提のようです。\u003cbr\u003e\n私のようにXamarinFormsと組み合わせてコンテンツの一つとしてゲームを入れ込もうと思うと…（\u003cem\u003eiOS向けには\u003c/em\u003e）できません。。\u003cbr\u003e\nAndroidのみであればゲームの終了でActivity殺してIntent発行すればそれっぽく動くので、できないことはないでしょう。\u003cbr\u003e\n　※が、それってXamarin使った意味あんのって話。\u003c/p\u003e\n\n\u003cp\u003eそれでは年末まで引き続き楽しいプログラミングライフを！\u003cbr\u003e\n\u003cdel\u003eクリスマスとか関係ないしね\u003c/del\u003e\u003c/p\u003e\n","createdAt":"2016-12-16T14:16:20Z","elapsedYearsFromLastModifiedAt":4,"encryptedId":"yOJMntKuaYkDsX/GZeGeGLdI21FelHa2--h8dwlaOgdtW5c4Zj--2jpDOqNAxbS19U1d36yLWQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2016-12-21T12:11:56Z","likesCount":8,"linkUrl":"https://qiita.com/ShikaTech/items/498c69d7bc92a7424061","organization":null,"originalId":450867,"stockedCount":1,"title":"CocosSharp migration from 1.6 to 1.7","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BA%8B%E3%81%AE%E5%A7%8B%E3%81%BE%E3%82%8A\"\u003e事の始まり\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%84%E3%81%8D%E3%81%AA%E3%82%8A%E3%81%AE%E3%82%B4%E3%83%A1%E3%83%B3%E3%83%8A%E3%82%B5%E3%82%A4\"\u003eいきなりのゴメンナサイ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#16-to-17\"\u003e1.6 to 1.7\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%BA%96%E5%82%99\"\u003e前準備\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%B5%B7%E5%8B%95%E6%96%B9%E6%B3%95%E3%82%92%E5%A4%89%E6%9B%B4\"\u003e起動方法を変更\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%97%A7%E3%82%B3%E3%83%BC%E3%83%89\"\u003e旧コード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%96%B0%E3%82%B3%E3%83%BC%E3%83%89\"\u003e新コード\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ccapplication%E3%81%AF%E6%AD%BB%E3%82%93%E3%81%A0ccgameview%E3%81%A0\"\u003eCCApplicationは死んだ！CCGameViewだ！！\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9B%B0%E3%82%8B%E3%81%9C\"\u003e困るぜ！\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%8C%E3%81%8A%E3%81%8B%E3%81%97%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C\"\u003eサイズがおかしくなったぜ！\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%9D%9E%E5%90%8C%E6%9C%9F%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C\"\u003e非同期で動かなくなったぜ！\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AA%E3%82%93%E3%81%A0%E3%81%8Bstatic%E3%81%AAccsprite%E3%81%8C%E5%A3%8A%E3%82%8C%E3%82%8B%E3%81%9C\"\u003eなんだかStaticなCCSpriteが壊れるぜ！\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%8C%E5%8A%B9%E3%81%8B%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%9C\"\u003eイベントが効かなくなったぜ！\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e最後に\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":1904,"uuid":"498c69d7bc92a7424061","banReason":null,"adventCalendarItem":{"day":16,"calendar":{"name":"Xamarin(その2)","urlName":"xamarin2","year":2016,"organization":null}},"author":{"encryptedId":"FNBnRdH9Oao9+S9YSw3Z4+qbKQw=--pohmy6QrSW/K8bdh--oQLvJm3Vdd3rGgfKl5mJOQ==","originalId":78880,"description":"いわゆる常駐IT戦士としてWEB系をメインに新卒から約10年。\r\nその後フリーランスとして放浪し、とあるベンチャーにジョインして今に至る。\r\n野望は「世界中から感謝される」こと。\r\n\r\nC#,Python,JavaScript/jQuery/HTML5,Xamarin","facebookUrl":null,"githubUrl":"https://github.com/ShikaTech","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"ShikaTech","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/78880/profile-images/1486425343","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F78880%2Fprofile-images%2F1486425343?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=771cefa7faaf1e17f78fe1c081f91309","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F78880%2Fprofile-images%2F1486425343?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=11407fdfd4b8c6afee7b24cd0a66e8a9","urlName":"ShikaTech","websiteUrl":"","twitterUrl":"https://twitter.com/ShikaTech","twitterUrlName":"ShikaTech","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Xamarin","urlName":"xamarin"},{"name":"CocosSharp","urlName":"cocossharp"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
