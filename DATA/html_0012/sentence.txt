以前開発したWPFアプリではCsvHelperの19.0.0を利用していました。
そのとき使っていたコードは以下のような感じ。HasHeaderRecordやRegisterClassMapを使用しています。
処理の内容は、郵便番号辞書のCSVファイルからの読み込みです。調べてみると、ヘッダーの読み込みやマッパーあたりが変わっていたようでした。
ググッて見ると、RegisterClassMapを使うのではなく、ClassMap使ったりといったものがありましたが、それでもエラーが起きたのでもう少し調べると、マッパーではなく、Attributesを使うようでした。変更したらこんな感じでうまくいきましたCSV読み込みで、Configuration.HasHeaderRecordではなく、Read()で読み込みを行い、そのあとでReadHeader()でヘッダーの読み込みを行います。以上でCsvHelperを利用できるようになりました。
しばらく、アップデートをしていないうちに、CsvHelperの使い方がかなり変わっていて、びっくりしました。


