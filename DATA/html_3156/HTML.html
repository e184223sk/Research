<!DOCTYPE html><html><head><meta charset="utf-8" /><title>UnityでRPGを作るpart2 2Dトップビューのマップと衝突判定 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/_tybt/items/0e9605b7acc955078c64" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="1ai+PAfYhP4uWXrrK+BOqz7a1cAHZ8VSwy9YuKTNo1OoRkdhxR+wcZetOtiusRpPM7iFZOzUaEI2+LewqlC0RQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@tyabata32" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="UnityでRPGを作るpart2 2Dトップビューのマップと衝突判定 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhuamdhZFNVRWZqZ3BMa3Zaempnb3R3WVhKME1pQXlST09EaU9PRGctT0RsLU9Eay1PRHBlT0R2T09CcnVPRG51T0RnLU9EbC1PQnFPaWhuZWVxZ2VXSXBPV3VtZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0wYjJlZGQ2MWU5MWI2ZGYwODVmZmI3Y2ZlYjJiN2FkZg&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRjkwZVdKMCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWU3ZjdkMmQyNDc0YTY0Mzg3ZjBhZjRhZjQxYWRhOGFj&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=87edba920d6c16cb1b6b55ccf4a3f96e"><meta property="og:description" content="

はじめに

前回はこちら
UnityでRPGを作るpart1 歩行アニメーションと操作 - Qiita

前回にキャラクターを歩行させるコードを書いたので今回は


2Dマップの作成
作成したマップのオブジェクトに衝突判定を設定す..."><meta content="https://qiita.com/_tybt/items/0e9605b7acc955078c64" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,初心者向け,RPG,衝突判定" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-3e12f85a-4eca-46a4-95b9-cc4875ee7f37"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2F_tybt%2Fitems%2F0e9605b7acc955078c64">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2F_tybt%2Fitems%2F0e9605b7acc955078c64">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-3e12f85a-4eca-46a4-95b9-cc4875ee7f37">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-06-30T14:16:39.000+09:00","dateModified":"2019-09-23T13:11:56.000+09:00","headline":"UnityでRPGを作るpart2 2Dトップビューのマップと衝突判定","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhuamdhZFNVRWZqZ3BMa3Zaempnb3R3WVhKME1pQXlST09EaU9PRGctT0RsLU9Eay1PRHBlT0R2T09CcnVPRG51T0RnLU9EbC1PQnFPaWhuZWVxZ2VXSXBPV3VtZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0wYjJlZGQ2MWU5MWI2ZGYwODVmZmI3Y2ZlYjJiN2FkZg\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRjkwZVdKMCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWU3ZjdkMmQyNDc0YTY0Mzg3ZjBhZjRhZjQxYWRhOGFj\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=87edba920d6c16cb1b6b55ccf4a3f96e","mainEntityOfPage":"https://qiita.com/_tybt/items/0e9605b7acc955078c64","author":{"@type":"Person","address":"Tokyo, Japan","email":null,"identifier":"_tybt","name":"_tybt","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fprofile-images%2F1613519314?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=545a8b2b8781165ee3e67deb9161560c","url":"https://qiita.com/_tybt","description":"しがないエンジニア。楽しくモノづくりがしたい。\r\n静的型付けをしてくれる言語が好きで、愛のない変数名は駆逐する。\r\nゆるい話ははてブに書いてます。もっとゆるいのはtwitterに書いてます。\r\n\r\n落ち着いたらゲーム制作再開したい\r\n","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"_tybt","type":"items","id":"0e9605b7acc955078c64"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"_tybt","type":"items","id":"0e9605b7acc955078c64"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"_tybt","type":"items","id":"0e9605b7acc955078c64"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/_tybt/items/0e9605b7acc955078c64","location":"/_tybt/items/0e9605b7acc955078c64","scheme":"https","host":"qiita.com","port":null,"pathname":"/_tybt/items/0e9605b7acc955078c64","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"Sb0WYLoSCnilRZU6zBB3EecIR92OSLiYwLvqNeRgRTU0U+89eNU+9xyx1QlJQSP16moXeWX7FYg1bAU96v1SIw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-618dcf57-59ab-43c2-9057-bac30b50dafc"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/_tybt/items/0e9605b7acc955078c64/likers" class="css-1iupg5d">34</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">37</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/0e9605b7acc955078c64/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/_tybt/items/0e9605b7acc955078c64/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/_tybt/items/0e9605b7acc955078c64/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/_tybt/items/0e9605b7acc955078c64/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/_tybt/items/0e9605b7acc955078c64.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/_tybt"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/profile-images/1613519314" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/_tybt" class="css-10ougpm">@<!-- -->_tybt</a><div class="css-1ay9vb9"><span><meta content="2019-06-30T05:16:39Z"/><time dateTime="2019-09-23T04:11:56Z" class="css-m19uds">updated at 2019-09-23</time></span></div></div></div></div></div><h1 class="css-cgzq40">UnityでRPGを作るpart2 2Dトップビューのマップと衝突判定</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/%e5%88%9d%e5%bf%83%e8%80%85%e5%90%91%e3%81%91" class="css-4czcte">初心者向け</a><a href="/tags/rpg" class="css-4czcte">RPG</a><a href="/tags/%e8%a1%9d%e7%aa%81%e5%88%a4%e5%ae%9a" class="css-4czcte">衝突判定</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>前回はこちら<br>
<a href="https://qiita.com/_tybt/items/bc9c3be75c04ab547c35" id="reference-084543b01a0c7f115f9b">UnityでRPGを作るpart1 歩行アニメーションと操作 - Qiita</a></p>

<p>前回にキャラクターを歩行させるコードを書いたので今回は</p>

<ul>
<li>2Dマップの作成</li>
<li>作成したマップのオブジェクトに衝突判定を設定する</li>
</ul>

<p>をやっていこうと思います。<br>
ちなみに今回の完成物はこちら。だいぶゲームっぽくなります。<br>
そして今回 <strong>記述するコードの少なさに感動しました</strong> (Unity初心者 雑感)<br>
<a href="https://camo.qiitausercontent.com/b7660df2d99e2d9efaf5195c2008f63280feb97a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f34383732376564342d383035322d623937612d356230392d6533633837386330353361392e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=02360ec86f8c5ed2ab1c12124e512ea3" width="600px" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/48727ed4-8052-b97a-5b09-e3c878c053a9.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=42ee6c0171abf23b4ceb121dfbb441b7 1x" loading="lazy"></a></p>

<p><strong>一応</strong><br>
これは勉強の備忘録として作っていますが、やっぱりこういったいかにもなAssetがStoreで提供されていたりします（便利か。はまだ使ってないのでわかりませんが）<br>
<a href="https://assetstore.unity.com/packages/templates/systems/rpg-map-editor-25657?aid=1011lGbg&amp;utm_source=aff" rel="nofollow noopener" target="_blank">RPG Map Editor - Asset Store</a><br>
さすがみんなのUnity。とりあえず探してみるのもアリです <img alt=":thumbsup:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f44d.png" title=":thumbsup:" width="20" loading="lazy"> </p>

<h1>
<span id="1-2dマップの作製" class="fragment"></span><a href="#1-2d%E3%83%9E%E3%83%83%E3%83%97%E3%81%AE%E4%BD%9C%E8%A3%BD"><i class="fa fa-link"></i></a>1. 2Dマップの作製</h1>

<p>まずは、マップ用の素材を準備します。<br>
さすがにマップの素材を1から作るのはしんどいので、今回はこちらのサイトの素材を利用させていただきます。 <img alt=":pray:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f64f.png" title=":pray:" width="20" loading="lazy"> <br>
<a href="https://pipoya.net/sozai/assets/map-chip_tileset/" rel="nofollow noopener" target="_blank">マップチップ - ぴぽや倉庫</a></p>

<p>画像をDLしたら前回同様に <code>Sprite Editor</code>を利用して、<br>
<code>32x32</code>画像なので、 Sliceでいい感じに設定して画像のように分割します<br>
<a href="https://camo.qiitausercontent.com/db35377fb6626fa3eb800394e132b5211a865025/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f63666265666466372d646234382d386538662d313861622d3632356435353033656537642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fcfbefdf7-db48-8e8f-18ab-625d5503ee7d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5f9315580cd806eb42e96da04860dfff" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/cfbefdf7-db48-8e8f-18ab-625d5503ee7d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fcfbefdf7-db48-8e8f-18ab-625d5503ee7d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=22e4ecaca745aed4387bb0695a6fd770 1x" loading="lazy"></a></p>

<p>で、前回は キャラクターの画像に対して <code>Pixel Per Unit = 1</code>と設定していましたが<br>
今回は、1マス = 1キャラクター に一つのチップをあわせるために<code>32x32</code>画像だから<br>
<strong>Pixel Per Unit = 32</strong>を設定します。</p>

<p>ちなみにこの工程は、RPGツクールのようなタイル状にいろんなマス画像が1枚のファイルになったものを分割するための工程なので、一つずつ読み込む場合などは適宜無視してください。</p>

<h2>
<span id="tilemapとtilepalette" class="fragment"></span><a href="#tilemap%E3%81%A8tilepalette"><i class="fa fa-link"></i></a>TileMapとTilePalette</h2>

<p>RPGツクール触ったことがある人ならわかるだろう…あのマップ編集機能。<br>
マップチップをイラスト編集のように簡単にできるアレですが<br>
<strong>Unityもそれっぽいのあるよ(?)</strong>といことで、TileMapとTilePaletteです。</p>

<p>名前のとおりですが、タイルの画像を設定して、それをマップ上にタイルのように敷き詰めるための機能です。</p>

<p>Sceneに新しく足していきます。<br>
右クリック -&gt; <code>2D Object</code> -&gt; <code>Tilemap</code>で新しいTilemapが追加できます。<br>
<a href="https://camo.qiitausercontent.com/db1fcb5b42c6c2d84b3923cc1f93a184b75952f0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f63613934663266662d653335392d316430392d303865662d3637633965626161303031392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fca94f2ff-e359-1d09-08ef-67c9ebaa0019.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e1a7aa1c6f61218d30a5d9f8efd6989a" width="300px" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/ca94f2ff-e359-1d09-08ef-67c9ebaa0019.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fca94f2ff-e359-1d09-08ef-67c9ebaa0019.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a1e3b0df19144d6827641afcd3c9eb5f 1x" loading="lazy"></a><br>
そうすると、<code>Grid</code>というオブジェクトが追加されてその中に今回編集対象の<code>Tilemap</code>のシーンが追加されています。</p>

<p>次に上部メニュー <code>Window</code> -&gt; <code>2D</code> -&gt; <code>Tile Palette</code>を押すと<br>
いかにもな画面がダイアログで表示されます（画像はパレット追加済みの状態です）</p>

<p><a href="https://camo.qiitausercontent.com/06e67a2a5f821bf4601186d3fd145f86e9ba828d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f31656332663136372d613065372d303838622d626161662d6464656131303836343264362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F1ec2f167-a0e7-088b-baaf-ddea108642d6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=aac5c288106756664864237d2ead1348" width="300px" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/1ec2f167-a0e7-088b-baaf-ddea108642d6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F1ec2f167-a0e7-088b-baaf-ddea108642d6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f06afeb6da62b37953cc6b5b7dc38e2b 1x" loading="lazy"></a></p>

<p>画像の左上に見えるプルダウンを押すと、<code>Create New Palette</code>という項目があるので<br>
押して新しいパレットを作成します。とりあえず設定は下の通り。</p>

<table>
<thead>
<tr>
<th>項目</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>わかりやすければ。</td>
</tr>
<tr>
<td>Grid</td>
<td>Rectangle(default)</td>
</tr>
<tr>
<td>CellSize</td>
<td>Automatic。作成する大きさが決まってるなら設定するぐらいでOKなはず</td>
</tr>
</tbody>
</table>

<p>これで、新しいパレットが作成されます。<br>
後々を考えると、「ダンジョン」「城下町」みたいなくくりでしっかり分けておくと管理しやすいかも？</p>

<p>次に先程 Sprite Editorで分割したマップ画像を Paletteにドラッグ&amp;ドロップすると<br>
タイルを保存するために、保存先のフォルダを指定する画面がでるので<br>
<strong>とりあえず専用のフォルダを作成</strong>して<code>Choose</code>を押します。</p>

<p><a href="https://camo.qiitausercontent.com/c15b7bbaa0d04f1135b5499e821f4ee88030794f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f32353039373936632d396366382d376264382d376161382d3863326235333062353438662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2509796c-9cf8-7bd8-7aa8-8c2b530b548f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=eac96e9ccb69584f18ba842c21c3d2a0" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/2509796c-9cf8-7bd8-7aa8-8c2b530b548f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2509796c-9cf8-7bd8-7aa8-8c2b530b548f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1e5ef00a8aa817a1be0425e18942531f 1x" loading="lazy"></a><br>
こうすると、分割したマップ画像内のそれぞれのタイルが一つの画像としてフォルダに保存されていきます。</p>

<p><strong>補足</strong><br>
パレットにいれたけど、いらない。といった場合は<br>
先程パレット作成時に選んだプルダウンメニューのとなりにある <code>Edit</code>という項目を押すことで<br>
編集ができます。消しゴムを選んで、パレットのタイルを選択すれば消えます。<br>
このあとに行うTilemapの編集時は <code>Edit</code>状態をもう一度押してOFFにしましょう。</p>

<h2>
<span id="tilemapの編集" class="fragment"></span><a href="#tilemap%E3%81%AE%E7%B7%A8%E9%9B%86"><i class="fa fa-link"></i></a>Tilemapの編集</h2>

<p>最初にSceneに用意したTilemapにマップを書いて作成していきましょう。<br>
<a href="https://camo.qiitausercontent.com/64dbba8ca8a44e5552351f77220cc3c2eab2bdc1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f37346530366666342d616162312d333836322d643163332d3530323866653864396430302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F74e06ff4-aab1-3862-d1c3-5028fe8d9d00.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=37d53d0a5f9e4593b27c34420a06a59e" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/74e06ff4-aab1-3862-d1c3-5028fe8d9d00.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F74e06ff4-aab1-3862-d1c3-5028fe8d9d00.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4632fa39bbd56b244e717ec324956730 1x" loading="lazy"></a></p>

<p>雰囲気でわかると思いますが</p>

<ul>
<li>Tile Paletteから書きたいタイルを選択</li>
<li>Tile Palette上部のペンを選択</li>
<li>その下にある<code>Active Tilemap</code>を選択

<ul>
<li>複数のTilemapがある場合は切り替える必要があります</li>
<li>Scene一覧にある方をクリックして選択しても切り替えられます</li>
</ul>
</li>
<li>画面真ん中で思いのままに描いていく</li>
</ul>

<p>だけで、最初に見せた完成形のようなマップが完成します。<br>
ただ、Tilemapが1枚だけでは 草原の地面の上に木を生やすといったことができないので、複数のTileMapを利用していきます。<br>
後々の衝突判定などでも有用になってくるので、次にレイヤーについて説明します。</p>

<h2>
<span id="レイヤーの上下関係を設定する" class="fragment"></span><a href="#%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AE%E4%B8%8A%E4%B8%8B%E9%96%A2%E4%BF%82%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>レイヤーの上下関係を設定する</h2>

<p>前回のキャラ作成では、複数のオブジェクトを扱わなかったのですが、今回からマップとキャラクターを扱うようになるため、単純に追加していくと下のように<strong>キャラクターがマップの後ろに隠れてしまう</strong>という現象に行き当たると思います。</p>

<p><a href="https://camo.qiitausercontent.com/68eda41affa9591325d039b65c05d2d97b17a58d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f64333435636230362d656237662d656531622d363933332d3830613831616266323135372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd345cb06-eb7f-ee1b-6933-80a81abf2157.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=bf7c1a6af1a28e0b5536f2fc8f5872b5" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/d345cb06-eb7f-ee1b-6933-80a81abf2157.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd345cb06-eb7f-ee1b-6933-80a81abf2157.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9a50e582c9b89d0ee887dfcbb90f9638 1x" loading="lazy"></a></p>

<p>そこで、各オブジェクトにレイヤーの位置関係を設定していきます。<br>
現在キャラやマップのオブジェクトには <code>xxx Renderer</code>というComponentがセットされていると思います。</p>

<ul>
<li>キャラ(Sprite) : Sprite Renderer</li>
<li>マップ(Tilemap) : Tilemap Renderer</li>
</ul>

<p>そのComponentに <strong>Sorting Layer</strong>という項目があるので、そこを選択し<br>
<strong>Add Sorting Layer...</strong>という項目をクリックすると下の画像のような画面が表示されます。</p>

<p><a href="https://camo.qiitausercontent.com/745b404234c2e68844668d0603b638e1a237ee51/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f62613636366638312d333237642d353136392d323963322d6564643137613961373032322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fba666f81-327d-5169-29c2-edd17a9a7022.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f91d4a4ffc2e13135679523b74b06737" width="500px" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/ba666f81-327d-5169-29c2-edd17a9a7022.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fba666f81-327d-5169-29c2-edd17a9a7022.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=93618822b63878d2e5e5f7d3457cca82 1x" loading="lazy"></a></p>

<p><code>Sorting Layers</code>の項目の右下にある+を押して、画像のように</p>

<ul>
<li>歩行可能なタイルを配置するレイヤー</li>
<li>移動できない(山や水のような)タイルを配置するレイヤー（後述）</li>
<li>キャラクターが表示されるレイヤー</li>
</ul>

<p>を作成してさきほどの画面に戻り、 <strong>Sorting Layer</strong>からそれぞれの作成したレイヤーを設定しましょう。<br>
これで、キャラクターがマップの上に表示される筈です。</p>

<p><strong>これで、ページ先頭に表示した完成物と同じ見た目になります</strong></p>

<h2>
<span id="歩けるタイルと歩けないタイルを分ける" class="fragment"></span><a href="#%E6%AD%A9%E3%81%91%E3%82%8B%E3%82%BF%E3%82%A4%E3%83%AB%E3%81%A8%E6%AD%A9%E3%81%91%E3%81%AA%E3%81%84%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E5%88%86%E3%81%91%E3%82%8B"><i class="fa fa-link"></i></a>歩けるタイルと歩けないタイルを分ける</h2>

<p>次の項目として説明していく衝突判定の前段階です。<br>
重ねて表示したいタイルがあったりする場合にレイヤーを分けますが、それだけではなく<br>
特定のレイヤーをまるごと衝突判定の対象とすることで、マップの実装が楽になります。</p>

<p>完成物から歩けるTilemapを除くとこのような状態になっています<br>
<a href="https://camo.qiitausercontent.com/9758788023fb95db84fa006bcfa0faae9c6bedcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f39313938303730632d646461612d316632632d323930342d6662303765333932313338662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F9198070c-ddaa-1f2c-2904-fb07e392138f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a28b62ce2189b282ca01637e52da826d" width="500px" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/9198070c-ddaa-1f2c-2904-fb07e392138f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F9198070c-ddaa-1f2c-2904-fb07e392138f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f145184fca8b706a0ec739075d39e119 1x" loading="lazy"></a></p>

<p>衝突判定の設定などは次項。</p>

<h1>
<span id="2-マップに衝突判定を設定していく" class="fragment"></span><a href="#2-%E3%83%9E%E3%83%83%E3%83%97%E3%81%AB%E8%A1%9D%E7%AA%81%E5%88%A4%E5%AE%9A%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%97%E3%81%A6%E3%81%84%E3%81%8F"><i class="fa fa-link"></i></a>2. マップに衝突判定を設定していく</h1>

<p>半分コード。半分Unityな項目です。<br>
マップを作ると「歩けない道」が当然のように作っていくことになるので<br>
ここでは、その設定と衝突判定に伴うキャラクターの操作を制御する実装をしていきます。</p>

<p>やることは <strong>山や川はすすめずにぶつかるようにする。</strong> です</p>

<p>とりあえず <strong>コリジョン</strong> <strong>Collision</strong> という単語を覚えておきましょう。<br>
検索のときに重要です <img alt=":innocent:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png" title=":innocent:" width="20" loading="lazy"> </p>

<h2>
<span id="collider2dを追加する" class="fragment"></span><a href="#collider2d%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Collider2Dを追加する</h2>

<p>キャラやマップのオブジェクトにコンポーネントを足していきます。</p>

<ul>
<li>キャラ(Sprite) : <code>Box Collider 2D</code>
</li>
<li>マップ(Tilemap) : <code>Tilemap Collider 2D</code>
</li>
</ul>

<p>昔ながらのゲーム（というコンセプト)なので衝突判定は厳密にやりません。ので、細かく調整をする必要もありません。<br>
上を追加すると、それぞれ緑色の枠のようなものが表示されます。<br>
以降、この衝突判定領域を示す緑の枠を <strong>Collider</strong>と表記します。</p>

<p>体の上部だけは判定を除いて重なるようにする場合<br>
<code>Box Collider 2D</code>の項目にある <code>Edit Collider</code>というボタンを押して、Colliderの大きさを調整します。<br>
Box Colliderをセットした場合、Spriteの大きさにあわせてColliderが設定されるので、<br>
それを全長の半分に設定した状態が下です。<br>
<a href="https://camo.qiitausercontent.com/bb92fea8f0ab56c93947aa6be5d402bdbf437273/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f36643363356365662d326630352d633435652d363165382d3937333465623236373431372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F6d3c5cef-2f05-c45e-61e8-9734eb267417.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5a6c002b9d0102fda2c626801616ed90" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/6d3c5cef-2f05-c45e-61e8-9734eb267417.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F6d3c5cef-2f05-c45e-61e8-9734eb267417.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5224d172e8be9e9db7f080e0d8745cf4 1x" loading="lazy"></a></p>

<p>マップ(<code>Tilemap Collider 2D</code>)の方はデフォルトで、読み込んだ画像の透明じゃない部分がColliderとして設定されていると思います。</p>

<p><a href="https://camo.qiitausercontent.com/279e83159bf015ef029834cce14763b7a886ddbb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f30633537396639652d343863632d396364662d366162612d3339353762353465306564632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F0c579f9e-48cc-9cdf-6aba-3957b54e0edc.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=db7a3a771036acd5949a06e76711fe6e" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/0c579f9e-48cc-9cdf-6aba-3957b54e0edc.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F0c579f9e-48cc-9cdf-6aba-3957b54e0edc.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8ebd2b178783c0f3bffbc3c36bccf97e 1x" loading="lazy"></a><br>
これはタイルの元になっている画像を選択してinspectorを見ると<br>
<strong>Collider Type</strong>が Spriteになっていると思います。</p>

<p>これを<strong>Grid</strong>に変えると、タイルにあわせた四角の部分がColliderとして設定されます。<br>
この設定を全部変える場合、画像をすべて選択した状態で変更することで一気に切り替えることができます。<br>
改めて編集画面を見ると、タイルにあわせたColliderに変わっていると思います。</p>

<p><a href="https://camo.qiitausercontent.com/a90290d393c037f61dbb0c2a9daa890952edca4a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f35643634616638322d666563662d666635302d396566302d3637396561386339393036372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F5d64af82-fecf-ff50-9ef0-679ea8c99067.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=91f93f4f61d5264a835d5e3d3d248065" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/5d64af82-fecf-ff50-9ef0-679ea8c99067.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F5d64af82-fecf-ff50-9ef0-679ea8c99067.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7f8bc525ee54bd6aad3ecbaa69c0aae4 1x" loading="lazy"></a></p>

<h2>
<span id="rigitbody2dの設定をdynamicにする" class="fragment"></span><a href="#rigitbody2d%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92dynamic%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>RigitBody2Dの設定をDynamicにする</h2>

<p>前回は「昔なつかしいRPGなので」 <code>body type: kinematic</code>に設定していましたが<br>
<strong>Body Type : Kinematicは標準の衝突判定が無効になります</strong></p>

<p>ただDynamicにするだけだと物理演算が有効になってしまい、キャラクターが画面外に落ちていってしまうので<strong>Gravity Scale を 0</strong>にすることで、落ちなくなります<br>
が、これだけでは足りません。</p>

<h3>
<span id="constraintsの設定で回転を止める" class="fragment"></span><a href="#constraints%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%81%A7%E5%9B%9E%E8%BB%A2%E3%82%92%E6%AD%A2%E3%82%81%E3%82%8B"><i class="fa fa-link"></i></a>constraintsの設定で回転を止める</h3>

<p>物理演算自体は有効なため、前述の設定だけだとCollider同士のぶつかったときに力が働いた方向にグルングルン回転することがあります。</p>

<p>あまり正確な図ではないですが、イメージ的には下の通り。<br>
<a href="https://camo.qiitausercontent.com/7785c82ae801d24380c92993104b07402bde978b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f64333566306463312d363239302d303638332d333332362d3730333262323866623962652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd35f0dc1-6290-0683-3326-7032b28fb9be.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=07a7fe1ad19953658bc2d2688d64976f" width="500px" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/d35f0dc1-6290-0683-3326-7032b28fb9be.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd35f0dc1-6290-0683-3326-7032b28fb9be.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=dc68582d90db3b3c143f90d4a102f71f 1x" loading="lazy"></a><br>
とりあえず、なんのコッチャな方もいるかと思いますが、とりあえず書いてあるとおりに実装して完成したら、あとでぜひ試してみてください……カオスですｗ<br>
（下のtweetでは Gravity Scaleが１の状態で見ています）</p>

<blockquote class="twitter-tweet">
<p>サンプルはドラクエ風でやるからBodyType Kinematicにしてたけど、やっぱりコードいじらないとな -&gt; Dynamicで動かしたらどうなるんだ　って思った結果カオスみのある動きになりました <a href="https://t.co/wnSX4KpWlc" rel="nofollow noopener" target="_blank">pic.twitter.com/wnSX4KpWlc</a></p>— とむお (@_tybt) <a href="https://twitter.com/_tybt/status/1144644422375596033?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">2019年6月28日</a>
</blockquote>

<p>そういった回転を抑えるためにコードで <code>Regitbody2D</code>に対して<br>
下記のような設定を行います。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>this.rigidBody.constraints = RigidbodyConstraints2D.FreezeRotation;
</code></pre></div></div>

<p><code>constraints</code> まさに制約ですね<br>
これで、上記のようなクルクルは発生しなくなります。</p>

<p><strong>2019/09/23 追記</strong><br>
コメントご指摘より<br>
UI上でもFreeze Rotationの設定ができるみたいです<br>
設定項目は Rigidbody2Dの下の項目 (確認済み)<br>
<a href="https://camo.qiitausercontent.com/c00d1b1e2136e1b59c06b21a6e3bd6c57453799a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f32616461333035632d666465372d653236302d383966312d3336613535643630316130322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2ada305c-fde7-e260-89f1-36a55d601a02.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6b7944dcb3cb6b1ed3292eeb52a27392" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/2ada305c-fde7-e260-89f1-36a55d601a02.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2ada305c-fde7-e260-89f1-36a55d601a02.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=23b65c5f39f976c945e25ee2da2b2858 1x" loading="lazy"></a></p>

<p>ご指摘ありがとうございました <img alt=":pray:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f64f.png" title=":pray:" width="20" loading="lazy"><br>
<strong>2019/09/23 追記 : ここまで</strong></p>

<p>ソレ以外の設定はこちらをご覧ください。<br>
<a href="https://docs.unity3d.com/ja/current/ScriptReference/RigidbodyConstraints.html" rel="nofollow noopener" target="_blank">RigidbodyConstraints - Unity スクリプトリファレンス</a></p>

<h2>
<span id="コードを書く" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F"><i class="fa fa-link"></i></a>コードを書く</h2>

<p>毎度最後のコードのターンです。今回はゆるっと説明します。<br>
前回からの説明なので、キャラクターにこのクラスはbind済みであるとします。</p>

<p>ここでは前回作った <code>MoveController</code>を修正します<br>
<a href="https://qiita.com/_tybt/items/bc9c3be75c04ab547c35#%E3%82%AD%E3%83%BC%E6%93%8D%E4%BD%9C%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%8B%95%E3%81%8B%E3%81%99%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88" id="reference-084543b01a0c7f115f9b">UnityでRPGを作るpart1 歩行アニメーションと操作 - Qiita</a></p>

<div class="code-frame" data-lang="C#">
<div class="code-lang"><span class="bold">MoveController.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">MoveController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">readonly</span> <span class="kt">float</span> <span class="n">SPEED</span> <span class="p">=</span> <span class="m">0.1f</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Rigidbody2D</span> <span class="n">rigidBody</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Vector2</span> <span class="n">input</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">rigidBody</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;();</span>
        <span class="c1">// 衝突時にobjectを回転させない設定</span>
        <span class="k">this</span><span class="p">.</span><span class="n">rigidBody</span><span class="p">.</span><span class="n">constraints</span> <span class="p">=</span> <span class="n">RigidbodyConstraints2D</span><span class="p">.</span><span class="n">FreezeRotation</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 入力を取得</span>
        <span class="n">input</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span>
            <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Horizontal"</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">.</span><span class="nf">GetAxis</span><span class="p">(</span><span class="s">"Vertical"</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">FixedUpdate</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="p">==</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">zero</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// 既存のポジションに対して、移動量(vector)を加算する</span>
        <span class="n">rigidBody</span><span class="p">.</span><span class="n">position</span> <span class="p">+=</span> <span class="n">input</span> <span class="p">*</span> <span class="n">SPEED</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p><strong>Unity先輩強すぎませんか？</strong></p>

<p>…すいませんちょっと感動しました。なぜかというと<br>
<strong>「衝突判定されたら、座標を戻す」</strong>的な処理を一切かかなくていいみたいです。<br>
上のコードだけで次のように「山や川にぶつかったら移動させない」みたいな動きができます。</p>

<h1>
<span id="完成物確認" class="fragment"></span><a href="#%E5%AE%8C%E6%88%90%E7%89%A9%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>完成物確認</h1>

<p><a href="https://camo.qiitausercontent.com/b7660df2d99e2d9efaf5195c2008f63280feb97a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f34383732376564342d383035322d623937612d356230392d6533633837386330353361392e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=02360ec86f8c5ed2ab1c12124e512ea3" width="400px" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/48727ed4-8052-b97a-5b09-e3c878c053a9.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=42ee6c0171abf23b4ceb121dfbb441b7 1x" loading="lazy"></a></p>

<p>ほぼUnityのUI上の設定だけでできました。</p>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<p>Unityってすごいですね（ボキャ貧）</p>

<p>最初は「衝突とみなされたら、コード上で位置を戻す」とかやらなきゃいけないのかと思っていましたが、ソレが不要というのはありがたい。<br>
ただ、この衝突判定のために 2Dトップビューでは不要な物理演算(Dynamic)を有効にして、Gravityを0にしたり回転を無効にしたりやっているので、あとで辛い目をみるかは…今考えても仕方ないので今後発生したら書きます <img alt=":innocent:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png" title=":innocent:" width="20" loading="lazy"> </p>

<p>次は</p>

<ul>
<li>人や宝箱に対してボタンを押したらイベントの実行</li>
<li>アイテム情報の管理</li>
</ul>

<p>的なものでもやっていこうかなと思います。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2F_tybt%2Fitems%2F0e9605b7acc955078c64&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2F_tybt%2Fitems%2F0e9605b7acc955078c64&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/_tybt/items/0e9605b7acc955078c64/likers" class="css-1iupg5d">34</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">37</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/0e9605b7acc955078c64/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/_tybt/items/0e9605b7acc955078c64/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/_tybt/items/0e9605b7acc955078c64/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/_tybt/items/0e9605b7acc955078c64/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/_tybt/items/0e9605b7acc955078c64.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-618dcf57-59ab-43c2-9057-bac30b50dafc">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-d0180458-d61e-45a9-8d9a-4edc9c607e2d"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-d0180458-d61e-45a9-8d9a-4edc9c607e2d">{}</script>
      
<div id="LoginModal-react-component-dfffe9a1-b328-46cd-a78c-0b5dc2277bf3"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-dfffe9a1-b328-46cd-a78c-0b5dc2277bf3">{}</script>
      
<div id="StockModal-react-component-f98e01b2-29db-432a-aedd-7fa052ff19d7"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-f98e01b2-29db-432a-aedd-7fa052ff19d7">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;551kqCQl8C1rWFxtxDs8bV+pUvI43YyPfhM6MTg9IGmac5315uLEotKsHF5BamiJUssCVtNuIZ+LxNU5NqA3fw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e前回はこちら\u003cbr\u003e\n\u003ca href=\"https://qiita.com/_tybt/items/bc9c3be75c04ab547c35\" id=\"reference-084543b01a0c7f115f9b\"\u003eUnityでRPGを作るpart1 歩行アニメーションと操作 - Qiita\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e前回にキャラクターを歩行させるコードを書いたので今回は\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e2Dマップの作成\u003c/li\u003e\n\u003cli\u003e作成したマップのオブジェクトに衝突判定を設定する\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eをやっていこうと思います。\u003cbr\u003e\nちなみに今回の完成物はこちら。だいぶゲームっぽくなります。\u003cbr\u003e\nそして今回 \u003cstrong\u003e記述するコードの少なさに感動しました\u003c/strong\u003e (Unity初心者 雑感)\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/b7660df2d99e2d9efaf5195c2008f63280feb97a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f34383732376564342d383035322d623937612d356230392d6533633837386330353361392e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=02360ec86f8c5ed2ab1c12124e512ea3\" width=\"600px\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/48727ed4-8052-b97a-5b09-e3c878c053a9.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=42ee6c0171abf23b4ceb121dfbb441b7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e一応\u003c/strong\u003e\u003cbr\u003e\nこれは勉強の備忘録として作っていますが、やっぱりこういったいかにもなAssetがStoreで提供されていたりします（便利か。はまだ使ってないのでわかりませんが）\u003cbr\u003e\n\u003ca href=\"https://assetstore.unity.com/packages/templates/systems/rpg-map-editor-25657?aid=1011lGbg\u0026amp;utm_source=aff\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRPG Map Editor - Asset Store\u003c/a\u003e\u003cbr\u003e\nさすがみんなのUnity。とりあえず探してみるのもアリです \u003cimg alt=\":thumbsup:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f44d.png\" title=\":thumbsup:\" width=\"20\" loading=\"lazy\"\u003e \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"1-2dマップの作製\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1-2d%E3%83%9E%E3%83%83%E3%83%97%E3%81%AE%E4%BD%9C%E8%A3%BD\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1. 2Dマップの作製\u003c/h1\u003e\n\n\u003cp\u003eまずは、マップ用の素材を準備します。\u003cbr\u003e\nさすがにマップの素材を1から作るのはしんどいので、今回はこちらのサイトの素材を利用させていただきます。 \u003cimg alt=\":pray:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f64f.png\" title=\":pray:\" width=\"20\" loading=\"lazy\"\u003e \u003cbr\u003e\n\u003ca href=\"https://pipoya.net/sozai/assets/map-chip_tileset/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eマップチップ - ぴぽや倉庫\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e画像をDLしたら前回同様に \u003ccode\u003eSprite Editor\u003c/code\u003eを利用して、\u003cbr\u003e\n\u003ccode\u003e32x32\u003c/code\u003e画像なので、 Sliceでいい感じに設定して画像のように分割します\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/db35377fb6626fa3eb800394e132b5211a865025/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f63666265666466372d646234382d386538662d313861622d3632356435353033656537642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fcfbefdf7-db48-8e8f-18ab-625d5503ee7d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5f9315580cd806eb42e96da04860dfff\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/cfbefdf7-db48-8e8f-18ab-625d5503ee7d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fcfbefdf7-db48-8e8f-18ab-625d5503ee7d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=22e4ecaca745aed4387bb0695a6fd770 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eで、前回は キャラクターの画像に対して \u003ccode\u003ePixel Per Unit = 1\u003c/code\u003eと設定していましたが\u003cbr\u003e\n今回は、1マス = 1キャラクター に一つのチップをあわせるために\u003ccode\u003e32x32\u003c/code\u003e画像だから\u003cbr\u003e\n\u003cstrong\u003ePixel Per Unit = 32\u003c/strong\u003eを設定します。\u003c/p\u003e\n\n\u003cp\u003eちなみにこの工程は、RPGツクールのようなタイル状にいろんなマス画像が1枚のファイルになったものを分割するための工程なので、一つずつ読み込む場合などは適宜無視してください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"tilemapとtilepalette\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tilemap%E3%81%A8tilepalette\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTileMapとTilePalette\u003c/h2\u003e\n\n\u003cp\u003eRPGツクール触ったことがある人ならわかるだろう…あのマップ編集機能。\u003cbr\u003e\nマップチップをイラスト編集のように簡単にできるアレですが\u003cbr\u003e\n\u003cstrong\u003eUnityもそれっぽいのあるよ(?)\u003c/strong\u003eといことで、TileMapとTilePaletteです。\u003c/p\u003e\n\n\u003cp\u003e名前のとおりですが、タイルの画像を設定して、それをマップ上にタイルのように敷き詰めるための機能です。\u003c/p\u003e\n\n\u003cp\u003eSceneに新しく足していきます。\u003cbr\u003e\n右クリック -\u0026gt; \u003ccode\u003e2D Object\u003c/code\u003e -\u0026gt; \u003ccode\u003eTilemap\u003c/code\u003eで新しいTilemapが追加できます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/db1fcb5b42c6c2d84b3923cc1f93a184b75952f0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f63613934663266662d653335392d316430392d303865662d3637633965626161303031392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fca94f2ff-e359-1d09-08ef-67c9ebaa0019.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e1a7aa1c6f61218d30a5d9f8efd6989a\" width=\"300px\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/ca94f2ff-e359-1d09-08ef-67c9ebaa0019.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fca94f2ff-e359-1d09-08ef-67c9ebaa0019.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a1e3b0df19144d6827641afcd3c9eb5f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nそうすると、\u003ccode\u003eGrid\u003c/code\u003eというオブジェクトが追加されてその中に今回編集対象の\u003ccode\u003eTilemap\u003c/code\u003eのシーンが追加されています。\u003c/p\u003e\n\n\u003cp\u003e次に上部メニュー \u003ccode\u003eWindow\u003c/code\u003e -\u0026gt; \u003ccode\u003e2D\u003c/code\u003e -\u0026gt; \u003ccode\u003eTile Palette\u003c/code\u003eを押すと\u003cbr\u003e\nいかにもな画面がダイアログで表示されます（画像はパレット追加済みの状態です）\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/06e67a2a5f821bf4601186d3fd145f86e9ba828d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f31656332663136372d613065372d303838622d626161662d6464656131303836343264362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F1ec2f167-a0e7-088b-baaf-ddea108642d6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=aac5c288106756664864237d2ead1348\" width=\"300px\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/1ec2f167-a0e7-088b-baaf-ddea108642d6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F1ec2f167-a0e7-088b-baaf-ddea108642d6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f06afeb6da62b37953cc6b5b7dc38e2b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e画像の左上に見えるプルダウンを押すと、\u003ccode\u003eCreate New Palette\u003c/code\u003eという項目があるので\u003cbr\u003e\n押して新しいパレットを作成します。とりあえず設定は下の通り。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e項目\u003c/th\u003e\n\u003cth\u003e概要\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eName\u003c/td\u003e\n\u003ctd\u003eわかりやすければ。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGrid\u003c/td\u003e\n\u003ctd\u003eRectangle(default)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCellSize\u003c/td\u003e\n\u003ctd\u003eAutomatic。作成する大きさが決まってるなら設定するぐらいでOKなはず\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eこれで、新しいパレットが作成されます。\u003cbr\u003e\n後々を考えると、「ダンジョン」「城下町」みたいなくくりでしっかり分けておくと管理しやすいかも？\u003c/p\u003e\n\n\u003cp\u003e次に先程 Sprite Editorで分割したマップ画像を Paletteにドラッグ\u0026amp;ドロップすると\u003cbr\u003e\nタイルを保存するために、保存先のフォルダを指定する画面がでるので\u003cbr\u003e\n\u003cstrong\u003eとりあえず専用のフォルダを作成\u003c/strong\u003eして\u003ccode\u003eChoose\u003c/code\u003eを押します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c15b7bbaa0d04f1135b5499e821f4ee88030794f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f32353039373936632d396366382d376264382d376161382d3863326235333062353438662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2509796c-9cf8-7bd8-7aa8-8c2b530b548f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=eac96e9ccb69584f18ba842c21c3d2a0\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/2509796c-9cf8-7bd8-7aa8-8c2b530b548f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2509796c-9cf8-7bd8-7aa8-8c2b530b548f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1e5ef00a8aa817a1be0425e18942531f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nこうすると、分割したマップ画像内のそれぞれのタイルが一つの画像としてフォルダに保存されていきます。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e補足\u003c/strong\u003e\u003cbr\u003e\nパレットにいれたけど、いらない。といった場合は\u003cbr\u003e\n先程パレット作成時に選んだプルダウンメニューのとなりにある \u003ccode\u003eEdit\u003c/code\u003eという項目を押すことで\u003cbr\u003e\n編集ができます。消しゴムを選んで、パレットのタイルを選択すれば消えます。\u003cbr\u003e\nこのあとに行うTilemapの編集時は \u003ccode\u003eEdit\u003c/code\u003e状態をもう一度押してOFFにしましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"tilemapの編集\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tilemap%E3%81%AE%E7%B7%A8%E9%9B%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTilemapの編集\u003c/h2\u003e\n\n\u003cp\u003e最初にSceneに用意したTilemapにマップを書いて作成していきましょう。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/64dbba8ca8a44e5552351f77220cc3c2eab2bdc1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f37346530366666342d616162312d333836322d643163332d3530323866653864396430302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F74e06ff4-aab1-3862-d1c3-5028fe8d9d00.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=37d53d0a5f9e4593b27c34420a06a59e\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/74e06ff4-aab1-3862-d1c3-5028fe8d9d00.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F74e06ff4-aab1-3862-d1c3-5028fe8d9d00.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4632fa39bbd56b244e717ec324956730 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e雰囲気でわかると思いますが\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eTile Paletteから書きたいタイルを選択\u003c/li\u003e\n\u003cli\u003eTile Palette上部のペンを選択\u003c/li\u003e\n\u003cli\u003eその下にある\u003ccode\u003eActive Tilemap\u003c/code\u003eを選択\n\n\u003cul\u003e\n\u003cli\u003e複数のTilemapがある場合は切り替える必要があります\u003c/li\u003e\n\u003cli\u003eScene一覧にある方をクリックして選択しても切り替えられます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e画面真ん中で思いのままに描いていく\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eだけで、最初に見せた完成形のようなマップが完成します。\u003cbr\u003e\nただ、Tilemapが1枚だけでは 草原の地面の上に木を生やすといったことができないので、複数のTileMapを利用していきます。\u003cbr\u003e\n後々の衝突判定などでも有用になってくるので、次にレイヤーについて説明します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"レイヤーの上下関係を設定する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AE%E4%B8%8A%E4%B8%8B%E9%96%A2%E4%BF%82%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eレイヤーの上下関係を設定する\u003c/h2\u003e\n\n\u003cp\u003e前回のキャラ作成では、複数のオブジェクトを扱わなかったのですが、今回からマップとキャラクターを扱うようになるため、単純に追加していくと下のように\u003cstrong\u003eキャラクターがマップの後ろに隠れてしまう\u003c/strong\u003eという現象に行き当たると思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/68eda41affa9591325d039b65c05d2d97b17a58d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f64333435636230362d656237662d656531622d363933332d3830613831616266323135372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd345cb06-eb7f-ee1b-6933-80a81abf2157.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=bf7c1a6af1a28e0b5536f2fc8f5872b5\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/d345cb06-eb7f-ee1b-6933-80a81abf2157.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd345cb06-eb7f-ee1b-6933-80a81abf2157.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9a50e582c9b89d0ee887dfcbb90f9638 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそこで、各オブジェクトにレイヤーの位置関係を設定していきます。\u003cbr\u003e\n現在キャラやマップのオブジェクトには \u003ccode\u003exxx Renderer\u003c/code\u003eというComponentがセットされていると思います。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eキャラ(Sprite) : Sprite Renderer\u003c/li\u003e\n\u003cli\u003eマップ(Tilemap) : Tilemap Renderer\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eそのComponentに \u003cstrong\u003eSorting Layer\u003c/strong\u003eという項目があるので、そこを選択し\u003cbr\u003e\n\u003cstrong\u003eAdd Sorting Layer...\u003c/strong\u003eという項目をクリックすると下の画像のような画面が表示されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/745b404234c2e68844668d0603b638e1a237ee51/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f62613636366638312d333237642d353136392d323963322d6564643137613961373032322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fba666f81-327d-5169-29c2-edd17a9a7022.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f91d4a4ffc2e13135679523b74b06737\" width=\"500px\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/ba666f81-327d-5169-29c2-edd17a9a7022.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fba666f81-327d-5169-29c2-edd17a9a7022.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=93618822b63878d2e5e5f7d3457cca82 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eSorting Layers\u003c/code\u003eの項目の右下にある+を押して、画像のように\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e歩行可能なタイルを配置するレイヤー\u003c/li\u003e\n\u003cli\u003e移動できない(山や水のような)タイルを配置するレイヤー（後述）\u003c/li\u003e\n\u003cli\u003eキャラクターが表示されるレイヤー\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eを作成してさきほどの画面に戻り、 \u003cstrong\u003eSorting Layer\u003c/strong\u003eからそれぞれの作成したレイヤーを設定しましょう。\u003cbr\u003e\nこれで、キャラクターがマップの上に表示される筈です。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eこれで、ページ先頭に表示した完成物と同じ見た目になります\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"歩けるタイルと歩けないタイルを分ける\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AD%A9%E3%81%91%E3%82%8B%E3%82%BF%E3%82%A4%E3%83%AB%E3%81%A8%E6%AD%A9%E3%81%91%E3%81%AA%E3%81%84%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E5%88%86%E3%81%91%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e歩けるタイルと歩けないタイルを分ける\u003c/h2\u003e\n\n\u003cp\u003e次の項目として説明していく衝突判定の前段階です。\u003cbr\u003e\n重ねて表示したいタイルがあったりする場合にレイヤーを分けますが、それだけではなく\u003cbr\u003e\n特定のレイヤーをまるごと衝突判定の対象とすることで、マップの実装が楽になります。\u003c/p\u003e\n\n\u003cp\u003e完成物から歩けるTilemapを除くとこのような状態になっています\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/9758788023fb95db84fa006bcfa0faae9c6bedcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f39313938303730632d646461612d316632632d323930342d6662303765333932313338662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F9198070c-ddaa-1f2c-2904-fb07e392138f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a28b62ce2189b282ca01637e52da826d\" width=\"500px\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/9198070c-ddaa-1f2c-2904-fb07e392138f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F9198070c-ddaa-1f2c-2904-fb07e392138f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f145184fca8b706a0ec739075d39e119 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e衝突判定の設定などは次項。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"2-マップに衝突判定を設定していく\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2-%E3%83%9E%E3%83%83%E3%83%97%E3%81%AB%E8%A1%9D%E7%AA%81%E5%88%A4%E5%AE%9A%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%97%E3%81%A6%E3%81%84%E3%81%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2. マップに衝突判定を設定していく\u003c/h1\u003e\n\n\u003cp\u003e半分コード。半分Unityな項目です。\u003cbr\u003e\nマップを作ると「歩けない道」が当然のように作っていくことになるので\u003cbr\u003e\nここでは、その設定と衝突判定に伴うキャラクターの操作を制御する実装をしていきます。\u003c/p\u003e\n\n\u003cp\u003eやることは \u003cstrong\u003e山や川はすすめずにぶつかるようにする。\u003c/strong\u003e です\u003c/p\u003e\n\n\u003cp\u003eとりあえず \u003cstrong\u003eコリジョン\u003c/strong\u003e \u003cstrong\u003eCollision\u003c/strong\u003e という単語を覚えておきましょう。\u003cbr\u003e\n検索のときに重要です \u003cimg alt=\":innocent:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png\" title=\":innocent:\" width=\"20\" loading=\"lazy\"\u003e \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"collider2dを追加する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#collider2d%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCollider2Dを追加する\u003c/h2\u003e\n\n\u003cp\u003eキャラやマップのオブジェクトにコンポーネントを足していきます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eキャラ(Sprite) : \u003ccode\u003eBox Collider 2D\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eマップ(Tilemap) : \u003ccode\u003eTilemap Collider 2D\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e昔ながらのゲーム（というコンセプト)なので衝突判定は厳密にやりません。ので、細かく調整をする必要もありません。\u003cbr\u003e\n上を追加すると、それぞれ緑色の枠のようなものが表示されます。\u003cbr\u003e\n以降、この衝突判定領域を示す緑の枠を \u003cstrong\u003eCollider\u003c/strong\u003eと表記します。\u003c/p\u003e\n\n\u003cp\u003e体の上部だけは判定を除いて重なるようにする場合\u003cbr\u003e\n\u003ccode\u003eBox Collider 2D\u003c/code\u003eの項目にある \u003ccode\u003eEdit Collider\u003c/code\u003eというボタンを押して、Colliderの大きさを調整します。\u003cbr\u003e\nBox Colliderをセットした場合、Spriteの大きさにあわせてColliderが設定されるので、\u003cbr\u003e\nそれを全長の半分に設定した状態が下です。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/bb92fea8f0ab56c93947aa6be5d402bdbf437273/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f36643363356365662d326630352d633435652d363165382d3937333465623236373431372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F6d3c5cef-2f05-c45e-61e8-9734eb267417.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5a6c002b9d0102fda2c626801616ed90\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/6d3c5cef-2f05-c45e-61e8-9734eb267417.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F6d3c5cef-2f05-c45e-61e8-9734eb267417.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5224d172e8be9e9db7f080e0d8745cf4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eマップ(\u003ccode\u003eTilemap Collider 2D\u003c/code\u003e)の方はデフォルトで、読み込んだ画像の透明じゃない部分がColliderとして設定されていると思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/279e83159bf015ef029834cce14763b7a886ddbb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f30633537396639652d343863632d396364662d366162612d3339353762353465306564632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F0c579f9e-48cc-9cdf-6aba-3957b54e0edc.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=db7a3a771036acd5949a06e76711fe6e\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/0c579f9e-48cc-9cdf-6aba-3957b54e0edc.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F0c579f9e-48cc-9cdf-6aba-3957b54e0edc.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8ebd2b178783c0f3bffbc3c36bccf97e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nこれはタイルの元になっている画像を選択してinspectorを見ると\u003cbr\u003e\n\u003cstrong\u003eCollider Type\u003c/strong\u003eが Spriteになっていると思います。\u003c/p\u003e\n\n\u003cp\u003eこれを\u003cstrong\u003eGrid\u003c/strong\u003eに変えると、タイルにあわせた四角の部分がColliderとして設定されます。\u003cbr\u003e\nこの設定を全部変える場合、画像をすべて選択した状態で変更することで一気に切り替えることができます。\u003cbr\u003e\n改めて編集画面を見ると、タイルにあわせたColliderに変わっていると思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a90290d393c037f61dbb0c2a9daa890952edca4a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f35643634616638322d666563662d666635302d396566302d3637396561386339393036372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F5d64af82-fecf-ff50-9ef0-679ea8c99067.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=91f93f4f61d5264a835d5e3d3d248065\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/5d64af82-fecf-ff50-9ef0-679ea8c99067.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F5d64af82-fecf-ff50-9ef0-679ea8c99067.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7f8bc525ee54bd6aad3ecbaa69c0aae4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"rigitbody2dの設定をdynamicにする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rigitbody2d%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92dynamic%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRigitBody2Dの設定をDynamicにする\u003c/h2\u003e\n\n\u003cp\u003e前回は「昔なつかしいRPGなので」 \u003ccode\u003ebody type: kinematic\u003c/code\u003eに設定していましたが\u003cbr\u003e\n\u003cstrong\u003eBody Type : Kinematicは標準の衝突判定が無効になります\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eただDynamicにするだけだと物理演算が有効になってしまい、キャラクターが画面外に落ちていってしまうので\u003cstrong\u003eGravity Scale を 0\u003c/strong\u003eにすることで、落ちなくなります\u003cbr\u003e\nが、これだけでは足りません。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"constraintsの設定で回転を止める\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#constraints%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%81%A7%E5%9B%9E%E8%BB%A2%E3%82%92%E6%AD%A2%E3%82%81%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003econstraintsの設定で回転を止める\u003c/h3\u003e\n\n\u003cp\u003e物理演算自体は有効なため、前述の設定だけだとCollider同士のぶつかったときに力が働いた方向にグルングルン回転することがあります。\u003c/p\u003e\n\n\u003cp\u003eあまり正確な図ではないですが、イメージ的には下の通り。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/7785c82ae801d24380c92993104b07402bde978b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f64333566306463312d363239302d303638332d333332362d3730333262323866623962652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd35f0dc1-6290-0683-3326-7032b28fb9be.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=07a7fe1ad19953658bc2d2688d64976f\" width=\"500px\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/d35f0dc1-6290-0683-3326-7032b28fb9be.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fd35f0dc1-6290-0683-3326-7032b28fb9be.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=dc68582d90db3b3c143f90d4a102f71f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\nとりあえず、なんのコッチャな方もいるかと思いますが、とりあえず書いてあるとおりに実装して完成したら、あとでぜひ試してみてください……カオスですｗ\u003cbr\u003e\n（下のtweetでは Gravity Scaleが１の状態で見ています）\u003c/p\u003e\n\n\u003cblockquote class=\"twitter-tweet\"\u003e\n\u003cp\u003eサンプルはドラクエ風でやるからBodyType Kinematicにしてたけど、やっぱりコードいじらないとな -\u0026gt; Dynamicで動かしたらどうなるんだ　って思った結果カオスみのある動きになりました \u003ca href=\"https://t.co/wnSX4KpWlc\" rel=\"nofollow noopener\" target=\"_blank\"\u003epic.twitter.com/wnSX4KpWlc\u003c/a\u003e\u003c/p\u003e— とむお (@_tybt) \u003ca href=\"https://twitter.com/_tybt/status/1144644422375596033?ref_src=twsrc%5Etfw\" rel=\"nofollow noopener\" target=\"_blank\"\u003e2019年6月28日\u003c/a\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eそういった回転を抑えるためにコードで \u003ccode\u003eRegitbody2D\u003c/code\u003eに対して\u003cbr\u003e\n下記のような設定を行います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003ethis.rigidBody.constraints = RigidbodyConstraints2D.FreezeRotation;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003econstraints\u003c/code\u003e まさに制約ですね\u003cbr\u003e\nこれで、上記のようなクルクルは発生しなくなります。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e2019/09/23 追記\u003c/strong\u003e\u003cbr\u003e\nコメントご指摘より\u003cbr\u003e\nUI上でもFreeze Rotationの設定ができるみたいです\u003cbr\u003e\n設定項目は Rigidbody2Dの下の項目 (確認済み)\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/c00d1b1e2136e1b59c06b21a6e3bd6c57453799a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f32616461333035632d666465372d653236302d383966312d3336613535643630316130322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2ada305c-fde7-e260-89f1-36a55d601a02.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6b7944dcb3cb6b1ed3292eeb52a27392\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/2ada305c-fde7-e260-89f1-36a55d601a02.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F2ada305c-fde7-e260-89f1-36a55d601a02.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=23b65c5f39f976c945e25ee2da2b2858 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eご指摘ありがとうございました \u003cimg alt=\":pray:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f64f.png\" title=\":pray:\" width=\"20\" loading=\"lazy\"\u003e\u003cbr\u003e\n\u003cstrong\u003e2019/09/23 追記 : ここまで\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eソレ以外の設定はこちらをご覧ください。\u003cbr\u003e\n\u003ca href=\"https://docs.unity3d.com/ja/current/ScriptReference/RigidbodyConstraints.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRigidbodyConstraints - Unity スクリプトリファレンス\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コードを書く\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコードを書く\u003c/h2\u003e\n\n\u003cp\u003e毎度最後のコードのターンです。今回はゆるっと説明します。\u003cbr\u003e\n前回からの説明なので、キャラクターにこのクラスはbind済みであるとします。\u003c/p\u003e\n\n\u003cp\u003eここでは前回作った \u003ccode\u003eMoveController\u003c/code\u003eを修正します\u003cbr\u003e\n\u003ca href=\"https://qiita.com/_tybt/items/bc9c3be75c04ab547c35#%E3%82%AD%E3%83%BC%E6%93%8D%E4%BD%9C%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%8B%95%E3%81%8B%E3%81%99%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88\" id=\"reference-084543b01a0c7f115f9b\"\u003eUnityでRPGを作るpart1 歩行アニメーションと操作 - Qiita\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMoveController.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMoveController\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eSPEED\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.1f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eRigidbody2D\u003c/span\u003e \u003cspan class=\"n\"\u003erigidBody\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eVector2\u003c/span\u003e \u003cspan class=\"n\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erigidBody\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGetComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eRigidbody2D\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 衝突時にobjectを回転させない設定\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erigidBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econstraints\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRigidbodyConstraints2D\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFreezeRotation\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 入力を取得\u003c/span\u003e\n        \u003cspan class=\"n\"\u003einput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eVector2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAxis\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Horizontal\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAxis\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Vertical\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eFixedUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einput\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eVector2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezero\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 既存のポジションに対して、移動量(vector)を加算する\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erigidBody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eposition\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003einput\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSPEED\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eUnity先輩強すぎませんか？\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e…すいませんちょっと感動しました。なぜかというと\u003cbr\u003e\n\u003cstrong\u003e「衝突判定されたら、座標を戻す」\u003c/strong\u003e的な処理を一切かかなくていいみたいです。\u003cbr\u003e\n上のコードだけで次のように「山や川にぶつかったら移動させない」みたいな動きができます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"完成物確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%8C%E6%88%90%E7%89%A9%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e完成物確認\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b7660df2d99e2d9efaf5195c2008f63280feb97a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f33393232392f34383732376564342d383035322d623937612d356230392d6533633837386330353361392e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=02360ec86f8c5ed2ab1c12124e512ea3\" width=\"400px\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/48727ed4-8052-b97a-5b09-e3c878c053a9.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2F48727ed4-8052-b97a-5b09-e3c878c053a9.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=42ee6c0171abf23b4ceb121dfbb441b7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eほぼUnityのUI上の設定だけでできました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eUnityってすごいですね（ボキャ貧）\u003c/p\u003e\n\n\u003cp\u003e最初は「衝突とみなされたら、コード上で位置を戻す」とかやらなきゃいけないのかと思っていましたが、ソレが不要というのはありがたい。\u003cbr\u003e\nただ、この衝突判定のために 2Dトップビューでは不要な物理演算(Dynamic)を有効にして、Gravityを0にしたり回転を無効にしたりやっているので、あとで辛い目をみるかは…今考えても仕方ないので今後発生したら書きます \u003cimg alt=\":innocent:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f607.png\" title=\":innocent:\" width=\"20\" loading=\"lazy\"\u003e \u003c/p\u003e\n\n\u003cp\u003e次は\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e人や宝箱に対してボタンを押したらイベントの実行\u003c/li\u003e\n\u003cli\u003eアイテム情報の管理\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e的なものでもやっていこうかなと思います。\u003c/p\u003e\n","createdAt":"2019-06-30T05:16:39Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"vdFSGYTXAZEN3I1l0tfVo6JcO2gZ5ye6--9yffXxvG1eknW4+i--h3Zm/9tuXUS6smWpncypeA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-09-23T04:11:56Z","likesCount":34,"linkUrl":"https://qiita.com/_tybt/items/0e9605b7acc955078c64","organization":null,"originalId":950245,"stockedCount":37,"title":"UnityでRPGを作るpart2 2Dトップビューのマップと衝突判定","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#1-2d%E3%83%9E%E3%83%83%E3%83%97%E3%81%AE%E4%BD%9C%E8%A3%BD\"\u003e1. 2Dマップの作製\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#tilemap%E3%81%A8tilepalette\"\u003eTileMapとTilePalette\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#tilemap%E3%81%AE%E7%B7%A8%E9%9B%86\"\u003eTilemapの編集\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AE%E4%B8%8A%E4%B8%8B%E9%96%A2%E4%BF%82%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\"\u003eレイヤーの上下関係を設定する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AD%A9%E3%81%91%E3%82%8B%E3%82%BF%E3%82%A4%E3%83%AB%E3%81%A8%E6%AD%A9%E3%81%91%E3%81%AA%E3%81%84%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E5%88%86%E3%81%91%E3%82%8B\"\u003e歩けるタイルと歩けないタイルを分ける\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2-%E3%83%9E%E3%83%83%E3%83%97%E3%81%AB%E8%A1%9D%E7%AA%81%E5%88%A4%E5%AE%9A%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%97%E3%81%A6%E3%81%84%E3%81%8F\"\u003e2. マップに衝突判定を設定していく\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#collider2d%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B\"\u003eCollider2Dを追加する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rigitbody2d%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92dynamic%E3%81%AB%E3%81%99%E3%82%8B\"\u003eRigitBody2Dの設定をDynamicにする\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#constraints%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%81%A7%E5%9B%9E%E8%BB%A2%E3%82%92%E6%AD%A2%E3%82%81%E3%82%8B\"\u003econstraintsの設定で回転を止める\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"\u003eコードを書く\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%8C%E6%88%90%E7%89%A9%E7%A2%BA%E8%AA%8D\"\u003e完成物確認\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":34422,"uuid":"0e9605b7acc955078c64","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"HPgrw7pbqXLbBdIM8EWdsXshaCU=--0JEAZ3jic7GeB9Tn--LU6AE1wzdME1lRFtatSMgw==","originalId":39229,"description":"しがないエンジニア。楽しくモノづくりがしたい。\r\n静的型付けをしてくれる言語が好きで、愛のない変数名は駆逐する。\r\nゆるい話ははてブに書いてます。もっとゆるいのはtwitterに書いてます。\r\n\r\n落ち着いたらゲーム制作再開したい\r\n","facebookUrl":null,"githubUrl":"https://github.com/tyabata","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"とむお","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/39229/profile-images/1613519314","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fprofile-images%2F1613519314?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=774f254414e72ad4792de00928f468ee","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F39229%2Fprofile-images%2F1613519314?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=545a8b2b8781165ee3e67deb9161560c","urlName":"_tybt","websiteUrl":"http://tyabata.hatenablog.com/","twitterUrl":"https://twitter.com/tyabata32","twitterUrlName":"tyabata32","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"初心者向け","urlName":"%e5%88%9d%e5%bf%83%e8%80%85%e5%90%91%e3%81%91"},{"name":"RPG","urlName":"rpg"},{"name":"衝突判定","urlName":"%e8%a1%9d%e7%aa%81%e5%88%a4%e5%ae%9a"}],"followingLikers":{"edges":[]},"comments":{"totalCount":2}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
