<!DOCTYPE html><html><head><meta charset="utf-8" /><title>[C#] Verboseなログ出力を無効化したときのパフォーマンスを100倍速くする - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/diontools/items/69e6df68fb63965019bf" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ztASfHlhE3jzROlWch9em8AVtJkeOv7meXFvMBKhCziCcoIeK4qe4kOUb5eWFrM3hCtRy0mXODXtlubrYhSJzQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@diontools" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="[C#] Verboseなログ出力を無効化したときのパフォーマンスを100倍速くする - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XME1qWFNCV1pYSmliM05sNDRHcTQ0T3Q0NEt3NVllNjVZcWI0NEtTNTRTaDVZcTU1WXlXNDRHWDQ0R2Y0NEdvNDRHTjQ0R3U0NE9SNDRPVjQ0S3A0NE84NDRPZTQ0T3o0NEs1NDRLU01UQXc1WUNONllDZjQ0R1A0NEdaNDRLTCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0wZDBiNDAxY2M1MGI1ZTRjYTE2NGY0ODhmZDNhNWJiYw&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR1JwYjI1MGIyOXNjdyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTZlMzcxNmI4ZjFjZjgxMzI0OTM3ZmZiYjdmN2UzYjVl&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=1fd3c2206bb06e6b477c635dea4c885f"><meta property="og:description" content="C#のnull条件演算子?.を利用して、無効化されたログ出力のオーバーヘッドを回避します。


通常のロガー

よくあるロガーはこんな感じだと思います。

    public static class NormalLogger
  ..."><meta content="https://qiita.com/diontools/items/69e6df68fb63965019bf" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,log,logger,performance" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-455917af-d6ed-4708-bbb9-54dc42bccf0f"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fdiontools%2Fitems%2F69e6df68fb63965019bf">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fdiontools%2Fitems%2F69e6df68fb63965019bf">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-455917af-d6ed-4708-bbb9-54dc42bccf0f">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-12-26T23:28:13.000+09:00","dateModified":"2020-12-26T23:28:13.000+09:00","headline":"[C#] Verboseなログ出力を無効化したときのパフォーマンスを100倍速くする","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XME1qWFNCV1pYSmliM05sNDRHcTQ0T3Q0NEt3NVllNjVZcWI0NEtTNTRTaDVZcTU1WXlXNDRHWDQ0R2Y0NEdvNDRHTjQ0R3U0NE9SNDRPVjQ0S3A0NE84NDRPZTQ0T3o0NEs1NDRLU01UQXc1WUNONllDZjQ0R1A0NEdaNDRLTCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0wZDBiNDAxY2M1MGI1ZTRjYTE2NGY0ODhmZDNhNWJiYw\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR1JwYjI1MGIyOXNjdyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTZlMzcxNmI4ZjFjZjgxMzI0OTM3ZmZiYjdmN2UzYjVl\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=1fd3c2206bb06e6b477c635dea4c885f","mainEntityOfPage":"https://qiita.com/diontools/items/69e6df68fb63965019bf","author":{"@type":"Person","address":null,"email":null,"identifier":"diontools","name":"diontools","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F12995573%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=df457faf4b2c9b0f5536f59c016684d9","url":"https://qiita.com/diontools","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"diontools","type":"items","id":"69e6df68fb63965019bf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"diontools","type":"items","id":"69e6df68fb63965019bf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"diontools","type":"items","id":"69e6df68fb63965019bf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/diontools/items/69e6df68fb63965019bf","location":"/diontools/items/69e6df68fb63965019bf","scheme":"https","host":"qiita.com","port":null,"pathname":"/diontools/items/69e6df68fb63965019bf","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"GqNW7XlajDVnx5ZbKvhGtIxlewuDVv3r4pbny/XalMRWAcaPK7EBr9cXEJrO8asYyFueWdT7Ozh2cW4QhW8WMQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-aa041e09-963f-4b7a-b70d-6d51def85fdd"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/diontools/items/69e6df68fb63965019bf/likers" class="css-1iupg5d">1</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">0</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/69e6df68fb63965019bf/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/diontools/items/69e6df68fb63965019bf/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/diontools/items/69e6df68fb63965019bf/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/diontools/items/69e6df68fb63965019bf/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/diontools/items/69e6df68fb63965019bf.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/diontools"><img class="css-100alwu eyfquo10" src="https://avatars0.githubusercontent.com/u/12995573?v=4" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/diontools" class="css-10ougpm">@<!-- -->diontools</a><div class="css-1ay9vb9"><time dateTime="2020-12-26T14:28:13Z" class="css-m19uds">posted at 2020-12-26</time></div></div></div></div></div><h1 class="css-cgzq40">[C#] Verboseなログ出力を無効化したときのパフォーマンスを100倍速くする</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/log" class="css-4czcte">log</a><a href="/tags/logger" class="css-4czcte">logger</a><a href="/tags/performance" class="css-4czcte">performance</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>C#のnull条件演算子<code>?.</code>を利用して、無効化されたログ出力のオーバーヘッドを回避します。</p>

<h2>
<span id="通常のロガー" class="fragment"></span><a href="#%E9%80%9A%E5%B8%B8%E3%81%AE%E3%83%AD%E3%82%AC%E3%83%BC"><i class="fa fa-link"></i></a>通常のロガー</h2>

<p>よくあるロガーはこんな感じだと思います。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">NormalLogger</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">_enabled</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Init</span><span class="p">(</span><span class="kt">bool</span> <span class="n">enabled</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_enabled</span> <span class="p">=</span> <span class="n">enabled</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Verbose</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="p">[</span><span class="n">CallerMemberName</span><span class="p">]</span> <span class="kt">string</span> <span class="n">memberName</span> <span class="p">=</span> <span class="s">""</span><span class="p">,</span> <span class="p">[</span><span class="n">CallerFilePath</span><span class="p">]</span> <span class="kt">string</span> <span class="n">sourceFilePath</span> <span class="p">=</span> <span class="s">""</span><span class="p">,</span> <span class="p">[</span><span class="n">CallerLineNumber</span><span class="p">]</span> <span class="kt">int</span> <span class="n">sourceLineNumber</span> <span class="p">=</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_enabled</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Trace</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span>
                    <span class="n">sourceFilePath</span>
                    <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">sourceLineNumber</span>
                    <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">memberName</span>
                    <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"yyyy/MM/dd HH:mm:ss.fff"</span><span class="p">)</span>
                    <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">message</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>呼び出し側：</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">NormalLogger</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="k">false</span><span class="p">);</span> <span class="c1">// ログ出力を無効化</span>
<span class="n">NormalLogger</span><span class="p">.</span><span class="nf">Verbose</span><span class="p">(</span><span class="s">"value: "</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span> <span class="c1">// ログ出力</span>
</code></pre></div></div>

<p>これを実行するとログ出力が無効になっているにもかかわらず、<code>"value: " + 1</code>が評価されてしまいます。<br>
<code>"value: " + 1</code>は、int型の数値<code>1</code>をToStringして<code>"value: "</code>文字列と結合する、というそれなりにコストがかかる処理です。<br>
今回はこれを回避します。</p>

<h2>
<span id="改善したロガー" class="fragment"></span><a href="#%E6%94%B9%E5%96%84%E3%81%97%E3%81%9F%E3%83%AD%E3%82%AC%E3%83%BC"><i class="fa fa-link"></i></a>改善したロガー</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="k">public</span> <span class="k">delegate</span> <span class="k">void</span> <span class="nf">LogFunc</span><span class="p">(</span>
        <span class="kt">string</span> <span class="n">message</span><span class="p">,</span>
        <span class="p">[</span><span class="n">CallerMemberName</span><span class="p">]</span> <span class="kt">string</span> <span class="n">memberName</span> <span class="p">=</span> <span class="s">""</span><span class="p">,</span>
        <span class="p">[</span><span class="n">CallerFilePath</span><span class="p">]</span> <span class="kt">string</span> <span class="n">sourceFilePath</span> <span class="p">=</span> <span class="s">""</span><span class="p">,</span>
        <span class="p">[</span><span class="n">CallerLineNumber</span><span class="p">]</span> <span class="kt">int</span> <span class="n">sourceLineNumber</span> <span class="p">=</span> <span class="m">0</span>
    <span class="p">);</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">FastLogger</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">LogFunc</span><span class="p">?</span> <span class="n">Verbose</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Init</span><span class="p">(</span><span class="kt">bool</span> <span class="n">enabled</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Verbose</span> <span class="p">=</span> <span class="n">enabled</span> <span class="p">?</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nf">Write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="p">:</span> <span class="k">null</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Write</span><span class="p">(</span><span class="kt">string</span> <span class="n">msg</span><span class="p">,</span> <span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">string</span> <span class="n">path</span><span class="p">,</span> <span class="kt">int</span> <span class="n">line</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Trace</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span>
                <span class="n">path</span>
                <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">line</span>
                <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">name</span>
                <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"yyyy/MM/dd HH:mm:ss.fff"</span><span class="p">)</span>
                <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">msg</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>呼び出し側：</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">FastLogger</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="k">false</span><span class="p">);</span> <span class="c1">// ログ無効化</span>
<span class="n">FastLogger</span><span class="p">.</span><span class="n">Verbose</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span><span class="s">"value: "</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span> <span class="c1">// ログ出力</span>
</code></pre></div></div>

<p>まず<code>Verbose</code>メソッドを<code>LogFunc</code>デリゲートに置き換えました。そして、呼び出し側にて<code>?.</code>を使用します。<br>
<code>Verbose</code>はデリゲートになったので、<code>?.</code>の後に<code>Invoke</code>メソッドでデリゲートを実行します。（本当は<code>?.()</code>としたいところですが文法上不可能です。）</p>

<p>このコードをコンパイルすると以下のように展開されます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">LogFunc</span> <span class="n">verbose</span> <span class="p">=</span> <span class="n">FastLogger</span><span class="p">.</span><span class="n">Verbose</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">verbose</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">verbose</span><span class="p">(</span><span class="s">"value: "</span> <span class="p">+</span> <span class="m">1</span><span class="p">,</span> <span class="s">"メソッド名"</span><span class="p">,</span> <span class="s">"ファイルパス"</span><span class="p">,</span> <span class="m">10</span><span class="cm">/*行番号*/</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>展開されたコードを見た通り、<code>Verbose</code>がnullの場合は、<code>"value: " + 1</code>も<code>Verbose</code>の呼び出しそのものも回避されます。<br>
絶対速いですよね！！！</p>

<h2>
<span id="ベンチマーク" class="fragment"></span><a href="#%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF"><i class="fa fa-link"></i></a>ベンチマーク</h2>

<p>BenchmarkDotNetでベンチマークしてみます。</p>

<p><details><summary>ベンチマークコード</summary><div>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code>    <span class="p">[</span><span class="n">MemoryDiagnoser</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">GroupBenchmarksBy</span><span class="p">(</span><span class="n">BenchmarkLogicalGroupRule</span><span class="p">.</span><span class="n">ByCategory</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">CategoriesColumn</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">LoggingTest</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">BenchmarkRunner</span><span class="p">.</span><span class="n">Run</span><span class="p">&lt;</span><span class="n">LoggingTest</span><span class="p">&gt;();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Params</span><span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="k">false</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">Enabled</span><span class="p">;</span>

        <span class="p">[</span><span class="n">GlobalSetup</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Setup</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">NormalLogger</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Enabled</span><span class="p">);</span>
            <span class="n">FastLogger</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Enabled</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">),</span> <span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"結合"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Normal</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">NormalLogger</span><span class="p">.</span><span class="nf">Verbose</span><span class="p">(</span><span class="s">"value: "</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Benchmark</span><span class="p">,</span> <span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"結合"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Fast__</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">FastLogger</span><span class="p">.</span><span class="n">Verbose</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span><span class="s">"value: "</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">),</span> <span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"文字列のみ"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">NormalSimple</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">NormalLogger</span><span class="p">.</span><span class="nf">Verbose</span><span class="p">(</span><span class="s">"verbose!"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Benchmark</span><span class="p">,</span> <span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"文字列のみ"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">FastSimple__</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">FastLogger</span><span class="p">.</span><span class="n">Verbose</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span><span class="s">"verbose!"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p></p>
</div></details></p>

<p><code>CallerMemberName</code>の影響を無くすため、<code>Fast__</code>のようにアンダーバーを追加して<code>Normal</code>と同じ文字数になるようにしています。</p>

<h3>
<span id="ベンチマーク結果" class="fragment"></span><a href="#%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF%E7%B5%90%E6%9E%9C"><i class="fa fa-link"></i></a>ベンチマーク結果</h3>

<div class="code-frame" data-lang="ini"><div class="highlight"><pre class="with-code"><code><span class="py">BenchmarkDotNet</span><span class="p">=</span><span class="s">v0.12.1, OS=Windows 8.1 (6.3.9600.0)</span>
<span class="err">Intel</span> <span class="err">Core</span> <span class="err">i7-4770K</span> <span class="err">CPU</span> <span class="err">3.50GHz</span> <span class="err">(Haswell),</span> <span class="err">1</span> <span class="err">CPU,</span> <span class="err">8</span> <span class="err">logical</span> <span class="err">and</span> <span class="err">4</span> <span class="err">physical</span> <span class="err">cores</span>
<span class="py">Frequency</span><span class="p">=</span><span class="s">3410067 Hz, Resolution=293.2494 ns, Timer=TSC</span>
<span class="err">.NET</span> <span class="err">Core</span> <span class="py">SDK</span><span class="p">=</span><span class="s">5.0.101</span>
  <span class="nn">[Host]</span>     <span class="err">:</span> <span class="err">.NET</span> <span class="err">Core</span> <span class="err">5.0.1</span> <span class="err">(CoreCLR</span> <span class="err">5.0.120.57516,</span> <span class="err">CoreFX</span> <span class="err">5.0.120.57516),</span> <span class="err">X64</span> <span class="err">RyuJIT</span>
  <span class="err">DefaultJob</span> <span class="err">:</span> <span class="err">.NET</span> <span class="err">Core</span> <span class="err">5.0.1</span> <span class="err">(CoreCLR</span> <span class="err">5.0.120.57516,</span> <span class="err">CoreFX</span> <span class="err">5.0.120.57516),</span> <span class="err">X64</span> <span class="err">RyuJIT</span>
</code></pre></div></div>

<table>
<thead>
<tr>
<th>Method</th>
<th>Categories</th>
<th>Enabled</th>
<th style="text-align: right">Mean</th>
<th style="text-align: right">Error</th>
<th style="text-align: right">StdDev</th>
<th style="text-align: right">Median</th>
<th style="text-align: right">Ratio</th>
<th style="text-align: right">Gen 0</th>
<th style="text-align: right">Gen 1</th>
<th style="text-align: right">Gen 2</th>
<th style="text-align: right">Allocated</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Normal</strong></td>
<td><strong>結合</strong></td>
<td><strong>False</strong></td>
<td style="text-align: right"><strong>20.3541 ns</strong></td>
<td style="text-align: right"><strong>0.0756 ns</strong></td>
<td style="text-align: right"><strong>0.0670 ns</strong></td>
<td style="text-align: right"><strong>20.3699 ns</strong></td>
<td style="text-align: right"><strong>1.00</strong></td>
<td style="text-align: right"><strong>0.0095</strong></td>
<td style="text-align: right"><strong>-</strong></td>
<td style="text-align: right"><strong>-</strong></td>
<td style="text-align: right"><strong>40 B</strong></td>
</tr>
<tr>
<td>Fast__</td>
<td>結合</td>
<td>False</td>
<td style="text-align: right">0.3115 ns</td>
<td style="text-align: right">0.0067 ns</td>
<td style="text-align: right">0.0063 ns</td>
<td style="text-align: right">0.3109 ns</td>
<td style="text-align: right">0.02</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>NormalSimple</td>
<td>文字列のみ</td>
<td>False</td>
<td style="text-align: right">1.8130 ns</td>
<td style="text-align: right">0.0098 ns</td>
<td style="text-align: right">0.0087 ns</td>
<td style="text-align: right">1.8138 ns</td>
<td style="text-align: right">1.00</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
</tr>
<tr>
<td>FastSimple__</td>
<td>文字列のみ</td>
<td>False</td>
<td style="text-align: right">0.0388 ns</td>
<td style="text-align: right">0.0256 ns</td>
<td style="text-align: right">0.0240 ns</td>
<td style="text-align: right">0.0304 ns</td>
<td style="text-align: right">0.02</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
</tr>
<tr>
<td><strong>Normal</strong></td>
<td><strong>結合</strong></td>
<td><strong>True</strong></td>
<td style="text-align: right"><strong>4,019.5700 ns</strong></td>
<td style="text-align: right"><strong>10.8629 ns</strong></td>
<td style="text-align: right"><strong>9.6297 ns</strong></td>
<td style="text-align: right"><strong>4,021.0225 ns</strong></td>
<td style="text-align: right"><strong>1.00</strong></td>
<td style="text-align: right"><strong>0.1678</strong></td>
<td style="text-align: right"><strong>-</strong></td>
<td style="text-align: right"><strong>-</strong></td>
<td style="text-align: right"><strong>728 B</strong></td>
</tr>
<tr>
<td>Fast__</td>
<td>結合</td>
<td>True</td>
<td style="text-align: right">4,033.7189 ns</td>
<td style="text-align: right">21.0017 ns</td>
<td style="text-align: right">19.6450 ns</td>
<td style="text-align: right">4,035.2283 ns</td>
<td style="text-align: right">1.00</td>
<td style="text-align: right">0.1678</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">728 B</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>NormalSimple</td>
<td>文字列のみ</td>
<td>True</td>
<td style="text-align: right">4,178.7744 ns</td>
<td style="text-align: right">66.8528 ns</td>
<td style="text-align: right">59.2633 ns</td>
<td style="text-align: right">4,161.0348 ns</td>
<td style="text-align: right">1.00</td>
<td style="text-align: right">0.1678</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">712 B</td>
</tr>
<tr>
<td>FastSimple__</td>
<td>文字列のみ</td>
<td>True</td>
<td style="text-align: right">4,010.7709 ns</td>
<td style="text-align: right">24.1833 ns</td>
<td style="text-align: right">20.1941 ns</td>
<td style="text-align: right">4,013.7803 ns</td>
<td style="text-align: right">0.96</td>
<td style="text-align: right">0.1678</td>
<td style="text-align: right">-</td>
<td style="text-align: right">-</td>
<td style="text-align: right">712 B</td>
</tr>
</tbody>
</table>

<p>20.3541 / 0.3115 ≒ 65倍速くなっています。<br>
え？タイトルの100倍は？<br>
・・・よく考えてみてください。このベンチマークは<code>"value: " + 1</code>という単純なログです。実際のログならもっと複雑になり、100倍どころでは済まないはずです。（希望的観測）</p>

<p>文字列のみの場合<code>ToString</code>や結合のコストは一切かからないはずですが、staticな<code>Verbose</code>メソッドの呼び出しにオーバーヘッドがそこそこあるのは意外でした。スタック領域の確保や各引数のコピーなども馬鹿になりません。<br>
<code>?.</code>演算子によりメソッドの呼び出し自体を回避できるため、1.8130 / 0.0388 ≒ 47倍も高速になるようです。</p>

<h1>
<span id="入力ミスの防止" class="fragment"></span><a href="#%E5%85%A5%E5%8A%9B%E3%83%9F%E3%82%B9%E3%81%AE%E9%98%B2%E6%AD%A2"><i class="fa fa-link"></i></a>入力ミスの防止</h1>

<p><code>Verbose</code>はデリゲートのため、次のように呼び出せます。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">FastLogger</span><span class="p">.</span><span class="nf">Verbose</span><span class="p">(</span><span class="s">"foo"</span><span class="p">);</span>
</code></pre></div></div>

<p>うっかり書いてしまうと、<code>NullReferenceException</code>が発生してしまいます。</p>

<h2>
<span id="null許容参照型" class="fragment"></span><a href="#null%E8%A8%B1%E5%AE%B9%E5%8F%82%E7%85%A7%E5%9E%8B"><i class="fa fa-link"></i></a>null許容参照型</h2>

<p><code>FastLogger</code>のコードで既に使用していますが、<code>Verbose</code>の型を<code>LogFunc?</code>のように後ろに<code>?</code>を付けることで、null許容参照型とすることができます。<br>
こうすることで、<code>Verbose(...)</code>と書いてしまった時にコンパイラーが警告を出してくれます。<br>
null許容参照型はC#8以降で使用可能です。</p>

<h1>
<span id="おわり" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A"><i class="fa fa-link"></i></a>おわり</h1>

<p>これでVerboseログを書きまくれます。ありがとうC#。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fdiontools%2Fitems%2F69e6df68fb63965019bf&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fdiontools%2Fitems%2F69e6df68fb63965019bf&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/diontools/items/69e6df68fb63965019bf/likers" class="css-1iupg5d">1</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">0</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/69e6df68fb63965019bf/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/diontools/items/69e6df68fb63965019bf/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/diontools/items/69e6df68fb63965019bf/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/diontools/items/69e6df68fb63965019bf/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/diontools/items/69e6df68fb63965019bf.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-aa041e09-963f-4b7a-b70d-6d51def85fdd">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-e3ce286e-18dc-410b-8c52-d422cfbb5f3f"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-e3ce286e-18dc-410b-8c52-d422cfbb5f3f">{}</script>
      
<div id="LoginModal-react-component-9c7f444f-2a60-4c8c-bbcd-7b2034c4df27"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-9c7f444f-2a60-4c8c-bbcd-7b2034c4df27">{}</script>
      
<div id="StockModal-react-component-f1f78a98-70e9-4fda-a478-2d9faf837484"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-f1f78a98-70e9-4fda-a478-2d9faf837484">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;X5oKWjgyOTCW5oini1iOINGuCtDAkBIMyihMByd9qoMTOJo4atm0qiY2DmZvUWOMlZDvgpc91N9ez8XcV8godg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eC#のnull条件演算子\u003ccode\u003e?.\u003c/code\u003eを利用して、無効化されたログ出力のオーバーヘッドを回避します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"通常のロガー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%80%9A%E5%B8%B8%E3%81%AE%E3%83%AD%E3%82%AC%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e通常のロガー\u003c/h2\u003e\n\n\u003cp\u003eよくあるロガーはこんな感じだと思います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eNormalLogger\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003e_enabled\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eenabled\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_enabled\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eenabled\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eCallerMemberName\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ememberName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eCallerFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esourceFilePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eCallerLineNumber\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003esourceLineNumber\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_enabled\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eTrace\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003esourceFilePath\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\":\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003esourceLineNumber\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ememberName\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"yyyy/MM/dd HH:mm:ss.fff\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e呼び出し側：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eNormalLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ログ出力を無効化\u003c/span\u003e\n\u003cspan class=\"n\"\u003eNormalLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ログ出力\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれを実行するとログ出力が無効になっているにもかかわらず、\u003ccode\u003e\"value: \" + 1\u003c/code\u003eが評価されてしまいます。\u003cbr\u003e\n\u003ccode\u003e\"value: \" + 1\u003c/code\u003eは、int型の数値\u003ccode\u003e1\u003c/code\u003eをToStringして\u003ccode\u003e\"value: \"\u003c/code\u003e文字列と結合する、というそれなりにコストがかかる処理です。\u003cbr\u003e\n今回はこれを回避します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"改善したロガー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%94%B9%E5%96%84%E3%81%97%E3%81%9F%E3%83%AD%E3%82%AC%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e改善したロガー\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003edelegate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eLogFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eCallerMemberName\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ememberName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eCallerFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003esourceFilePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eCallerLineNumber\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003esourceLineNumber\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFastLogger\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eLogFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003eVerbose\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eenabled\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eVerbose\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eenabled\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eTrace\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epath\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\":\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eline\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"yyyy/MM/dd HH:mm:ss.fff\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e呼び出し側：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eFastLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ログ無効化\u003c/span\u003e\n\u003cspan class=\"n\"\u003eFastLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ログ出力\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまず\u003ccode\u003eVerbose\u003c/code\u003eメソッドを\u003ccode\u003eLogFunc\u003c/code\u003eデリゲートに置き換えました。そして、呼び出し側にて\u003ccode\u003e?.\u003c/code\u003eを使用します。\u003cbr\u003e\n\u003ccode\u003eVerbose\u003c/code\u003eはデリゲートになったので、\u003ccode\u003e?.\u003c/code\u003eの後に\u003ccode\u003eInvoke\u003c/code\u003eメソッドでデリゲートを実行します。（本当は\u003ccode\u003e?.()\u003c/code\u003eとしたいところですが文法上不可能です。）\u003c/p\u003e\n\n\u003cp\u003eこのコードをコンパイルすると以下のように展開されます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eLogFunc\u003c/span\u003e \u003cspan class=\"n\"\u003everbose\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eFastLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003everbose\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003everbose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"メソッド名\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ファイルパス\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"cm\"\u003e/*行番号*/\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e展開されたコードを見た通り、\u003ccode\u003eVerbose\u003c/code\u003eがnullの場合は、\u003ccode\u003e\"value: \" + 1\u003c/code\u003eも\u003ccode\u003eVerbose\u003c/code\u003eの呼び出しそのものも回避されます。\u003cbr\u003e\n絶対速いですよね！！！\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ベンチマーク\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eベンチマーク\u003c/h2\u003e\n\n\u003cp\u003eBenchmarkDotNetでベンチマークしてみます。\u003c/p\u003e\n\n\u003cp\u003e\u003cdetails\u003e\u003csummary\u003eベンチマークコード\u003c/summary\u003e\u003cdiv\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eMemoryDiagnoser\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eGroupBenchmarksBy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBenchmarkLogicalGroupRule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eByCategory\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eCategoriesColumn\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLoggingTest\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eBenchmarkRunner\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eLoggingTest\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eParams\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eGlobalSetup\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetup\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eNormalLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFastLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eBenchmark\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkCategory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"結合\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eNormalLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eBenchmark\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkCategory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"結合\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eFast__\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFastLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"value: \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eBenchmark\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseline\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkCategory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"文字列のみ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eNormalSimple\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eNormalLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"verbose!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eBenchmark\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkCategory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"文字列のみ\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eFastSimple__\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFastLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"verbose!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/details\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eCallerMemberName\u003c/code\u003eの影響を無くすため、\u003ccode\u003eFast__\u003c/code\u003eのようにアンダーバーを追加して\u003ccode\u003eNormal\u003c/code\u003eと同じ文字数になるようにしています。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ベンチマーク結果\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF%E7%B5%90%E6%9E%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eベンチマーク結果\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ini\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"py\"\u003eBenchmarkDotNet\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003ev0.12.1, OS=Windows 8.1 (6.3.9600.0)\u003c/span\u003e\n\u003cspan class=\"err\"\u003eIntel\u003c/span\u003e \u003cspan class=\"err\"\u003eCore\u003c/span\u003e \u003cspan class=\"err\"\u003ei7-4770K\u003c/span\u003e \u003cspan class=\"err\"\u003eCPU\u003c/span\u003e \u003cspan class=\"err\"\u003e3.50GHz\u003c/span\u003e \u003cspan class=\"err\"\u003e(Haswell),\u003c/span\u003e \u003cspan class=\"err\"\u003e1\u003c/span\u003e \u003cspan class=\"err\"\u003eCPU,\u003c/span\u003e \u003cspan class=\"err\"\u003e8\u003c/span\u003e \u003cspan class=\"err\"\u003elogical\u003c/span\u003e \u003cspan class=\"err\"\u003eand\u003c/span\u003e \u003cspan class=\"err\"\u003e4\u003c/span\u003e \u003cspan class=\"err\"\u003ephysical\u003c/span\u003e \u003cspan class=\"err\"\u003ecores\u003c/span\u003e\n\u003cspan class=\"py\"\u003eFrequency\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e3410067 Hz, Resolution=293.2494 ns, Timer=TSC\u003c/span\u003e\n\u003cspan class=\"err\"\u003e.NET\u003c/span\u003e \u003cspan class=\"err\"\u003eCore\u003c/span\u003e \u003cspan class=\"py\"\u003eSDK\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e5.0.101\u003c/span\u003e\n  \u003cspan class=\"nn\"\u003e[Host]\u003c/span\u003e     \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e.NET\u003c/span\u003e \u003cspan class=\"err\"\u003eCore\u003c/span\u003e \u003cspan class=\"err\"\u003e5.0.1\u003c/span\u003e \u003cspan class=\"err\"\u003e(CoreCLR\u003c/span\u003e \u003cspan class=\"err\"\u003e5.0.120.57516,\u003c/span\u003e \u003cspan class=\"err\"\u003eCoreFX\u003c/span\u003e \u003cspan class=\"err\"\u003e5.0.120.57516),\u003c/span\u003e \u003cspan class=\"err\"\u003eX64\u003c/span\u003e \u003cspan class=\"err\"\u003eRyuJIT\u003c/span\u003e\n  \u003cspan class=\"err\"\u003eDefaultJob\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e.NET\u003c/span\u003e \u003cspan class=\"err\"\u003eCore\u003c/span\u003e \u003cspan class=\"err\"\u003e5.0.1\u003c/span\u003e \u003cspan class=\"err\"\u003e(CoreCLR\u003c/span\u003e \u003cspan class=\"err\"\u003e5.0.120.57516,\u003c/span\u003e \u003cspan class=\"err\"\u003eCoreFX\u003c/span\u003e \u003cspan class=\"err\"\u003e5.0.120.57516),\u003c/span\u003e \u003cspan class=\"err\"\u003eX64\u003c/span\u003e \u003cspan class=\"err\"\u003eRyuJIT\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eMethod\u003c/th\u003e\n\u003cth\u003eCategories\u003c/th\u003e\n\u003cth\u003eEnabled\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eMean\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eError\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eStdDev\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eMedian\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eRatio\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eGen 0\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eGen 1\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eGen 2\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003eAllocated\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003cstrong\u003eNormal\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003e結合\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003eFalse\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e20.3541 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e0.0756 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e0.0670 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e20.3699 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e1.00\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e0.0095\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e-\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e-\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e40 B\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFast__\u003c/td\u003e\n\u003ctd\u003e結合\u003c/td\u003e\n\u003ctd\u003eFalse\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.3115 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0067 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0063 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.3109 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.02\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNormalSimple\u003c/td\u003e\n\u003ctd\u003e文字列のみ\u003c/td\u003e\n\u003ctd\u003eFalse\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1.8130 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0098 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0087 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1.8138 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1.00\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFastSimple__\u003c/td\u003e\n\u003ctd\u003e文字列のみ\u003c/td\u003e\n\u003ctd\u003eFalse\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0388 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0256 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0240 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.0304 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.02\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003cstrong\u003eNormal\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003e結合\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003eTrue\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e4,019.5700 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e10.8629 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e9.6297 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e4,021.0225 ns\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e1.00\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e0.1678\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e-\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e-\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003cstrong\u003e728 B\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFast__\u003c/td\u003e\n\u003ctd\u003e結合\u003c/td\u003e\n\u003ctd\u003eTrue\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e4,033.7189 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e21.0017 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e19.6450 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e4,035.2283 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1.00\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.1678\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e728 B\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNormalSimple\u003c/td\u003e\n\u003ctd\u003e文字列のみ\u003c/td\u003e\n\u003ctd\u003eTrue\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e4,178.7744 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e66.8528 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e59.2633 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e4,161.0348 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1.00\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.1678\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e712 B\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFastSimple__\u003c/td\u003e\n\u003ctd\u003e文字列のみ\u003c/td\u003e\n\u003ctd\u003eTrue\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e4,010.7709 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e24.1833 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e20.1941 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e4,013.7803 ns\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.96\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0.1678\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e-\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e712 B\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e20.3541 / 0.3115 ≒ 65倍速くなっています。\u003cbr\u003e\nえ？タイトルの100倍は？\u003cbr\u003e\n・・・よく考えてみてください。このベンチマークは\u003ccode\u003e\"value: \" + 1\u003c/code\u003eという単純なログです。実際のログならもっと複雑になり、100倍どころでは済まないはずです。（希望的観測）\u003c/p\u003e\n\n\u003cp\u003e文字列のみの場合\u003ccode\u003eToString\u003c/code\u003eや結合のコストは一切かからないはずですが、staticな\u003ccode\u003eVerbose\u003c/code\u003eメソッドの呼び出しにオーバーヘッドがそこそこあるのは意外でした。スタック領域の確保や各引数のコピーなども馬鹿になりません。\u003cbr\u003e\n\u003ccode\u003e?.\u003c/code\u003e演算子によりメソッドの呼び出し自体を回避できるため、1.8130 / 0.0388 ≒ 47倍も高速になるようです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"入力ミスの防止\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%A5%E5%8A%9B%E3%83%9F%E3%82%B9%E3%81%AE%E9%98%B2%E6%AD%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e入力ミスの防止\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eVerbose\u003c/code\u003eはデリゲートのため、次のように呼び出せます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eFastLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVerbose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eうっかり書いてしまうと、\u003ccode\u003eNullReferenceException\u003c/code\u003eが発生してしまいます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"null許容参照型\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#null%E8%A8%B1%E5%AE%B9%E5%8F%82%E7%85%A7%E5%9E%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003enull許容参照型\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eFastLogger\u003c/code\u003eのコードで既に使用していますが、\u003ccode\u003eVerbose\u003c/code\u003eの型を\u003ccode\u003eLogFunc?\u003c/code\u003eのように後ろに\u003ccode\u003e?\u003c/code\u003eを付けることで、null許容参照型とすることができます。\u003cbr\u003e\nこうすることで、\u003ccode\u003eVerbose(...)\u003c/code\u003eと書いてしまった時にコンパイラーが警告を出してくれます。\u003cbr\u003e\nnull許容参照型はC#8以降で使用可能です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわり\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわり\u003c/h1\u003e\n\n\u003cp\u003eこれでVerboseログを書きまくれます。ありがとうC#。\u003c/p\u003e\n","createdAt":"2020-12-26T14:28:13Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"ULQuNUVloVBx79lqjXwgGMHkI5K4ItRnlw==--6YkqPqsU1kMSjQLm--TYyW8SaOBEHc5Vwusb3lNg==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2020-12-26T14:28:13Z","likesCount":1,"linkUrl":"https://qiita.com/diontools/items/69e6df68fb63965019bf","organization":null,"originalId":1367462,"stockedCount":0,"title":"[C#] Verboseなログ出力を無効化したときのパフォーマンスを100倍速くする","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%80%9A%E5%B8%B8%E3%81%AE%E3%83%AD%E3%82%AC%E3%83%BC\"\u003e通常のロガー\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%94%B9%E5%96%84%E3%81%97%E3%81%9F%E3%83%AD%E3%82%AC%E3%83%BC\"\u003e改善したロガー\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF\"\u003eベンチマーク\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF%E7%B5%90%E6%9E%9C\"\u003eベンチマーク結果\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%A5%E5%8A%9B%E3%83%9F%E3%82%B9%E3%81%AE%E9%98%B2%E6%AD%A2\"\u003e入力ミスの防止\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#null%E8%A8%B1%E5%AE%B9%E5%8F%82%E7%85%A7%E5%9E%8B\"\u003enull許容参照型\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A\"\u003eおわり\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":432,"uuid":"69e6df68fb63965019bf","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"qseChjdhCZMPwSzdmnjWzLV/XVGA--azk/1APWDTHil++t--TnGQTONaddCChPVetbOIyw==","originalId":304839,"description":"","facebookUrl":null,"githubUrl":"https://github.com/diontools","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://avatars0.githubusercontent.com/u/12995573?v=4","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F12995573%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=9dc7c3061c0c62cbeae5cfbd00b06038","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F12995573%3Fv%3D4?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=df457faf4b2c9b0f5536f59c016684d9","urlName":"diontools","websiteUrl":null,"twitterUrl":"https://twitter.com/diontools","twitterUrlName":"diontools","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"log","urlName":"log"},{"name":"logger","urlName":"logger"},{"name":"performance","urlName":"performance"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
