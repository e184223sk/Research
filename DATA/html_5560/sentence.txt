More than 3 years have passed since last update.Network Time Protocol(ネットワーク・タイム・プロトコル)の略称で、ネットワークに接続される機器の持つ時計を正しい時刻に同期するための通信プロトコルのこと。
PC、スマホなどネットワークに接続される機器の時刻がずれないのは、この仕組みを利用して定期的に時刻の同期を行い修正しているため。NTPサーバは、世界中に存在し階層構造(最大16階層)で構成され負荷分散を行う仕組みになっている。
最上位にGPSや標準電波、原子時計などの正確な時刻源を配置し、下位のサーバーは通常複数の上位/同位サーバーを利用して時刻を取得している。
上位サーバーの方がより正確な時刻保持しているが、サーバとのネットワーク的な近さのほうが時刻精度に大きく影響する。
また、高負荷によりサーバの応答性を下げ、配信される時刻の正確性が失われる場合があり、一般的にWindowsOSやMacOSなどで初期設定されているNTPサーバーは混雑しているため、他のNTPサーバーに変更することでより正確な時刻取得が可能になる。
また、組織内(LAN)のクライアント台数が存在する場合、内部NTPサーバーを利用し同期を行った方が、外部サーバーとの同期と比べ各機器同士の時刻誤差が発生しにくくなる。NTPは、OSI基本参照モデルの第7層(アプリケーション層)に位置し、UDPポート123番を使用し、下図のパケットで送受信を行っている。
８ビットの符号付き整数で、連続するメッセージの最大間隔を、秒単位で２のべき乗で表される。8ビットの符号付き整数でローカル時計の精度を、秒単位で2のべき乗で表される。32ビット符号付き固定小数点で、1次参照源までの往復遅延の合計を表す。32ビット符号付き固定小数点で、1次参照源までの相対的な誤差を表す。32ビットのビット列で階層0，1のサーバでは4文字のアスキーで左寄せされている。残りは0で埋められている。
それ以外のサーバでは時刻源のIPv4のIPアドレスがセットされる。ローカル時計が最後に設定、修正された時刻を表す。64ビットのタイムスタンプフォーマットで表される。クライアントからサーバへリクエストを発信した時間を表す。64ビットのタイムスタンプフォーマットで表される。サーバへリクエストが到着した時間を表す。64ビットのタイムスタンプフォーマットで表される。サーバからクライアントに応答が発信された時間を表す。64ビットのタイムスタンプフォーマットで表される。RFC 1128
RFC 1129
RFC 1305
RFC 2030
RFC 4330
RFC 5905
RFC 5906
RFC 5907
RFC 5908
RFC 868 - Time Protocol


