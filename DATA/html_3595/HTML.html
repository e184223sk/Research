<!DOCTYPE html><html><head><meta charset="utf-8" /><title>[.NET][改元] 「元年」表記に変わる日付書式が今になって拡大！（フレームワーク別の対策が必要）――マイクロソフト様、重大な変更をしれっとリリースしないで - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/CodeOne/items/97c5a84cfa7376cbb629" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="HC9xurkfQEjWmGBwc4ajy/NCda/DD7sTBsg0KwMfRWPhhh1tDx6c6rkLuNCPMlQwfeL7X3TZtls1X1DD9u6qsA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="[.NET][改元] 「元年」表記に変わる日付書式が今になって拡大！（フレームワーク別の対策が必要）――マイクロソフト様、重大な変更をしれっとリリースしないで - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XeTVPUlZSZFctYVV1ZVdGZzEwZzQ0Q001WVdENWJtMDQ0Q042S0dvNktpWTQ0R3I1YVNKNDRLUDQ0S0w1cGVsNUx1WTVwdTQ1YnlQNDRHTTVMdUs0NEdyNDRHcTQ0R2o0NEdtNW91aDVhU243N3lCNzd5STQ0T1Y0NE9zNDRPODQ0T2c0NE92NDRPODQ0S3Y1WWlsNDRHdTVhLS01NjJXNDRHTTViLUY2S2FCNzd5SjRvQ1Y0b0NWNDRPZTQ0S2s0NEt2NDRPdDQ0Szk0NE9WNDRPSTRvQ20mdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NGZlMWMyN2UyMTZhZjRmZDdmZjllZTIzNDU5NjkxYTA&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRU52WkdWUGJtVSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTBhMTM0ZWM5MWU5MTE5NDZiZTQ5OWZjYWQyNmFmZTEx&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=ea5a8f8855d84bb767ac97ef9e87ee8e"><meta property="og:description" content="

「元年」表記の既定動作が突然変わった！

新元号「令和」が発表されて間もない4月5日、一緒に仕事するエンジニアの方に教えていただき、愕然としました。

2019 年 4 月 3 日 — KB4489192 Windows 10 V..."><meta content="https://qiita.com/CodeOne/items/97c5a84cfa7376cbb629" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="Windows,C#,.NET,.NETFramework,元号" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-57ac0d74-158e-4b8a-a05b-722f84c42d75"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FCodeOne%2Fitems%2F97c5a84cfa7376cbb629">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FCodeOne%2Fitems%2F97c5a84cfa7376cbb629">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-57ac0d74-158e-4b8a-a05b-722f84c42d75">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/windows","name":"Windows"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-04-06T02:18:18.000+09:00","dateModified":"2019-06-05T12:44:12.000+09:00","headline":"[.NET][改元] 「元年」表記に変わる日付書式が今になって拡大！（フレームワーク別の対策が必要）――マイクロソフト様、重大な変更をしれっとリリースしないで","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XeTVPUlZSZFctYVV1ZVdGZzEwZzQ0Q001WVdENWJtMDQ0Q042S0dvNktpWTQ0R3I1YVNKNDRLUDQ0S0w1cGVsNUx1WTVwdTQ1YnlQNDRHTTVMdUs0NEdyNDRHcTQ0R2o0NEdtNW91aDVhU243N3lCNzd5STQ0T1Y0NE9zNDRPODQ0T2c0NE92NDRPODQ0S3Y1WWlsNDRHdTVhLS01NjJXNDRHTTViLUY2S2FCNzd5SjRvQ1Y0b0NWNDRPZTQ0S2s0NEt2NDRPdDQ0Szk0NE9WNDRPSTRvQ20mdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NGZlMWMyN2UyMTZhZjRmZDdmZjllZTIzNDU5NjkxYTA\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRU52WkdWUGJtVSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTBhMTM0ZWM5MWU5MTE5NDZiZTQ5OWZjYWQyNmFmZTEx\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=ea5a8f8855d84bb767ac97ef9e87ee8e","mainEntityOfPage":"https://qiita.com/CodeOne/items/97c5a84cfa7376cbb629","author":{"@type":"Person","address":"","email":"public@codeone.jp","identifier":"CodeOne","name":"CodeOne","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F335669%2Fprofile-images%2F1546497723?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d065bb7eb81ec93789852af0e352faa5","url":"https://qiita.com/CodeOne","description":"【品質と生産性にこだわるシステム開発】 .NET（C#/VB.NET）リモート開発支援。即日・15分から頼める常駐しないエンジニア。確かな技術で開発チームを手堅くサポートします。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita&amp;utm_medium=header-banner">急成長する「NewsPicks」ブランドの開発思想を探る</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"CodeOne","type":"items","id":"97c5a84cfa7376cbb629"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"急成長する「NewsPicks」ブランドの開発思想を探る","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"CodeOne","type":"items","id":"97c5a84cfa7376cbb629"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"急成長する「NewsPicks」ブランドの開発思想を探る","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"CodeOne","type":"items","id":"97c5a84cfa7376cbb629"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"急成長する「NewsPicks」ブランドの開発思想を探る","url":"https://zine.qiita.com/interview/202105-uzabase-2/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/CodeOne/items/97c5a84cfa7376cbb629","location":"/CodeOne/items/97c5a84cfa7376cbb629","scheme":"https","host":"qiita.com","port":null,"pathname":"/CodeOne/items/97c5a84cfa7376cbb629","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"bIEBt6QlyrB85oD3pOFrUEjMXoWwxx/EhOjGHW+NCtSRKG1gEiQWEhN1WFdYVZyrxmzQdQcREoy3f6L1mnzlBw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-590afef9-9852-47ac-9808-2782d1a52aa2"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/CodeOne/items/97c5a84cfa7376cbb629/likers" class="css-1iupg5d">81</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">48</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/97c5a84cfa7376cbb629/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/CodeOne/items/97c5a84cfa7376cbb629/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/CodeOne/items/97c5a84cfa7376cbb629/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/CodeOne/items/97c5a84cfa7376cbb629/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/CodeOne/items/97c5a84cfa7376cbb629.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/CodeOne"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/335669/profile-images/1546497723" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/CodeOne" class="css-10ougpm">@<!-- -->CodeOne</a><div class="css-1ay9vb9"><span><meta content="2019-04-05T17:18:18Z"/><time dateTime="2019-06-05T03:44:12Z" class="css-m19uds">updated at 2019-06-05</time></span></div></div></div></div></div><h1 class="css-cgzq40">[.NET][改元] 「元年」表記に変わる日付書式が今になって拡大！（フレームワーク別の対策が必要）――マイクロソフト様、重大な変更をしれっとリリースしないで</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/windows" class="css-4czcte">Windows</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/.net" class="css-4czcte">.NET</a><a href="/tags/.netframework" class="css-4czcte">.NETFramework</a><a href="/tags/%e5%85%83%e5%8f%b7" class="css-4czcte">元号</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="元年表記の既定動作が突然変わった" class="fragment"></span><a href="#%E5%85%83%E5%B9%B4%E8%A1%A8%E8%A8%98%E3%81%AE%E6%97%A2%E5%AE%9A%E5%8B%95%E4%BD%9C%E3%81%8C%E7%AA%81%E7%84%B6%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F"><i class="fa fa-link"></i></a>「元年」表記の既定動作が突然変わった！</h1>

<p>新元号「令和」が発表されて間もない4月5日、一緒に仕事するエンジニアの方に教えていただき、愕然としました。</p>

<p><a href="https://support.microsoft.com/ja-jp/help/4489192/april-2-2019-kb4489192" rel="nofollow noopener" target="_blank">2019 年 4 月 3 日 — KB4489192 Windows 10 Version 1809 および Windows Server 2019 用の .NET Framework 3.5 および 4.7.2 の累積的な更新プログラム</a></p>

<blockquote>
<p>書式パターンに <font color="Red">"年" の文字を囲む半角の引用符が含まれているかいないかに関係なく</font>、1 年目の日付の書式が変更されている日本の元号の元年の文字を出力できます。</p>
</blockquote>

<p>改元まで残り1か月を切り、新元号の Windows への組み込みが差し迫った、このタイミングで？<br>
本気でしょうか。</p>

<p><a href="https://support.microsoft.com/ja-jp/help/4477957" rel="nofollow noopener" target="_blank">.NET Framework 用の日本の新元号対応更新プログラムの概要（2019/4/3付）</a></p>

<blockquote>
<p>日本の元号の書式で<font color="Red">元年の文字を出力するにはシングル クォーテーションを付ける必要があった問題を解決する新しい品質更新</font>プログラムも含まれています。そのため、.NET Framework でカスタムの日付と時刻の書式に “y年” または “y’年'” のいずれを使用しても、年の数値 1 を元という書式で示すことができるようになりました。</p>
</blockquote>

<p>どうやら本気のようです。</p>

<h3>
<span id="どうなるのか" class="fragment"></span><a href="#%E3%81%A9%E3%81%86%E3%81%AA%E3%82%8B%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>どうなるのか？</h3>

<p>以下のようになります。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="kt">var</span> <span class="n">japanseCalendarCulture</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CultureInfo</span><span class="p">(</span><span class="s">"ja-JP"</span><span class="p">)</span> <span class="p">{</span> <span class="n">DateTimeFormat</span> <span class="p">=</span> <span class="p">{</span> <span class="n">Calendar</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JapaneseCalendar</span><span class="p">()</span> <span class="p">}</span> <span class="p">};</span>

<span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"平成元年"</span><span class="p">,</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1989</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">).</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"ggyy年"</span><span class="p">,</span> <span class="n">japanseCalendarCulture</span><span class="p">));</span>
<span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"令和元年"</span><span class="p">,</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2019</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">).</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"ggyy年"</span><span class="p">,</span> <span class="n">japanseCalendarCulture</span><span class="p">));</span>
</code></pre></div></div>

<h3>
<span id="何が変わったのか" class="fragment"></span><a href="#%E4%BD%95%E3%81%8C%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>何が変わったのか？</h3>

<p>これまでの改元対応では、「元年」表記されるのは "yy'年'" のように「年」をシングルクォーテーションで囲んだときだけでした。<br>
"yy年" のようにシングルクォーテーションで囲まない場合、これまでは「01年」でしたが、今後は「元年」と表記されるようになります。</p>

<p>※ここでは書式 "yy" を例に説明を進めますので、書式 "y" の場合は「1年」に読み替えてください。</p>

<h3>
<span id="何が困るのか" class="fragment"></span><a href="#%E4%BD%95%E3%81%8C%E5%9B%B0%E3%82%8B%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>何が困るのか？</h3>

<ul>
<li>「01年」が「元年」と表記されるように変わる。（これ自体は仕様として許容できることが多いでしょう）</li>
<li>和暦文字列の年部分が数値であることを前提とした処理でエラーが発生する。</li>
<li>和暦文字列の年部分が2文字であることを前提とした処理でエラーが発生する。</li>
<li>カルチャを指定しない DateTime.Parse, DateTime.TryParse メソッドが「元年」の和暦文字列を解釈できない。</li>
</ul>

<p>※こうした文字列解析処理の是非はここでは問題にしません。現実にありうるなら対処が必要、という視点で書いています。</p>

<h3>
<span id="これまでの経緯" class="fragment"></span><a href="#%E3%81%93%E3%82%8C%E3%81%BE%E3%81%A7%E3%81%AE%E7%B5%8C%E7%B7%AF"><i class="fa fa-link"></i></a>これまでの経緯</h3>

<p>2018年8月、<a href="https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/" rel="nofollow noopener" target="_blank">.NET Blog（英語）</a>で .NET Framework で「元年」表記が既定になるとアナウンスされました。</p>

<p>2018年10月、対応版のパッチがリリースされ、実際に書式 "yy'年'" で和暦初年が「元年」に文字列化されることが確認できました。</p>

<p>一方で、「年」をシングルクォーテーションで囲まない "yy年" 書式による和暦初年文字列は、新元号検証用のレジストリ設定が公開された後も後述する FormatJapaneseFirstYearAsANumber 設定に関係なく「01年」でした。</p>

<p>※この間の実行結果は、『<a href="https://devlog.grapecity.co.jp/entry/2018/10/26/dotnet-first-year-era" rel="nofollow noopener" target="_blank">「元年」に対応した.NET Frameworkを試してみた - GrapeCity.devlog</a>』や『<a href="https://www.atmarkit.co.jp/ait/articles/0306/06/news004.html#breakingchange" rel="nofollow noopener" target="_blank">西暦と和暦を変換するには？：.NET TIPS - ＠IT</a>』にあるとおりです（いずれも 2019/4/14 時点）。</p>

<p>中途半端な仕様だなとは感じつつも、特に変更予定の告知もなく、公式に検証方法まで案内されているので、<strong>「この仕様で行くのだろう。シングルクォーテーションはつけていないので対応は不要だ」</strong>と判断した人は少なくないでしょう。</p>

<p>もちろん「最終的にはシングルクォーテーションなしにも対応するのでは？」という可能性は想定しえたわけですが、明確な予告のない状況で具体的な対応に踏み切ることはそうそうできません。</p>

<h3>
<span id="リリース状況" class="fragment"></span><a href="#%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E7%8A%B6%E6%B3%81"><i class="fa fa-link"></i></a>リリース状況</h3>

<p>この KB4489192 のリリース事情がまた複雑です。</p>

<p>2018年3月20日（日本時間）、.NET Framework 2018年3月更新がリリースされました。<br>
このパッチによって "y年" が「元年」に変換されるようになることが、リリース報告記事『<a href="https://devblogs.microsoft.com/dotnet/net-framework-march-2019-update/" rel="nofollow noopener" target="_blank">.NET Framework March 2019 Update | .NET Blog（英語）</a>』に記載されています。</p>

<p>※上記<a href="https://www.atmarkit.co.jp/ait/articles/0306/06/news004.html#breakingchange" rel="nofollow noopener" target="_blank">@IT記事</a>の共著者の一人である山本康彦氏が、3月20日に<a href="https://twitter.com/biac/status/1108527703269867521" rel="nofollow noopener" target="_blank">Twitter</a>でこの記事を取り上げて話題にしていました。</p>

<p>しかし、そこに記載のない Windows 10 Version 1809 / Server 2019 向けの更新（KB4489192）は4月3日（日本時間）までずれ込みました（4/14現在もHTMLの title は「2019 年 3 月 20 日 — KB4489192」のままです）。</p>

<p>『<a href="https://support.microsoft.com/ja-jp/help/4477957/new-japanese-era-updates-for-net-framework" rel="nofollow noopener" target="_blank">.NET Framework 用の日本の新元号対応更新プログラムの概要</a>』にOSごとのKB一覧がありますが、</p>

<blockquote>
<p>Windows 8.1 以前のバージョンのサポートされる Windows 用に .NET Framework のセキュリティおよび品質ロールアップを 2019 年 3 月にリリースしませんでした。</p>
</blockquote>

<p>とありますので、実際には Windows 8.1 以前（Windows 7, 8.1, Server 2008/R2, 2012/R2）向けのリリースも4月1日までずれ込んだ可能性があります。</p>

<p>Windows 10 1809 / Server 2019 向けの KB4489192 は、<a href="http://www.catalog.update.microsoft.com/Search.aspx?q=KB4489192" rel="nofollow noopener" target="_blank">Microsoft Update カタログ</a> からダウンロードして Windows 10 Version 1809（October 2018 Update）環境にインストールできますが、4月14日時点でまだ Windows Update には上がってこないようです。</p>

<p>※『<a href="https://yamanxworld.blogspot.com/2019/04/windows-update-2019-4-2-4-3-drs5.html" rel="nofollow noopener" target="_blank">山市良のえぬなんとかわーるど: 本日の Windows Update － 2019 年 4 月 2 日（4 月に流れた 3 月 D、RS5 のみ）</a>』にこの辺りの経緯が書いてあります。</p>

<p>※Windows 8.1 以前のOS向け .NET Framework 2018年3月更新の個々の Windows Update 配信状況は把握できておりません。</p>

<p>リリース済みですので、いつ Windows Update で配信されてもおかしくない状況ではあります。<br>
逡巡しているかのような上記状況から、撤回／延期される可能性もゼロとは言い切れませんが。<br>
⇒ [<a href="#20190414-%E8%BF%BD%E8%A8%98">2019/04/14 追記</a>]、[<a href="#20190429-%E8%BF%BD%E8%A8%98">2019/04/29 追記</a>]、[<a href="#20190515-%E8%BF%BD%E8%A8%98">2019/15/15 追記</a>] に続報があります。</p>

<h3>
<span id="マイクロソフト社の言い分推測" class="fragment"></span><a href="#%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E7%A4%BE%E3%81%AE%E8%A8%80%E3%81%84%E5%88%86%E6%8E%A8%E6%B8%AC"><i class="fa fa-link"></i></a>マイクロソフト社の言い分（推測）</h3>

<p>「品質更新」ですから、当初よりシングルクォーテーションなしにも対応すべきだった、ということなのでしょう。</p>

<p>『<a href="https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/custom-numeric-format-strings" rel="nofollow noopener" target="_blank">カスタム数値書式指定文字列 | Microsoft Docs</a>』には</p>

<blockquote>
<p>リテラル文字列全体を引用符のアポストロフィで囲みます。</p>
</blockquote>

<p>とありますので、囲んでいない方が悪い ⇒ 改善リリースもあらかじめ通知しなくてもいいだろう、という判断なのかもしれません。</p>

<p>※あくまで推測であり、違っているかもしれませんが、それなら不備と認識した時点で、余裕を持った事前のアナウンスが欲しかったです。</p>

<h3>
<span id="そうはいかない現実" class="fragment"></span><a href="#%E3%81%9D%E3%81%86%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84%E7%8F%BE%E5%AE%9F"><i class="fa fa-link"></i></a>そうはいかない現実</h3>

<p>現実には著名なサイトの技術記事でも和暦書式として "ggyy年" が普通に使われています。<br>
ということは、現場レベルでもシングルクォーテーションなしの書式で和暦文字列化しているケースはかなり多いと考えられます。</p>

<p>問題が起こらないようにするためには、調査、実装、テスト、ユーザー様への通知が必要となります。</p>

<p>新元号「令和」の Windows 組み込みは間近に迫っています。<br>
それまでに何とか直せば大丈夫、ということではありません。<br>
生年月日など、平成元年のデータは現にシステムで扱っていることもあります。<br>
急に「01年」が「元年」に変わっては困るのです。</p>

<h1>
<span id="どうすればいいのか" class="fragment"></span><a href="#%E3%81%A9%E3%81%86%E3%81%99%E3%82%8C%E3%81%B0%E3%81%84%E3%81%84%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>どうすればいいのか？</h1>

<p>"yy'年'" のようにシングルクォーテーションで囲っていた場合は、すでに既定で「元年」になっていますので、対応済みでしょう。<br>
問題は "yy年" のように指定していた場合です。<br>
KB4489192 が適用された後も「01年」表記を続けるためには対応が必要となります。</p>

<p>※システム内で「01年」表記に戻すことができたとしても、連携するシステムから「元年」のデータを受け取る可能性がありますので、協調して対応を進めましょう。</p>

<h3>
<span id="net-core-の場合" class="fragment"></span><a href="#net-core-%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>.NET Core の場合</h3>

<p>プロジェクト直下にコンテンツとして以下のような runtimeconfig.template.json を配置してビルドすると、{AppName}.runtimeconfig.json に設定が追記され、既定の「元年」表記から「01年」表記に変わります。</p>

<div class="code-frame" data-lang="json">
<div class="code-lang"><span class="bold">runtimeconfig.template.json</span></div>
<div class="highlight"><pre class="with-code"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"configProperties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
</div>

<p>　 ↓ （ビルド出力）</p>

<div class="code-frame" data-lang="json">
<div class="code-lang"><span class="bold">{AppName}.runtimeconfig.json（例）</span></div>
<div class="highlight"><pre class="with-code"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"runtimeOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"tfm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"netcoreapp2.2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"framework"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Microsoft.AspNetCore.App"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.2.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"configProperties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"System.GC.Server"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
</div>

<h3>
<span id="net-46-以降で動作する場合windows-formswpf" class="fragment"></span><a href="#net-46-%E4%BB%A5%E9%99%8D%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88windows-formswpf"><i class="fa fa-link"></i></a>.NET 4.6 以降で動作する場合（Windows Forms／WPF）</h3>

<p>構成ファイル（App.config ⇒ {AppName}.exe.config）に以下のような AppContextSwitchOverrides 要素を追記すると、既定の「元年」表記が無効となり、「01年」表記になります。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">App.config</span></div>
<div class="highlight"><pre class="with-code"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;runtime&gt;</span>
 　　:
    <span class="nt">&lt;AppContextSwitchOverrides</span> <span class="na">value=</span><span class="s">"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber=true"</span> <span class="nt">/&gt;</span>
 　　:
</code></pre></div>
</div>

<p>.NET 4 系はインプレースアップグレードですので、ターゲットフレームワークが .NET 4.6 未満でも、.NET 4.6 以降がインストールされた環境ではこの設定が有効となります。</p>

<p>ターゲットフレームワークが .NET 4.6 以上の場合、<a href="https://docs.microsoft.com/en-us/dotnet/api/system.appcontext.setswitch" rel="nofollow noopener" target="_blank">AppContext.SetSwitch(String, Boolean)</a> メソッドで指定することも可能です。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="n">AppContext</span><span class="p">.</span><span class="nf">SetSwitch</span><span class="p">(</span><span class="s">"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber"</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</code></pre></div></div>

<p>ただし、この設定にはキャッシュされる仕組みがあり（<a href="https://referencesource.microsoft.com/#mscorlib/system/AppContext/AppContextSwitches.cs,cb82ff2a6201f14f" rel="nofollow noopener" target="_blank">System.AppContextSwitches ソースコード参照</a>）、一度 String.Format や DateTime.ToString による日付文字列化を行うと、その後に SetSwitch しても効かずに「元年」出力されたりします。設定のタイミングが遅れないよう、記述箇所には注意しましょう。</p>

<h3>
<span id="net-46-以降で動作する場合aspnet" class="fragment"></span><a href="#net-46-%E4%BB%A5%E9%99%8D%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88aspnet"><i class="fa fa-link"></i></a>.NET 4.6 以降で動作する場合（ASP.NET）</h3>

<p>Web.config に以下のような設定を追記すると、既定の「元年」表記が無効となり、「01年」表記になります。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">Web.config</span></div>
<div class="highlight"><pre class="with-code"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    :
  <span class="nt">&lt;appSettings&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">"AppContext.SetSwitch:Switch.System.Globalization.FormatJapaneseFirstYearAsANumber"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
     :
</code></pre></div>
</div>

<h3>
<span id="net-35-や-net-452-までのランタイムで動作する場合" class="fragment"></span><a href="#net-35-%E3%82%84-net-452-%E3%81%BE%E3%81%A7%E3%81%AE%E3%83%A9%E3%83%B3%E3%82%BF%E3%82%A4%E3%83%A0%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>.NET 3.5 や .NET 4.5.2 までのランタイムで動作する場合</h3>

<p>※Windows 10 の場合、.NET Framework 4.6 以上がインストールされていますので、.NET 4 系のアプリケーションは（ターゲットフレームワークが 4.5.2 以下だとしても）該当しません。</p>

<p>『<a href="https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/" rel="nofollow noopener" target="_blank">Handling a new era in the Japanese calendar in .NET | .NET Blog</a>』や『<a href="https://docs.microsoft.com/ja-jp/dotnet/standard/datetime/working-with-calendars" rel="nofollow noopener" target="_blank">カレンダーの使用 | Microsoft Docs</a>』で紹介されているように、レジストリ登録することで「01年」表記に戻すことが可能です。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>Key     HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\AppContext
Name    Switch.System.Globalization.FormatJapaneseFirstYearAsANumber
Type    REG_SZ
Value   1
</code></pre></div></div>

<p>ただし、アプリケーション単位でなく、マシン全体の設定になってしまいます。<br>
試してみたところ、.NET 4.6 以降で動作するアプリケーションには影響しないようです。</p>

<p>WOW64（64ビット Windows で x86 ターゲット）の場合は Key が変わります。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>Key     HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\.NETFramework\AppContext
Name    Switch.System.Globalization.FormatJapaneseFirstYearAsANumber
Type    REG_SZ
Value   1
</code></pre></div></div>

<p>WOW64 については、上記 <a href="https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/" rel="nofollow noopener" target="_blank">.NET Blog</a> や <a href="https://docs.microsoft.com/ja-jp/dotnet/standard/datetime/working-with-calendars" rel="nofollow noopener" target="_blank">Microsoft Docs</a> にも記載がありません。<br>
きちんと案内しなくて大丈夫なのだろうか。</p>

<h3>
<span id="別解というより時間的余裕があるなら王道" class="fragment"></span><a href="#%E5%88%A5%E8%A7%A3%E3%81%A8%E3%81%84%E3%81%86%E3%82%88%E3%82%8A%E6%99%82%E9%96%93%E7%9A%84%E4%BD%99%E8%A3%95%E3%81%8C%E3%81%82%E3%82%8B%E3%81%AA%E3%82%89%E7%8E%8B%E9%81%93"><i class="fa fa-link"></i></a>別解（というより時間的余裕があるなら王道）</h3>

<p>FormatJapaneseFirstYearAsANumber=true は設定せずに、「元年」表記でも問題ないようにコードを修正します。</p>

<p>「修正なしで問題ないだろう」と思っても、それを保証するためには、ソースコード全体の調査とある程度の動作検証が必要でしょう。<br>
影響するようなコードを書いた覚えがなくても、ほかのプログラマが書いているかもしれません。<br>
コード内に問題が見つからなくても、使用しているサードパーティーコンポーネントで問題が発生するかもしれません<sup id="fnref1"><a href="#fn1" title="一連の改元騒動について「和暦なんて使うから」という書き込みも散見されるので、あえて参考に挙げておきます。特殊な例とは思いますが、西暦を使っていれば安心とは限りません。
[FlexGrid for WinForms] Windows 10 April 2018 Updateが適用された環境において、2019/5/1以降の日付に対してColumn.Formatで指定した書式が適用されない - ComponentOne for WinForms - ナレッジベースの詳細｜Developer Tools - グレープシティ株式会社">1</a></sup>。<br>
システム単体では問題がなくても、連携するシステムに「元年」を送ってエラーになることがあるかもしれません。</p>

<p>"yy" の直後に "'月'" や "月" がつかなければ「元年」表記にはならないので、どうしても「01」表記にしたい箇所については、年部分とその後ろを別々に文字列化して結合する、といった対応が考えられます。</p>

<p>なお、実行環境を完全に制御できる場合でない限り、 和暦初年が必ず「元年」表記になることを前提とする、逆の罠にはまらないように気をつけましょう。<br>
そのコードは、「元年」表記が既定で有効になる前の環境で動く可能性があります。</p>

<p>※修正箇所については上記「何が困るのか？」をご参照ください。</p>

<h3>
<span id="vb6visual-basic-60vbavisual-basic-for-applications-は" class="fragment"></span><a href="#vb6visual-basic-60vbavisual-basic-for-applications-%E3%81%AF"><i class="fa fa-link"></i></a>VB6（Visual Basic 6.0）／VBA（Visual Basic for Applications） は？</h3>

<p><a href="https://support.microsoft.com/ja-jp/help/4493509/windows-10-update-kb4493509" rel="nofollow noopener" target="_blank">2019年4月セキュリティ更新（KB4493509）</a>を適用した Windows 10 Version 1809 環境での VB6/VBA 実行結果は以下のようになりました。</p>

<p>※新元号のレジストリ設定 "令和_令_Reiwa_R" を手動で登録しています。</p>

<p>※「←」の右は2019年4月セキュリティ更新をあてる以前の確認結果です。<br>
IsDate, CDate が新元号レジストリ設定を解釈できるように、Format は「元年」でなく「01年」を返すように変わりました。<br>
⇒ <a href="/tfukumori" class="user-mention js-hovercard" title="tfukumori" data-hovercard-target-type="user" data-hovercard-target-name="tfukumori">@tfukumori</a> さんの記事『<a href="https://qiita.com/tfukumori/items/aa9179f961eca86f192f" id="reference-930b8be5c9558fbd4d6b">VB6、およびOffice VBAの元号対応の状況について</a>』に環境別の詳細な検証結果があります。<br>
ただし、Windows 10 の次期大型アップデート「19H1」の Insider Preview 版では、Format 関数の依存する元年／1年のレジストリ設定　[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Calendars\Japanese] InitialEraYear が "元年" になっています（<a href="https://support.microsoft.com/ja-jp/help/4469068/summary-of-new-japanese-era-updates-kb4469068" rel="nofollow noopener" target="_blank">KB4469068「元年対 1年」参考</a>）。<br>
万全を期すならどちらを返しても問題ないように対応しておくのが安心と言えるでしょう。<br>
⇒ 正式版の Windows 10 Version 1903 にアップデートしたところ、既定が "元年" に変わっていました（<a href="#20190528-%E8%BF%BD%E8%A8%98">[2019/05/28 追記]</a>）。</p>

<div class="code-frame" data-lang="vb"><div class="highlight"><pre class="with-code"><code><span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">IsDate</span><span class="p">(</span><span class="s">"平成01年02月01日"</span><span class="p">)</span>
<span class="k">True</span>

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">IsDate</span><span class="p">(</span><span class="s">"平成元年02月01日"</span><span class="p">)</span>
<span class="k">True</span>

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">IsDate</span><span class="p">(</span><span class="s">"令和01年05月01日"</span><span class="p">)</span>
<span class="k">True</span><span class="err">（←</span> <span class="k">False</span><span class="err">）</span>

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">IsDate</span><span class="p">(</span><span class="s">"令和元年05月01日"</span><span class="p">)</span>
<span class="k">True</span><span class="err">（←</span> <span class="k">False</span><span class="err">）</span>

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">CDate</span><span class="p">(</span><span class="s">"平成01年02月01日"</span><span class="p">)</span>
<span class="mi">1989</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">01</span> 

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">CDate</span><span class="p">(</span><span class="s">"平成元年02月01日"</span><span class="p">)</span>
<span class="mi">1989</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">01</span> 

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">CDate</span><span class="p">(</span><span class="s">"令和01年05月01日"</span><span class="p">)</span>
<span class="mi">2019</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">01</span><span class="err">（←</span> <span class="err">実行時ｴﾗｰ</span> <span class="c1">'13': 型が一致しません。）</span>

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">CDate</span><span class="p">(</span><span class="s">"令和元年05月01日"</span><span class="p">)</span>
<span class="mi">2019</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">01</span><span class="err">（←</span> <span class="err">実行時ｴﾗｰ</span> <span class="c1">'13': 型が一致しません。）</span>

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">Format</span><span class="err">$</span><span class="p">(</span><span class="s">"1989/02/01"</span><span class="p">,</span> <span class="s">"gggee年"</span><span class="p">)</span>
<span class="err">（平成元年</span> <span class="err">←）平成</span><span class="mi">01</span><span class="err">年（←</span> <span class="err">平成元年）</span>

<span class="err">?</span><span class="n">VBA</span><span class="p">.</span><span class="n">Format</span><span class="err">$</span><span class="p">(</span><span class="s">"2019/05/01"</span><span class="p">,</span> <span class="s">"gggee年"</span><span class="p">)</span>
<span class="err">（令和元年</span> <span class="err">←）令和</span><span class="mi">01</span><span class="err">年（←</span> <span class="err">令和元年）</span>
</code></pre></div></div>

<p>VB6 も Windows 10 でランタイムはサポートされているわけですから、IsDate, CDate, Format 等の動作について、対応方法まで明示する義務はないとしても、最終的にどう変わるのか、あるいは変わらないのか、わかりやすい形の公式情報が欲しいところです。</p>

<h1>
<span id="windows-update-で-kb4489192-が配信されたら大騒ぎにならないか" class="fragment"></span><a href="#windows-update-%E3%81%A7-kb4489192-%E3%81%8C%E9%85%8D%E4%BF%A1%E3%81%95%E3%82%8C%E3%81%9F%E3%82%89%E5%A4%A7%E9%A8%92%E3%81%8E%E3%81%AB%E3%81%AA%E3%82%89%E3%81%AA%E3%81%84%E3%81%8B"><i class="fa fa-link"></i></a>Windows Update で KB4489192 が配信されたら大騒ぎにならないか？</h1>

<p>一度リリースして後に撤回された新元号「？？」仮表記みたいに（あるいはそれ以上に）。<br>
「大丈夫、皆対応しているよ」と、杞憂であればいいのですが。</p>

<h1>
<span id="マイクロソフト様" class="fragment"></span><a href="#%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E6%A7%98"><i class="fa fa-link"></i></a>マイクロソフト様</h1>

<p>改元が間近に迫り、いろいろたいへんだとは推察しますが、特にシステムの改修が必要となるような変更については、対応に時間が必要ですので、修正内容とリリース／Windows Update 配信時期について、あらかじめ余裕を持った情報公開をお願いできればと思います。</p>

<p><a href="https://support.microsoft.com/ja-jp/help/4470918/updates-for-may-2019-japan-era-change" rel="nofollow noopener" target="_blank">2019 年 5 月の新元号への変更に関する更新</a></p>

<blockquote>
<p>2019 年 4 月 1 日に新元号の名称が発表されました。弊社のエンジニアリング チームは、段階的に実稼働環境用の更新プログラムをリリースしていきます。<font color="Red">完了するまでに数か月程度かかる</font>ことがあります。</p>
</blockquote>

<p>改元までに間に合わない機能や制限事項があれば、わかりやすい形でのご提示を望みます。</p>

<p>（届かないか…と思いつつ、回り回って伝わればと期待を込めて）</p>

<h1>
<span id="続報" class="fragment"></span><a href="#%E7%B6%9A%E5%A0%B1"><i class="fa fa-link"></i></a>続報</h1>

<h4>
<span id="20190412-追記" class="fragment"></span><a href="#20190412-%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>[2019/04/12 追記]</h4>

<p><a href="https://news.mynavi.jp/article/win10tips-367/" rel="nofollow noopener" target="_blank">Windows 10ミニTips(367) 「令和」前にチェック! 和暦を設定する方法 | マイナビニュース</a></p>

<blockquote>
<p>先日筆者が日本マイクロソフトのセミナーに参加した際に知ったのだが、<font color="red">Windows 10でもハードコードが各所に残っているという</font>。通常はHKEY_LOCAL_MACHINE¥SYSTEM¥CurrentControlSet¥Control¥Nls¥Calendars¥Japanese¥Erasキーに並ぶ値から元号データを取得するものの、日本語MS-IMEやVBScriptエンジンはハードコードのため、OSが新元号に対応しても平成31年という表記になってしまうそうだ。</p>

<p>日本マイクロソフトは現在改善に取り組んでいる。だが、<font color="red">「令和」が適用される修正プログラムの公開は2019年4月末になりそうだ</font>。</p>
</blockquote>

<h4>
<span id="20190413-追記" class="fragment"></span><a href="#20190413-%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>[2019/04/13 追記]</h4>

<p><a href="https://www.microsoft.com/ja-jp/mscorp/newera/default.aspx" rel="nofollow noopener" target="_blank">新元号への対応について - Microsoft mscorp</a></p>

<blockquote>
<p>4 月 5 日時点で主要な機能更新を終え、お客様、パートナー様にご確認いただける段階になっております。<br>
4 月 1 日の新元号発表を受け、残りの作業である合字のデザイン、フォントの更新、レジストリ (設定データベース)、および IME の対応を進め、<font color="red">4 月中のご提供ができるよう</font>準備を進めております。</p>
</blockquote>

<h4>
<span id="20190414-追記" class="fragment"></span><a href="#20190414-%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>[2019/04/14 追記]</h4>

<p><a href="/ht_deko" class="user-mention js-hovercard" title="ht_deko" data-hovercard-target-type="user" data-hovercard-target-name="ht_deko">@ht_deko</a> さんの記事『<a href="https://qiita.com/ht_deko/items/249db60e1c99ba440969" id="reference-e51336f28340840a3c33">【令和】Microsoft の元号対応が迷走している件</a>』で気づきましたが、『<a href="https://www.microsoft.com/ja-jp/mscorp/newera/default.aspx" rel="nofollow noopener" target="_blank">新元号への対応について - Microsoft mscorp</a>』の記載がここにきて変更されたようです。</p>

<blockquote>
<p>元年表記をデフォルトに変更 (1 年表記にも変更可能)<br>
　 ↓<br>
元年表記も選択できるよう変更</p>
</blockquote>

<p>危惧する声を考慮したのか。<br>
さらなる変更の予兆でしょうか。<br>
『<a href="https://support.microsoft.com/ja-jp/help/4477957/new-japanese-era-updates-for-net-framework" rel="nofollow noopener" target="_blank">.NET Framework 用の日本の新元号対応更新プログラムの概要</a>』の記載は変わっていないようですが。</p>

<h4>
<span id="20190429-追記" class="fragment"></span><a href="#20190429-%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>[2019/04/29 追記]</h4>

<p>4月26日に配信開始された「令和」対応パッチ（プレビュー版）を Windows 10 Version 1803 環境にあてると、シングルクォーテーションなしの書式 "y年" で「元年」と出力される変更も適用されることが確認されました。<br>
Windows 8.1 や Windows 7 向けのパッチではこの変更は適用されないようです。</p>

<p>「令和」対応パッチ（プレビュー版）には別の問題も含まれているので、こちらをご参照ください。<br>
<a href="https://qiita.com/CodeOne/items/22004635d3c7cc533e5e" id="reference-d5e9d5c2acefa98404d7">【警鐘】[改元][Windows][.NET] 「令和」対応パッチで画面が横に伸びる、文字が見切れる ― Windows Update 手動更新はちょっと待った方がいい</a></p>

<h4>
<span id="20190506-追記" class="fragment"></span><a href="#20190506-%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>[2019/05/06 追記]</h4>

<p>Windows 10 Version 1809, Server 2019 向けの「令和」対応パッチ（プレビュー版）が、5月2日に <a href="https://support.microsoft.com/ja-jp/help/4501835/windows-10-update-kb4501835" rel="nofollow noopener" target="_blank">KB4501835</a>、5月3日にはその他の累積的な修正を含む <a href="https://support.microsoft.com/ja-jp/help/4495667/windows-10-update-kb4495667" rel="nofollow noopener" target="_blank">KB4495667</a> としてリリースされました。<br>
これらのパッチでは、Version 1803 向けと異なり、シングルクォーテーションなしの書式 "y年" で「元年」と出力される変更は確認されませんでした。</p>

<h4>
<span id="20190515-追記" class="fragment"></span><a href="#20190515-%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>[2019/05/15 追記]</h4>

<p>2019年5月15日（日本時間）、5月の Windows 月例更新プログラムで「令和」対応パッチの正式版（<a href="https://qiita.com/CodeOne/items/22004635d3c7cc533e5e">プレビュー版の不具合</a>を修正）がリリースされ、Windows Update 自動更新の対象となりました。<br>
同日に配信された .NET Framework 累積更新プログラム <a href="https://support.microsoft.com/ja-jp/help/4499405/may-14-2019-kb4499405-cumulative-update-for-net-framework-3-5-4-7-2-an" rel="nofollow noopener" target="_blank">KB4499405</a>（.NET Framework 3.5/4.7.2 向け：<a href="https://support.microsoft.com/ja-jp/help/4495590/may-14-2019-kb4495590-cumulative-update-for-net-framework" rel="nofollow noopener" target="_blank">KB4495590</a>）が適用されると、シングルクォーテーションなしの書式 "y年" で「元年」と出力されるようになることが確認されました（確認環境：Windows 10 Version 1809）。<br>
撤回されることはなく、この仕様で確定したと考えてよさそうです。<br>
いよいよ自動更新の対象になりましたので、まだの場合は対応を急ぎましょう。</p>

<h4>
<span id="20190528-追記" class="fragment"></span><a href="#20190528-%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>[2019/05/28 追記]</h4>

<p>2019年5月22日（日本時間）に一般公開された「Windows 10 May 2019 Update」（開発コード 19H1／バージョン 1903）を適用すると、[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Calendars\Japanese] InitialEraYear が "1年" から "元年" に変わり、VB6 で Format 関数の戻り値に反映されることが確認されました。<br>
.NET Framework の書式パターンを指定した文字列化や Excel の「和暦」セル書式には影響しません。</p>

<p>なお、現状では既知の不具合が多数ありますので、手動でパッチをあてる際は注意しましょう。<br>
<a href="https://forest.watch.impress.co.jp/docs/news/1186179.html" rel="nofollow noopener" target="_blank">「Windows 10 May 2019 Update」には既知の不具合が12件 ～手動更新には十分注意 - 窓の杜</a><br>
<a href="https://forest.watch.impress.co.jp/docs/news/1186644.html" rel="nofollow noopener" target="_blank">「May 2019 Update」に新たな既知の不具合が2件 ～手動更新には十分注意 - 窓の杜</a><br>
⇒ 5月30日（日本時間）、<a href="https://support.microsoft.com/ja-jp/help/4497935/windows-10-update-kb4497935" rel="nofollow noopener" target="_blank">修正パッチ</a>がリリースされました。</p>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<p>過去にはこうした記事もありましたね。</p>

<p><a href="https://qiita.com/gushwell/items/88411bb2c833e7d7ff6b" id="reference-732ede1121a8dd5cb5cd">マイクロソフトさん、お願いですから.NET Frameworkの動作を何の説明もなく変更するのはやめてください。- 改元対応で思うこと</a><br>
元号1文字表記の問題について、収束までの経緯。</p>

<p><a href="https://qiita.com/You_name_is_YU/items/3f6f9825c2d1c97c5ea6" id="reference-381cda245b7497eabdeb">新元号（平成の次の元号）対応におけるMicrosoftのセミナー「新元号とマイクロソフト製品における対応」を受けてきました</a></p>

<blockquote>
<p>Microsoft製品の新元号対応が難航していてスケジュールが遅れるかも。。。</p>
</blockquote>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p>一連の改元騒動について「和暦なんて使うから」という書き込みも散見されるので、あえて参考に挙げておきます。特殊な例とは思いますが、西暦を使っていれば安心とは限りません。<br>
<a href="https://dev.grapecity.co.jp/support/kb/detail.asp?id=83053&amp;utm_medium=link&amp;utm_source=tools-support-new-era-support" rel="nofollow noopener" target="_blank">[FlexGrid for WinForms] Windows 10 April 2018 Updateが適用された環境において、2019/5/1以降の日付に対してColumn.Formatで指定した書式が適用されない - ComponentOne for WinForms - ナレッジベースの詳細｜Developer Tools - グレープシティ株式会社</a> <a href="#fnref1">↩</a></p>
</li>

</ol>
</div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FCodeOne%2Fitems%2F97c5a84cfa7376cbb629&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FCodeOne%2Fitems%2F97c5a84cfa7376cbb629&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/CodeOne/items/97c5a84cfa7376cbb629/likers" class="css-1iupg5d">81</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">48</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/97c5a84cfa7376cbb629/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/CodeOne/items/97c5a84cfa7376cbb629/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/CodeOne/items/97c5a84cfa7376cbb629/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/CodeOne/items/97c5a84cfa7376cbb629/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/CodeOne/items/97c5a84cfa7376cbb629.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-590afef9-9852-47ac-9808-2782d1a52aa2">{"authorAnalyticsTrackingId":"UA-131645275-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-5074cc2c-1318-47ad-9815-b1fa35edafef"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-5074cc2c-1318-47ad-9815-b1fa35edafef">{}</script>
      
<div id="LoginModal-react-component-da76052f-99c9-4f25-a8cf-d132a1350c63"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-da76052f-99c9-4f25-a8cf-d132a1350c63">{}</script>
      
<div id="StockModal-react-component-87219790-685d-4f3d-b5ad-8a8868c88cf0"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-87219790-685d-4f3d-b5ad-8a8868c88cf0">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;BmsjPeA+f6KPtjq3efCQbTW7+Q1Coi5snEyet6GcbYn7wk/qVj+jAOAl4heFRGeWuxt3/fV0IySv2/pfVG2CWg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"元年表記の既定動作が突然変わった\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%83%E5%B9%B4%E8%A1%A8%E8%A8%98%E3%81%AE%E6%97%A2%E5%AE%9A%E5%8B%95%E4%BD%9C%E3%81%8C%E7%AA%81%E7%84%B6%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e「元年」表記の既定動作が突然変わった！\u003c/h1\u003e\n\n\u003cp\u003e新元号「令和」が発表されて間もない4月5日、一緒に仕事するエンジニアの方に教えていただき、愕然としました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://support.microsoft.com/ja-jp/help/4489192/april-2-2019-kb4489192\" rel=\"nofollow noopener\" target=\"_blank\"\u003e2019 年 4 月 3 日 — KB4489192 Windows 10 Version 1809 および Windows Server 2019 用の .NET Framework 3.5 および 4.7.2 の累積的な更新プログラム\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e書式パターンに \u003cfont color=\"Red\"\u003e\"年\" の文字を囲む半角の引用符が含まれているかいないかに関係なく\u003c/font\u003e、1 年目の日付の書式が変更されている日本の元号の元年の文字を出力できます。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e改元まで残り1か月を切り、新元号の Windows への組み込みが差し迫った、このタイミングで？\u003cbr\u003e\n本気でしょうか。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://support.microsoft.com/ja-jp/help/4477957\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NET Framework 用の日本の新元号対応更新プログラムの概要（2019/4/3付）\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e日本の元号の書式で\u003cfont color=\"Red\"\u003e元年の文字を出力するにはシングル クォーテーションを付ける必要があった問題を解決する新しい品質更新\u003c/font\u003eプログラムも含まれています。そのため、.NET Framework でカスタムの日付と時刻の書式に “y年” または “y’年'” のいずれを使用しても、年の数値 1 を元という書式で示すことができるようになりました。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eどうやら本気のようです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"どうなるのか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%81%86%E3%81%AA%E3%82%8B%E3%81%AE%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどうなるのか？\u003c/h3\u003e\n\n\u003cp\u003e以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ejapanseCalendarCulture\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eCultureInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ja-JP\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTimeFormat\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eCalendar\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eJapaneseCalendar\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"平成元年\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1989\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ggyy年\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ejapanseCalendarCulture\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"令和元年\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2019\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ggyy年\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ejapanseCalendarCulture\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"何が変わったのか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%95%E3%81%8C%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e何が変わったのか？\u003c/h3\u003e\n\n\u003cp\u003eこれまでの改元対応では、「元年」表記されるのは \"yy'年'\" のように「年」をシングルクォーテーションで囲んだときだけでした。\u003cbr\u003e\n\"yy年\" のようにシングルクォーテーションで囲まない場合、これまでは「01年」でしたが、今後は「元年」と表記されるようになります。\u003c/p\u003e\n\n\u003cp\u003e※ここでは書式 \"yy\" を例に説明を進めますので、書式 \"y\" の場合は「1年」に読み替えてください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"何が困るのか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%95%E3%81%8C%E5%9B%B0%E3%82%8B%E3%81%AE%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e何が困るのか？\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e「01年」が「元年」と表記されるように変わる。（これ自体は仕様として許容できることが多いでしょう）\u003c/li\u003e\n\u003cli\u003e和暦文字列の年部分が数値であることを前提とした処理でエラーが発生する。\u003c/li\u003e\n\u003cli\u003e和暦文字列の年部分が2文字であることを前提とした処理でエラーが発生する。\u003c/li\u003e\n\u003cli\u003eカルチャを指定しない DateTime.Parse, DateTime.TryParse メソッドが「元年」の和暦文字列を解釈できない。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e※こうした文字列解析処理の是非はここでは問題にしません。現実にありうるなら対処が必要、という視点で書いています。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"これまでの経緯\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%93%E3%82%8C%E3%81%BE%E3%81%A7%E3%81%AE%E7%B5%8C%E7%B7%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eこれまでの経緯\u003c/h3\u003e\n\n\u003cp\u003e2018年8月、\u003ca href=\"https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NET Blog（英語）\u003c/a\u003eで .NET Framework で「元年」表記が既定になるとアナウンスされました。\u003c/p\u003e\n\n\u003cp\u003e2018年10月、対応版のパッチがリリースされ、実際に書式 \"yy'年'\" で和暦初年が「元年」に文字列化されることが確認できました。\u003c/p\u003e\n\n\u003cp\u003e一方で、「年」をシングルクォーテーションで囲まない \"yy年\" 書式による和暦初年文字列は、新元号検証用のレジストリ設定が公開された後も後述する FormatJapaneseFirstYearAsANumber 設定に関係なく「01年」でした。\u003c/p\u003e\n\n\u003cp\u003e※この間の実行結果は、『\u003ca href=\"https://devlog.grapecity.co.jp/entry/2018/10/26/dotnet-first-year-era\" rel=\"nofollow noopener\" target=\"_blank\"\u003e「元年」に対応した.NET Frameworkを試してみた - GrapeCity.devlog\u003c/a\u003e』や『\u003ca href=\"https://www.atmarkit.co.jp/ait/articles/0306/06/news004.html#breakingchange\" rel=\"nofollow noopener\" target=\"_blank\"\u003e西暦と和暦を変換するには？：.NET TIPS - ＠IT\u003c/a\u003e』にあるとおりです（いずれも 2019/4/14 時点）。\u003c/p\u003e\n\n\u003cp\u003e中途半端な仕様だなとは感じつつも、特に変更予定の告知もなく、公式に検証方法まで案内されているので、\u003cstrong\u003e「この仕様で行くのだろう。シングルクォーテーションはつけていないので対応は不要だ」\u003c/strong\u003eと判断した人は少なくないでしょう。\u003c/p\u003e\n\n\u003cp\u003eもちろん「最終的にはシングルクォーテーションなしにも対応するのでは？」という可能性は想定しえたわけですが、明確な予告のない状況で具体的な対応に踏み切ることはそうそうできません。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"リリース状況\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E7%8A%B6%E6%B3%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eリリース状況\u003c/h3\u003e\n\n\u003cp\u003eこの KB4489192 のリリース事情がまた複雑です。\u003c/p\u003e\n\n\u003cp\u003e2018年3月20日（日本時間）、.NET Framework 2018年3月更新がリリースされました。\u003cbr\u003e\nこのパッチによって \"y年\" が「元年」に変換されるようになることが、リリース報告記事『\u003ca href=\"https://devblogs.microsoft.com/dotnet/net-framework-march-2019-update/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NET Framework March 2019 Update | .NET Blog（英語）\u003c/a\u003e』に記載されています。\u003c/p\u003e\n\n\u003cp\u003e※上記\u003ca href=\"https://www.atmarkit.co.jp/ait/articles/0306/06/news004.html#breakingchange\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@IT記事\u003c/a\u003eの共著者の一人である山本康彦氏が、3月20日に\u003ca href=\"https://twitter.com/biac/status/1108527703269867521\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTwitter\u003c/a\u003eでこの記事を取り上げて話題にしていました。\u003c/p\u003e\n\n\u003cp\u003eしかし、そこに記載のない Windows 10 Version 1809 / Server 2019 向けの更新（KB4489192）は4月3日（日本時間）までずれ込みました（4/14現在もHTMLの title は「2019 年 3 月 20 日 — KB4489192」のままです）。\u003c/p\u003e\n\n\u003cp\u003e『\u003ca href=\"https://support.microsoft.com/ja-jp/help/4477957/new-japanese-era-updates-for-net-framework\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NET Framework 用の日本の新元号対応更新プログラムの概要\u003c/a\u003e』にOSごとのKB一覧がありますが、\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWindows 8.1 以前のバージョンのサポートされる Windows 用に .NET Framework のセキュリティおよび品質ロールアップを 2019 年 3 月にリリースしませんでした。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eとありますので、実際には Windows 8.1 以前（Windows 7, 8.1, Server 2008/R2, 2012/R2）向けのリリースも4月1日までずれ込んだ可能性があります。\u003c/p\u003e\n\n\u003cp\u003eWindows 10 1809 / Server 2019 向けの KB4489192 は、\u003ca href=\"http://www.catalog.update.microsoft.com/Search.aspx?q=KB4489192\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMicrosoft Update カタログ\u003c/a\u003e からダウンロードして Windows 10 Version 1809（October 2018 Update）環境にインストールできますが、4月14日時点でまだ Windows Update には上がってこないようです。\u003c/p\u003e\n\n\u003cp\u003e※『\u003ca href=\"https://yamanxworld.blogspot.com/2019/04/windows-update-2019-4-2-4-3-drs5.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e山市良のえぬなんとかわーるど: 本日の Windows Update － 2019 年 4 月 2 日（4 月に流れた 3 月 D、RS5 のみ）\u003c/a\u003e』にこの辺りの経緯が書いてあります。\u003c/p\u003e\n\n\u003cp\u003e※Windows 8.1 以前のOS向け .NET Framework 2018年3月更新の個々の Windows Update 配信状況は把握できておりません。\u003c/p\u003e\n\n\u003cp\u003eリリース済みですので、いつ Windows Update で配信されてもおかしくない状況ではあります。\u003cbr\u003e\n逡巡しているかのような上記状況から、撤回／延期される可能性もゼロとは言い切れませんが。\u003cbr\u003e\n⇒ [\u003ca href=\"#20190414-%E8%BF%BD%E8%A8%98\"\u003e2019/04/14 追記\u003c/a\u003e]、[\u003ca href=\"#20190429-%E8%BF%BD%E8%A8%98\"\u003e2019/04/29 追記\u003c/a\u003e]、[\u003ca href=\"#20190515-%E8%BF%BD%E8%A8%98\"\u003e2019/15/15 追記\u003c/a\u003e] に続報があります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"マイクロソフト社の言い分推測\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E7%A4%BE%E3%81%AE%E8%A8%80%E3%81%84%E5%88%86%E6%8E%A8%E6%B8%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマイクロソフト社の言い分（推測）\u003c/h3\u003e\n\n\u003cp\u003e「品質更新」ですから、当初よりシングルクォーテーションなしにも対応すべきだった、ということなのでしょう。\u003c/p\u003e\n\n\u003cp\u003e『\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/custom-numeric-format-strings\" rel=\"nofollow noopener\" target=\"_blank\"\u003eカスタム数値書式指定文字列 | Microsoft Docs\u003c/a\u003e』には\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eリテラル文字列全体を引用符のアポストロフィで囲みます。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eとありますので、囲んでいない方が悪い ⇒ 改善リリースもあらかじめ通知しなくてもいいだろう、という判断なのかもしれません。\u003c/p\u003e\n\n\u003cp\u003e※あくまで推測であり、違っているかもしれませんが、それなら不備と認識した時点で、余裕を持った事前のアナウンスが欲しかったです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"そうはいかない現実\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%86%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84%E7%8F%BE%E5%AE%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eそうはいかない現実\u003c/h3\u003e\n\n\u003cp\u003e現実には著名なサイトの技術記事でも和暦書式として \"ggyy年\" が普通に使われています。\u003cbr\u003e\nということは、現場レベルでもシングルクォーテーションなしの書式で和暦文字列化しているケースはかなり多いと考えられます。\u003c/p\u003e\n\n\u003cp\u003e問題が起こらないようにするためには、調査、実装、テスト、ユーザー様への通知が必要となります。\u003c/p\u003e\n\n\u003cp\u003e新元号「令和」の Windows 組み込みは間近に迫っています。\u003cbr\u003e\nそれまでに何とか直せば大丈夫、ということではありません。\u003cbr\u003e\n生年月日など、平成元年のデータは現にシステムで扱っていることもあります。\u003cbr\u003e\n急に「01年」が「元年」に変わっては困るのです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"どうすればいいのか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%81%86%E3%81%99%E3%82%8C%E3%81%B0%E3%81%84%E3%81%84%E3%81%AE%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどうすればいいのか？\u003c/h1\u003e\n\n\u003cp\u003e\"yy'年'\" のようにシングルクォーテーションで囲っていた場合は、すでに既定で「元年」になっていますので、対応済みでしょう。\u003cbr\u003e\n問題は \"yy年\" のように指定していた場合です。\u003cbr\u003e\nKB4489192 が適用された後も「01年」表記を続けるためには対応が必要となります。\u003c/p\u003e\n\n\u003cp\u003e※システム内で「01年」表記に戻すことができたとしても、連携するシステムから「元年」のデータを受け取る可能性がありますので、協調して対応を進めましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"net-core-の場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#net-core-%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e.NET Core の場合\u003c/h3\u003e\n\n\u003cp\u003eプロジェクト直下にコンテンツとして以下のような runtimeconfig.template.json を配置してビルドすると、{AppName}.runtimeconfig.json に設定が追記され、既定の「元年」表記から「01年」表記に変わります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"json\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eruntimeconfig.template.json\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"configProperties\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e　 ↓ （ビルド出力）\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"json\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e{AppName}.runtimeconfig.json（例）\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"runtimeOptions\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"tfm\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"netcoreapp2.2\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"framework\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Microsoft.AspNetCore.App\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"version\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"2.2.0\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"configProperties\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"System.GC.Server\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"net-46-以降で動作する場合windows-formswpf\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#net-46-%E4%BB%A5%E9%99%8D%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88windows-formswpf\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e.NET 4.6 以降で動作する場合（Windows Forms／WPF）\u003c/h3\u003e\n\n\u003cp\u003e構成ファイル（App.config ⇒ {AppName}.exe.config）に以下のような AppContextSwitchOverrides 要素を追記すると、既定の「元年」表記が無効となり、「01年」表記になります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eApp.config\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\"1.0\" encoding=\"utf-8\"?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;configuration\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;runtime\u0026gt;\u003c/span\u003e\n 　　:\n    \u003cspan class=\"nt\"\u003e\u0026lt;AppContextSwitchOverrides\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber=true\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n 　　:\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e.NET 4 系はインプレースアップグレードですので、ターゲットフレームワークが .NET 4.6 未満でも、.NET 4.6 以降がインストールされた環境ではこの設定が有効となります。\u003c/p\u003e\n\n\u003cp\u003eターゲットフレームワークが .NET 4.6 以上の場合、\u003ca href=\"https://docs.microsoft.com/en-us/dotnet/api/system.appcontext.setswitch\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAppContext.SetSwitch(String, Boolean)\u003c/a\u003e メソッドで指定することも可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eAppContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetSwitch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Switch.System.Globalization.FormatJapaneseFirstYearAsANumber\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eただし、この設定にはキャッシュされる仕組みがあり（\u003ca href=\"https://referencesource.microsoft.com/#mscorlib/system/AppContext/AppContextSwitches.cs,cb82ff2a6201f14f\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSystem.AppContextSwitches ソースコード参照\u003c/a\u003e）、一度 String.Format や DateTime.ToString による日付文字列化を行うと、その後に SetSwitch しても効かずに「元年」出力されたりします。設定のタイミングが遅れないよう、記述箇所には注意しましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"net-46-以降で動作する場合aspnet\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#net-46-%E4%BB%A5%E9%99%8D%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88aspnet\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e.NET 4.6 以降で動作する場合（ASP.NET）\u003c/h3\u003e\n\n\u003cp\u003eWeb.config に以下のような設定を追記すると、既定の「元年」表記が無効となり、「01年」表記になります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eWeb.config\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\"1.0\" encoding=\"utf-8\"?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;configuration\u0026gt;\u003c/span\u003e\n    :\n  \u003cspan class=\"nt\"\u003e\u0026lt;appSettings\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;add\u003c/span\u003e \u003cspan class=\"na\"\u003ekey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"AppContext.SetSwitch:Switch.System.Globalization.FormatJapaneseFirstYearAsANumber\"\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"true\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n     :\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"net-35-や-net-452-までのランタイムで動作する場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#net-35-%E3%82%84-net-452-%E3%81%BE%E3%81%A7%E3%81%AE%E3%83%A9%E3%83%B3%E3%82%BF%E3%82%A4%E3%83%A0%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e.NET 3.5 や .NET 4.5.2 までのランタイムで動作する場合\u003c/h3\u003e\n\n\u003cp\u003e※Windows 10 の場合、.NET Framework 4.6 以上がインストールされていますので、.NET 4 系のアプリケーションは（ターゲットフレームワークが 4.5.2 以下だとしても）該当しません。\u003c/p\u003e\n\n\u003cp\u003e『\u003ca href=\"https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHandling a new era in the Japanese calendar in .NET | .NET Blog\u003c/a\u003e』や『\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/standard/datetime/working-with-calendars\" rel=\"nofollow noopener\" target=\"_blank\"\u003eカレンダーの使用 | Microsoft Docs\u003c/a\u003e』で紹介されているように、レジストリ登録することで「01年」表記に戻すことが可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eKey     HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\AppContext\nName    Switch.System.Globalization.FormatJapaneseFirstYearAsANumber\nType    REG_SZ\nValue   1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eただし、アプリケーション単位でなく、マシン全体の設定になってしまいます。\u003cbr\u003e\n試してみたところ、.NET 4.6 以降で動作するアプリケーションには影響しないようです。\u003c/p\u003e\n\n\u003cp\u003eWOW64（64ビット Windows で x86 ターゲット）の場合は Key が変わります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eKey     HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Microsoft\\.NETFramework\\AppContext\nName    Switch.System.Globalization.FormatJapaneseFirstYearAsANumber\nType    REG_SZ\nValue   1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eWOW64 については、上記 \u003ca href=\"https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NET Blog\u003c/a\u003e や \u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/standard/datetime/working-with-calendars\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMicrosoft Docs\u003c/a\u003e にも記載がありません。\u003cbr\u003e\nきちんと案内しなくて大丈夫なのだろうか。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"別解というより時間的余裕があるなら王道\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%A5%E8%A7%A3%E3%81%A8%E3%81%84%E3%81%86%E3%82%88%E3%82%8A%E6%99%82%E9%96%93%E7%9A%84%E4%BD%99%E8%A3%95%E3%81%8C%E3%81%82%E3%82%8B%E3%81%AA%E3%82%89%E7%8E%8B%E9%81%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e別解（というより時間的余裕があるなら王道）\u003c/h3\u003e\n\n\u003cp\u003eFormatJapaneseFirstYearAsANumber=true は設定せずに、「元年」表記でも問題ないようにコードを修正します。\u003c/p\u003e\n\n\u003cp\u003e「修正なしで問題ないだろう」と思っても、それを保証するためには、ソースコード全体の調査とある程度の動作検証が必要でしょう。\u003cbr\u003e\n影響するようなコードを書いた覚えがなくても、ほかのプログラマが書いているかもしれません。\u003cbr\u003e\nコード内に問題が見つからなくても、使用しているサードパーティーコンポーネントで問題が発生するかもしれません\u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" title=\"一連の改元騒動について「和暦なんて使うから」という書き込みも散見されるので、あえて参考に挙げておきます。特殊な例とは思いますが、西暦を使っていれば安心とは限りません。\n[FlexGrid for WinForms] Windows 10 April 2018 Updateが適用された環境において、2019/5/1以降の日付に対してColumn.Formatで指定した書式が適用されない - ComponentOne for WinForms - ナレッジベースの詳細｜Developer Tools - グレープシティ株式会社\"\u003e1\u003c/a\u003e\u003c/sup\u003e。\u003cbr\u003e\nシステム単体では問題がなくても、連携するシステムに「元年」を送ってエラーになることがあるかもしれません。\u003c/p\u003e\n\n\u003cp\u003e\"yy\" の直後に \"'月'\" や \"月\" がつかなければ「元年」表記にはならないので、どうしても「01」表記にしたい箇所については、年部分とその後ろを別々に文字列化して結合する、といった対応が考えられます。\u003c/p\u003e\n\n\u003cp\u003eなお、実行環境を完全に制御できる場合でない限り、 和暦初年が必ず「元年」表記になることを前提とする、逆の罠にはまらないように気をつけましょう。\u003cbr\u003e\nそのコードは、「元年」表記が既定で有効になる前の環境で動く可能性があります。\u003c/p\u003e\n\n\u003cp\u003e※修正箇所については上記「何が困るのか？」をご参照ください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"vb6visual-basic-60vbavisual-basic-for-applications-は\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#vb6visual-basic-60vbavisual-basic-for-applications-%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eVB6（Visual Basic 6.0）／VBA（Visual Basic for Applications） は？\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://support.microsoft.com/ja-jp/help/4493509/windows-10-update-kb4493509\" rel=\"nofollow noopener\" target=\"_blank\"\u003e2019年4月セキュリティ更新（KB4493509）\u003c/a\u003eを適用した Windows 10 Version 1809 環境での VB6/VBA 実行結果は以下のようになりました。\u003c/p\u003e\n\n\u003cp\u003e※新元号のレジストリ設定 \"令和_令_Reiwa_R\" を手動で登録しています。\u003c/p\u003e\n\n\u003cp\u003e※「←」の右は2019年4月セキュリティ更新をあてる以前の確認結果です。\u003cbr\u003e\nIsDate, CDate が新元号レジストリ設定を解釈できるように、Format は「元年」でなく「01年」を返すように変わりました。\u003cbr\u003e\n⇒ \u003ca href=\"/tfukumori\" class=\"user-mention js-hovercard\" title=\"tfukumori\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"tfukumori\"\u003e@tfukumori\u003c/a\u003e さんの記事『\u003ca href=\"https://qiita.com/tfukumori/items/aa9179f961eca86f192f\" id=\"reference-930b8be5c9558fbd4d6b\"\u003eVB6、およびOffice VBAの元号対応の状況について\u003c/a\u003e』に環境別の詳細な検証結果があります。\u003cbr\u003e\nただし、Windows 10 の次期大型アップデート「19H1」の Insider Preview 版では、Format 関数の依存する元年／1年のレジストリ設定　[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Calendars\\Japanese] InitialEraYear が \"元年\" になっています（\u003ca href=\"https://support.microsoft.com/ja-jp/help/4469068/summary-of-new-japanese-era-updates-kb4469068\" rel=\"nofollow noopener\" target=\"_blank\"\u003eKB4469068「元年対 1年」参考\u003c/a\u003e）。\u003cbr\u003e\n万全を期すならどちらを返しても問題ないように対応しておくのが安心と言えるでしょう。\u003cbr\u003e\n⇒ 正式版の Windows 10 Version 1903 にアップデートしたところ、既定が \"元年\" に変わっていました（\u003ca href=\"#20190528-%E8%BF%BD%E8%A8%98\"\u003e[2019/05/28 追記]\u003c/a\u003e）。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"平成01年02月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"平成元年02月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"令和01年05月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\u003cspan class=\"err\"\u003e（←\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\u003cspan class=\"err\"\u003e）\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"令和元年05月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eTrue\u003c/span\u003e\u003cspan class=\"err\"\u003e（←\u003c/span\u003e \u003cspan class=\"k\"\u003eFalse\u003c/span\u003e\u003cspan class=\"err\"\u003e）\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"平成01年02月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e1989\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e02\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e \n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"平成元年02月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e1989\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e02\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e \n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"令和01年05月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e2019\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e05\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"err\"\u003e（←\u003c/span\u003e \u003cspan class=\"err\"\u003e実行時ｴﾗｰ\u003c/span\u003e \u003cspan class=\"c1\"\u003e'13': 型が一致しません。）\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"令和元年05月01日\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e2019\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e05\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"err\"\u003e（←\u003c/span\u003e \u003cspan class=\"err\"\u003e実行時ｴﾗｰ\u003c/span\u003e \u003cspan class=\"c1\"\u003e'13': 型が一致しません。）\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"1989/02/01\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"gggee年\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"err\"\u003e（平成元年\u003c/span\u003e \u003cspan class=\"err\"\u003e←）平成\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"err\"\u003e年（←\u003c/span\u003e \u003cspan class=\"err\"\u003e平成元年）\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003eVBA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFormat\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"2019/05/01\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"gggee年\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"err\"\u003e（令和元年\u003c/span\u003e \u003cspan class=\"err\"\u003e←）令和\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"err\"\u003e年（←\u003c/span\u003e \u003cspan class=\"err\"\u003e令和元年）\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eVB6 も Windows 10 でランタイムはサポートされているわけですから、IsDate, CDate, Format 等の動作について、対応方法まで明示する義務はないとしても、最終的にどう変わるのか、あるいは変わらないのか、わかりやすい形の公式情報が欲しいところです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"windows-update-で-kb4489192-が配信されたら大騒ぎにならないか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#windows-update-%E3%81%A7-kb4489192-%E3%81%8C%E9%85%8D%E4%BF%A1%E3%81%95%E3%82%8C%E3%81%9F%E3%82%89%E5%A4%A7%E9%A8%92%E3%81%8E%E3%81%AB%E3%81%AA%E3%82%89%E3%81%AA%E3%81%84%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWindows Update で KB4489192 が配信されたら大騒ぎにならないか？\u003c/h1\u003e\n\n\u003cp\u003e一度リリースして後に撤回された新元号「？？」仮表記みたいに（あるいはそれ以上に）。\u003cbr\u003e\n「大丈夫、皆対応しているよ」と、杞憂であればいいのですが。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"マイクロソフト様\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E6%A7%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマイクロソフト様\u003c/h1\u003e\n\n\u003cp\u003e改元が間近に迫り、いろいろたいへんだとは推察しますが、特にシステムの改修が必要となるような変更については、対応に時間が必要ですので、修正内容とリリース／Windows Update 配信時期について、あらかじめ余裕を持った情報公開をお願いできればと思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://support.microsoft.com/ja-jp/help/4470918/updates-for-may-2019-japan-era-change\" rel=\"nofollow noopener\" target=\"_blank\"\u003e2019 年 5 月の新元号への変更に関する更新\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e2019 年 4 月 1 日に新元号の名称が発表されました。弊社のエンジニアリング チームは、段階的に実稼働環境用の更新プログラムをリリースしていきます。\u003cfont color=\"Red\"\u003e完了するまでに数か月程度かかる\u003c/font\u003eことがあります。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e改元までに間に合わない機能や制限事項があれば、わかりやすい形でのご提示を望みます。\u003c/p\u003e\n\n\u003cp\u003e（届かないか…と思いつつ、回り回って伝わればと期待を込めて）\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"続報\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B6%9A%E5%A0%B1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e続報\u003c/h1\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20190412-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20190412-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[2019/04/12 追記]\u003c/h4\u003e\n\n\u003cp\u003e\u003ca href=\"https://news.mynavi.jp/article/win10tips-367/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWindows 10ミニTips(367) 「令和」前にチェック! 和暦を設定する方法 | マイナビニュース\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e先日筆者が日本マイクロソフトのセミナーに参加した際に知ったのだが、\u003cfont color=\"red\"\u003eWindows 10でもハードコードが各所に残っているという\u003c/font\u003e。通常はHKEY_LOCAL_MACHINE¥SYSTEM¥CurrentControlSet¥Control¥Nls¥Calendars¥Japanese¥Erasキーに並ぶ値から元号データを取得するものの、日本語MS-IMEやVBScriptエンジンはハードコードのため、OSが新元号に対応しても平成31年という表記になってしまうそうだ。\u003c/p\u003e\n\n\u003cp\u003e日本マイクロソフトは現在改善に取り組んでいる。だが、\u003cfont color=\"red\"\u003e「令和」が適用される修正プログラムの公開は2019年4月末になりそうだ\u003c/font\u003e。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20190413-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20190413-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[2019/04/13 追記]\u003c/h4\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.microsoft.com/ja-jp/mscorp/newera/default.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003e新元号への対応について - Microsoft mscorp\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e4 月 5 日時点で主要な機能更新を終え、お客様、パートナー様にご確認いただける段階になっております。\u003cbr\u003e\n4 月 1 日の新元号発表を受け、残りの作業である合字のデザイン、フォントの更新、レジストリ (設定データベース)、および IME の対応を進め、\u003cfont color=\"red\"\u003e4 月中のご提供ができるよう\u003c/font\u003e準備を進めております。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20190414-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20190414-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[2019/04/14 追記]\u003c/h4\u003e\n\n\u003cp\u003e\u003ca href=\"/ht_deko\" class=\"user-mention js-hovercard\" title=\"ht_deko\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"ht_deko\"\u003e@ht_deko\u003c/a\u003e さんの記事『\u003ca href=\"https://qiita.com/ht_deko/items/249db60e1c99ba440969\" id=\"reference-e51336f28340840a3c33\"\u003e【令和】Microsoft の元号対応が迷走している件\u003c/a\u003e』で気づきましたが、『\u003ca href=\"https://www.microsoft.com/ja-jp/mscorp/newera/default.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003e新元号への対応について - Microsoft mscorp\u003c/a\u003e』の記載がここにきて変更されたようです。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e元年表記をデフォルトに変更 (1 年表記にも変更可能)\u003cbr\u003e\n　 ↓\u003cbr\u003e\n元年表記も選択できるよう変更\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e危惧する声を考慮したのか。\u003cbr\u003e\nさらなる変更の予兆でしょうか。\u003cbr\u003e\n『\u003ca href=\"https://support.microsoft.com/ja-jp/help/4477957/new-japanese-era-updates-for-net-framework\" rel=\"nofollow noopener\" target=\"_blank\"\u003e.NET Framework 用の日本の新元号対応更新プログラムの概要\u003c/a\u003e』の記載は変わっていないようですが。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20190429-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20190429-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[2019/04/29 追記]\u003c/h4\u003e\n\n\u003cp\u003e4月26日に配信開始された「令和」対応パッチ（プレビュー版）を Windows 10 Version 1803 環境にあてると、シングルクォーテーションなしの書式 \"y年\" で「元年」と出力される変更も適用されることが確認されました。\u003cbr\u003e\nWindows 8.1 や Windows 7 向けのパッチではこの変更は適用されないようです。\u003c/p\u003e\n\n\u003cp\u003e「令和」対応パッチ（プレビュー版）には別の問題も含まれているので、こちらをご参照ください。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/CodeOne/items/22004635d3c7cc533e5e\" id=\"reference-d5e9d5c2acefa98404d7\"\u003e【警鐘】[改元][Windows][.NET] 「令和」対応パッチで画面が横に伸びる、文字が見切れる ― Windows Update 手動更新はちょっと待った方がいい\u003c/a\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20190506-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20190506-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[2019/05/06 追記]\u003c/h4\u003e\n\n\u003cp\u003eWindows 10 Version 1809, Server 2019 向けの「令和」対応パッチ（プレビュー版）が、5月2日に \u003ca href=\"https://support.microsoft.com/ja-jp/help/4501835/windows-10-update-kb4501835\" rel=\"nofollow noopener\" target=\"_blank\"\u003eKB4501835\u003c/a\u003e、5月3日にはその他の累積的な修正を含む \u003ca href=\"https://support.microsoft.com/ja-jp/help/4495667/windows-10-update-kb4495667\" rel=\"nofollow noopener\" target=\"_blank\"\u003eKB4495667\u003c/a\u003e としてリリースされました。\u003cbr\u003e\nこれらのパッチでは、Version 1803 向けと異なり、シングルクォーテーションなしの書式 \"y年\" で「元年」と出力される変更は確認されませんでした。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20190515-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20190515-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[2019/05/15 追記]\u003c/h4\u003e\n\n\u003cp\u003e2019年5月15日（日本時間）、5月の Windows 月例更新プログラムで「令和」対応パッチの正式版（\u003ca href=\"https://qiita.com/CodeOne/items/22004635d3c7cc533e5e\"\u003eプレビュー版の不具合\u003c/a\u003eを修正）がリリースされ、Windows Update 自動更新の対象となりました。\u003cbr\u003e\n同日に配信された .NET Framework 累積更新プログラム \u003ca href=\"https://support.microsoft.com/ja-jp/help/4499405/may-14-2019-kb4499405-cumulative-update-for-net-framework-3-5-4-7-2-an\" rel=\"nofollow noopener\" target=\"_blank\"\u003eKB4499405\u003c/a\u003e（.NET Framework 3.5/4.7.2 向け：\u003ca href=\"https://support.microsoft.com/ja-jp/help/4495590/may-14-2019-kb4495590-cumulative-update-for-net-framework\" rel=\"nofollow noopener\" target=\"_blank\"\u003eKB4495590\u003c/a\u003e）が適用されると、シングルクォーテーションなしの書式 \"y年\" で「元年」と出力されるようになることが確認されました（確認環境：Windows 10 Version 1809）。\u003cbr\u003e\n撤回されることはなく、この仕様で確定したと考えてよさそうです。\u003cbr\u003e\nいよいよ自動更新の対象になりましたので、まだの場合は対応を急ぎましょう。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20190528-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20190528-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e[2019/05/28 追記]\u003c/h4\u003e\n\n\u003cp\u003e2019年5月22日（日本時間）に一般公開された「Windows 10 May 2019 Update」（開発コード 19H1／バージョン 1903）を適用すると、[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Calendars\\Japanese] InitialEraYear が \"1年\" から \"元年\" に変わり、VB6 で Format 関数の戻り値に反映されることが確認されました。\u003cbr\u003e\n.NET Framework の書式パターンを指定した文字列化や Excel の「和暦」セル書式には影響しません。\u003c/p\u003e\n\n\u003cp\u003eなお、現状では既知の不具合が多数ありますので、手動でパッチをあてる際は注意しましょう。\u003cbr\u003e\n\u003ca href=\"https://forest.watch.impress.co.jp/docs/news/1186179.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e「Windows 10 May 2019 Update」には既知の不具合が12件 ～手動更新には十分注意 - 窓の杜\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://forest.watch.impress.co.jp/docs/news/1186644.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e「May 2019 Update」に新たな既知の不具合が2件 ～手動更新には十分注意 - 窓の杜\u003c/a\u003e\u003cbr\u003e\n⇒ 5月30日（日本時間）、\u003ca href=\"https://support.microsoft.com/ja-jp/help/4497935/windows-10-update-kb4497935\" rel=\"nofollow noopener\" target=\"_blank\"\u003e修正パッチ\u003c/a\u003eがリリースされました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cp\u003e過去にはこうした記事もありましたね。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/gushwell/items/88411bb2c833e7d7ff6b\" id=\"reference-732ede1121a8dd5cb5cd\"\u003eマイクロソフトさん、お願いですから.NET Frameworkの動作を何の説明もなく変更するのはやめてください。- 改元対応で思うこと\u003c/a\u003e\u003cbr\u003e\n元号1文字表記の問題について、収束までの経緯。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/You_name_is_YU/items/3f6f9825c2d1c97c5ea6\" id=\"reference-381cda245b7497eabdeb\"\u003e新元号（平成の次の元号）対応におけるMicrosoftのセミナー「新元号とマイクロソフト製品における対応」を受けてきました\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eMicrosoft製品の新元号対応が難航していてスケジュールが遅れるかも。。。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003e一連の改元騒動について「和暦なんて使うから」という書き込みも散見されるので、あえて参考に挙げておきます。特殊な例とは思いますが、西暦を使っていれば安心とは限りません。\u003cbr\u003e\n\u003ca href=\"https://dev.grapecity.co.jp/support/kb/detail.asp?id=83053\u0026amp;utm_medium=link\u0026amp;utm_source=tools-support-new-era-support\" rel=\"nofollow noopener\" target=\"_blank\"\u003e[FlexGrid for WinForms] Windows 10 April 2018 Updateが適用された環境において、2019/5/1以降の日付に対してColumn.Formatで指定した書式が適用されない - ComponentOne for WinForms - ナレッジベースの詳細｜Developer Tools - グレープシティ株式会社\u003c/a\u003e \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","createdAt":"2019-04-05T17:18:18Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"0MRV538TRXNN7XU6GrcjnwF0BXJjI5tR--9Q01HlvL6B/Zt3kx--kYXgiUIYUcpfwBwpNisPjg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-06-05T03:44:12Z","likesCount":81,"linkUrl":"https://qiita.com/CodeOne/items/97c5a84cfa7376cbb629","organization":null,"originalId":852850,"stockedCount":48,"title":"[.NET][改元] 「元年」表記に変わる日付書式が今になって拡大！（フレームワーク別の対策が必要）――マイクロソフト様、重大な変更をしれっとリリースしないで","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%83%E5%B9%B4%E8%A1%A8%E8%A8%98%E3%81%AE%E6%97%A2%E5%AE%9A%E5%8B%95%E4%BD%9C%E3%81%8C%E7%AA%81%E7%84%B6%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F\"\u003e「元年」表記の既定動作が突然変わった！\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%81%86%E3%81%AA%E3%82%8B%E3%81%AE%E3%81%8B\"\u003eどうなるのか？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%95%E3%81%8C%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B\"\u003e何が変わったのか？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%95%E3%81%8C%E5%9B%B0%E3%82%8B%E3%81%AE%E3%81%8B\"\u003e何が困るのか？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%93%E3%82%8C%E3%81%BE%E3%81%A7%E3%81%AE%E7%B5%8C%E7%B7%AF\"\u003eこれまでの経緯\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E7%8A%B6%E6%B3%81\"\u003eリリース状況\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E7%A4%BE%E3%81%AE%E8%A8%80%E3%81%84%E5%88%86%E6%8E%A8%E6%B8%AC\"\u003eマイクロソフト社の言い分（推測）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%86%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84%E7%8F%BE%E5%AE%9F\"\u003eそうはいかない現実\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%81%86%E3%81%99%E3%82%8C%E3%81%B0%E3%81%84%E3%81%84%E3%81%AE%E3%81%8B\"\u003eどうすればいいのか？\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#net-core-%E3%81%AE%E5%A0%B4%E5%90%88\"\u003e.NET Core の場合\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#net-46-%E4%BB%A5%E9%99%8D%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88windows-formswpf\"\u003e.NET 4.6 以降で動作する場合（Windows Forms／WPF）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#net-46-%E4%BB%A5%E9%99%8D%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88aspnet\"\u003e.NET 4.6 以降で動作する場合（ASP.NET）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#net-35-%E3%82%84-net-452-%E3%81%BE%E3%81%A7%E3%81%AE%E3%83%A9%E3%83%B3%E3%82%BF%E3%82%A4%E3%83%A0%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88\"\u003e.NET 3.5 や .NET 4.5.2 までのランタイムで動作する場合\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%A5%E8%A7%A3%E3%81%A8%E3%81%84%E3%81%86%E3%82%88%E3%82%8A%E6%99%82%E9%96%93%E7%9A%84%E4%BD%99%E8%A3%95%E3%81%8C%E3%81%82%E3%82%8B%E3%81%AA%E3%82%89%E7%8E%8B%E9%81%93\"\u003e別解（というより時間的余裕があるなら王道）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#vb6visual-basic-60vbavisual-basic-for-applications-%E3%81%AF\"\u003eVB6（Visual Basic 6.0）／VBA（Visual Basic for Applications） は？\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\u003cli\u003e\n\u003ca href=\"#windows-update-%E3%81%A7-kb4489192-%E3%81%8C%E9%85%8D%E4%BF%A1%E3%81%95%E3%82%8C%E3%81%9F%E3%82%89%E5%A4%A7%E9%A8%92%E3%81%8E%E3%81%AB%E3%81%AA%E3%82%89%E3%81%AA%E3%81%84%E3%81%8B\"\u003eWindows Update で KB4489192 が配信されたら大騒ぎにならないか？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E6%A7%98\"\u003eマイクロソフト様\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B6%9A%E5%A0%B1\"\u003e続報\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#20190412-%E8%BF%BD%E8%A8%98\"\u003e[2019/04/12 追記]\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#20190413-%E8%BF%BD%E8%A8%98\"\u003e[2019/04/13 追記]\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#20190414-%E8%BF%BD%E8%A8%98\"\u003e[2019/04/14 追記]\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#20190429-%E8%BF%BD%E8%A8%98\"\u003e[2019/04/29 追記]\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#20190506-%E8%BF%BD%E8%A8%98\"\u003e[2019/05/06 追記]\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#20190515-%E8%BF%BD%E8%A8%98\"\u003e[2019/05/15 追記]\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#20190528-%E8%BF%BD%E8%A8%98\"\u003e[2019/05/28 追記]\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\n\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\n","totalPv":53953,"uuid":"97c5a84cfa7376cbb629","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"26llsTQ67ZeuhM1B9ifyr8mXmS+F--1zan12LelIc34rFv--cMOi8raV2hkglFVjZOBGgg==","originalId":335669,"description":"【品質と生産性にこだわるシステム開発】 .NET（C#/VB.NET）リモート開発支援。即日・15分から頼める常駐しないエンジニア。確かな技術で開発チームを手堅くサポートします。","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"株式会社 コードワン","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/335669/profile-images/1546497723","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F335669%2Fprofile-images%2F1546497723?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=59e834e4f828b3b0e41c02fc0819ee57","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F335669%2Fprofile-images%2F1546497723?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d065bb7eb81ec93789852af0e352faa5","urlName":"CodeOne","websiteUrl":"https://codeone.jp/","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"Windows","urlName":"windows"},{"name":"C#","urlName":"csharp"},{"name":".NET","urlName":".net"},{"name":".NETFramework","urlName":".netframework"},{"name":"元号","urlName":"%e5%85%83%e5%8f%b7"}],"followingLikers":{"edges":[]},"comments":{"totalCount":6}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
