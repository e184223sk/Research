前回はソースで動的にボタンコントロールをフォームへ追加して、クリックイベントを用いてみたんですが、今回はそれを応用して、さらにテキストボックスを動的に追加して、それらを参照しますボタンの動的な追加ができたので、今度はテキストボックスを動的に追加して、それが他から参照できるかどうかをやってみました( ˙꒳​˙ᐢ ) そのためには、テキストボックスを動的にソースから参照したときは、それぞれのテキストボックスをNameに識別名を割り当てないといけないことです。本来は設定ファイルやデータベースで受け持つけど、いきなり話が複雑になるので、今回は手法検証ということでプログラムにて。。。
今度は新たに「buttonCheckEntry」をボタン追加しました！このボタンをクリックすると、動的に追加したテキストフォームの内容を拾ってくれるようにソースコードを作ります(動的にテキストフォームを作成する前はグレーアウトします)。まずは本来データベースや設定ファイルで取得すべき、識別名をテキストボックスに設定する箇所このことをしなければ、まずテキストボックスを参照することができません。なぜならボタンbuttonCheckEntryのクリックイベントでは、識別名をFindすることで、該当するテキストボックスを検索するからです。Findメソッドの引数は、それぞれ識別名、子要素を探すかのフラグ。ここではテキストフォームだけを使うので、それ以下の子要素は意識しないのでfalseで。要素が見つかれば、上記のtxtboxctrlsの要素数は0より大きい(1以上)になります。これも成功しました。
最後は要素数を動的に変えて対応できるかもチェックします最後は要素数を8→11に増やして、そうするとボタンを11個に増やし、テキストボックスも11個識別しなければならなくなるので、上記のように修正します。これも11個のテキストボックスを正しく識別できました！！(˶ ･ᴗ･ )੭⚐⚑今回はデータベースのマスタだの設定ファイルだのといっぺんに話を混ぜると疲れるので、動的にコントロールを追加する方法に絞って記事にしてみましたが、次はデータベースのマスタデータから動的にコントロールを追加することに挑戦してみます( ˙꒳​˙ᐢ )


