More than 1 year has passed since last update.なんか一億円くらい遊ぶ金が欲しいので、今流行りのVRのゲームとか作って大儲けしたい！
って吠えてたら「まずはプロトタイピングしてブツを見せてみなさい」って言われたので作りました。この記事はその過程です。Pack Gesta Furniture #1
VRならLowPolyな環境が大半ですが、今回作りたかったものはリアルなやつなので、リアルな部屋で無料のやつ。
リアルっぽいのほしいなーってときはいつもこれを使ってます。
こういう屋内のシーンの場合、後から室内を調整することもあるので、壁や天井をこのようにまとめておくと一気にdisableして室内を見やすくできるのでよいです。

でなんかまるごとMeshColliderつけておきます。Bodyguards

VRなので自キャラとかはいらないですが他のキャラは必要です。
今回は無料で一番リアルっぽいこれを選びます。Idle MoCap

ぼんやり立っててくれてるだけでいいので、アニメーションはこれ。実はAssetStoreでアニメーションを探すのってけっこう手間です。見本がYoutubeなので、見てるだけでも時間がかかります。
UnityでAnimationを必要とするような開発してる人はAdobe CC契約してると思うのでmixamoで探したほうが楽かも。ここのAnimationライブラリはかなり充実している上に、検索も簡単だしプレビューもさっと見られるので時間が節約できます。Ragdollのことです。
この単語をなかなか思い出せなくて、検索履歴が「Unity　死体」「Unity 死ぬ」「Unity 死んだら」とかになってました。
でUnity標準のウィザードがこんな感じです。

んなめんどくせえことぜってぇやんねぇからな！でまあ調べたらいい感じにやってくれるやつあるのでそれを使います。
Ragdoll helper
Ragdollを設定していてもAnimatorの動きが優先されます。なので死んだときにAnimatorをdisableすれば死体になりますが、それだと裏で結局Ragdoll分のColliderが計算されている気がするので、通常時はRagdoll用のColliderはdisableにしておいて死んだときに全部enableにする……とかしたほうがいいんじゃないでしょうか。まあ金が欲しいと吠えているくらいですからVR機材とか持ってないわけですが、基本的にDayDreamやOculusなどVR系のPrefabはこんな構成です。
でバットが欲しいので素材を探してきます。Small Survival Pack

あらかじめバットの形状に合わせてColliderが調整してあっていい感じ。
このバットを先程のRightの子オブジェクトとして配置します。こうすることでコントローラの動きに連動してバットが動くようになります。
衝突判定をつけるためにRigidBodyを付与します。このときConstrainsにすべてチェックを入れておかないと、バットがなにかに衝突したときに反動を受けてCameraのPrefab全体が回転してVR酔いが大変なことになります。ぜひ試してみてください。
VR機材は持ってないですがNintendo Switchは持ってます。SwitchのコントローラであるJoyconは3DOFです。BluetoothでペアリングすればUnityの入力装置として使えます。【Unity】Nintendo Switch の Joy-Con のジャイロ・加速度・傾きの値を取得したり、振動させたりすることができる「JoyconLib」紹介JoyconLib自分のPCはmacですがとりあえずクローンしたもの一式つっこんだら動きました。エラーは出てましたがログ出力する箇所だったのでコメントアウトしただけ。移動法の参考記事。transform.rightを使う発想がなかった。
Unityでカメラの向きを基準に移動する方法と、追従して回転できるカメラの実装で参考記事のスクリプトをコピペしつつ「左スティックで移動、右スティックで視点操作」できるようにします。次はキャラの方です。別のクラス作るのめんどくさいのでUniRxでColliderの判定をします。以上で完成しました！　さっそくプレイしてみましょう。VRは疑似体験に最適。トレーニングツールなどにも導入されている。
今回は3DOFだったが、6DOFのコントローラを使って振動なども調整すればリアルな「人を殴り殺す感触」を体験できる。
殺す人数は少数。多すぎるとゲーム性が強くて実感が薄れる。
みんなゾンビとかいっぱい殺してるけど人間が殺したくてしょうがない奴もいるはず。だいたい3時間くらいでプロトタイピングできたので、改めてUnityはすごいなって思いました。
あと、実際作って操作してみたらあまりにもやばいかったのでいずれ規制されそうだなって思いました。おしまい。


