前回の続きになります。
前回：[Unity,Photon2]Photon2でルームを作成したいこんな感じで選択したボタンを押したらそのルームに入りたい。
今回はそのボタンを作成します。
今回使ったボタンのプレハブの構成はこんな感じです。

ボタンには押されたらボタンの中で表示されているRoomNameのルームに移動するという処理だけです。
調べたらいくらでも出てくるので割愛。今回はボタンを並べたかったのでScroolView内のContentにボタンを生成します。

デフォルトから名前を変更した"RoomContet"に"ViewMatchWaitingPlayers.cs"というスクリプトを追加します。このコードの簡単な解説ですpublic GameObjectで先ほど作成しておいたボタンのプレハブを指定します。ロビーにいないとルーム情報を取得できないのでロビーに入っておきます。この"OnRoomListUpdate()"でルーム情報を取得します。
自分はここで詰まってたのですが、この関数はルーム内で人数が変更されたり、ルームの情報が変更されたときのみ、
変更が起こったルームだけroomListに入ります。
任意のタイミングでは実行できません。ルームのリスト全部じゃないんかーい。好きなタイミングで呼び出せんのかーいって感じですが、仕様ならしょうがないです。ちなみに、
ロビーに入ったときは何もない状態から"OnRoomListUpdate"を読み込む形になるのでルームが存在すればすべてのルームがroomListに入ります。
それ以降は先ほどと同じで人数が変わったなどの変更があったルームだけがroomListとして"OnRoomListUpdate()"が実行されます。とりあえずこれでルームが取得できました。次はこのルーム情報をもとにプレハブのボタンに情報を表示させてボタンを生成していきます。"OnRoomListUpdate()"で更新があったルームリストがくるので、
そのリストの中のルームにプレイヤーがいる =　人数制限だとしても表示させるとしたら表示する。
なので、
プレイヤーが存在していたらボタンを作成していく方向で行きます。ルームの情報が更新されるたびに"OnRoomListUpdate()"が実行されるので
すでに存在しているルームならば情報の更新だけにしておきます。そうしないと人が抜けたり入ったりするだけで同じルームのボタンがいくつも生成されてしまいます。これで生成したボタンに情報が入るようになります。人がいないルームをいつまでも表示させておくわけにはいかないので人が0人になったらボタンのリストから削除します。これで冒頭にもあったルームリストが作成できます。
ルーム情報の取得はpublic override void OnRoomListUpdate(List roomList)
public override void OnRoomListUpdate(List roomList)を使うためにはロビーに入っておく
roomListには変更があったルームの情報しか入らない


