<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Q#でJones多項式の量子アルゴリズム - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/SelMut/items/15b66d35e25de4d66dc6" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="yMCeqt1xd+ISZVMM8ebCerxx+U1bPXgmKXNrSu4c5oARO/WNZ6WPuCKP4LVaN4xrXWY9+mFwCkOkho4W5JTPtQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="Q#でJones多項式の量子アルゴリズム - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1VU1BqZ2FkS2IyNWxjLVdrbXVtZ2hlVzhqLU9CcnVtSGotV3RrT09Db3VPRHEtT0N0T09EcXVPQ3V1T0RvQSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0xODBhNzVhMDEyNTNkNmUyNGQyNDQwMTk0ZTg1ZDJmZQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRk5sYkUxMWRBJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9Y2E0ZTZmMTc4NzIzNzQ4OTJiZGEzNTg1YjYyZWIwMDI&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=3b5fbe0e4301eab50e4aea869188fcb3"><meta property="og:description" content="大学院で数学を学んでいる者です．本記事では前回書いたQISKitでJones多項式の量子アルゴリズムをもとにQ#でJones多項式の量子アルゴリズムを実装してみます．プログラミング歴はまだ一年も満たず，特にQ#とC#にいたっては学び始..."><meta content="https://qiita.com/SelMut/items/15b66d35e25de4d66dc6" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,量子コンピュータ,量子ゲート,Q#" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-7acfb38b-5c4f-4d42-9d49-8073fce02df2"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FSelMut%2Fitems%2F15b66d35e25de4d66dc6">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FSelMut%2Fitems%2F15b66d35e25de4d66dc6">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-7acfb38b-5c4f-4d42-9d49-8073fce02df2">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-12-15T07:34:12.000+09:00","dateModified":"2018-12-17T15:09:10.000+09:00","headline":"Q#でJones多項式の量子アルゴリズム","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1VU1BqZ2FkS2IyNWxjLVdrbXVtZ2hlVzhqLU9CcnVtSGotV3RrT09Db3VPRHEtT0N0T09EcXVPQ3V1T0RvQSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0xODBhNzVhMDEyNTNkNmUyNGQyNDQwMTk0ZTg1ZDJmZQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRk5sYkUxMWRBJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9Y2E0ZTZmMTc4NzIzNzQ4OTJiZGEzNTg1YjYyZWIwMDI\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=3b5fbe0e4301eab50e4aea869188fcb3","mainEntityOfPage":"https://qiita.com/SelMut/items/15b66d35e25de4d66dc6","author":{"@type":"Person","address":"","email":null,"identifier":"SelMut","name":"SelMut","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fprofile-images%2F1544826927?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=f05ff665ed587f15d9b464aeef5d8d22","url":"https://qiita.com/SelMut","description":"大学院で数学を学んでいます．数学のトポロジーが量子コンピュータに応用されていることを学び，量子情報の分野に興味を持ちました．現在は分配関数やトポロジカルデータ解析の量子アルゴリズムを実装できないか考えています．写像類群やDehn手術が量子情報にどのように応用されているかに興味を持っています．","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"SelMut","type":"items","id":"15b66d35e25de4d66dc6"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"SelMut","type":"items","id":"15b66d35e25de4d66dc6"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"SelMut","type":"items","id":"15b66d35e25de4d66dc6"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"日立の研究者が、2年間ドイツ人工知能研究センターで学んだこと","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/SelMut/items/15b66d35e25de4d66dc6","location":"/SelMut/items/15b66d35e25de4d66dc6","scheme":"https","host":"qiita.com","port":null,"pathname":"/SelMut/items/15b66d35e25de4d66dc6","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"o3J7J10MHGL1vssycC7uJ5iCpnFO8t2yhSrYvPqDnzl6iRAA59jkOMVUeIvb/6A2eZVixnS/r9cI3z3g8Au2DA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-1bb31d53-7141-4c0b-b28d-56c85fb4e4ec"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/SelMut/items/15b66d35e25de4d66dc6/likers" class="css-1iupg5d">3</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">2</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/15b66d35e25de4d66dc6/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/SelMut/items/15b66d35e25de4d66dc6/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/SelMut/items/15b66d35e25de4d66dc6/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/SelMut/items/15b66d35e25de4d66dc6/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/SelMut/items/15b66d35e25de4d66dc6.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2018/quantum2" class="it-AdcalRibbon_title">量子コンピュータ #2<!-- --> Advent Calendar<!-- --> <!-- -->2018</a>Day 15</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/SelMut"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/252982/profile-images/1544826927" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/SelMut" class="css-10ougpm">@<!-- -->SelMut</a><div class="css-1ay9vb9"><span><meta content="2018-12-14T22:34:12Z"/><time dateTime="2018-12-17T06:09:10Z" class="css-m19uds">updated at 2018-12-17</time></span></div></div></div></div></div><h1 class="css-cgzq40">Q#でJones多項式の量子アルゴリズム</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e9%87%8f%e5%ad%90%e3%82%b3%e3%83%b3%e3%83%94%e3%83%a5%e3%83%bc%e3%82%bf" class="css-4czcte">量子コンピュータ</a><a href="/tags/%e9%87%8f%e5%ad%90%e3%82%b2%e3%83%bc%e3%83%88" class="css-4czcte">量子ゲート</a><a href="/tags/qsharp" class="css-4czcte">Q#</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>大学院で数学を学んでいる者です．本記事では前回書いた<a href="https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d" id="reference-b928593511faede7b59f">QISKitでJones多項式の量子アルゴリズム</a>をもとにQ#でJones多項式の量子アルゴリズムを実装してみます．プログラミング歴はまだ一年も満たず，特にQ#とC#にいたっては学び始めて一か月も経っていないため，もっと工夫してコードを書ける等ありましたら，コメントいただけると幸いです．</p>

<h1>
<span id="準備" class="fragment"></span><a href="#%E6%BA%96%E5%82%99"><i class="fa fa-link"></i></a>準備</h1>

<p>Jones多項式の量子アルゴリズムの本質的な部分はHadamardテストとよばれる量子計算で，一般の$2 \times 2$のユニタリ行列に対する制御ゲートをどのように実装するかが課題でした．<a href="https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d">前回</a>実装するのに必要となった量子ゲートとして，$U_1(\alpha) := \begin{pmatrix}1 &amp; 0\\ 0 &amp; e^{i \alpha} \end{pmatrix}$と以下の制御ゲート${\rm c}U_3(\gamma, \beta, \delta)$がありました：</p>

<table>
<thead>
<tr>
<th style="text-align: center">量子ゲート</th>
<th style="text-align: center">ユニタリ行列</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center">
<a href="https://camo.qiitausercontent.com/9cc4c61d5d4240af2f173edd32a1dc69f9732957/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f62373031613136312d336232632d623164322d666332662d3263613832633731323261352e706e67" target="_blank" rel="nofollow noopener"><img width="103" alt="U3'(b,g,d).png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7c7e9662aac01d198ddf191c320fda7e" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/b701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3f5a17310bf621500c5371b75e1ad318 1x" loading="lazy"></a> $${\rm c}U_3(\gamma, \beta, \delta)$$</td>
<td style="text-align: center">$\begin{pmatrix} I &amp; O \\ O &amp; U_3^{\prime}(\gamma, \beta, \delta) \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; e^{i (-\frac{\beta + \delta}{2})} \cos\frac{\gamma}{2} &amp; -e^{i (-\frac{\beta - \delta}{2})} \sin\frac{\gamma}{2} \\ 0 &amp; 0 &amp; e^{i \cdot \frac{\beta - \delta}{2}} \sin\frac{\gamma}{2} &amp; e^{i \cdot \frac{\beta + \delta}{2}} \cos\frac{\gamma}{2} \end{pmatrix}$</td>
</tr>
</tbody>
</table>

<p>これらを使って，どんな$2 \times 2$のユニタリ行列$U$に対する制御ゲートも実数$\alpha$, $\gamma$, $\beta$, $\delta$を使って次のように表わせました：</p>

<p>$$\begin{align}<br>
{\rm controlled}\text{-}U &amp;= \left(U_1 \left(\alpha \right) \otimes I_2 \right) \cdot {\rm c}U_3 \left(\gamma, \beta, \delta \right).<br>
\end{align}$$</p>

<p>$U_1(\alpha)$についてはQ#では$R_1(\alpha)$として準備されています．</p>

<table>
<thead>
<tr>
<th style="text-align: center">量子ゲート</th>
<th style="text-align: center">ユニタリ行列</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><a href="https://camo.qiitausercontent.com/21a6c96f64fca13f8d8e31073689ecd3d6a08146/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f31336231353134362d316436372d643566342d373165612d3236626261343036613863652e706e67" target="_blank" rel="nofollow noopener"><img width="77" alt="R1(alpha).png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F13b15146-1d67-d5f4-71ea-26bba406a8ce.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1d6db87138173d73313c99b2751471a3" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/13b15146-1d67-d5f4-71ea-26bba406a8ce.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F13b15146-1d67-d5f4-71ea-26bba406a8ce.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=516372ac49fd05ea30279bc8d0678455 1x" loading="lazy"></a></td>
<td style="text-align: center">$\begin{pmatrix}1 &amp; 0\\ 0 &amp; e^{i \alpha} \end{pmatrix}$</td>
</tr>
</tbody>
</table>

<p>${\rm c}U_3(\gamma, \beta, \delta)$や$U_3^{\prime}(\gamma, \beta, \delta)$についてはQ#では（2018年12月時点，ver. 0.3ではおそらく）準備されていないため，自分で作る必要があります．ここではQ#ですでに準備されている回転を表わす以下の二つの量子ゲートと<strong>CNOT</strong>(controlled-$X$)を使って，${\rm c}U_3(\gamma, \beta, \delta)$を実装することを考えます．</p>

<table>
<thead>
<tr>
<th style="text-align: center">量子ゲート</th>
<th style="text-align: center">ユニタリ行列</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><a href="https://camo.qiitausercontent.com/4cecb23fef9776d8d4b800f636e8926bec080e44/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f66386434376537322d383137642d323232302d353062312d3564643639663166353438302e706e67" target="_blank" rel="nofollow noopener"><img width="76" alt="Ry-theta.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff8d47e72-817d-2220-50b1-5dd69f1f5480.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ef14bfd04c63b3e7d19f3c231381d493" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/f8d47e72-817d-2220-50b1-5dd69f1f5480.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff8d47e72-817d-2220-50b1-5dd69f1f5480.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a7ea8ca8d1ac0f19ec66a5e3513e84e2 1x" loading="lazy"></a></td>
<td style="text-align: center">$\begin{pmatrix} \cos\frac{\theta}{2} &amp; -\sin\frac{\theta}{2} \\ \sin\frac{\theta}{2} &amp; \cos\frac{\theta}{2} \end{pmatrix}$</td>
</tr>
<tr>
<td style="text-align: center"><a href="https://camo.qiitausercontent.com/f2c35a4ecaeb54c4e9f12cbce25e2a9890627d5d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f34376338343137642d353631372d653839302d616134662d3733666231613039313939332e706e67" target="_blank" rel="nofollow noopener"><img width="75" alt="Rz-theta.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F47c8417d-5617-e890-aa4f-73fb1a091993.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f563ed2b363fb7896fd403251992ba1e" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/47c8417d-5617-e890-aa4f-73fb1a091993.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F47c8417d-5617-e890-aa4f-73fb1a091993.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c53037f02b128be5eadb143645a64cc5 1x" loading="lazy"></a></td>
<td style="text-align: center">$\begin{pmatrix} e^{-\frac{i \theta}{2}} &amp; 0 \\ 0 &amp; e^{\frac{i \theta}{2}} \end{pmatrix}$</td>
</tr>
<tr>
<td style="text-align: center">
<a href="https://camo.qiitausercontent.com/29864a8aa95534986a34b004784487127da55c60/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f32363739623736662d343536352d383539622d343433622d3930363837663632346463302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F2679b76f-4565-859b-443b-90687f624dc0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b0ff210287e57f1daa8d3321a1df106a" width="30%" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/2679b76f-4565-859b-443b-90687f624dc0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F2679b76f-4565-859b-443b-90687f624dc0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4020c6835f672b05c0391123db1df3c2 1x" loading="lazy"></a> $${\rm CNOT}$$</td>
<td style="text-align: center">$\begin{pmatrix}I &amp; O \\ O &amp; X \end{pmatrix} = \begin{pmatrix}1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; 0 \end{pmatrix}$</td>
</tr>
</tbody>
</table>

<p>上の二つの量子ゲートと$X := \begin{pmatrix}0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix}$をうまく組み合わせることによって，$U_3^{\prime}(\gamma, \beta, \delta)$は以下のように表わせます：</p>

<p>$$U_3^{\prime}(\gamma, \beta, \delta) = R_z (\beta) R_y \left(\frac{\gamma}{2} \right) \cdot X \cdot R_y \left(- \frac{\gamma}{2} \right) R_z \left(- \frac{\beta +\delta}{2} \right) \cdot X \cdot R_z \left(- \frac{\beta -\delta}{2} \right). $$</p>

<p>また，$R_z (\beta) R_y \left(\frac{\gamma}{2} \right) \cdot R_y \left(- \frac{\gamma}{2} \right) R_z \left(- \frac{\beta +\delta}{2} \right) \cdot R_z \left(- \frac{\beta -\delta}{2} \right) = I$より，制御ゲート${\rm c}U_3(\gamma, \beta, \delta)$は次のように表わせます(cf. [Nielsen-Chuang; Section 4.2])：</p>

<p><a href="https://camo.qiitausercontent.com/9cc4c61d5d4240af2f173edd32a1dc69f9732957/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f62373031613136312d336232632d623164322d666332662d3263613832633731323261352e706e67" target="_blank" rel="nofollow noopener"><img width="103" alt="U3'(b,g,d).png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7c7e9662aac01d198ddf191c320fda7e" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/b701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3f5a17310bf621500c5371b75e1ad318 1x" loading="lazy"></a> ${\Huge =}$ <a href="https://camo.qiitausercontent.com/839b6c3482ac2e75498943d470ae19a4ae97abdc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f66346232653232392d636530662d356562612d303635622d3638663561343861323463312e706e67" target="_blank" rel="nofollow noopener"><img width="863" alt="RzRy.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff4b2e229-ce0f-5eba-065b-68f5a48a24c1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8f53d2fcc8b082e6578e67b7f730fea3" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/f4b2e229-ce0f-5eba-065b-68f5a48a24c1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff4b2e229-ce0f-5eba-065b-68f5a48a24c1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f456f9f81df1a178799ebe10f773215e 1x" loading="lazy"></a></p>

<p>これらの等式を使ってQ#で実装することを試みます．</p>

<h1>
<span id="虚数単位での近似値を求める" class="fragment"></span><a href="#%E8%99%9A%E6%95%B0%E5%8D%98%E4%BD%8D%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B"><i class="fa fa-link"></i></a>虚数単位での近似値を求める</h1>

<p><a href="https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d">前回の記事</a>にならって，８の字結び目のJones多項式の虚数単位$i$での近似値を求めてみます．目標は，二つのユニタリ行列</p>

<p>$$<br>
A_1 :=<br>
e^{\frac{\pi i}{8}}<br>
\begin{pmatrix}<br>
1 &amp; 0 \ \\<br>
0 &amp; -i<br>
\end{pmatrix}, \<br>
A_2 :=<br>
\frac{1}{\sqrt{2}} \begin{pmatrix}<br>
e^{-\frac{\pi i}{8}} &amp; e^{\frac{3 \pi i}{8}} \\<br>
e^{\frac{3 \pi i}{8}} &amp; e^{-\frac{\pi i}{8}}<br>
\end{pmatrix},<br>
$$</p>

<p>に対して，行列の積$A_2^{\dagger} A_1 A_2^{\dagger} A_1$のトレース（つまり，$(1,1)$-成分と $(2,2)$-成分の和）が$-1$に近似することを確かめることでした．</p>

<p>$R_1(\alpha)$と${\rm c}U_3(\gamma, \beta, \delta)$の$\alpha$, $\gamma$, $\beta$, $\delta$ については，<a href="https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d#%EF%BC%98%E3%81%AE%E5%AD%97%E7%B5%90%E3%81%B3%E7%9B%AE%E3%81%AEjones-%E5%A4%9A%E9%A0%85%E5%BC%8F%E3%81%AE%E8%99%9A%E6%95%B0%E5%8D%98%E4%BD%8D%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B" id="reference-b928593511faede7b59f">前回</a>の$\alpha$, $\theta$, $\phi$, $\lambda$をそれぞれ対応させるだけです．$A_1$と$A_2^{\dagger}$の制御ゲートは以下のように表わせます：</p>

<p>$$\begin{align}<br>
{\rm controlled}\text{-}A_1 &amp;= \left(R_1 \left(-\frac{\pi}{8} \right) \otimes I_2 \right) \cdot {\rm c}U_3 \left(0, -\frac{\pi}{2}, 0 \right), \\<br>
{\rm controlled}\text{-}A_2^{\dagger} &amp;= \left(R_1 \left(\frac{\pi}{8} \right) \otimes I_2 \right) \cdot {\rm c}U_3 \left(\frac{\pi}{2}, -\frac{\pi}{2}, \frac{\pi}{2} \right).<br>
\end{align}$$</p>

<p>よって，$A_2^{\dagger} A_1 A_2^{\dagger} A_1$の$(1,1)$-成分の実部・虚部を求めるHadamardテストの量子回路はそれぞれ以下のようになります：</p>

<p><a href="https://camo.qiitausercontent.com/ec5d9f3aea58641ab5961f5155be19f90df80af0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f39343336346338342d653035332d623565382d313563302d3739666664636334316435662e706e67" target="_blank" rel="nofollow noopener"><img width="971" alt="H-test1.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F94364c84-e053-b5e8-15c0-79ffdcc41d5f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=03540191a1fb1adf2e6cc0b1f3b809ac" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/94364c84-e053-b5e8-15c0-79ffdcc41d5f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F94364c84-e053-b5e8-15c0-79ffdcc41d5f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fb8890dd124af35abb16b5d4c25f3fc4 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/ea1af108204fcdb87a251972f7bd6f89a1db96aa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f63616562643435342d636435392d366535392d353765392d3937613033306536376331642e706e67" target="_blank" rel="nofollow noopener"><img width="942" alt="H-test2.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcaebd454-cd59-6e59-57e9-97a030e67c1d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=255faa46921a81ea748de9b3aed39370" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/caebd454-cd59-6e59-57e9-97a030e67c1d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcaebd454-cd59-6e59-57e9-97a030e67c1d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9a4318f909c69baf5b280dd0654b7ee6 1x" loading="lazy"></a></p>

<p>また，$A_2^{\dagger} A_1 A_2^{\dagger} A_1$の$(2,2)$-成分の実部・虚部を求めるHadamard テストの量子回路はそれぞれ以下のようになります：</p>

<p><a href="https://camo.qiitausercontent.com/aa2314703121d38d43dd3e605c9ef0725bc94cac/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f63633566616265642d323234362d316563392d666162652d3334633334336561323766662e706e67" target="_blank" rel="nofollow noopener"><img width="941" alt="H-test3.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcc5fabed-2246-1ec9-fabe-34c343ea27ff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b9390d6da21a9e0a5e4f2b04c8561d55" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/cc5fabed-2246-1ec9-fabe-34c343ea27ff.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcc5fabed-2246-1ec9-fabe-34c343ea27ff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d059505b0633e8adabe3e58bccf1487c 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/b77748e2c27142ab716a00508910fa18db8f6fa5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f38373164643838372d663839612d383161362d313837382d3939353736306630636230332e706e67" target="_blank" rel="nofollow noopener"><img width="983" alt="H-test4.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F871dd887-f89a-81a6-1878-995760f0cb03.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6fc2b1a2c972f254e879aa7ba604e4d4" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/871dd887-f89a-81a6-1878-995760f0cb03.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F871dd887-f89a-81a6-1878-995760f0cb03.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0008aa8279c4a9fec117587c4cb8655a 1x" loading="lazy"></a></p>

<p>さらに，制御ゲート${\rm c}U_3 \left(0, -\frac{\pi}{2}, 0 \right)$，${\rm c}U_3 \left(\frac{\pi}{2}, -\frac{\pi}{2}, \frac{\pi}{2} \right)$については$R_y(\theta)$, $R_z(\theta)$, CNOTを使って以下のように表わせます：</p>

<p><a href="https://camo.qiitausercontent.com/cec8b648c1bfa46bfe00ae814e10710247be0c7e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f64306233633536632d313033622d393666312d303936362d3931646237616265613832372e706e67" target="_blank" rel="nofollow noopener"><img width="101" alt="A1-cU3.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fd0b3c56c-103b-96f1-0966-91db7abea827.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=692f810079f6cd519b890b367441e30f" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/d0b3c56c-103b-96f1-0966-91db7abea827.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fd0b3c56c-103b-96f1-0966-91db7abea827.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=39c23490d7f4a0b966bc33ba8689102b 1x" loading="lazy"></a> ${\Huge =}$ <a href="https://camo.qiitausercontent.com/88896b6f1c9c7f8a69976f7bc367546477e2cef6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f66353336303730352d316362372d323966322d343363642d3437623835346366643437362e706e67" target="_blank" rel="nofollow noopener"><img width="806" alt="A1.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff5360705-1cb7-29f2-43cd-47b854cfd476.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b0e1dc839b5f10cea2702e39e57ce35d" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/f5360705-1cb7-29f2-43cd-47b854cfd476.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff5360705-1cb7-29f2-43cd-47b854cfd476.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4c93f8b656b864ed7430ea756e502f7d 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/c7dbe447fabd65e5c65d38ce25a78bed4eb780e7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f33313439616333612d366265382d636361372d653633342d3335656339393363623032652e706e67" target="_blank" rel="nofollow noopener"><img width="135" alt="A2-cU3.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F3149ac3a-6be8-cca7-e634-35ec993cb02e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=33bf534ab7b2c2f1f7f55ade2bbc21bb" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/3149ac3a-6be8-cca7-e634-35ec993cb02e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F3149ac3a-6be8-cca7-e634-35ec993cb02e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=75bffa42879a8d3480876c4d3df3f1ca 1x" loading="lazy"></a> ${\Huge =}$ <a href="https://camo.qiitausercontent.com/9e0558f68fdd50403d96566698cd0157be95ef50/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f65623361333134302d386266372d626262382d393233642d3838643538636361333666302e706e67" target="_blank" rel="nofollow noopener"><img width="927" alt="A2dg.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Feb3a3140-8bf7-bbb8-923d-88d58cca36f0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a2917adda4364e7d66c6939e0ffe974c" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/eb3a3140-8bf7-bbb8-923d-88d58cca36f0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Feb3a3140-8bf7-bbb8-923d-88d58cca36f0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ae04aa8c5b71b53db33bd76abec804c8 1x" loading="lazy"></a></p>

<p>以上をもとにQ#とC#でコードを愚直に書いてみます．Q#については，Hadamard テストを上の順番通りに実装すると，以下のようになります：</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">Operations.qs</span></div>
<div class="highlight"><pre><code><span class="k">namespace</span> <span class="nn">Quantum.Jones_figEight_4th</span>
<span class="p">{</span>
    <span class="n">open</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Quantum</span><span class="p">.</span><span class="n">Primitive</span><span class="p">;</span>
    <span class="n">open</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Quantum</span><span class="p">.</span><span class="n">Canon</span><span class="p">;</span>
    <span class="n">open</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Quantum</span><span class="p">.</span><span class="n">Extensions</span><span class="p">.</span><span class="n">Math</span><span class="p">;</span> <span class="c1">// PI()</span>

    <span class="n">operation</span> <span class="nf">Set</span> <span class="p">(</span><span class="n">desired</span><span class="p">:</span> <span class="n">Result</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">Qubit</span><span class="p">)</span> <span class="p">:</span> <span class="n">Unit</span>
    <span class="p">{</span>
        <span class="k">let</span> <span class="n">current</span> <span class="p">=</span> <span class="nf">M</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">desired</span> <span class="p">!=</span> <span class="n">current</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">X</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">operation</span> <span class="nf">HadamardTest_figEight_4th</span> <span class="p">(</span><span class="n">count</span> <span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">initial</span> <span class="p">:</span> <span class="n">Result</span><span class="p">,</span> <span class="n">index</span> <span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Int</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">mutable</span> <span class="n">numZeros</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="k">using</span> <span class="p">(</span><span class="n">qubits</span> <span class="p">=</span> <span class="n">Qubit</span><span class="p">[</span><span class="m">2</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">test</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="n">count</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// initial state: |00&gt;</span>
                <span class="nf">Set</span> <span class="p">(</span><span class="n">Zero</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
                <span class="nf">Set</span> <span class="p">(</span><span class="n">Zero</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">/</span> <span class="m">2</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="nf">X</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="p">}</span>

                <span class="nf">H</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">%</span> <span class="m">2</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
                <span class="p">{</span>               
                    <span class="nf">Adjoint</span><span class="p">(</span><span class="n">S</span><span class="p">)(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
                <span class="p">}</span>

                <span class="c1">// controlled-A1</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(-</span><span class="m">0.50</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">R1</span><span class="p">(-</span><span class="m">0.125</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="c1">// controlled-A2†</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.50</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(-</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(-</span><span class="m">0.50</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">R1</span><span class="p">(</span><span class="m">0.125</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="c1">// controlled-A1</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(-</span><span class="m">0.50</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">R1</span><span class="p">(-</span><span class="m">0.125</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="c1">// controlled-A2†</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.50</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(-</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">CNOT</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Ry</span><span class="p">(</span><span class="m">0.25</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Rz</span><span class="p">(-</span><span class="m">0.50</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">R1</span><span class="p">(</span><span class="m">0.125</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="nf">H</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="k">let</span> <span class="n">res</span> <span class="p">=</span> <span class="nf">M</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="c1">// count |0&gt;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="p">==</span> <span class="n">Zero</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">set</span> <span class="n">numZeros</span> <span class="p">=</span> <span class="n">numZeros</span> <span class="p">+</span> <span class="m">1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nf">ResetAll</span><span class="p">(</span><span class="n">qubits</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// number of |0&gt; and |1&gt;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">numZeros</span><span class="p">,</span> <span class="n">count</span> <span class="p">-</span> <span class="n">numZeros</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>C#の方では古典計算，つまりショット数が1000で一つ目の量子ビットだけを測定したとき$| 0 \rangle$が出力される確率$p_0$の計算，求めたい行列の対角成分の実部・虚部を表わす$2 p_0 - 1$のリストの作成，そして求めたい行列のトレースの実部・虚部の計算を行います．以上をまとめると，上のQ#に付随するC#のコードは以下のようになります：</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">Driver.cs</span></div>
<div class="highlight"><pre><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span> <span class="c1">// List</span>
<span class="k">using</span> <span class="nn">Microsoft.Quantum.Simulation.Core</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Quantum.Simulation.Simulators</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Quantum.Jones_figEight_4th</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Driver</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">qsim</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">QuantumSimulator</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">listVals</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;();</span>                

                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">4</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="kt">var</span> <span class="p">(</span><span class="n">num0s</span><span class="p">,</span> <span class="n">num1s</span><span class="p">)</span> <span class="p">=</span> <span class="n">HadamardTest_figEight_4th</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="n">qsim</span><span class="p">,</span> <span class="m">1000</span><span class="p">,</span> <span class="n">Result</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">i</span><span class="p">).</span><span class="n">Result</span><span class="p">;</span>               
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">i</span><span class="p">}</span><span class="s">: 0s=</span><span class="p">{</span><span class="n">num0s</span><span class="p">,-</span><span class="m">4</span><span class="p">}</span><span class="s"> 1s=</span><span class="p">{</span><span class="n">num1s</span><span class="p">,-</span><span class="m">4</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>

                    <span class="kt">double</span> <span class="n">p0</span> <span class="p">=</span> <span class="n">num0s</span> <span class="p">/</span> <span class="m">1000.0</span><span class="p">;</span>
                    <span class="n">listVals</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="m">2</span> <span class="p">*</span> <span class="n">p0</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Re:</span><span class="p">{</span><span class="n">listVals</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">+</span> <span class="n">listVals</span><span class="p">[</span><span class="m">2</span><span class="p">],-</span><span class="m">4</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Im:</span><span class="p">{</span><span class="n">listVals</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">+</span> <span class="n">listVals</span><span class="p">[</span><span class="m">3</span><span class="p">],-</span><span class="m">4</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>これらを（ビルドして）走らせることにより，以下のような結果が得られます：</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">結果</span></div>
<div class="highlight"><pre><code>0: 0s=264  1s=736
1: 0s=748  1s=252
2: 0s=222  1s=778
3: 0s=242  1s=758
Re:-1.028
Im:-0.02
</code></pre></div>
</div>

<p>以上より，$A_2^{\dagger} A_1 A_2^{\dagger} A_1$のトレースの値の一番近い整数 $^{\ast 1}$ は$-1 + 0 \cdot i$となることが分かり，８の字結び目のJones多項式の$i$での値が$-1$になることを確認できました．</p>

<p><details><summary>$\ast 1$</summary><br>
一般の結び目$K$に対し，Arf 不変量とよばれる，0または1に値をとる結び目の不変量 ${\rm Arf}(K)$ を使って，結び目$K$のJones多項式の$i$での値$J_K(i)$は$(-1)^{{\rm Arf}(K)}$で与えられます(cf. [Murakami])．よって$J_K(i)$ は整数になるため，実装で得られた結果に近い整数を見つければよいことが分かります．逆に言えば，得られた結果からArf 不変量を求めることができ，$K$ が8の字結び目の場合は${\rm Arf}(K) = 1$ になることが分かります．<br>
</details></p>

<h1>
<span id="1の5乗根での近似値を求める" class="fragment"></span><a href="#1%E3%81%AE5%E4%B9%97%E6%A0%B9%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B"><i class="fa fa-link"></i></a>1の5乗根での近似値を求める</h1>

<p>最後に８の字結び目のJones 多項式の1の5乗根 $e^{\frac{2 \pi i}{5}}$ での近似値を同様の方法で求めてみます．$\begin{align} \eta := 2 \cos\frac{\pi}{5} = \frac{1 + \sqrt{5}}{2} \end{align}$とおくと，目標は二つのユニタリ行列</p>

<p>$$\begin{align}<br>
B_1 :=<br>
\begin{pmatrix}<br>
e^{-\frac{4 \pi i}{5}} &amp; 0 &amp; 0\ \\<br>
0 &amp; e^{\frac{3 \pi i}{5}} &amp; 0\ \\<br>
0 &amp; 0 &amp; e^{\frac{3 \pi i}{5}}<br>
\end{pmatrix}, \<br>
B_2 :=<br>
\begin{pmatrix}<br>
\eta^{-1} e^{\frac{4 \pi i}{5}} &amp; \eta^{-\frac{1}{2}} e^{-\frac{3 \pi i}{5}} &amp; 0\ \\<br>
\eta^{-\frac{1}{2}} e^{-\frac{3 \pi i}{5}} &amp; -\eta^{-1} &amp; 0\ \\<br>
0 &amp; 0 &amp; e^{\frac{3 \pi i}{5}}<br>
\end{pmatrix}<br>
\end{align}$$</p>

<p>に対し，行列の積$B_2^{\dagger} B_1 B_2^{\dagger} B_1$の対角成分$b_{ii}$ で表わされる値</p>

<p>$$\begin{align} \eta^2 \cdot \frac{1}{\sin\frac{2 \pi}{5} + \sin\frac{2 \pi}{5} + \sin\frac{4 \pi}{5}} \cdot \left( \sin\frac{2 \pi}{5} \cdot b_{11} + \sin\frac{2 \pi}{5} \cdot b_{22} + \sin\frac{4 \pi}{5} \cdot b_{33} \right) \end{align}<br>
$$</p>

<p>を求めることです．</p>

<p>まず$B_2^{\dagger} B_1 B_2^{\dagger} B_1$の $(3,3)$-成分$b_{33}$ については直接計算することにより，$1$になることが分かります．</p>

<p>残りの$(1,1)$-成分$b_{11}$，$(2,2)$-成分$b_{22}$を求めるためには，$B_1$，$B_2$から第3行と第3列を取り除いた以下の二つの2行2列のユニタリ行列を考えます：</p>

<p>$$\begin{align}<br>
B_1^{\prime} :=<br>
\begin{pmatrix}<br>
e^{-\frac{4 \pi i}{5}} &amp; 0 \\<br>
0 &amp; e^{\frac{3 \pi i}{5}}<br>
\end{pmatrix}, \<br>
B_2^{\prime} :=<br>
\begin{pmatrix}<br>
\eta^{-1} e^{\frac{4 \pi i}{5}} &amp; \eta^{-\frac{1}{2}} e^{-\frac{3 \pi i}{5}}\ \\<br>
\eta^{-\frac{1}{2}} e^{-\frac{3 \pi i}{5}} &amp; -\eta^{-1}<br>
\end{pmatrix}.<br>
\end{align}<br>
$$</p>

<p>行列の積${B_2^{\dagger}}^{\prime} B_1 {B_2^{\dagger}}^{\prime} B_1$の$(1,1)$-成分，$(2,2)$-成分がそれぞれ$b_{11}$，$b_{22}$ になります．<a href="https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d#%EF%BC%98%E3%81%AE%E5%AD%97%E7%B5%90%E3%81%B3%E7%9B%AE%E3%81%AEjones-%E5%A4%9A%E9%A0%85%E5%BC%8F%E3%81%AE1%E3%81%AE%E5%8E%9F%E5%A7%8B5%E4%B9%97%E6%A0%B9%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B%E3%81%93%E3%81%A8%E3%82%92%E8%A9%A6%E3%81%BF%E3%82%8B" id="reference-b928593511faede7b59f">前回</a>は$B_1^{\prime}$ と$B_2^{\prime}$に対して，近似値 $\eta^{-1} = \frac{\sqrt{5} - 1}{2} = 0.618 \cdots \approx \cos 51.8^{\circ} = \cos\left(\frac{1}{2} \cdot \frac{103.6 \pi}{180}\right)$ と$\eta^{-\frac{1}{2}} \approx \sin 51.8^{\circ} = \sin\left(\frac{1}{2} \cdot \frac{103.6 \pi}{180}\right)$を使って$\alpha$, $\gamma$, $\beta$, $\delta$を求めました．Q#でも量子ゲートの合成・随伴，さらには制御ゲートについても簡潔に書くことができるため，これらを使って実装します．</p>

<p>一般の$2 \times 2$のユニタリ行列を実装するには準備でも述べた以下の等式を使います：</p>

<p>$$U_3^{\prime}(\gamma, \beta, \delta) = R_z (\beta) R_y \left(\frac{\gamma}{2} \right) \cdot X \cdot R_y \left(- \frac{\gamma}{2} \right) R_z \left(- \frac{\beta +\delta}{2} \right) \cdot X \cdot R_z \left(- \frac{\beta -\delta}{2} \right)$$</p>

<p>実は$X \cdot R_y \left(- \frac{\gamma}{2} \right) R_z \left(- \frac{\beta +\delta}{2} \right) \cdot X  = R_y \left(\frac{\gamma}{2} \right) R_z \left(\frac{\beta +\delta}{2} \right)$ より，$U_3^{\prime}(\gamma, \beta, \delta)$ は $R_y(\theta)$ と $R_z (\theta)$ のみで表わすことができます：</p>

<p>$$U_3^{\prime}(\gamma, \beta, \delta) = R_z(\beta) R_y(\gamma) R_z(\delta). $$</p>

<p>一般の$2 \times 2$のユニタリ行列は$e^{i \alpha} U_3^{\prime}(\gamma, \beta, \delta)$と表わされるため，$e^{i \alpha}$倍についても考える必要があります．これをユニタリ行列として表わすには，Q#で準備されている以下の量子ゲートを使ってみます（符号と2で割ることに注意．コードでは <code>R(PauliI, theta, qubit)</code>のように書きます．）：</p>

<table>
<thead>
<tr>
<th style="text-align: center">量子ゲート</th>
<th style="text-align: center">ユニタリ行列</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><a href="https://camo.qiitausercontent.com/a11bb191c8d4fc5dddba5835bfc43025d3094abb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f34373564393662332d656539372d363266632d636534332d3636366434633439643038612e706e67" target="_blank" rel="nofollow noopener"><img width="78" alt="RI-theta.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F475d96b3-ee97-62fc-ce43-666d4c49d08a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1cba470a7674534cba9ecb1b3e4548a1" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/252982/475d96b3-ee97-62fc-ce43-666d4c49d08a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F475d96b3-ee97-62fc-ce43-666d4c49d08a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9fe5fd5e3f13c821bc7973cba9e306e5 1x" loading="lazy"></a></td>
<td style="text-align: center">$\begin{pmatrix} e^{- \frac{i \theta}{2}} &amp; 0\\ 0 &amp; e^{- \frac{i \theta}{2}} \end{pmatrix}$</td>
</tr>
</tbody>
</table>

<p>すると，$B_1^{\prime}$と$B_2^{\prime}$はそれぞれ以下のように表わされます：</p>

<p>$$\begin{align}<br>
B_1^{\prime} &amp;= R_I \left(\frac{\pi}{5} \right) \cdot U_3^{\prime} \left(0, \frac{7}{5}\pi, 0 \right)，\\<br>
B_2^{\prime} &amp;\approx R_I \left(-\frac{9 \pi}{5} \right) \cdot U_3^{\prime} \left( \frac{103.6 \pi}{180}, \frac{3 \pi}{5}, -\frac{2 \pi}{5} \right).<br>
\end{align}<br>
$$</p>

<p>以上より，目標をまとめて書くと，Q#については以下のように見やすく書くことができます：</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">Operations.qs</span></div>
<div class="highlight"><pre><code><span class="k">namespace</span> <span class="nn">Quantum.Jones_figEight_5th</span>
<span class="p">{</span>
    <span class="n">open</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Quantum</span><span class="p">.</span><span class="n">Primitive</span><span class="p">;</span>
    <span class="n">open</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Quantum</span><span class="p">.</span><span class="n">Canon</span><span class="p">;</span>
    <span class="n">open</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Quantum</span><span class="p">.</span><span class="n">Extensions</span><span class="p">.</span><span class="n">Math</span><span class="p">;</span>

    <span class="n">operation</span> <span class="nf">Set</span> <span class="p">(</span><span class="n">desired</span><span class="p">:</span> <span class="n">Result</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">Qubit</span><span class="p">)</span> <span class="p">:</span> <span class="n">Unit</span>
    <span class="p">{</span>
        <span class="k">let</span> <span class="n">current</span> <span class="p">=</span> <span class="nf">M</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">desired</span> <span class="p">!=</span> <span class="n">current</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">X</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// U3'(γ, β, δ)</span>
    <span class="n">operation</span> <span class="nf">U3p</span> <span class="p">(</span><span class="n">gamma</span> <span class="p">:</span> <span class="n">Double</span><span class="p">,</span> <span class="n">beta</span> <span class="p">:</span> <span class="n">Double</span><span class="p">,</span> <span class="n">delta</span> <span class="p">:</span> <span class="n">Double</span><span class="p">,</span> <span class="n">q</span> <span class="p">:</span> <span class="n">Qubit</span><span class="p">)</span> <span class="p">:</span> <span class="n">Unit</span>
    <span class="p">{</span>
        <span class="nf">body</span> <span class="p">(...)</span>
        <span class="p">{</span>
              <span class="nf">Rz</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
              <span class="nf">Ry</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
              <span class="nf">Rz</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">adjoint</span> <span class="n">auto</span><span class="p">;</span>
        <span class="n">controlled</span> <span class="n">auto</span><span class="p">;</span>
        <span class="n">controlled</span> <span class="n">adjoint</span> <span class="n">auto</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// B1'</span>
    <span class="n">operation</span> <span class="nf">B1p</span> <span class="p">(</span><span class="n">q</span> <span class="p">:</span> <span class="n">Qubit</span><span class="p">)</span> <span class="p">:</span> <span class="n">Unit</span>
    <span class="p">{</span>
        <span class="nf">body</span> <span class="p">(...)</span>
        <span class="p">{</span>
              <span class="nf">U3p</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> <span class="m">1.40</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="m">0.0</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
              <span class="nf">R</span><span class="p">(</span><span class="n">PauliI</span><span class="p">,</span> <span class="m">0.20</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">q</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">adjoint</span> <span class="n">auto</span><span class="p">;</span>
        <span class="n">controlled</span> <span class="n">auto</span><span class="p">;</span>
        <span class="n">controlled</span> <span class="n">adjoint</span> <span class="n">auto</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// B2'</span>
    <span class="n">operation</span> <span class="nf">B2p</span> <span class="p">(</span><span class="n">q</span> <span class="p">:</span> <span class="n">Qubit</span><span class="p">)</span> <span class="p">:</span> <span class="n">Unit</span>
    <span class="p">{</span>
        <span class="nf">body</span> <span class="p">(...)</span>
        <span class="p">{</span>
              <span class="nf">U3p</span><span class="p">((</span><span class="m">103.6</span> <span class="p">/</span> <span class="m">180.0</span><span class="p">)</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="m">0.60</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="p">-</span><span class="m">0.40</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">q</span><span class="p">);</span>
              <span class="nf">R</span><span class="p">(</span><span class="n">PauliI</span><span class="p">,</span> <span class="p">-</span><span class="m">1.80</span> <span class="p">*</span> <span class="nf">PI</span><span class="p">(),</span> <span class="n">q</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">adjoint</span> <span class="n">auto</span><span class="p">;</span>
        <span class="n">controlled</span> <span class="n">auto</span><span class="p">;</span>
        <span class="n">controlled</span> <span class="n">adjoint</span> <span class="n">auto</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="n">operation</span> <span class="nf">HadamardTest_figEight_5th</span> <span class="p">(</span><span class="n">count</span> <span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">initial</span> <span class="p">:</span> <span class="n">Result</span><span class="p">,</span> <span class="n">index</span> <span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">:</span> <span class="n">Int</span>
    <span class="p">{</span>
        <span class="n">mutable</span> <span class="n">numZeros</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="k">using</span> <span class="p">(</span><span class="n">qubits</span> <span class="p">=</span> <span class="n">Qubit</span><span class="p">[</span><span class="m">2</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">test</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="n">count</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nf">Set</span> <span class="p">(</span><span class="n">Zero</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
                <span class="nf">Set</span> <span class="p">(</span><span class="n">Zero</span><span class="p">,</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">/</span> <span class="m">2</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="nf">X</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="p">}</span>

                <span class="nf">H</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">%</span> <span class="m">2</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
                <span class="p">{</span>               
                    <span class="nf">Adjoint</span><span class="p">(</span><span class="n">S</span><span class="p">)(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
                <span class="p">}</span>

                <span class="nf">Controlled</span><span class="p">(</span><span class="n">B1p</span><span class="p">)([</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Controlled</span><span class="p">(</span><span class="nf">Adjoint</span><span class="p">(</span><span class="n">B2p</span><span class="p">))([</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Controlled</span><span class="p">(</span><span class="n">B1p</span><span class="p">)([</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
                <span class="nf">Controlled</span><span class="p">(</span><span class="nf">Adjoint</span><span class="p">(</span><span class="n">B2p</span><span class="p">))([</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]],</span> <span class="n">qubits</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>

                <span class="nf">H</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="k">let</span> <span class="n">res</span> <span class="p">=</span> <span class="nf">M</span><span class="p">(</span><span class="n">qubits</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="p">==</span> <span class="n">Zero</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">set</span> <span class="n">numZeros</span> <span class="p">=</span> <span class="n">numZeros</span> <span class="p">+</span> <span class="m">1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nf">ResetAll</span><span class="p">(</span><span class="n">qubits</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">numZeros</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>また，今回もより正確な値（目標は上4桁）を得るためにHadamardテストを1000回繰り返し，得られた結果の平均を取ることを考えます．すると，C#については以下のようになります：</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">Driver.cs</span></div>
<div class="highlight"><pre><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span> <span class="c1">// List</span>
<span class="k">using</span> <span class="nn">Microsoft.Quantum.Simulation.Core</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Quantum.Simulation.Simulators</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Quantum.Jones_figEight_5th</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Driver</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">qsim</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">QuantumSimulator</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">listVals</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;();</span>

                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">4</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="kt">int</span> <span class="n">sum0s</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

                    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="m">1000</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                    <span class="p">{</span>
                        <span class="kt">var</span> <span class="n">num0s</span> <span class="p">=</span> <span class="n">HadamardTest_figEight_5th</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="n">qsim</span><span class="p">,</span> <span class="m">1000</span><span class="p">,</span> <span class="n">Result</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">i</span><span class="p">).</span><span class="n">Result</span><span class="p">;</span>
                        <span class="n">sum0s</span> <span class="p">+=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">num0s</span><span class="p">;</span>
                    <span class="p">}</span>

                    <span class="kt">double</span> <span class="n">avgNum0s</span> <span class="p">=</span> <span class="n">sum0s</span> <span class="p">/</span> <span class="m">1000.0</span><span class="p">;</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">i</span><span class="p">}</span><span class="s">: avgNum0s=</span><span class="p">{</span><span class="n">avgNum0s</span><span class="p">,-</span><span class="m">4</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>

                    <span class="kt">double</span> <span class="n">p0</span> <span class="p">=</span> <span class="n">avgNum0s</span> <span class="p">/</span> <span class="m">1000.0</span><span class="p">;</span>
                    <span class="n">listVals</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="m">2</span> <span class="p">*</span> <span class="n">p0</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="kt">double</span> <span class="n">eta</span> <span class="p">=</span> <span class="m">2.0</span> <span class="p">*</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="m">0.20</span> <span class="p">*</span> <span class="n">Math</span><span class="p">.</span><span class="n">PI</span><span class="p">);</span>
                <span class="kt">double</span>  <span class="n">s2</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="m">0.40</span> <span class="p">*</span> <span class="n">Math</span><span class="p">.</span><span class="n">PI</span><span class="p">);</span>
                <span class="kt">double</span>  <span class="n">s4</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="m">0.80</span> <span class="p">*</span> <span class="n">Math</span><span class="p">.</span><span class="n">PI</span><span class="p">);</span>

                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Re:</span><span class="p">{</span><span class="n">eta</span> <span class="p">*</span> <span class="n">eta</span> <span class="p">/</span> <span class="p">(</span><span class="n">s2</span> <span class="p">+</span> <span class="n">s2</span> <span class="p">+</span> <span class="n">s4</span><span class="p">)</span> <span class="p">*</span> <span class="p">(</span><span class="n">s2</span> <span class="p">*</span> <span class="n">listVals</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">+</span> <span class="n">s2</span> <span class="p">*</span> <span class="n">listVals</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">+</span> <span class="n">s4</span> <span class="p">*</span> <span class="m">1.0</span><span class="p">),-</span><span class="m">4</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Im:</span><span class="p">{</span><span class="n">eta</span> <span class="p">*</span> <span class="n">eta</span> <span class="p">/</span> <span class="p">(</span><span class="n">s2</span> <span class="p">+</span> <span class="n">s2</span> <span class="p">+</span> <span class="n">s4</span><span class="p">)</span> <span class="p">*</span> <span class="p">(</span><span class="n">s2</span> <span class="p">*</span> <span class="n">listVals</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">+</span> <span class="n">s2</span> <span class="p">*</span> <span class="n">listVals</span><span class="p">[</span><span class="m">3</span><span class="p">]),-</span><span class="m">4</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>以上を走らせると，以下のような結果が得られます（筆者の安いPCのWindows上のVSCodeでは4時間ほど掛かりました）：</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">結果</span></div>
<div class="highlight"><pre><code>0: avgNum0s=36.604
1: avgNum0s=612.636
2: avgNum0s=36.005
3: avgNum0s=387.623
Re: -1.2367480112501
Im: 0.0005179999999999
</code></pre></div>
</div>

<p>以上より，８の字結び目のJones多項式の$e^{\frac{2 \pi i}{5}}$での値$\begin{align} (-\sqrt{5} + 1) + 0 \cdot i = -1.23606 \cdots \end{align}$と近い値を得ることができました．</p>

<h1>
<span id="参考文献" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><i class="fa fa-link"></i></a>参考文献</h1>

<p>・H. Murakami, <a href="https://projecteuclid.org/euclid.jmsj/1230395012" rel="nofollow noopener" target="_blank">A recursive calculation of the Arf invariant of a link</a>, J. Math. Soc. Japan 38 (1986) 335--338.</p>

<p>・M. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum Information: 10th Anniversary Edition, Cambridge University Press (2010).</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FSelMut%2Fitems%2F15b66d35e25de4d66dc6&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FSelMut%2Fitems%2F15b66d35e25de4d66dc6&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/SelMut/items/15b66d35e25de4d66dc6/likers" class="css-1iupg5d">3</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">2</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/15b66d35e25de4d66dc6/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/SelMut/items/15b66d35e25de4d66dc6/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/SelMut/items/15b66d35e25de4d66dc6/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/SelMut/items/15b66d35e25de4d66dc6/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/SelMut/items/15b66d35e25de4d66dc6.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-1bb31d53-7141-4c0b-b28d-56c85fb4e4ec">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-be50c82d-ce4a-488c-9256-10ccf7681364"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-be50c82d-ce4a-488c-9256-10ccf7681364">{}</script>
      
<div id="LoginModal-react-component-c40a6483-d75d-4610-9fab-9b2cf154d3ee"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-c40a6483-d75d-4610-9fab-9b2cf154d3ee">{}</script>
      
<div id="StockModal-react-component-63cd0f6e-49b3-428a-810c-6c8b34b3b825"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-63cd0f6e-49b3-428a-810c-6c8b34b3b825">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;caTt7hSI32sw5LKJr/lJeWF3sXEeQtVOSwWNWxdEz5GoX4bJrlwnMQAOATAEKAdogGB1xiQPpyvG8GgHHczmpA==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e大学院で数学を学んでいる者です．本記事では前回書いた\u003ca href=\"https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d\" id=\"reference-b928593511faede7b59f\"\u003eQISKitでJones多項式の量子アルゴリズム\u003c/a\u003eをもとにQ#でJones多項式の量子アルゴリズムを実装してみます．プログラミング歴はまだ一年も満たず，特にQ#とC#にいたっては学び始めて一か月も経っていないため，もっと工夫してコードを書ける等ありましたら，コメントいただけると幸いです．\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e準備\u003c/h1\u003e\n\n\u003cp\u003eJones多項式の量子アルゴリズムの本質的な部分はHadamardテストとよばれる量子計算で，一般の$2 \\times 2$のユニタリ行列に対する制御ゲートをどのように実装するかが課題でした．\u003ca href=\"https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d\"\u003e前回\u003c/a\u003e実装するのに必要となった量子ゲートとして，$U_1(\\alpha) := \\begin{pmatrix}1 \u0026amp; 0\\\\ 0 \u0026amp; e^{i \\alpha} \\end{pmatrix}$と以下の制御ゲート${\\rm c}U_3(\\gamma, \\beta, \\delta)$がありました：\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e量子ゲート\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003eユニタリ行列\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/9cc4c61d5d4240af2f173edd32a1dc69f9732957/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f62373031613136312d336232632d623164322d666332662d3263613832633731323261352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"103\" alt=\"U3'(b,g,d).png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7c7e9662aac01d198ddf191c320fda7e\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/b701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3f5a17310bf621500c5371b75e1ad318 1x\" loading=\"lazy\"\u003e\u003c/a\u003e $${\\rm c}U_3(\\gamma, \\beta, \\delta)$$\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e$\\begin{pmatrix} I \u0026amp; O \\\\ O \u0026amp; U_3^{\\prime}(\\gamma, \\beta, \\delta) \\end{pmatrix} = \\begin{pmatrix} 1 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 1 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; e^{i (-\\frac{\\beta + \\delta}{2})} \\cos\\frac{\\gamma}{2} \u0026amp; -e^{i (-\\frac{\\beta - \\delta}{2})} \\sin\\frac{\\gamma}{2} \\\\ 0 \u0026amp; 0 \u0026amp; e^{i \\cdot \\frac{\\beta - \\delta}{2}} \\sin\\frac{\\gamma}{2} \u0026amp; e^{i \\cdot \\frac{\\beta + \\delta}{2}} \\cos\\frac{\\gamma}{2} \\end{pmatrix}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eこれらを使って，どんな$2 \\times 2$のユニタリ行列$U$に対する制御ゲートも実数$\\alpha$, $\\gamma$, $\\beta$, $\\delta$を使って次のように表わせました：\u003c/p\u003e\n\n\u003cp\u003e$$\\begin{align}\u003cbr\u003e\n{\\rm controlled}\\text{-}U \u0026amp;= \\left(U_1 \\left(\\alpha \\right) \\otimes I_2 \\right) \\cdot {\\rm c}U_3 \\left(\\gamma, \\beta, \\delta \\right).\u003cbr\u003e\n\\end{align}$$\u003c/p\u003e\n\n\u003cp\u003e$U_1(\\alpha)$についてはQ#では$R_1(\\alpha)$として準備されています．\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e量子ゲート\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003eユニタリ行列\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003ca href=\"https://camo.qiitausercontent.com/21a6c96f64fca13f8d8e31073689ecd3d6a08146/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f31336231353134362d316436372d643566342d373165612d3236626261343036613863652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"77\" alt=\"R1(alpha).png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F13b15146-1d67-d5f4-71ea-26bba406a8ce.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1d6db87138173d73313c99b2751471a3\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/13b15146-1d67-d5f4-71ea-26bba406a8ce.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F13b15146-1d67-d5f4-71ea-26bba406a8ce.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=516372ac49fd05ea30279bc8d0678455 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e$\\begin{pmatrix}1 \u0026amp; 0\\\\ 0 \u0026amp; e^{i \\alpha} \\end{pmatrix}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e${\\rm c}U_3(\\gamma, \\beta, \\delta)$や$U_3^{\\prime}(\\gamma, \\beta, \\delta)$についてはQ#では（2018年12月時点，ver. 0.3ではおそらく）準備されていないため，自分で作る必要があります．ここではQ#ですでに準備されている回転を表わす以下の二つの量子ゲートと\u003cstrong\u003eCNOT\u003c/strong\u003e(controlled-$X$)を使って，${\\rm c}U_3(\\gamma, \\beta, \\delta)$を実装することを考えます．\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e量子ゲート\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003eユニタリ行列\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003ca href=\"https://camo.qiitausercontent.com/4cecb23fef9776d8d4b800f636e8926bec080e44/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f66386434376537322d383137642d323232302d353062312d3564643639663166353438302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"76\" alt=\"Ry-theta.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff8d47e72-817d-2220-50b1-5dd69f1f5480.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ef14bfd04c63b3e7d19f3c231381d493\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/f8d47e72-817d-2220-50b1-5dd69f1f5480.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff8d47e72-817d-2220-50b1-5dd69f1f5480.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a7ea8ca8d1ac0f19ec66a5e3513e84e2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e$\\begin{pmatrix} \\cos\\frac{\\theta}{2} \u0026amp; -\\sin\\frac{\\theta}{2} \\\\ \\sin\\frac{\\theta}{2} \u0026amp; \\cos\\frac{\\theta}{2} \\end{pmatrix}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003ca href=\"https://camo.qiitausercontent.com/f2c35a4ecaeb54c4e9f12cbce25e2a9890627d5d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f34376338343137642d353631372d653839302d616134662d3733666231613039313939332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"75\" alt=\"Rz-theta.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F47c8417d-5617-e890-aa4f-73fb1a091993.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f563ed2b363fb7896fd403251992ba1e\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/47c8417d-5617-e890-aa4f-73fb1a091993.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F47c8417d-5617-e890-aa4f-73fb1a091993.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c53037f02b128be5eadb143645a64cc5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e$\\begin{pmatrix} e^{-\\frac{i \\theta}{2}} \u0026amp; 0 \\\\ 0 \u0026amp; e^{\\frac{i \\theta}{2}} \\end{pmatrix}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/29864a8aa95534986a34b004784487127da55c60/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f32363739623736662d343536352d383539622d343433622d3930363837663632346463302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F2679b76f-4565-859b-443b-90687f624dc0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b0ff210287e57f1daa8d3321a1df106a\" width=\"30%\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/2679b76f-4565-859b-443b-90687f624dc0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F2679b76f-4565-859b-443b-90687f624dc0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4020c6835f672b05c0391123db1df3c2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e $${\\rm CNOT}$$\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e$\\begin{pmatrix}I \u0026amp; O \\\\ O \u0026amp; X \\end{pmatrix} = \\begin{pmatrix}1 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 1 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\\\ 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; 0 \\end{pmatrix}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e上の二つの量子ゲートと$X := \\begin{pmatrix}0 \u0026amp; 1 \\\\ 1 \u0026amp; 0 \\end{pmatrix}$をうまく組み合わせることによって，$U_3^{\\prime}(\\gamma, \\beta, \\delta)$は以下のように表わせます：\u003c/p\u003e\n\n\u003cp\u003e$$U_3^{\\prime}(\\gamma, \\beta, \\delta) = R_z (\\beta) R_y \\left(\\frac{\\gamma}{2} \\right) \\cdot X \\cdot R_y \\left(- \\frac{\\gamma}{2} \\right) R_z \\left(- \\frac{\\beta +\\delta}{2} \\right) \\cdot X \\cdot R_z \\left(- \\frac{\\beta -\\delta}{2} \\right). $$\u003c/p\u003e\n\n\u003cp\u003eまた，$R_z (\\beta) R_y \\left(\\frac{\\gamma}{2} \\right) \\cdot R_y \\left(- \\frac{\\gamma}{2} \\right) R_z \\left(- \\frac{\\beta +\\delta}{2} \\right) \\cdot R_z \\left(- \\frac{\\beta -\\delta}{2} \\right) = I$より，制御ゲート${\\rm c}U_3(\\gamma, \\beta, \\delta)$は次のように表わせます(cf. [Nielsen-Chuang; Section 4.2])：\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/9cc4c61d5d4240af2f173edd32a1dc69f9732957/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f62373031613136312d336232632d623164322d666332662d3263613832633731323261352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"103\" alt=\"U3'(b,g,d).png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7c7e9662aac01d198ddf191c320fda7e\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/b701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fb701a161-3b2c-b1d2-fc2f-2ca82c7122a5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3f5a17310bf621500c5371b75e1ad318 1x\" loading=\"lazy\"\u003e\u003c/a\u003e ${\\Huge =}$ \u003ca href=\"https://camo.qiitausercontent.com/839b6c3482ac2e75498943d470ae19a4ae97abdc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f66346232653232392d636530662d356562612d303635622d3638663561343861323463312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"863\" alt=\"RzRy.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff4b2e229-ce0f-5eba-065b-68f5a48a24c1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8f53d2fcc8b082e6578e67b7f730fea3\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/f4b2e229-ce0f-5eba-065b-68f5a48a24c1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff4b2e229-ce0f-5eba-065b-68f5a48a24c1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f456f9f81df1a178799ebe10f773215e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれらの等式を使ってQ#で実装することを試みます．\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"虚数単位での近似値を求める\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%99%9A%E6%95%B0%E5%8D%98%E4%BD%8D%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e虚数単位での近似値を求める\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d\"\u003e前回の記事\u003c/a\u003eにならって，８の字結び目のJones多項式の虚数単位$i$での近似値を求めてみます．目標は，二つのユニタリ行列\u003c/p\u003e\n\n\u003cp\u003e$$\u003cbr\u003e\nA_1 :=\u003cbr\u003e\ne^{\\frac{\\pi i}{8}}\u003cbr\u003e\n\\begin{pmatrix}\u003cbr\u003e\n1 \u0026amp; 0 \\ \\\\\u003cbr\u003e\n0 \u0026amp; -i\u003cbr\u003e\n\\end{pmatrix}, \\\u003cbr\u003e\nA_2 :=\u003cbr\u003e\n\\frac{1}{\\sqrt{2}} \\begin{pmatrix}\u003cbr\u003e\ne^{-\\frac{\\pi i}{8}} \u0026amp; e^{\\frac{3 \\pi i}{8}} \\\\\u003cbr\u003e\ne^{\\frac{3 \\pi i}{8}} \u0026amp; e^{-\\frac{\\pi i}{8}}\u003cbr\u003e\n\\end{pmatrix},\u003cbr\u003e\n$$\u003c/p\u003e\n\n\u003cp\u003eに対して，行列の積$A_2^{\\dagger} A_1 A_2^{\\dagger} A_1$のトレース（つまり，$(1,1)$-成分と $(2,2)$-成分の和）が$-1$に近似することを確かめることでした．\u003c/p\u003e\n\n\u003cp\u003e$R_1(\\alpha)$と${\\rm c}U_3(\\gamma, \\beta, \\delta)$の$\\alpha$, $\\gamma$, $\\beta$, $\\delta$ については，\u003ca href=\"https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d#%EF%BC%98%E3%81%AE%E5%AD%97%E7%B5%90%E3%81%B3%E7%9B%AE%E3%81%AEjones-%E5%A4%9A%E9%A0%85%E5%BC%8F%E3%81%AE%E8%99%9A%E6%95%B0%E5%8D%98%E4%BD%8D%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\" id=\"reference-b928593511faede7b59f\"\u003e前回\u003c/a\u003eの$\\alpha$, $\\theta$, $\\phi$, $\\lambda$をそれぞれ対応させるだけです．$A_1$と$A_2^{\\dagger}$の制御ゲートは以下のように表わせます：\u003c/p\u003e\n\n\u003cp\u003e$$\\begin{align}\u003cbr\u003e\n{\\rm controlled}\\text{-}A_1 \u0026amp;= \\left(R_1 \\left(-\\frac{\\pi}{8} \\right) \\otimes I_2 \\right) \\cdot {\\rm c}U_3 \\left(0, -\\frac{\\pi}{2}, 0 \\right), \\\\\u003cbr\u003e\n{\\rm controlled}\\text{-}A_2^{\\dagger} \u0026amp;= \\left(R_1 \\left(\\frac{\\pi}{8} \\right) \\otimes I_2 \\right) \\cdot {\\rm c}U_3 \\left(\\frac{\\pi}{2}, -\\frac{\\pi}{2}, \\frac{\\pi}{2} \\right).\u003cbr\u003e\n\\end{align}$$\u003c/p\u003e\n\n\u003cp\u003eよって，$A_2^{\\dagger} A_1 A_2^{\\dagger} A_1$の$(1,1)$-成分の実部・虚部を求めるHadamardテストの量子回路はそれぞれ以下のようになります：\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ec5d9f3aea58641ab5961f5155be19f90df80af0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f39343336346338342d653035332d623565382d313563302d3739666664636334316435662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"971\" alt=\"H-test1.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F94364c84-e053-b5e8-15c0-79ffdcc41d5f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=03540191a1fb1adf2e6cc0b1f3b809ac\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/94364c84-e053-b5e8-15c0-79ffdcc41d5f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F94364c84-e053-b5e8-15c0-79ffdcc41d5f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fb8890dd124af35abb16b5d4c25f3fc4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ea1af108204fcdb87a251972f7bd6f89a1db96aa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f63616562643435342d636435392d366535392d353765392d3937613033306536376331642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"942\" alt=\"H-test2.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcaebd454-cd59-6e59-57e9-97a030e67c1d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=255faa46921a81ea748de9b3aed39370\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/caebd454-cd59-6e59-57e9-97a030e67c1d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcaebd454-cd59-6e59-57e9-97a030e67c1d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9a4318f909c69baf5b280dd0654b7ee6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eまた，$A_2^{\\dagger} A_1 A_2^{\\dagger} A_1$の$(2,2)$-成分の実部・虚部を求めるHadamard テストの量子回路はそれぞれ以下のようになります：\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/aa2314703121d38d43dd3e605c9ef0725bc94cac/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f63633566616265642d323234362d316563392d666162652d3334633334336561323766662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"941\" alt=\"H-test3.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcc5fabed-2246-1ec9-fabe-34c343ea27ff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b9390d6da21a9e0a5e4f2b04c8561d55\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/cc5fabed-2246-1ec9-fabe-34c343ea27ff.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fcc5fabed-2246-1ec9-fabe-34c343ea27ff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d059505b0633e8adabe3e58bccf1487c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b77748e2c27142ab716a00508910fa18db8f6fa5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f38373164643838372d663839612d383161362d313837382d3939353736306630636230332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"983\" alt=\"H-test4.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F871dd887-f89a-81a6-1878-995760f0cb03.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6fc2b1a2c972f254e879aa7ba604e4d4\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/871dd887-f89a-81a6-1878-995760f0cb03.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F871dd887-f89a-81a6-1878-995760f0cb03.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0008aa8279c4a9fec117587c4cb8655a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eさらに，制御ゲート${\\rm c}U_3 \\left(0, -\\frac{\\pi}{2}, 0 \\right)$，${\\rm c}U_3 \\left(\\frac{\\pi}{2}, -\\frac{\\pi}{2}, \\frac{\\pi}{2} \\right)$については$R_y(\\theta)$, $R_z(\\theta)$, CNOTを使って以下のように表わせます：\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/cec8b648c1bfa46bfe00ae814e10710247be0c7e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f64306233633536632d313033622d393666312d303936362d3931646237616265613832372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"101\" alt=\"A1-cU3.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fd0b3c56c-103b-96f1-0966-91db7abea827.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=692f810079f6cd519b890b367441e30f\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/d0b3c56c-103b-96f1-0966-91db7abea827.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fd0b3c56c-103b-96f1-0966-91db7abea827.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=39c23490d7f4a0b966bc33ba8689102b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e ${\\Huge =}$ \u003ca href=\"https://camo.qiitausercontent.com/88896b6f1c9c7f8a69976f7bc367546477e2cef6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f66353336303730352d316362372d323966322d343363642d3437623835346366643437362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"806\" alt=\"A1.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff5360705-1cb7-29f2-43cd-47b854cfd476.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b0e1dc839b5f10cea2702e39e57ce35d\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/f5360705-1cb7-29f2-43cd-47b854cfd476.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Ff5360705-1cb7-29f2-43cd-47b854cfd476.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4c93f8b656b864ed7430ea756e502f7d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c7dbe447fabd65e5c65d38ce25a78bed4eb780e7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f33313439616333612d366265382d636361372d653633342d3335656339393363623032652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"135\" alt=\"A2-cU3.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F3149ac3a-6be8-cca7-e634-35ec993cb02e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=33bf534ab7b2c2f1f7f55ade2bbc21bb\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/3149ac3a-6be8-cca7-e634-35ec993cb02e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F3149ac3a-6be8-cca7-e634-35ec993cb02e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=75bffa42879a8d3480876c4d3df3f1ca 1x\" loading=\"lazy\"\u003e\u003c/a\u003e ${\\Huge =}$ \u003ca href=\"https://camo.qiitausercontent.com/9e0558f68fdd50403d96566698cd0157be95ef50/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f65623361333134302d386266372d626262382d393233642d3838643538636361333666302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"927\" alt=\"A2dg.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Feb3a3140-8bf7-bbb8-923d-88d58cca36f0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a2917adda4364e7d66c6939e0ffe974c\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/eb3a3140-8bf7-bbb8-923d-88d58cca36f0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Feb3a3140-8bf7-bbb8-923d-88d58cca36f0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ae04aa8c5b71b53db33bd76abec804c8 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e以上をもとにQ#とC#でコードを愚直に書いてみます．Q#については，Hadamard テストを上の順番通りに実装すると，以下のようになります：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eOperations.qs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eQuantum.Jones_figEight_4th\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eQuantum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimitive\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eQuantum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCanon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eQuantum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eExtensions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// PI()\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"nf\"\u003eSet\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edesired\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eQubit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eM\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edesired\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"nf\"\u003eHadamardTest_figEight_4th\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecount\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003einitial\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emutable\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eQubit\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etest\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"m\"\u003e1.\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// initial state: |00\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eSet\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eSet\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nf\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"nf\"\u003eH\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e               \n                    \u003cspan class=\"nf\"\u003eAdjoint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eS\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// controlled-A1\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.50\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eR1\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.125\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// controlled-A2†\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.50\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.50\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eR1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.125\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// controlled-A1\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.50\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eR1\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.125\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// controlled-A2†\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.50\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eCNOT\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.50\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eR1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.125\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"nf\"\u003eH\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eM\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// count |0\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eset\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"nf\"\u003eResetAll\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// number of |0\u0026gt; and |1\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecount\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eC#の方では古典計算，つまりショット数が1000で一つ目の量子ビットだけを測定したとき$| 0 \\rangle$が出力される確率$p_0$の計算，求めたい行列の対角成分の実部・虚部を表わす$2 p_0 - 1$のリストの作成，そして求めたい行列のトレースの実部・虚部の計算を行います．以上をまとめると，上のQ#に付随するC#のコードは以下のようになります：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eDriver.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// List\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMicrosoft.Quantum.Simulation.Core\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMicrosoft.Quantum.Simulation.Simulators\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eQuantum.Jones_figEight_4th\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDriver\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eqsim\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eQuantumSimulator\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003edouble\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e                \n\n                \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum0s\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enum1s\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eHadamardTest_figEight_4th\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eqsim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e               \n                    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e: 0s=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003enum0s\u003c/span\u003e\u003cspan class=\"p\"\u003e,-\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e 1s=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003enum1s\u003c/span\u003e\u003cspan class=\"p\"\u003e,-\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                    \u003cspan class=\"kt\"\u003edouble\u003c/span\u003e \u003cspan class=\"n\"\u003ep0\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enum0s\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep0\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Re:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],-\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Im:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e],-\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadKey\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれらを（ビルドして）走らせることにより，以下のような結果が得られます：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e結果\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e0: 0s=264  1s=736\n1: 0s=748  1s=252\n2: 0s=222  1s=778\n3: 0s=242  1s=758\nRe:-1.028\nIm:-0.02\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以上より，$A_2^{\\dagger} A_1 A_2^{\\dagger} A_1$のトレースの値の一番近い整数 $^{\\ast 1}$ は$-1 + 0 \\cdot i$となることが分かり，８の字結び目のJones多項式の$i$での値が$-1$になることを確認できました．\u003c/p\u003e\n\n\u003cp\u003e\u003cdetails\u003e\u003csummary\u003e$\\ast 1$\u003c/summary\u003e\u003cbr\u003e\n一般の結び目$K$に対し，Arf 不変量とよばれる，0または1に値をとる結び目の不変量 ${\\rm Arf}(K)$ を使って，結び目$K$のJones多項式の$i$での値$J_K(i)$は$(-1)^{{\\rm Arf}(K)}$で与えられます(cf. [Murakami])．よって$J_K(i)$ は整数になるため，実装で得られた結果に近い整数を見つければよいことが分かります．逆に言えば，得られた結果からArf 不変量を求めることができ，$K$ が8の字結び目の場合は${\\rm Arf}(K) = 1$ になることが分かります．\u003cbr\u003e\n\u003c/details\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"1の5乗根での近似値を求める\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1%E3%81%AE5%E4%B9%97%E6%A0%B9%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1の5乗根での近似値を求める\u003c/h1\u003e\n\n\u003cp\u003e最後に８の字結び目のJones 多項式の1の5乗根 $e^{\\frac{2 \\pi i}{5}}$ での近似値を同様の方法で求めてみます．$\\begin{align} \\eta := 2 \\cos\\frac{\\pi}{5} = \\frac{1 + \\sqrt{5}}{2} \\end{align}$とおくと，目標は二つのユニタリ行列\u003c/p\u003e\n\n\u003cp\u003e$$\\begin{align}\u003cbr\u003e\nB_1 :=\u003cbr\u003e\n\\begin{pmatrix}\u003cbr\u003e\ne^{-\\frac{4 \\pi i}{5}} \u0026amp; 0 \u0026amp; 0\\ \\\\\u003cbr\u003e\n0 \u0026amp; e^{\\frac{3 \\pi i}{5}} \u0026amp; 0\\ \\\\\u003cbr\u003e\n0 \u0026amp; 0 \u0026amp; e^{\\frac{3 \\pi i}{5}}\u003cbr\u003e\n\\end{pmatrix}, \\\u003cbr\u003e\nB_2 :=\u003cbr\u003e\n\\begin{pmatrix}\u003cbr\u003e\n\\eta^{-1} e^{\\frac{4 \\pi i}{5}} \u0026amp; \\eta^{-\\frac{1}{2}} e^{-\\frac{3 \\pi i}{5}} \u0026amp; 0\\ \\\\\u003cbr\u003e\n\\eta^{-\\frac{1}{2}} e^{-\\frac{3 \\pi i}{5}} \u0026amp; -\\eta^{-1} \u0026amp; 0\\ \\\\\u003cbr\u003e\n0 \u0026amp; 0 \u0026amp; e^{\\frac{3 \\pi i}{5}}\u003cbr\u003e\n\\end{pmatrix}\u003cbr\u003e\n\\end{align}$$\u003c/p\u003e\n\n\u003cp\u003eに対し，行列の積$B_2^{\\dagger} B_1 B_2^{\\dagger} B_1$の対角成分$b_{ii}$ で表わされる値\u003c/p\u003e\n\n\u003cp\u003e$$\\begin{align} \\eta^2 \\cdot \\frac{1}{\\sin\\frac{2 \\pi}{5} + \\sin\\frac{2 \\pi}{5} + \\sin\\frac{4 \\pi}{5}} \\cdot \\left( \\sin\\frac{2 \\pi}{5} \\cdot b_{11} + \\sin\\frac{2 \\pi}{5} \\cdot b_{22} + \\sin\\frac{4 \\pi}{5} \\cdot b_{33} \\right) \\end{align}\u003cbr\u003e\n$$\u003c/p\u003e\n\n\u003cp\u003eを求めることです．\u003c/p\u003e\n\n\u003cp\u003eまず$B_2^{\\dagger} B_1 B_2^{\\dagger} B_1$の $(3,3)$-成分$b_{33}$ については直接計算することにより，$1$になることが分かります．\u003c/p\u003e\n\n\u003cp\u003e残りの$(1,1)$-成分$b_{11}$，$(2,2)$-成分$b_{22}$を求めるためには，$B_1$，$B_2$から第3行と第3列を取り除いた以下の二つの2行2列のユニタリ行列を考えます：\u003c/p\u003e\n\n\u003cp\u003e$$\\begin{align}\u003cbr\u003e\nB_1^{\\prime} :=\u003cbr\u003e\n\\begin{pmatrix}\u003cbr\u003e\ne^{-\\frac{4 \\pi i}{5}} \u0026amp; 0 \\\\\u003cbr\u003e\n0 \u0026amp; e^{\\frac{3 \\pi i}{5}}\u003cbr\u003e\n\\end{pmatrix}, \\\u003cbr\u003e\nB_2^{\\prime} :=\u003cbr\u003e\n\\begin{pmatrix}\u003cbr\u003e\n\\eta^{-1} e^{\\frac{4 \\pi i}{5}} \u0026amp; \\eta^{-\\frac{1}{2}} e^{-\\frac{3 \\pi i}{5}}\\ \\\\\u003cbr\u003e\n\\eta^{-\\frac{1}{2}} e^{-\\frac{3 \\pi i}{5}} \u0026amp; -\\eta^{-1}\u003cbr\u003e\n\\end{pmatrix}.\u003cbr\u003e\n\\end{align}\u003cbr\u003e\n$$\u003c/p\u003e\n\n\u003cp\u003e行列の積${B_2^{\\dagger}}^{\\prime} B_1 {B_2^{\\dagger}}^{\\prime} B_1$の$(1,1)$-成分，$(2,2)$-成分がそれぞれ$b_{11}$，$b_{22}$ になります．\u003ca href=\"https://qiita.com/SelMut/items/8aa2a9a21b39da2bd28d#%EF%BC%98%E3%81%AE%E5%AD%97%E7%B5%90%E3%81%B3%E7%9B%AE%E3%81%AEjones-%E5%A4%9A%E9%A0%85%E5%BC%8F%E3%81%AE1%E3%81%AE%E5%8E%9F%E5%A7%8B5%E4%B9%97%E6%A0%B9%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B%E3%81%93%E3%81%A8%E3%82%92%E8%A9%A6%E3%81%BF%E3%82%8B\" id=\"reference-b928593511faede7b59f\"\u003e前回\u003c/a\u003eは$B_1^{\\prime}$ と$B_2^{\\prime}$に対して，近似値 $\\eta^{-1} = \\frac{\\sqrt{5} - 1}{2} = 0.618 \\cdots \\approx \\cos 51.8^{\\circ} = \\cos\\left(\\frac{1}{2} \\cdot \\frac{103.6 \\pi}{180}\\right)$ と$\\eta^{-\\frac{1}{2}} \\approx \\sin 51.8^{\\circ} = \\sin\\left(\\frac{1}{2} \\cdot \\frac{103.6 \\pi}{180}\\right)$を使って$\\alpha$, $\\gamma$, $\\beta$, $\\delta$を求めました．Q#でも量子ゲートの合成・随伴，さらには制御ゲートについても簡潔に書くことができるため，これらを使って実装します．\u003c/p\u003e\n\n\u003cp\u003e一般の$2 \\times 2$のユニタリ行列を実装するには準備でも述べた以下の等式を使います：\u003c/p\u003e\n\n\u003cp\u003e$$U_3^{\\prime}(\\gamma, \\beta, \\delta) = R_z (\\beta) R_y \\left(\\frac{\\gamma}{2} \\right) \\cdot X \\cdot R_y \\left(- \\frac{\\gamma}{2} \\right) R_z \\left(- \\frac{\\beta +\\delta}{2} \\right) \\cdot X \\cdot R_z \\left(- \\frac{\\beta -\\delta}{2} \\right)$$\u003c/p\u003e\n\n\u003cp\u003e実は$X \\cdot R_y \\left(- \\frac{\\gamma}{2} \\right) R_z \\left(- \\frac{\\beta +\\delta}{2} \\right) \\cdot X  = R_y \\left(\\frac{\\gamma}{2} \\right) R_z \\left(\\frac{\\beta +\\delta}{2} \\right)$ より，$U_3^{\\prime}(\\gamma, \\beta, \\delta)$ は $R_y(\\theta)$ と $R_z (\\theta)$ のみで表わすことができます：\u003c/p\u003e\n\n\u003cp\u003e$$U_3^{\\prime}(\\gamma, \\beta, \\delta) = R_z(\\beta) R_y(\\gamma) R_z(\\delta). $$\u003c/p\u003e\n\n\u003cp\u003e一般の$2 \\times 2$のユニタリ行列は$e^{i \\alpha} U_3^{\\prime}(\\gamma, \\beta, \\delta)$と表わされるため，$e^{i \\alpha}$倍についても考える必要があります．これをユニタリ行列として表わすには，Q#で準備されている以下の量子ゲートを使ってみます（符号と2で割ることに注意．コードでは \u003ccode\u003eR(PauliI, theta, qubit)\u003c/code\u003eのように書きます．）：\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e量子ゲート\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003eユニタリ行列\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003ca href=\"https://camo.qiitausercontent.com/a11bb191c8d4fc5dddba5835bfc43025d3094abb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3235323938322f34373564393662332d656539372d363266632d636534332d3636366434633439643038612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"78\" alt=\"RI-theta.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F475d96b3-ee97-62fc-ce43-666d4c49d08a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1cba470a7674534cba9ecb1b3e4548a1\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/252982/475d96b3-ee97-62fc-ce43-666d4c49d08a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2F475d96b3-ee97-62fc-ce43-666d4c49d08a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9fe5fd5e3f13c821bc7973cba9e306e5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e$\\begin{pmatrix} e^{- \\frac{i \\theta}{2}} \u0026amp; 0\\\\ 0 \u0026amp; e^{- \\frac{i \\theta}{2}} \\end{pmatrix}$\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eすると，$B_1^{\\prime}$と$B_2^{\\prime}$はそれぞれ以下のように表わされます：\u003c/p\u003e\n\n\u003cp\u003e$$\\begin{align}\u003cbr\u003e\nB_1^{\\prime} \u0026amp;= R_I \\left(\\frac{\\pi}{5} \\right) \\cdot U_3^{\\prime} \\left(0, \\frac{7}{5}\\pi, 0 \\right)，\\\\\u003cbr\u003e\nB_2^{\\prime} \u0026amp;\\approx R_I \\left(-\\frac{9 \\pi}{5} \\right) \\cdot U_3^{\\prime} \\left( \\frac{103.6 \\pi}{180}, \\frac{3 \\pi}{5}, -\\frac{2 \\pi}{5} \\right).\u003cbr\u003e\n\\end{align}\u003cbr\u003e\n$$\u003c/p\u003e\n\n\u003cp\u003e以上より，目標をまとめて書くと，Q#については以下のように見やすく書くことができます：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eOperations.qs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eQuantum.Jones_figEight_5th\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eQuantum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimitive\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eQuantum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCanon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eQuantum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eExtensions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"nf\"\u003eSet\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edesired\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eQubit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eM\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edesired\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// U3'(γ, β, δ)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"nf\"\u003eU3p\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDouble\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebeta\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDouble\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDouble\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eQubit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003ebody\u003c/span\u003e \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edelta\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n              \u003cspan class=\"nf\"\u003eRy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n              \u003cspan class=\"nf\"\u003eRz\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebeta\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eadjoint\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolled\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolled\u003c/span\u003e \u003cspan class=\"n\"\u003eadjoint\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// B1'\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"nf\"\u003eB1p\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eQubit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003ebody\u003c/span\u003e \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"nf\"\u003eU3p\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1.40\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n              \u003cspan class=\"nf\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePauliI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.20\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eadjoint\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolled\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolled\u003c/span\u003e \u003cspan class=\"n\"\u003eadjoint\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// B2'\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"nf\"\u003eB2p\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eQubit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUnit\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003ebody\u003c/span\u003e \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"nf\"\u003eU3p\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"m\"\u003e103.6\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e180.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"m\"\u003e0.60\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e0.40\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n              \u003cspan class=\"nf\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePauliI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1.80\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eadjoint\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolled\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtrolled\u003c/span\u003e \u003cspan class=\"n\"\u003eadjoint\u003c/span\u003e \u003cspan class=\"n\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"nf\"\u003eHadamardTest_figEight_5th\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecount\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003einitial\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eInt\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emutable\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eQubit\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etest\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"m\"\u003e1.\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eSet\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eSet\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nf\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"nf\"\u003eH\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e               \n                    \u003cspan class=\"nf\"\u003eAdjoint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eS\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"nf\"\u003eControlled\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eB1p\u003c/span\u003e\u003cspan class=\"p\"\u003e)([\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eControlled\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdjoint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eB2p\u003c/span\u003e\u003cspan class=\"p\"\u003e))([\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eControlled\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eB1p\u003c/span\u003e\u003cspan class=\"p\"\u003e)([\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eControlled\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdjoint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eB2p\u003c/span\u003e\u003cspan class=\"p\"\u003e))([\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]],\u003c/span\u003e \u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"nf\"\u003eH\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eM\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eset\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"nf\"\u003eResetAll\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equbits\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003enumZeros\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eまた，今回もより正確な値（目標は上4桁）を得るためにHadamardテストを1000回繰り返し，得られた結果の平均を取ることを考えます．すると，C#については以下のようになります：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eDriver.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// List\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMicrosoft.Quantum.Simulation.Core\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMicrosoft.Quantum.Simulation.Simulators\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eQuantum.Jones_figEight_5th\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDriver\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eqsim\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eQuantumSimulator\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003edouble\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n                \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003esum0s\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enum0s\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eHadamardTest_figEight_5th\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eqsim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eResult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esum0s\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003enum0s\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                    \u003cspan class=\"kt\"\u003edouble\u003c/span\u003e \u003cspan class=\"n\"\u003eavgNum0s\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esum0s\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e: avgNum0s=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eavgNum0s\u003c/span\u003e\u003cspan class=\"p\"\u003e,-\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                    \u003cspan class=\"kt\"\u003edouble\u003c/span\u003e \u003cspan class=\"n\"\u003ep0\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eavgNum0s\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep0\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                \u003cspan class=\"kt\"\u003edouble\u003c/span\u003e \u003cspan class=\"n\"\u003eeta\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2.0\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCos\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.20\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003edouble\u003c/span\u003e  \u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.40\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003edouble\u003c/span\u003e  \u003cspan class=\"n\"\u003es4\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.80\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePI\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Re:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eeta\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eeta\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es4\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es4\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"m\"\u003e1.0\u003c/span\u003e\u003cspan class=\"p\"\u003e),-\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Im:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eeta\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eeta\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es4\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elistVals\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]),-\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadKey\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以上を走らせると，以下のような結果が得られます（筆者の安いPCのWindows上のVSCodeでは4時間ほど掛かりました）：\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e結果\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e0: avgNum0s=36.604\n1: avgNum0s=612.636\n2: avgNum0s=36.005\n3: avgNum0s=387.623\nRe: -1.2367480112501\nIm: 0.0005179999999999\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以上より，８の字結び目のJones多項式の$e^{\\frac{2 \\pi i}{5}}$での値$\\begin{align} (-\\sqrt{5} + 1) + 0 \\cdot i = -1.23606 \\cdots \\end{align}$と近い値を得ることができました．\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考文献\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考文献\u003c/h1\u003e\n\n\u003cp\u003e・H. Murakami, \u003ca href=\"https://projecteuclid.org/euclid.jmsj/1230395012\" rel=\"nofollow noopener\" target=\"_blank\"\u003eA recursive calculation of the Arf invariant of a link\u003c/a\u003e, J. Math. Soc. Japan 38 (1986) 335--338.\u003c/p\u003e\n\n\u003cp\u003e・M. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum Information: 10th Anniversary Edition, Cambridge University Press (2010).\u003c/p\u003e\n","createdAt":"2018-12-14T22:34:12Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"Jpx2kP+5AUvmievrwwgyd26rJ4FcsJPF--K4HjzWSPUbpK8KUc--XeLXBFeeb9YQzGmLA47fbQ==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2018-12-17T06:09:10Z","likesCount":3,"linkUrl":"https://qiita.com/SelMut/items/15b66d35e25de4d66dc6","organization":null,"originalId":741178,"stockedCount":2,"title":"Q#でJones多項式の量子アルゴリズム","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%BA%96%E5%82%99\"\u003e準備\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%99%9A%E6%95%B0%E5%8D%98%E4%BD%8D%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003e虚数単位での近似値を求める\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#1%E3%81%AE5%E4%B9%97%E6%A0%B9%E3%81%A7%E3%81%AE%E8%BF%91%E4%BC%BC%E5%80%A4%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003e1の5乗根での近似値を求める\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e参考文献\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":1033,"uuid":"15b66d35e25de4d66dc6","banReason":null,"adventCalendarItem":{"day":15,"calendar":{"name":"量子コンピュータ #2","urlName":"quantum2","year":2018,"organization":null}},"author":{"encryptedId":"MJP+twUwGd2C6oe+Ri7/VMIUdmuj--RPipOB524Z8jfkR7--ISa5mgqmBWSwp8va7CX11Q==","originalId":252982,"description":"大学院で数学を学んでいます．数学のトポロジーが量子コンピュータに応用されていることを学び，量子情報の分野に興味を持ちました．現在は分配関数やトポロジカルデータ解析の量子アルゴリズムを実装できないか考えています．写像類群やDehn手術が量子情報にどのように応用されているかに興味を持っています．","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/252982/profile-images/1544826927","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fprofile-images%2F1544826927?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=d46f42ad498068c9017b5b8638bdf0db","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F252982%2Fprofile-images%2F1544826927?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=f05ff665ed587f15d9b464aeef5d8d22","urlName":"SelMut","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"量子コンピュータ","urlName":"%e9%87%8f%e5%ad%90%e3%82%b3%e3%83%b3%e3%83%94%e3%83%a5%e3%83%bc%e3%82%bf"},{"name":"量子ゲート","urlName":"%e9%87%8f%e5%ad%90%e3%82%b2%e3%83%bc%e3%83%88"},{"name":"Q#","urlName":"qsharp"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
