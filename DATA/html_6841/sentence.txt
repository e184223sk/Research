More than 3 years have passed since last update.例えばこんな構造体をこさえたとするでこいつが､何かしらのreadonlyなメンバフィールドになったとき､予想外の結果になるので注意しましょうってお話なので､一つおつきあい頂ければこれ幸い｡とりあえずこんな風にメンバフィールドとしてこさえてみる｡で､下記のようにメソッドを追加してみる｡この場合､コメントにあるとおり､readonlyなメンバに対するプロパティの設定操作は許容されずコンパイルエラーになる｡
そりゃそーだ､なにせ読み取り専用なのだから｡内部状態を変更するメソッドを実行した場合､とても厄介なことになる｡
とりあえず､問題起こすサンプルは以下の通り｡さてこの場合､結果は､値型のメンバフィールドの値型はreadonly制約が効くので変更されない｡
しかも､メソッド呼び出しそのものはコンパイルエラーもランタイムエラーも発生させず､結果が予想外になるというとんでもなく厄介な結果となる｡
蛇足ながら､なんでエラーにならず､結果が予想外になるかはコンパイル時に以下のような結果を生成するからまた､readonlyな値型の参照型メンバフィールドはしれっと変更できちゃうのでこれも又注意しないとマズい｡ということで､readonlyな値型に対する間接的なmutableな操作は時として相当厄介なバグを生み出すので､注意すべきかと｡
おつきあい頂有り難うございました｡


