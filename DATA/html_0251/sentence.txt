Xamarin.Forms でアプリ作るときには結構な人がお世話になる Prism !!
この Prism ですが、現状 Shell には対応していません。Shell が割とバギーな雰囲気があるせいもあるのかもしれませんが、Shell で作れる以下のような画面作りたいっていうのはよくある話ですよね。じゃぁ Prism を使った状態でこんな雰囲気のページを作るには？ということになるのですが、大体以下のような感じです。大体こんな感じです。とりあえずやってみた。登録しているページは以下のような感じです今回は初期状態では MasterDetailPage の中に 空の NavigationPage を表示しておきました。MasterDetailPage を継承した MainPage では以下のように CollectionView でフライアウトメニューの項目を表示するようにしています。MainPageViewModel で実際にメニューに表示する項目の管理やメニューの項目が選択されたときに画面遷移を行うようにしています。タブのページのところだけ以下のように画面遷移の文字列がちょっと複雑になっています。これでタブの中に3ページ作って ViewB を初期表示にしています。Shell でも先日やった戻るボタンで一旦トップに戻る実装ですが、今回の場合は MainPage でやれば OK です。今回は、お試しで愚直に View に書いてますが OnBackButtonPressed のハンドリングは View でするとしても中身の処理は ViewModel に突っ込んだ方がいいと思います。これで ViewA 以外で戻るボタンを押したら ViewA に行きます。とりあえず Prism 使うと Shell は諦めることになるので、こんな感じで Prism の強力なナビゲーション機能を使って実現することになるかなと思います。ソースは GitHub に上げてます。


