More than 1 year has passed since last update.初心者脱却のために、どうしてもGUIプログラムを作りたい・・・！と思ったのとせっかくなので、TodoListdonをグレードアップしてみようと思いました電気系プログラミングガチ素人学生が初心者脱却のためのコアのプログラムを作ったら思いっきり脱線した話こちらに。
https://github.com/sanbongazin/TodoListDon-GUIコマンドで設計した内容ができているのだから、その内容をGUIに落とし込むだけ！と考えていたのがアホの極みでした。
画面の置き方をデザインビューで行います。今回はフォームアプリを利用しています。まず設計からつまづきました。コマンドプロンプトではクラス化すればいいだけだもの・・・ウィンドウどうすれば動くんや！！！って思ったら簡単にわかりました。これで表示できるし、閉じられるまで待ってくれるので、エラーが起きづらい！！めっちゃ楽！！！TodoListをまずは追加したいだろ！って思いながら、まずは、リストを作ってそれを追加します。また、TodoListを裏方でListに格納しています。追加、削除はListBoxで追加や、削除は一行で済みますが、問題は保存と読み込み。そこで、裏でリストを格納させ、リストとデータをリンクさせ、テキストファイルとして保存させることで、保存、読み込みを可能としています。保存の際にリストにしておくことで、foreach処理で一度文字数を連結することを可能にしています。思いつく簡単な処理がこれでしたので、今回はこの形にしてみました。Mastdonで、トゥートするにも権限を付与したアクセストークンが必要です。そこで以前はテキストに裸で格納しているという危険な手法をとっていたので、それらを一般用で頒布するのはとんでもない方法なのでやめました。そこで、Qiitadonの方々に、レジストリを使ってみては？という案をいただきました。そこで、使ってみることにしました。tryセクションで、レジストリを読みに行きます。今回はSoftwareにkeyを作成しました。そこでhostの情報と、アクセストークンを取得するようにしました。また、もし取得できない場合、catchします。新規作成の場合はダイアログを作成します。ダイアログのソースコードは以下のようになります。この認証のソースコードは結構再利用できます。簡易的ですが、これでレジストリに記録が可能になります。テキストボックスにリンクを入力し、アクセストークンを取得します。アクセストークンは、レジストリに格納されます。コンパイルしようと思ったら何故かこんなエラーが・・・
なにこれ？？？と思いつつ、検索しても出てこない。どうすればええんや・・・と思ったのですが、VS2017にするとなぜか実行可能に・・・ソフトウェアを頒布したいならやはりインストーラは必要ではと感じたため、どうやってインストーラを作ろうかと考えました。しかし、VisualStudioならそういったパッケージも簡単に作成可能のようです。
拡張機能からダウンロード可能です。さて、これを活用しましょう。
ソリューションを右クリックして、新しいプロジェクトを追加しましょう。
その他のプロジェクトにセットアップを追加できます。そうすると3つのフォルダーが出現しますApplicationFolderを右クリックすることで、メニューを開き、プロジェクト出力をクリックしましょう。これで出力されたソフトウェアをインストールパッケージに加えることができます。ソフトウェアをデスクトップやスタートメニューに加えることも可能です。その際は以下のようにショートカットを作り、それぞれのフォルダーに入れましょう。また、PDFをフォルダーに追加することも可能です。これにより、説明書なども入れることができます。これで初めてのソフトウェアづくりは完遂できました・・・・はじめて初心者向けのチュートリアルを一つクリアできたというところでしょうか・・・学んだことはあたり前なものもあるかもしれません。しかし、電気系プログラムガチ素人である私にはとても新鮮なことも多かったです。また、コーディングもまだまだ非効率であったり、穴もありそうです。まだまだ学ぶことは多そうですね・・・今度は動作OSを拡大したいところです。また、ソフトウェアデザインの必要性を強く感じました。あとは・・・フォームじゃなくてXamlで作りたくなりました・・・できるだけ新しい技術に触れていたいところです。Visual Studio 2017でインストーラ作成
https://www.osadasoft.com/visual-studio-2017%E3%81%A7%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%A9%E4%BD%9C%E6%88%90/


