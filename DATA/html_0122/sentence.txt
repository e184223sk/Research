業務上、特定の場所のテキストを一定の法則で置き換えて更新する作業が発生した。
本来ならpyautoguiなどを使って自動化できないか考えるところだったが、
派遣開始してからの日が浅く、納期も短いために時間のかかることはできない。そのため、次善の策としてC#でクリップボードを監視・置き換えするアプリを作成した。インターネットで検索をかけると、このようなクリップボードの監視方法があるらしい。
ただ、僕は今の会社に無限にいるわけでもないので、もう少しシンプルな方法で実装しておいて、他人がメンテナンスできるようにしておいたほうが良いと思った。なので今回はシンプルにSystem.Windows.Forms.Clipboardクラスを使ってフォームアプリケーションとして作ることにした。なお、Clipboardクラス自体は.Net Framework1.1から対応しているようなので、
今使用可能なWindowsならバージョン依存はなく動くはずである。下の画像のようなUIを準備した。数字の書かれているラベルはcountLabel、監視中と書かれているボタンは見た目をボタンにしたcheckEnablerという名前のチェックボックス、
変換後のテキストボックスはlastText、変換前のテキストボックスはnextTextと名付けた。
また、timer1という名前のタイマも適当な間隔を指定してある。特に難しいことは考えず、一定周期でクリップボードにテキストデータが入っているかを確認し、
テキストデータが最後に取得したテキストデータと異なっているのであれば一定の条件で処理を行っている。数百回レベルの作業が予想されていたため、確認処理を行うたびにラベルのテキストと色を反転させて、
処理が行われているかどうかをわかりやすくした。
業務アプリだったら変換前・後のテキストをどこかに保存しておくのも有効だと思う。とりあえず自分で動かしてみた限りでは問題なく動いた。


