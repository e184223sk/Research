More than 5 years have passed since last update.ListViewをDetailsモードで使っているとき、コンテキストメニューを行コマンドとして扱う、ってのは自然な事ですよね
この場合、「有効な行」の上でのコンテキストメニューと、「有効な行がない」時にでるコンテキストメニューは項目が違ったりしますでもこのコンテキストメニュー、ヘッダ行の上でも出てきちゃうんです（ListViewに対するコンテキストメニューなので、当然っちゃ当然ですが）
でもヘッダ領域ってのは、「有効な行」であるとは到底言えませんが、「有効な行ではない」場所と断定されても困るなぁ…
と云う、お・は・な・し当然基本的には、ContextMenuStripのOpeningイベントハンドラ内で、マウスクリック位置がヘッダであったらメニューを開かなければ良いだけですだけ、何ですけどね…
ヘッダ行上でマウスクリックが起きたのかを判定する簡単で直接的な方法が見つからないんです
で、それを判定する方法を纏めてみたいと思います取り敢えず何も考えずにコンテキストメニュー有効な行があるか否かでメニューを変える
ここでは、ListViewのSelectedItemsにListViewItemがあるか無いかで判定で、結果うーん、使えない標準で準備されているプロパティ～Item(s)とかは余りアテにならなそう
こういう時はListView.HitTest()を使え！
と先人達が仰っておられる
つまり、何があるかは自分で判断しなさい、と云う事ですねうむむー…
行のない処では期待通りの動きをしているが、ヘッダ領域ではあたかも有効な行が存在するかの様な判定結果になっているListViewの云う事を素直に聞けないならばどうすれば良いのか？
それは、関係者の意見を集めて矛盾点を衝く！
という事で以下の作戦を立てるここで、カレント君の中にマウスがいなければListViewはウソを吐いているっ！と云う事で以下のコードで対応めでたしめでたし


