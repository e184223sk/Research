More than 1 year has passed since last update.前回C#で伺か(SSP)にSSTP通信する - Qiitaでゴーストに好きな発話をさせることに成功しましたが、
私はスクリプターではなくユーザーなので操作するのはゴーストではなくユーザー操作側でありたいです。ここでは
イベント - 里々Wiki
や
UKADOC Project SHIORI Eventリスト
だけではなく、その転送？先のもっと直接的なイベントを呼び出します。
だってOnMouseMoveイベントだけで「こする」「なでる」動作を呼びだしずらくないですか？まずは一番簡単そうなOnMouseDoubleClickでエミリの口をつついてみようと思います。OnMouseDoubleClickのReferenceは規定さてれいますが
それでも実装はゴースト側しだいなので確認しておきましょう。
ゴーストのフォルダからそれらしいフォルダを探して…ssp\ghost\emily4\ghost\master\aya_mouse_core.dic
を覗くとと記述されていました。EMGETPrefixも一応乗せておくと、なので、Mouseと呼び変えてＯＫです。このイベントの組み方では、referenceの3と4を指定することで特定の部位をダブルクリックしたものとみなせそうですね。じゃあ実際にどんな反応を返してほしいかをさぐるために、呼び出されるイベントを調べて面白い反応を探して見ます。次はコアではなく実際のトークが書かれていそうな
ssp\ghost\emily4\ghost\master\aya_mouse.dic
を見ます。ありました。
0は仕様からさくら側、というか本体側のことなので、このイベントはエミリの口をダブルクリックしたときのイベントです。
OnMouseDoubleClickとあわせて、とすればよさそうですね。では前回書いたコードのmessage変数を書き換えて実行してみますランダムなトーク内容までは指定できませんが、口のダブルクリックをコマンド上で実現できました。なでる、というイベントは、マウスでおこなう場合は一定時間継続して同じ部位の上でマウスを動かすことで実現されていると思います。
エミリの場合、頭をなでるトーク名はこうでは、aya_mouse_core.dicのほうでNadeに転送している部分はというとなんとなーく読んでなんとなーく面倒だという気がしますね？
内部で保持する「撫でられ量」を一定以上にする必要がありそうです。こういった場合はもう面倒なので、ゴースト独自のイベントを直接呼んでしまうことにします。すなわち、Mouse_Nade0Headを直接callするのです。
SHIORI Eventリストからは外れるので汎用性はなくなりますが、
組み方しだいでは好感度や前提条件などをもろもろ飛ばして実行できるやりかたですね。これで動く…はずなのですが、問題発生。
まったく動かない
実はエミリで書くのは記事用で、実際にイベントを発行して遊んでいたゴーストは別の子だったんですよね。
その子は里々で書かれており、エミリは文(YAYA？)で書かれているのでイベントの受け取り方が違うのかしらん？ということで、急遽里々製の別のゴーストを受信してみました。おすすめゴーストのトップにいたシルフィア氏です。里々は非常に読みやすくて助かりますが、一応コードも見ておきますかこのようになでる処理は複雑なので、直接こちらを送信してみますやはり里々では成功しました。
私は伺か全般に加え栞、SAORIにまったく詳しくないのでエミリでなぜ失敗しているのか教えてもらえると助かるのですが…。里々に関してはコミュニケーション含め実行できることが確認できているので、一応全ゴースト対応というわけではないですが、CLIでゴーストの標準の反応を引き出す手法として勘弁してください。当初は汎用のイベント送信プログラムを組もうと思っていたのですが、ゴーストごとのイベントの記述に特徴がありそうでOnMouseDoubleClickなど簡単なものを除けば辞書を見ながらゴーストごとに最適なイベント名とリファレンスを設定しないといけないのかもしれないなあと思いました。私はあまり複数ゴーストを使わないので特化でいいのですが汎用的な操作コマンドが作られるといいですね(他人事余談の余談ですが任意たんの辞書ってどうやって読むんでしょうかね…？
そもそもSSPで動くのかしら


