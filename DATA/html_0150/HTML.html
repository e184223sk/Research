<!DOCTYPE html><html><head><meta charset="utf-8" /><title>D言語 → C++ → C#の連携方式 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/devmynote/items/b52c13f0d3437de786cb" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="NyOaAlSMd8dfV5iY4I/0R219glHduFpENKkIHhHPh8VeI3GzgdQQNhzdSZlnl/77tsuGHIjJmRDHrwVqgIubnQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="D言語 → C++ → C#の連携方式 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ST2lvZ09pcW5pRGlocElnUXlzcklPS0draUJESS1PQnJ1bUFvLWFRdXVhV3VlVzhqdyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz00MmZmNTUwNDZmMDEyNWQ0MjM3ODVhZDQ4OGY4NDA4OQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR1JsZG0xNWJtOTBaUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTRhZjQ2MGJiMjQyNGU1ZTQ5NzMyNTEwOTY0MjI2MWFm&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=7ffa5ebc5afa5b4a4a7127d9fe684ee8"><meta property="og:description" content="

はじめに

D言語から、C#のソースコードやライブラリを利用したい場合について、その利用方法を考えてみました。


D言語とC#との連携方式

D言語からC#の関数を呼び出す際、C++（C++/CLI）を経由するのが簡単だと思って..."><meta content="https://qiita.com/devmynote/items/b52c13f0d3437de786cb" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C++,C#,dlang,D言語,C++CLI" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-239365a1-3c98-441e-b63e-98a55b13bb34"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fdevmynote%2Fitems%2Fb52c13f0d3437de786cb">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fdevmynote%2Fitems%2Fb52c13f0d3437de786cb">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-239365a1-3c98-441e-b63e-98a55b13bb34">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/cpp","name":"C++"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2021-01-02T14:07:09.000+09:00","dateModified":"2021-01-02T14:07:09.000+09:00","headline":"D言語 → C++ → C#の連携方式","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ST2lvZ09pcW5pRGlocElnUXlzcklPS0draUJESS1PQnJ1bUFvLWFRdXVhV3VlVzhqdyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz00MmZmNTUwNDZmMDEyNWQ0MjM3ODVhZDQ4OGY4NDA4OQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR1JsZG0xNWJtOTBaUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTRhZjQ2MGJiMjQyNGU1ZTQ5NzMyNTEwOTY0MjI2MWFm\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=7ffa5ebc5afa5b4a4a7127d9fe684ee8","mainEntityOfPage":"https://qiita.com/devmynote/items/b52c13f0d3437de786cb","author":{"@type":"Person","address":"","email":null,"identifier":"devmynote","name":"devmynote","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F675901%2Fprofile-images%2F1595052067?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=2bbe618a286032f5490c73d2de3eb35c","url":"https://qiita.com/devmynote","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"devmynote","type":"items","id":"b52c13f0d3437de786cb"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"devmynote","type":"items","id":"b52c13f0d3437de786cb"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"devmynote","type":"items","id":"b52c13f0d3437de786cb"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/devmynote/items/b52c13f0d3437de786cb","location":"/devmynote/items/b52c13f0d3437de786cb","scheme":"https","host":"qiita.com","port":null,"pathname":"/devmynote/items/b52c13f0d3437de786cb","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"JhCAgDyEXkHE0Ld7ry8+I0GBR3PKgydOEdSP6TkS7KVPEGsx6dw5sIdaZnooNzSfmjdDPp/y5Bri0oKdqFbw/Q==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-da21ec35-10bf-4347-b7fc-f7982e920d31"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/devmynote/items/b52c13f0d3437de786cb/likers" class="css-1iupg5d">1</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">0</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/b52c13f0d3437de786cb/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/devmynote/items/b52c13f0d3437de786cb/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/devmynote/items/b52c13f0d3437de786cb/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/devmynote/items/b52c13f0d3437de786cb/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/devmynote/items/b52c13f0d3437de786cb.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2020/dlang" class="it-AdcalRibbon_title">D言語<!-- --> Advent Calendar<!-- --> <!-- -->2020</a>Day 9</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/devmynote"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/675901/profile-images/1595052067" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/devmynote" class="css-10ougpm">@<!-- -->devmynote</a><div class="css-1ay9vb9"><time dateTime="2021-01-02T05:07:09Z" class="css-m19uds">posted at 2021-01-02</time></div></div></div></div></div><h1 class="css-cgzq40">D言語 → C++ → C#の連携方式</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/cpp" class="css-4czcte">C++</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/dlang" class="css-4czcte">dlang</a><a href="/tags/d%e8%a8%80%e8%aa%9e" class="css-4czcte">D言語</a><a href="/tags/c%2b%2bcli" class="css-4czcte">C++CLI</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p><code>D言語</code>から、<code>C#</code>のソースコードやライブラリを利用したい場合について、その利用方法を考えてみました。</p>

<h1>
<span id="d言語とcとの連携方式" class="fragment"></span><a href="#d%E8%A8%80%E8%AA%9E%E3%81%A8c%E3%81%A8%E3%81%AE%E9%80%A3%E6%90%BA%E6%96%B9%E5%BC%8F"><i class="fa fa-link"></i></a>D言語とC#との連携方式</h1>

<p><code>D言語</code>から<code>C#</code>の関数を呼び出す際、<code>C++</code>（<code>C++/CLI</code>）を経由するのが簡単だと思っています。<br>
<a href="https://qiita.com/devmynote/items/015483085e1d6e1a209b" id="reference-d83f5bf5c3a4ba6b603e">以前の記事</a>でも、１つの実装例を紹介しましたが、他にも連携方式を考えてみましたので、ここにまとめます。</p>

<p><code>EXE</code>ファイルや<code>DLL</code>ファイルの作成方法で、４つのパターンに分類しました。</p>

<table>
<thead>
<tr>
<th style="text-align: left">#</th>
<th style="text-align: left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">パターン１</td>
<td style="text-align: left">C++、C#のソースごとにDLLを作成する。DのソースでEXEファイルを作成する。</td>
</tr>
<tr>
<td style="text-align: left">パターン２</td>
<td style="text-align: left">C++、C#のソースをあわせて１つのDLLを作成する。DのソースでEXEファイルを作成する。</td>
</tr>
<tr>
<td style="text-align: left">パターン３</td>
<td style="text-align: left">C#のソースでDLL、C++、DのソースをあわせてEXEファイルを作成する。</td>
</tr>
<tr>
<td style="text-align: left">パターン４</td>
<td style="text-align: left">D、C++、C#のソースをあわせて、１つのEXEファイルを作成する。</td>
</tr>
</tbody>
</table>

<h1>
<span id="環境" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>環境</h1>

<p>以下のソースコードは、以下の環境でコンパイルしています。</p>

<ul>
<li>Windows 10</li>
<li>
<a href="https://visualstudio.microsoft.com/ja/downloads/" rel="nofollow noopener" target="_blank">Visual C++ ビルドツール 2019</a>　→　<a href="https://www.kkaneko.jp/tools/win/buildtool.html" rel="nofollow noopener" target="_blank">インストール手順</a>
</li>
<li>
<a href="https://dlang.org/download.html" rel="nofollow noopener" target="_blank">DMD</a> v2.094.2</li>
</ul>

<h1>
<span id="パターン１" class="fragment"></span><a href="#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%91"><i class="fa fa-link"></i></a>パターン１</h1>

<p><code>C++</code>、<code>C#</code>のソースコードごとに<code>DLL</code>を作成、<code>D言語</code>のソースコードで<code>EXE</code>ファイルを作成するパターンです。</p>

<h2>
<span id="ソースコード" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>ソースコード</h2>

<p><code>C#</code>のソースコード<code>str.cs</code>を<code>D言語</code>から呼び出したいと仮定します。</p>

<div class="code-frame" data-lang="C#">
<div class="code-lang"><span class="bold">str.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MyLibrary</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">MyStringClass</span>
    <span class="p">{</span>
        <span class="k">unsafe</span> <span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="nf">ComplexCalc</span><span class="p">(</span><span class="n">Char</span> <span class="p">*</span><span class="n">c</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">String</span> <span class="n">s</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">String</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"{0} -&gt; {1:d}"</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="nf">GetHashCode</span><span class="p">());</span>
            <span class="k">return</span> <span class="p">(</span> <span class="n">s</span><span class="p">.</span><span class="nf">GetHashCode</span><span class="p">()</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p><code>C++</code>（<code>C++/CLI</code>）の<code>intermediate1.cpp</code>は、<code>D言語</code>からの呼び出しを中継する役割です。</p>

<div class="code-frame" data-lang="C++">
<div class="code-lang"><span class="bold">intermediate1.cpp</span></div>
<div class="highlight"><pre class="with-code"><code><span class="cp">#using &lt;str.dll&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">MyLibrary</span><span class="p">;</span>

<span class="cp">#define VC_DLL_EXPORTS extern "C" __declspec(dllexport)
</span>
<span class="n">VC_DLL_EXPORTS</span> <span class="kt">int</span> <span class="nf">callMyStringClass</span><span class="p">(</span><span class="kt">wchar_t</span> <span class="o">*</span><span class="n">wc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">MyStringClass</span><span class="o">::</span><span class="n">ComplexCalc</span><span class="p">(</span><span class="n">wc</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p><code>C#</code>の<code>Char</code>型が、<code>D</code>の<code>wchar</code>型に対応してします。<br>
<code>D</code>の<code>wstring</code>を変換して、<code>C#</code>に渡すように実装しました。</p>

<div class="code-frame" data-lang="D">
<div class="code-lang"><span class="bold">case1.d</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">conv</span><span class="p">;</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="k">pragma</span><span class="p">(</span><span class="n">lib</span><span class="p">,</span> <span class="s">"intermediate1.lib"</span><span class="p">);</span>

<span class="k">extern</span> <span class="p">(</span><span class="n">Windows</span><span class="p">)</span> <span class="k">nothrow</span> <span class="nd">@nogc</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="kt">wchar</span><span class="p">*</span> <span class="n">wc</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nb">wstring</span> <span class="n">ws</span> <span class="p">=</span> <span class="s">"Hello C#"</span><span class="p">;</span>
    <span class="n">writefln</span><span class="p">(</span><span class="s">"input  : %s"</span><span class="p">,</span> <span class="n">ws</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">res</span> <span class="p">=</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="n">ws</span><span class="p">.</span><span class="n">to</span><span class="p">!(</span><span class="kt">wchar</span><span class="p">[]).</span><span class="n">ptr</span><span class="p">);</span>
    <span class="n">writefln</span><span class="p">(</span><span class="s">"output : %d"</span><span class="p">,</span> <span class="n">res</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="コンパイル" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB"><i class="fa fa-link"></i></a>コンパイル</h2>

<p>コンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。<br>
コンパイルは、以下の順序で進めます。<br>
コンパイルの結果、<code>str.dll</code>、<code>intermediate1.dll</code>、<code>case1.exe</code>が作成されます。</p>

<table>
<thead>
<tr>
<th style="text-align: left">#</th>
<th style="text-align: left">説明</th>
<th style="text-align: left">コマンド</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">1</td>
<td style="text-align: left">C#からDLLを作成</td>
<td style="text-align: left">csc -unsafe -target:library str.cs</td>
</tr>
<tr>
<td style="text-align: left">2</td>
<td style="text-align: left">C++からDLLを作成</td>
<td style="text-align: left">cl /clr /LD intermediate1.cpp</td>
</tr>
<tr>
<td style="text-align: left">3</td>
<td style="text-align: left">DからEXEを作成</td>
<td style="text-align: left">dmd -m64 case1.d</td>
</tr>
</tbody>
</table>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">VS2019用_x64_Native_Tools_コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; where csc
C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\MSBuild\Current\Bin\Roslyn\csc.exe
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe

D:\Dev&gt; csc -unsafe -target:library str.cs
Microsoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)
Copyright (C) Microsoft Corporation. All rights reserved.

D:\Dev&gt; where cl
C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Tools\MSVC\14.24.28314\bin\Hostx64\x64\cl.exe

D:\Dev&gt; cl /clr /LD intermediate1.cpp
Microsoft(R) C/C++ Optimizing Compiler Version 19.24.28314
Microsoft (R) .NET Framework の場合 バージョン 4.08.4250.0
Copyright (C) Microsoft Corporation.  All rights reserved.

intermediate1.cpp
Microsoft (R) Incremental Linker Version 14.24.28314.0
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:intermediate1.dll
/dll
/implib:intermediate1.lib
intermediate1.obj
   ライブラリ intermediate1.lib とオブジェクト intermediate1.exp を作成中

D:\Dev&gt; dmd -m64 case1.d
</code></pre></div>
</div>

<h2>
<span id="実行結果" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C"><i class="fa fa-link"></i></a>実行結果</h2>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; case1
input  : Hello C#
Hello C# -&gt; 589585528
output : 589585528
</code></pre></div>
</div>

<h1>
<span id="パターン２" class="fragment"></span><a href="#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%92"><i class="fa fa-link"></i></a>パターン２</h1>

<p><code>C++</code>、<code>C#</code>のソースコードをあわせて１つの<code>DLL</code>、<code>D言語</code>のソースコードで<code>EXE</code>ファイルを作成するパターンです。</p>

<h2>
<span id="ソースコード-1" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-1"><i class="fa fa-link"></i></a>ソースコード</h2>

<p><code>C#</code>のソースコード<code>str.cs</code>は、パターン１と同じものを使用します。<br>
パターン１<code>C++</code>のソースコード１行目は<code>#using &lt;str.dll&gt;</code>でしたが、パターン２では<code>#using &lt;str.netmodule&gt;</code>とします。</p>

<div class="code-frame" data-lang="C++">
<div class="code-lang"><span class="bold">intermediate2.cpp</span></div>
<div class="highlight"><pre class="with-code"><code><span class="cp">#using &lt;str.netmodule&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">MyLibrary</span><span class="p">;</span>

<span class="cp">#define VC_DLL_EXPORTS extern "C" __declspec(dllexport)
</span>
<span class="n">VC_DLL_EXPORTS</span> <span class="kt">int</span> <span class="nf">callMyStringClass</span><span class="p">(</span><span class="kt">wchar_t</span> <span class="o">*</span><span class="n">wc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">MyStringClass</span><span class="o">::</span><span class="n">ComplexCalc</span><span class="p">(</span><span class="n">wc</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p><code>D言語</code>のソースコードは、パターン１と<code>pragma</code>行以外は同じです。</p>

<div class="code-frame" data-lang="D">
<div class="code-lang"><span class="bold">case2.d</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">conv</span><span class="p">;</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="k">pragma</span><span class="p">(</span><span class="n">lib</span><span class="p">,</span> <span class="s">"intermediate2.lib"</span><span class="p">);</span>

<span class="k">extern</span> <span class="p">(</span><span class="n">Windows</span><span class="p">)</span> <span class="k">nothrow</span> <span class="nd">@nogc</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="kt">wchar</span><span class="p">*</span> <span class="n">wc</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nb">wstring</span> <span class="n">ws</span> <span class="p">=</span> <span class="s">"Hello C#"</span><span class="p">;</span>
    <span class="n">writefln</span><span class="p">(</span><span class="s">"input  : %s"</span><span class="p">,</span> <span class="n">ws</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">res</span> <span class="p">=</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="n">ws</span><span class="p">.</span><span class="n">to</span><span class="p">!(</span><span class="kt">wchar</span><span class="p">[]).</span><span class="n">ptr</span><span class="p">);</span>
    <span class="n">writefln</span><span class="p">(</span><span class="s">"output : %d"</span><span class="p">,</span> <span class="n">res</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="コンパイル-1" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-1"><i class="fa fa-link"></i></a>コンパイル</h2>

<p>コンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。<br>
コンパイルは、以下の順序で進めます。<br>
コンパイルの結果、<code>intermediate2.dll</code>、<code>case2.exe</code>が作成されます。</p>

<table>
<thead>
<tr>
<th style="text-align: left">#</th>
<th style="text-align: left">説明</th>
<th style="text-align: left">コマンド</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">1</td>
<td style="text-align: left">C#からstr.netmoduleを作成</td>
<td style="text-align: left">csc -unsafe -target:module str.cs</td>
</tr>
<tr>
<td style="text-align: left">2</td>
<td style="text-align: left">C++とstr.netmoduleからDLLを作成</td>
<td style="text-align: left">cl /clr /LD intermediate2.cpp str.netmodule /link /LTCG</td>
</tr>
<tr>
<td style="text-align: left">3</td>
<td style="text-align: left">DからEXEを作成</td>
<td style="text-align: left">dmd -m64 case2.d</td>
</tr>
</tbody>
</table>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">VS2019用_x64_Native_Tools_コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev\&gt; csc -unsafe -target:module str.cs
Microsoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)
Copyright (C) Microsoft Corporation. All rights reserved.

D:\Dev&gt; cl /clr /LD intermediate2.cpp str.netmodule /link /LTCG
Microsoft(R) C/C++ Optimizing Compiler Version 19.24.28314
Microsoft (R) .NET Framework の場合 バージョン 4.08.4250.0
Copyright (C) Microsoft Corporation.  All rights reserved.

intermediate2.cpp
Microsoft (R) Incremental Linker Version 14.24.28314.0
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:intermediate2.dll
/dll
/implib:intermediate2.lib
/LTCG
intermediate2.obj
str.netmodule
   ライブラリ intermediate2.lib とオブジェクト intermediate2.exp を作成中
コード生成しています。
コード生成が終了しました。

D:\Dev&gt; dmd -m64 case2.d
</code></pre></div>
</div>

<h2>
<span id="実行結果-1" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-1"><i class="fa fa-link"></i></a>実行結果</h2>

<p>パターン１と同じ実行結果となりました。</p>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; case2
input  : Hello C#
Hello C# -&gt; 589585528
output : 589585528
</code></pre></div>
</div>

<h1>
<span id="パターン３" class="fragment"></span><a href="#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%93"><i class="fa fa-link"></i></a>パターン３</h1>

<p><code>C#</code>のソースコードで<code>DLL</code>、<code>C++</code>、<code>D言語</code>のソースコードをあわせて<code>EXE</code>ファイルを作成するパターンです。</p>

<h2>
<span id="ソースコード-2" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-2"><i class="fa fa-link"></i></a>ソースコード</h2>

<p><code>C#</code>のソースコード<code>str.cs</code>は、パターン１と同じものを使用します。<br>
<code>C++</code>の<code>callMyStringClass</code>関数は、<code>VC_DLL_EXPORTS</code>から<code>extern "C"</code>になっています。</p>

<div class="code-frame" data-lang="C++">
<div class="code-lang"><span class="bold">intermediate3.cpp</span></div>
<div class="highlight"><pre class="with-code"><code><span class="cp">#using &lt;str.dll&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">MyLibrary</span><span class="p">;</span>

<span class="k">extern</span> <span class="s">"C"</span> <span class="kt">int</span> <span class="nf">callMyStringClass</span><span class="p">(</span><span class="kt">wchar_t</span> <span class="o">*</span><span class="n">wc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">MyStringClass</span><span class="o">::</span><span class="n">ComplexCalc</span><span class="p">(</span><span class="n">wc</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p><code>D</code>のソースコードは<code>pragma</code>行から、<code>extern (C)</code>ブロックで関数宣言しています。</p>

<div class="code-frame" data-lang="D">
<div class="code-lang"><span class="bold">case3.d</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">conv</span><span class="p">;</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="k">extern</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="kt">wchar</span><span class="p">*</span> <span class="n">wc</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nb">wstring</span> <span class="n">ws</span> <span class="p">=</span> <span class="s">"Hello C#"</span><span class="p">;</span>
    <span class="n">writefln</span><span class="p">(</span><span class="s">"input  : %s"</span><span class="p">,</span> <span class="n">ws</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">res</span> <span class="p">=</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="n">ws</span><span class="p">.</span><span class="n">to</span><span class="p">!(</span><span class="kt">wchar</span><span class="p">[]).</span><span class="n">ptr</span><span class="p">);</span>
    <span class="n">writefln</span><span class="p">(</span><span class="s">"output : %d"</span><span class="p">,</span> <span class="n">res</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="コンパイル-2" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-2"><i class="fa fa-link"></i></a>コンパイル</h2>

<p>コンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。<br>
コンパイルは、以下の順序で進めます。<br>
コンパイルの結果、<code>str.dll</code>、<code>case3.exe</code>が作成されます。</p>

<p><code>mscoree.dll</code>は、<code>C++/CLI</code>から<code>.NET</code>ランタイムを呼び出すための<code>DLL</code>で、<code>mscoree.lib</code>はそのライブラリです。<br>
<code>D言語</code>と<code>C++</code>との<code>ABI互換</code>により、<code>mscoree.lib</code>をそのまま使用できました。</p>

<table>
<thead>
<tr>
<th style="text-align: left">#</th>
<th style="text-align: left">説明</th>
<th style="text-align: left">コマンド</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">1</td>
<td style="text-align: left">C#からDLLを作成</td>
<td style="text-align: left">csc -unsafe -target:library str.cs</td>
</tr>
<tr>
<td style="text-align: left">2</td>
<td style="text-align: left">C++からobjファイルを作成</td>
<td style="text-align: left">cl /clr /c intermediate3.cpp</td>
</tr>
<tr>
<td style="text-align: left">3</td>
<td style="text-align: left">DとobjファイルからEXEを作成</td>
<td style="text-align: left">dmd -m64 -L=/NODEFAULTLIB:libcmt.lib case3.d intermediate3.obj "C:\Program Files (x86)\Windows Kits\NETFXSDK\4.8\Lib\um\x64\mscoree.lib"</td>
</tr>
</tbody>
</table>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">VS2019用_x64_Native_Tools_コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; csc -unsafe -target:library str.cs
Microsoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)
Copyright (C) Microsoft Corporation. All rights reserved.

D:\Dev&gt; cl /clr /c intermediate3.cpp
Microsoft(R) C/C++ Optimizing Compiler Version 19.24.28314
Microsoft (R) .NET Framework の場合 バージョン 4.08.4250.0
Copyright (C) Microsoft Corporation.  All rights reserved.

intermediate3.cpp

D:\Dev&gt; dmd -m64 -L=/NODEFAULTLIB:libcmt.lib case3.d intermediate3.obj "C:\Program Files (x86)\Windows Kits\NETFXSDK\4.8\Lib\um\x64\mscoree.lib"
</code></pre></div>
</div>

<h3>
<span id="dmdでのコンパイル時の注意事項" class="fragment"></span><a href="#dmd%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB%E6%99%82%E3%81%AE%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85"><i class="fa fa-link"></i></a><code>DMD</code>でのコンパイル時の注意事項</h3>

<p><code>DMD</code>でのコンパイル時の注意事項として、<code>-L=/NODEFAULTLIB:libcmt.lib</code>オプションの指定と<code>mscoree.lib</code>の指定が必要です。</p>

<p><code>-L=/NODEFAULTLIB:libcmt.lib</code>オプションを指定しない場合、<code>warning</code>メッセージと共に<code>EXE</code>ファイルは生成されますが、実行時エラーが発生しました。</p>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">失敗例１</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; dmd -m64 case3.d intermediate3.obj "C:\Program Files (x86)\Windows Kits\NETFXSDK\4.8\Lib\um\x64\mscoree.lib"
LINK : warning LNK4098: defaultlib 'MSVCRT' は他のライブラリの使用と競合しています。/NODEFAULTLIB:library を使用してください。

D:\Dev&gt; case3
ハンドルされていない例外: System.TypeInitializationException: '&lt;Module&gt;' のタイプ初期化子が例外をスローしました。 ---&gt; System.AccessViolationException: 保護されているメモリに読み取りまたは書き込み操作を行おうとしました。他のメモリが壊れていることが考えられます。
   場所 _initterm_e((fnptr)* pfbegin, (fnptr)* pfend)
   場所 &lt;CrtImplementationDetails&gt;.LanguageSupport.InitializeNative(LanguageSupport* )
   場所 &lt;CrtImplementationDetails&gt;.LanguageSupport._Initialize(LanguageSupport* )
   場所 &lt;CrtImplementationDetails&gt;.LanguageSupport.Initialize(LanguageSupport* )
   場所 .cctor()
   --- 内部例外スタック トレースの終わり ---
</code></pre></div>
</div>

<p>また、<code>mscoree.lib</code>を指定しない場合、リンク時エラーとなります。</p>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">失敗例２</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; dmd -m64 -L=/NODEFAULTLIB:libcmt.lib case3.d intermediate3.obj
LINK : fatal error LNK1104: ファイル 'MSCOREE.lib' を開くことができません。
Error: linker exited with status 1104
</code></pre></div>
</div>

<h2>
<span id="実行結果-2" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-2"><i class="fa fa-link"></i></a>実行結果</h2>

<p>パターン１と同じ実行結果となりました。</p>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; case3
input  : Hello C#
Hello C# -&gt; 589585528
output : 589585528
</code></pre></div>
</div>

<h1>
<span id="パターン４" class="fragment"></span><a href="#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%94"><i class="fa fa-link"></i></a>パターン４</h1>

<p><code>D</code>、<code>C++</code>、<code>C#</code>のソースをあわせて、１つの<code>EXE</code>ファイルを作成するパターンです。</p>

<h2>
<span id="ソースコード-3" class="fragment"></span><a href="#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-3"><i class="fa fa-link"></i></a>ソースコード</h2>

<p><code>C#</code>のソースコード<code>str.cs</code>は、パターン１と同じものを使用します。<br>
<code>C++</code>のソースコードは、パターン２と同じく<code>#using &lt;str.netmodule&gt;</code>とします。</p>

<div class="code-frame" data-lang="C++">
<div class="code-lang"><span class="bold">intermediate4.cpp</span></div>
<div class="highlight"><pre class="with-code"><code><span class="cp">#using &lt;str.netmodule&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">System</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">MyLibrary</span><span class="p">;</span>

<span class="k">extern</span> <span class="s">"C"</span> <span class="kt">int</span> <span class="nf">callMyStringClass</span><span class="p">(</span><span class="kt">wchar_t</span> <span class="o">*</span><span class="n">wc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">MyStringClass</span><span class="o">::</span><span class="n">ComplexCalc</span><span class="p">(</span><span class="n">wc</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>パターン４では、<code>C++</code>コンパイラで<code>EXE</code>ファイルを作成するため、<code>Phobos</code>ライブラリではなく<code>C</code>標準ライブラリを使用するようコーディングしています。</p>

<div class="code-frame" data-lang="D">
<div class="code-lang"><span class="bold">case4.d</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">extern</span> <span class="p">(</span><span class="n">C</span><span class="p">):</span>
<span class="kt">int</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="kt">wchar</span><span class="p">*</span> <span class="n">wc</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">printf</span><span class="p">(</span><span class="k">immutable</span><span class="p">(</span><span class="kt">char</span><span class="p">)*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">wchar</span><span class="p">[]</span> <span class="n">wc</span> <span class="p">=</span> <span class="k">cast</span><span class="p">(</span><span class="kt">wchar</span><span class="p">[])</span><span class="s">"Hello C#"w</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"input  : %ls\n"</span><span class="p">.</span><span class="n">ptr</span><span class="p">,</span> <span class="n">wc</span><span class="p">.</span><span class="n">ptr</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">res</span> <span class="p">=</span> <span class="n">callMyStringClass</span><span class="p">(</span><span class="n">wc</span><span class="p">.</span><span class="n">ptr</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"output : %d\n"</span><span class="p">.</span><span class="n">ptr</span><span class="p">,</span> <span class="n">res</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h2>
<span id="コンパイル-3" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-3"><i class="fa fa-link"></i></a>コンパイル</h2>

<p>コンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。<br>
コンパイルは、以下の順序で進めます。<br>
コンパイルの結果、<code>case4.exe</code>が作成されます。</p>

<p><code>D</code>コンパイラで<code>str.netmodule</code>を処理できなかったため、<code>C++</code>コンパイラで<code>EXE</code>ファイルを作成する方法をとりました。<br>
<code>D言語</code>から<code>C</code>の<code>printf</code>関数を使用する場合の注意事項として、<code>legacy_stdio_definitions.lib</code>を指定する必要があります。<br>
Visual Studio 2015以降、<code>printf</code>、<code>scanf</code>系の関数が<code>inline</code>化されていて、回避手段として<code>legacy_stdio_definitions.lib</code>が提供されています。<a href="https://docs.microsoft.com/en-us/cpp/porting/visual-cpp-change-history-2003-2015?redirectedfrom=MSDN&amp;view=msvc-160#stdio_and_conio" rel="nofollow noopener" target="_blank">参照情報(英語)</a></p>

<table>
<thead>
<tr>
<th style="text-align: left">#</th>
<th style="text-align: left">説明</th>
<th style="text-align: left">コマンド</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">1</td>
<td style="text-align: left">C#からstr.netmoduleを作成</td>
<td style="text-align: left">csc -unsafe -target:module str.cs</td>
</tr>
<tr>
<td style="text-align: left">2</td>
<td style="text-align: left">Dからobjファイルを作成</td>
<td style="text-align: left">dmd -m64 -c case4.d</td>
</tr>
<tr>
<td style="text-align: left">3</td>
<td style="text-align: left">C++とobjファイルとstr.netmoduleからEXEを作成</td>
<td style="text-align: left">cl /clr /Fe:case4.exe intermediate4.cpp str.netmodule case4.obj legacy_stdio_definitions.lib /link /NODEFAULTLIB:libcmt.lib /LTCG</td>
</tr>
</tbody>
</table>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">VS2019用_x64_Native_Tools_コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; csc -unsafe -target:module str.cs
Microsoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)
Copyright (C) Microsoft Corporation. All rights reserved.

D:\Dev&gt; dmd -m64 -c case4.d

D:\Dev&gt; cl /clr /Fe:case4.exe intermediate4.cpp str.netmodule case4.obj legacy_stdio_definitions.lib /link /NODEFAULTLIB:libcmt.lib /LTCG
Microsoft(R) C/C++ Optimizing Compiler Version 19.24.28314
Microsoft (R) .NET Framework の場合 バージョン 4.08.4250.0
Copyright (C) Microsoft Corporation.  All rights reserved.

intermediate4.cpp
Microsoft (R) Incremental Linker Version 14.24.28314.0
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:case4.exe
/NODEFAULTLIB:libcmt.lib
/LTCG
intermediate4.obj
str.netmodule
case4.obj
legacy_stdio_definitions.lib
コード生成しています。
コード生成が終了しました。
</code></pre></div>
</div>

<h2>
<span id="実行結果-3" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-3"><i class="fa fa-link"></i></a>実行結果</h2>

<p>パターン１と同じ実行結果となりました。</p>

<div class="code-frame" data-lang="text">
<div class="code-lang"><span class="bold">コマンドプロンプト</span></div>
<div class="highlight"><pre class="with-code"><code>D:\Dev&gt; case4
input  : Hello C#
Hello C# -&gt; 589585528
output : 589585528
</code></pre></div>
</div>

<h1>
<span id="私見感想" class="fragment"></span><a href="#%E7%A7%81%E8%A6%8B%E6%84%9F%E6%83%B3"><i class="fa fa-link"></i></a>私見、感想</h1>

<p>４つのパターンを実装してみた結果、パターン３が私のお気に入りです。<br>
パターン３であれば、<code>C#</code>のソースコートが手元になく、<code>DLL</code>のみの提供であっても対応できます。</p>

<p>パターン４は、１つのEXEファイルにまとめられるというアイデアは面白いと思いました。<br>
ただ、<code>D言語</code>を使う上で<code>Phobos</code>ライブラリが使えない等の制約があるため、私にとっては実用的ではないと思いました。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fdevmynote%2Fitems%2Fb52c13f0d3437de786cb&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fdevmynote%2Fitems%2Fb52c13f0d3437de786cb&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/devmynote/items/b52c13f0d3437de786cb/likers" class="css-1iupg5d">1</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">0</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/b52c13f0d3437de786cb/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/devmynote/items/b52c13f0d3437de786cb/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/devmynote/items/b52c13f0d3437de786cb/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/devmynote/items/b52c13f0d3437de786cb/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/devmynote/items/b52c13f0d3437de786cb.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-da21ec35-10bf-4347-b7fc-f7982e920d31">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-ed79f4e4-3ad8-4384-911c-1c0800288bf6"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-ed79f4e4-3ad8-4384-911c-1c0800288bf6">{}</script>
      
<div id="LoginModal-react-component-e247dbeb-635e-408c-a05c-d838befd059b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-e247dbeb-635e-408c-a05c-d838befd059b">{}</script>
      
<div id="StockModal-react-component-3262a199-552f-45cb-a977-b025784e0165"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-3262a199-552f-45cb-a977-b025784e0165">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;lZdQu2GvfIW3EvQDuluNPXdSgVPRr5eKo+FFhujzsfP8l7sKtPcbdPSYJQI9Q4eBrOSFHoTeVN5Q50jyebetqw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eD言語\u003c/code\u003eから、\u003ccode\u003eC#\u003c/code\u003eのソースコードやライブラリを利用したい場合について、その利用方法を考えてみました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"d言語とcとの連携方式\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#d%E8%A8%80%E8%AA%9E%E3%81%A8c%E3%81%A8%E3%81%AE%E9%80%A3%E6%90%BA%E6%96%B9%E5%BC%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eD言語とC#との連携方式\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eD言語\u003c/code\u003eから\u003ccode\u003eC#\u003c/code\u003eの関数を呼び出す際、\u003ccode\u003eC++\u003c/code\u003e（\u003ccode\u003eC++/CLI\u003c/code\u003e）を経由するのが簡単だと思っています。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/devmynote/items/015483085e1d6e1a209b\" id=\"reference-d83f5bf5c3a4ba6b603e\"\u003e以前の記事\u003c/a\u003eでも、１つの実装例を紹介しましたが、他にも連携方式を考えてみましたので、ここにまとめます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eEXE\u003c/code\u003eファイルや\u003ccode\u003eDLL\u003c/code\u003eファイルの作成方法で、４つのパターンに分類しました。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e#\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e説明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eパターン１\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC++、C#のソースごとにDLLを作成する。DのソースでEXEファイルを作成する。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eパターン２\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC++、C#のソースをあわせて１つのDLLを作成する。DのソースでEXEファイルを作成する。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eパターン３\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC#のソースでDLL、C++、DのソースをあわせてEXEファイルを作成する。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eパターン４\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eD、C++、C#のソースをあわせて、１つのEXEファイルを作成する。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e環境\u003c/h1\u003e\n\n\u003cp\u003e以下のソースコードは、以下の環境でコンパイルしています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows 10\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://visualstudio.microsoft.com/ja/downloads/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVisual C++ ビルドツール 2019\u003c/a\u003e　→　\u003ca href=\"https://www.kkaneko.jp/tools/win/buildtool.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eインストール手順\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://dlang.org/download.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eDMD\u003c/a\u003e v2.094.2\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"パターン１\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%91\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパターン１\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eC++\u003c/code\u003e、\u003ccode\u003eC#\u003c/code\u003eのソースコードごとに\u003ccode\u003eDLL\u003c/code\u003eを作成、\u003ccode\u003eD言語\u003c/code\u003eのソースコードで\u003ccode\u003eEXE\u003c/code\u003eファイルを作成するパターンです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ソースコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースコード\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eC#\u003c/code\u003eのソースコード\u003ccode\u003estr.cs\u003c/code\u003eを\u003ccode\u003eD言語\u003c/code\u003eから呼び出したいと仮定します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003estr.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eMyLibrary\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyStringClass\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003eComplexCalc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eChar\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{0} -\u0026gt; {1:d}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetHashCode\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetHashCode\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eC++\u003c/code\u003e（\u003ccode\u003eC++/CLI\u003c/code\u003e）の\u003ccode\u003eintermediate1.cpp\u003c/code\u003eは、\u003ccode\u003eD言語\u003c/code\u003eからの呼び出しを中継する役割です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C++\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eintermediate1.cpp\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e#using \u0026lt;str.dll\u0026gt;\n\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eMyLibrary\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"cp\"\u003e#define VC_DLL_EXPORTS extern \"C\" __declspec(dllexport)\n\u003c/span\u003e\n\u003cspan class=\"n\"\u003eVC_DLL_EXPORTS\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar_t\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eMyStringClass\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eComplexCalc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eC#\u003c/code\u003eの\u003ccode\u003eChar\u003c/code\u003e型が、\u003ccode\u003eD\u003c/code\u003eの\u003ccode\u003ewchar\u003c/code\u003e型に対応してします。\u003cbr\u003e\n\u003ccode\u003eD\u003c/code\u003eの\u003ccode\u003ewstring\u003c/code\u003eを変換して、\u003ccode\u003eC#\u003c/code\u003eに渡すように実装しました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"D\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecase1.d\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econv\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estdio\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epragma\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elib\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"intermediate1.lib\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eextern\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003enothrow\u003c/span\u003e \u003cspan class=\"nd\"\u003e@nogc\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003ewstring\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Hello C#\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewritefln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input  : %s\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eto\u003c/span\u003e\u003cspan class=\"p\"\u003e!(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e[]).\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewritefln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"output : %d\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コンパイル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンパイル\u003c/h2\u003e\n\n\u003cp\u003eコンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。\u003cbr\u003e\nコンパイルは、以下の順序で進めます。\u003cbr\u003e\nコンパイルの結果、\u003ccode\u003estr.dll\u003c/code\u003e、\u003ccode\u003eintermediate1.dll\u003c/code\u003e、\u003ccode\u003ecase1.exe\u003c/code\u003eが作成されます。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e#\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e説明\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003eコマンド\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC#からDLLを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecsc -unsafe -target:library str.cs\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC++からDLLを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecl /clr /LD intermediate1.cpp\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eDからEXEを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003edmd -m64 case1.d\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVS2019用_x64_Native_Tools_コマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; where csc\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\MSBuild\\Current\\Bin\\Roslyn\\csc.exe\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe\n\nD:\\Dev\u0026gt; csc -unsafe -target:library str.cs\nMicrosoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nD:\\Dev\u0026gt; where cl\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.24.28314\\bin\\Hostx64\\x64\\cl.exe\n\nD:\\Dev\u0026gt; cl /clr /LD intermediate1.cpp\nMicrosoft(R) C/C++ Optimizing Compiler Version 19.24.28314\nMicrosoft (R) .NET Framework の場合 バージョン 4.08.4250.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\nintermediate1.cpp\nMicrosoft (R) Incremental Linker Version 14.24.28314.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n/out:intermediate1.dll\n/dll\n/implib:intermediate1.lib\nintermediate1.obj\n   ライブラリ intermediate1.lib とオブジェクト intermediate1.exp を作成中\n\nD:\\Dev\u0026gt; dmd -m64 case1.d\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"実行結果\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行結果\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eコマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; case1\ninput  : Hello C#\nHello C# -\u0026gt; 589585528\noutput : 589585528\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"パターン２\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパターン２\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eC++\u003c/code\u003e、\u003ccode\u003eC#\u003c/code\u003eのソースコードをあわせて１つの\u003ccode\u003eDLL\u003c/code\u003e、\u003ccode\u003eD言語\u003c/code\u003eのソースコードで\u003ccode\u003eEXE\u003c/code\u003eファイルを作成するパターンです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ソースコード-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースコード\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eC#\u003c/code\u003eのソースコード\u003ccode\u003estr.cs\u003c/code\u003eは、パターン１と同じものを使用します。\u003cbr\u003e\nパターン１\u003ccode\u003eC++\u003c/code\u003eのソースコード１行目は\u003ccode\u003e#using \u0026lt;str.dll\u0026gt;\u003c/code\u003eでしたが、パターン２では\u003ccode\u003e#using \u0026lt;str.netmodule\u0026gt;\u003c/code\u003eとします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C++\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eintermediate2.cpp\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e#using \u0026lt;str.netmodule\u0026gt;\n\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eMyLibrary\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"cp\"\u003e#define VC_DLL_EXPORTS extern \"C\" __declspec(dllexport)\n\u003c/span\u003e\n\u003cspan class=\"n\"\u003eVC_DLL_EXPORTS\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar_t\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eMyStringClass\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eComplexCalc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eD言語\u003c/code\u003eのソースコードは、パターン１と\u003ccode\u003epragma\u003c/code\u003e行以外は同じです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"D\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecase2.d\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econv\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estdio\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epragma\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elib\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"intermediate2.lib\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eextern\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003enothrow\u003c/span\u003e \u003cspan class=\"nd\"\u003e@nogc\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003ewstring\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Hello C#\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewritefln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input  : %s\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eto\u003c/span\u003e\u003cspan class=\"p\"\u003e!(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e[]).\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewritefln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"output : %d\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コンパイル-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンパイル\u003c/h2\u003e\n\n\u003cp\u003eコンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。\u003cbr\u003e\nコンパイルは、以下の順序で進めます。\u003cbr\u003e\nコンパイルの結果、\u003ccode\u003eintermediate2.dll\u003c/code\u003e、\u003ccode\u003ecase2.exe\u003c/code\u003eが作成されます。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e#\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e説明\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003eコマンド\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC#からstr.netmoduleを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecsc -unsafe -target:module str.cs\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC++とstr.netmoduleからDLLを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecl /clr /LD intermediate2.cpp str.netmodule /link /LTCG\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eDからEXEを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003edmd -m64 case2.d\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVS2019用_x64_Native_Tools_コマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\\\u0026gt; csc -unsafe -target:module str.cs\nMicrosoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nD:\\Dev\u0026gt; cl /clr /LD intermediate2.cpp str.netmodule /link /LTCG\nMicrosoft(R) C/C++ Optimizing Compiler Version 19.24.28314\nMicrosoft (R) .NET Framework の場合 バージョン 4.08.4250.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\nintermediate2.cpp\nMicrosoft (R) Incremental Linker Version 14.24.28314.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n/out:intermediate2.dll\n/dll\n/implib:intermediate2.lib\n/LTCG\nintermediate2.obj\nstr.netmodule\n   ライブラリ intermediate2.lib とオブジェクト intermediate2.exp を作成中\nコード生成しています。\nコード生成が終了しました。\n\nD:\\Dev\u0026gt; dmd -m64 case2.d\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"実行結果-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行結果\u003c/h2\u003e\n\n\u003cp\u003eパターン１と同じ実行結果となりました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eコマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; case2\ninput  : Hello C#\nHello C# -\u0026gt; 589585528\noutput : 589585528\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"パターン３\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパターン３\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eC#\u003c/code\u003eのソースコードで\u003ccode\u003eDLL\u003c/code\u003e、\u003ccode\u003eC++\u003c/code\u003e、\u003ccode\u003eD言語\u003c/code\u003eのソースコードをあわせて\u003ccode\u003eEXE\u003c/code\u003eファイルを作成するパターンです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ソースコード-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースコード\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eC#\u003c/code\u003eのソースコード\u003ccode\u003estr.cs\u003c/code\u003eは、パターン１と同じものを使用します。\u003cbr\u003e\n\u003ccode\u003eC++\u003c/code\u003eの\u003ccode\u003ecallMyStringClass\u003c/code\u003e関数は、\u003ccode\u003eVC_DLL_EXPORTS\u003c/code\u003eから\u003ccode\u003eextern \"C\"\u003c/code\u003eになっています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C++\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eintermediate3.cpp\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e#using \u0026lt;str.dll\u0026gt;\n\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eMyLibrary\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eextern\u003c/span\u003e \u003cspan class=\"s\"\u003e\"C\"\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar_t\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eMyStringClass\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eComplexCalc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eD\u003c/code\u003eのソースコードは\u003ccode\u003epragma\u003c/code\u003e行から、\u003ccode\u003eextern (C)\u003c/code\u003eブロックで関数宣言しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"D\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecase3.d\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econv\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estdio\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eextern\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eC\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003ewstring\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Hello C#\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewritefln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input  : %s\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eto\u003c/span\u003e\u003cspan class=\"p\"\u003e!(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e[]).\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewritefln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"output : %d\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コンパイル-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンパイル\u003c/h2\u003e\n\n\u003cp\u003eコンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。\u003cbr\u003e\nコンパイルは、以下の順序で進めます。\u003cbr\u003e\nコンパイルの結果、\u003ccode\u003estr.dll\u003c/code\u003e、\u003ccode\u003ecase3.exe\u003c/code\u003eが作成されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003emscoree.dll\u003c/code\u003eは、\u003ccode\u003eC++/CLI\u003c/code\u003eから\u003ccode\u003e.NET\u003c/code\u003eランタイムを呼び出すための\u003ccode\u003eDLL\u003c/code\u003eで、\u003ccode\u003emscoree.lib\u003c/code\u003eはそのライブラリです。\u003cbr\u003e\n\u003ccode\u003eD言語\u003c/code\u003eと\u003ccode\u003eC++\u003c/code\u003eとの\u003ccode\u003eABI互換\u003c/code\u003eにより、\u003ccode\u003emscoree.lib\u003c/code\u003eをそのまま使用できました。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e#\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e説明\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003eコマンド\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC#からDLLを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecsc -unsafe -target:library str.cs\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC++からobjファイルを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecl /clr /c intermediate3.cpp\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eDとobjファイルからEXEを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003edmd -m64 -L=/NODEFAULTLIB:libcmt.lib case3.d intermediate3.obj \"C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.8\\Lib\\um\\x64\\mscoree.lib\"\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVS2019用_x64_Native_Tools_コマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; csc -unsafe -target:library str.cs\nMicrosoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nD:\\Dev\u0026gt; cl /clr /c intermediate3.cpp\nMicrosoft(R) C/C++ Optimizing Compiler Version 19.24.28314\nMicrosoft (R) .NET Framework の場合 バージョン 4.08.4250.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\nintermediate3.cpp\n\nD:\\Dev\u0026gt; dmd -m64 -L=/NODEFAULTLIB:libcmt.lib case3.d intermediate3.obj \"C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.8\\Lib\\um\\x64\\mscoree.lib\"\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"dmdでのコンパイル時の注意事項\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#dmd%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB%E6%99%82%E3%81%AE%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eDMD\u003c/code\u003eでのコンパイル時の注意事項\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eDMD\u003c/code\u003eでのコンパイル時の注意事項として、\u003ccode\u003e-L=/NODEFAULTLIB:libcmt.lib\u003c/code\u003eオプションの指定と\u003ccode\u003emscoree.lib\u003c/code\u003eの指定が必要です。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e-L=/NODEFAULTLIB:libcmt.lib\u003c/code\u003eオプションを指定しない場合、\u003ccode\u003ewarning\u003c/code\u003eメッセージと共に\u003ccode\u003eEXE\u003c/code\u003eファイルは生成されますが、実行時エラーが発生しました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e失敗例１\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; dmd -m64 case3.d intermediate3.obj \"C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.8\\Lib\\um\\x64\\mscoree.lib\"\nLINK : warning LNK4098: defaultlib 'MSVCRT' は他のライブラリの使用と競合しています。/NODEFAULTLIB:library を使用してください。\n\nD:\\Dev\u0026gt; case3\nハンドルされていない例外: System.TypeInitializationException: '\u0026lt;Module\u0026gt;' のタイプ初期化子が例外をスローしました。 ---\u0026gt; System.AccessViolationException: 保護されているメモリに読み取りまたは書き込み操作を行おうとしました。他のメモリが壊れていることが考えられます。\n   場所 _initterm_e((fnptr)* pfbegin, (fnptr)* pfend)\n   場所 \u0026lt;CrtImplementationDetails\u0026gt;.LanguageSupport.InitializeNative(LanguageSupport* )\n   場所 \u0026lt;CrtImplementationDetails\u0026gt;.LanguageSupport._Initialize(LanguageSupport* )\n   場所 \u0026lt;CrtImplementationDetails\u0026gt;.LanguageSupport.Initialize(LanguageSupport* )\n   場所 .cctor()\n   --- 内部例外スタック トレースの終わり ---\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eまた、\u003ccode\u003emscoree.lib\u003c/code\u003eを指定しない場合、リンク時エラーとなります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e失敗例２\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; dmd -m64 -L=/NODEFAULTLIB:libcmt.lib case3.d intermediate3.obj\nLINK : fatal error LNK1104: ファイル 'MSCOREE.lib' を開くことができません。\nError: linker exited with status 1104\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"実行結果-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行結果\u003c/h2\u003e\n\n\u003cp\u003eパターン１と同じ実行結果となりました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eコマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; case3\ninput  : Hello C#\nHello C# -\u0026gt; 589585528\noutput : 589585528\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"パターン４\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%94\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパターン４\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eD\u003c/code\u003e、\u003ccode\u003eC++\u003c/code\u003e、\u003ccode\u003eC#\u003c/code\u003eのソースをあわせて、１つの\u003ccode\u003eEXE\u003c/code\u003eファイルを作成するパターンです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ソースコード-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eソースコード\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eC#\u003c/code\u003eのソースコード\u003ccode\u003estr.cs\u003c/code\u003eは、パターン１と同じものを使用します。\u003cbr\u003e\n\u003ccode\u003eC++\u003c/code\u003eのソースコードは、パターン２と同じく\u003ccode\u003e#using \u0026lt;str.netmodule\u0026gt;\u003c/code\u003eとします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"C++\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eintermediate4.cpp\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e#using \u0026lt;str.netmodule\u0026gt;\n\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"n\"\u003eMyLibrary\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eextern\u003c/span\u003e \u003cspan class=\"s\"\u003e\"C\"\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar_t\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eMyStringClass\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eComplexCalc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eパターン４では、\u003ccode\u003eC++\u003c/code\u003eコンパイラで\u003ccode\u003eEXE\u003c/code\u003eファイルを作成するため、\u003ccode\u003ePhobos\u003c/code\u003eライブラリではなく\u003ccode\u003eC\u003c/code\u003e標準ライブラリを使用するようコーディングしています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"D\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecase4.d\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eextern\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eC\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eimmutable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e)*\u003c/span\u003e \u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e...);\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ecast\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ewchar\u003c/span\u003e\u003cspan class=\"p\"\u003e[])\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Hello C#\"w\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input  : %ls\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecallMyStringClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"output : %d\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コンパイル-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンパイル\u003c/h2\u003e\n\n\u003cp\u003eコンパイルは「VS2019用 x64 Native Tools コマンドプロンプト」から実行します。\u003cbr\u003e\nコンパイルは、以下の順序で進めます。\u003cbr\u003e\nコンパイルの結果、\u003ccode\u003ecase4.exe\u003c/code\u003eが作成されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eD\u003c/code\u003eコンパイラで\u003ccode\u003estr.netmodule\u003c/code\u003eを処理できなかったため、\u003ccode\u003eC++\u003c/code\u003eコンパイラで\u003ccode\u003eEXE\u003c/code\u003eファイルを作成する方法をとりました。\u003cbr\u003e\n\u003ccode\u003eD言語\u003c/code\u003eから\u003ccode\u003eC\u003c/code\u003eの\u003ccode\u003eprintf\u003c/code\u003e関数を使用する場合の注意事項として、\u003ccode\u003elegacy_stdio_definitions.lib\u003c/code\u003eを指定する必要があります。\u003cbr\u003e\nVisual Studio 2015以降、\u003ccode\u003eprintf\u003c/code\u003e、\u003ccode\u003escanf\u003c/code\u003e系の関数が\u003ccode\u003einline\u003c/code\u003e化されていて、回避手段として\u003ccode\u003elegacy_stdio_definitions.lib\u003c/code\u003eが提供されています。\u003ca href=\"https://docs.microsoft.com/en-us/cpp/porting/visual-cpp-change-history-2003-2015?redirectedfrom=MSDN\u0026amp;view=msvc-160#stdio_and_conio\" rel=\"nofollow noopener\" target=\"_blank\"\u003e参照情報(英語)\u003c/a\u003e\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e#\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e説明\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003eコマンド\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC#からstr.netmoduleを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecsc -unsafe -target:module str.cs\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eDからobjファイルを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003edmd -m64 -c case4.d\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eC++とobjファイルとstr.netmoduleからEXEを作成\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecl /clr /Fe:case4.exe intermediate4.cpp str.netmodule case4.obj legacy_stdio_definitions.lib /link /NODEFAULTLIB:libcmt.lib /LTCG\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVS2019用_x64_Native_Tools_コマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; csc -unsafe -target:module str.cs\nMicrosoft (R) Visual C# Compiler バージョン 3.4.1-beta4-19610-02 (c4e5d138)\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nD:\\Dev\u0026gt; dmd -m64 -c case4.d\n\nD:\\Dev\u0026gt; cl /clr /Fe:case4.exe intermediate4.cpp str.netmodule case4.obj legacy_stdio_definitions.lib /link /NODEFAULTLIB:libcmt.lib /LTCG\nMicrosoft(R) C/C++ Optimizing Compiler Version 19.24.28314\nMicrosoft (R) .NET Framework の場合 バージョン 4.08.4250.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\nintermediate4.cpp\nMicrosoft (R) Incremental Linker Version 14.24.28314.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n/out:case4.exe\n/NODEFAULTLIB:libcmt.lib\n/LTCG\nintermediate4.obj\nstr.netmodule\ncase4.obj\nlegacy_stdio_definitions.lib\nコード生成しています。\nコード生成が終了しました。\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"実行結果-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行結果\u003c/h2\u003e\n\n\u003cp\u003eパターン１と同じ実行結果となりました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eコマンドプロンプト\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eD:\\Dev\u0026gt; case4\ninput  : Hello C#\nHello C# -\u0026gt; 589585528\noutput : 589585528\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"私見感想\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%A7%81%E8%A6%8B%E6%84%9F%E6%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e私見、感想\u003c/h1\u003e\n\n\u003cp\u003e４つのパターンを実装してみた結果、パターン３が私のお気に入りです。\u003cbr\u003e\nパターン３であれば、\u003ccode\u003eC#\u003c/code\u003eのソースコートが手元になく、\u003ccode\u003eDLL\u003c/code\u003eのみの提供であっても対応できます。\u003c/p\u003e\n\n\u003cp\u003eパターン４は、１つのEXEファイルにまとめられるというアイデアは面白いと思いました。\u003cbr\u003e\nただ、\u003ccode\u003eD言語\u003c/code\u003eを使う上で\u003ccode\u003ePhobos\u003c/code\u003eライブラリが使えない等の制約があるため、私にとっては実用的ではないと思いました。\u003c/p\u003e\n","createdAt":"2021-01-02T05:07:09Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"EQiejAe5825LvN03Vc2v54kKQk7d4980Kg==--xONN7Dsju5Gz+xsp--Z+NDkVx+3ctBKWAOeUgoBQ==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2021-01-02T05:07:09Z","likesCount":1,"linkUrl":"https://qiita.com/devmynote/items/b52c13f0d3437de786cb","organization":null,"originalId":1371206,"stockedCount":0,"title":"D言語 → C++ → C#の連携方式","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#d%E8%A8%80%E8%AA%9E%E3%81%A8c%E3%81%A8%E3%81%AE%E9%80%A3%E6%90%BA%E6%96%B9%E5%BC%8F\"\u003eD言語とC#との連携方式\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%91\"\u003eパターン１\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003eソースコード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB\"\u003eコンパイル\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\"\u003e実行結果\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%92\"\u003eパターン２\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-1\"\u003eソースコード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-1\"\u003eコンパイル\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-1\"\u003e実行結果\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%93\"\u003eパターン３\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-2\"\u003eソースコード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-2\"\u003eコンパイル\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#dmd%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB%E6%99%82%E3%81%AE%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\"\u003eDMDでのコンパイル時の注意事項\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-2\"\u003e実行結果\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%EF%BC%94\"\u003eパターン４\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89-3\"\u003eソースコード\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB-3\"\u003eコンパイル\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C-3\"\u003e実行結果\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%A7%81%E8%A6%8B%E6%84%9F%E6%83%B3\"\u003e私見、感想\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":3304,"uuid":"b52c13f0d3437de786cb","banReason":null,"adventCalendarItem":{"day":9,"calendar":{"name":"D言語","urlName":"dlang","year":2020,"organization":null}},"author":{"encryptedId":"REWw92e411ngriIRZhRC67upqMZ7--vhVc70xT9kNiitkh--Ite5MTpdop6gscEtMdmgkQ==","originalId":675901,"description":"","facebookUrl":null,"githubUrl":"https://github.com/devmynote","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/675901/profile-images/1595052067","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F675901%2Fprofile-images%2F1595052067?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=5962ba2900a437d6b423a7f7dcf825ce","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F675901%2Fprofile-images%2F1595052067?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=2bbe618a286032f5490c73d2de3eb35c","urlName":"devmynote","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C++","urlName":"cpp"},{"name":"C#","urlName":"csharp"},{"name":"dlang","urlName":"dlang"},{"name":"D言語","urlName":"d%e8%a8%80%e8%aa%9e"},{"name":"C++CLI","urlName":"c%2b%2bcli"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
