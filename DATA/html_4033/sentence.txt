More than 1 year has passed since last update.アプリケーションの設定値 (フォームの位置やサイズなど) を保存し, 次回起動時にこの設定値で起動する、ということを実施することがあると思います. この設定値を保存する形式は, .NET Frameworkアプリケーションではxml形式が推奨されていますが, 未だにini形式が好まれたりします.
そのため, iniファイルの読み書き用のクラスを作成してみました.使用するWin32 APIの定義はNativeMethodsクラスに以下のように定義します.iniファイル読み書き用のクラスは次の通りです.WinFormsアプリケーションでフォームの位置・サイズをiniファイルへの読み書きするサンプルです.
アプリケーションと同一ディレクトリーにTest.iniが存在しているとし, このTest.iniに設定値を読み書きします. FormのLoadイベントでiniファイルの内容を読み込み, FormClosingイベントでiniファイルに書き込みしています.今回作成したIniクラスを使用することで簡易にiniファイルの内容を読み書きできるようになりました.


