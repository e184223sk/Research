<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Blazor Tutorialまとめ(番外×2 + EP10～) - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/NAVE/items/e3831c73adaaf56211e2" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="9AF9Ke45gZNrBvfKzi6n68QN/8wE1oKv8MPs9zF9IEb7TxCJ2bo6Ggx2TW2EfW/kuawhN371p3Cv31mRRIFN7w==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="Blazor Tutorialまとめ(番外×2 + EP10～) - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1RbXhoZW05eUlGUjFkRzl5YVdGczQ0Ry00NEdvNDRLQktPZVZxdVdrbHNPWE1pQXJJRVZRTVREdnZaNHAmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NmFmN2JmM2YyODFmMDQ1YTY2MzY5ODA5MjEyYzgxNmY&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRTVCVmtVJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NjMxYmI4ZjczYWI4NTYwOGQ1MGViYmQ0NjFhYjY5MWU&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=0ec74fd40205bdef6d79cb6c1724b308"><meta property="og:description" content="本家動画はこちら
EP01～05はこちら
EP06～09はこちら

EP10でREST API扱うんだけど、API叩くにもちょうどいいのがないので、この人の別動画
　ASP.NET Core Web API + Entity Fram..."><meta content="https://qiita.com/NAVE/items/e3831c73adaaf56211e2" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Razor,Blazor" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-bd4f8bba-b9dc-4d50-9113-5a647091f1f6"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FNAVE%2Fitems%2Fe3831c73adaaf56211e2">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FNAVE%2Fitems%2Fe3831c73adaaf56211e2">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-bd4f8bba-b9dc-4d50-9113-5a647091f1f6">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2021-01-09T11:58:48.000+09:00","dateModified":"2021-03-07T16:12:51.000+09:00","headline":"Blazor Tutorialまとめ(番外×2 + EP10～)","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1RbXhoZW05eUlGUjFkRzl5YVdGczQ0Ry00NEdvNDRLQktPZVZxdVdrbHNPWE1pQXJJRVZRTVREdnZaNHAmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9NmFmN2JmM2YyODFmMDQ1YTY2MzY5ODA5MjEyYzgxNmY\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRTVCVmtVJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NjMxYmI4ZjczYWI4NTYwOGQ1MGViYmQ0NjFhYjY5MWU\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=0ec74fd40205bdef6d79cb6c1724b308","mainEntityOfPage":"https://qiita.com/NAVE/items/e3831c73adaaf56211e2","author":{"@type":"Person","address":"","email":null,"identifier":"NAVE","name":"NAVE","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65842%2Fprofile-images%2F1473697011?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=145fb26db3907978141d316a5648c29e","url":"https://qiita.com/NAVE","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"NAVE","type":"items","id":"e3831c73adaaf56211e2"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"NAVE","type":"items","id":"e3831c73adaaf56211e2"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"NAVE","type":"items","id":"e3831c73adaaf56211e2"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/NAVE/items/e3831c73adaaf56211e2","location":"/NAVE/items/e3831c73adaaf56211e2","scheme":"https","host":"qiita.com","port":null,"pathname":"/NAVE/items/e3831c73adaaf56211e2","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"CrE18MxhMAfzIFo4IKqw3QcR3zqOrqF0koIB+bfJNIwF/1hQ++KLjpRQ4J9q+XjSerABwfSNhKvNnrSfwjVZJQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-07f06415-88e2-4f9f-965d-f831a9b109ff"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/NAVE/items/e3831c73adaaf56211e2/likers" class="css-1iupg5d">0</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">1</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/e3831c73adaaf56211e2/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/NAVE/items/e3831c73adaaf56211e2/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/NAVE/items/e3831c73adaaf56211e2/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/NAVE/items/e3831c73adaaf56211e2/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/NAVE/items/e3831c73adaaf56211e2.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/NAVE"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/65842/profile-images/1473697011" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/NAVE" class="css-10ougpm">@<!-- -->NAVE</a><div class="css-1ay9vb9"><span><meta content="2021-01-09T02:58:48Z"/><time dateTime="2021-03-07T07:12:51Z" class="css-m19uds">updated at 2021-03-07</time></span></div></div></div></div></div><h1 class="css-cgzq40">Blazor Tutorialまとめ(番外×2 + EP10～)</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/razor" class="css-4czcte">Razor</a><a href="/tags/blazor" class="css-4czcte">Blazor</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><a href="https://www.youtube.com/watch?v=xr56fmgLl74&amp;list=PL4WEkbdagHIR0RBe_P4bai64UDqZEbQap" rel="nofollow noopener" target="_blank">本家動画はこちら</a><br>
<a href="https://qiita.com/NAVE/items/1e9d44ea2c0b43dcd9b7" id="reference-b004738aab8bc0691831">EP01～05はこちら</a><br>
<a href="https://qiita.com/NAVE/items/124d6a9e7a4e2cdb580b" id="reference-8cd384e1461433022388">EP06～09はこちら</a></p>

<p>EP10でREST API扱うんだけど、API叩くにもちょうどいいのがないので、この人の別動画<br>
　<a href="https://www.youtube.com/watch?v=CLVJVA9cTuU&amp;list=PL4WEkbdagHIQVbiTwos0E38VghMJA06OT" rel="nofollow noopener" target="_blank">ASP.NET Core Web API + Entity Framework Core</a><br>
の基本を番外でまとめていくよ。</p>

<h1>
<span id="番外rest-apiの作り方" class="fragment"></span><a href="#%E7%95%AA%E5%A4%96rest-api%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9"><i class="fa fa-link"></i></a>番外①:REST APIの作り方</h1>

<ul>
<li>ASP.NET CoreでREST APIを作るのは簡単だよ。</li>
<li>まずは専用のプロジェクトを作るパターンから見てみよう。</li>
<li>プロジェクトを新規作成して「ASP.NET Core Webアプリケーション」を選択するよ。プロジェクト名は何でもいいよ。</li>
<li>次に「API」を選択してプロジェクトを作成するよ。するとサンプル付きでプロジェクトができるよ。</li>
<li>とりあえずこのまま何も変更せずに実行してみよう。すると「<a href="https://localhost:(%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7)/weatherforecast%E3%80%8D%E3%81%AB%E9%81%B7%E7%A7%BB%E3%81%97%E3%81%A6JSON%E3%81%8C%E8%BF%94%E3%81%A3%E3%81%A6%E3%81%8D%E3%81%9F%E3%81%AD%E3%80%82" class="autolink">https://localhost:(ポート番号)/weatherforecast」に遷移してJSONが返ってきたね。</a>
</li>
<li>それじゃコードについて説明していこう。</li>
<li>まずは「<strong>Controllers</strong>」フォルダ内の「<strong>WeatherForecastController.cs</strong>」。これがデータを返してる本体だよ。</li>
<li>クラス名が「<code>WeatherForecastController</code>」ってなってるけど、<strong>このクラス名のControllerより前の部分</strong>が<code>[Route("[controller]")]</code>の<code>[controller]</code>に該当するよ。試しにクラス名を「<code>HogeController</code>」に変えて実行してみると、初期遷移の「<a href="https://localhost:(%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7)/weatherforecast%E3%80%8D%E3%81%AF%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%A6%E3%80%8Chttps://localhost:(%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7)/hoge%E3%80%8D%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B%E3%81%A8JSON%E3%81%8C%E8%BF%94%E3%81%A3%E3%81%A6%E3%81%8F%E3%82%8B%E3%81%AE%E3%81%8C%E3%82%8F%E3%81%8B%E3%82%8B%E3%81%AD%E3%80%82" class="autolink">https://localhost:(ポート番号)/weatherforecast」はエラーになって「https://localhost:(ポート番号)/hoge」にアクセスするとJSONが返ってくるのがわかるね。</a>
</li>
<li>どのメソッドがJSONを返しているかというと<code>[HttpGet]</code>属性がついた<code>IEnumerable&lt;WeatherForecast&gt; Get()</code>が返してるよ。このメソッドみたいに[HttpGet]属性つけてIEnumerable&lt;(任意の型)&gt;ってやれば勝手にクラスをJSONに変換して返してくれるんだね。</li>
<li>ちなみにこのAPIはBlazorとかASP.NET MVCとかにも追加できるよ。</li>
<li>ただその場合、「<strong>Startup.cs</strong>」の編集が必要で、<code>ConfigureServices</code>メソッドに<code>services.AddControllers();</code>の追加と、<code>Configure</code>メソッドに<code>app.UseHttpsRedirection();</code>、<code>app.UseAuthorization();</code>、<code>endpoints.MapControllers();</code> の追加が必要だよ。細かい追加位置はサンプルを確認してね。</li>
</ul>

<p>(あとはこの人が公開してるサンプル(<a href="https://github.com/CuriousDrive/BookStores" rel="nofollow noopener" target="_blank">CuriousDrive/BookStores - GitHub</a>の「<strong>SalesController.cs</strong>」)見たほうが早いかも )<br>
(↑のサンプルよく見ずにVisualStudioが作るテンプレベースにしてたらハマった・・・)<br>
(VisualStudioが作るテンプレだとAPIの戻り値が<code>IEnumerable&lt;WeatherForecast&gt;</code>になってるけど、これだと<code>GetFromJsonAsync</code>で戻り値が取れん。APIの定義側も非同期に対応するために<code>Task&lt;ActionResult&lt;IEnumerable&lt;WeatherForecast&gt;&gt;</code>ってせんとあかんかった)<br>
(EntityFrameworkCoreと組み合わせたらもっと簡単な方法があった…(´・ω・`))<br>
(DBコンテキスト継承したクラス作ってEntityFrameworkCoreで読み書きできる状態にした上で、プロジェクト内の任意のフォルダ右クリック→追加→コントーローラー→共通→API→Entity Frameworkを使用したアクションがあるAPIコントローラー、で一発で参照/追加/削除のWeb APIが生成された…)<br>
(<del>↑で生成したコントローラー、なんかうまく動かん…</del>)<br>
(「<strong>Startup.cs</strong>」の <code>public void ConfigureServices(IServiceCollection services)</code> の中に <code>services.AddScoped&lt;AuthorContext&gt;();</code> を追加する必要があったわ。)<br>
(クラスにバリデーションつけとけば勝手に文字列長とかチェックしてエラー返してくれるのイイね)<br>
(ただやっぱり勉強用コードとは言え、DBエラーとか例外はちゃんとcatchしてエラーメッセージ返さないとエラー発生時が大変だわ)</p>

<h1>
<span id="番外entityframeworkcore" class="fragment"></span><a href="#%E7%95%AA%E5%A4%96entityframeworkcore"><i class="fa fa-link"></i></a>番外②:EntityFrameworkCore</h1>

<p>(動画は長いしSQLServer立てる必要もあるからSQLite使って今までの書き方みたく書いていこう。参考にしたのは<br>
　<a href="https://www.fenet.jp/dotnet/column/environment/828/" rel="nofollow noopener" target="_blank">Entity FrameworkでSQLiteを利用する方法とは</a> とか<br>
　<a href="https://entityframeworkcore.com/ja/knowledge-base/38238043/" rel="nofollow noopener" target="_blank">Database.EnsureCreatedおよびDatabase.Migrateを呼び出す方法と場所</a> とか<br>
　 <a href="https://www.entityframeworktutorial.net/efcore/create-model-for-existing-database-in-ef-core.aspx" rel="nofollow noopener" target="_blank">Creating a Model for an Existing Database in Entity Framework Core</a> とか<br>
　<a href="https://qiita.com/kawasukeeee/items/7bc5d948e3029c8a3a23" id="reference-1cab824b454adb739101">VSCodeでRESTクライアントを使って効率的にAPIを呼び出す。</a> とか<br>
　<a href="https://sql-oracle.com/sqlserver/?p=1087" rel="nofollow noopener" target="_blank">C# EntityFrameworkでIDENTITY属性を無効化する</a> とか。)</p>

<ul>
<li>EntityFrameworkを使って、今まで使ってた<code>Author</code>クラスのデータをデータベースに保存してみよう。</li>
<li>RDBMSはインストールとかいらないSQliteを使うよ。</li>
<li>SQliteはRDBMSの一種でライブラリだけで動いてファイル単位でDBを持てるやつだよ。</li>
<li>今までのプロジェクトに追加してもいいけど、わかりやすいようにコンソールアプリのプロジェクトを別で作ろう。</li>
<li>プロジェクトを作ったら<code>Author</code>クラスのソースをこのプロジェクトに追加しよう。</li>
<li>
<code>Author</code>クラスの<code>AuthorId</code>には<code>[Key]</code>属性を付与しよう。こうすることでプライマリキーになって自動採番(SQLiteならAUTOINCREMENT)されるようになるよ。</li>
<li>ちなみに自動採番したくない場合は追加で<code>[DatabaseGenerated(DatabaseGeneratedOption.None)]</code>を属性追加すればいいよ。</li>
<li>次にNugetで <code>Microsoft.EntityFrameworkCore.Sqlite</code> を追加するよ。</li>
<li>続いてコードを修正するよ。<code>using System.ComponentModel.DataAnnotations.Schema;</code> と <code>Author</code> の前に <code>[Table("Authors")]</code> を追加するだけだよ。</li>
</ul>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">Author.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.ComponentModel.DataAnnotations</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.ComponentModel.DataAnnotations.Schema</span><span class="p">;</span><span class="c1">//←追加</span>

<span class="k">namespace</span> <span class="nn">EntityFrameworkTest</span> <span class="p">{</span>
    <span class="p">[</span><span class="nf">Table</span><span class="p">(</span><span class="s">"Authors"</span><span class="p">)]</span><span class="c1">//←追加</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Author</span> <span class="p">{</span>
</code></pre></div>
</div>

<ul>
<li>続いて <code>DbContext</code> を継承したクラスを作るよ。</li>
</ul>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">AuthorContext.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">AuthorContext</span> <span class="p">:</span> <span class="n">DbContext</span> <span class="p">{</span>
    <span class="k">public</span> <span class="n">DbSet</span><span class="p">&lt;</span><span class="n">Author</span><span class="p">&gt;</span> <span class="n">Authors</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">internal</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnConfiguring</span><span class="p">(</span><span class="n">DbContextOptionsBuilder</span> <span class="n">optionBuilder</span><span class="p">){</span>
        <span class="kt">var</span> <span class="n">connectionString</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqliteConnectionStringBuilder</span> <span class="p">{</span> <span class="n">DataSource</span> <span class="p">=</span> <span class="s">@"C:\tmp\sample.db"</span> <span class="p">}.</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="n">optionBuilder</span><span class="p">.</span><span class="nf">UseSqlite</span><span class="p">(</span><span class="k">new</span> <span class="nf">SqliteConnection</span><span class="p">(</span><span class="n">connectionString</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<ul>
<li>これで準備はOK。DBを読み書きしてみよう。</li>
</ul>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">Program.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// コンテキスト・クラスを作成</span>
    <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">db</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AuthorContext</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">// スキーマとかテーブルが無かったら作るよ。</span>
        <span class="n">db</span><span class="p">.</span><span class="n">Database</span><span class="p">.</span><span class="nf">EnsureCreated</span><span class="p">();</span>

        <span class="c1">//サンプルに山田さんを100人</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span> <span class="p">{</span>
            <span class="c1">//AuthorIdは自動採番されるので未指定でいいよ</span>
            <span class="n">db</span><span class="p">.</span><span class="n">Authors</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Author</span>
                            <span class="p">{</span>
                                <span class="n">FirstName</span> <span class="p">=</span> <span class="s">"太郎"</span><span class="p">,</span>
                                <span class="n">LastName</span> <span class="p">=</span> <span class="s">"山田"</span><span class="p">,</span>
                                <span class="n">City</span> <span class="p">=</span> <span class="s">"東京"</span><span class="p">,</span>
                                <span class="n">EmailAddress</span> <span class="p">=</span> <span class="s">"taro@tokyo.com"</span><span class="p">,</span>
                                <span class="n">Salary</span> <span class="p">=</span> <span class="m">10000000</span><span class="p">,</span>
                                <span class="n">Phone</span> <span class="p">=</span> <span class="s">"03-1234-4567"</span>
                            <span class="p">};);</span>
        <span class="p">}</span>

        <span class="c1">// DBへ保存</span>
        <span class="kt">int</span> <span class="n">recordsAffected</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">SaveChanges</span><span class="p">();</span>

        <span class="c1">// 順に取り出して表示</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="k">in</span> <span class="n">db</span><span class="p">.</span><span class="n">Authors</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"AuthorId: {0} , FirstName: {1} , LastName: {2}"</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">AuthorId</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">FirstName</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">LastName</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// キー入力待ち</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<ul>
<li>ホントにDB読み書きしてるのか不安になるレベルのコードの少なさだけど、一回実行した後 <code>EnsureCreated</code> から <code>SaveChanges</code> までをコメントアウトしてもちゃんとデータが表示できてるから、ちゃんとDB読み書きしてることがわかるね。</li>
<li>コードからDBを作ったけど、今度はDBからコードを作ってみよう。</li>
<li>まずは別プロジェクトのコンソールアプリで 「<strong>EntryFrameworkTestFromDB</strong>」 っていうのを作ってみよう。</li>
<li>NuGetで <code>Microsoft.EntityFrameworkCore.Sqlite</code> と <code>Microsoft.EntityFrameworkCore.Tools</code> を追加するよ。</li>
<li>
<strong>パッケージマネージャコンソール</strong>(表示されてなければメニューの「表示」→「その他のウィンドウ」→「パッケージマネージャコンソール」から表示できるよ)にコマンド <code>Scaffold-DbContext "DataSource=C:\tmp\sample.db;" Microsoft.EntityFrameworkCore.Sqlite</code> を実行してみよう。</li>
<li>「<strong>Author.cs</strong>」「<strong>sampleContext.cs</strong>」が生成されたね。</li>
<li>「<strong>sampleContext.cs</strong>」だと名前がいまいちなので、名前は変えておこう。</li>
<li>「<strong>sampleContext.cs</strong>」を開いてクラス名 <code>sampleContext</code> を右クリック、「名前の変更」を選択しよう。</li>
<li>
<code>sampleContext</code> がハイライトされるのでクラス名を <code>AuthorContext</code> に変更しよう。</li>
<li>「シンボルのファイル名を変更する」にチェックが入っていることを確認して「適用」をクリックするとファイル名も含めてプロジェクト内の <code>sampleContext</code> が <code>AuthorContext</code> に置き換わるよ。</li>
<li>同ファイルにはプリプロセッサ<code>#warning</code>で「ソースコードの中に接続文字列を入れないようにしようね」みたいな警告が出るけど、今回は無視するので削除しておこう。</li>
<li>あとはメイン関数に「<strong>EntryFrameworkTest</strong>」で書いた表示プログラムを張り付けてみたらちゃんとデータが表示されることがわかるね。</li>
</ul>

<h1>
<span id="ep10rest-apiの呼び出し" class="fragment"></span><a href="#ep10rest-api%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97"><i class="fa fa-link"></i></a>EP10:REST APIの呼び出し</h1>

<ul>
<li>今回はREST APIの呼び出し方について説明するよ。</li>
<li>手順としては<code>@inject HttpClient</code>を追加して<del><code>GetJsonAsync</code></del><code>GetFromJsonAsync&lt;T&gt;</code>、<del><code>PostJsonAsync</code></del><del><code>PostAsJsonAsync</code></del><code>PostAsync</code>、<code>DeleteAsync</code>、<del><code>PutJsonAsync</code></del><del><code>PutAsJsonAsync</code></del><code>PutJsonAsync</code>でREST APIを叩くだけだよ。</li>
</ul>

<p>(動画では<code>GetJsonAsync</code>と<code>PostJsonAsync</code>と<code>PutJsonAsync</code>やったけど、.NET5でやってたら<code>GetFromJsonAsync</code>と<code>PostAsJsonAsync</code>と<code>PutAsJsonAsync</code>やった。名前変わったんかな？)<br>
(あと日本語とか含んでると文字のエンコード処理がうまくいかないから<code>PostJsonAsync</code>と<code>PutJsonAsync</code>は使えんかった。)</p>

<ul>
<li>別の動画で作った本屋さんWebAPIを使って実際にやってみよう。</li>
<li>まずは「<strong>Startup.cs</strong>」の<code>ConfigureServices</code>に<code>services.AddSingleton&lt;HttpClient&gt;();</code>を追加するよ。</li>
<li>続いて使いたいページに<code>@inject HttpClient Http;</code>を追加するよ。</li>
<li>あとは<code>GetFromJsonAsync&lt;T&gt;</code>で指定したURLを叩くだけだよ。</li>
</ul>

<p>(「<strong>_Imports.razor</strong>」に<code>@using System.Net.Http.Json</code>追加せな「GetFromJsonAsyncとか知らんで」って言われた。)<br>
(無料の天気予報REST APIで試そうかとも思ったけど、これ用で作った方がシンプルかなぁ)<br>
(→番外作成。地味にハマった・・・)</p>

<ul>
<li>今回の場合Authorのリストを取得したいから<code>GetFromJsonAsync&lt;LIST&lt;Author&gt;&gt;</code>となるね。</li>
<li>JSONのキー名をそのままクラスのプロパティ名にしたクラスを作っておけば後は勝手に変換してくれるよ。</li>
<li>あとこの実行は非同期だからnull参照して落ちないように戻り値用変数は<code>new List&lt;Author&gt;</code>で初期化しておく必要があるね。</li>
</ul>

<p>(自分で試したときは一々別プロジェクト立ち上げるのが面倒だったので、同じプロジェクトにコントローラー追加した。なので呼び出しは↓みたいな感じに。)</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="n">List</span><span class="p">&lt;</span><span class="n">Product</span><span class="p">&gt;</span> <span class="n">ret</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Product</span><span class="p">&gt;;</span>
<span class="n">ret</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Http</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Product</span><span class="p">&gt;&gt;(</span><span class="n">NavigationManager</span><span class="p">.</span><span class="n">BaseUri</span> <span class="p">+</span> <span class="s">"Values"</span><span class="p">);</span>
</code></pre></div></div>

<ul>
<li>あと取ったデータは<code>authirKust.OrderByDescending(auth =&gt; auth.AuthorId).ToList&lt;Author&gt;();</code>で降順に並べておこう。</li>
<li>それじゃ実行してみよう。ちゃんとAPIで取ってきたデータを表示しているのがわかるね。</li>
<li>続いて値の設定に移ろう。</li>
<li>
<code>SaveAuthor</code> 関数のところでPOSTするようにするよ。(動画では<code>PostAsJsonAsync</code>使ってるけど、日本語含んでるとエンコードがうまくいかないのかエラーになるので<code>PostAsync</code>使わないとダメそう？あと、動画では書いてないけど、POSTの結果でJSONが返ってくる場合は<code>ReadFromJsonAsync</code>で結果を読んでデシリアライズが一発できるみたい)</li>
</ul>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="kt">var</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonSerializer</span><span class="p">.</span><span class="nf">Serialize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerOptions</span> <span class="p">{</span>
    <span class="n">Encoder</span> <span class="p">=</span> <span class="n">JavaScriptEncoder</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">UnicodeRanges</span><span class="p">.</span><span class="n">All</span><span class="p">),</span>
<span class="p">});</span>
<span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">ret</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Http</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">NavigationManager</span><span class="p">.</span><span class="n">BaseUri</span> <span class="p">+</span> <span class="s">"api/Authors"</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">ret</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadFromJsonAsync</span><span class="p">&lt;</span><span class="n">Author</span><span class="p">&gt;();</span>
</code></pre></div></div>

<ul>
<li>実行してみると正常にデータは更新されているはずなのに表示が更新されないのがわかるね。</li>
<li>これはデータを取り直して <code>StateHasChanged()</code> で画面に対して更新通知を行っていないからだよ。</li>
<li>POSTした後にデータを取り直して <code>StateHasChanged()</code> を呼んでみよう。</li>
<li>実行してみるとちゃんとデータが更新されることがわかるね。</li>
<li><p>次は削除と更新をしてみよう。<br>
(動画じゃ分けてるけどPUTとDELETEの違い程度なので一緒で。)</p></li>
<li><p>まずは表の各行に「更新」と「削除」ボタンを付けるよ。<br>
(動画じゃHTMLタグにスタイル直書きしてるけどイマイチだなぁ…<del>せっかくだしSCSS試してみるか。</del>それより先にBootstrap覚えよ)<br>
<a href="http://www.tohoho-web.com/bootstrap/introduction.html" rel="nofollow noopener" target="_blank">とほほのBootstrap 4入門</a><br>
(杜甫々さんのページ、HP作るのにHTML覚えた(1998年頃)以来に見るけどすごいコンテンツ増えてるなぁ)<br>
(Bootstrap使うのは<a href="http://www.tohoho-web.com/bootstrap/tables.html" rel="nofollow noopener" target="_blank">テーブル</a>と<a href="http://www.tohoho-web.com/bootstrap/buttons.html" rel="nofollow noopener" target="_blank">ボタン</a>かなぁ。動画だとハイパーリンクだけどボタンにしとこ)</p></li>
</ul>

<div class="code-frame" data-lang="html"><div class="highlight"><pre class="with-code"><code><span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-striped"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thead</span> <span class="na">class=</span><span class="s">"thead-lignt"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>ID<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>First name<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Last name<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>City<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Email<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>更新/削除<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody&gt;</span>
        @foreach (var a in author_list)
        {
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    @a.AuthorId
                <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    @a.FirstName
                <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    @a.LastName
                <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    @a.City
                <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    @a.EmailAddress
                <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"btn btn-outline-primary btn-sm"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="err">@</span><span class="na">onclick=</span><span class="s">"(() =&gt; EditAuthor(a.AuthorId, author))"</span><span class="nt">&gt;</span>Edit<span class="nt">&lt;/button&gt;</span> |
                    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>  <span class="na">class=</span><span class="s">"btn btn-outline-danger btn-sm"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="err">@</span><span class="na">onclick=</span><span class="s">"(() =&gt; DeleteAuthor(a.AuthorId))"</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/button&gt;</span>
                <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        }
    <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div></div>

<ul>
<li>続いて更新と削除のコードを書くよ。表示更新はどっちも同じなので関数化したよ。</li>
</ul>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">UpdateTable</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">author_list</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Http</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Author</span><span class="p">&gt;&gt;(</span><span class="n">NavigationManager</span><span class="p">.</span><span class="n">BaseUri</span> <span class="p">+</span> <span class="s">"api/Authors"</span><span class="p">);</span>
    <span class="nf">StateHasChanged</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">EditAuthor</span><span class="p">(</span><span class="kt">int</span> <span class="n">_id</span><span class="p">,</span> <span class="n">Author</span> <span class="n">_author</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">_author</span><span class="p">.</span><span class="n">AuthorId</span> <span class="p">=</span> <span class="n">_id</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonSerializer</span><span class="p">.</span><span class="nf">Serialize</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerOptions</span> <span class="p">{</span>
        <span class="n">Encoder</span> <span class="p">=</span> <span class="n">JavaScriptEncoder</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">UnicodeRanges</span><span class="p">.</span><span class="n">All</span><span class="p">)</span>
    <span class="p">});</span>
    <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">ret</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Http</span><span class="p">.</span><span class="nf">PutAsync</span><span class="p">(</span><span class="n">NavigationManager</span><span class="p">.</span><span class="n">BaseUri</span> <span class="p">+</span> <span class="s">"api/Authors/"</span> <span class="p">+</span> <span class="n">_id</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(),</span> <span class="n">content</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">.</span><span class="n">IsSuccessStatusCode</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//今は結果を返さないのでひとまずコメントアウト</span>
        <span class="c1">//var response = await ret.Content.ReadFromJsonAsync&lt;Author&gt;();</span>
    <span class="p">}</span>

    <span class="k">await</span> <span class="nf">UpdateTable</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">DeleteAuthor</span><span class="p">(</span><span class="kt">int</span> <span class="n">_id</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">ret</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Http</span><span class="p">.</span><span class="nf">DeleteAsync</span><span class="p">(</span><span class="n">NavigationManager</span><span class="p">.</span><span class="n">BaseUri</span> <span class="p">+</span> <span class="s">"api/Authors/"</span> <span class="p">+</span> <span class="n">_id</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
    <span class="k">await</span> <span class="nf">UpdateTable</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>(動画じゃ<code>SaveAuthor</code>にif文追加してPOSTとPut分岐してるな。しかも動作は「Edit」押したらフォームに値設定→Saveで更新　か、上記だとフォームに入力→Edit押したら更新になるな。けどまぁRESTの動き見るだけだからまぁいっか)</p>

<h1>
<span id="ep11認証すぐ使えるやつ" class="fragment"></span><a href="#ep11%E8%AA%8D%E8%A8%BC%E3%81%99%E3%81%90%E4%BD%BF%E3%81%88%E3%82%8B%E3%82%84%E3%81%A4"><i class="fa fa-link"></i></a>EP11:認証(すぐ使えるやつ)</h1>

<ul>
<li>今回は簡単にすぐ使える認証について説明するよ。</li>
<li>Blazorのプロジェクトを作るときに認証オプションが表示されるやつの話だよ。</li>
<li>認証してユーザー情報をDBに保存するよ。</li>
<li>あと今回説明する認証方法の長所/短所の話もするよ。</li>
<li>他に作成時に設定しなかった場合に後から追加する話もするよ。</li>
<li>それじゃ実際に作っていってみよう。</li>
<li>Blazorのプロジェクトを作るよ。プロジェクト名はOutOfBox(すぐ使える)にしようか。</li>
<li>「新しいBlazorアプリを作成します」の画面まで行くと右に「認証」っていう表示があってデフォルトは「認証なし」になってるね。</li>
<li>ここで変更をクリックすると認証を選択できるよ。</li>
<li>「個別のユーザーアカウント」は自前でアプリの中にユーザーのDBを持つか、Azure AD B2Cを使う方式だよ。</li>
</ul>

<p>　　参考：<a href="https://www.slideshare.net/ssuser18f2cf/aad-b2c" rel="nofollow noopener" target="_blank">AAD B2C使ってみた - slideshare</a></p>

<ul>
<li>「職場または学校のアカウント」はオンプレのADかAzure ADを使う方式だよ。</li>
</ul>

<p>　(業務アプリ作るならAzure AD使う方式が重宝しそう。SAMLとかOpenID Connectにも対応してくれたらうれしいんだけどなぁ)</p>

<ul>
<li>「Windows認証」はIISの認証方式に従うやつだよ。</li>
<li>今回は「個別のユーザーアカウント」を選択して自前でアプリの中にユーザーのDBを作ってみよう。</li>
<li>まずは何も考えず動作を見てみよう。実行すると右上に「Log in(ログイン)」があるのでクリックしてみよう。</li>
<li>自動で生成されたRazorページが表示されるよ。</li>
<li>ユーザーは誰も登録してないので「Register as a new user(新しいユーザーを登録する)」をクリックしよう。</li>
<li>実際に登録を実行してみると「DBを開くことができません」っていう例外が発生するね。</li>
</ul>

<p>(パスワード要件(6文字以上、大文字小文字記号必須)がデフォルトで設定されてるのいいね)</p>

<ul>
<li>DBを構成する必要があるよ。</li>
<li>ちなみにこの「個別のユーザーアカウント」認証ではEntryFrameworkを使ってSQL Serverにユーザー情報を格納しているよ。</li>
</ul>

<p>　(<del>動画ではSQLServerって言ってるけど面倒だしSQLiteかなぁ</del>)<br>
　(SQL Serverって言ってもVisual Studioと一緒にインストールしたような気がするLocalDBだから別途インストールする必要ない(※)のか)<br>
　※Visual Studioのインストールの時にオプション選んだかもしれないけど覚えてない</p>

<p>　参考：<br>
<a href="https://qiita.com/miyamiya/items/1e8d847f225b3dc0281a" id="reference-6b183b4786778f1f0d5f">MicrosoftSQL Server 2016 Express LocalDB で気軽に DB を試す</a><br>
(Visual Studio 2017からSQL Server Express 2016 LocalDBを使ってみる)[<a href="https://qiita.com/akabei/items/7f62056e44dd2d44f703" class="autolink" id="reference-0761953e3ec0c44b582d">https://qiita.com/akabei/items/7f62056e44dd2d44f703</a>]</p>

<ul>
<li>この画面の「Apply Migrations」をクリックすると「<strong>00000000000000_CreateIdentitySchema.cs</strong>」のコードが実行されてスキーマとかテーブルとかDBが全部作られるよ。</li>
</ul>

<p>(ブラウザ翻訳便利。そういえば１から作るのにMigrations(=移住/移行)ってなんか違和感あるよね。コードからDBへの移行ってこと？)<br>
<a href="https://camo.qiitausercontent.com/c660446ee080ca382422f8f4c5108a31b9dd8fac/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f36353834322f36383736303161392d656164382d313735352d616533632d6237653330336565373731632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F65842%2F687601a9-ead8-1755-ae3c-b7e303ee771c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ae6f7c6ae4254483e7e6e1ad08448d1f" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/65842/687601a9-ead8-1755-ae3c-b7e303ee771c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F65842%2F687601a9-ead8-1755-ae3c-b7e303ee771c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bb4d055fcfc2449b288c1af1faaa6400 1x" loading="lazy"></a></p>

<ul>
<li>それじゃ「Apply Migrations」をクリックして「Try refreshing the page」と表示されたらページを更新してみよう。ログインができた状態で初画面に移るね。いったんログアウトしてログインできるか見てみよう</li>
</ul>

<p>(うちの環境じゃ「Register confirmation(登録確認)」画面で「メール送れんかったよ、設定してね」みたいな表示になった。微妙なバージョンの違いかな？登録はできてるみたいでログインはできる)</p>

<ul>
<li>さっき登録したメールとパスワードを入力して「Log in」をクリックするとログインできて右上にメアドが表示されてるのがわかるね。</li>
</ul>

<p>(何回かやってたらログイン失敗するようになった。ググってみたら「<strong>Startup.cs</strong>」の<code>ConfigureServices</code>内の以下の<code>options.SignIn.RequireConfirmedAccount</code>を<code>false</code>に設定してメールによる確認を無効にする必要があるとか)</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">Startup.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="n">services</span><span class="p">.</span><span class="n">AddDefaultIdentity</span><span class="p">&lt;</span><span class="n">IdentityUser</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span> <span class="n">options</span><span class="p">.</span><span class="n">SignIn</span><span class="p">.</span><span class="n">RequireConfirmedAccount</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddEntityFrameworkStores</span><span class="p">&lt;</span><span class="n">ApplicationDbContext</span><span class="p">&gt;();</span>
</code></pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">Startup.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="n">services</span><span class="p">.</span><span class="n">AddDefaultIdentity</span><span class="p">&lt;</span><span class="n">IdentityUser</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span> <span class="n">options</span><span class="p">.</span><span class="n">SignIn</span><span class="p">.</span><span class="n">RequireConfirmedAccount</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddEntityFrameworkStores</span><span class="p">&lt;</span><span class="n">ApplicationDbContext</span><span class="p">&gt;();</span>
</code></pre></div>
</div>

<ul>
<li>このログイン情報がどこに格納されてるか見てみよう。</li>
<li>「<strong>appsettings.json</strong>」に接続文字列が書かれていてSQL Server Express LocalDBにつながってるのがわかるね。</li>
<li>サーバーエクスプローラーでつなげてスキーマを見てみよう。</li>
</ul>

<p>(SQL Serverオブジェクトエクスプローラーじゃなくて汎用性を考えてサーバーエクスプローラーを使うんやね)</p>

<ul>
<li>サーバーエクスプローラーで「データベースへの接続」をクリックして出てきたダイアログのサーバー名に「(localdb)\mssqllocaldb」と入力するよ。コードの方からコピペするときはエスケープシーケンス表記になってるので気を付けてね。</li>
<li>DBはなんかGUIDがくっついたDBができてるのでそれを選ぶよ。</li>
</ul>

<p>(このGUIDって↓と関係してるっぽいな。ソリューション内Grepかけたらcsprojのファイルの中の「UserSecretsId」ってやつと一致した)<br>
<a href="https://docs.microsoft.com/ja-jp/aspnet/core/security/app-secrets?view=aspnetcore-5.0&amp;tabs=windows" rel="nofollow noopener" target="_blank">ASP.NET Core での開発におけるアプリシークレットの安全な保存</a></p>

<ul>
<li>
<code>AspnetUser</code>っていうテーブルにユーザーが格納されてるよ。テーブルを右クリック→「テーブルデータの表示」から中身を見てみよう。</li>
<li>
<code>UserName</code>と<code>Email</code>にメールアドレスが、パスワードに暗号化されたパスワードが入ってるのがわかるね。こんな感じで認証に必要な機能は一通りそろってるよ。</li>
</ul>

<p>(暗号化って言ってるけどハッシュやんな？復号化出来たら危ないんやけど…)</p>

<ul>
<li>Role(役割)も設定できるから「ユーザーAは画面Xと画面Yが表示可能」「ユーザーBは画面Xのみ表示可能」とかもできるよ。</li>
<li>プロファイルページもあってそこで電話番号入れたりメアド変えたりパスワード変えたり２要素認証追加したりアカウント削除したりできるよ。</li>
<li>画面に戻ってみようログインしてない状態だと「Register(登録)」「Login」の二つがあるね。このエイリアスがどのコードと対応してるか探してみよう。</li>
<li>Areasフォルダの下にIdentityフォルダがあって、さらにその下にPagesフォルダがあるんだけど、ここにあるのは二つしかないね。</li>
<li>登録画面とかプロファイル管理画面が何故ないかというと、これらの画面は<code>Microsoft.AspNetCor.Identity.UI</code>に含まれてるからで、プロジェクトごとに追加したりする必要はないからだよ。独自のページを作ることもできるよ。</li>
</ul>

<p>(詳しくは書いてないけど、「Identity」フォルダ右クリック→追加→新規スキャフォールディングアイテム→ID、で登録できるみたい)</p>

<ul>
<li>次は実際にどんな風にユーザー認証してるのかを見てみよう。まずは「<strong>Startup.cs</strong>」から。</li>
<li>
<code>Configure</code>メソッドの中で、<code>app.UseRouting()</code>の後に<code>app.UseAuthentication()</code>と<code>app.UseAuthorization()</code>を呼んでるね。</li>
<li>今回はプロジェクト作成時に認証ありで作成したから最初からあるけど、後から認証を追加する場合は自分で追加しないといけないよ。</li>
<li>認証の処理とかを実際に行ってるオブジェクトがどれかというと<code>ConfigureServices</code>の中で<code>AddScoped</code>で追加されてる<code>AuthenticationStateProvider</code>から派生した<code>RevalidatingIdentityAuthenticationStateProvider&lt;IdentityUser&gt;</code>だよ。</li>
<li>このオブジェクトで認証されてるかどうかとか状態を保持してるよ。</li>
<li>実装である<code>RevalidatingIdentityAuthenticationStateProvider</code>の定義を見てみよう。</li>
<li>メソッド<code>ValidateAuthenticationStateAsync</code>内で認証状態を検証してるよ。この中で呼ばれてる<code>ValidateSecurityStampAsync</code>の中で<code>GetUserAsync</code>を呼んでユーザー情報を取得してるよ。</li>
</ul>

<p>(この辺の説明、自動翻訳だとメソッド名まで翻訳するから訳見ても意味が通らん…。この辺りは飛ばして、細かい仕組みの面は↓見てまた今度勉強しよ)<br>
(CascadingAuthenticationState(数珠繋ぎの認証状態)って何やろ？)</p>

<p>(ASP.NET Core Blazor の認証と承認)[<a href="https://docs.microsoft.com/ja-jp/aspnet/core/blazor/security/?view=aspnetcore-5.0" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/aspnet/core/blazor/security/?view=aspnetcore-5.0</a>]</p>

<ul>
<li>次に、画面の動きを見てみよう。ログインしてない状態ではRegisterとLoginが、ログインするとメールアドレスとLogoutが表示されるね。</li>
<li>これがどのように実装されているか「<strong>MainLayout.razor</strong>」を見てみよう。「About」の上に<code>LoginDisplay</code>っていうRazorコンポーネントを呼んでるのが見て取れるね。</li>
<li>それじゃ「<strong>LoginDisplay.razor</strong>」を見てみよう。ここには３つの重要なコンポーネントが書かれてるよ。</li>
<li>
<code>AuthorizeView</code>と<code>Authorized</code>と<code>NotAuthorized</code>だね。これは直感的にもわかると思うけど認証済みならAuthorizedの中身を表示、認証していないならNotAuthorizedの中身を表示っていう動きになるよ。</li>
<li>ここには書かれてないけど<code>Authorizing</code>って言うのもあるよ。認証に時間がかかる場合に使うといいよ。</li>
<li>それじゃ今回説明した認証の長所と短所をまとめてみよう。</li>
<li>長所は「セットアップが簡単(プロジェクト作成時に選択するだけ)」「小さいプロジェクトに向いてる」「DBの設計がいらない」「登録とかログインがすぐ使える」だね。</li>
<li>短所は「EntryFrameworkが必須」「APIを利用した設計ができない(データアクセスをAPIにしようとしたとき、APIの認証として使えない)」「古いrazorページを使う(cshtmlのこと？)」「既に存在するユーザーDBからの移行が難しい」だね。</li>
<li>次のエピソードでこれらの短所をカバーする方法を紹介するよ。</li>
</ul>

<h1>
<span id="ep12authentication--customauthenticationstateprovider" class="fragment"></span><a href="#ep12authentication--customauthenticationstateprovider"><i class="fa fa-link"></i></a>EP12:Authentication | CustomAuthenticationStateProvider</h1>

<ul>
<li>このエピソードではCustomAuthenticationStateProviderについて説明するよ。</li>
<li>
</ul>

<h1>
<span id="ep13layouts--login-pages" class="fragment"></span><a href="#ep13layouts--login-pages"><i class="fa fa-link"></i></a>EP13:Layouts | Login Pages</h1>

<h1>
<span id="ep14httpclient--login-user" class="fragment"></span><a href="#ep14httpclient--login-user"><i class="fa fa-link"></i></a>EP14:HttpClient | Login User</h1>

<h1>
<span id="ep15ihttpclientfactory--login-user" class="fragment"></span><a href="#ep15ihttpclientfactory--login-user"><i class="fa fa-link"></i></a>EP15:IHttpClientFactory | Login User</h1>

<h1>
<span id="ep16sending-jwt-token--building-request-middleware" class="fragment"></span><a href="#ep16sending-jwt-token--building-request-middleware"><i class="fa fa-link"></i></a>EP16:Sending JWT token &amp; Building Request Middleware</h1>

<h1>
<span id="ep17register-user--generate-jwt" class="fragment"></span><a href="#ep17register-user--generate-jwt"><i class="fa fa-link"></i></a>EP17:Register User &amp; Generate JWT</h1>

<h1>
<span id="ep18role-based-authorization" class="fragment"></span><a href="#ep18role-based-authorization"><i class="fa fa-link"></i></a>EP18:Role-based Authorization</h1>

<h1>
<span id="ep19policy-based-authorization" class="fragment"></span><a href="#ep19policy-based-authorization"><i class="fa fa-link"></i></a>EP19:Policy-based Authorization</h1>

<h1>
<span id="ep20procedural-logic--authentication--authorization-in-c" class="fragment"></span><a href="#ep20procedural-logic--authentication--authorization-in-c"><i class="fa fa-link"></i></a>EP20:Procedural Logic | Authentication &amp; Authorization in C</h1>

<h1>
<span id="ep21templated-components--html-table" class="fragment"></span><a href="#ep21templated-components--html-table"><i class="fa fa-link"></i></a>EP21:Templated Components | Html Table</h1>

<h1>
<span id="ep22razor-components--eventcallback" class="fragment"></span><a href="#ep22razor-components--eventcallback"><i class="fa fa-link"></i></a>EP22:Razor Components | EventCallback</h1>

<h1>
<span id="ep23event-handling" class="fragment"></span><a href="#ep23event-handling"><i class="fa fa-link"></i></a>EP23:Event Handling</h1>

<h1>
<span id="ep24gridview-header-filter" class="fragment"></span><a href="#ep24gridview-header-filter"><i class="fa fa-link"></i></a>EP24:GridView Header Filter</h1>

<h1>
<span id="ep25gridview-paging" class="fragment"></span><a href="#ep25gridview-paging"><i class="fa fa-link"></i></a>EP25:Gridview Paging</h1>

<h1>
<span id="ep26spinner-or-activity-indicator--ep26" class="fragment"></span><a href="#ep26spinner-or-activity-indicator--ep26"><i class="fa fa-link"></i></a>EP26:Spinner or Activity Indicator : EP26</h1>

<h1>
<span id="ep27code-faster-using-dotnet-watch-run" class="fragment"></span><a href="#ep27code-faster-using-dotnet-watch-run"><i class="fa fa-link"></i></a>EP27:Code Faster Using dotnet watch run</h1>

<h1>
<span id="ep28deploy-to-iis" class="fragment"></span><a href="#ep28deploy-to-iis"><i class="fa fa-link"></i></a>EP28:Deploy to IIS</h1>

<h1>
<span id="ep29deploy-to-azure-app-services" class="fragment"></span><a href="#ep29deploy-to-azure-app-services"><i class="fa fa-link"></i></a>EP29:Deploy to Azure App Services</h1>

<h1>
<span id="ep30handling-exceptions" class="fragment"></span><a href="#ep30handling-exceptions"><i class="fa fa-link"></i></a>EP30:Handling Exceptions</h1>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FNAVE%2Fitems%2Fe3831c73adaaf56211e2&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FNAVE%2Fitems%2Fe3831c73adaaf56211e2&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/NAVE/items/e3831c73adaaf56211e2/likers" class="css-1iupg5d">0</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">1</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/e3831c73adaaf56211e2/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/NAVE/items/e3831c73adaaf56211e2/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/NAVE/items/e3831c73adaaf56211e2/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/NAVE/items/e3831c73adaaf56211e2/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/NAVE/items/e3831c73adaaf56211e2.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-07f06415-88e2-4f9f-965d-f831a9b109ff">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-0b40a617-42ed-4e8b-8de0-689c338fcab9"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-0b40a617-42ed-4e8b-8de0-689c338fcab9">{}</script>
      
<div id="LoginModal-react-component-b43b738b-5946-4ca5-b929-4ffc3d05cc61"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-b43b738b-5946-4ca5-b929-4ffc3d05cc61">{}</script>
      
<div id="StockModal-react-component-703b6e7f-cc94-48c0-8800-1010a13ba2fd"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-703b6e7f-cc94-48c0-8800-1010a13ba2fd">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;4XXPh3LhaE+LMP/kPgDb6sEF6bXSVf+P88p7rW9YhZbuO6InRWLTxuxARUN0UxPlvKQ3Tqh22lCs1s7LGqToPw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003ca href=\"https://www.youtube.com/watch?v=xr56fmgLl74\u0026amp;list=PL4WEkbdagHIR0RBe_P4bai64UDqZEbQap\" rel=\"nofollow noopener\" target=\"_blank\"\u003e本家動画はこちら\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/NAVE/items/1e9d44ea2c0b43dcd9b7\" id=\"reference-b004738aab8bc0691831\"\u003eEP01～05はこちら\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/NAVE/items/124d6a9e7a4e2cdb580b\" id=\"reference-8cd384e1461433022388\"\u003eEP06～09はこちら\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eEP10でREST API扱うんだけど、API叩くにもちょうどいいのがないので、この人の別動画\u003cbr\u003e\n　\u003ca href=\"https://www.youtube.com/watch?v=CLVJVA9cTuU\u0026amp;list=PL4WEkbdagHIQVbiTwos0E38VghMJA06OT\" rel=\"nofollow noopener\" target=\"_blank\"\u003eASP.NET Core Web API + Entity Framework Core\u003c/a\u003e\u003cbr\u003e\nの基本を番外でまとめていくよ。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"番外rest-apiの作り方\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%95%AA%E5%A4%96rest-api%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e番外①:REST APIの作り方\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eASP.NET CoreでREST APIを作るのは簡単だよ。\u003c/li\u003e\n\u003cli\u003eまずは専用のプロジェクトを作るパターンから見てみよう。\u003c/li\u003e\n\u003cli\u003eプロジェクトを新規作成して「ASP.NET Core Webアプリケーション」を選択するよ。プロジェクト名は何でもいいよ。\u003c/li\u003e\n\u003cli\u003e次に「API」を選択してプロジェクトを作成するよ。するとサンプル付きでプロジェクトができるよ。\u003c/li\u003e\n\u003cli\u003eとりあえずこのまま何も変更せずに実行してみよう。すると「\u003ca href=\"https://localhost:(%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7)/weatherforecast%E3%80%8D%E3%81%AB%E9%81%B7%E7%A7%BB%E3%81%97%E3%81%A6JSON%E3%81%8C%E8%BF%94%E3%81%A3%E3%81%A6%E3%81%8D%E3%81%9F%E3%81%AD%E3%80%82\" class=\"autolink\"\u003ehttps://localhost:(ポート番号)/weatherforecast」に遷移してJSONが返ってきたね。\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eそれじゃコードについて説明していこう。\u003c/li\u003e\n\u003cli\u003eまずは「\u003cstrong\u003eControllers\u003c/strong\u003e」フォルダ内の「\u003cstrong\u003eWeatherForecastController.cs\u003c/strong\u003e」。これがデータを返してる本体だよ。\u003c/li\u003e\n\u003cli\u003eクラス名が「\u003ccode\u003eWeatherForecastController\u003c/code\u003e」ってなってるけど、\u003cstrong\u003eこのクラス名のControllerより前の部分\u003c/strong\u003eが\u003ccode\u003e[Route(\"[controller]\")]\u003c/code\u003eの\u003ccode\u003e[controller]\u003c/code\u003eに該当するよ。試しにクラス名を「\u003ccode\u003eHogeController\u003c/code\u003e」に変えて実行してみると、初期遷移の「\u003ca href=\"https://localhost:(%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7)/weatherforecast%E3%80%8D%E3%81%AF%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%A6%E3%80%8Chttps://localhost:(%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7)/hoge%E3%80%8D%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B%E3%81%A8JSON%E3%81%8C%E8%BF%94%E3%81%A3%E3%81%A6%E3%81%8F%E3%82%8B%E3%81%AE%E3%81%8C%E3%82%8F%E3%81%8B%E3%82%8B%E3%81%AD%E3%80%82\" class=\"autolink\"\u003ehttps://localhost:(ポート番号)/weatherforecast」はエラーになって「https://localhost:(ポート番号)/hoge」にアクセスするとJSONが返ってくるのがわかるね。\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eどのメソッドがJSONを返しているかというと\u003ccode\u003e[HttpGet]\u003c/code\u003e属性がついた\u003ccode\u003eIEnumerable\u0026lt;WeatherForecast\u0026gt; Get()\u003c/code\u003eが返してるよ。このメソッドみたいに[HttpGet]属性つけてIEnumerable\u0026lt;(任意の型)\u0026gt;ってやれば勝手にクラスをJSONに変換して返してくれるんだね。\u003c/li\u003e\n\u003cli\u003eちなみにこのAPIはBlazorとかASP.NET MVCとかにも追加できるよ。\u003c/li\u003e\n\u003cli\u003eただその場合、「\u003cstrong\u003eStartup.cs\u003c/strong\u003e」の編集が必要で、\u003ccode\u003eConfigureServices\u003c/code\u003eメソッドに\u003ccode\u003eservices.AddControllers();\u003c/code\u003eの追加と、\u003ccode\u003eConfigure\u003c/code\u003eメソッドに\u003ccode\u003eapp.UseHttpsRedirection();\u003c/code\u003e、\u003ccode\u003eapp.UseAuthorization();\u003c/code\u003e、\u003ccode\u003eendpoints.MapControllers();\u003c/code\u003e の追加が必要だよ。細かい追加位置はサンプルを確認してね。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(あとはこの人が公開してるサンプル(\u003ca href=\"https://github.com/CuriousDrive/BookStores\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCuriousDrive/BookStores - GitHub\u003c/a\u003eの「\u003cstrong\u003eSalesController.cs\u003c/strong\u003e」)見たほうが早いかも )\u003cbr\u003e\n(↑のサンプルよく見ずにVisualStudioが作るテンプレベースにしてたらハマった・・・)\u003cbr\u003e\n(VisualStudioが作るテンプレだとAPIの戻り値が\u003ccode\u003eIEnumerable\u0026lt;WeatherForecast\u0026gt;\u003c/code\u003eになってるけど、これだと\u003ccode\u003eGetFromJsonAsync\u003c/code\u003eで戻り値が取れん。APIの定義側も非同期に対応するために\u003ccode\u003eTask\u0026lt;ActionResult\u0026lt;IEnumerable\u0026lt;WeatherForecast\u0026gt;\u0026gt;\u003c/code\u003eってせんとあかんかった)\u003cbr\u003e\n(EntityFrameworkCoreと組み合わせたらもっと簡単な方法があった…(´・ω・`))\u003cbr\u003e\n(DBコンテキスト継承したクラス作ってEntityFrameworkCoreで読み書きできる状態にした上で、プロジェクト内の任意のフォルダ右クリック→追加→コントーローラー→共通→API→Entity Frameworkを使用したアクションがあるAPIコントローラー、で一発で参照/追加/削除のWeb APIが生成された…)\u003cbr\u003e\n(\u003cdel\u003e↑で生成したコントローラー、なんかうまく動かん…\u003c/del\u003e)\u003cbr\u003e\n(「\u003cstrong\u003eStartup.cs\u003c/strong\u003e」の \u003ccode\u003epublic void ConfigureServices(IServiceCollection services)\u003c/code\u003e の中に \u003ccode\u003eservices.AddScoped\u0026lt;AuthorContext\u0026gt;();\u003c/code\u003e を追加する必要があったわ。)\u003cbr\u003e\n(クラスにバリデーションつけとけば勝手に文字列長とかチェックしてエラー返してくれるのイイね)\u003cbr\u003e\n(ただやっぱり勉強用コードとは言え、DBエラーとか例外はちゃんとcatchしてエラーメッセージ返さないとエラー発生時が大変だわ)\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"番外entityframeworkcore\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%95%AA%E5%A4%96entityframeworkcore\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e番外②:EntityFrameworkCore\u003c/h1\u003e\n\n\u003cp\u003e(動画は長いしSQLServer立てる必要もあるからSQLite使って今までの書き方みたく書いていこう。参考にしたのは\u003cbr\u003e\n　\u003ca href=\"https://www.fenet.jp/dotnet/column/environment/828/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eEntity FrameworkでSQLiteを利用する方法とは\u003c/a\u003e とか\u003cbr\u003e\n　\u003ca href=\"https://entityframeworkcore.com/ja/knowledge-base/38238043/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eDatabase.EnsureCreatedおよびDatabase.Migrateを呼び出す方法と場所\u003c/a\u003e とか\u003cbr\u003e\n　 \u003ca href=\"https://www.entityframeworktutorial.net/efcore/create-model-for-existing-database-in-ef-core.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCreating a Model for an Existing Database in Entity Framework Core\u003c/a\u003e とか\u003cbr\u003e\n　\u003ca href=\"https://qiita.com/kawasukeeee/items/7bc5d948e3029c8a3a23\" id=\"reference-1cab824b454adb739101\"\u003eVSCodeでRESTクライアントを使って効率的にAPIを呼び出す。\u003c/a\u003e とか\u003cbr\u003e\n　\u003ca href=\"https://sql-oracle.com/sqlserver/?p=1087\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC# EntityFrameworkでIDENTITY属性を無効化する\u003c/a\u003e とか。)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eEntityFrameworkを使って、今まで使ってた\u003ccode\u003eAuthor\u003c/code\u003eクラスのデータをデータベースに保存してみよう。\u003c/li\u003e\n\u003cli\u003eRDBMSはインストールとかいらないSQliteを使うよ。\u003c/li\u003e\n\u003cli\u003eSQliteはRDBMSの一種でライブラリだけで動いてファイル単位でDBを持てるやつだよ。\u003c/li\u003e\n\u003cli\u003e今までのプロジェクトに追加してもいいけど、わかりやすいようにコンソールアプリのプロジェクトを別で作ろう。\u003c/li\u003e\n\u003cli\u003eプロジェクトを作ったら\u003ccode\u003eAuthor\u003c/code\u003eクラスのソースをこのプロジェクトに追加しよう。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eAuthor\u003c/code\u003eクラスの\u003ccode\u003eAuthorId\u003c/code\u003eには\u003ccode\u003e[Key]\u003c/code\u003e属性を付与しよう。こうすることでプライマリキーになって自動採番(SQLiteならAUTOINCREMENT)されるようになるよ。\u003c/li\u003e\n\u003cli\u003eちなみに自動採番したくない場合は追加で\u003ccode\u003e[DatabaseGenerated(DatabaseGeneratedOption.None)]\u003c/code\u003eを属性追加すればいいよ。\u003c/li\u003e\n\u003cli\u003e次にNugetで \u003ccode\u003eMicrosoft.EntityFrameworkCore.Sqlite\u003c/code\u003e を追加するよ。\u003c/li\u003e\n\u003cli\u003e続いてコードを修正するよ。\u003ccode\u003eusing System.ComponentModel.DataAnnotations.Schema;\u003c/code\u003e と \u003ccode\u003eAuthor\u003c/code\u003e の前に \u003ccode\u003e[Table(\"Authors\")]\u003c/code\u003e を追加するだけだよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAuthor.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.ComponentModel.DataAnnotations\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.ComponentModel.DataAnnotations.Schema\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//←追加\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eEntityFrameworkTest\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eTable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Authors\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\u003cspan class=\"c1\"\u003e//←追加\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAuthor\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003e続いて \u003ccode\u003eDbContext\u003c/code\u003e を継承したクラスを作るよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAuthorContext.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAuthorContext\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDbContext\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDbSet\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthor\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eAuthors\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnConfiguring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDbContextOptionsBuilder\u003c/span\u003e \u003cspan class=\"n\"\u003eoptionBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econnectionString\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eSqliteConnectionStringBuilder\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eDataSource\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e@\"C:\\tmp\\sample.db\"\u003c/span\u003e \u003cspan class=\"p\"\u003e}.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoptionBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUseSqlite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSqliteConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econnectionString\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003eこれで準備はOK。DBを読み書きしてみよう。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eProgram.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// コンテキスト・クラスを作成\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edb\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAuthorContext\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// スキーマとかテーブルが無かったら作るよ。\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDatabase\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEnsureCreated\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//サンプルに山田さんを100人\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//AuthorIdは自動採番されるので未指定でいいよ\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eAuthor\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003eFirstName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"太郎\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003eLastName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"山田\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003eCity\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"東京\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003eEmailAddress\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"taro@tokyo.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003eSalary\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e10000000\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                \u003cspan class=\"n\"\u003ePhone\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"03-1234-4567\"\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e};);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// DBへ保存\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003erecordsAffected\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSaveChanges\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 順に取り出して表示\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthors\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"AuthorId: {0} , FirstName: {1} , LastName: {2}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthorId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFirstName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLastName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// キー入力待ち\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadKey\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003eホントにDB読み書きしてるのか不安になるレベルのコードの少なさだけど、一回実行した後 \u003ccode\u003eEnsureCreated\u003c/code\u003e から \u003ccode\u003eSaveChanges\u003c/code\u003e までをコメントアウトしてもちゃんとデータが表示できてるから、ちゃんとDB読み書きしてることがわかるね。\u003c/li\u003e\n\u003cli\u003eコードからDBを作ったけど、今度はDBからコードを作ってみよう。\u003c/li\u003e\n\u003cli\u003eまずは別プロジェクトのコンソールアプリで 「\u003cstrong\u003eEntryFrameworkTestFromDB\u003c/strong\u003e」 っていうのを作ってみよう。\u003c/li\u003e\n\u003cli\u003eNuGetで \u003ccode\u003eMicrosoft.EntityFrameworkCore.Sqlite\u003c/code\u003e と \u003ccode\u003eMicrosoft.EntityFrameworkCore.Tools\u003c/code\u003e を追加するよ。\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eパッケージマネージャコンソール\u003c/strong\u003e(表示されてなければメニューの「表示」→「その他のウィンドウ」→「パッケージマネージャコンソール」から表示できるよ)にコマンド \u003ccode\u003eScaffold-DbContext \"DataSource=C:\\tmp\\sample.db;\" Microsoft.EntityFrameworkCore.Sqlite\u003c/code\u003e を実行してみよう。\u003c/li\u003e\n\u003cli\u003e「\u003cstrong\u003eAuthor.cs\u003c/strong\u003e」「\u003cstrong\u003esampleContext.cs\u003c/strong\u003e」が生成されたね。\u003c/li\u003e\n\u003cli\u003e「\u003cstrong\u003esampleContext.cs\u003c/strong\u003e」だと名前がいまいちなので、名前は変えておこう。\u003c/li\u003e\n\u003cli\u003e「\u003cstrong\u003esampleContext.cs\u003c/strong\u003e」を開いてクラス名 \u003ccode\u003esampleContext\u003c/code\u003e を右クリック、「名前の変更」を選択しよう。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003esampleContext\u003c/code\u003e がハイライトされるのでクラス名を \u003ccode\u003eAuthorContext\u003c/code\u003e に変更しよう。\u003c/li\u003e\n\u003cli\u003e「シンボルのファイル名を変更する」にチェックが入っていることを確認して「適用」をクリックするとファイル名も含めてプロジェクト内の \u003ccode\u003esampleContext\u003c/code\u003e が \u003ccode\u003eAuthorContext\u003c/code\u003e に置き換わるよ。\u003c/li\u003e\n\u003cli\u003e同ファイルにはプリプロセッサ\u003ccode\u003e#warning\u003c/code\u003eで「ソースコードの中に接続文字列を入れないようにしようね」みたいな警告が出るけど、今回は無視するので削除しておこう。\u003c/li\u003e\n\u003cli\u003eあとはメイン関数に「\u003cstrong\u003eEntryFrameworkTest\u003c/strong\u003e」で書いた表示プログラムを張り付けてみたらちゃんとデータが表示されることがわかるね。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep10rest-apiの呼び出し\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep10rest-api%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP10:REST APIの呼び出し\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e今回はREST APIの呼び出し方について説明するよ。\u003c/li\u003e\n\u003cli\u003e手順としては\u003ccode\u003e@inject HttpClient\u003c/code\u003eを追加して\u003cdel\u003e\u003ccode\u003eGetJsonAsync\u003c/code\u003e\u003c/del\u003e\u003ccode\u003eGetFromJsonAsync\u0026lt;T\u0026gt;\u003c/code\u003e、\u003cdel\u003e\u003ccode\u003ePostJsonAsync\u003c/code\u003e\u003c/del\u003e\u003cdel\u003e\u003ccode\u003ePostAsJsonAsync\u003c/code\u003e\u003c/del\u003e\u003ccode\u003ePostAsync\u003c/code\u003e、\u003ccode\u003eDeleteAsync\u003c/code\u003e、\u003cdel\u003e\u003ccode\u003ePutJsonAsync\u003c/code\u003e\u003c/del\u003e\u003cdel\u003e\u003ccode\u003ePutAsJsonAsync\u003c/code\u003e\u003c/del\u003e\u003ccode\u003ePutJsonAsync\u003c/code\u003eでREST APIを叩くだけだよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(動画では\u003ccode\u003eGetJsonAsync\u003c/code\u003eと\u003ccode\u003ePostJsonAsync\u003c/code\u003eと\u003ccode\u003ePutJsonAsync\u003c/code\u003eやったけど、.NET5でやってたら\u003ccode\u003eGetFromJsonAsync\u003c/code\u003eと\u003ccode\u003ePostAsJsonAsync\u003c/code\u003eと\u003ccode\u003ePutAsJsonAsync\u003c/code\u003eやった。名前変わったんかな？)\u003cbr\u003e\n(あと日本語とか含んでると文字のエンコード処理がうまくいかないから\u003ccode\u003ePostJsonAsync\u003c/code\u003eと\u003ccode\u003ePutJsonAsync\u003c/code\u003eは使えんかった。)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e別の動画で作った本屋さんWebAPIを使って実際にやってみよう。\u003c/li\u003e\n\u003cli\u003eまずは「\u003cstrong\u003eStartup.cs\u003c/strong\u003e」の\u003ccode\u003eConfigureServices\u003c/code\u003eに\u003ccode\u003eservices.AddSingleton\u0026lt;HttpClient\u0026gt;();\u003c/code\u003eを追加するよ。\u003c/li\u003e\n\u003cli\u003e続いて使いたいページに\u003ccode\u003e@inject HttpClient Http;\u003c/code\u003eを追加するよ。\u003c/li\u003e\n\u003cli\u003eあとは\u003ccode\u003eGetFromJsonAsync\u0026lt;T\u0026gt;\u003c/code\u003eで指定したURLを叩くだけだよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(「\u003cstrong\u003e_Imports.razor\u003c/strong\u003e」に\u003ccode\u003e@using System.Net.Http.Json\u003c/code\u003e追加せな「GetFromJsonAsyncとか知らんで」って言われた。)\u003cbr\u003e\n(無料の天気予報REST APIで試そうかとも思ったけど、これ用で作った方がシンプルかなぁ)\u003cbr\u003e\n(→番外作成。地味にハマった・・・)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e今回の場合Authorのリストを取得したいから\u003ccode\u003eGetFromJsonAsync\u0026lt;LIST\u0026lt;Author\u0026gt;\u0026gt;\u003c/code\u003eとなるね。\u003c/li\u003e\n\u003cli\u003eJSONのキー名をそのままクラスのプロパティ名にしたクラスを作っておけば後は勝手に変換してくれるよ。\u003c/li\u003e\n\u003cli\u003eあとこの実行は非同期だからnull参照して落ちないように戻り値用変数は\u003ccode\u003enew List\u0026lt;Author\u0026gt;\u003c/code\u003eで初期化しておく必要があるね。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(自分で試したときは一々別プロジェクト立ち上げるのが面倒だったので、同じプロジェクトにコントローラー追加した。なので呼び出しは↓みたいな感じに。)\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eProduct\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eProduct\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eHttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetFromJsonAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eProduct\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eNavigationManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUri\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Values\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003eあと取ったデータは\u003ccode\u003eauthirKust.OrderByDescending(auth =\u0026gt; auth.AuthorId).ToList\u0026lt;Author\u0026gt;();\u003c/code\u003eで降順に並べておこう。\u003c/li\u003e\n\u003cli\u003eそれじゃ実行してみよう。ちゃんとAPIで取ってきたデータを表示しているのがわかるね。\u003c/li\u003e\n\u003cli\u003e続いて値の設定に移ろう。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eSaveAuthor\u003c/code\u003e 関数のところでPOSTするようにするよ。(動画では\u003ccode\u003ePostAsJsonAsync\u003c/code\u003e使ってるけど、日本語含んでるとエンコードがうまくいかないのかエラーになるので\u003ccode\u003ePostAsync\u003c/code\u003e使わないとダメそう？あと、動画では書いてないけど、POSTの結果でJSONが返ってくる場合は\u003ccode\u003eReadFromJsonAsync\u003c/code\u003eで結果を読んでデシリアライズが一発できるみたい)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonSerializer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSerialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonSerializerOptions\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eEncoder\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJavaScriptEncoder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eUnicodeRanges\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAll\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringContent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"application/json\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eHttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePostAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eNavigationManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUri\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"api/Authors\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresponse\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReadFromJsonAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthor\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003e実行してみると正常にデータは更新されているはずなのに表示が更新されないのがわかるね。\u003c/li\u003e\n\u003cli\u003eこれはデータを取り直して \u003ccode\u003eStateHasChanged()\u003c/code\u003e で画面に対して更新通知を行っていないからだよ。\u003c/li\u003e\n\u003cli\u003ePOSTした後にデータを取り直して \u003ccode\u003eStateHasChanged()\u003c/code\u003e を呼んでみよう。\u003c/li\u003e\n\u003cli\u003e実行してみるとちゃんとデータが更新されることがわかるね。\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e次は削除と更新をしてみよう。\u003cbr\u003e\n(動画じゃ分けてるけどPUTとDELETEの違い程度なので一緒で。)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eまずは表の各行に「更新」と「削除」ボタンを付けるよ。\u003cbr\u003e\n(動画じゃHTMLタグにスタイル直書きしてるけどイマイチだなぁ…\u003cdel\u003eせっかくだしSCSS試してみるか。\u003c/del\u003eそれより先にBootstrap覚えよ)\u003cbr\u003e\n\u003ca href=\"http://www.tohoho-web.com/bootstrap/introduction.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eとほほのBootstrap 4入門\u003c/a\u003e\u003cbr\u003e\n(杜甫々さんのページ、HP作るのにHTML覚えた(1998年頃)以来に見るけどすごいコンテンツ増えてるなぁ)\u003cbr\u003e\n(Bootstrap使うのは\u003ca href=\"http://www.tohoho-web.com/bootstrap/tables.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eテーブル\u003c/a\u003eと\u003ca href=\"http://www.tohoho-web.com/bootstrap/buttons.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eボタン\u003c/a\u003eかなぁ。動画だとハイパーリンクだけどボタンにしとこ)\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;table\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"table table-striped\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;thead\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"thead-lignt\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;tr\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;th\u0026gt;\u003c/span\u003eID\u003cspan class=\"nt\"\u003e\u0026lt;/th\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;th\u0026gt;\u003c/span\u003eFirst name\u003cspan class=\"nt\"\u003e\u0026lt;/th\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;th\u0026gt;\u003c/span\u003eLast name\u003cspan class=\"nt\"\u003e\u0026lt;/th\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;th\u0026gt;\u003c/span\u003eCity\u003cspan class=\"nt\"\u003e\u0026lt;/th\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;th\u0026gt;\u003c/span\u003eEmail\u003cspan class=\"nt\"\u003e\u0026lt;/th\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;th\u0026gt;\u003c/span\u003e更新/削除\u003cspan class=\"nt\"\u003e\u0026lt;/th\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/tr\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/thead\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;tbody\u0026gt;\u003c/span\u003e\n        @foreach (var a in author_list)\n        {\n            \u003cspan class=\"nt\"\u003e\u0026lt;tr\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;td\u0026gt;\u003c/span\u003e\n                    @a.AuthorId\n                \u003cspan class=\"nt\"\u003e\u0026lt;/td\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;td\u0026gt;\u003c/span\u003e\n                    @a.FirstName\n                \u003cspan class=\"nt\"\u003e\u0026lt;/td\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;td\u0026gt;\u003c/span\u003e\n                    @a.LastName\n                \u003cspan class=\"nt\"\u003e\u0026lt;/td\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;td\u0026gt;\u003c/span\u003e\n                    @a.City\n                \u003cspan class=\"nt\"\u003e\u0026lt;/td\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;td\u0026gt;\u003c/span\u003e\n                    @a.EmailAddress\n                \u003cspan class=\"nt\"\u003e\u0026lt;/td\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;td\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"button\"\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"btn btn-outline-primary btn-sm\"\u003c/span\u003e \u003cspan class=\"na\"\u003erole=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"button\"\u003c/span\u003e \u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003eonclick=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"(() =\u0026gt; EditAuthor(a.AuthorId, author))\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eEdit\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e |\n                    \u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"button\"\u003c/span\u003e  \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"btn btn-outline-danger btn-sm\"\u003c/span\u003e \u003cspan class=\"na\"\u003erole=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"button\"\u003c/span\u003e \u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003eonclick=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"(() =\u0026gt; DeleteAuthor(a.AuthorId))\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eDelete\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;/td\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;/tr\u0026gt;\u003c/span\u003e\n        }\n    \u003cspan class=\"nt\"\u003e\u0026lt;/tbody\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/table\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003e続いて更新と削除のコードを書くよ。表示更新はどっちも同じなので関数化したよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e \u003cspan class=\"nf\"\u003eUpdateTable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eauthor_list\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eHttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetFromJsonAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthor\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eNavigationManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUri\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"api/Authors\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eStateHasChanged\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e \u003cspan class=\"nf\"\u003eEditAuthor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003e_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAuthor\u003c/span\u003e \u003cspan class=\"n\"\u003e_author\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003e_author\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthorId\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_id\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonSerializer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSerialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonSerializerOptions\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eEncoder\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJavaScriptEncoder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eUnicodeRanges\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAll\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eStringContent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"application/json\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eHttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePutAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eNavigationManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUri\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"api/Authors/\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003e_id\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsSuccessStatusCode\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//今は結果を返さないのでひとまずコメントアウト\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//var response = await ret.Content.ReadFromJsonAsync\u0026lt;Author\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"nf\"\u003eUpdateTable\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"n\"\u003eTask\u003c/span\u003e \u003cspan class=\"nf\"\u003eDeleteAuthor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003e_id\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eHttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDeleteAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eNavigationManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUri\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"api/Authors/\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003e_id\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"nf\"\u003eUpdateTable\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e(動画じゃ\u003ccode\u003eSaveAuthor\u003c/code\u003eにif文追加してPOSTとPut分岐してるな。しかも動作は「Edit」押したらフォームに値設定→Saveで更新　か、上記だとフォームに入力→Edit押したら更新になるな。けどまぁRESTの動き見るだけだからまぁいっか)\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep11認証すぐ使えるやつ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep11%E8%AA%8D%E8%A8%BC%E3%81%99%E3%81%90%E4%BD%BF%E3%81%88%E3%82%8B%E3%82%84%E3%81%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP11:認証(すぐ使えるやつ)\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e今回は簡単にすぐ使える認証について説明するよ。\u003c/li\u003e\n\u003cli\u003eBlazorのプロジェクトを作るときに認証オプションが表示されるやつの話だよ。\u003c/li\u003e\n\u003cli\u003e認証してユーザー情報をDBに保存するよ。\u003c/li\u003e\n\u003cli\u003eあと今回説明する認証方法の長所/短所の話もするよ。\u003c/li\u003e\n\u003cli\u003e他に作成時に設定しなかった場合に後から追加する話もするよ。\u003c/li\u003e\n\u003cli\u003eそれじゃ実際に作っていってみよう。\u003c/li\u003e\n\u003cli\u003eBlazorのプロジェクトを作るよ。プロジェクト名はOutOfBox(すぐ使える)にしようか。\u003c/li\u003e\n\u003cli\u003e「新しいBlazorアプリを作成します」の画面まで行くと右に「認証」っていう表示があってデフォルトは「認証なし」になってるね。\u003c/li\u003e\n\u003cli\u003eここで変更をクリックすると認証を選択できるよ。\u003c/li\u003e\n\u003cli\u003e「個別のユーザーアカウント」は自前でアプリの中にユーザーのDBを持つか、Azure AD B2Cを使う方式だよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e　　参考：\u003ca href=\"https://www.slideshare.net/ssuser18f2cf/aad-b2c\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAAD B2C使ってみた - slideshare\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e「職場または学校のアカウント」はオンプレのADかAzure ADを使う方式だよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e　(業務アプリ作るならAzure AD使う方式が重宝しそう。SAMLとかOpenID Connectにも対応してくれたらうれしいんだけどなぁ)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e「Windows認証」はIISの認証方式に従うやつだよ。\u003c/li\u003e\n\u003cli\u003e今回は「個別のユーザーアカウント」を選択して自前でアプリの中にユーザーのDBを作ってみよう。\u003c/li\u003e\n\u003cli\u003eまずは何も考えず動作を見てみよう。実行すると右上に「Log in(ログイン)」があるのでクリックしてみよう。\u003c/li\u003e\n\u003cli\u003e自動で生成されたRazorページが表示されるよ。\u003c/li\u003e\n\u003cli\u003eユーザーは誰も登録してないので「Register as a new user(新しいユーザーを登録する)」をクリックしよう。\u003c/li\u003e\n\u003cli\u003e実際に登録を実行してみると「DBを開くことができません」っていう例外が発生するね。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(パスワード要件(6文字以上、大文字小文字記号必須)がデフォルトで設定されてるのいいね)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eDBを構成する必要があるよ。\u003c/li\u003e\n\u003cli\u003eちなみにこの「個別のユーザーアカウント」認証ではEntryFrameworkを使ってSQL Serverにユーザー情報を格納しているよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e　(\u003cdel\u003e動画ではSQLServerって言ってるけど面倒だしSQLiteかなぁ\u003c/del\u003e)\u003cbr\u003e\n　(SQL Serverって言ってもVisual Studioと一緒にインストールしたような気がするLocalDBだから別途インストールする必要ない(※)のか)\u003cbr\u003e\n　※Visual Studioのインストールの時にオプション選んだかもしれないけど覚えてない\u003c/p\u003e\n\n\u003cp\u003e　参考：\u003cbr\u003e\n\u003ca href=\"https://qiita.com/miyamiya/items/1e8d847f225b3dc0281a\" id=\"reference-6b183b4786778f1f0d5f\"\u003eMicrosoftSQL Server 2016 Express LocalDB で気軽に DB を試す\u003c/a\u003e\u003cbr\u003e\n(Visual Studio 2017からSQL Server Express 2016 LocalDBを使ってみる)[\u003ca href=\"https://qiita.com/akabei/items/7f62056e44dd2d44f703\" class=\"autolink\" id=\"reference-0761953e3ec0c44b582d\"\u003ehttps://qiita.com/akabei/items/7f62056e44dd2d44f703\u003c/a\u003e]\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eこの画面の「Apply Migrations」をクリックすると「\u003cstrong\u003e00000000000000_CreateIdentitySchema.cs\u003c/strong\u003e」のコードが実行されてスキーマとかテーブルとかDBが全部作られるよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(ブラウザ翻訳便利。そういえば１から作るのにMigrations(=移住/移行)ってなんか違和感あるよね。コードからDBへの移行ってこと？)\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/c660446ee080ca382422f8f4c5108a31b9dd8fac/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f36353834322f36383736303161392d656164382d313735352d616533632d6237653330336565373731632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F65842%2F687601a9-ead8-1755-ae3c-b7e303ee771c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ae6f7c6ae4254483e7e6e1ad08448d1f\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/65842/687601a9-ead8-1755-ae3c-b7e303ee771c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F65842%2F687601a9-ead8-1755-ae3c-b7e303ee771c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bb4d055fcfc2449b288c1af1faaa6400 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eそれじゃ「Apply Migrations」をクリックして「Try refreshing the page」と表示されたらページを更新してみよう。ログインができた状態で初画面に移るね。いったんログアウトしてログインできるか見てみよう\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(うちの環境じゃ「Register confirmation(登録確認)」画面で「メール送れんかったよ、設定してね」みたいな表示になった。微妙なバージョンの違いかな？登録はできてるみたいでログインはできる)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eさっき登録したメールとパスワードを入力して「Log in」をクリックするとログインできて右上にメアドが表示されてるのがわかるね。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(何回かやってたらログイン失敗するようになった。ググってみたら「\u003cstrong\u003eStartup.cs\u003c/strong\u003e」の\u003ccode\u003eConfigureServices\u003c/code\u003e内の以下の\u003ccode\u003eoptions.SignIn.RequireConfirmedAccount\u003c/code\u003eを\u003ccode\u003efalse\u003c/code\u003eに設定してメールによる確認を無効にする必要があるとか)\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eStartup.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eservices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAddDefaultIdentity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIdentityUser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSignIn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequireConfirmedAccount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAddEntityFrameworkStores\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplicationDbContext\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e↓\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eStartup.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eservices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAddDefaultIdentity\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIdentityUser\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSignIn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequireConfirmedAccount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAddEntityFrameworkStores\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplicationDbContext\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003eこのログイン情報がどこに格納されてるか見てみよう。\u003c/li\u003e\n\u003cli\u003e「\u003cstrong\u003eappsettings.json\u003c/strong\u003e」に接続文字列が書かれていてSQL Server Express LocalDBにつながってるのがわかるね。\u003c/li\u003e\n\u003cli\u003eサーバーエクスプローラーでつなげてスキーマを見てみよう。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(SQL Serverオブジェクトエクスプローラーじゃなくて汎用性を考えてサーバーエクスプローラーを使うんやね)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eサーバーエクスプローラーで「データベースへの接続」をクリックして出てきたダイアログのサーバー名に「(localdb)\\mssqllocaldb」と入力するよ。コードの方からコピペするときはエスケープシーケンス表記になってるので気を付けてね。\u003c/li\u003e\n\u003cli\u003eDBはなんかGUIDがくっついたDBができてるのでそれを選ぶよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(このGUIDって↓と関係してるっぽいな。ソリューション内Grepかけたらcsprojのファイルの中の「UserSecretsId」ってやつと一致した)\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/aspnet/core/security/app-secrets?view=aspnetcore-5.0\u0026amp;tabs=windows\" rel=\"nofollow noopener\" target=\"_blank\"\u003eASP.NET Core での開発におけるアプリシークレットの安全な保存\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eAspnetUser\u003c/code\u003eっていうテーブルにユーザーが格納されてるよ。テーブルを右クリック→「テーブルデータの表示」から中身を見てみよう。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eUserName\u003c/code\u003eと\u003ccode\u003eEmail\u003c/code\u003eにメールアドレスが、パスワードに暗号化されたパスワードが入ってるのがわかるね。こんな感じで認証に必要な機能は一通りそろってるよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(暗号化って言ってるけどハッシュやんな？復号化出来たら危ないんやけど…)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eRole(役割)も設定できるから「ユーザーAは画面Xと画面Yが表示可能」「ユーザーBは画面Xのみ表示可能」とかもできるよ。\u003c/li\u003e\n\u003cli\u003eプロファイルページもあってそこで電話番号入れたりメアド変えたりパスワード変えたり２要素認証追加したりアカウント削除したりできるよ。\u003c/li\u003e\n\u003cli\u003e画面に戻ってみようログインしてない状態だと「Register(登録)」「Login」の二つがあるね。このエイリアスがどのコードと対応してるか探してみよう。\u003c/li\u003e\n\u003cli\u003eAreasフォルダの下にIdentityフォルダがあって、さらにその下にPagesフォルダがあるんだけど、ここにあるのは二つしかないね。\u003c/li\u003e\n\u003cli\u003e登録画面とかプロファイル管理画面が何故ないかというと、これらの画面は\u003ccode\u003eMicrosoft.AspNetCor.Identity.UI\u003c/code\u003eに含まれてるからで、プロジェクトごとに追加したりする必要はないからだよ。独自のページを作ることもできるよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(詳しくは書いてないけど、「Identity」フォルダ右クリック→追加→新規スキャフォールディングアイテム→ID、で登録できるみたい)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e次は実際にどんな風にユーザー認証してるのかを見てみよう。まずは「\u003cstrong\u003eStartup.cs\u003c/strong\u003e」から。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eConfigure\u003c/code\u003eメソッドの中で、\u003ccode\u003eapp.UseRouting()\u003c/code\u003eの後に\u003ccode\u003eapp.UseAuthentication()\u003c/code\u003eと\u003ccode\u003eapp.UseAuthorization()\u003c/code\u003eを呼んでるね。\u003c/li\u003e\n\u003cli\u003e今回はプロジェクト作成時に認証ありで作成したから最初からあるけど、後から認証を追加する場合は自分で追加しないといけないよ。\u003c/li\u003e\n\u003cli\u003e認証の処理とかを実際に行ってるオブジェクトがどれかというと\u003ccode\u003eConfigureServices\u003c/code\u003eの中で\u003ccode\u003eAddScoped\u003c/code\u003eで追加されてる\u003ccode\u003eAuthenticationStateProvider\u003c/code\u003eから派生した\u003ccode\u003eRevalidatingIdentityAuthenticationStateProvider\u0026lt;IdentityUser\u0026gt;\u003c/code\u003eだよ。\u003c/li\u003e\n\u003cli\u003eこのオブジェクトで認証されてるかどうかとか状態を保持してるよ。\u003c/li\u003e\n\u003cli\u003e実装である\u003ccode\u003eRevalidatingIdentityAuthenticationStateProvider\u003c/code\u003eの定義を見てみよう。\u003c/li\u003e\n\u003cli\u003eメソッド\u003ccode\u003eValidateAuthenticationStateAsync\u003c/code\u003e内で認証状態を検証してるよ。この中で呼ばれてる\u003ccode\u003eValidateSecurityStampAsync\u003c/code\u003eの中で\u003ccode\u003eGetUserAsync\u003c/code\u003eを呼んでユーザー情報を取得してるよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(この辺の説明、自動翻訳だとメソッド名まで翻訳するから訳見ても意味が通らん…。この辺りは飛ばして、細かい仕組みの面は↓見てまた今度勉強しよ)\u003cbr\u003e\n(CascadingAuthenticationState(数珠繋ぎの認証状態)って何やろ？)\u003c/p\u003e\n\n\u003cp\u003e(ASP.NET Core Blazor の認証と承認)[\u003ca href=\"https://docs.microsoft.com/ja-jp/aspnet/core/blazor/security/?view=aspnetcore-5.0\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/aspnet/core/blazor/security/?view=aspnetcore-5.0\u003c/a\u003e]\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e次に、画面の動きを見てみよう。ログインしてない状態ではRegisterとLoginが、ログインするとメールアドレスとLogoutが表示されるね。\u003c/li\u003e\n\u003cli\u003eこれがどのように実装されているか「\u003cstrong\u003eMainLayout.razor\u003c/strong\u003e」を見てみよう。「About」の上に\u003ccode\u003eLoginDisplay\u003c/code\u003eっていうRazorコンポーネントを呼んでるのが見て取れるね。\u003c/li\u003e\n\u003cli\u003eそれじゃ「\u003cstrong\u003eLoginDisplay.razor\u003c/strong\u003e」を見てみよう。ここには３つの重要なコンポーネントが書かれてるよ。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eAuthorizeView\u003c/code\u003eと\u003ccode\u003eAuthorized\u003c/code\u003eと\u003ccode\u003eNotAuthorized\u003c/code\u003eだね。これは直感的にもわかると思うけど認証済みならAuthorizedの中身を表示、認証していないならNotAuthorizedの中身を表示っていう動きになるよ。\u003c/li\u003e\n\u003cli\u003eここには書かれてないけど\u003ccode\u003eAuthorizing\u003c/code\u003eって言うのもあるよ。認証に時間がかかる場合に使うといいよ。\u003c/li\u003e\n\u003cli\u003eそれじゃ今回説明した認証の長所と短所をまとめてみよう。\u003c/li\u003e\n\u003cli\u003e長所は「セットアップが簡単(プロジェクト作成時に選択するだけ)」「小さいプロジェクトに向いてる」「DBの設計がいらない」「登録とかログインがすぐ使える」だね。\u003c/li\u003e\n\u003cli\u003e短所は「EntryFrameworkが必須」「APIを利用した設計ができない(データアクセスをAPIにしようとしたとき、APIの認証として使えない)」「古いrazorページを使う(cshtmlのこと？)」「既に存在するユーザーDBからの移行が難しい」だね。\u003c/li\u003e\n\u003cli\u003e次のエピソードでこれらの短所をカバーする方法を紹介するよ。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep12authentication--customauthenticationstateprovider\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep12authentication--customauthenticationstateprovider\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP12:Authentication | CustomAuthenticationStateProvider\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eこのエピソードではCustomAuthenticationStateProviderについて説明するよ。\u003c/li\u003e\n\u003cli\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep13layouts--login-pages\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep13layouts--login-pages\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP13:Layouts | Login Pages\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep14httpclient--login-user\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep14httpclient--login-user\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP14:HttpClient | Login User\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep15ihttpclientfactory--login-user\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep15ihttpclientfactory--login-user\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP15:IHttpClientFactory | Login User\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep16sending-jwt-token--building-request-middleware\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep16sending-jwt-token--building-request-middleware\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP16:Sending JWT token \u0026amp; Building Request Middleware\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep17register-user--generate-jwt\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep17register-user--generate-jwt\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP17:Register User \u0026amp; Generate JWT\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep18role-based-authorization\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep18role-based-authorization\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP18:Role-based Authorization\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep19policy-based-authorization\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep19policy-based-authorization\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP19:Policy-based Authorization\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep20procedural-logic--authentication--authorization-in-c\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep20procedural-logic--authentication--authorization-in-c\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP20:Procedural Logic | Authentication \u0026amp; Authorization in C\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep21templated-components--html-table\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep21templated-components--html-table\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP21:Templated Components | Html Table\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep22razor-components--eventcallback\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep22razor-components--eventcallback\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP22:Razor Components | EventCallback\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep23event-handling\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep23event-handling\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP23:Event Handling\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep24gridview-header-filter\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep24gridview-header-filter\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP24:GridView Header Filter\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep25gridview-paging\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep25gridview-paging\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP25:Gridview Paging\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep26spinner-or-activity-indicator--ep26\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep26spinner-or-activity-indicator--ep26\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP26:Spinner or Activity Indicator : EP26\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep27code-faster-using-dotnet-watch-run\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep27code-faster-using-dotnet-watch-run\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP27:Code Faster Using dotnet watch run\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep28deploy-to-iis\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep28deploy-to-iis\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP28:Deploy to IIS\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep29deploy-to-azure-app-services\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep29deploy-to-azure-app-services\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP29:Deploy to Azure App Services\u003c/h1\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ep30handling-exceptions\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ep30handling-exceptions\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEP30:Handling Exceptions\u003c/h1\u003e\n","createdAt":"2021-01-09T02:58:48Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"I1/kCaYLif1/L/tpvCL1h4XGZ8MfuK1kVA==--Q6uaj8++y9Y8wI51--uWQbbsCrZL/l/J3znx3utQ==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2021-03-07T07:12:51Z","likesCount":0,"linkUrl":"https://qiita.com/NAVE/items/e3831c73adaaf56211e2","organization":null,"originalId":1374714,"stockedCount":1,"title":"Blazor Tutorialまとめ(番外×2 + EP10～)","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%95%AA%E5%A4%96rest-api%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9\"\u003e番外①:REST APIの作り方\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%95%AA%E5%A4%96entityframeworkcore\"\u003e番外②:EntityFrameworkCore\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep10rest-api%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97\"\u003eEP10:REST APIの呼び出し\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep11%E8%AA%8D%E8%A8%BC%E3%81%99%E3%81%90%E4%BD%BF%E3%81%88%E3%82%8B%E3%82%84%E3%81%A4\"\u003eEP11:認証(すぐ使えるやつ)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep12authentication--customauthenticationstateprovider\"\u003eEP12:Authentication | CustomAuthenticationStateProvider\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep13layouts--login-pages\"\u003eEP13:Layouts | Login Pages\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep14httpclient--login-user\"\u003eEP14:HttpClient | Login User\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep15ihttpclientfactory--login-user\"\u003eEP15:IHttpClientFactory | Login User\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep16sending-jwt-token--building-request-middleware\"\u003eEP16:Sending JWT token \u0026amp; Building Request Middleware\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep17register-user--generate-jwt\"\u003eEP17:Register User \u0026amp; Generate JWT\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep18role-based-authorization\"\u003eEP18:Role-based Authorization\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep19policy-based-authorization\"\u003eEP19:Policy-based Authorization\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep20procedural-logic--authentication--authorization-in-c\"\u003eEP20:Procedural Logic | Authentication \u0026amp; Authorization in C\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep21templated-components--html-table\"\u003eEP21:Templated Components | Html Table\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep22razor-components--eventcallback\"\u003eEP22:Razor Components | EventCallback\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep23event-handling\"\u003eEP23:Event Handling\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep24gridview-header-filter\"\u003eEP24:GridView Header Filter\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep25gridview-paging\"\u003eEP25:Gridview Paging\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep26spinner-or-activity-indicator--ep26\"\u003eEP26:Spinner or Activity Indicator : EP26\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep27code-faster-using-dotnet-watch-run\"\u003eEP27:Code Faster Using dotnet watch run\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep28deploy-to-iis\"\u003eEP28:Deploy to IIS\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep29deploy-to-azure-app-services\"\u003eEP29:Deploy to Azure App Services\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ep30handling-exceptions\"\u003eEP30:Handling Exceptions\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":1381,"uuid":"e3831c73adaaf56211e2","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"Ie9S5gcWlSrqtMcn/gYxOhiP1wE=--BjiqWpnemCQWY3F2--K4GFuPcSYSfCXG3GaEZK2g==","originalId":65842,"description":"","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"NAVE NAVE","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/65842/profile-images/1473697011","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65842%2Fprofile-images%2F1473697011?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=9dbe547aacb61358726808f696e1447a","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65842%2Fprofile-images%2F1473697011?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=145fb26db3907978141d316a5648c29e","urlName":"NAVE","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Razor","urlName":"razor"},{"name":"Blazor","urlName":"blazor"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
