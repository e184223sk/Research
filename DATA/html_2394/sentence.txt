記事を書いたものの、Vista以降は別の方法(AddClipboardFormatListener)のほうが安定する（チェイン管理をOSがやってくれる）ようである。
クリップボードの監視
→   https://gist.github.com/unarist/6342758  が参考になりそう。Windows APIであるSetClipboardViewerとChangeClipboardChainを使ってクリップボード監視チェインへの登録・削除をし、
WindowメッセージWM_DRAWCLIPBOARDとWM_CHANGECBCHAINを処理して、クリップボードの変更通知受け取りと、チェインの維持を行う。
キーボードフックとかに近い構造のようだが、チェインの維持をしないといけない点が異なる。※チェインに登録されているアプリが強制終了とかで後処理せずに終了すると不安定になると思われるため、本記事の冒頭で言及しているAddClipboardFormatListenerを使う方法をおすすめします。参考サイトの1つ目をベースに作成。1 
文字列をクリップボードにコピーするたびに、コンソールにその文字列を出力します。試してみたところでは、SetClipboardViewerに登録すると、ユーザーがクリップボードにコピーする操作をしていなくても、クリップボードの更新通知(WM_DRAWCLIPBOARD)が来るようである。そのままだと64bit環境でハマる可能性あり。IntPtrをintにキャストして0と比較しているとこは、intキャストをやめてIntPtr.Zeroとの比較に修正した。 ↩


