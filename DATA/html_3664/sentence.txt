More than 1 year has passed since last update.概要(MS-DOC)によると、HTTP.sys というアプリ(カーネルモードドライバ)を利用し、HTTPパケットの送受信を行うクラス。
HTTP.sys がSSL通信、HTTP接続の管理、HTTPヘッダの解析を行ってくれる。
API(MS-DOC)より、SSL証明書の追加には netsh コマンドを用いる必要がある。
WebSocket に関しては、Windows 8 以降では対応している。1.HTTP.sys にサーバURLを登録
  サーバアプリを管理者権限で実行するなら必要ないが、一般ユーザで実行する場合はあらかじめHTTP.sysが監視するURLを登録しておく必要がある。
コマンドプロンプトから netsh コマンドを実行することになるが、コマンドプロンプトの起動は管理者として行うこと。
登録するURLは HttpListener.Prefixes.Add() に渡した値でよい。2.ファイアーウォールに HTTP.sys を許可
  コントロールパネルの「Windows ファイアーウォール」&gt;「詳細設定」&gt;「受信の規則」に「新しい規則」を追加する。
新しい規則は system プログラムを許可するような規則とする。3.HTTP.sys にサーバ証明書とURLの関連を登録
  管理者として起動したコマンドプロンプトから netsh コマンドを実行する。
サーバ証明書はあらかじめ登録しておく。pfx ファイルをエクスプローラから実行すればよい。その際、「保存場所」は「ローカルコンピュータ」にしておくこと。
その後、サーバ証明書の拇印を確認するため、mmc を起動し、スナップインに証明書を追加し、「証明書(ローカルコンピュータ)」&gt;「個人」&gt;「証明書」に表示される証明書を選択し、拇印を確認する。
URLは ワイルドカードが使えないので、具体的に指定する。
GUID も必要になるが、なんでもよい。Get の確認方法
ブラウザで https://127.0.0.1:44300 にアクセスし、応答を確認するWebSocket の確認方法
ブラウザで https://www.websocket.org/echo.html にアクセスし、「Location」に 「wss://127.0.0.1:44300」を入力後、「Connect」を押下し、「Log」を確認する


