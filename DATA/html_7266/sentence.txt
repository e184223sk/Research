More than 5 years have passed since last update.例えば、以下のような構造体（値型）をこさえたとして、コレを、dynamic経由で取り回したときどうなるかというのが今回のお題。
最後までおつきあい頂ければこれ幸いナリ。コレは割と直感的な結果になると思う。
以下のようなコードを書いたとする。この場合、コメントに記載したとおりの出力となる。
このようになる理由は、dynamic DynamA=val;及びdynamic DynamB=val;は、共々Valのコピーをボクシングしているので、片方のValueを動かしてももう片方が影響を受けることは無い。こちらは若干直感的ではないかも知れない。同様にコードを書いていこうこの場合、dynamAのValueに新たな値を代入した場合、dynamBも同様に値が変更されている。
これは、元がobject型なので、ボクシングが最初から行われており、そのボクシングされた結果の参照先をdynamAとdynamBが参照することになるので、参照型のような振る舞いをすることになる。
また、このことからdynamic型の動的呼び出しは外から観測する限り、ボクシングしたまま値型の内部状態を変更可能であると言うことになると思う。参考まで、下記のようなコードもobject経由の代入と同じ挙動をとる。代入の差異が挙動に直結するので、このようなことをする際は若干注意が必要かと思いまとめてみました。
特に、object経由の場合は、一般的な値型の振る舞いと異なり、参照型のそれに近い形になるので、意図的に使う場合は別として、注意をしなければならないと考えます。


