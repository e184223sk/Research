More than 1 year has passed since last update.過去の資産に縛られたWindowsForms開発をしております。
しかし過去の資産の余りにも・・・。な姿に涙目です。
.NET 4.0、C#4.0縛りです。少しでも見通しを良くしたいと思い、
MVVMパターンの導入を検討しました。試しにやってみたら.NET 4.0だと結構躓きましたので記録。「Windows Forms で MVVM」を参考にしたのですが、.NET 4.0縛りの私の環境ではそのままでは使えませんでした。.NETのRx周りはStandard2.0以降で開花した為か、それ以前の環境ではそのままでは上手く実装できません。とりあえずここで自作されているFormsMvvmをビルドする最低限のパッケージは以下で導入できました。nugetパッケージマネージャコンソールにてこれによって導入されるパッケージは以下でした。2018/12/4時点ではMicrosoft.Bclは最新版のVersion1.1.10で導入されました。
よってバージョン指定はしていません。一緒に入ってくるMicrosoft.Bcl.Build は 1.0.14が導入されましたが、
2018/12/4時点で1.0.21が公開されていますので、場合によってはこれも手動でアップデートする必要が有るかもしれません。.NET 4.0で Rxに手を出そうとすると Rx-Main Version 2.2.5というのが肝のようです。Rx-MainはGUIのnuget管理Iから検索すると見つかりません。
https://stackoverflow.com/questions/40004669/system-reactive-rx-net-4-0-on-nuget「Windows Forms で MVVM 2 (ReactiveProperty 編)」を参考にReactivePropertyを使おうとすると、最新版(5.3.0)は同様に.NET 4.0では導入できません。
2.9.0以下でエラー無く導入できました。後述するエラーに悩まされた結果、
更にが発生しました。変更したコードの部分でと怒られます。この記述ではラムダ式の左辺が()なので引数0を示していますが、
Subscribeはobjectを引数に取ることを要求しています。
よって上記のエラーが吐かれてます。
ラムダ式を良く分かってなかった私はこれが良く分からずうろうろしてしまいました。因みにこのobjectはUpCommand.Execute(object)で渡せますが、
引数を使いたい場合はUpCommandの型を指定するべきでしょう。の様に。ラムダ式の左辺を()から_に変えたところまたエラーが。メッセージに従い、PresentationCoreの参照を追加してみます。これでやっとコンパイルが通ります。


