<!DOCTYPE html><html><head><meta charset="utf-8" /><title>【Unity】【AssetBundle】Unity2017~Unity2018.1 のためのAssetBundle システム構築方法 (2018/09/19追記) - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/Cova8bitdot/items/20e8962ed0ca0544289d" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="KVeRtfQyTD+n97HrOKAbSHhA1JFXAmVBOlOMSCGllT459SGY+TsH7CzKRzYPXBufQjRQ5NA5OwG3x+rL61C9sg==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@8bitdots" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="【Unity】【AssetBundle】Unity2017~Unity2018.1 のためのAssetBundle システム構築方法 (2018/09/19追記) - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRVlc1cGRIbmpnSkhqZ0pCQmMzTmxkRUoxYm1Sc1plT0FrVlZ1YVhSNU1qQXhOMzVWYm1sMGVUSXdNVGd1TVNEamdhN2pnWl9qZ29IamdhNUJjM05sZEVKMWJtUnNaU0RqZ3JmamdybmpnNGJqZzZEbXA0dm5yNG5tbHJubXM1VWdLREl3TVRndk1Ea3ZNVG5vdjczb3FKZ3AmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ODgzMTUzYmZkMGI1M2Y5NjhiOTI2ZDVkMTlkMDA4NmE&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRU52ZG1FNFltbDBaRzkwJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9OTQ3ZTIyZTU1NjU5MTQwZGQxYTRmZTY1NTllZGEzN2U&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=e8ddd60401d6f07da04e5633cf28c2fe"><meta property="og:description" content="

はじめに


この記事は主にUnity2017.1 ~ Unity2018.1 向けの話になります。
内容としては初級者〜中級者レベルで、AssetBundle の仕組みを作らなければならない人向けです。
他のバージョンは様々な記..."><meta content="https://qiita.com/Cova8bitdot/items/20e8962ed0ca0544289d" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="Python,C#,Unity,YAML,AssetBundle" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-ff5c47f1-2242-45c3-bad6-8d254818de5e"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FCova8bitdot%2Fitems%2F20e8962ed0ca0544289d">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FCova8bitdot%2Fitems%2F20e8962ed0ca0544289d">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-ff5c47f1-2242-45c3-bad6-8d254818de5e">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/python","name":"Python"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-09-16T18:48:10.000+09:00","dateModified":"2018-09-19T21:12:45.000+09:00","headline":"【Unity】【AssetBundle】Unity2017~Unity2018.1 のためのAssetBundle システム構築方法 (2018/09/19追記)","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRVlc1cGRIbmpnSkhqZ0pCQmMzTmxkRUoxYm1Sc1plT0FrVlZ1YVhSNU1qQXhOMzVWYm1sMGVUSXdNVGd1TVNEamdhN2pnWl9qZ29IamdhNUJjM05sZEVKMWJtUnNaU0RqZ3JmamdybmpnNGJqZzZEbXA0dm5yNG5tbHJubXM1VWdLREl3TVRndk1Ea3ZNVG5vdjczb3FKZ3AmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ODgzMTUzYmZkMGI1M2Y5NjhiOTI2ZDVkMTlkMDA4NmE\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRU52ZG1FNFltbDBaRzkwJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9OTQ3ZTIyZTU1NjU5MTQwZGQxYTRmZTY1NTllZGEzN2U\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=e8ddd60401d6f07da04e5633cf28c2fe","mainEntityOfPage":"https://qiita.com/Cova8bitdot/items/20e8962ed0ca0544289d","author":{"@type":"Person","address":null,"email":null,"identifier":"Cova8bitdot","name":"Cova8bitdot","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2Fprofile-images%2F1524148529?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=5e90c37c2fc83f3d18613c5f27484e28","url":"https://qiita.com/Cova8bitdot","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Cova8bitdot","type":"items","id":"20e8962ed0ca0544289d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Cova8bitdot","type":"items","id":"20e8962ed0ca0544289d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Cova8bitdot","type":"items","id":"20e8962ed0ca0544289d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/Cova8bitdot/items/20e8962ed0ca0544289d","location":"/Cova8bitdot/items/20e8962ed0ca0544289d","scheme":"https","host":"qiita.com","port":null,"pathname":"/Cova8bitdot/items/20e8962ed0ca0544289d","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"U24VqzwgXS8vrvQRpRbLbf+vnsOEQBuGdwzUuvx1qD1DzKWGMSkW/KSTAsyS6su6xdsatgN7Rcb6mLI5NoCAsQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-90e03e85-cea5-4f57-85c8-705beca1d08c"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/likers" class="css-1iupg5d">66</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">67</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/20e8962ed0ca0544289d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Cova8bitdot/items/20e8962ed0ca0544289d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/Cova8bitdot"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/65257/profile-images/1524148529" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/Cova8bitdot" class="css-10ougpm">@<!-- -->Cova8bitdot</a><div class="css-1ay9vb9"><span><meta content="2018-09-16T09:48:10Z"/><time dateTime="2018-09-19T12:12:45Z" class="css-m19uds">updated at 2018-09-19</time></span></div></div></div></div></div><h1 class="css-cgzq40">【Unity】【AssetBundle】Unity2017~Unity2018.1 のためのAssetBundle システム構築方法 (2018/09/19追記)</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/python" class="css-4czcte">Python</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/yaml" class="css-4czcte">YAML</a><a href="/tags/assetbundle" class="css-4czcte">AssetBundle</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<ul>
<li>この記事は主にUnity2017.1 ~ Unity2018.1 向けの話になります。</li>
<li>内容としては初級者〜中級者レベルで、AssetBundle の仕組みを作らなければならない人向けです。</li>
<li>他のバージョンは様々な記事があるので参考リンクに記載してあるページを見ていただければと思います。</li>
<li>コードについてはダミーコードを載せているので、コピペしただけでは動かないと思います。</li>
</ul>

<h2>
<span id="用語" class="fragment"></span><a href="#%E7%94%A8%E8%AA%9E"><i class="fa fa-link"></i></a>用語</h2>

<table>
<thead>
<tr>
<th style="text-align: center">用語</th>
<th style="text-align: left">意味</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center">Asset(アセット)</td>
<td style="text-align: left">訳すと資産。Prefab,Animation,Texture,AudioClip,Scene などのゲームで用いるリソース全般を指す言葉</td>
</tr>
<tr>
<td style="text-align: center">AssetBundle</td>
<td style="text-align: left">複数のAssetをパッキングしてまとめたもの。複数存在可能</td>
</tr>
<tr>
<td style="text-align: center">AssetBundleBrowser</td>
<td style="text-align: left">Unity謹製AssetBundle管理ツール。後述で説明します</td>
</tr>
<tr>
<td style="text-align: center">AssetBundleManifest</td>
<td style="text-align: left">AssetBundleのバージョンや名前、依存関係などをまとめたYAML( or バイナリ) ファイル。AssetBundleと一緒に自動生成される</td>
</tr>
<tr>
<td style="text-align: center">ビルド</td>
<td style="text-align: left">AssetBundleを作ること。APIこそ公式であるがツールはないので大抵は自作する</td>
</tr>
</tbody>
</table>

<h1>
<span id="assetbundle-とは" class="fragment"></span><a href="#assetbundle-%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>AssetBundle とは</h1>

<p>ざっくりと説明すると「アプリ外部から素材などをダウンロード〜ロードする仕組み」+「ロードする素材群をパック（まとめる）するための仕組み」です。</p>

<h2>
<span id="メリット" class="fragment"></span><a href="#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88"><i class="fa fa-link"></i></a>メリット</h2>

<p>アプリ内部に一部リソースを持たなくていいため</p>

<ul>
<li>アプリのサイズを抑えることができる

<ul>
<li>モバイルアプリだと各プラットフォームで3G/4G回線でDL出来るアプリのサイズ制限がある（Apple:150MB, GooglePlay:100MB)</li>
<li>ユーザーとしてはDLしやすくなるためDL数が伸びやすい</li>
<li>動画やボイスなど重いファイルは必要な時にDLする仕組みに出来る</li>
</ul>
</li>
<li>サーバーにAssetBundleを置くことができる

<ul>
<li>アプリ申請なしにリソースの更新が可能

<ul>
<li>アプリ内イベントなどのリソース追加が容易</li>
<li>見た目修正程度であれば、AssetBundleを更新して、ユーザーに最新のものをDLしてもらえればすぐ治る</li>
</ul>
</li>
<li>（アプリの作りによるが）必要な時に必要なもののみDLできる</li>
<li>リソースのバージョン管理も行える</li>
</ul>
</li>
</ul>

<h1>
<span id="assetbundle-の仕組みの導入" class="fragment"></span><a href="#assetbundle-%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF%E3%81%AE%E5%B0%8E%E5%85%A5"><i class="fa fa-link"></i></a>AssetBundle の仕組みの導入</h1>

<h2>
<span id="楽したい方へ" class="fragment"></span><a href="#%E6%A5%BD%E3%81%97%E3%81%9F%E3%81%84%E6%96%B9%E3%81%B8"><i class="fa fa-link"></i></a>楽したい方へ</h2>

<ul>
<li>もし極力コードを書きたくないという方は既存のパッケージの利用をオススメします。
<a href="/neon-izm" class="user-mention js-hovercard" title="neon-izm" data-hovercard-target-type="user" data-hovercard-target-name="neon-izm">@neon-izm</a>　さんが紹介しているコチラなどを参考にしてもらうと良いと思います。
<a href="https://qiita.com/neon-izm/items/b105130fac060ec40ad4" class="autolink" id="reference-321e8ff4ad961f785916">https://qiita.com/neon-izm/items/b105130fac060ec40ad4</a>
</li>
<li>ちなみにAutoyaの導入も考えましたがUnityAdsが必要だったりしたので辞めました</li>
<li>Unity謹製AssetBundleManagerは5.X系以降はあまりメンテされてなかったのでオススメしません。ただ、コードを書く時の参考に利用するのはありだと思います</li>
</ul>

<p>なんらかの事情でパッケージ導入がダメな人はここから一緒に頑張りましょう（悲しみ）</p>

<h2>
<span id="機能の確認" class="fragment"></span><a href="#%E6%A9%9F%E8%83%BD%E3%81%AE%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>機能の確認</h2>

<p>AssetBundleで最低限必要なこととしては</p>

<ul>
<li>AssetBundle のDownload処理</li>
<li>AssetBundle のローカルキャッシュへSave/Load 処理</li>
<li>AssetBundle のLoad/Unload 処理</li>
<li>AssetBundle のビルド処理</li>
<li>シミュレーションモードの実装</li>
</ul>

<p>だと思います。</p>

<p>AssetBundle のDownload ~ Unload までの流れはCEDECの講演でとてもわかりやすく解説されているのでぜひ見て見てください。<br>
<a href="https://creator.game.cyberagent.co.jp/?p=4791" class="autolink" rel="nofollow noopener" target="_blank">https://creator.game.cyberagent.co.jp/?p=4791</a></p>

<p>これらが出来た上で実装したい項目としては</p>

<ul>
<li>AssetBundle の暗号化</li>
<li>AssetBundle のバージョン管理</li>
</ul>

<p>あたりが候補として上がってくると思います。</p>

<h2>
<span id="ワークフロー" class="fragment"></span><a href="#%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%95%E3%83%AD%E3%83%BC"><i class="fa fa-link"></i></a>ワークフロー</h2>

<p>最低限必要な「Download」「Cache管理」「Load」を踏まえると、フローとしては以下のような感じになります。<br>
<a href="https://camo.qiitausercontent.com/ebdab12be5f434d81c4508c1ab4e8910d6937ea8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36353235372f38306561306665362d323232312d613066652d376539342d3332656666323836306439322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F80ea0fe6-2221-a0fe-7e94-32eff2860d92.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a18d864e2282491ed63e4a64a321430f" alt="AssetBundleFlow (1).png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/65257/80ea0fe6-2221-a0fe-7e94-32eff2860d92.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F80ea0fe6-2221-a0fe-7e94-32eff2860d92.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5e988871e106e43cd8d9da8272dab560 1x" loading="lazy"></a></p>

<h3>
<span id="download処理" class="fragment"></span><a href="#download%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>Download処理</h3>

<p>Downloadといっても「ManifestのDownload」と「AssetBundleのDownload」とでは少し話（やコード）が変わってくるので順を追って説明していきます。</p>

<h4>
<span id="assetbundlemanifestのdownload" class="fragment"></span><a href="#assetbundlemanifest%E3%81%AEdownload"><i class="fa fa-link"></i></a>AssetBundleManifestのDownload</h4>

<p>AssetBundleを使うためにも、その情報が記載されているManifestが無いと始まりません。<br>
Manifestに関しては特に制約とかが無いのでUnityWebRequest.GetAssetBundle()　でとってくればOKです。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">AssetBundleDownloader.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.Networking</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">TIME_OUT</span> <span class="p">=</span> <span class="m">60</span><span class="p">;</span> <span class="c1">//[sec]</span>

<span class="k">public</span> <span class="k">delegate</span> <span class="k">void</span> <span class="nf">OnCompleteDownloadManifest</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">_isSucceeded</span><span class="p">,</span> <span class="n">AssetBundle</span> <span class="n">_bundle</span><span class="p">);</span>

<span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">DoDownloadManifest</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_manifestName</span><span class="p">,</span> <span class="n">OnCompleteDownloadManifest</span> <span class="n">_onComplete</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Validation</span>
    <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">_manifestName</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_onComplete</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span> <span class="k">false</span><span class="p">,</span> <span class="k">null</span> <span class="p">);</span>
        <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// uri とありますがurl と認識してもらって差し支えないです</span>
    <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">$"</span><span class="p">{</span><span class="n">AssetManager</span><span class="p">.</span><span class="n">I</span><span class="p">.</span><span class="nf">GetServerUrl</span><span class="p">()}</span><span class="s">/</span><span class="p">{</span><span class="n">_manifestName</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>

    <span class="c1">// GetAssetBundle 関数ではcrcやhash128 を指定するものがありますが、</span>
    <span class="c1">// 基本的にManifestファイルはキャッシュに保存せずオンメモリで扱うことが多い</span>
    <span class="c1">// &amp; サーバー側からもらったバージョン(int やhash値)を見て必要になって</span>
<span class="err">　　　　　　　　</span><span class="c1">//   これを叩いているはずなのであえて指定していません</span>
    <span class="err">#</span><span class="k">if</span> <span class="n">UNITY2018_OR_NEWER</span>
    <span class="c1">// なんでバージョンによってAPI名というかクラス名すら変わるかなぁ...(運用で困る)</span>
    <span class="n">UnityWebRequestAssetBundle</span> <span class="n">webRequest</span> <span class="p">=</span> <span class="n">UnityWebRequestAssetBundle</span><span class="p">.</span><span class="nf">GetAssetBundle</span><span class="p">(</span> <span class="n">uri</span><span class="p">:</span><span class="n">uri</span><span class="p">);</span>
    <span class="err">#</span><span class="k">else</span>
    <span class="n">UnityWebRequest</span> <span class="n">webRequest</span> <span class="p">=</span> <span class="n">UnityWebRequest</span><span class="p">.</span><span class="nf">GetAssetBundle</span><span class="p">(</span> <span class="n">uri</span><span class="p">:</span><span class="n">uri</span><span class="p">);</span>
    <span class="err">#</span><span class="n">endif</span>

    <span class="n">webRequest</span><span class="p">.</span><span class="n">timeout</span> <span class="p">=</span> <span class="n">TIME_OUT</span><span class="p">;</span>
    <span class="c1">// DL 開始 &amp; 終了待機</span>
    <span class="err">#</span><span class="k">if</span> <span class="n">UNITY_2017_3_OR_NEWER</span>
    <span class="k">yield</span> <span class="k">return</span> <span class="n">webRequest</span><span class="p">.</span><span class="nf">SendWebRequest</span><span class="p">();</span>
    <span class="err">#</span><span class="k">else</span>
    <span class="k">yield</span> <span class="k">return</span> <span class="n">webRequest</span><span class="p">.</span><span class="nf">Send</span><span class="p">();</span>
    <span class="err">#</span><span class="n">endif</span>


    <span class="kt">bool</span> <span class="n">isSucceeded</span> <span class="p">=</span> <span class="p">(</span> <span class="p">!</span> <span class="n">webRequest</span><span class="p">.</span><span class="n">isHttpError</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">webRequest</span><span class="p">.</span><span class="n">isNetworkError</span><span class="p">);</span>
    <span class="n">_onComplete</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span> <span class="n">isSucceeded</span><span class="p">,</span> <span class="n">DownloadHandlerAssetBundle</span><span class="p">.</span><span class="nf">GetContent</span><span class="p">(</span><span class="n">webRequest</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>

</code></pre></div>
</div>

<p>一方AssetBundleに関してはこんな感じ</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">AssetBundleDownloader.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">delegate</span> <span class="n">IEnumerator</span> <span class="nf">OnCompleteDownloadEachBundle</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_bundleName</span><span class="p">,</span> <span class="n">Hash128</span> <span class="n">_bundleHash</span><span class="p">);</span>
<span class="k">public</span> <span class="k">delegate</span> <span class="k">void</span> <span class="nf">OnCompleteDownloadAllBundle</span><span class="p">(</span> <span class="kt">int</span> <span class="n">_isSucceededCount</span><span class="p">,</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">_failedList</span><span class="p">);</span> 
<span class="k">public</span> <span class="k">class</span> <span class="nc">DownloadRequestParam</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">AssetName</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">Hash128</span> <span class="n">AssetHash</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">OnCompleteDownloadEachBundle</span> <span class="n">OnCompleteDownload</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">DoDownloadAssetBundles</span><span class="p">(</span> <span class="n">DownloadRequestParam</span><span class="p">[]</span> <span class="n">_reqParams</span><span class="p">,</span> <span class="n">OnCompleteDownloadAllBundle</span> <span class="n">_onAllComplete</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// DL 対象が無い</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">_reqParams</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="n">_reqParams</span><span class="p">.</span><span class="n">Length</span> <span class="p">&lt;</span> <span class="m">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_onAllComplete</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span> <span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]{}</span> <span class="p">);</span>
        <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 失敗したリストを用意</span>
    <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">failedList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>

    <span class="c1">//各アセットのDownload</span>
    <span class="k">foreach</span><span class="p">(</span> <span class="kt">var</span> <span class="n">p</span> <span class="k">in</span> <span class="n">_reqParams</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Assert</span><span class="p">(</span> <span class="n">p</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">"ReqParam is NULL"</span><span class="p">);</span>
        <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">$"</span><span class="p">{</span><span class="n">AssetManager</span><span class="p">.</span><span class="n">I</span><span class="p">.</span><span class="nf">GetServerUrl</span><span class="p">()}</span><span class="s">/</span><span class="p">{</span><span class="n">p</span><span class="p">.</span><span class="n">AssetName</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
        <span class="err">#</span><span class="k">if</span> <span class="n">UNITY_2018_OR_NEWER</span>
        <span class="k">using</span><span class="p">(</span> <span class="n">UnityWebRequest</span> <span class="n">webRequest</span> <span class="p">=</span> <span class="n">UnityWebRequest</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span> <span class="n">uri</span> <span class="p">)</span> <span class="p">)</span>
        <span class="err">#</span><span class="k">else</span>
        <span class="k">using</span><span class="p">(</span> <span class="n">UnityWebRequest</span> <span class="n">webRequest</span> <span class="p">=</span> <span class="n">UnityWebRequest</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span> <span class="n">uri</span> <span class="p">)</span> <span class="p">)</span>
        <span class="err">#</span><span class="n">endif</span>
        <span class="p">{</span>
            <span class="c1">// 重複ダウンロード禁止</span>
            <span class="k">if</span><span class="p">(</span> <span class="nf">IsAlreadyDownloading</span><span class="p">(</span><span class="n">uri</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="c1">// Cacheにあるならそっちのロード処理に任せればいい</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">AssetBundleCacheController</span><span class="p">.</span><span class="nf">IsCached</span><span class="p">(</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetName</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetHash</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="c1">//古いキャッシュがあるとDownload失敗するので削除</span>
            <span class="n">AssetBundleCacheController</span><span class="p">.</span><span class="nf">ClearTargetOldAssetCache</span><span class="p">(</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetName</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetHash</span><span class="p">);</span>
            <span class="c1">// DL 開始 &amp; 終了待機</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">$"[Download] </span><span class="p">{</span><span class="n">uri</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="err">#</span><span class="k">if</span> <span class="n">UNITY_2017_3_OR_NEWER</span>
            <span class="k">yield</span> <span class="k">return</span> <span class="n">webRequest</span><span class="p">.</span><span class="nf">SendWebRequest</span><span class="p">();</span>
            <span class="err">#</span><span class="k">else</span>
            <span class="k">yield</span> <span class="k">return</span> <span class="n">webRequest</span><span class="p">.</span><span class="nf">Send</span><span class="p">();</span>
            <span class="err">#</span><span class="n">endif</span>

            <span class="kt">bool</span> <span class="n">isSucceeded</span> <span class="p">=</span> <span class="p">(</span> <span class="p">!</span> <span class="n">webRequest</span><span class="p">.</span><span class="n">isHttpError</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">webRequest</span><span class="p">.</span><span class="n">isNetworkError</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">isSucceeded</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">webRequest</span><span class="p">.</span><span class="n">downloadHandler</span><span class="p">.</span><span class="n">data</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">// Cache に保存</span>
                    <span class="kt">bool</span> <span class="n">ret</span> <span class="p">=</span> <span class="n">AssetBundleCacheController</span><span class="p">.</span><span class="nf">WriteAssetBundle</span><span class="p">(</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetName</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetHash</span><span class="p">,</span> <span class="n">webRequest</span><span class="p">.</span><span class="n">downloadHandler</span><span class="p">.</span><span class="n">data</span> <span class="p">);</span>
                    <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">$"[Cache] WriteFile</span><span class="p">{</span><span class="n">p</span><span class="p">.</span><span class="n">AssetName</span><span class="p">}</span><span class="s">:</span><span class="p">{</span><span class="n">ret</span><span class="p">}</span><span class="s">"</span> <span class="p">);</span>
                <span class="p">}</span>
                <span class="k">yield</span> <span class="k">return</span> <span class="n">p</span><span class="p">.</span><span class="n">OnCompleteDownload</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetName</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetHash</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>    
            <span class="p">{</span>
                <span class="n">failedList</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetName</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// 全工程の終了を確実にするため1f 待つ</span>
    <span class="k">yield</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="c1">// 終了コールバック</span>
    <span class="n">_onAllComplete</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span> <span class="n">_reqParams</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="n">failedList</span><span class="p">.</span><span class="n">Count</span><span class="p">,</span> <span class="n">failedList</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">()</span> <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="ローカルキャッシュへsaveload" class="fragment"></span><a href="#%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%B8saveload"><i class="fa fa-link"></i></a>ローカルキャッシュへSave/Load</h3>

<p>Unity に<a href="https://docs.unity3d.com/ja/current/ScriptReference/Caching.html" rel="nofollow noopener" target="_blank">Cachingクラス</a> というものがありますが、2015年頃まではUniteのコロプラさんセッションで話題になっていたUnityのCacheシステムは運用系のゲームではとてもじゃないですが使いづらかった状態でした。（数万AssetがあるとisReady がいつまでもReady になってくれなかったり、Cacheの削除は全削除しかできない→全Assetの再ダウンロードを強要してしまうなど）<br>
しかし2017 からは、UnityWebRequestを使うとAssetBundleに関しては自動的にCache 管理をしてくれるという魔法の仕組みがAPIでは提供されていたり、個別削除APIが追加されたりして、<a href="https://qiita.com/su10/items/98d7a9f89923b09a2d3c" id="reference-6cab32f40d5be9ad3caf">こちら</a>をはじめ、様々なブログ等でUnity2017で「Caching周りが改善された」という記事をよく目にしました。<br>
<del>当時は自分も「やったぜ」と思っていましたが、検証を行なった結果、怒りで頭がおかしくなりそうでした。<br>
そうです。<strong>「Cachingシステムがまともに動作していない」</strong> のです。<br>
（ちゃんと個別削除APIとか動いてますよという方は報告いただけると嬉しいです。）</del></p>

<p><del>APIを叩くもののCacheファイルはいつまでたっても削除されず、削除は全削除しか出来ないので１個ファイルに更新があるたびに全AssetBundleの落とし直しを余儀なくされます。</del></p>

<p><del>ということで<strong>Cachingに関しては using System.IO; して普通にファイル操作を行わないとダメ(つまり自前で実装する)</strong>です。</del></p>

<h4>
<span id="20180919追記" class="fragment"></span><a href="#20180919%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a><strong>2018/09/19追記：</strong>
</h4>

<p><a href="/k7a" class="user-mention js-hovercard" title="k7a" data-hovercard-target-type="user" data-hovercard-target-name="k7a">@k7a</a> さんから情報を頂き再度検証を行いました。<br>
基本的には k7a さんの記事 <a href="https://qiita.com/k7a/items/23d909ffeea3bab7dfcb" id="reference-aa3826817c64024656bf">[Unity 2018.2] AssetBundleのキャッシュを完全に理解する</a> で記載の通りでした。（k7aさん、情報提供ありがとうございます）<br>
※検証環境：Unity2018.4.8f1 </p>

<p>自動キャッシュ, 削除に関しては CachedAssetBundle 経由で行うこと（もしくは同等の値を直接設定）で動作の確認が取れました。</p>

<p>ただし、検証の結果<strong>Caching.IsVersionCached に関しては動作に問題がありました</strong>。<br>
いつの間にか<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Caching.IsVersionCached.html" rel="nofollow noopener" target="_blank">公式リファレンス</a> が<strong>obsolete になっていた</strong> 通りで、CachedAssetBundle.name, CachedAssetBundle.hash の組み合わせでも uri, hash128 の組み合わせそれぞれのパターンで応答を見た所、Cacheされているにも関わらずIsVersionCached が常にfalse を返していました。</p>

<p>対象のAssetBundleがCacheされているかどうかは現状知るすべが無いという感じですね。<br>
（何かご存知の方は教えていただけますと助かります。）</p>

<h4>
<span id="削除機能の自前実装" class="fragment"></span><a href="#%E5%89%8A%E9%99%A4%E6%A9%9F%E8%83%BD%E3%81%AE%E8%87%AA%E5%89%8D%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>削除機能の自前実装</h4>

<p>削除機能を実装するならこんな感じになるかと思います。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">AssetBundleCacheController.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 指定したAssetBundleをキャッシュから削除</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="_bundleName"&gt;AssetBundle名&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="_hash"&gt;Hash 値&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">ClearTargetAssetCache</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_bundleName</span><span class="p">,</span> <span class="n">Hash128</span> <span class="n">_hash</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="nf">IsCached</span><span class="p">(</span> <span class="n">_bundleName</span><span class="p">,</span> <span class="n">_hash</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">LogWarning</span><span class="p">(</span><span class="s">$"Not Cached:</span><span class="p">{</span><span class="n">_bundleName</span><span class="p">}</span><span class="s">(Hash:</span><span class="p">{</span><span class="n">_hash</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()}</span><span class="s">"</span> <span class="p">);</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">CreateAssetPath</span><span class="p">(</span> <span class="n">_bundleName</span><span class="p">,</span> <span class="n">_hash</span> <span class="p">);</span>

    <span class="n">File</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 指定したAssetBundleでバージョンが古いもの(=指定Hash値以外のもの)をキャッシュから削除</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="_bundleName"&gt;AssetBundle名&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">ClearTargetOldAssetCache</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_bundleName</span><span class="p">,</span> <span class="n">Hash128</span> <span class="n">_hash</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="kt">string</span> <span class="n">dirName</span> <span class="p">=</span> <span class="nf">CreateAssetDirName</span><span class="p">(</span> <span class="n">_bundleName</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">_bundleName</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">LogWarning</span><span class="p">(</span><span class="s">" Argument Error"</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Dirが存在しないので実質削除完了と等価</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">dirName</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 指定Dirにファイルがなければ、実質削除完了と等価</span>
    <span class="kt">string</span><span class="p">[]</span> <span class="n">filePaths</span> <span class="p">=</span> <span class="n">Directory</span><span class="p">.</span><span class="nf">GetFiles</span><span class="p">(</span> <span class="n">dirName</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">filePaths</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="n">filePaths</span><span class="p">.</span><span class="n">Length</span> <span class="p">&lt;</span> <span class="m">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">CreateAssetPath</span><span class="p">(</span> <span class="n">_bundleName</span><span class="p">,</span> <span class="n">_hash</span> <span class="p">);</span>
    <span class="k">foreach</span><span class="p">(</span> <span class="kt">string</span> <span class="n">p</span> <span class="k">in</span> <span class="n">filePaths</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">p</span> <span class="p">==</span> <span class="n">path</span><span class="p">)</span>
      <span class="p">{</span>
          <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">File</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span> <span class="n">p</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Cache Dir 上にファイルが存在するかどうか</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="_assetBundleName"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="_hash"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">IsCached</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_assetBundleName</span><span class="p">,</span> <span class="n">Hash128</span> <span class="n">_hash</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 読込先</span>
    <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">CreateAssetPath</span><span class="p">(</span> <span class="n">_assetBundleName</span><span class="p">,</span> <span class="n">_hash</span><span class="p">);</span>
    <span class="c1">//Validation</span>
    <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">path</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
<span class="p">}</span>

</code></pre></div>
</div>

<p>Saveに関してはFile.WriteAllBytes とかFileStreamを使って書き出せばOK。<br>
LoadはAssetBundleクラスのLoadFromFileAsyncメソッドを使えばOK。</p>

<h3>
<span id="assetbundle-のloadunload-処理" class="fragment"></span><a href="#assetbundle-%E3%81%AEloadunload-%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>AssetBundle のLoad/Unload 処理</h3>

<h4>
<span id="load" class="fragment"></span><a href="#load"><i class="fa fa-link"></i></a>Load</h4>

<p>AssetBundle のロード処理は少し厄介です。<br>
というのも<strong>同一のAssetBundleを２回ロードしようとするとエラー</strong>になります。<br>
なのでロードリクエストはしっかり自前で管理しないと簡単にロードリクエストが重複してエラーになって進行不能になったり・・・</p>

<p>よって<br>
- ロード済みのAssetBundleは需要がなくなるまでは保持していた方がいい<br>
- ロードが重複しないようにリクエストをしっかり管理する</p>

<p>ことが大事になってきます。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">AssetBundleLoadController.cs</span></div>
<div class="highlight"><pre class="with-code"><code>
<span class="k">private</span> <span class="n">IEnumerator</span> <span class="nf">LoadAssetBundleFromCache</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_assetBundleName</span><span class="p">,</span> <span class="n">Hash128</span> <span class="n">_hash</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 既にロード済み</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">TempLoadedDecryptAssetBundleNameList</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span> <span class="n">_assetBundleName</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//対象アセットバンドルが既にロード済み?</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">AssetManager</span><span class="p">.</span><span class="n">I</span><span class="p">.</span><span class="nf">IsLoadedBundle</span><span class="p">(</span> <span class="n">_assetBundleName</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//一時ロードするAssetBundleリストに登録</span>
    <span class="nf">RegisterTempAssetBundle</span><span class="p">(</span> <span class="n">_assetBundleName</span> <span class="p">);</span>

    <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">AssetBundleCacheController</span><span class="p">.</span><span class="nf">CreateAssetPath</span><span class="p">(</span><span class="n">_assetBundleName</span><span class="p">,</span><span class="n">_hash</span><span class="p">);</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"[Cache] Load:{path}"</span><span class="p">);</span>
    <span class="n">AssetBundleCreateRequest</span> <span class="n">req</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="nf">LoadFromFileAsync</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>

    <span class="k">yield</span> <span class="k">return</span> <span class="n">req</span><span class="p">;</span>

    <span class="c1">// Load成功していたら登録</span>
    <span class="kt">bool</span> <span class="n">isSucceeded</span> <span class="p">=</span> <span class="p">(</span> <span class="n">req</span><span class="p">.</span><span class="n">assetBundle</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">);</span>

    <span class="c1">// Download 成功</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">isSucceeded</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Download してきたAssetBundle の登録</span>
        <span class="n">AssetManager</span><span class="p">.</span><span class="n">I</span><span class="p">.</span><span class="nf">RegisterAssetData</span><span class="p">(</span><span class="n">_assetBundleName</span><span class="p">,</span> <span class="k">new</span> <span class="nf">AssetData</span><span class="p">(</span> <span class="n">req</span><span class="p">.</span><span class="n">assetBundle</span><span class="p">,</span> <span class="n">_hash</span> <span class="p">)</span> <span class="p">);</span>    
    <span class="p">}</span>

    <span class="c1">// リクエスト終了</span>
    <span class="nf">UnregisterTempAssetBundle</span><span class="p">(</span> <span class="n">_assetBundleName</span> <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h4>
<span id="unload" class="fragment"></span><a href="#unload"><i class="fa fa-link"></i></a>Unload</h4>

<p>迂闊に破棄をしてしまうと、同一フレームの後続の処理でロードしようとすると死んだりするので、<br>
「<strong>完全に需要がなくなったタイミングで破棄</strong>」するのが退治になります。<br>
なので、自前で<strong>参照カウント</strong>を管理して、参照カウントが0になったタイミングで破棄してあげればOK。</p>

<p>こんな感じでAssetBundleを管理するクラスを作って、管理</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">AssetData.cs</span></div>
<div class="highlight"><pre class="with-code"><code>
<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Load済みAssetBundle に関する情報まとめクラス</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">AssetData</span> <span class="p">:</span> <span class="n">IDisposable</span>
<span class="p">{</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="c1">// メンバ変数</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">=====</span> <span class="n">MEMBER_VARIABLES</span> <span class="p">=====</span>

    <span class="c1">// AssetBundle名</span>
    <span class="kt">string</span> <span class="n">m_bundleName</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">BundleName</span><span class="p">{</span><span class="k">get</span><span class="p">{</span><span class="k">return</span> <span class="n">m_bundleName</span><span class="p">;}}</span>

    <span class="c1">// ロード対象のAssetBundle</span>
    <span class="k">private</span> <span class="n">AssetBundle</span> <span class="n">m_targetBundle</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">AssetBundle</span> <span class="n">TargetBundle</span><span class="p">{</span><span class="k">get</span><span class="p">{</span><span class="k">return</span> <span class="n">m_targetBundle</span><span class="p">;}}</span>

    <span class="c1">// 参照カウンタ</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">m_refCount</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">public</span>  <span class="kt">int</span> <span class="n">RefCount</span><span class="p">{</span><span class="k">get</span><span class="p">{</span><span class="k">return</span> <span class="n">m_refCount</span><span class="p">;}}</span>

    <span class="c1">// このBundle のhash 値</span>
    <span class="k">private</span> <span class="n">Hash128</span> <span class="n">m_assetHash</span><span class="p">;</span>
    <span class="k">public</span>  <span class="n">Hash128</span> <span class="n">AssetHash</span><span class="p">{</span><span class="k">get</span><span class="p">{</span><span class="k">return</span> <span class="n">m_assetHash</span><span class="p">;}}</span>

    <span class="err">#</span><span class="n">endregion</span> <span class="c1">//) ===== MEMBER_VARIABLES =====</span>



    <span class="c1">//--------------------------------------------</span>
    <span class="c1">// 初期化</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">=====</span> <span class="n">INIT</span> <span class="p">=====</span>

    <span class="k">public</span> <span class="nf">AssetData</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">m_bundleName</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
        <span class="n">m_refCount</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="n">m_targetBundle</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">AssetData</span><span class="p">(</span> <span class="n">AssetBundle</span> <span class="n">_loadedBundle</span><span class="p">,</span> <span class="n">Hash128</span> <span class="n">_hash</span> <span class="p">)</span> <span class="p">:</span> <span class="k">this</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">m_targetBundle</span> <span class="p">=</span> <span class="n">_loadedBundle</span><span class="p">;</span>
        <span class="n">m_bundleName</span> <span class="p">=</span> <span class="n">_loadedBundle</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
        <span class="n">m_assetHash</span> <span class="p">=</span> <span class="n">_hash</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span> <span class="c1">//) ===== INIT =====</span>

    <span class="c1">//--------------------------------------------</span>
    <span class="c1">// Dispose</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">=====</span> <span class="n">DISPOSE</span> <span class="p">=====</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">(</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 念のためチェック</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">TargetBundle</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TargetBundle</span><span class="p">.</span><span class="nf">Unload</span><span class="p">(</span> <span class="k">false</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span> <span class="c1">//) ===== DISPOSE =====</span>


    <span class="c1">//--------------------------------------------</span>
    <span class="c1">// 参照カウンタ</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">=====</span> <span class="n">REFERENCE_COUNT</span> <span class="p">=====</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">SetReference</span><span class="p">(</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="p">++</span><span class="n">m_refCount</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">SetRelease</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="p">--</span><span class="n">m_refCount</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">RefCount</span> <span class="p">&lt;</span> <span class="m">1</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//Unload</span>
            <span class="n">TargetBundle</span><span class="p">.</span><span class="nf">Unload</span><span class="p">(</span> <span class="k">false</span> <span class="p">);</span>
            <span class="n">m_targetBundle</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span> <span class="c1">//) ===== REFERENCE_COUNT =====</span>


    <span class="c1">//--------------------------------------------</span>
    <span class="c1">// Asset</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">=====</span> <span class="n">ASSETS</span> <span class="p">=====</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// このAssetBundle に対象のAssetが存在するか</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="_assetName"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">IsContainsAsset</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_assetName</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">TargetBundle</span> <span class="p">==</span> <span class="k">null</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">string</span><span class="p">[]</span> <span class="n">names</span> <span class="p">=</span> <span class="n">TargetBundle</span><span class="p">.</span><span class="nf">GetAllAssetNames</span><span class="p">();</span>
        <span class="k">foreach</span><span class="p">(</span> <span class="kt">string</span> <span class="n">name</span> <span class="k">in</span> <span class="n">names</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">name</span> <span class="p">==</span> <span class="n">_assetName</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span> <span class="c1">//) ===== ASSETS =====</span>
<span class="p">}</span>

</code></pre></div>
</div>

<h3>
<span id="assetbundle-のビルド処理" class="fragment"></span><a href="#assetbundle-%E3%81%AE%E3%83%93%E3%83%AB%E3%83%89%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>AssetBundle のビルド処理</h3>

<h4>
<span id="ビルドの前に" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89%E3%81%AE%E5%89%8D%E3%81%AB"><i class="fa fa-link"></i></a>ビルドの前に</h4>

<p>Unity謹製ツールの<a href="https://github.com/Unity-Technologies/AssetBundles-Browser" rel="nofollow noopener" target="_blank">AssetBundleBrowser</a>の導入を強くオススメします。</p>

<p>リンクのGithubから落としてくるか、UnityPackageManagerからDLで導入出来ます。<br>
ただ、導入するときはEditor以下のみで、それ以外は削除してしまった方がいいです。<br>
特にTest以下のコードは不要なのと<code>using Boo.Lang.Runtime;</code> という見たく無いコードが紛れてビルドがこけたりするので要注意です（Unityさん、メンテお願いします）</p>

<p>導入メリットとしては</p>

<ul>
<li>設定しているAssetBundleをGUIでリスト化して見れる</li>
<li>各AssetBundleの依存関係や参照しているリソースも見ることが可能</li>
<li>リソースをD&amp;DでAssetBundleとして設定可能</li>
<li>Inspector下の小さいところで名前設定をしなくていい</li>
<li>GUIなのでアーティストさんも操作可能→エンジニアのタスク軽減の効果も期待できる</li>
</ul>

<p>など色々とメリットがあるので非常にオススメです。</p>

<h4>
<span id="ビルドスクリプト" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88"><i class="fa fa-link"></i></a>ビルドスクリプト</h4>

<p>基本的には<a href="https://docs.unity3d.com/ja/current/ScriptReference/BuildPipeline.BuildAssetBundles.html" rel="nofollow noopener" target="_blank">BuildPipeline.BuildAssetBundle</a> を叩いてあげれば一応はAssetBundleは焼けます。</p>

<p>また、Manifestをちゃんと読み込めれば「更新のあったアセットのみビルド」が行われるインクリメンタルビルドが行われるので、ビルド時間の短縮も自動的にやってくれます。</p>

<p>ここに関しては割と運用スタイルによって異なってくるので割愛します。</p>

<h1>
<span id="apple-のdownloadサイズ表示義務規約について" class="fragment"></span><a href="#apple-%E3%81%AEdownload%E3%82%B5%E3%82%A4%E3%82%BA%E8%A1%A8%E7%A4%BA%E7%BE%A9%E5%8B%99%E8%A6%8F%E7%B4%84%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>Apple のDownloadサイズ表示義務規約について</h1>

<p><a href="/midnightSuyama" class="user-mention js-hovercard" title="midnightSuyama" data-hovercard-target-type="user" data-hovercard-target-name="midnightSuyama">@midnightSuyama</a> さんの<a href="https://qiita.com/midnightSuyama/items/d1addebbc9a620d28eaa" id="reference-1c29f4957fcf5487b0d1">Apple規約解説記事</a>（いつもお世話になってます）でも紹介されている通り、追加リソースのダウンロード時にダウンロードサイズを明記する必要がでました。</p>

<blockquote>
<p>If your app needs to download additional resources, disclose the size of the download and prompt users before doing so. Existing apps must comply with this guideline in any update submitted after January 1, 2019.</p>
</blockquote>

<p>WTF!!<br>
<a href="https://camo.qiitausercontent.com/06a5826a4c767967b2f4ec605fbcc1a05493cbfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36353235372f36373762366535382d613262642d383535312d326263302d3934333762386238636462662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F677b6e58-a2bd-8551-2bc0-9437b8b8cdbf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=fd41f9ead7946d125bef5015bae7ddb7" alt="rage.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/65257/677b6e58-a2bd-8551-2bc0-9437b8b8cdbf.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F677b6e58-a2bd-8551-2bc0-9437b8b8cdbf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e10f05345adb06ca0b888f42c9448142 1x" loading="lazy"></a></p>

<p>既存アプリは対応猶予期間がありますが、新規アプリはマスト対応です。<br>
はい。Unityの既存の機能じゃどうしようもありません。</p>

<p>AssetBundleManifestには「Bundle名」「依存関係」の情報があるので、ここに「サイズ」を追加できると嬉しいですね。</p>

<p>方針としては<br>
- AssetBundleManifest にサイズの項目を追加して読めるようにする<br>
- 独自Manifestを作成して対応する</p>

<p>になります。</p>

<h2>
<span id="拡張マニフェスト対応" class="fragment"></span><a href="#%E6%8B%A1%E5%BC%B5%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88%E5%AF%BE%E5%BF%9C"><i class="fa fa-link"></i></a>拡張マニフェスト対応</h2>

<p>データを加工したAssetBundleManifestを読むのは技術的に辛かったので、独自マニフェスト実装<del>に逃げました</del>をすることにしました。</p>

<h3>
<span id="独自マニフェスト作成上の注意点" class="fragment"></span><a href="#%E7%8B%AC%E8%87%AA%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88%E4%BD%9C%E6%88%90%E4%B8%8A%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9"><i class="fa fa-link"></i></a>独自マニフェスト作成上の注意点</h3>

<ul>
<li>Hash値(Hash128) はそれぞれのAssetBundleの個別マニフェストにはありますが、本体には記載されないです</li>
<li>AssetBundleManifestはYAMLで書かれている</li>
<li>Unity上でのパース速度でいえば JSON &gt; YAML （<a href="https://qiita.com/Marimoiro/items/e998584d973baab3aac8" id="reference-e5dcbccb9120074054ba">検証記事</a>)</li>
</ul>

<h3>
<span id="ワークフロー-1" class="fragment"></span><a href="#%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%95%E3%83%AD%E3%83%BC-1"><i class="fa fa-link"></i></a>ワークフロー</h3>

<ol>
<li>AssetBundleビルド時に、Bundle名とHash128の値をまとめたテキストファイルを出力</li>
<li>YAMLを解析できる外部ツールで解析</li>
<li>出力先Dirを探索してサイズを取得</li>
<li>１. のハッシュ値情報, 2.のYAML情報, 3. のサイズ情報を統合</li>
<li>独自マニフェスト.json を出力</li>
<li>他のAssetBundleと一緒に独自マニフェスト.json をアップ</li>
<li>公式AssetBundleManifestの代わりに独自マニフェストをDLして利用</li>
</ol>

<p>というワークフローになります。</p>

<h3>
<span id="yaml-の解析" class="fragment"></span><a href="#yaml-%E3%81%AE%E8%A7%A3%E6%9E%90"><i class="fa fa-link"></i></a>YAML の解析</h3>

<p>個人的にはShellScriptがいいのですが、たまたま他の人から反発を受けたので他を検討したところ<br>
<a href="https://maku77.github.io/python/io/yaml.html" rel="nofollow noopener" target="_blank">こちら</a> を見つけてしまったため、「あ、Pythonならクッソ簡単に行けそう」と判断してPythonで実装していくことにしました。</p>

<p>早速homebrew でpython3, pip, PyYAML を入れて環境を設定します。</p>

<h4>
<span id="解析ツールの実装" class="fragment"></span><a href="#%E8%A7%A3%E6%9E%90%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>解析ツールの実装</h4>

<p>正直python を書くのって指で数える程度しか無いですが、こんな感じで生成しました</p>

<div class="code-frame" data-lang="python">
<div class="code-lang"><span class="bold">extManifestGenerator.py</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">#!/usr/bin/env python
# coding: UTF-8
</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># コマンドラインから情報を取得
</span><span class="n">buildTarget</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">outputFormat</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">path</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>


<span class="c1"># ファイルの読み込み 
</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">path</span><span class="o">+</span><span class="s">'/'</span><span class="o">+</span><span class="n">buildTarget</span><span class="o">+</span><span class="s">'.manifest'</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">fp</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Parse YAML
</span><span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="p">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="c1"># Init Output
</span><span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">output</span><span class="p">[</span><span class="s">'ManifestFileVersion'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">'ManifestFileVersion'</span><span class="p">]</span>
<span class="n">output</span><span class="p">[</span><span class="s">'CRC'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">'CRC'</span><span class="p">]</span>
<span class="n">output</span><span class="p">[</span><span class="s">'BundleList'</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>

<span class="c1"># Hashリストのロード
</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">'/'</span><span class="o">+</span><span class="n">buildTarget</span><span class="o">+</span><span class="s">'Hash.yaml'</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">hashfp</span><span class="p">:</span>
    <span class="n">hashListText</span> <span class="o">=</span> <span class="n">hashfp</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Parse YAML
</span><span class="n">hashListYaml</span> <span class="o">=</span> <span class="n">yaml</span><span class="p">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">hashListText</span><span class="p">)</span>

<span class="c1"># Manifest Info
</span>
<span class="c1"># Create Manifest
</span><span class="n">infos</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'AssetBundleManifest'</span><span class="p">][</span><span class="s">'AssetBundleInfos'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k1</span><span class="p">,</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">infos</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">bundle</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">k2</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">v1</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># 名前一致で検索
</span>        <span class="k">if</span> <span class="n">k2</span> <span class="o">==</span> <span class="s">'Name'</span> <span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s">'/'</span><span class="o">+</span><span class="n">v2</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
            <span class="c1"># 名前を設定
</span>            <span class="n">bundle</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span><span class="o">=</span><span class="n">v2</span>
            <span class="c1"># Size設定
</span>            <span class="n">bundle</span><span class="p">[</span><span class="s">'Size'</span><span class="p">]</span><span class="o">=</span><span class="n">size</span>
            <span class="c1"># Hash 値を取得
</span>            <span class="k">for</span> <span class="n">k3</span><span class="p">,</span> <span class="n">v3</span> <span class="ow">in</span> <span class="n">hashListYaml</span><span class="p">[</span><span class="s">'HashList'</span><span class="p">].</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">v3</span><span class="p">[</span><span class="s">'Name'</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span><span class="p">:</span>
                    <span class="n">bundle</span><span class="p">[</span><span class="s">'Hash'</span><span class="p">]</span><span class="o">=</span><span class="n">v3</span><span class="p">[</span><span class="s">'Hash'</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">k2</span> <span class="o">==</span> <span class="s">'Dependencies'</span><span class="p">:</span>
            <span class="n">bundle</span><span class="p">[</span><span class="s">'Dependencies'</span><span class="p">]</span><span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">dependItem</span><span class="p">,</span> <span class="n">dependBundleName</span> <span class="ow">in</span> <span class="n">v2</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">bundle</span><span class="p">[</span><span class="s">'Dependencies'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span> <span class="n">dependBundleName</span> <span class="p">)</span>

    <span class="c1"># パースしたバンドル情報を追加
</span>    <span class="n">output</span><span class="p">[</span><span class="s">'BundleList'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span> <span class="n">bundle</span> <span class="p">)</span>

<span class="k">if</span> <span class="n">outputFormat</span> <span class="o">==</span> <span class="s">'YAML'</span> <span class="p">:</span> 
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">'/'</span><span class="o">+</span><span class="n">buildTarget</span><span class="o">+</span><span class="s">'.yaml'</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">wf</span><span class="p">:</span>
        <span class="n">wf</span><span class="p">.</span><span class="n">write</span><span class="p">(</span> <span class="n">yaml</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="k">elif</span> <span class="n">outputFormat</span> <span class="o">==</span> <span class="s">'JSON'</span> <span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">'/'</span><span class="o">+</span><span class="n">buildTarget</span><span class="o">+</span><span class="s">'.json'</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">wf</span><span class="p">:</span>
        <span class="n">wf</span><span class="p">.</span><span class="n">write</span><span class="p">(</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

</code></pre></div>
</div>

<h3>
<span id="unity側の独自マニフェスト" class="fragment"></span><a href="#unity%E5%81%B4%E3%81%AE%E7%8B%AC%E8%87%AA%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88"><i class="fa fa-link"></i></a>Unity側の独自マニフェスト</h3>

<p>基本的にはAssetBundleManifestで実装しているAPIを作りつつ、サイズを返すAPIを生やしていきます。<br>
Interface 的には以下のような感じで実装していけば問題ないはずです。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">IExtManifest.cs</span></div>
<div class="highlight"><pre class="with-code"><code>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IExtManifest</span>
<span class="p">{</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="c1">// AssetBundleManifestAPI</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">=====</span> <span class="n">BUNDLE_MANIFEST_API</span> <span class="p">=====</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 全バンドルリストを返す</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">string</span><span class="p">[]</span> <span class="nf">GetAllAssetBundles</span><span class="p">();</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Variant 情報ありでバンドルリストを返す</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">string</span><span class="p">[]</span> <span class="nf">GetAllAssetBundlesWithVariant</span><span class="p">();</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 指定バンドルの依存バンドルリストを返す</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="assetBundleName"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">string</span><span class="p">[]</span> <span class="nf">GetAllDependencies</span><span class="p">(</span><span class="kt">string</span> <span class="n">_assetBundleName</span><span class="p">);</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 指定バンドルと直接依存関係にあるバンドルリストを返す</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="assetBundleName"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">string</span><span class="p">[]</span> <span class="nf">GetDirectDependencies</span><span class="p">(</span><span class="kt">string</span> <span class="n">_assetBundleName</span><span class="p">);</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 指定バンドルのハッシュ値を返す</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="assetBundleName"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="n">Hash128</span> <span class="nf">GetAssetBundleHash128</span><span class="p">(</span><span class="kt">string</span> <span class="n">_assetBundleName</span><span class="p">);</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 指定バンドルのハッシュ値を返す</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="assetBundleName"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">GetAssetBundleHash</span><span class="p">(</span><span class="kt">string</span> <span class="n">_assetBundleName</span><span class="p">);</span>


    <span class="err">#</span><span class="n">endregion</span> <span class="c1">//) ===== BUNDLE_MANIFEST_API =====</span>

    <span class="c1">//--------------------------------------------</span>
    <span class="c1">// BundleSizeAPI</span>
    <span class="c1">//--------------------------------------------</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">=====</span> <span class="n">BUNDLE_SIZE_API</span> <span class="p">=====</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 指定バンドルのサイズを取得[byte]</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="_assetBundleName"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="nf">GetBundleSize</span><span class="p">(</span> <span class="kt">string</span> <span class="n">_assetBundleName</span><span class="p">);</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// 指定バンドルサイズの合計値を返す</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name="_assetBundleNames"&gt;&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="nf">CalcTotalDownloadSize</span><span class="p">(</span> <span class="k">params</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">_assetBundleNames</span><span class="p">);</span>

    <span class="err">#</span><span class="n">endregion</span> <span class="c1">//) ===== BUNDLE_SIZE_API =====</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h1>
<span id="実装に当たって" class="fragment"></span><a href="#%E5%AE%9F%E8%A3%85%E3%81%AB%E5%BD%93%E3%81%9F%E3%81%A3%E3%81%A6"><i class="fa fa-link"></i></a>実装に当たって</h1>

<p>実際に作って遭遇した問題などを書いていきます</p>

<h2>
<span id="apiの方針" class="fragment"></span><a href="#api%E3%81%AE%E6%96%B9%E9%87%9D"><i class="fa fa-link"></i></a>APIの方針</h2>

<ul>
<li>Facade パターンのススメ

<ul>
<li>Addressable AssetもFacadeパターン<br>
</li>
<li>窓口となるSingletonクラスのAPI以外は外部からは見えないようにする方が使うときに便利</li>
</ul>
</li>
<li>Download 関数は「個別ダウンロード」と「一括ダウンロード」と２つ用意しておくと良いです

<ul>
<li>最近のゲームは初回に一括でダウンロードすることが多くオンデマンドでのダウンロードは珍しい</li>
<li>初回DLで満足は厳禁!! iPhone のOSによる自動キャッシュ削除でいつのまにか消えている場合がある</li>
<li>Androidは常にユーザーの任意タイミングでキャッシュを消せるのを念頭におく</li>
<li>個人的には初回一括DL＋オンデマンドの併用をオススメ。</li>
<li>インゲームへの遷移時間短縮や、マルチプレイ時はマッチング時間短縮のためにも、追加で必要なリソースをオンデマンドでDLできる制約を入れておいた方が無難です。（直前に多量のDLを走らせないためにも）</li>
</ul>
</li>
<li>SetServerUrl() を用意して、なるべくURLを埋め込まない

<ul>
<li>クライアントコードは基本的に全部解読される前提</li>
<li>サーバーリソースを引き抜かれないためにも自己防衛しましょう</li>
</ul>
</li>
</ul>

<h2>
<span id="loadrequest-の制御" class="fragment"></span><a href="#loadrequest-%E3%81%AE%E5%88%B6%E5%BE%A1"><i class="fa fa-link"></i></a>LoadRequest の制御</h2>

<p>非同期でロードリクエストを出す際、コールバックが呼ばれる前に呼び出し側がDestroyされるパターンがあり、それでエラーになることが頻発したので、リクエスト発行時にハンドラを返して、呼び出し元がDestroyされるときに、ハンドラを介してコールバックを実行させないように制御しないとダメでした。</p>

<h2>
<span id="assetbundle-の命名規則" class="fragment"></span><a href="#assetbundle-%E3%81%AE%E5%91%BD%E5%90%8D%E8%A6%8F%E5%89%87"><i class="fa fa-link"></i></a>AssetBundle の命名規則</h2>

<ul>
<li>そもそも仕様で大文字が使えない(英数小文字のみ)</li>
<li>ディレクトリ名+ファイル名をAssetBundle名にしておくと、名称被りが起きづらいし、用途を管理しやすいです</li>
</ul>

<h2>
<span id="最適化について" class="fragment"></span><a href="#%E6%9C%80%E9%81%A9%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>最適化について</h2>

<ul>
<li>Coroutine よりも使えるならTask, UniRxやAsync/Await などをうまく使った方がいいです</li>
<li>Native でやれば絶対早くなります。

<ul>
<li>出来るのは大人数の開発者がいる or 超スーパーエンジニアがいる場合のみ</li>
<li>Native のコードは公開されないので個人開発や中小企業は素直にUnityAPIにあやかるべき</li>
</ul>
</li>
</ul>

<h2>
<span id="暗号化について" class="fragment"></span><a href="#%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>暗号化について</h2>

<ul>
<li>
<a href="https://qiita.com/snaka/items/a4c16719888bbd23067f" id="reference-8d0ea6bc0b3467e925b2">ここ</a> のまとめがすごくよくまとまっています(すごくおすすめです)</li>
<li>AssetBundle自体をAESを利用して暗号化をする場合、一旦暗号化AssetBundleをメモリに全て載せないとダメなので、Chunkロードが使えないデメリットがある</li>
<li>パフォーマンスをとるか、暗号化をとるかは要検討案件です</li>
</ul>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<p>Unity2018.2 〜が使えるなら頑張ってAdressable Assetsを使って見た方が今後のためにも良いと思います。<br>
出来ることなら、もう2度と作りたくないですね（白目</p>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<p><qiita-embed-ogp src="https://creator.game.cyberagent.co.jp/?p=4791"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/neon-izm/items/b105130fac060ec40ad4"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/fukaken5050/items/e69572f963c26015a716"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/su10/items/98d7a9f89923b09a2d3c"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/Marimoiro/items/e998584d973baab3aac8"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/snaka/items/a4c16719888bbd23067f"></qiita-embed-ogp></p>

<p><qiita-embed-ogp src="https://qiita.com/k7a/items/23d909ffeea3bab7dfcb"></qiita-embed-ogp></p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FCova8bitdot%2Fitems%2F20e8962ed0ca0544289d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FCova8bitdot%2Fitems%2F20e8962ed0ca0544289d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/likers" class="css-1iupg5d">66</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">67</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/20e8962ed0ca0544289d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Cova8bitdot/items/20e8962ed0ca0544289d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Cova8bitdot/items/20e8962ed0ca0544289d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-90e03e85-cea5-4f57-85c8-705beca1d08c">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-ff2e2451-9690-4f27-9569-de9e5a7dd367"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-ff2e2451-9690-4f27-9569-de9e5a7dd367">{}</script>
      
<div id="LoginModal-react-component-06471dd3-2a50-4c1b-9da0-648d82f504de"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-06471dd3-2a50-4c1b-9da0-648d82f504de">{}</script>
      
<div id="StockModal-react-component-aa4f5b9e-215c-46e7-85ff-37a71948560d"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-aa4f5b9e-215c-46e7-85ff-37a71948560d">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;Dk1uJFqa0/f5/lIRJYczAWMckd10OcWJdbdIys1QrC4e794JV5OYJHLDpMwSezPWWWgVqPMCm8n4Iy5JB6WEog==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eこの記事は主にUnity2017.1 ~ Unity2018.1 向けの話になります。\u003c/li\u003e\n\u003cli\u003e内容としては初級者〜中級者レベルで、AssetBundle の仕組みを作らなければならない人向けです。\u003c/li\u003e\n\u003cli\u003e他のバージョンは様々な記事があるので参考リンクに記載してあるページを見ていただければと思います。\u003c/li\u003e\n\u003cli\u003eコードについてはダミーコードを載せているので、コピペしただけでは動かないと思います。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"用語\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%94%A8%E8%AA%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e用語\u003c/h2\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e用語\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e意味\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eAsset(アセット)\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e訳すと資産。Prefab,Animation,Texture,AudioClip,Scene などのゲームで用いるリソース全般を指す言葉\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eAssetBundle\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e複数のAssetをパッキングしてまとめたもの。複数存在可能\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eAssetBundleBrowser\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eUnity謹製AssetBundle管理ツール。後述で説明します\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eAssetBundleManifest\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eAssetBundleのバージョンや名前、依存関係などをまとめたYAML( or バイナリ) ファイル。AssetBundleと一緒に自動生成される\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eビルド\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eAssetBundleを作ること。APIこそ公式であるがツールはないので大抵は自作する\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"assetbundle-とは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assetbundle-%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssetBundle とは\u003c/h1\u003e\n\n\u003cp\u003eざっくりと説明すると「アプリ外部から素材などをダウンロード〜ロードする仕組み」+「ロードする素材群をパック（まとめる）するための仕組み」です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"メリット\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h2\u003e\n\n\u003cp\u003eアプリ内部に一部リソースを持たなくていいため\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eアプリのサイズを抑えることができる\n\n\u003cul\u003e\n\u003cli\u003eモバイルアプリだと各プラットフォームで3G/4G回線でDL出来るアプリのサイズ制限がある（Apple:150MB, GooglePlay:100MB)\u003c/li\u003e\n\u003cli\u003eユーザーとしてはDLしやすくなるためDL数が伸びやすい\u003c/li\u003e\n\u003cli\u003e動画やボイスなど重いファイルは必要な時にDLする仕組みに出来る\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eサーバーにAssetBundleを置くことができる\n\n\u003cul\u003e\n\u003cli\u003eアプリ申請なしにリソースの更新が可能\n\n\u003cul\u003e\n\u003cli\u003eアプリ内イベントなどのリソース追加が容易\u003c/li\u003e\n\u003cli\u003e見た目修正程度であれば、AssetBundleを更新して、ユーザーに最新のものをDLしてもらえればすぐ治る\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e（アプリの作りによるが）必要な時に必要なもののみDLできる\u003c/li\u003e\n\u003cli\u003eリソースのバージョン管理も行える\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"assetbundle-の仕組みの導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assetbundle-%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssetBundle の仕組みの導入\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"楽したい方へ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A5%BD%E3%81%97%E3%81%9F%E3%81%84%E6%96%B9%E3%81%B8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e楽したい方へ\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eもし極力コードを書きたくないという方は既存のパッケージの利用をオススメします。\n\u003ca href=\"/neon-izm\" class=\"user-mention js-hovercard\" title=\"neon-izm\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"neon-izm\"\u003e@neon-izm\u003c/a\u003e　さんが紹介しているコチラなどを参考にしてもらうと良いと思います。\n\u003ca href=\"https://qiita.com/neon-izm/items/b105130fac060ec40ad4\" class=\"autolink\" id=\"reference-321e8ff4ad961f785916\"\u003ehttps://qiita.com/neon-izm/items/b105130fac060ec40ad4\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eちなみにAutoyaの導入も考えましたがUnityAdsが必要だったりしたので辞めました\u003c/li\u003e\n\u003cli\u003eUnity謹製AssetBundleManagerは5.X系以降はあまりメンテされてなかったのでオススメしません。ただ、コードを書く時の参考に利用するのはありだと思います\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eなんらかの事情でパッケージ導入がダメな人はここから一緒に頑張りましょう（悲しみ）\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"機能の確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A9%9F%E8%83%BD%E3%81%AE%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e機能の確認\u003c/h2\u003e\n\n\u003cp\u003eAssetBundleで最低限必要なこととしては\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAssetBundle のDownload処理\u003c/li\u003e\n\u003cli\u003eAssetBundle のローカルキャッシュへSave/Load 処理\u003c/li\u003e\n\u003cli\u003eAssetBundle のLoad/Unload 処理\u003c/li\u003e\n\u003cli\u003eAssetBundle のビルド処理\u003c/li\u003e\n\u003cli\u003eシミュレーションモードの実装\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eだと思います。\u003c/p\u003e\n\n\u003cp\u003eAssetBundle のDownload ~ Unload までの流れはCEDECの講演でとてもわかりやすく解説されているのでぜひ見て見てください。\u003cbr\u003e\n\u003ca href=\"https://creator.game.cyberagent.co.jp/?p=4791\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://creator.game.cyberagent.co.jp/?p=4791\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれらが出来た上で実装したい項目としては\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAssetBundle の暗号化\u003c/li\u003e\n\u003cli\u003eAssetBundle のバージョン管理\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eあたりが候補として上がってくると思います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ワークフロー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%95%E3%83%AD%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eワークフロー\u003c/h2\u003e\n\n\u003cp\u003e最低限必要な「Download」「Cache管理」「Load」を踏まえると、フローとしては以下のような感じになります。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/ebdab12be5f434d81c4508c1ab4e8910d6937ea8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36353235372f38306561306665362d323232312d613066652d376539342d3332656666323836306439322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F80ea0fe6-2221-a0fe-7e94-32eff2860d92.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a18d864e2282491ed63e4a64a321430f\" alt=\"AssetBundleFlow (1).png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/65257/80ea0fe6-2221-a0fe-7e94-32eff2860d92.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F80ea0fe6-2221-a0fe-7e94-32eff2860d92.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5e988871e106e43cd8d9da8272dab560 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"download処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#download%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eDownload処理\u003c/h3\u003e\n\n\u003cp\u003eDownloadといっても「ManifestのDownload」と「AssetBundleのDownload」とでは少し話（やコード）が変わってくるので順を追って説明していきます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"assetbundlemanifestのdownload\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assetbundlemanifest%E3%81%AEdownload\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssetBundleManifestのDownload\u003c/h4\u003e\n\n\u003cp\u003eAssetBundleを使うためにも、その情報が記載されているManifestが無いと始まりません。\u003cbr\u003e\nManifestに関しては特に制約とかが無いのでUnityWebRequest.GetAssetBundle()　でとってくればOKです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAssetBundleDownloader.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine.Networking\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eTIME_OUT\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e60\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//[sec]\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003edelegate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnCompleteDownloadManifest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003e_isSucceeded\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundle\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoDownloadManifest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_manifestName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOnCompleteDownloadManifest\u003c/span\u003e \u003cspan class=\"n\"\u003e_onComplete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Validation\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_manifestName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_onComplete\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// uri とありますがurl と認識してもらって差し支えないです\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euri\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetServerUrl\u003c/span\u003e\u003cspan class=\"p\"\u003e()}\u003c/span\u003e\u003cspan class=\"s\"\u003e/\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003e_manifestName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// GetAssetBundle 関数ではcrcやhash128 を指定するものがありますが、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 基本的にManifestファイルはキャッシュに保存せずオンメモリで扱うことが多い\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// \u0026amp; サーバー側からもらったバージョン(int やhash値)を見て必要になって\u003c/span\u003e\n\u003cspan class=\"err\"\u003e　　　　　　　　\u003c/span\u003e\u003cspan class=\"c1\"\u003e//   これを叩いているはずなのであえて指定していません\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eUNITY2018_OR_NEWER\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// なんでバージョンによってAPI名というかクラス名すら変わるかなぁ...(運用で困る)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnityWebRequestAssetBundle\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eUnityWebRequestAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnityWebRequest\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eUnityWebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendif\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etimeout\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTIME_OUT\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// DL 開始 \u0026amp; 終了待機\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eUNITY_2017_3_OR_NEWER\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendWebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendif\u003c/span\u003e\n\n\n    \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisSucceeded\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eisHttpError\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eisNetworkError\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003e_onComplete\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eisSucceeded\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDownloadHandlerAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetContent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e一方AssetBundleに関してはこんな感じ\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAssetBundleDownloader.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003edelegate\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnCompleteDownloadEachBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleHash\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003edelegate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnCompleteDownloadAllBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003e_isSucceededCount\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003e_failedList\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDownloadRequestParam\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetHash\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eOnCompleteDownloadEachBundle\u003c/span\u003e \u003cspan class=\"n\"\u003eOnCompleteDownload\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoDownloadAssetBundles\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eDownloadRequestParam\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003e_reqParams\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eOnCompleteDownloadAllBundle\u003c/span\u003e \u003cspan class=\"n\"\u003e_onAllComplete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// DL 対象が無い\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_reqParams\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003e_reqParams\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_onAllComplete\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{}\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 失敗したリストを用意\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003efailedList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//各アセットのDownload\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003e_reqParams\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ReqParam is NULL\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003euri\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetServerUrl\u003c/span\u003e\u003cspan class=\"p\"\u003e()}\u003c/span\u003e\u003cspan class=\"s\"\u003e/\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eUNITY_2018_OR_NEWER\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eUnityWebRequest\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eUnityWebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003euri\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eUnityWebRequest\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eUnityWebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003euri\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendif\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 重複ダウンロード禁止\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nf\"\u003eIsAlreadyDownloading\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// Cacheにあるならそっちのロード処理に任せればいい\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundleCacheController\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsCached\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetHash\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//古いキャッシュがあるとDownload失敗するので削除\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssetBundleCacheController\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearTargetOldAssetCache\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetHash\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// DL 開始 \u0026amp; 終了待機\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"[Download] \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eUNITY_2017_3_OR_NEWER\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSendWebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendif\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisSucceeded\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eisHttpError\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eisNetworkError\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eisSucceeded\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edownloadHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e// Cache に保存\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundleCacheController\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetHash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewebRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edownloadHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"[Cache] WriteFile\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOnCompleteDownload\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetHash\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e    \n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efailedList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAssetName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 全工程の終了を確実にするため1f 待つ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 終了コールバック\u003c/span\u003e\n    \u003cspan class=\"n\"\u003e_onAllComplete\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_reqParams\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003efailedList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efailedList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ローカルキャッシュへsaveload\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%B8saveload\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eローカルキャッシュへSave/Load\u003c/h3\u003e\n\n\u003cp\u003eUnity に\u003ca href=\"https://docs.unity3d.com/ja/current/ScriptReference/Caching.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCachingクラス\u003c/a\u003e というものがありますが、2015年頃まではUniteのコロプラさんセッションで話題になっていたUnityのCacheシステムは運用系のゲームではとてもじゃないですが使いづらかった状態でした。（数万AssetがあるとisReady がいつまでもReady になってくれなかったり、Cacheの削除は全削除しかできない→全Assetの再ダウンロードを強要してしまうなど）\u003cbr\u003e\nしかし2017 からは、UnityWebRequestを使うとAssetBundleに関しては自動的にCache 管理をしてくれるという魔法の仕組みがAPIでは提供されていたり、個別削除APIが追加されたりして、\u003ca href=\"https://qiita.com/su10/items/98d7a9f89923b09a2d3c\" id=\"reference-6cab32f40d5be9ad3caf\"\u003eこちら\u003c/a\u003eをはじめ、様々なブログ等でUnity2017で「Caching周りが改善された」という記事をよく目にしました。\u003cbr\u003e\n\u003cdel\u003e当時は自分も「やったぜ」と思っていましたが、検証を行なった結果、怒りで頭がおかしくなりそうでした。\u003cbr\u003e\nそうです。\u003cstrong\u003e「Cachingシステムがまともに動作していない」\u003c/strong\u003e のです。\u003cbr\u003e\n（ちゃんと個別削除APIとか動いてますよという方は報告いただけると嬉しいです。）\u003c/del\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cdel\u003eAPIを叩くもののCacheファイルはいつまでたっても削除されず、削除は全削除しか出来ないので１個ファイルに更新があるたびに全AssetBundleの落とし直しを余儀なくされます。\u003c/del\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cdel\u003eということで\u003cstrong\u003eCachingに関しては using System.IO; して普通にファイル操作を行わないとダメ(つまり自前で実装する)\u003c/strong\u003eです。\u003c/del\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"20180919追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20180919%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cstrong\u003e2018/09/19追記：\u003c/strong\u003e\n\u003c/h4\u003e\n\n\u003cp\u003e\u003ca href=\"/k7a\" class=\"user-mention js-hovercard\" title=\"k7a\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"k7a\"\u003e@k7a\u003c/a\u003e さんから情報を頂き再度検証を行いました。\u003cbr\u003e\n基本的には k7a さんの記事 \u003ca href=\"https://qiita.com/k7a/items/23d909ffeea3bab7dfcb\" id=\"reference-aa3826817c64024656bf\"\u003e[Unity 2018.2] AssetBundleのキャッシュを完全に理解する\u003c/a\u003e で記載の通りでした。（k7aさん、情報提供ありがとうございます）\u003cbr\u003e\n※検証環境：Unity2018.4.8f1 \u003c/p\u003e\n\n\u003cp\u003e自動キャッシュ, 削除に関しては CachedAssetBundle 経由で行うこと（もしくは同等の値を直接設定）で動作の確認が取れました。\u003c/p\u003e\n\n\u003cp\u003eただし、検証の結果\u003cstrong\u003eCaching.IsVersionCached に関しては動作に問題がありました\u003c/strong\u003e。\u003cbr\u003e\nいつの間にか\u003ca href=\"https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Caching.IsVersionCached.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式リファレンス\u003c/a\u003e が\u003cstrong\u003eobsolete になっていた\u003c/strong\u003e 通りで、CachedAssetBundle.name, CachedAssetBundle.hash の組み合わせでも uri, hash128 の組み合わせそれぞれのパターンで応答を見た所、Cacheされているにも関わらずIsVersionCached が常にfalse を返していました。\u003c/p\u003e\n\n\u003cp\u003e対象のAssetBundleがCacheされているかどうかは現状知るすべが無いという感じですね。\u003cbr\u003e\n（何かご存知の方は教えていただけますと助かります。）\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"削除機能の自前実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8A%E9%99%A4%E6%A9%9F%E8%83%BD%E3%81%AE%E8%87%AA%E5%89%8D%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e削除機能の自前実装\u003c/h4\u003e\n\n\u003cp\u003e削除機能を実装するならこんな感じになるかと思います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAssetBundleCacheController.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 指定したAssetBundleをキャッシュから削除\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_bundleName\"\u0026gt;AssetBundle名\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_hash\"\u0026gt;Hash 値\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eClearTargetAssetCache\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsCached\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"Not Cached:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e(Hash:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003e_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateAssetPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 指定したAssetBundleでバージョンが古いもの(=指定Hash値以外のもの)をキャッシュから削除\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_bundleName\"\u0026gt;AssetBundle名\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eClearTargetOldAssetCache\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003edirName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateAssetDirName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogWarning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\" Argument Error\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Dirが存在しないので実質削除完了と等価\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003edirName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 指定Dirにファイルがなければ、実質削除完了と等価\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003efilePaths\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetFiles\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003edirName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efilePaths\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003efilePaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateAssetPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003efilePaths\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// Cache Dir 上にファイルが存在するかどうか\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_assetBundleName\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_hash\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eIsCached\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 読込先\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCreateAssetPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//Validation\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eSaveに関してはFile.WriteAllBytes とかFileStreamを使って書き出せばOK。\u003cbr\u003e\nLoadはAssetBundleクラスのLoadFromFileAsyncメソッドを使えばOK。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"assetbundle-のloadunload-処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assetbundle-%E3%81%AEloadunload-%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssetBundle のLoad/Unload 処理\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"load\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#load\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eLoad\u003c/h4\u003e\n\n\u003cp\u003eAssetBundle のロード処理は少し厄介です。\u003cbr\u003e\nというのも\u003cstrong\u003e同一のAssetBundleを２回ロードしようとするとエラー\u003c/strong\u003eになります。\u003cbr\u003e\nなのでロードリクエストはしっかり自前で管理しないと簡単にロードリクエストが重複してエラーになって進行不能になったり・・・\u003c/p\u003e\n\n\u003cp\u003eよって\u003cbr\u003e\n- ロード済みのAssetBundleは需要がなくなるまでは保持していた方がいい\u003cbr\u003e\n- ロードが重複しないようにリクエストをしっかり管理する\u003c/p\u003e\n\n\u003cp\u003eことが大事になってきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAssetBundleLoadController.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eLoadAssetBundleFromCache\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 既にロード済み\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eTempLoadedDecryptAssetBundleNameList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//対象アセットバンドルが既にロード済み?\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsLoadedBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//一時ロードするAssetBundleリストに登録\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eRegisterTempAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundleCacheController\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateAssetPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003e_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"[Cache] Load:{path}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eAssetBundleCreateRequest\u003c/span\u003e \u003cspan class=\"n\"\u003ereq\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadFromFileAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Load成功していたら登録\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eisSucceeded\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eassetBundle\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Download 成功\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eisSucceeded\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Download してきたAssetBundle の登録\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eAssetManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRegisterAssetData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAssetData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eassetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e    \n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// リクエスト終了\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eUnregisterTempAssetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"unload\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unload\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUnload\u003c/h4\u003e\n\n\u003cp\u003e迂闊に破棄をしてしまうと、同一フレームの後続の処理でロードしようとすると死んだりするので、\u003cbr\u003e\n「\u003cstrong\u003e完全に需要がなくなったタイミングで破棄\u003c/strong\u003e」するのが退治になります。\u003cbr\u003e\nなので、自前で\u003cstrong\u003e参照カウント\u003c/strong\u003eを管理して、参照カウントが0になったタイミングで破棄してあげればOK。\u003c/p\u003e\n\n\u003cp\u003eこんな感じでAssetBundleを管理するクラスを作って、管理\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eAssetData.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// Load済みAssetBundle に関する情報まとめクラス\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAssetData\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIDisposable\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// メンバ変数\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eregion\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e \u003cspan class=\"n\"\u003eMEMBER_VARIABLES\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// AssetBundle名\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003em_bundleName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003em_bundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e;}}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// ロード対象のAssetBundle\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundle\u003c/span\u003e \u003cspan class=\"n\"\u003em_targetBundle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundle\u003c/span\u003e \u003cspan class=\"n\"\u003eTargetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003em_targetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e;}}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 参照カウンタ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003em_refCount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e  \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eRefCount\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003em_refCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;}}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// このBundle のhash 値\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003em_assetHash\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e  \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetHash\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003em_assetHash\u003c/span\u003e\u003cspan class=\"p\"\u003e;}}\u003c/span\u003e\n\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendregion\u003c/span\u003e \u003cspan class=\"c1\"\u003e//) ===== MEMBER_VARIABLES =====\u003c/span\u003e\n\n\n\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 初期化\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eregion\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e \u003cspan class=\"n\"\u003eINIT\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eAssetData\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_bundleName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_refCount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_targetBundle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eAssetData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eAssetBundle\u003c/span\u003e \u003cspan class=\"n\"\u003e_loadedBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_targetBundle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_loadedBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_bundleName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_loadedBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003em_assetHash\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendregion\u003c/span\u003e \u003cspan class=\"c1\"\u003e//) ===== INIT =====\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Dispose\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eregion\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e \u003cspan class=\"n\"\u003eDISPOSE\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 念のためチェック\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eTargetBundle\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eTargetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUnload\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendregion\u003c/span\u003e \u003cspan class=\"c1\"\u003e//) ===== DISPOSE =====\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 参照カウンタ\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eregion\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e \u003cspan class=\"n\"\u003eREFERENCE_COUNT\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetReference\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003em_refCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetRelease\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003em_refCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eRefCount\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//Unload\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eTargetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUnload\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003em_targetBundle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendregion\u003c/span\u003e \u003cspan class=\"c1\"\u003e//) ===== REFERENCE_COUNT =====\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Asset\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eregion\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e \u003cspan class=\"n\"\u003eASSETS\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// このAssetBundle に対象のAssetが存在するか\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_assetName\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eIsContainsAsset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eTargetBundle\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003enames\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTargetBundle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAllAssetNames\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003enames\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendregion\u003c/span\u003e \u003cspan class=\"c1\"\u003e//) ===== ASSETS =====\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"assetbundle-のビルド処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assetbundle-%E3%81%AE%E3%83%93%E3%83%AB%E3%83%89%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssetBundle のビルド処理\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ビルドの前に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%93%E3%83%AB%E3%83%89%E3%81%AE%E5%89%8D%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eビルドの前に\u003c/h4\u003e\n\n\u003cp\u003eUnity謹製ツールの\u003ca href=\"https://github.com/Unity-Technologies/AssetBundles-Browser\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAssetBundleBrowser\u003c/a\u003eの導入を強くオススメします。\u003c/p\u003e\n\n\u003cp\u003eリンクのGithubから落としてくるか、UnityPackageManagerからDLで導入出来ます。\u003cbr\u003e\nただ、導入するときはEditor以下のみで、それ以外は削除してしまった方がいいです。\u003cbr\u003e\n特にTest以下のコードは不要なのと\u003ccode\u003eusing Boo.Lang.Runtime;\u003c/code\u003e という見たく無いコードが紛れてビルドがこけたりするので要注意です（Unityさん、メンテお願いします）\u003c/p\u003e\n\n\u003cp\u003e導入メリットとしては\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e設定しているAssetBundleをGUIでリスト化して見れる\u003c/li\u003e\n\u003cli\u003e各AssetBundleの依存関係や参照しているリソースも見ることが可能\u003c/li\u003e\n\u003cli\u003eリソースをD\u0026amp;DでAssetBundleとして設定可能\u003c/li\u003e\n\u003cli\u003eInspector下の小さいところで名前設定をしなくていい\u003c/li\u003e\n\u003cli\u003eGUIなのでアーティストさんも操作可能→エンジニアのタスク軽減の効果も期待できる\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eなど色々とメリットがあるので非常にオススメです。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ビルドスクリプト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%93%E3%83%AB%E3%83%89%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eビルドスクリプト\u003c/h4\u003e\n\n\u003cp\u003e基本的には\u003ca href=\"https://docs.unity3d.com/ja/current/ScriptReference/BuildPipeline.BuildAssetBundles.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eBuildPipeline.BuildAssetBundle\u003c/a\u003e を叩いてあげれば一応はAssetBundleは焼けます。\u003c/p\u003e\n\n\u003cp\u003eまた、Manifestをちゃんと読み込めれば「更新のあったアセットのみビルド」が行われるインクリメンタルビルドが行われるので、ビルド時間の短縮も自動的にやってくれます。\u003c/p\u003e\n\n\u003cp\u003eここに関しては割と運用スタイルによって異なってくるので割愛します。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"apple-のdownloadサイズ表示義務規約について\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#apple-%E3%81%AEdownload%E3%82%B5%E3%82%A4%E3%82%BA%E8%A1%A8%E7%A4%BA%E7%BE%A9%E5%8B%99%E8%A6%8F%E7%B4%84%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eApple のDownloadサイズ表示義務規約について\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"/midnightSuyama\" class=\"user-mention js-hovercard\" title=\"midnightSuyama\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"midnightSuyama\"\u003e@midnightSuyama\u003c/a\u003e さんの\u003ca href=\"https://qiita.com/midnightSuyama/items/d1addebbc9a620d28eaa\" id=\"reference-1c29f4957fcf5487b0d1\"\u003eApple規約解説記事\u003c/a\u003e（いつもお世話になってます）でも紹介されている通り、追加リソースのダウンロード時にダウンロードサイズを明記する必要がでました。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf your app needs to download additional resources, disclose the size of the download and prompt users before doing so. Existing apps must comply with this guideline in any update submitted after January 1, 2019.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWTF!!\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/06a5826a4c767967b2f4ec605fbcc1a05493cbfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36353235372f36373762366535382d613262642d383535312d326263302d3934333762386238636462662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F677b6e58-a2bd-8551-2bc0-9437b8b8cdbf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=fd41f9ead7946d125bef5015bae7ddb7\" alt=\"rage.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/65257/677b6e58-a2bd-8551-2bc0-9437b8b8cdbf.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2F677b6e58-a2bd-8551-2bc0-9437b8b8cdbf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e10f05345adb06ca0b888f42c9448142 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e既存アプリは対応猶予期間がありますが、新規アプリはマスト対応です。\u003cbr\u003e\nはい。Unityの既存の機能じゃどうしようもありません。\u003c/p\u003e\n\n\u003cp\u003eAssetBundleManifestには「Bundle名」「依存関係」の情報があるので、ここに「サイズ」を追加できると嬉しいですね。\u003c/p\u003e\n\n\u003cp\u003e方針としては\u003cbr\u003e\n- AssetBundleManifest にサイズの項目を追加して読めるようにする\u003cbr\u003e\n- 独自Manifestを作成して対応する\u003c/p\u003e\n\n\u003cp\u003eになります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"拡張マニフェスト対応\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88%E5%AF%BE%E5%BF%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e拡張マニフェスト対応\u003c/h2\u003e\n\n\u003cp\u003eデータを加工したAssetBundleManifestを読むのは技術的に辛かったので、独自マニフェスト実装\u003cdel\u003eに逃げました\u003c/del\u003eをすることにしました。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"独自マニフェスト作成上の注意点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%8B%AC%E8%87%AA%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88%E4%BD%9C%E6%88%90%E4%B8%8A%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e独自マニフェスト作成上の注意点\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eHash値(Hash128) はそれぞれのAssetBundleの個別マニフェストにはありますが、本体には記載されないです\u003c/li\u003e\n\u003cli\u003eAssetBundleManifestはYAMLで書かれている\u003c/li\u003e\n\u003cli\u003eUnity上でのパース速度でいえば JSON \u0026gt; YAML （\u003ca href=\"https://qiita.com/Marimoiro/items/e998584d973baab3aac8\" id=\"reference-e5dcbccb9120074054ba\"\u003e検証記事\u003c/a\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ワークフロー-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%95%E3%83%AD%E3%83%BC-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eワークフロー\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eAssetBundleビルド時に、Bundle名とHash128の値をまとめたテキストファイルを出力\u003c/li\u003e\n\u003cli\u003eYAMLを解析できる外部ツールで解析\u003c/li\u003e\n\u003cli\u003e出力先Dirを探索してサイズを取得\u003c/li\u003e\n\u003cli\u003e１. のハッシュ値情報, 2.のYAML情報, 3. のサイズ情報を統合\u003c/li\u003e\n\u003cli\u003e独自マニフェスト.json を出力\u003c/li\u003e\n\u003cli\u003e他のAssetBundleと一緒に独自マニフェスト.json をアップ\u003c/li\u003e\n\u003cli\u003e公式AssetBundleManifestの代わりに独自マニフェストをDLして利用\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eというワークフローになります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"yaml-の解析\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#yaml-%E3%81%AE%E8%A7%A3%E6%9E%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eYAML の解析\u003c/h3\u003e\n\n\u003cp\u003e個人的にはShellScriptがいいのですが、たまたま他の人から反発を受けたので他を検討したところ\u003cbr\u003e\n\u003ca href=\"https://maku77.github.io/python/io/yaml.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003e を見つけてしまったため、「あ、Pythonならクッソ簡単に行けそう」と判断してPythonで実装していくことにしました。\u003c/p\u003e\n\n\u003cp\u003e早速homebrew でpython3, pip, PyYAML を入れて環境を設定します。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"解析ツールの実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E6%9E%90%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解析ツールの実装\u003c/h4\u003e\n\n\u003cp\u003e正直python を書くのって指で数える程度しか無いですが、こんな感じで生成しました\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eextManifestGenerator.py\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e#!/usr/bin/env python\n# coding: UTF-8\n\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eyaml\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejson\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eos\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003esys\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# コマンドラインから情報を取得\n\u003c/span\u003e\u003cspan class=\"n\"\u003ebuildTarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"n\"\u003eoutputFormat\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n\n\u003cspan class=\"c1\"\u003e# ファイルの読み込み \n\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'/'\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"n\"\u003ebuildTarget\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'.manifest'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'rt'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Parse YAML\n\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eyaml\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esafe_load\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Init Output\n\u003c/span\u003e\u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'ManifestFileVersion'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'ManifestFileVersion'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'CRC'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'CRC'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'BundleList'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Hashリストのロード\n\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'/'\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"n\"\u003ebuildTarget\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'Hash.yaml'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'rt'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ehashfp\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ehashListText\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehashfp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Parse YAML\n\u003c/span\u003e\u003cspan class=\"n\"\u003ehashListYaml\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eyaml\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esafe_load\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehashListText\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Manifest Info\n\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# Create Manifest\n\u003c/span\u003e\u003cspan class=\"n\"\u003einfos\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'AssetBundleManifest'\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s\"\u003e'AssetBundleInfos'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ek1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ev1\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003einfos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ek2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ev2\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# 名前一致で検索\n\u003c/span\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ek2\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e'Name'\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efilepath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'/'\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"n\"\u003ev2\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esize\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetsize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilepath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# 名前を設定\n\u003c/span\u003e            \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ek2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ev2\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# Size設定\n\u003c/span\u003e            \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'Size'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# Hash 値を取得\n\u003c/span\u003e            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ek3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ev3\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ehashListYaml\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'HashList'\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ev3\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'Name'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003ev2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'Hash'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ev3\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'Hash'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"n\"\u003ek2\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e'Dependencies'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'Dependencies'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003edependItem\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edependBundleName\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ev2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'Dependencies'\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003edependBundleName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# パースしたバンドル情報を追加\n\u003c/span\u003e    \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'BundleList'\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eoutputFormat\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e'YAML'\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \n    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'/'\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"n\"\u003ebuildTarget\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'.yaml'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"w\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ewf\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ewf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eyaml\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edefault_flow_style\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"n\"\u003eoutputFormat\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e'JSON'\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'/'\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"n\"\u003ebuildTarget\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"s\"\u003e'.json'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"w\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ewf\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ewf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edumps\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esort_keys\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eindent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"unity側の独自マニフェスト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unity%E5%81%B4%E3%81%AE%E7%8B%AC%E8%87%AA%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUnity側の独自マニフェスト\u003c/h3\u003e\n\n\u003cp\u003e基本的にはAssetBundleManifestで実装しているAPIを作りつつ、サイズを返すAPIを生やしていきます。\u003cbr\u003e\nInterface 的には以下のような感じで実装していけば問題ないはずです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eIExtManifest.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIExtManifest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// AssetBundleManifestAPI\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eregion\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e \u003cspan class=\"n\"\u003eBUNDLE_MANIFEST_API\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 全バンドルリストを返す\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetAllAssetBundles\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// Variant 情報ありでバンドルリストを返す\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetAllAssetBundlesWithVariant\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 指定バンドルの依存バンドルリストを返す\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"assetBundleName\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetAllDependencies\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 指定バンドルと直接依存関係にあるバンドルリストを返す\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"assetBundleName\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetDirectDependencies\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 指定バンドルのハッシュ値を返す\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"assetBundleName\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eHash128\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetAssetBundleHash128\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 指定バンドルのハッシュ値を返す\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"assetBundleName\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetAssetBundleHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendregion\u003c/span\u003e \u003cspan class=\"c1\"\u003e//) ===== BUNDLE_MANIFEST_API =====\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// BundleSizeAPI\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//--------------------------------------------\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eregion\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e \u003cspan class=\"n\"\u003eBUNDLE_SIZE_API\u003c/span\u003e \u003cspan class=\"p\"\u003e=====\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 指定バンドルのサイズを取得[byte]\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_assetBundleName\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetBundleSize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// 指定バンドルサイズの合計値を返す\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"_assetBundleNames\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003eCalcTotalDownloadSize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"k\"\u003eparams\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003e_assetBundleNames\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"n\"\u003eendregion\u003c/span\u003e \u003cspan class=\"c1\"\u003e//) ===== BUNDLE_SIZE_API =====\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"実装に当たって\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A3%85%E3%81%AB%E5%BD%93%E3%81%9F%E3%81%A3%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実装に当たって\u003c/h1\u003e\n\n\u003cp\u003e実際に作って遭遇した問題などを書いていきます\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"apiの方針\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#api%E3%81%AE%E6%96%B9%E9%87%9D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAPIの方針\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eFacade パターンのススメ\n\n\u003cul\u003e\n\u003cli\u003eAddressable AssetもFacadeパターン\u003cbr\u003e\n\u003c/li\u003e\n\u003cli\u003e窓口となるSingletonクラスのAPI以外は外部からは見えないようにする方が使うときに便利\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eDownload 関数は「個別ダウンロード」と「一括ダウンロード」と２つ用意しておくと良いです\n\n\u003cul\u003e\n\u003cli\u003e最近のゲームは初回に一括でダウンロードすることが多くオンデマンドでのダウンロードは珍しい\u003c/li\u003e\n\u003cli\u003e初回DLで満足は厳禁!! iPhone のOSによる自動キャッシュ削除でいつのまにか消えている場合がある\u003c/li\u003e\n\u003cli\u003eAndroidは常にユーザーの任意タイミングでキャッシュを消せるのを念頭におく\u003c/li\u003e\n\u003cli\u003e個人的には初回一括DL＋オンデマンドの併用をオススメ。\u003c/li\u003e\n\u003cli\u003eインゲームへの遷移時間短縮や、マルチプレイ時はマッチング時間短縮のためにも、追加で必要なリソースをオンデマンドでDLできる制約を入れておいた方が無難です。（直前に多量のDLを走らせないためにも）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eSetServerUrl() を用意して、なるべくURLを埋め込まない\n\n\u003cul\u003e\n\u003cli\u003eクライアントコードは基本的に全部解読される前提\u003c/li\u003e\n\u003cli\u003eサーバーリソースを引き抜かれないためにも自己防衛しましょう\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"loadrequest-の制御\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#loadrequest-%E3%81%AE%E5%88%B6%E5%BE%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eLoadRequest の制御\u003c/h2\u003e\n\n\u003cp\u003e非同期でロードリクエストを出す際、コールバックが呼ばれる前に呼び出し側がDestroyされるパターンがあり、それでエラーになることが頻発したので、リクエスト発行時にハンドラを返して、呼び出し元がDestroyされるときに、ハンドラを介してコールバックを実行させないように制御しないとダメでした。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"assetbundle-の命名規則\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assetbundle-%E3%81%AE%E5%91%BD%E5%90%8D%E8%A6%8F%E5%89%87\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssetBundle の命名規則\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eそもそも仕様で大文字が使えない(英数小文字のみ)\u003c/li\u003e\n\u003cli\u003eディレクトリ名+ファイル名をAssetBundle名にしておくと、名称被りが起きづらいし、用途を管理しやすいです\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"最適化について\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E9%81%A9%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最適化について\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eCoroutine よりも使えるならTask, UniRxやAsync/Await などをうまく使った方がいいです\u003c/li\u003e\n\u003cli\u003eNative でやれば絶対早くなります。\n\n\u003cul\u003e\n\u003cli\u003e出来るのは大人数の開発者がいる or 超スーパーエンジニアがいる場合のみ\u003c/li\u003e\n\u003cli\u003eNative のコードは公開されないので個人開発や中小企業は素直にUnityAPIにあやかるべき\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"暗号化について\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e暗号化について\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://qiita.com/snaka/items/a4c16719888bbd23067f\" id=\"reference-8d0ea6bc0b3467e925b2\"\u003eここ\u003c/a\u003e のまとめがすごくよくまとまっています(すごくおすすめです)\u003c/li\u003e\n\u003cli\u003eAssetBundle自体をAESを利用して暗号化をする場合、一旦暗号化AssetBundleをメモリに全て載せないとダメなので、Chunkロードが使えないデメリットがある\u003c/li\u003e\n\u003cli\u003eパフォーマンスをとるか、暗号化をとるかは要検討案件です\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eUnity2018.2 〜が使えるなら頑張ってAdressable Assetsを使って見た方が今後のためにも良いと思います。\u003cbr\u003e\n出来ることなら、もう2度と作りたくないですね（白目\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://creator.game.cyberagent.co.jp/?p=4791\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/neon-izm/items/b105130fac060ec40ad4\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/fukaken5050/items/e69572f963c26015a716\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/su10/items/98d7a9f89923b09a2d3c\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/Marimoiro/items/e998584d973baab3aac8\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/snaka/items/a4c16719888bbd23067f\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://qiita.com/k7a/items/23d909ffeea3bab7dfcb\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n","createdAt":"2018-09-16T09:48:10Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"ykEO8x+MSUlnLVPCnNdZXUYcFK4+j+QF--IE1cqFPRNawaqiZc--CJUt7cgOjIFbM+rcu1d5eg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2018-09-19T12:12:45Z","likesCount":66,"linkUrl":"https://qiita.com/Cova8bitdot/items/20e8962ed0ca0544289d","organization":null,"originalId":693986,"stockedCount":67,"title":"【Unity】【AssetBundle】Unity2017~Unity2018.1 のためのAssetBundle システム構築方法 (2018/09/19追記)","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%94%A8%E8%AA%9E\"\u003e用語\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#assetbundle-%E3%81%A8%E3%81%AF\"\u003eAssetBundle とは\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003eメリット\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#assetbundle-%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003eAssetBundle の仕組みの導入\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A5%BD%E3%81%97%E3%81%9F%E3%81%84%E6%96%B9%E3%81%B8\"\u003e楽したい方へ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A9%9F%E8%83%BD%E3%81%AE%E7%A2%BA%E8%AA%8D\"\u003e機能の確認\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%95%E3%83%AD%E3%83%BC\"\u003eワークフロー\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#download%E5%87%A6%E7%90%86\"\u003eDownload処理\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#assetbundlemanifest%E3%81%AEdownload\"\u003eAssetBundleManifestのDownload\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%B8saveload\"\u003eローカルキャッシュへSave/Load\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#20180919%E8%BF%BD%E8%A8%98\"\u003e2018/09/19追記：\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8A%E9%99%A4%E6%A9%9F%E8%83%BD%E3%81%AE%E8%87%AA%E5%89%8D%E5%AE%9F%E8%A3%85\"\u003e削除機能の自前実装\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#assetbundle-%E3%81%AEloadunload-%E5%87%A6%E7%90%86\"\u003eAssetBundle のLoad/Unload 処理\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#load\"\u003eLoad\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#unload\"\u003eUnload\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#assetbundle-%E3%81%AE%E3%83%93%E3%83%AB%E3%83%89%E5%87%A6%E7%90%86\"\u003eAssetBundle のビルド処理\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%93%E3%83%AB%E3%83%89%E3%81%AE%E5%89%8D%E3%81%AB\"\u003eビルドの前に\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%93%E3%83%AB%E3%83%89%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88\"\u003eビルドスクリプト\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#apple-%E3%81%AEdownload%E3%82%B5%E3%82%A4%E3%82%BA%E8%A1%A8%E7%A4%BA%E7%BE%A9%E5%8B%99%E8%A6%8F%E7%B4%84%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003eApple のDownloadサイズ表示義務規約について\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8B%A1%E5%BC%B5%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88%E5%AF%BE%E5%BF%9C\"\u003e拡張マニフェスト対応\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%8B%AC%E8%87%AA%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88%E4%BD%9C%E6%88%90%E4%B8%8A%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9\"\u003e独自マニフェスト作成上の注意点\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%95%E3%83%AD%E3%83%BC-1\"\u003eワークフロー\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#yaml-%E3%81%AE%E8%A7%A3%E6%9E%90\"\u003eYAML の解析\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A7%A3%E6%9E%90%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e解析ツールの実装\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#unity%E5%81%B4%E3%81%AE%E7%8B%AC%E8%87%AA%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88\"\u003eUnity側の独自マニフェスト\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A3%85%E3%81%AB%E5%BD%93%E3%81%9F%E3%81%A3%E3%81%A6\"\u003e実装に当たって\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#api%E3%81%AE%E6%96%B9%E9%87%9D\"\u003eAPIの方針\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#loadrequest-%E3%81%AE%E5%88%B6%E5%BE%A1\"\u003eLoadRequest の制御\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#assetbundle-%E3%81%AE%E5%91%BD%E5%90%8D%E8%A6%8F%E5%89%87\"\u003eAssetBundle の命名規則\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E9%81%A9%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e最適化について\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e暗号化について\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":14359,"uuid":"20e8962ed0ca0544289d","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"Hk4UgKSHx7YT05WBuJSmfzkuVqM=--MSChgx5NGBrx6Mlu--V5FLMRNj+JWN8vyGL/XCCA==","originalId":65257,"description":"","facebookUrl":null,"githubUrl":"https://github.com/Cova8bitdots","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/65257/profile-images/1524148529","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2Fprofile-images%2F1524148529?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=e03869861a5c95d906bd124103725123","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F65257%2Fprofile-images%2F1524148529?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=5e90c37c2fc83f3d18613c5f27484e28","urlName":"Cova8bitdot","websiteUrl":null,"twitterUrl":"https://twitter.com/8bitdots","twitterUrlName":"8bitdots","revealedOrganizations":{"edges":[]}},"tags":[{"name":"Python","urlName":"python"},{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"YAML","urlName":"yaml"},{"name":"AssetBundle","urlName":"assetbundle"}],"followingLikers":{"edges":[]},"comments":{"totalCount":2}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
