More than 1 year has passed since last update.工場など使用する場合、PCを単一のアプリケーション専用にすることがあります。スタートアップに専用のアプリケーションで登録して即使用(入力)できるようにしたいわけです。Windows 10にてスタートアップからアプリケーション起動後にテキストボックスに入力出来るようになっているはずなのですが、入力を受け付けません。
見た目はアクティブでテキストボックス上はキャレットが点滅しているが入力ができないという状態です。ただ、厄介なことに毎回発生するわけではないです。タスクバーでアイコンが点滅した状態になっており、アプリケーションが正常にアクティブになっていないため。
アプリケーションをマウスクリック等でアクティブにすれば入力ができるようになります。OS起動後にメニューからやexeのダブルクリックなどでアプリケーションを起動する上では問題が発生しないので、スタートアップ登録による起動からだと何かしらの影響により発生してしまうようです。exeのプロパティにて「管理者としてこのプログラムを実行する」にチェックを付けると回避できることを同僚が見つけました。出来るならプログラムで何とか回避したい。
以前の記事「【.NET】ウインドウを一時的に最前面に表示しフォーカスを奪う」で、強制的にアクティブにしたことがあったので、これを採用しました。フォーム起動時にForceActiveWindow()を呼んで強制的にアクティブにします。Windowフォームの場合WPFの場合Windows 7 からWindows 10 に移行する上で問題になりうる一つです。検証する際にチェック対象にしておくといいかも知れませんね。


