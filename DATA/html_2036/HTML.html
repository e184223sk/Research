<!DOCTYPE html><html><head><meta charset="utf-8" /><title>高校生がC#でSHA256暗号化アルゴリズムを完全独自実装してみた。 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/kkent030315/items/3f095208ed083ce9f1e5" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="7RlCQOjllWjDQPYDD6gDVjQETlkJae+NhdlBzFXt3aqJ8TUgIBeOr1vGbF9heVjVyWwDeUG3iC03VVZezrOF0w==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@kento932376" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="高校生がC#でSHA256暗号化アルゴリズムを完全独自実装してみた。 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND02YXVZNXFDaDU1U2Y0NEdNUXlQamdhZFRTRUV5TlRibW1wZmxqN2ZsakpiamdxTGpnNnZqZ3JUamc2cmpncnJqZzZEamdwTGxyb3psaGFqbmk2em9oNnJscnBfb280WGpnWmZqZ2FiamdiX2pnWl9qZ0lJJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTJiN2Q3ZDA2M2NjODc3NTY2N2RmOTU3MzZjNTcyODli&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RyWlc1ME1ETXdNekUxJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZGNmODE1OTVhODU3OTFkY2I5MzVjNmRiNDU2NDgyZGY&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=e64448d9beaf7d232e627dd68b910927"><meta property="og:description" content="高校生の僕がSHA256暗号化アルゴリズムを外部ライブラリやランタイムに一切頼らず、独自で実装してみました。
当記事は、マイクロソフト様にケンカを売る記事ではございません。


前置き



この記事をご覧になっている方々は、様々な分..."><meta content="https://qiita.com/kkent030315/items/3f095208ed083ce9f1e5" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C,C#,アルゴリズム,暗号化,sha256" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-0fcbac6d-1100-4b63-908a-4f912cbe9780"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fkkent030315%2Fitems%2F3f095208ed083ce9f1e5">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fkkent030315%2Fitems%2F3f095208ed083ce9f1e5">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-0fcbac6d-1100-4b63-908a-4f912cbe9780">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/c","name":"C"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-01-14T14:59:26.000+09:00","dateModified":"2020-01-21T06:47:31.000+09:00","headline":"高校生がC#でSHA256暗号化アルゴリズムを完全独自実装してみた。","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND02YXVZNXFDaDU1U2Y0NEdNUXlQamdhZFRTRUV5TlRibW1wZmxqN2ZsakpiamdxTGpnNnZqZ3JUamc2cmpncnJqZzZEamdwTGxyb3psaGFqbmk2em9oNnJscnBfb280WGpnWmZqZ2FiamdiX2pnWl9qZ0lJJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPTJiN2Q3ZDA2M2NjODc3NTY2N2RmOTU3MzZjNTcyODli\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RyWlc1ME1ETXdNekUxJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZGNmODE1OTVhODU3OTFkY2I5MzVjNmRiNDU2NDgyZGY\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=e64448d9beaf7d232e627dd68b910927","mainEntityOfPage":"https://qiita.com/kkent030315/items/3f095208ed083ce9f1e5","author":{"@type":"Person","address":"Japan, Fukuoka","email":"hrn832@protonmail.com","identifier":"kkent030315","name":"kkent030315","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fprofile-images%2F1627665079?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=40ff829c53c059c5406fc09aad5dba9d","url":"https://qiita.com/kkent030315","description":"","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita&amp;utm_medium=header-banner">グループ会社出納業務の証票処理を70％自動化。日立のAI-OCR技術とは？</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kkent030315","type":"items","id":"3f095208ed083ce9f1e5"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"グループ会社出納業務の証票処理を70％自動化。日立のAI-OCR技術とは？","url":"https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kkent030315","type":"items","id":"3f095208ed083ce9f1e5"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"グループ会社出納業務の証票処理を70％自動化。日立のAI-OCR技術とは？","url":"https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kkent030315","type":"items","id":"3f095208ed083ce9f1e5"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"グループ会社出納業務の証票処理を70％自動化。日立のAI-OCR技術とは？","url":"https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/kkent030315/items/3f095208ed083ce9f1e5","location":"/kkent030315/items/3f095208ed083ce9f1e5","scheme":"https","host":"qiita.com","port":null,"pathname":"/kkent030315/items/3f095208ed083ce9f1e5","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"2S3g197XMz3DQxxPvf1SEHtePpFBx9U/Vpe9WKSuHoq9xZe3FiUo+lvFhhPTLAmThjZzsQkZsp/kG6rKP/BG8w==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-e9fac793-f574-495a-b537-770c2803bd52"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kkent030315/items/3f095208ed083ce9f1e5/likers" class="css-1iupg5d">142</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">85</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/3f095208ed083ce9f1e5/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kkent030315/items/3f095208ed083ce9f1e5/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kkent030315/items/3f095208ed083ce9f1e5/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kkent030315/items/3f095208ed083ce9f1e5/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kkent030315/items/3f095208ed083ce9f1e5.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/kkent030315"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/profile-images/1627665079" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/kkent030315" class="css-10ougpm">@<!-- -->kkent030315</a><div class="css-1ay9vb9"><span><meta content="2020-01-14T05:59:26Z"/><time dateTime="2020-01-20T21:47:31Z" class="css-m19uds">updated at 2020-01-20</time></span></div></div></div></div></div><h1 class="css-cgzq40">高校生がC#でSHA256暗号化アルゴリズムを完全独自実装してみた。</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/c" class="css-4czcte">C</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e3%82%a2%e3%83%ab%e3%82%b4%e3%83%aa%e3%82%ba%e3%83%a0" class="css-4czcte">アルゴリズム</a><a href="/tags/%e6%9a%97%e5%8f%b7%e5%8c%96" class="css-4czcte">暗号化</a><a href="/tags/sha256" class="css-4czcte">sha256</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>高校生の僕が<strong>SHA256</strong>暗号化アルゴリズムを外部ライブラリやランタイムに一切頼らず、独自で実装してみました。<br>
当記事は、マイクロソフト様にケンカを売る記事ではございません。</p>

<h1>
<span id="前置き" class="fragment"></span><a href="#%E5%89%8D%E7%BD%AE%E3%81%8D"><i class="fa fa-link"></i></a>前置き</h1>

<p><a href="https://camo.qiitausercontent.com/b64e00cdb705e2d387d35d66cde94cb45c9032e8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f61633237346331372d666635372d633131642d326562392d3030623064666161316232652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fac274c17-ff57-c11d-2eb9-00b0dfaa1b2e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d5c9217764d15ce7f7c631a881364bb0" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/ac274c17-ff57-c11d-2eb9-00b0dfaa1b2e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fac274c17-ff57-c11d-2eb9-00b0dfaa1b2e.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f28be023118f1d790b234e901f51e5d3 1x" loading="lazy"></a></p>

<p>この記事をご覧になっている方々は、様々な分野でお仕事をされている方がいらっしゃると思います。<br>
そういった方々含め、プログラミングを実際にされていない方も「SHA256」という単語は一度でも目に入れた方も多くいらっしゃるのではないでしょうか。</p>

<p><strong>SHA256</strong>とは、アメリカ国家安全保障局によって設計され、<br>
2001年にアメリカ国立標準技術研究所によって連邦情報処理標準とされた暗号化アルゴリズムのひとつです。<br>
SHA256の他にも、「SHA-1」や「SHA-512」といった多くの暗号化アルゴリズムがあります。</p>

<p>そのひとつである「SHA-1」は、2017年にGoogleによって攻撃手段が公開され、<br>
それまでSHA-1を使用していたシステムは半強制的に、より安全な暗号化アルゴリズムへの移行を余儀なくされた。<br>
という事件がありましたね。</p>

<blockquote>
<p>該当記事: <a href="https://gigazine.net/news/20170224-google-cwi-break-sha-1/" rel="nofollow noopener" target="_blank">Googleがハッシュ関数「SHA-1」を破ることに成功</a></p>
</blockquote>

<p>そういった背景もある暗号化アルゴリズム達ですが、今回はなかでも多くの場面で使われている<br>
「SHA-256」をプログラミング言語 C# を使って独自で実装してみたいと思います。</p>

<p>ビットコインを支えている<strong>ブロックチェーン</strong>でも、SHA-256は活躍しています。<br>
ブロックチェーンに関しましては、下記記事をご参照頂くとわかりやすいと思います。</p>

<blockquote>
<p>参考記事: <a href="https://qiita.com/sa2shun/items/f4991357ece3303c7167#4blockchain%E3%81%AE%E5%AE%9F%E8%A3%85" id="reference-a1da5f4c700e21d8aab7">【Python】10分でイキリ高校生がブロックチェーンを初心者に解説してやる！！！</a></p>
</blockquote>

<h1>
<span id="sha256の特徴" class="fragment"></span><a href="#sha256%E3%81%AE%E7%89%B9%E5%BE%B4"><i class="fa fa-link"></i></a>SHA256の特徴</h1>

<p><a href="https://camo.qiitausercontent.com/aedec45c258ede7dd902b7fb14a0e879288ef02f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f64323938346430382d313630632d613736302d356364342d3264363165633339336439642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd2984d08-160c-a760-5cd4-2d61ec393d9d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ea94dc22751b72b638f726d26c1df4e8" alt="weodnmgvbws.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/d2984d08-160c-a760-5cd4-2d61ec393d9d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd2984d08-160c-a760-5cd4-2d61ec393d9d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d293423495f2aa6d68a800d51360afac 1x" loading="lazy"></a></p>

<p>ここまでで、様々な暗号化アルゴリズムがあることがわかりました。<br>
SHA256の特徴は</p>

<ul>
<li>
<strong>一方向性</strong>

<ul>
<li>▶復号化が困難である。</li>
</ul>
</li>
</ul>

<p>ここで、”困難”と言ったのは、<strong>総当り攻撃</strong>による突破が可能であるからです。<br>
論理的には、2^80（2の80乗）という回数総当たりを仕掛ければどれかが当たる、ということです。<br>
現在では、遥かに少ない2^63（2の63乗）という回数で突破できる手法が見つかっているそうです。</p>

<ul>
<li>
<strong>衝突困難</strong>

<ul>
<li>▶SHA-1で使用された攻撃手法。衝突させることが困難である。</li>
</ul>
</li>
</ul>

<p>簡単に言うと、<strong>異なる2つの平文から同一のハッシュ値が得られる脆弱性に強い</strong>ということです。<br>
詳しく知りたい方は、下記の記事を参照下さい。</p>

<blockquote>
<p>参考記事: <a href="http://73spica.tech/blog/sha1-collision/" rel="nofollow noopener" target="_blank">巷で話題のGoogleのSHA-1衝突やってみた</a></p>
</blockquote>

<h1>
<span id="実装してみる" class="fragment"></span><a href="#%E5%AE%9F%E8%A3%85%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>実装してみる</h1>

<p>ここからは、実際にプログラムを書いてC#で暗号化アルゴリズムを再現してみたいと思います。</p>

<h2>
<span id="大まかな処理フロー" class="fragment"></span><a href="#%E5%A4%A7%E3%81%BE%E3%81%8B%E3%81%AA%E5%87%A6%E7%90%86%E3%83%95%E3%83%AD%E3%83%BC"><i class="fa fa-link"></i></a>大まかな処理フロー</h2>

<p>かなり大雑把ではありますが、大まかな処理フローは以下の通りです。</p>

<p><a href="https://camo.qiitausercontent.com/4aac4ef3fedf9c0a2b8411f272c637cd479f723f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f35386536613664632d383239652d643465642d316237352d6633633833633330306236342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F58e6a6dc-829e-d4ed-1b75-f3c83c300b64.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f671a0b76e73d9445892f84158702af6" alt="sha256flow.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/58e6a6dc-829e-d4ed-1b75-f3c83c300b64.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F58e6a6dc-829e-d4ed-1b75-f3c83c300b64.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b4b922c221369baeb2143b0dcaecce1e 1x" loading="lazy"></a></p>

<h3>
<span id="1平文16進数を2進数に変換" class="fragment"></span><a href="#1%E5%B9%B3%E6%96%8716%E9%80%B2%E6%95%B0%E3%82%922%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B"><i class="fa fa-link"></i></a>1.平文(16進数)を2進数に変換</h3>

<p><code>a</code>であれば16進数<code>61</code> 2進数 <code>1100001</code> に変換されます。</p>

<h3>
<span id="2パディング処理" class="fragment"></span><a href="#2%E3%83%91%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>2.パディング処理</h3>

<p>パディング（Padding）と呼ばれる空埋め処理を行います。<br>
1ブロックのサイズは<code>64byte</code>ですので、それ以下であれば空の部分を埋める必要があります。<br>
但し、ただ埋めるだけではダメです。<br>
例として以下のようなブロックがあったとします。<br>
<code>14byte</code>分足りません。これを埋めます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>//50byte
0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000
0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 
</code></pre></div></div>

<p>これを、ただ埋めると何が起こるかは安易に予想できます。<br>
<code>X</code>の部分を0で埋めたとすると、異なるブロックであっても全く同じメッセージブロックが生まれてしまいます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>//46byte
1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000
0000 0100 0000 0110 0000 0000 0000 0000 XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX

//50byte
1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000
0000 0100 0000 0110 0000 0000 0000 0000 0000 0000 XXXX XXXX XXXX XXXX XXXX XXXX XXXX

↓

全く同じブロックが生まれる。
</code></pre></div></div>

<p>そこで、もとのブロックのブロック長を末端に記録します。<br>
<code>B</code>の部分がブロック長を記録した部分です。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>//46byte
1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000
0000 0100 0000 0110 0000 0000 0000 0000 XXXX XXXX XXXX XXXX XXXX BBBB BBBB BBBB BBBB

//50byte
1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000
0000 0100 0000 0110 0000 0000 0000 0000 0000 0000 XXXX XXXX XXXX BBBB BBBB BBBB BBBB
</code></pre></div></div>

<p>ブロック長が64byte丁度だったり、万が一記録する余裕が無かっただった場合は次のブロックで記録します。</p>

<h3>
<span id="3ブロックをメッセージブロックに分割" class="fragment"></span><a href="#3%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%82%92%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AB%E5%88%86%E5%89%B2"><i class="fa fa-link"></i></a>3.ブロックをメッセージブロックに分割</h3>

<p>パディングが済んだ512byteのブロックを64byte長のメッセージブロックへと分割します。</p>

<h3>
<span id="4初期ベクトルを使用してハッシュ値を算出" class="fragment"></span><a href="#4%E5%88%9D%E6%9C%9F%E3%83%99%E3%82%AF%E3%83%88%E3%83%AB%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E7%AE%97%E5%87%BA"><i class="fa fa-link"></i></a>4.初期ベクトルを使用してハッシュ値を算出</h3>

<p>初回ラウンドでは、初期ベクトル（IV）を使用します。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 初期ハッシュ</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">private</span> <span class="kt">uint</span><span class="p">[]</span> <span class="n">initial_hash</span> <span class="p">=</span> 
<span class="p">{</span> 
    <span class="m">0x6a09e667</span><span class="p">,</span> <span class="m">0xbb67ae85</span><span class="p">,</span> <span class="m">0x3c6ef372</span><span class="p">,</span> <span class="m">0xa54ff53a</span><span class="p">,</span> 
    <span class="m">0x510e527f</span><span class="p">,</span> <span class="m">0x9b05688c</span><span class="p">,</span> <span class="m">0x1f83d9ab</span><span class="p">,</span> <span class="m">0x5be0cd19</span> 
<span class="p">};</span>
</code></pre></div></div>

<h3>
<span id="5合計64ラウンド処理を行う" class="fragment"></span><a href="#5%E5%90%88%E8%A8%8864%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%86"><i class="fa fa-link"></i></a>5.合計64ラウンド処理を行う</h3>

<p>行う処理は簡単に以下の通りです。</p>

<p><a href="https://camo.qiitausercontent.com/ac05cb102f004f8e62a26633692a31c597012c55/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f64353064616365352d353463382d346435302d343465342d3734353765326265366566622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd50dace5-54c8-4d50-44e4-7457e2be6efb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=78ebe15498bb0e1a5657bdf750b8bfde" alt="sha256flow2.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/d50dace5-54c8-4d50-44e4-7457e2be6efb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd50dace5-54c8-4d50-44e4-7457e2be6efb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a6ac6acb6d85548943b3d220c653aa2d 1x" loading="lazy"></a></p>

<h4>
<span id="論理代数" class="fragment"></span><a href="#%E8%AB%96%E7%90%86%E4%BB%A3%E6%95%B0"><i class="fa fa-link"></i></a>論理代数</h4>

<p>ここからは論理代数の分野です。<br>
正直なところ、僕もふわっとしか理解できていません。<br>
一通り調べてはみましたが、情報そのものが正しいものであるか区別する手段がありませんでしたので、<br>
あくまで参考として記載します。<br>
詳しい方がいらっしゃいましたら、コメント欄にて解説をお願い致します。</p>

<blockquote>
<p>参考記事: <a href="http://maicommon.ciao.jp/ss/dscrtMath2/alg/" rel="nofollow noopener" target="_blank">論理代数を学ぼう</a><br>
参考記事: <a href="http://www.ieice-hbkb.org/files/01/01gun_08hen_01.pdf" rel="nofollow noopener" target="_blank">論理代数と論理関数　湊 真一</a></p>
</blockquote>

<h4>
<span id="ch" class="fragment"></span><a href="#ch"><i class="fa fa-link"></i></a>Ch</h4>

<div class="code-frame" data-lang="math"><div class="highlight"><pre class="with-code"><code>Ch(E,F,G) = (E \Lambda F)　Xor　(\rightharpoondown E \Lambda G)
</code></pre></div></div>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="kt">uint</span> <span class="nf">Ch</span><span class="p">(</span><span class="kt">uint</span> <span class="n">x</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">y</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="p">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="p">^</span> <span class="p">(~</span><span class="n">x</span> <span class="p">&amp;</span> <span class="n">z</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h4>
<span id="maj-変数多数決関数" class="fragment"></span><a href="#maj-%E5%A4%89%E6%95%B0%E5%A4%9A%E6%95%B0%E6%B1%BA%E9%96%A2%E6%95%B0"><i class="fa fa-link"></i></a>Maj (変数多数決関数)</h4>

<div class="code-frame" data-lang="math"><div class="highlight"><pre class="with-code"><code>Maj(A,B,C) = (A \Lambda B)　Xor　(A \Lambda C)　Xor　(B \Lambda C)
</code></pre></div></div>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="kt">uint</span> <span class="nf">Maj</span><span class="p">(</span><span class="kt">uint</span> <span class="n">x</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">y</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="p">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="p">^</span> <span class="p">(</span><span class="n">x</span> <span class="p">&amp;</span> <span class="n">z</span><span class="p">)</span> <span class="p">^</span> <span class="p">(</span><span class="n">y</span> <span class="p">&amp;</span> <span class="n">z</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h4>
<span id="rotr-rotation-right" class="fragment"></span><a href="#rotr-rotation-right"><i class="fa fa-link"></i></a>RotR (Rotation Right)</h4>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="kt">uint</span> <span class="nf">Rot_R</span><span class="p">(</span><span class="kt">uint</span> <span class="n">x</span><span class="p">,</span> <span class="kt">byte</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="p">&gt;&gt;</span> <span class="n">n</span><span class="p">)</span> <span class="p">|</span> <span class="p">(</span><span class="n">x</span> <span class="p">&lt;&lt;</span> <span class="p">(</span><span class="m">32</span> <span class="p">-</span> <span class="n">n</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h4>
<span id="rotl-rotation-left" class="fragment"></span><a href="#rotl-rotation-left"><i class="fa fa-link"></i></a>RotL (Rotation Left)</h4>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="kt">uint</span> <span class="nf">Rot_L</span><span class="p">(</span><span class="kt">uint</span> <span class="n">x</span><span class="p">,</span> <span class="kt">byte</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="p">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="p">|</span> <span class="p">(</span><span class="n">x</span> <span class="p">&gt;&gt;</span> <span class="p">(</span><span class="m">32</span> <span class="p">-</span> <span class="n">n</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h4>
<span id="σ0-sigma0" class="fragment"></span><a href="#%CF%830-sigma0"><i class="fa fa-link"></i></a>Σ0 (Sigma0)</h4>

<div class="code-frame" data-lang="math"><div class="highlight"><pre class="with-code"><code>\sum 0 (A) = (A \ggg 2)　Xor　(A \ggg 13)　Xor　(A \ggg 22)
</code></pre></div></div>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="kt">uint</span> <span class="nf">Sigma0</span><span class="p">(</span><span class="kt">uint</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nf">Rot_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">^</span> <span class="nf">Rot_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">13</span><span class="p">)</span> <span class="p">^</span> <span class="nf">Rot_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">22</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h4>
<span id="σ1-sigma1" class="fragment"></span><a href="#%CF%831-sigma1"><i class="fa fa-link"></i></a>Σ1 (Sigma1)</h4>

<div class="code-frame" data-lang="math"><div class="highlight"><pre class="with-code"><code>\sum 1 (E) = (E \ggg 6)　Xor　(E \ggg 11)　Xor　(E \ggg 25)
</code></pre></div></div>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="kt">uint</span> <span class="nf">Sigma1</span><span class="p">(</span><span class="kt">uint</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nf">Rot_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span> <span class="p">^</span> <span class="nf">Rot_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">11</span><span class="p">)</span> <span class="p">^</span> <span class="nf">Rot_R</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">25</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2>
<span id="cソースコード" class="fragment"></span><a href="#c%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>C#ソースコード</h2>

<p>ここからは、実際のソースコードを紹介します。</p>

<h3>
<span id="定数k" class="fragment"></span><a href="#%E5%AE%9A%E6%95%B0k"><i class="fa fa-link"></i></a>定数K</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Kと呼ばれる定数</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">private</span> <span class="k">readonly</span> <span class="kt">uint</span><span class="p">[]</span> <span class="n">const_k</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">uint</span><span class="p">[</span><span class="m">64</span><span class="p">]</span> 
<span class="p">{</span>
    <span class="m">0x428A2F98</span><span class="p">,</span> <span class="m">0x71374491</span><span class="p">,</span> <span class="m">0xB5C0FBCF</span><span class="p">,</span> <span class="m">0xE9B5DBA5</span><span class="p">,</span> 
    <span class="m">0x3956C25B</span><span class="p">,</span> <span class="m">0x59F111F1</span><span class="p">,</span> <span class="m">0x923F82A4</span><span class="p">,</span> <span class="m">0xAB1C5ED5</span><span class="p">,</span>
    <span class="m">0xD807AA98</span><span class="p">,</span> <span class="m">0x12835B01</span><span class="p">,</span> <span class="m">0x243185BE</span><span class="p">,</span> <span class="m">0x550C7DC3</span><span class="p">,</span> 
    <span class="m">0x72BE5D74</span><span class="p">,</span> <span class="m">0x80DEB1FE</span><span class="p">,</span> <span class="m">0x9BDC06A7</span><span class="p">,</span> <span class="m">0xC19BF174</span><span class="p">,</span>
    <span class="m">0xE49B69C1</span><span class="p">,</span> <span class="m">0xEFBE4786</span><span class="p">,</span> <span class="m">0x0FC19DC6</span><span class="p">,</span> <span class="m">0x240CA1CC</span><span class="p">,</span> 
    <span class="m">0x2DE92C6F</span><span class="p">,</span> <span class="m">0x4A7484AA</span><span class="p">,</span> <span class="m">0x5CB0A9DC</span><span class="p">,</span> <span class="m">0x76F988DA</span><span class="p">,</span>
    <span class="m">0x983E5152</span><span class="p">,</span> <span class="m">0xA831C66D</span><span class="p">,</span> <span class="m">0xB00327C8</span><span class="p">,</span> <span class="m">0xBF597FC7</span><span class="p">,</span> 
    <span class="m">0xC6E00BF3</span><span class="p">,</span> <span class="m">0xD5A79147</span><span class="p">,</span> <span class="m">0x06CA6351</span><span class="p">,</span> <span class="m">0x14292967</span><span class="p">,</span>
    <span class="m">0x27B70A85</span><span class="p">,</span> <span class="m">0x2E1B2138</span><span class="p">,</span> <span class="m">0x4D2C6DFC</span><span class="p">,</span> <span class="m">0x53380D13</span><span class="p">,</span> 
    <span class="m">0x650A7354</span><span class="p">,</span> <span class="m">0x766A0ABB</span><span class="p">,</span> <span class="m">0x81C2C92E</span><span class="p">,</span> <span class="m">0x92722C85</span><span class="p">,</span>
    <span class="m">0xA2BFE8A1</span><span class="p">,</span> <span class="m">0xA81A664B</span><span class="p">,</span> <span class="m">0xC24B8B70</span><span class="p">,</span> <span class="m">0xC76C51A3</span><span class="p">,</span> 
    <span class="m">0xD192E819</span><span class="p">,</span> <span class="m">0xD6990624</span><span class="p">,</span> <span class="m">0xF40E3585</span><span class="p">,</span> <span class="m">0x106AA070</span><span class="p">,</span>
    <span class="m">0x19A4C116</span><span class="p">,</span> <span class="m">0x1E376C08</span><span class="p">,</span> <span class="m">0x2748774C</span><span class="p">,</span> <span class="m">0x34B0BCB5</span><span class="p">,</span> 
    <span class="m">0x391C0CB3</span><span class="p">,</span> <span class="m">0x4ED8AA4A</span><span class="p">,</span> <span class="m">0x5B9CCA4F</span><span class="p">,</span> <span class="m">0x682E6FF3</span><span class="p">,</span>
    <span class="m">0x748F82EE</span><span class="p">,</span> <span class="m">0x78A5636F</span><span class="p">,</span> <span class="m">0x84C87814</span><span class="p">,</span> <span class="m">0x8CC70208</span><span class="p">,</span> 
    <span class="m">0x90BEFFFA</span><span class="p">,</span> <span class="m">0xA4506CEB</span><span class="p">,</span> <span class="m">0xBEF9A3F7</span><span class="p">,</span> <span class="m">0xC67178F2</span>
<span class="p">};</span>
</code></pre></div></div>

<h3>
<span id="computehash-関数---ハッシュ値を算出" class="fragment"></span><a href="#computehash-%E9%96%A2%E6%95%B0---%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E7%AE%97%E5%87%BA"><i class="fa fa-link"></i></a>ComputeHash() 関数 - ハッシュ値を算出</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// SHA256ハッシュを生成します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="plainText"&gt;暗号化したい文字列&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;暗号化された文字列&lt;/returns&gt;</span>
<span class="k">public</span> <span class="kt">string</span> <span class="nf">ComputeHash</span><span class="p">(</span><span class="kt">string</span> <span class="n">plainText</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">p</span> <span class="p">=</span> <span class="nf">Padding</span><span class="p">(</span><span class="n">plainText</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">block_list</span> <span class="p">=</span> <span class="nf">Parse</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">s</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">uint</span><span class="p">[</span><span class="m">8</span><span class="p">];</span>
    <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">initial_hash</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">initial_hash</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>

    <span class="c1">//ブロックリストの中のブロックにスコープを当てる</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">block</span> <span class="k">in</span> <span class="n">block_list</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">pair</span> <span class="p">=</span> <span class="nf">MakePair</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">expanded_block</span> <span class="p">=</span> <span class="nf">ExpandBlock</span><span class="p">(</span><span class="n">block</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">n</span> <span class="p">&lt;</span> <span class="m">64</span><span class="p">;</span> <span class="p">++</span><span class="n">n</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">CH</span> <span class="p">=</span> <span class="nf">Ch</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"e"</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="s">"f"</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="s">"g"</span><span class="p">]);</span>
            <span class="kt">var</span> <span class="n">MAJ</span> <span class="p">=</span> <span class="nf">Maj</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"a"</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="s">"b"</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="s">"c"</span><span class="p">]);</span>
            <span class="kt">var</span> <span class="n">SIG0</span> <span class="p">=</span> <span class="nf">Sigma0</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"a"</span><span class="p">]);</span>
            <span class="kt">var</span> <span class="n">SIG1</span> <span class="p">=</span> <span class="nf">Sigma1</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"e"</span><span class="p">]);</span>

            <span class="kt">var</span> <span class="n">WJ_KJ</span> <span class="p">=</span> <span class="p">(</span><span class="n">const_k</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">+</span> <span class="n">expanded_block</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
            <span class="kt">var</span> <span class="n">T1_TEMP</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"h"</span><span class="p">]</span> <span class="p">+</span> <span class="n">WJ_KJ</span> <span class="p">+</span> <span class="n">CH</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">T1</span> <span class="p">=</span> <span class="p">(</span><span class="n">T1_TEMP</span> <span class="p">+</span> <span class="n">SIG1</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">T2</span> <span class="p">=</span> <span class="p">(</span><span class="n">SIG0</span> <span class="p">+</span> <span class="n">MAJ</span><span class="p">);</span>

            <span class="n">pair</span><span class="p">[</span><span class="s">"h"</span><span class="p">]</span> <span class="p">=</span> <span class="n">pair</span><span class="p">[</span><span class="s">"g"</span><span class="p">];</span>
            <span class="n">pair</span><span class="p">[</span><span class="s">"g"</span><span class="p">]</span> <span class="p">=</span> <span class="n">pair</span><span class="p">[</span><span class="s">"f"</span><span class="p">];</span>
            <span class="n">pair</span><span class="p">[</span><span class="s">"f"</span><span class="p">]</span> <span class="p">=</span> <span class="n">pair</span><span class="p">[</span><span class="s">"e"</span><span class="p">];</span>
            <span class="n">pair</span><span class="p">[</span><span class="s">"e"</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"d"</span><span class="p">]</span> <span class="p">+</span> <span class="n">T1</span><span class="p">);</span>
            <span class="n">pair</span><span class="p">[</span><span class="s">"d"</span><span class="p">]</span> <span class="p">=</span> <span class="n">pair</span><span class="p">[</span><span class="s">"c"</span><span class="p">];</span>
            <span class="n">pair</span><span class="p">[</span><span class="s">"c"</span><span class="p">]</span> <span class="p">=</span> <span class="n">pair</span><span class="p">[</span><span class="s">"b"</span><span class="p">];</span>
            <span class="n">pair</span><span class="p">[</span><span class="s">"b"</span><span class="p">]</span> <span class="p">=</span> <span class="n">pair</span><span class="p">[</span><span class="s">"a"</span><span class="p">];</span>
            <span class="n">pair</span><span class="p">[</span><span class="s">"a"</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">T1</span> <span class="p">+</span> <span class="n">T2</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">s</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"a"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"b"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"c"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">2</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">[</span><span class="m">3</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"d"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">3</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">[</span><span class="m">4</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"e"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">4</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">[</span><span class="m">5</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"f"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">5</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">[</span><span class="m">6</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"g"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">6</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">[</span><span class="m">7</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s">"h"</span><span class="p">]</span> <span class="p">+</span> <span class="n">s</span><span class="p">[</span><span class="m">7</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nf">MakeHash</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="touint32array-関数---2進数に変換" class="fragment"></span><a href="#touint32array-%E9%96%A2%E6%95%B0---2%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B"><i class="fa fa-link"></i></a>ToUInt32Array() 関数 - 2進数に変換</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Stringを2進数に変換します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="plain_text"&gt;暗号化する文字列&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;2進数配列&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">uint</span><span class="p">[]</span> <span class="nf">ToUInt32Array</span><span class="p">(</span><span class="kt">string</span> <span class="n">plain_text</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//文字列を16進数に変換. 実体はbyte配列</span>
    <span class="kt">var</span> <span class="n">a</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">plain_text</span><span class="p">);</span>

    <span class="c1">//結果を格納する配列</span>
    <span class="kt">uint</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="p">{</span> <span class="p">};</span>

    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">n</span> <span class="k">in</span> <span class="n">a</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//16進数を2進数に変換</span>
        <span class="kt">var</span> <span class="n">j</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">2</span><span class="p">));</span>
        <span class="kt">var</span> <span class="n">len</span> <span class="p">=</span> <span class="n">j</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="n">Length</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">fill_len</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="c1">//2進数を8桁に揃える  0を先頭に追加</span>
        <span class="k">if</span><span class="p">(</span><span class="n">len</span> <span class="p">&lt;</span> <span class="m">8</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//2進数が8桁以下であったとき、埋めるべき数は |8 - len| である</span>
            <span class="n">fill_len</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="m">8</span> <span class="p">-</span> <span class="n">len</span><span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">fill_len</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">fill_len</span><span class="p">--;</span>
                <span class="nf">SelfAppend</span><span class="p">(</span><span class="k">ref</span> <span class="n">result</span><span class="p">,</span> <span class="m">0u</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nf">SelfConcat</span><span class="p">(</span><span class="k">ref</span> <span class="n">result</span><span class="p">,</span> <span class="nf">ToArray</span><span class="p">((</span><span class="kt">uint</span><span class="p">)</span><span class="n">j</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="calculatek-関数---kを算出" class="fragment"></span><a href="#calculatek-%E9%96%A2%E6%95%B0---k%E3%82%92%E7%AE%97%E5%87%BA"><i class="fa fa-link"></i></a>CalculateK() 関数 - Kを算出</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 与えられた配列から定数Kを算出します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="plain_bits"&gt;算出された数&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;定数K&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">uint</span> <span class="nf">CalculateK</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="n">plain_bits</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">uint</span> <span class="n">k</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">length</span> <span class="p">=</span> <span class="n">plain_bits</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">((</span><span class="n">length</span> <span class="p">+</span> <span class="m">1</span> <span class="p">+</span> <span class="n">k</span><span class="p">)</span> <span class="p">%</span> <span class="m">512</span> <span class="p">!=</span> <span class="m">448</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">k</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">k</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="padding-関数---パディング" class="fragment"></span><a href="#padding-%E9%96%A2%E6%95%B0---%E3%83%91%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>Padding() 関数 - パディング</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// パディングと呼ばれる、空埋め処理を行います。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="plain_text"&gt;パディングする2進数配列&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;パディングされた2進数配列&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">uint</span><span class="p">[]</span> <span class="nf">Padding</span><span class="p">(</span><span class="kt">string</span> <span class="n">plain_text</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">plain_bits</span> <span class="p">=</span> <span class="nf">ToUInt32Array</span><span class="p">(</span><span class="n">plain_text</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">length</span> <span class="p">=</span> <span class="n">plain_bits</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">k</span> <span class="p">=</span> <span class="nf">CalculateK</span><span class="p">(</span><span class="n">plain_bits</span><span class="p">);</span>

    <span class="c1">//処理する値を保持するバッファ</span>
    <span class="kt">uint</span><span class="p">[]</span> <span class="n">buf</span> <span class="p">=</span> <span class="p">{</span> <span class="p">};</span>

    <span class="n">buf</span> <span class="p">=</span> <span class="n">Extend</span><span class="p">&lt;</span><span class="kt">uint</span><span class="p">&gt;(</span><span class="n">plain_bits</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">r</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">r</span> <span class="p">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">r</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="nf">SelfAppend</span><span class="p">(</span><span class="k">ref</span> <span class="n">buf</span><span class="p">,</span> <span class="m">0u</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">var</span> <span class="n">bytStr</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>

    <span class="c1">//64桁右寄せゼロ埋め</span>
    <span class="c1">//0000000000000000000000000000000000000000000000000000000000011000</span>
    <span class="n">bytStr</span> <span class="p">=</span> <span class="n">bytStr</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">PadLeft</span><span class="p">(</span><span class="m">64</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">);</span>

    <span class="c1">//↑で得た64桁の数列を配列に変換</span>
    <span class="c1">//(64)[ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0 ]</span>
    <span class="kt">uint</span><span class="p">[]</span> <span class="n">bytStr_array</span> <span class="p">=</span> <span class="p">{</span> <span class="p">};</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;=</span> <span class="m">63</span><span class="p">;</span> <span class="n">x</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">num_str</span> <span class="p">=</span> <span class="n">bytStr</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">num</span> <span class="p">=</span> <span class="kt">uint</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">num_str</span><span class="p">);</span>
        <span class="nf">SelfAppend</span><span class="p">(</span><span class="k">ref</span> <span class="n">bytStr_array</span><span class="p">,</span> <span class="n">num</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//位取り バッファにAppend</span>
    <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">b</span> <span class="k">in</span> <span class="n">bytStr_array</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nf">SelfAppend</span><span class="p">(</span><span class="k">ref</span> <span class="n">buf</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
    <span class="p">}</span>

<span class="cp">#if DEBUG
</span>    <span class="c1">//ブロックサイズはパディング後512である</span>
    <span class="c1">//Assert(buf.Length != 512)</span>
    <span class="nf">PrintArray</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span> <span class="c1">//512</span>
<span class="cp">#endif
</span>
    <span class="k">return</span> <span class="n">buf</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="parse-関数---ブロックの分割" class="fragment"></span><a href="#parse-%E9%96%A2%E6%95%B0---%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E5%88%86%E5%89%B2"><i class="fa fa-link"></i></a>Parse() 関数 - ブロックの分割</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// パディングされた配列を512バイトのブロック長に分割します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="plain_bits"&gt;分割する2進数配列&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;分割された2進数ブロック一覧を格納したリスト&lt;/returns&gt;</span>
<span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">uint</span><span class="p">[</span><span class="k">]&gt;</span> <span class="nf">Parse</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="n">plain_bits</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">uint</span><span class="p">[</span><span class="k">]&gt;</span><span class="p">();</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">BLOCK_SIZE</span> <span class="p">=</span> <span class="m">512</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">length</span> <span class="p">=</span> <span class="n">plain_bits</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">num_blocks</span> <span class="p">=</span> <span class="n">length</span> <span class="p">/</span> <span class="n">BLOCK_SIZE</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">n</span> <span class="p">&lt;</span> <span class="n">num_blocks</span><span class="p">;</span> <span class="n">n</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">block</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">uint</span><span class="p">[</span><span class="n">BLOCK_SIZE</span><span class="p">];</span>
        <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">plain_bits</span><span class="p">,</span> <span class="n">n</span> <span class="p">*</span> <span class="n">BLOCK_SIZE</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">);</span>

        <span class="c1">//ブロックリストに追加</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">block</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="expandblock-関数---ブロックのプレ処理" class="fragment"></span><a href="#expandblock-%E9%96%A2%E6%95%B0---%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E3%83%97%E3%83%AC%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>ExpandBlock() 関数 - ブロックのプレ処理</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// ブロックを処理します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="block"&gt;64バイトの2進数ブロック配列&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;処理された2進数ブロック配列&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">uint</span><span class="p">[]</span> <span class="nf">ExpandBlock</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="n">block</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">uint</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="p">{</span> <span class="p">};</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="m">16</span><span class="p">;</span> <span class="n">x</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="c1">//例</span>
        <span class="c1">//バイナリ -&gt; ヘックスデシマル -&gt; uint OR バイナリ -&gt; demical</span>
        <span class="c1">//↓チャンクバイナリ 01100001011000100110001110000000 は ヘックスデミカル 0x61626380 である.</span>
        <span class="c1">//CHUNK: [ 32 ] [0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</span>
        <span class="c1">//= 0x61626380 したがって uint は 1633837952</span>

        <span class="c1">//コピー先のチャンク配列</span>
        <span class="kt">uint</span><span class="p">[]</span> <span class="n">chunk_array</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">uint</span><span class="p">[</span><span class="m">32</span><span class="p">];</span>
        <span class="c1">//ブロックの x*32 から 32byte先までをコピー</span>
        <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">x</span><span class="p">*</span><span class="m">32</span><span class="p">,</span> <span class="n">chunk_array</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">32</span><span class="p">);</span>
        <span class="c1">//バイナリに変換</span>
        <span class="kt">var</span> <span class="n">chunk_binary_str</span> <span class="p">=</span> <span class="nf">ToBinary</span><span class="p">(</span><span class="n">chunk_array</span><span class="p">);</span>

        <span class="kt">var</span> <span class="n">chunk_decimal</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToUInt32</span><span class="p">(</span><span class="n">chunk_binary_str</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>

        <span class="nf">SelfAppend</span><span class="p">(</span><span class="k">ref</span> <span class="n">result</span><span class="p">,</span> <span class="n">chunk_decimal</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="p">=</span> <span class="m">16</span><span class="p">;</span> <span class="n">y</span> <span class="p">&lt;</span> <span class="m">64</span><span class="p">;</span> <span class="n">y</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">T1</span> <span class="p">=</span> <span class="nf">Sub0</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">y</span> <span class="p">-</span> <span class="m">15</span><span class="p">])</span> <span class="p">+</span> <span class="n">result</span><span class="p">[</span><span class="n">y</span> <span class="p">-</span> <span class="m">16</span><span class="p">];</span>
        <span class="kt">var</span> <span class="n">T2</span> <span class="p">=</span> <span class="n">T1</span> <span class="p">+</span> <span class="n">result</span><span class="p">[</span><span class="n">y</span> <span class="p">-</span> <span class="m">7</span><span class="p">];</span>
        <span class="kt">var</span> <span class="n">T3</span> <span class="p">=</span> <span class="n">T2</span> <span class="p">+</span> <span class="nf">Sub1</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">y</span> <span class="p">-</span> <span class="m">2</span><span class="p">]);</span>

        <span class="nf">SelfAppend</span><span class="p">(</span><span class="k">ref</span> <span class="n">result</span><span class="p">,</span> <span class="n">T3</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="makepair-関数---ペアを生成" class="fragment"></span><a href="#makepair-%E9%96%A2%E6%95%B0---%E3%83%9A%E3%82%A2%E3%82%92%E7%94%9F%E6%88%90"><i class="fa fa-link"></i></a>MakePair() 関数 - ペアを生成</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 計算をより楽に、分かりやすくするためにStringとのペアを生成します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="hash"&gt;ペアと対になる2進数配列&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;ペアを格納したディクショナリ&lt;/returns&gt;</span>
<span class="k">private</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">&gt;</span> <span class="nf">MakePair</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="n">hash</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">dictionary</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">uint</span><span class="p">&gt;();</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"b"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"c"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">2</span><span class="p">]);</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"d"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">3</span><span class="p">]);</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"e"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">4</span><span class="p">]);</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"f"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">5</span><span class="p">]);</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"g"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">6</span><span class="p">]);</span>
    <span class="n">dictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"h"</span><span class="p">,</span> <span class="n">hash</span><span class="p">[</span><span class="m">7</span><span class="p">]);</span>

    <span class="k">return</span> <span class="n">dictionary</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="makehash-関数---16進数に変換" class="fragment"></span><a href="#makehash-%E9%96%A2%E6%95%B0---16%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B"><i class="fa fa-link"></i></a>MakeHash() 関数 - 16進数に変換</h3>

<p>追記(2)より、一度<code>byte[32]</code>に変換しないと<code>0</code>が抜け落ちる模様。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 2進数を16進数の文字列に変換します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="s"&gt;変換したい2進数配列&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;変換された文字列&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">string</span> <span class="nf">MakeHash</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">s_byte_array</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">SelectMany</span><span class="p">((</span><span class="n">v</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="nf">Reverse</span><span class="p">()).</span><span class="nf">ToArray</span><span class="p">();</span>
    <span class="kt">var</span> <span class="n">result_str</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">s_byte_array</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">v</span> <span class="p">=&gt;</span> <span class="s">$"</span><span class="p">{</span><span class="n">v</span><span class="p">:</span><span class="n">X2</span><span class="p">}</span><span class="s">"</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">result_str</span><span class="p">.</span><span class="nf">ToLower</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="tobinary-関数---バイナリに変換" class="fragment"></span><a href="#tobinary-%E9%96%A2%E6%95%B0---%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%81%AB%E5%A4%89%E6%8F%9B"><i class="fa fa-link"></i></a>ToBinary() 関数 - バイナリに変換</h3>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// チャンクをバイナリに変換します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="chunk"&gt;&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;変換されたバイナリ&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">string</span> <span class="nf">ToBinary</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="n">chunk</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

    <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">n</span> <span class="k">in</span> <span class="n">chunk</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">result</span> <span class="p">+=</span> <span class="n">n</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="binarytodecimal-関数---デシマルに変換" class="fragment"></span><a href="#binarytodecimal-%E9%96%A2%E6%95%B0---%E3%83%87%E3%82%B7%E3%83%9E%E3%83%AB%E3%81%AB%E5%A4%89%E6%8F%9B"><i class="fa fa-link"></i></a>BinaryTodecimal() 関数 - デシマルに変換</h3>

<p><code>Convert.ToString(value, 16)</code> を使う方法もあります。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// バイナリをデシマル Integer に変換します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="binary_str"&gt;バイナリ&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;デシマル Integer&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">int</span> <span class="nf">BinaryToDecimal</span><span class="p">(</span><span class="kt">string</span> <span class="n">binary_str</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">char</span><span class="p">[]</span> <span class="n">binary_char_array</span> <span class="p">=</span> <span class="n">binary_str</span><span class="p">.</span><span class="nf">ToCharArray</span><span class="p">();</span>
    <span class="n">Array</span><span class="p">.</span><span class="nf">Reverse</span><span class="p">(</span><span class="n">binary_char_array</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">binary_char_array</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">binary_char_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="sc">'1'</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">result</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">result</span> <span class="p">+=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="nf">Pow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2>
<span id="自作便利関数" class="fragment"></span><a href="#%E8%87%AA%E4%BD%9C%E4%BE%BF%E5%88%A9%E9%96%A2%E6%95%B0"><i class="fa fa-link"></i></a>自作便利関数</h2>

<p>やっていて、色々と不便に感じた部分や簡略化したい部分を関数化したものです。</p>

<h3>
<span id="extend-関数---配列を拡張" class="fragment"></span><a href="#extend-%E9%96%A2%E6%95%B0---%E9%85%8D%E5%88%97%E3%82%92%E6%8B%A1%E5%BC%B5"><i class="fa fa-link"></i></a>Extend() 関数 - 配列を拡張</h3>

<p>C#では型付けが厳しい為、定義後に配列の大きさを柔軟に変更することができません。<br>
そこで、既存の配列を拡張する関数を作ってみました。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 配列を右辺へ拡張し、値を格納します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;typeparam name="T"&gt;アンマネージド型&lt;/typeparam&gt;</span>
<span class="c1">/// &lt;param name="source"&gt;ソース元である配列&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="num"&gt;格納する値&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;拡張された配列&lt;/returns&gt;</span>
<span class="k">private</span> <span class="n">T</span><span class="p">[]</span> <span class="n">Extend</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">IList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">source</span><span class="p">,</span> <span class="n">T</span> <span class="n">num</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">new</span> <span class="n">T</span><span class="p">[</span><span class="n">source</span><span class="p">.</span><span class="n">Count</span><span class="p">+</span><span class="m">1</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">n</span> <span class="p">&lt;</span> <span class="n">source</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">n</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">result</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">=</span> <span class="n">source</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">result</span><span class="p">[</span><span class="n">source</span><span class="p">.</span><span class="n">Count</span><span class="p">]</span> <span class="p">=</span> <span class="n">num</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>使い方:</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="kt">uint</span><span class="p">[]</span> <span class="n">test</span> <span class="p">=</span> <span class="p">{</span> <span class="m">1</span> <span class="p">};</span>
<span class="c1">//before [ 1 ]</span>
<span class="kt">uint</span><span class="p">[]</span> <span class="n">res</span> <span class="p">=</span> <span class="n">Extend</span><span class="p">&lt;</span><span class="kt">uint</span><span class="p">&gt;(</span><span class="n">test</span><span class="p">,</span> <span class="m">3</span><span class="p">);</span>
<span class="c1">//after [ 1, 3 ]</span>
</code></pre></div></div>

<h3>
<span id="printarray-関数---配列をいい感じに出力" class="fragment"></span><a href="#printarray-%E9%96%A2%E6%95%B0---%E9%85%8D%E5%88%97%E3%82%92%E3%81%84%E3%81%84%E6%84%9F%E3%81%98%E3%81%AB%E5%87%BA%E5%8A%9B"><i class="fa fa-link"></i></a>PrintArray() 関数 - 配列をいい感じに出力</h3>

<p>C#では、<code>Console.WriteLine()</code>で大体のことはできますが、<br>
配列をそのまま出力しようとすると<code>System.Int32</code>と、型がそのまま出力されてしまいます。<br>
そのままではデバッグするのもストレスなので、いい感じに出力してくれる関数を作ってみました。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 配列をいい感じに出力します。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;typeparam name="T"&gt;アンマネージド型&lt;/typeparam&gt;</span>
<span class="c1">/// &lt;param name="source"&gt;ソース元である配列&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="n">PrintArray</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">IList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"({0})"</span><span class="p">,</span> <span class="n">source</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span> <span class="p">+</span> <span class="s">"[ "</span> <span class="p">+</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">", "</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span> <span class="p">+</span> <span class="s">" ]"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//こんな配列が</span>
<span class="kt">int</span><span class="p">[]</span> <span class="n">hoge</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span> <span class="p">};</span>

<span class="c1">//こうすると</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">hoge</span><span class="p">);</span>

<span class="c1">//こうなるから</span>
<span class="c1">//Output: System.Int32</span>

<span class="c1">//自作関数でラップすると</span>
<span class="nf">PrintArray</span><span class="p">(</span><span class="n">hoge</span><span class="p">);</span>

<span class="c1">//いい感じに出力される</span>
<span class="c1">//Output: [ 0, 1, 2, 3, 4 ]</span>
</code></pre></div></div>

<h3>
<span id="strmid-関数---数値の中から数値を取り出す" class="fragment"></span><a href="#strmid-%E9%96%A2%E6%95%B0---%E6%95%B0%E5%80%A4%E3%81%AE%E4%B8%AD%E3%81%8B%E3%82%89%E6%95%B0%E5%80%A4%E3%82%92%E5%8F%96%E3%82%8A%E5%87%BA%E3%81%99"><i class="fa fa-link"></i></a>StrMid() 関数 - 数値の中から数値を取り出す</h3>

<p>例えば、こんな数字から</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>123456
</code></pre></div></div>

<p><code>3</code>のインデックス部分を取り出したいとします。<br>
パッと思いつくのは、<code>string</code>にして<code>SubString()</code>する方法でした。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//int文字列から特定の位置にある数字を取り出す</span>
<span class="c1">//12345</span>
<span class="c1">// ↑indexN</span>
<span class="c1">//return 2</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Integer から指定されたインデックスにある数値を取り出します。</span>
<span class="c1">/// 12345678 の インデックス 5 の場合 返り値は 5 です。</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="source"&gt;ソース元である数値&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="indexN"&gt;インデックス&lt;/param&gt;</span>
<span class="c1">/// &lt;returns&gt;取り出された数値&lt;/returns&gt;</span>
<span class="k">private</span> <span class="kt">int</span> <span class="nf">StrMid</span><span class="p">(</span><span class="kt">int</span> <span class="n">source</span><span class="p">,</span> <span class="kt">int</span> <span class="n">indexN</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">s</span> <span class="p">=</span> <span class="n">source</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">Substring</span><span class="p">(</span><span class="n">indexN</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2>
<span id="実行してみた" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F"><i class="fa fa-link"></i></a>実行してみた！</h2>

<p><a href="https://camo.qiitausercontent.com/14b280ccfcaf05f98ad3685144ac5448d3aa53d7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f37626637313239382d366337622d623438382d626531652d6237356136633633653231322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F7bf71298-6c7b-b488-be1e-b75a6c63e212.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=67c032d8ec72fb2f625bf17e83d51c62" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/7bf71298-6c7b-b488-be1e-b75a6c63e212.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F7bf71298-6c7b-b488-be1e-b75a6c63e212.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=98de637bbcd42b08d148ba21e8525541 1x" loading="lazy"></a></p>

<p>環境は .NET Framework 4.7.2 です。<br>
WinFormで適当にそれっぽいものを作って実際に実行してみます。</p>

<p>使用例:</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="p">(</span><span class="n">SHA256NotManaged</span> <span class="n">sha256</span> <span class="p">=</span> <span class="n">SHA256NotManaged</span><span class="p">.</span><span class="nf">Create</span><span class="p">())</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">plainText</span> <span class="p">=</span> <span class="n">textBox1</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">encryptedText</span> <span class="p">=</span> <span class="n">sha256</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">plainText</span><span class="p">);</span>
    <span class="n">textBox2</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">encryptedText</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>実行結果:</p>

<p><a href="https://camo.qiitausercontent.com/a8b5f1d90c488af15c624fd8b57dd4708641bcb1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f32343964613265382d383731312d336663662d316362622d3439326661336234353166622e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F249da2e8-8711-3fcf-1cbb-492fa3b451fb.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=16d047b980ac80c7219d3e346f4ca4b3" alt="afqbu-uhkdc.gif" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/249da2e8-8711-3fcf-1cbb-492fa3b451fb.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F249da2e8-8711-3fcf-1cbb-492fa3b451fb.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f1026569228e038b0cec8db5363bf81e 1x" loading="lazy"></a></p>

<p>出てきたハッシュをSHA256データベースで検索してみます。</p>

<p><a href="https://camo.qiitausercontent.com/fe04a5418de17f5cfd103fce9b18aabb63a005dd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f31393630633938332d373162322d623866312d386535612d3332633139623335373862372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1960c983-71b2-b8f1-8e5a-32c19b3578b7.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8e74502cc416905374c6d013507db63b" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/1960c983-71b2-b8f1-8e5a-32c19b3578b7.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1960c983-71b2-b8f1-8e5a-32c19b3578b7.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9b3f4051f3234b04a007ed58eb3fa803 1x" loading="lazy"></a></p>

<p>正しいようです。</p>

<h3>
<span id="処理時間" class="fragment"></span><a href="#%E5%87%A6%E7%90%86%E6%99%82%E9%96%93"><i class="fa fa-link"></i></a>処理時間</h3>

<p>今回は、アルゴリズムに集点をおいて、可読性を優先してコードを書いたのもあり<br>
速度については一切考慮しておりませんが、一応ランタイムのものと比較してみます。</p>

<p>比較にあたって、下記記事を参考にソースコードを拝借いたしました。<br>
ありがとうございました。</p>

<blockquote>
<p>参考記事: <a href="https://takachan.hatenablog.com/entry/2019/03/05/230952" rel="nofollow noopener" target="_blank">C#でStopwatchを使った時間計測を1行でできるようにする</a></p>
</blockquote>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="p">(</span><span class="n">SHA256NotManaged</span> <span class="n">sha256</span> <span class="p">=</span> <span class="n">SHA256NotManaged</span><span class="p">.</span><span class="nf">Create</span><span class="p">())</span>
<span class="p">{</span>
    <span class="n">TimeSpan</span> <span class="n">elapsed</span> <span class="p">=</span> <span class="n">StopwatchEx</span><span class="p">.</span><span class="nf">Context</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">sha256</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="s">"abc"</span><span class="p">);</span> <span class="p">},</span> <span class="m">1000</span><span class="p">);</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"自作: </span><span class="p">{</span><span class="n">elapsed</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">using</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Cryptography</span><span class="p">.</span><span class="n">SHA256</span> <span class="n">sha256_</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Cryptography</span><span class="p">.</span><span class="n">SHA256</span><span class="p">.</span><span class="nf">Create</span><span class="p">())</span>
<span class="p">{</span>
    <span class="n">TimeSpan</span> <span class="n">elapsed</span> <span class="p">=</span> <span class="n">StopwatchEx</span><span class="p">.</span><span class="nf">Context</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">sha256_</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">abc</span><span class="p">);</span> <span class="p">},</span> <span class="m">1000</span><span class="p">);</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"本家: </span><span class="p">{</span><span class="n">elapsed</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>今回は5回ほど計測してみました。<br>
それぞれ1000回の試行にかかった平均時間(ミリ秒)です。<br>
ランタイムのものと比較すると、約800倍近く時間がかかっていますね。<br>
手も足も出ませんでした。</p>

<p><del>正直ランタイムといい勝負するのではないかと期待していた</del> 打ち砕かれました。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>自作: 857.9315
本家: 1.1778

自作: 920.8264
本家: 1.8223

自作: 804.2666
本家: 1.009

自作: 803.6653
本家: 1.0139

自作: 821.0931
本家: 1.0187
</code></pre></div></div>

<h1>
<span id="最後に" class="fragment"></span><a href="#%E6%9C%80%E5%BE%8C%E3%81%AB"><i class="fa fa-link"></i></a>最後に</h1>

<p>一番苦戦したのは理論代数の分野の理解です。<br>
一向に理解できないせいで計算があわず、2時間格闘しました。。。<br>
結局ふわっとしか理解できていません。<br>
詳しい方がいらっしゃれば、些細な情報でもコメント欄にて解説頂けるとありがたいです。</p>

<p>フルソースコードは僕のGithubリポジトリにあります。<br>
コピペで動きます。<br>
<a href="https://github.com/kkent030315/SHA256-Algorithm-CSharp" rel="nofollow noopener" target="_blank"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F472a7984-d9cb-5a9b-84a7-22e8efb1bfa5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9347254a81df040d91e760ab05757c98" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/472a7984-d9cb-5a9b-84a7-22e8efb1bfa5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F472a7984-d9cb-5a9b-84a7-22e8efb1bfa5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e75acfa337b3dc73ab4fc7ef14d871e6 1x" loading="lazy"></a></p>

<p>当記事内で間違いや誤字脱字等ありましたら、お手数ですがコメント欄にてご指摘いただけますと幸いです。</p>

<p><strong>最後まで読んでいただき、ありがとうございました。</strong></p>

<h1>
<span id="追記-不具合修正" class="fragment"></span><a href="#%E8%BF%BD%E8%A8%98-%E4%B8%8D%E5%85%B7%E5%90%88%E4%BF%AE%E6%AD%A3"><i class="fa fa-link"></i></a>追記 (不具合修正)</h1>

<ul>
<li>一定の文字数を超えると、生成されるハッシュの値が異なる現象</li>
<li>その他一部で意図しない動作</li>
</ul>

<p>を確認しました。</p>

<p>本題です。<br>
なぜこのプログラムで<strong>一定以上の文字数を超えると算出されるハッシュ値が異なる</strong>か？<br>
結論から申し上げますと、<del>ブロック長の記録の例外処理を完全に忘れていました。<br>
「何らかの理由で記録するスペースがなかった場合、次のブロックで記録する」<br>
という処理です。</del><br>
ただのヒューマンエラーでした。</p>

<p>最初、この謎現象の原因を掴むべくデバッグしていましたら</p>

<p><a href="https://camo.qiitausercontent.com/91b0946c824abc8b62c7e1353de7e5a459aa9e6b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f35303065306661622d656461382d613862332d646239392d3161633563383134656235382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F500e0fab-eda8-a8b3-db99-1ac5c814eb58.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=331ebc5b35af2d73aba27f23283def07" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/500e0fab-eda8-a8b3-db99-1ac5c814eb58.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F500e0fab-eda8-a8b3-db99-1ac5c814eb58.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=31eceb8ec302d022b244d840762efdd1 1x" loading="lazy"></a></p>

<p>右が正しいものです。<br>
ブロック末端＆チャンクが異なっています。<br>
デバッグを続けていくと、この現象は<br>
<strong>一定の文字数以上(ブロック数2以上)で発生する</strong>ことがわかりました。<br>
したがって、ブロック分割部分で何かしらの問題が発生していると予想できます。</p>

<p>そこで、実際に中身を見てました。</p>

<p><a href="https://camo.qiitausercontent.com/b55b95d83b6e65769d663cf7bedeb07658e8a480/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f62656437303230322d386633652d636632352d633962662d6462633835326636616432642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fbed70202-8f3e-cf25-c9bf-dbc852f6ad2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7bf3370d08eaf2f0ee6b3c414bc2ad6f" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/bed70202-8f3e-cf25-c9bf-dbc852f6ad2d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fbed70202-8f3e-cf25-c9bf-dbc852f6ad2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bd71faac76276e4776b383cb7b45cce1 1x" loading="lazy"></a></p>

<p>予想的中。<br>
<strong>1ブロック目と2ブロック目のブロックがそれぞれ同一の値となっている</strong>ことが確認できます。<br>
問題の分割関数を覗いてみます。</p>

<p><a href="https://camo.qiitausercontent.com/1b30b7e06fad31e26d3c95ab9de348debfb2f5e4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f36643937616436342d396361652d313938302d646663382d3435363363376630643632322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F6d97ad64-9cae-1980-dfc8-4563c7f0d622.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e106436048b1705eb80cd1bab5d36f59" alt="5799d40641a72eedc85e110d8d2b3e14.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/6d97ad64-9cae-1980-dfc8-4563c7f0d622.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F6d97ad64-9cae-1980-dfc8-4563c7f0d622.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3787124c4aaf0f28e500dbe7ac9d832e 1x" loading="lazy"></a></p>

<p>問題箇所を特定できました。<br>
人為的ミスは、一歩引いてソースを見てみないと中々発見できませんね。。<br>
<font color="red"><strong>2進数のプレーンテキスト配列の0から512までを毎回コピーしていた</strong></font>ことが原因でした。<br>
ブロックが複数ある場合にのみ発生する不具合だったので、発見に時間がかかりました。<br>
修正後のソースコードは以下の通りです。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//ブロックが複数ある場合も想定されるので、</span>
<span class="c1">//n*512から512先までをコピーしなければいけない。</span>
<span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">plain_bits</span><span class="p">,</span> <span class="n">n</span> <span class="p">*</span> <span class="n">BLOCK_SIZE</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">);</span>
</code></pre></div></div>

<hr>

<p>以上、折角の機会なので不具合に対する適切な対処法と僕なりのデバッグ手法を紹介してみました。</p>

<h1>
<span id="追記2-不具合について" class="fragment"></span><a href="#%E8%BF%BD%E8%A8%982-%E4%B8%8D%E5%85%B7%E5%90%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>追記(2) 不具合について</h1>

<p>既知の不具合として、コメント欄にてご指摘いただきました。<br>
どうやら、プレーンテキストの文字数が5文字であり、特定の文字が含まれていると発生する模様。</p>

<p><a href="https://camo.qiitausercontent.com/f8092173de6a2a0331c42443e4ceb1fe35bef0b6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f64623437616134362d613236372d393966312d386633622d3137333937346333313663362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fdb47aa46-a267-99f1-8f3b-173974c316c6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d610f7d71b520953d780acd9e5aeba5f" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/db47aa46-a267-99f1-8f3b-173974c316c6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fdb47aa46-a267-99f1-8f3b-173974c316c6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f8200998dd26be8337e17758ac8598ad 1x" loading="lazy"></a></p>

<p>▼2文字分、<code>0</code>が抜け落ちてます。<br>
<a href="https://camo.qiitausercontent.com/b1eaa9c201129d5f02ee9088437af9c158ed6ace/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f31633439656334622d326262642d333735382d643233652d3666663232316638656233642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1c49ec4b-2bbd-3758-d23e-6ff221f8eb3d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8fc479ed91b9c7c0f7562829b2f50a0e" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/1c49ec4b-2bbd-3758-d23e-6ff221f8eb3d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1c49ec4b-2bbd-3758-d23e-6ff221f8eb3d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=90062d2ef51fd7e21f92a47e6c06bda9 1x" loading="lazy"></a></p>

<p>だけど、<code>abcdh</code>は大丈夫。</p>

<p><a href="https://camo.qiitausercontent.com/df261ae9e1b8801ea9c02673bf254a13f8b51f9a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f32383133383662632d653364352d313962392d346635342d6666383335313964353833342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F281386bc-e3d5-19b9-4f54-ff83519d5834.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a2c91a4d53d7b6b9f93cf236c9ca6d0f" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/281386bc-e3d5-19b9-4f54-ff83519d5834.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F281386bc-e3d5-19b9-4f54-ff83519d5834.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=20fa63f68676e9f0103daacb493db77a 1x" loading="lazy"></a></p>

<p><code>abcdg</code>もダメ。</p>

<p><a href="https://camo.qiitausercontent.com/862cad76a5b3604fa4f1cee433fd388aca8cb16e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f33653139633366612d346439632d616633652d633333302d3235343135626439616666652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F3e19c3fa-4d9c-af3e-c330-25415bd9affe.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=de6b7176c2a76cf2cd20b91b06259e69" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/3e19c3fa-4d9c-af3e-c330-25415bd9affe.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F3e19c3fa-4d9c-af3e-c330-25415bd9affe.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5d8646a93a4391f1557880245efa7c7d 1x" loading="lazy"></a></p>

<p>生成されるプレーンテキストに<code>0</code>が含まれていると発生するみたいです。<br>
計算に間違いがあれば生成されるハッシュ全体が変わるはずですから、<br>
この<strong>特定の文字が局所的に変化する現象</strong>はハッシュを16進数に変換する課程で問題が発生していると思われます。<br>
5文字以上である時は特に問題は無い様子？<br>
↑ははっきりと原因がわからない。</p>

<p>とりあえず、デバッグプリントしてみます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>自作Bytes: (32)[ 191, 22, 120, 186, 234, 207, 1, 143, 222, 64, 65, 65, 35, 34, 174, 93, 163, 97, 3, 176, 156, 122, 23, 150, 97, 255, 16, 180, 173, 21, 0, 242 ]
本家Bytes: (32)[ 186, 120, 22, 191, 143, 1, 207, 234, 65, 65, 64, 222, 93, 174, 34, 35, 176, 3, 97, 163, 150, 23, 122, 156, 180, 16, 255, 97, 242, 0, 21, 173 ]
</code></pre></div></div>

<p>4桁区切りでの規則性が見られます。<br>
<code>191, 22, 120, 186</code> ▶ <code>186, 120, 22, 191</code><br>
<code>uint</code>から<code>byte[4]</code>の変換の際に配列をリバースする必要がある様です。</p>

<p>そこで、こんな感じにリバースしてみました。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="kt">var</span> <span class="n">test</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">SelectMany</span><span class="p">((</span><span class="n">v</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="nf">Reverse</span><span class="p">()).</span><span class="nf">ToArray</span><span class="p">();</span>
</code></pre></div></div>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>自作Bytes: (32)[ 186, 120, 22, 191, 143, 1, 207, 234, 65, 65, 64, 222, 93, 174, 34, 35, 176, 3, 97, 163, 150, 23, 122, 156, 180, 16, 255, 97, 242, 0, 21, 173 ]
本家Bytes: (32)[ 186, 120, 22, 191, 143, 1, 207, 234, 65, 65, 64, 222, 93, 174, 34, 35, 176, 3, 97, 163, 150, 23, 122, 156, 180, 16, 255, 97, 242, 0, 21, 173 ]
</code></pre></div></div>

<p>OKっぽい。<br>
肝心の<code>abcde</code>の中身を見てみます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>自作Bytes: (32)[ 54, 187, 229, 14, 217, 104, 65, 209, 4, 67, 188, 182, 112, 214, 85, 79, 10, 52, 183, 97, 190, 103, 236, 156, 74, 138, 210, 192, 196, 76, 164, 44 ]
本家Bytes: (32)[ 54, 187, 229, 14, 217, 104, 65, 209, 4, 67, 188, 182, 112, 214, 85, 79, 10, 52, 183, 97, 190, 103, 236, 156, 74, 138, 210, 192, 196, 76, 164, 44 ]
</code></pre></div></div>

<p>。。。おろ？問題ないっぽいです。<br>
これを16進数文字列に変換してみます。</p>

<p>読みにくいコードでごめんなさい。<br>
やっていることは、<br>
<code>uint</code>▶<code>byte</code>▶<code>Reverse()</code>▶<code>Concat()</code>▶<code>byte</code>▶<code>string(64)</code><br>
こんな感じです。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="kt">var</span> <span class="n">test</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">SelectMany</span><span class="p">((</span><span class="n">v</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="nf">Reverse</span><span class="p">()).</span><span class="nf">ToArray</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">makehash_fixed_test</span> <span class="p">=</span> <span class="n">test</span><span class="p">.</span><span class="nf">SelectMany</span><span class="p">((</span><span class="n">v</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="m">16</span><span class="p">)).</span><span class="nf">ToArray</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">t</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">test</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">v</span> <span class="p">=&gt;</span> <span class="s">$"</span><span class="p">{</span><span class="n">v</span><span class="p">:</span><span class="n">X2</span><span class="p">}</span><span class="s">"</span><span class="p">));</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"MakeHashFixed?: ({0}) : {1}"</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="nf">ToLower</span><span class="p">()));</span>
</code></pre></div></div>

<p>無事解決しました！</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>MakeHashFixed?: (64) : 36bbe50ed96841d10443bcb670d6554f0a34b761be67ec9c4a8ad2c0c44ca42c
</code></pre></div></div>

<p><a href="https://camo.qiitausercontent.com/dd4d0ceed00aec2e9eb5fdd20724a5e48122c530/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f34353836303261622d626662652d633266312d313562652d3033346462323137306134392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F458602ab-bfbe-c2f1-15be-034db2170a49.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=51c0eba10311a6bcbb77fd647101e987" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/458602ab-bfbe-c2f1-15be-034db2170a49.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F458602ab-bfbe-c2f1-15be-034db2170a49.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ddc247ddcceac1e4f924b95026fa5ca6 1x" loading="lazy"></a></p>

<p>やはり、予想通りエンコーディングの問題でした。<br>
具体的な原因は謎ですが、<br>
下記のコードでも不具合が発生することを考えると、フレームワークの不具合なのかな？と思ったり。<br>
とにかく、<code>byte</code>を噛ませないとダメみたいですね。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">//これも不具合発生.</span>
<span class="k">private</span> <span class="kt">string</span> <span class="nf">MakeHash</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">n</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">Select</span><span class="p">((</span><span class="n">v</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">$"</span><span class="p">{</span><span class="n">v</span><span class="p">:</span><span class="n">X2</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">n</span><span class="p">).</span><span class="nf">ToLower</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fkkent030315%2Fitems%2F3f095208ed083ce9f1e5&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fkkent030315%2Fitems%2F3f095208ed083ce9f1e5&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kkent030315/items/3f095208ed083ce9f1e5/likers" class="css-1iupg5d">142</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">85</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/3f095208ed083ce9f1e5/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kkent030315/items/3f095208ed083ce9f1e5/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kkent030315/items/3f095208ed083ce9f1e5/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kkent030315/items/3f095208ed083ce9f1e5/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kkent030315/items/3f095208ed083ce9f1e5.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-e9fac793-f574-495a-b537-770c2803bd52">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-1c816618-2003-43e8-9104-ff95b6a1ede6"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-1c816618-2003-43e8-9104-ff95b6a1ede6">{}</script>
      
<div id="LoginModal-react-component-f34c101d-1685-4921-9ecf-2da1c945e47d"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-f34c101d-1685-4921-9ecf-2da1c945e47d">{}</script>
      
<div id="StockModal-react-component-a9d7ca48-3629-4b38-b126-90054fa4567c"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-a9d7ca48-3629-4b38-b126-90054fa4567c">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;fpjhOWvAiQYnwo2eLv4J9KSXUJQdzFeN/74MiEkT4T0acJZZozKSwb9EF8JAL1J3Wf8dtFUSMC1NMhsa0k25RA==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e高校生の僕が\u003cstrong\u003eSHA256\u003c/strong\u003e暗号化アルゴリズムを外部ライブラリやランタイムに一切頼らず、独自で実装してみました。\u003cbr\u003e\n当記事は、マイクロソフト様にケンカを売る記事ではございません。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前置き\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E7%BD%AE%E3%81%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前置き\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b64e00cdb705e2d387d35d66cde94cb45c9032e8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f61633237346331372d666635372d633131642d326562392d3030623064666161316232652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fac274c17-ff57-c11d-2eb9-00b0dfaa1b2e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d5c9217764d15ce7f7c631a881364bb0\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/ac274c17-ff57-c11d-2eb9-00b0dfaa1b2e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fac274c17-ff57-c11d-2eb9-00b0dfaa1b2e.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f28be023118f1d790b234e901f51e5d3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこの記事をご覧になっている方々は、様々な分野でお仕事をされている方がいらっしゃると思います。\u003cbr\u003e\nそういった方々含め、プログラミングを実際にされていない方も「SHA256」という単語は一度でも目に入れた方も多くいらっしゃるのではないでしょうか。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSHA256\u003c/strong\u003eとは、アメリカ国家安全保障局によって設計され、\u003cbr\u003e\n2001年にアメリカ国立標準技術研究所によって連邦情報処理標準とされた暗号化アルゴリズムのひとつです。\u003cbr\u003e\nSHA256の他にも、「SHA-1」や「SHA-512」といった多くの暗号化アルゴリズムがあります。\u003c/p\u003e\n\n\u003cp\u003eそのひとつである「SHA-1」は、2017年にGoogleによって攻撃手段が公開され、\u003cbr\u003e\nそれまでSHA-1を使用していたシステムは半強制的に、より安全な暗号化アルゴリズムへの移行を余儀なくされた。\u003cbr\u003e\nという事件がありましたね。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e該当記事: \u003ca href=\"https://gigazine.net/news/20170224-google-cwi-break-sha-1/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGoogleがハッシュ関数「SHA-1」を破ることに成功\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eそういった背景もある暗号化アルゴリズム達ですが、今回はなかでも多くの場面で使われている\u003cbr\u003e\n「SHA-256」をプログラミング言語 C# を使って独自で実装してみたいと思います。\u003c/p\u003e\n\n\u003cp\u003eビットコインを支えている\u003cstrong\u003eブロックチェーン\u003c/strong\u003eでも、SHA-256は活躍しています。\u003cbr\u003e\nブロックチェーンに関しましては、下記記事をご参照頂くとわかりやすいと思います。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e参考記事: \u003ca href=\"https://qiita.com/sa2shun/items/f4991357ece3303c7167#4blockchain%E3%81%AE%E5%AE%9F%E8%A3%85\" id=\"reference-a1da5f4c700e21d8aab7\"\u003e【Python】10分でイキリ高校生がブロックチェーンを初心者に解説してやる！！！\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"sha256の特徴\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sha256%E3%81%AE%E7%89%B9%E5%BE%B4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSHA256の特徴\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/aedec45c258ede7dd902b7fb14a0e879288ef02f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f64323938346430382d313630632d613736302d356364342d3264363165633339336439642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd2984d08-160c-a760-5cd4-2d61ec393d9d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ea94dc22751b72b638f726d26c1df4e8\" alt=\"weodnmgvbws.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/d2984d08-160c-a760-5cd4-2d61ec393d9d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd2984d08-160c-a760-5cd4-2d61ec393d9d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d293423495f2aa6d68a800d51360afac 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここまでで、様々な暗号化アルゴリズムがあることがわかりました。\u003cbr\u003e\nSHA256の特徴は\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003e一方向性\u003c/strong\u003e\n\n\u003cul\u003e\n\u003cli\u003e▶復号化が困難である。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eここで、”困難”と言ったのは、\u003cstrong\u003e総当り攻撃\u003c/strong\u003eによる突破が可能であるからです。\u003cbr\u003e\n論理的には、2^80（2の80乗）という回数総当たりを仕掛ければどれかが当たる、ということです。\u003cbr\u003e\n現在では、遥かに少ない2^63（2の63乗）という回数で突破できる手法が見つかっているそうです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003e衝突困難\u003c/strong\u003e\n\n\u003cul\u003e\n\u003cli\u003e▶SHA-1で使用された攻撃手法。衝突させることが困難である。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e簡単に言うと、\u003cstrong\u003e異なる2つの平文から同一のハッシュ値が得られる脆弱性に強い\u003c/strong\u003eということです。\u003cbr\u003e\n詳しく知りたい方は、下記の記事を参照下さい。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e参考記事: \u003ca href=\"http://73spica.tech/blog/sha1-collision/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e巷で話題のGoogleのSHA-1衝突やってみた\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"実装してみる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A3%85%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実装してみる\u003c/h1\u003e\n\n\u003cp\u003eここからは、実際にプログラムを書いてC#で暗号化アルゴリズムを再現してみたいと思います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"大まかな処理フロー\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%A4%A7%E3%81%BE%E3%81%8B%E3%81%AA%E5%87%A6%E7%90%86%E3%83%95%E3%83%AD%E3%83%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e大まかな処理フロー\u003c/h2\u003e\n\n\u003cp\u003eかなり大雑把ではありますが、大まかな処理フローは以下の通りです。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4aac4ef3fedf9c0a2b8411f272c637cd479f723f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f35386536613664632d383239652d643465642d316237352d6633633833633330306236342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F58e6a6dc-829e-d4ed-1b75-f3c83c300b64.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f671a0b76e73d9445892f84158702af6\" alt=\"sha256flow.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/58e6a6dc-829e-d4ed-1b75-f3c83c300b64.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F58e6a6dc-829e-d4ed-1b75-f3c83c300b64.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b4b922c221369baeb2143b0dcaecce1e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"1平文16進数を2進数に変換\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1%E5%B9%B3%E6%96%8716%E9%80%B2%E6%95%B0%E3%82%922%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1.平文(16進数)を2進数に変換\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003ea\u003c/code\u003eであれば16進数\u003ccode\u003e61\u003c/code\u003e 2進数 \u003ccode\u003e1100001\u003c/code\u003e に変換されます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"2パディング処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2%E3%83%91%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2.パディング処理\u003c/h3\u003e\n\n\u003cp\u003eパディング（Padding）と呼ばれる空埋め処理を行います。\u003cbr\u003e\n1ブロックのサイズは\u003ccode\u003e64byte\u003c/code\u003eですので、それ以下であれば空の部分を埋める必要があります。\u003cbr\u003e\n但し、ただ埋めるだけではダメです。\u003cbr\u003e\n例として以下のようなブロックがあったとします。\u003cbr\u003e\n\u003ccode\u003e14byte\u003c/code\u003e分足りません。これを埋めます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e//50byte\n0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000\n0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれを、ただ埋めると何が起こるかは安易に予想できます。\u003cbr\u003e\n\u003ccode\u003eX\u003c/code\u003eの部分を0で埋めたとすると、異なるブロックであっても全く同じメッセージブロックが生まれてしまいます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e//46byte\n1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000\n0000 0100 0000 0110 0000 0000 0000 0000 XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX\n\n//50byte\n1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000\n0000 0100 0000 0110 0000 0000 0000 0000 0000 0000 XXXX XXXX XXXX XXXX XXXX XXXX XXXX\n\n↓\n\n全く同じブロックが生まれる。\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eそこで、もとのブロックのブロック長を末端に記録します。\u003cbr\u003e\n\u003ccode\u003eB\u003c/code\u003eの部分がブロック長を記録した部分です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e//46byte\n1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000\n0000 0100 0000 0110 0000 0000 0000 0000 XXXX XXXX XXXX XXXX XXXX BBBB BBBB BBBB BBBB\n\n//50byte\n1111 0101 0111 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000\n0000 0100 0000 0110 0000 0000 0000 0000 0000 0000 XXXX XXXX XXXX BBBB BBBB BBBB BBBB\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eブロック長が64byte丁度だったり、万が一記録する余裕が無かっただった場合は次のブロックで記録します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"3ブロックをメッセージブロックに分割\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%82%92%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AB%E5%88%86%E5%89%B2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3.ブロックをメッセージブロックに分割\u003c/h3\u003e\n\n\u003cp\u003eパディングが済んだ512byteのブロックを64byte長のメッセージブロックへと分割します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"4初期ベクトルを使用してハッシュ値を算出\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#4%E5%88%9D%E6%9C%9F%E3%83%99%E3%82%AF%E3%83%88%E3%83%AB%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E7%AE%97%E5%87%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e4.初期ベクトルを使用してハッシュ値を算出\u003c/h3\u003e\n\n\u003cp\u003e初回ラウンドでは、初期ベクトル（IV）を使用します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 初期ハッシュ\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003einitial_hash\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x6a09e667\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xbb67ae85\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x3c6ef372\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xa54ff53a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x510e527f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x9b05688c\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x1f83d9ab\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x5be0cd19\u003c/span\u003e \n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"5合計64ラウンド処理を行う\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#5%E5%90%88%E8%A8%8864%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e5.合計64ラウンド処理を行う\u003c/h3\u003e\n\n\u003cp\u003e行う処理は簡単に以下の通りです。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ac05cb102f004f8e62a26633692a31c597012c55/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f64353064616365352d353463382d346435302d343465342d3734353765326265366566622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd50dace5-54c8-4d50-44e4-7457e2be6efb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=78ebe15498bb0e1a5657bdf750b8bfde\" alt=\"sha256flow2.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/d50dace5-54c8-4d50-44e4-7457e2be6efb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fd50dace5-54c8-4d50-44e4-7457e2be6efb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a6ac6acb6d85548943b3d220c653aa2d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"論理代数\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AB%96%E7%90%86%E4%BB%A3%E6%95%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e論理代数\u003c/h4\u003e\n\n\u003cp\u003eここからは論理代数の分野です。\u003cbr\u003e\n正直なところ、僕もふわっとしか理解できていません。\u003cbr\u003e\n一通り調べてはみましたが、情報そのものが正しいものであるか区別する手段がありませんでしたので、\u003cbr\u003e\nあくまで参考として記載します。\u003cbr\u003e\n詳しい方がいらっしゃいましたら、コメント欄にて解説をお願い致します。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e参考記事: \u003ca href=\"http://maicommon.ciao.jp/ss/dscrtMath2/alg/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e論理代数を学ぼう\u003c/a\u003e\u003cbr\u003e\n参考記事: \u003ca href=\"http://www.ieice-hbkb.org/files/01/01gun_08hen_01.pdf\" rel=\"nofollow noopener\" target=\"_blank\"\u003e論理代数と論理関数　湊 真一\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"ch\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ch\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCh\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eCh(E,F,G) = (E \\Lambda F)　Xor　(\\rightharpoondown E \\Lambda G)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"nf\"\u003eCh\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ez\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"p\"\u003e(~\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ez\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"maj-変数多数決関数\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#maj-%E5%A4%89%E6%95%B0%E5%A4%9A%E6%95%B0%E6%B1%BA%E9%96%A2%E6%95%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMaj (変数多数決関数)\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eMaj(A,B,C) = (A \\Lambda B)　Xor　(A \\Lambda C)　Xor　(B \\Lambda C)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"nf\"\u003eMaj\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ez\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ez\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ez\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"rotr-rotation-right\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rotr-rotation-right\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRotR (Rotation Right)\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_R\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e32\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"rotl-rotation-left\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rotl-rotation-left\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRotL (Rotation Left)\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_L\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e32\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"σ0-sigma0\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%CF%830-sigma0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eΣ0 (Sigma0)\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\\sum 0 (A) = (A \\ggg 2)　Xor　(A \\ggg 13)　Xor　(A \\ggg 22)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"nf\"\u003eSigma0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_R\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_R\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e13\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_R\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e22\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"σ1-sigma1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%CF%831-sigma1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eΣ1 (Sigma1)\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\\sum 1 (E) = (E \\ggg 6)　Xor　(E \\ggg 11)　Xor　(E \\ggg 25)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"nf\"\u003eSigma1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_R\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_R\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e11\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e^\u003c/span\u003e \u003cspan class=\"nf\"\u003eRot_R\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e25\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"cソースコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#c%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eC#ソースコード\u003c/h2\u003e\n\n\u003cp\u003eここからは、実際のソースコードを紹介します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"定数k\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9A%E6%95%B0k\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e定数K\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// Kと呼ばれる定数\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003econst_k\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0x428A2F98\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x71374491\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xB5C0FBCF\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xE9B5DBA5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x3956C25B\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x59F111F1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x923F82A4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xAB1C5ED5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0xD807AA98\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x12835B01\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x243185BE\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x550C7DC3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x72BE5D74\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x80DEB1FE\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x9BDC06A7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xC19BF174\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0xE49B69C1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xEFBE4786\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x0FC19DC6\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x240CA1CC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x2DE92C6F\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x4A7484AA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x5CB0A9DC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x76F988DA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0x983E5152\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xA831C66D\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xB00327C8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xBF597FC7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0xC6E00BF3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xD5A79147\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x06CA6351\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x14292967\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0x27B70A85\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x2E1B2138\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x4D2C6DFC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x53380D13\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x650A7354\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x766A0ABB\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x81C2C92E\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x92722C85\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0xA2BFE8A1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xA81A664B\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xC24B8B70\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xC76C51A3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0xD192E819\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xD6990624\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xF40E3585\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x106AA070\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0x19A4C116\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x1E376C08\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x2748774C\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x34B0BCB5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x391C0CB3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x4ED8AA4A\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x5B9CCA4F\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x682E6FF3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"m\"\u003e0x748F82EE\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x78A5636F\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x84C87814\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0x8CC70208\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"m\"\u003e0x90BEFFFA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xA4506CEB\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xBEF9A3F7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0xC67178F2\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"computehash-関数---ハッシュ値を算出\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#computehash-%E9%96%A2%E6%95%B0---%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E7%AE%97%E5%87%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eComputeHash() 関数 - ハッシュ値を算出\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// SHA256ハッシュを生成します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"plainText\"\u0026gt;暗号化したい文字列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;暗号化された文字列\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eComputeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eplainText\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003ePadding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplainText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eblock_list\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einitial_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003einitial_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//ブロックリストの中のブロックにスコープを当てる\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eblock\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eblock_list\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakePair\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eexpanded_block\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eExpandBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eblock\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eCH\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCh\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"f\"\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"g\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eMAJ\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMaj\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"a\"\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"b\"\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"c\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eSIG0\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eSigma0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"a\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eSIG1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eSigma1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eWJ_KJ\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econst_k\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eexpanded_block\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eT1_TEMP\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"h\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eWJ_KJ\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eCH\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eT1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT1_TEMP\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eSIG1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eT2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSIG0\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eMAJ\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"h\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"g\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"g\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"f\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"f\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eT1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"c\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"c\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"b\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"b\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"a\"\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"a\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT1\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eT2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"a\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"b\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"c\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"f\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"g\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epair\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"h\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"touint32array-関数---2進数に変換\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#touint32array-%E9%96%A2%E6%95%B0---2%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eToUInt32Array() 関数 - 2進数に変換\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// Stringを2進数に変換します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"plain_text\"\u0026gt;暗号化する文字列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;2進数配列\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003eToUInt32Array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_text\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//文字列を16進数に変換. 実体はbyte配列\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eASCII\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplain_text\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//結果を格納する配列\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//16進数を2進数に変換\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elen\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003efill_len\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//2進数を8桁に揃える  0を先頭に追加\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elen\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//2進数が8桁以下であったとき、埋めるべき数は |8 - len| である\u003c/span\u003e\n            \u003cspan class=\"n\"\u003efill_len\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAbs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efill_len\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003efill_len\u003c/span\u003e\u003cspan class=\"p\"\u003e--;\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eSelfAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0u\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"nf\"\u003eSelfConcat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"calculatek-関数---kを算出\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#calculatek-%E9%96%A2%E6%95%B0---k%E3%82%92%E7%AE%97%E5%87%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCalculateK() 関数 - Kを算出\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 与えられた配列から定数Kを算出します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"plain_bits\"\u0026gt;算出された数\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;定数K\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"nf\"\u003eCalculateK\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"m\"\u003e512\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"m\"\u003e448\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ek\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"padding-関数---パディング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#padding-%E9%96%A2%E6%95%B0---%E3%83%91%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePadding() 関数 - パディング\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// パディングと呼ばれる、空埋め処理を行います。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"plain_text\"\u0026gt;パディングする2進数配列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;パディングされた2進数配列\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003ePadding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_text\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eToUInt32Array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplain_text\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eCalculateK\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//処理する値を保持するバッファ\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eExtend\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eSelfAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0u\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ebytStr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//64桁右寄せゼロ埋め\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//0000000000000000000000000000000000000000000000000000000000011000\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebytStr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebytStr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003ePadLeft\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"sc\"\u003e'0'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//↑で得た64桁の数列を配列に変換\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//(64)[ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0 ]\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebytStr_array\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"m\"\u003e63\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enum_str\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebytStr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enum\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum_str\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eSelfAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003ebytStr_array\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//位取り バッファにAppend\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ebytStr_array\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eSelfAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"cp\"\u003e#if DEBUG\n\u003c/span\u003e    \u003cspan class=\"c1\"\u003e//ブロックサイズはパディング後512である\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//Assert(buf.Length != 512)\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003ePrintArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e//512\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e#endif\n\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"parse-関数---ブロックの分割\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#parse-%E9%96%A2%E6%95%B0---%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E5%88%86%E5%89%B2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eParse() 関数 - ブロックの分割\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// パディングされた配列を512バイトのブロック長に分割します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"plain_bits\"\u0026gt;分割する2進数配列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;分割された2進数ブロック一覧を格納したリスト\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003e]\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003e]\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eBLOCK_SIZE\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e512\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enum_blocks\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eBLOCK_SIZE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003enum_blocks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eblock\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eBLOCK_SIZE\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eBLOCK_SIZE\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eblock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBLOCK_SIZE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//ブロックリストに追加\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eblock\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"expandblock-関数---ブロックのプレ処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#expandblock-%E9%96%A2%E6%95%B0---%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E3%83%97%E3%83%AC%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eExpandBlock() 関数 - ブロックのプレ処理\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// ブロックを処理します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"block\"\u0026gt;64バイトの2進数ブロック配列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;処理された2進数ブロック配列\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"nf\"\u003eExpandBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eblock\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//例\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//バイナリ -\u0026gt; ヘックスデシマル -\u0026gt; uint OR バイナリ -\u0026gt; demical\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//↓チャンクバイナリ 01100001011000100110001110000000 は ヘックスデミカル 0x61626380 である.\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//CHUNK: [ 32 ] [0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0]\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//= 0x61626380 したがって uint は 1633837952\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//コピー先のチャンク配列\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003echunk_array\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//ブロックの x*32 から 32byte先までをコピー\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eblock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e\u003cspan class=\"m\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003echunk_array\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//バイナリに変換\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003echunk_binary_str\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eToBinary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echunk_array\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003echunk_decimal\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToUInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echunk_binary_str\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"nf\"\u003eSelfAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003echunk_decimal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"m\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eT1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eSub0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eT2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eT1\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eT3\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eT2\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"nf\"\u003eSub1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n        \u003cspan class=\"nf\"\u003eSelfAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eT3\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"makepair-関数---ペアを生成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#makepair-%E9%96%A2%E6%95%B0---%E3%83%9A%E3%82%A2%E3%82%92%E7%94%9F%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMakePair() 関数 - ペアを生成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 計算をより楽に、分かりやすくするためにStringとのペアを生成します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"hash\"\u0026gt;ペアと対になる2進数配列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;ペアを格納したディクショナリ\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakePair\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"a\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"b\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"c\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"d\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"f\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"g\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"h\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"makehash-関数---16進数に変換\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#makehash-%E9%96%A2%E6%95%B0---16%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMakeHash() 関数 - 16進数に変換\u003c/h3\u003e\n\n\u003cp\u003e追記(2)より、一度\u003ccode\u003ebyte[32]\u003c/code\u003eに変換しないと\u003ccode\u003e0\u003c/code\u003eが抜け落ちる模様。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 2進数を16進数の文字列に変換します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"s\"\u0026gt;変換したい2進数配列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;変換された文字列\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003es_byte_array\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectMany\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eReverse\u003c/span\u003e\u003cspan class=\"p\"\u003e()).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult_str\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eJoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es_byte_array\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eX2\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult_str\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToLower\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"tobinary-関数---バイナリに変換\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tobinary-%E9%96%A2%E6%95%B0---%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eToBinary() 関数 - バイナリに変換\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// チャンクをバイナリに変換します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"chunk\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;変換されたバイナリ\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eToBinary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003echunk\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003echunk\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"binarytodecimal-関数---デシマルに変換\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#binarytodecimal-%E9%96%A2%E6%95%B0---%E3%83%87%E3%82%B7%E3%83%9E%E3%83%AB%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eBinaryTodecimal() 関数 - デシマルに変換\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eConvert.ToString(value, 16)\u003c/code\u003e を使う方法もあります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// バイナリをデシマル Integer に変換します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"binary_str\"\u0026gt;バイナリ\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;デシマル Integer\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003eBinaryToDecimal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ebinary_str\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ebinary_char_array\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebinary_str\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToCharArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReverse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebinary_char_array\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebinary_char_array\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebinary_char_array\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"sc\"\u003e'1'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"自作便利関数\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%87%AA%E4%BD%9C%E4%BE%BF%E5%88%A9%E9%96%A2%E6%95%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e自作便利関数\u003c/h2\u003e\n\n\u003cp\u003eやっていて、色々と不便に感じた部分や簡略化したい部分を関数化したものです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"extend-関数---配列を拡張\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#extend-%E9%96%A2%E6%95%B0---%E9%85%8D%E5%88%97%E3%82%92%E6%8B%A1%E5%BC%B5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eExtend() 関数 - 配列を拡張\u003c/h3\u003e\n\n\u003cp\u003eC#では型付けが厳しい為、定義後に配列の大きさを柔軟に変更することができません。\u003cbr\u003e\nそこで、既存の配列を拡張する関数を作ってみました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 配列を右辺へ拡張し、値を格納します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;typeparam name=\"T\"\u0026gt;アンマネージド型\u0026lt;/typeparam\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"source\"\u0026gt;ソース元である配列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"num\"\u0026gt;格納する値\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;拡張された配列\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eExtend\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eIList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e+\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e使い方:\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003etest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//before [ 1 ]\u003c/span\u003e\n\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eExtend\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//after [ 1, 3 ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"printarray-関数---配列をいい感じに出力\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#printarray-%E9%96%A2%E6%95%B0---%E9%85%8D%E5%88%97%E3%82%92%E3%81%84%E3%81%84%E6%84%9F%E3%81%98%E3%81%AB%E5%87%BA%E5%8A%9B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePrintArray() 関数 - 配列をいい感じに出力\u003c/h3\u003e\n\n\u003cp\u003eC#では、\u003ccode\u003eConsole.WriteLine()\u003c/code\u003eで大体のことはできますが、\u003cbr\u003e\n配列をそのまま出力しようとすると\u003ccode\u003eSystem.Int32\u003c/code\u003eと、型がそのまま出力されてしまいます。\u003cbr\u003e\nそのままではデバッグするのもストレスなので、いい感じに出力してくれる関数を作ってみました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 配列をいい感じに出力します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;typeparam name=\"T\"\u0026gt;アンマネージド型\u0026lt;/typeparam\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"source\"\u0026gt;ソース元である配列\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003ePrintArray\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eIList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"({0})\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"[ \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eJoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\", \"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" ]\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//こんな配列が\u003c/span\u003e\n\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//こうすると\u003c/span\u003e\n\u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//こうなるから\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//Output: System.Int32\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//自作関数でラップすると\u003c/span\u003e\n\u003cspan class=\"nf\"\u003ePrintArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//いい感じに出力される\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//Output: [ 0, 1, 2, 3, 4 ]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"strmid-関数---数値の中から数値を取り出す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#strmid-%E9%96%A2%E6%95%B0---%E6%95%B0%E5%80%A4%E3%81%AE%E4%B8%AD%E3%81%8B%E3%82%89%E6%95%B0%E5%80%A4%E3%82%92%E5%8F%96%E3%82%8A%E5%87%BA%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eStrMid() 関数 - 数値の中から数値を取り出す\u003c/h3\u003e\n\n\u003cp\u003e例えば、こんな数字から\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e123456\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e3\u003c/code\u003eのインデックス部分を取り出したいとします。\u003cbr\u003e\nパッと思いつくのは、\u003ccode\u003estring\u003c/code\u003eにして\u003ccode\u003eSubString()\u003c/code\u003eする方法でした。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//int文字列から特定の位置にある数字を取り出す\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//12345\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ↑indexN\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//return 2\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// Integer から指定されたインデックスにある数値を取り出します。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// 12345678 の インデックス 5 の場合 返り値は 5 です。\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"source\"\u0026gt;ソース元である数値\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"indexN\"\u0026gt;インデックス\u0026lt;/param\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;取り出された数値\u0026lt;/returns\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003eStrMid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eindexN\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindexN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"実行してみた\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行してみた！\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/14b280ccfcaf05f98ad3685144ac5448d3aa53d7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f37626637313239382d366337622d623438382d626531652d6237356136633633653231322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F7bf71298-6c7b-b488-be1e-b75a6c63e212.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=67c032d8ec72fb2f625bf17e83d51c62\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/7bf71298-6c7b-b488-be1e-b75a6c63e212.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F7bf71298-6c7b-b488-be1e-b75a6c63e212.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=98de637bbcd42b08d148ba21e8525541 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e環境は .NET Framework 4.7.2 です。\u003cbr\u003e\nWinFormで適当にそれっぽいものを作って実際に実行してみます。\u003c/p\u003e\n\n\u003cp\u003e使用例:\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSHA256NotManaged\u003c/span\u003e \u003cspan class=\"n\"\u003esha256\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSHA256NotManaged\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eplainText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eencryptedText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esha256\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eComputeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplainText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etextBox2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eencryptedText\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e実行結果:\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a8b5f1d90c488af15c624fd8b57dd4708641bcb1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f32343964613265382d383731312d336663662d316362622d3439326661336234353166622e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F249da2e8-8711-3fcf-1cbb-492fa3b451fb.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=16d047b980ac80c7219d3e346f4ca4b3\" alt=\"afqbu-uhkdc.gif\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/249da2e8-8711-3fcf-1cbb-492fa3b451fb.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F249da2e8-8711-3fcf-1cbb-492fa3b451fb.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f1026569228e038b0cec8db5363bf81e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e出てきたハッシュをSHA256データベースで検索してみます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/fe04a5418de17f5cfd103fce9b18aabb63a005dd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f31393630633938332d373162322d623866312d386535612d3332633139623335373862372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1960c983-71b2-b8f1-8e5a-32c19b3578b7.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8e74502cc416905374c6d013507db63b\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/1960c983-71b2-b8f1-8e5a-32c19b3578b7.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1960c983-71b2-b8f1-8e5a-32c19b3578b7.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9b3f4051f3234b04a007ed58eb3fa803 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e正しいようです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"処理時間\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%87%A6%E7%90%86%E6%99%82%E9%96%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e処理時間\u003c/h3\u003e\n\n\u003cp\u003e今回は、アルゴリズムに集点をおいて、可読性を優先してコードを書いたのもあり\u003cbr\u003e\n速度については一切考慮しておりませんが、一応ランタイムのものと比較してみます。\u003c/p\u003e\n\n\u003cp\u003e比較にあたって、下記記事を参考にソースコードを拝借いたしました。\u003cbr\u003e\nありがとうございました。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e参考記事: \u003ca href=\"https://takachan.hatenablog.com/entry/2019/03/05/230952\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC#でStopwatchを使った時間計測を1行でできるようにする\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSHA256NotManaged\u003c/span\u003e \u003cspan class=\"n\"\u003esha256\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSHA256NotManaged\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eStopwatchEx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003esha256\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eComputeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"abc\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"自作: \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTotalMilliseconds\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCryptography\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSHA256\u003c/span\u003e \u003cspan class=\"n\"\u003esha256_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCryptography\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSHA256\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eStopwatchEx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003esha256_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eComputeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eabc\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"m\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"本家: \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTotalMilliseconds\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e今回は5回ほど計測してみました。\u003cbr\u003e\nそれぞれ1000回の試行にかかった平均時間(ミリ秒)です。\u003cbr\u003e\nランタイムのものと比較すると、約800倍近く時間がかかっていますね。\u003cbr\u003e\n手も足も出ませんでした。\u003c/p\u003e\n\n\u003cp\u003e\u003cdel\u003e正直ランタイムといい勝負するのではないかと期待していた\u003c/del\u003e 打ち砕かれました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e自作: 857.9315\n本家: 1.1778\n\n自作: 920.8264\n本家: 1.8223\n\n自作: 804.2666\n本家: 1.009\n\n自作: 803.6653\n本家: 1.0139\n\n自作: 821.0931\n本家: 1.0187\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"最後に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最後に\u003c/h1\u003e\n\n\u003cp\u003e一番苦戦したのは理論代数の分野の理解です。\u003cbr\u003e\n一向に理解できないせいで計算があわず、2時間格闘しました。。。\u003cbr\u003e\n結局ふわっとしか理解できていません。\u003cbr\u003e\n詳しい方がいらっしゃれば、些細な情報でもコメント欄にて解説頂けるとありがたいです。\u003c/p\u003e\n\n\u003cp\u003eフルソースコードは僕のGithubリポジトリにあります。\u003cbr\u003e\nコピペで動きます。\u003cbr\u003e\n\u003ca href=\"https://github.com/kkent030315/SHA256-Algorithm-CSharp\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F472a7984-d9cb-5a9b-84a7-22e8efb1bfa5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9347254a81df040d91e760ab05757c98\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/472a7984-d9cb-5a9b-84a7-22e8efb1bfa5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F472a7984-d9cb-5a9b-84a7-22e8efb1bfa5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e75acfa337b3dc73ab4fc7ef14d871e6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e当記事内で間違いや誤字脱字等ありましたら、お手数ですがコメント欄にてご指摘いただけますと幸いです。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e最後まで読んでいただき、ありがとうございました。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"追記-不具合修正\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E8%A8%98-%E4%B8%8D%E5%85%B7%E5%90%88%E4%BF%AE%E6%AD%A3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e追記 (不具合修正)\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e一定の文字数を超えると、生成されるハッシュの値が異なる現象\u003c/li\u003e\n\u003cli\u003eその他一部で意図しない動作\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eを確認しました。\u003c/p\u003e\n\n\u003cp\u003e本題です。\u003cbr\u003e\nなぜこのプログラムで\u003cstrong\u003e一定以上の文字数を超えると算出されるハッシュ値が異なる\u003c/strong\u003eか？\u003cbr\u003e\n結論から申し上げますと、\u003cdel\u003eブロック長の記録の例外処理を完全に忘れていました。\u003cbr\u003e\n「何らかの理由で記録するスペースがなかった場合、次のブロックで記録する」\u003cbr\u003e\nという処理です。\u003c/del\u003e\u003cbr\u003e\nただのヒューマンエラーでした。\u003c/p\u003e\n\n\u003cp\u003e最初、この謎現象の原因を掴むべくデバッグしていましたら\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/91b0946c824abc8b62c7e1353de7e5a459aa9e6b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f35303065306661622d656461382d613862332d646239392d3161633563383134656235382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F500e0fab-eda8-a8b3-db99-1ac5c814eb58.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=331ebc5b35af2d73aba27f23283def07\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/500e0fab-eda8-a8b3-db99-1ac5c814eb58.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F500e0fab-eda8-a8b3-db99-1ac5c814eb58.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=31eceb8ec302d022b244d840762efdd1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e右が正しいものです。\u003cbr\u003e\nブロック末端＆チャンクが異なっています。\u003cbr\u003e\nデバッグを続けていくと、この現象は\u003cbr\u003e\n\u003cstrong\u003e一定の文字数以上(ブロック数2以上)で発生する\u003c/strong\u003eことがわかりました。\u003cbr\u003e\nしたがって、ブロック分割部分で何かしらの問題が発生していると予想できます。\u003c/p\u003e\n\n\u003cp\u003eそこで、実際に中身を見てました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b55b95d83b6e65769d663cf7bedeb07658e8a480/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f62656437303230322d386633652d636632352d633962662d6462633835326636616432642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fbed70202-8f3e-cf25-c9bf-dbc852f6ad2d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7bf3370d08eaf2f0ee6b3c414bc2ad6f\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/bed70202-8f3e-cf25-c9bf-dbc852f6ad2d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fbed70202-8f3e-cf25-c9bf-dbc852f6ad2d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bd71faac76276e4776b383cb7b45cce1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e予想的中。\u003cbr\u003e\n\u003cstrong\u003e1ブロック目と2ブロック目のブロックがそれぞれ同一の値となっている\u003c/strong\u003eことが確認できます。\u003cbr\u003e\n問題の分割関数を覗いてみます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1b30b7e06fad31e26d3c95ab9de348debfb2f5e4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f36643937616436342d396361652d313938302d646663382d3435363363376630643632322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F6d97ad64-9cae-1980-dfc8-4563c7f0d622.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e106436048b1705eb80cd1bab5d36f59\" alt=\"5799d40641a72eedc85e110d8d2b3e14.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/6d97ad64-9cae-1980-dfc8-4563c7f0d622.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F6d97ad64-9cae-1980-dfc8-4563c7f0d622.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3787124c4aaf0f28e500dbe7ac9d832e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e問題箇所を特定できました。\u003cbr\u003e\n人為的ミスは、一歩引いてソースを見てみないと中々発見できませんね。。\u003cbr\u003e\n\u003cfont color=\"red\"\u003e\u003cstrong\u003e2進数のプレーンテキスト配列の0から512までを毎回コピーしていた\u003c/strong\u003e\u003c/font\u003eことが原因でした。\u003cbr\u003e\nブロックが複数ある場合にのみ発生する不具合だったので、発見に時間がかかりました。\u003cbr\u003e\n修正後のソースコードは以下の通りです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//ブロックが複数ある場合も想定されるので、\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//n*512から512先までをコピーしなければいけない。\u003c/span\u003e\n\u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplain_bits\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eBLOCK_SIZE\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eblock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBLOCK_SIZE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e以上、折角の機会なので不具合に対する適切な対処法と僕なりのデバッグ手法を紹介してみました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"追記2-不具合について\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E8%A8%982-%E4%B8%8D%E5%85%B7%E5%90%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e追記(2) 不具合について\u003c/h1\u003e\n\n\u003cp\u003e既知の不具合として、コメント欄にてご指摘いただきました。\u003cbr\u003e\nどうやら、プレーンテキストの文字数が5文字であり、特定の文字が含まれていると発生する模様。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f8092173de6a2a0331c42443e4ceb1fe35bef0b6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f64623437616134362d613236372d393966312d386633622d3137333937346333313663362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fdb47aa46-a267-99f1-8f3b-173974c316c6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d610f7d71b520953d780acd9e5aeba5f\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/db47aa46-a267-99f1-8f3b-173974c316c6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fdb47aa46-a267-99f1-8f3b-173974c316c6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f8200998dd26be8337e17758ac8598ad 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e▼2文字分、\u003ccode\u003e0\u003c/code\u003eが抜け落ちてます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/b1eaa9c201129d5f02ee9088437af9c158ed6ace/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f31633439656334622d326262642d333735382d643233652d3666663232316638656233642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1c49ec4b-2bbd-3758-d23e-6ff221f8eb3d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8fc479ed91b9c7c0f7562829b2f50a0e\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/1c49ec4b-2bbd-3758-d23e-6ff221f8eb3d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F1c49ec4b-2bbd-3758-d23e-6ff221f8eb3d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=90062d2ef51fd7e21f92a47e6c06bda9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eだけど、\u003ccode\u003eabcdh\u003c/code\u003eは大丈夫。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/df261ae9e1b8801ea9c02673bf254a13f8b51f9a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f32383133383662632d653364352d313962392d346635342d6666383335313964353833342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F281386bc-e3d5-19b9-4f54-ff83519d5834.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a2c91a4d53d7b6b9f93cf236c9ca6d0f\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/281386bc-e3d5-19b9-4f54-ff83519d5834.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F281386bc-e3d5-19b9-4f54-ff83519d5834.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=20fa63f68676e9f0103daacb493db77a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eabcdg\u003c/code\u003eもダメ。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/862cad76a5b3604fa4f1cee433fd388aca8cb16e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f33653139633366612d346439632d616633652d633333302d3235343135626439616666652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F3e19c3fa-4d9c-af3e-c330-25415bd9affe.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=de6b7176c2a76cf2cd20b91b06259e69\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/3e19c3fa-4d9c-af3e-c330-25415bd9affe.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F3e19c3fa-4d9c-af3e-c330-25415bd9affe.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5d8646a93a4391f1557880245efa7c7d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e生成されるプレーンテキストに\u003ccode\u003e0\u003c/code\u003eが含まれていると発生するみたいです。\u003cbr\u003e\n計算に間違いがあれば生成されるハッシュ全体が変わるはずですから、\u003cbr\u003e\nこの\u003cstrong\u003e特定の文字が局所的に変化する現象\u003c/strong\u003eはハッシュを16進数に変換する課程で問題が発生していると思われます。\u003cbr\u003e\n5文字以上である時は特に問題は無い様子？\u003cbr\u003e\n↑ははっきりと原因がわからない。\u003c/p\u003e\n\n\u003cp\u003eとりあえず、デバッグプリントしてみます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e自作Bytes: (32)[ 191, 22, 120, 186, 234, 207, 1, 143, 222, 64, 65, 65, 35, 34, 174, 93, 163, 97, 3, 176, 156, 122, 23, 150, 97, 255, 16, 180, 173, 21, 0, 242 ]\n本家Bytes: (32)[ 186, 120, 22, 191, 143, 1, 207, 234, 65, 65, 64, 222, 93, 174, 34, 35, 176, 3, 97, 163, 150, 23, 122, 156, 180, 16, 255, 97, 242, 0, 21, 173 ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e4桁区切りでの規則性が見られます。\u003cbr\u003e\n\u003ccode\u003e191, 22, 120, 186\u003c/code\u003e ▶ \u003ccode\u003e186, 120, 22, 191\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003euint\u003c/code\u003eから\u003ccode\u003ebyte[4]\u003c/code\u003eの変換の際に配列をリバースする必要がある様です。\u003c/p\u003e\n\n\u003cp\u003eそこで、こんな感じにリバースしてみました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectMany\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eReverse\u003c/span\u003e\u003cspan class=\"p\"\u003e()).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e自作Bytes: (32)[ 186, 120, 22, 191, 143, 1, 207, 234, 65, 65, 64, 222, 93, 174, 34, 35, 176, 3, 97, 163, 150, 23, 122, 156, 180, 16, 255, 97, 242, 0, 21, 173 ]\n本家Bytes: (32)[ 186, 120, 22, 191, 143, 1, 207, 234, 65, 65, 64, 222, 93, 174, 34, 35, 176, 3, 97, 163, 150, 23, 122, 156, 180, 16, 255, 97, 242, 0, 21, 173 ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eOKっぽい。\u003cbr\u003e\n肝心の\u003ccode\u003eabcde\u003c/code\u003eの中身を見てみます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e自作Bytes: (32)[ 54, 187, 229, 14, 217, 104, 65, 209, 4, 67, 188, 182, 112, 214, 85, 79, 10, 52, 183, 97, 190, 103, 236, 156, 74, 138, 210, 192, 196, 76, 164, 44 ]\n本家Bytes: (32)[ 54, 187, 229, 14, 217, 104, 65, 209, 4, 67, 188, 182, 112, 214, 85, 79, 10, 52, 183, 97, 190, 103, 236, 156, 74, 138, 210, 192, 196, 76, 164, 44 ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e。。。おろ？問題ないっぽいです。\u003cbr\u003e\nこれを16進数文字列に変換してみます。\u003c/p\u003e\n\n\u003cp\u003e読みにくいコードでごめんなさい。\u003cbr\u003e\nやっていることは、\u003cbr\u003e\n\u003ccode\u003euint\u003c/code\u003e▶\u003ccode\u003ebyte\u003c/code\u003e▶\u003ccode\u003eReverse()\u003c/code\u003e▶\u003ccode\u003eConcat()\u003c/code\u003e▶\u003ccode\u003ebyte\u003c/code\u003e▶\u003ccode\u003estring(64)\u003c/code\u003e\u003cbr\u003e\nこんな感じです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectMany\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eBitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eReverse\u003c/span\u003e\u003cspan class=\"p\"\u003e()).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003emakehash_fixed_test\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelectMany\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eJoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eX2\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFormat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"MakeHashFixed?: ({0}) : {1}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToLower\u003c/span\u003e\u003cspan class=\"p\"\u003e()));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e無事解決しました！\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eMakeHashFixed?: (64) : 36bbe50ed96841d10443bcb670d6554f0a34b761be67ec9c4a8ad2c0c44ca42c\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/dd4d0ceed00aec2e9eb5fdd20724a5e48122c530/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3533353237302f34353836303261622d626662652d633266312d313562652d3033346462323137306134392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F458602ab-bfbe-c2f1-15be-034db2170a49.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=51c0eba10311a6bcbb77fd647101e987\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/458602ab-bfbe-c2f1-15be-034db2170a49.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2F458602ab-bfbe-c2f1-15be-034db2170a49.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ddc247ddcceac1e4f924b95026fa5ca6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eやはり、予想通りエンコーディングの問題でした。\u003cbr\u003e\n具体的な原因は謎ですが、\u003cbr\u003e\n下記のコードでも不具合が発生することを考えると、フレームワークの不具合なのかな？と思ったり。\u003cbr\u003e\nとにかく、\u003ccode\u003ebyte\u003c/code\u003eを噛ませないとダメみたいですね。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//これも不具合発生.\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003euint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eX2\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eJoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToLower\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n","createdAt":"2020-01-14T05:59:26Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"qcJORK77i9ciaUrpokOH9nsI/cwOXB9o4A==--dpYnRpVvJGcU7hKe--R5xIjhL376DKhe4jWH2AoA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-01-20T21:47:31Z","likesCount":142,"linkUrl":"https://qiita.com/kkent030315/items/3f095208ed083ce9f1e5","organization":null,"originalId":1137595,"stockedCount":85,"title":"高校生がC#でSHA256暗号化アルゴリズムを完全独自実装してみた。","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E7%BD%AE%E3%81%8D\"\u003e前置き\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sha256%E3%81%AE%E7%89%B9%E5%BE%B4\"\u003eSHA256の特徴\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A3%85%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e実装してみる\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%A4%A7%E3%81%BE%E3%81%8B%E3%81%AA%E5%87%A6%E7%90%86%E3%83%95%E3%83%AD%E3%83%BC\"\u003e大まかな処理フロー\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1%E5%B9%B3%E6%96%8716%E9%80%B2%E6%95%B0%E3%82%922%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003e1.平文(16進数)を2進数に変換\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2%E3%83%91%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86\"\u003e2.パディング処理\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#3%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%82%92%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AB%E5%88%86%E5%89%B2\"\u003e3.ブロックをメッセージブロックに分割\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#4%E5%88%9D%E6%9C%9F%E3%83%99%E3%82%AF%E3%83%88%E3%83%AB%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E7%AE%97%E5%87%BA\"\u003e4.初期ベクトルを使用してハッシュ値を算出\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#5%E5%90%88%E8%A8%8864%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%86\"\u003e5.合計64ラウンド処理を行う\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AB%96%E7%90%86%E4%BB%A3%E6%95%B0\"\u003e論理代数\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ch\"\u003eCh\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#maj-%E5%A4%89%E6%95%B0%E5%A4%9A%E6%95%B0%E6%B1%BA%E9%96%A2%E6%95%B0\"\u003eMaj (変数多数決関数)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rotr-rotation-right\"\u003eRotR (Rotation Right)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#rotl-rotation-left\"\u003eRotL (Rotation Left)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%CF%830-sigma0\"\u003eΣ0 (Sigma0)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%CF%831-sigma1\"\u003eΣ1 (Sigma1)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#c%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\"\u003eC#ソースコード\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9A%E6%95%B0k\"\u003e定数K\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#computehash-%E9%96%A2%E6%95%B0---%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E7%AE%97%E5%87%BA\"\u003eComputeHash() 関数 - ハッシュ値を算出\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#touint32array-%E9%96%A2%E6%95%B0---2%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003eToUInt32Array() 関数 - 2進数に変換\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#calculatek-%E9%96%A2%E6%95%B0---k%E3%82%92%E7%AE%97%E5%87%BA\"\u003eCalculateK() 関数 - Kを算出\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#padding-%E9%96%A2%E6%95%B0---%E3%83%91%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0\"\u003ePadding() 関数 - パディング\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#parse-%E9%96%A2%E6%95%B0---%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E5%88%86%E5%89%B2\"\u003eParse() 関数 - ブロックの分割\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#expandblock-%E9%96%A2%E6%95%B0---%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AE%E3%83%97%E3%83%AC%E5%87%A6%E7%90%86\"\u003eExpandBlock() 関数 - ブロックのプレ処理\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#makepair-%E9%96%A2%E6%95%B0---%E3%83%9A%E3%82%A2%E3%82%92%E7%94%9F%E6%88%90\"\u003eMakePair() 関数 - ペアを生成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#makehash-%E9%96%A2%E6%95%B0---16%E9%80%B2%E6%95%B0%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003eMakeHash() 関数 - 16進数に変換\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#tobinary-%E9%96%A2%E6%95%B0---%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003eToBinary() 関数 - バイナリに変換\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#binarytodecimal-%E9%96%A2%E6%95%B0---%E3%83%87%E3%82%B7%E3%83%9E%E3%83%AB%E3%81%AB%E5%A4%89%E6%8F%9B\"\u003eBinaryTodecimal() 関数 - デシマルに変換\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%87%AA%E4%BD%9C%E4%BE%BF%E5%88%A9%E9%96%A2%E6%95%B0\"\u003e自作便利関数\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#extend-%E9%96%A2%E6%95%B0---%E9%85%8D%E5%88%97%E3%82%92%E6%8B%A1%E5%BC%B5\"\u003eExtend() 関数 - 配列を拡張\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#printarray-%E9%96%A2%E6%95%B0---%E9%85%8D%E5%88%97%E3%82%92%E3%81%84%E3%81%84%E6%84%9F%E3%81%98%E3%81%AB%E5%87%BA%E5%8A%9B\"\u003ePrintArray() 関数 - 配列をいい感じに出力\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#strmid-%E9%96%A2%E6%95%B0---%E6%95%B0%E5%80%A4%E3%81%AE%E4%B8%AD%E3%81%8B%E3%82%89%E6%95%B0%E5%80%A4%E3%82%92%E5%8F%96%E3%82%8A%E5%87%BA%E3%81%99\"\u003eStrMid() 関数 - 数値の中から数値を取り出す\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F\"\u003e実行してみた！\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%87%A6%E7%90%86%E6%99%82%E9%96%93\"\u003e処理時間\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e最後に\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%BF%BD%E8%A8%98-%E4%B8%8D%E5%85%B7%E5%90%88%E4%BF%AE%E6%AD%A3\"\u003e追記 (不具合修正)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%BF%BD%E8%A8%982-%E4%B8%8D%E5%85%B7%E5%90%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e追記(2) 不具合について\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":12529,"uuid":"3f095208ed083ce9f1e5","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"0BPHGg3FD/xGfchbicDvpfbgLqZh--PTREbwmHJHZHdyDF--C1cOlqlmRVZChXFeg9anHg==","originalId":535270,"description":"","facebookUrl":null,"githubUrl":"https://github.com/kkent030315","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":"https://www.linkedin.com/in/kento-oki","name":"沖 絢斗","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/535270/profile-images/1627665079","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fprofile-images%2F1627665079?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=99a1660a32a63cb24c00d818c9a27134","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F535270%2Fprofile-images%2F1627665079?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=40ff829c53c059c5406fc09aad5dba9d","urlName":"kkent030315","websiteUrl":"https://www.godeye.club/","twitterUrl":"https://twitter.com/kento932376","twitterUrlName":"kento932376","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C","urlName":"c"},{"name":"C#","urlName":"csharp"},{"name":"アルゴリズム","urlName":"%e3%82%a2%e3%83%ab%e3%82%b4%e3%83%aa%e3%82%ba%e3%83%a0"},{"name":"暗号化","urlName":"%e6%9a%97%e5%8f%b7%e5%8c%96"},{"name":"sha256","urlName":"sha256"}],"followingLikers":{"edges":[]},"comments":{"totalCount":8}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
