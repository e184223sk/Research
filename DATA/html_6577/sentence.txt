More than 3 years have passed since last update.SIDを取得する際に whoami /user を実行するとユーザーSIDを取得することが出来る。いろんなサイトだと、ここから末尾のRIDを除いた値がコンピューターSIDだと記載してるけど、ドメインユーザーでログインしてるとその方法は使えない。
その場合でもローカルユーザーのSIDを表示させれば同じ事は出来るんだけど、出来ればちゃんとした方法で取得したい。最近C++を使ってみる機会があったし、関数の使い方をちゃんと把握するのに都合がよかったので C++ → C# (→ PowerShell)で作ってみました。
特にC++は初心者なので、書き方とか解放とか微妙かもしれません。エラー処理もしてません。
(wstringに変換しているのはコピーが楽そうだからです。)取得方法含め、ご利用は自己責任でお願いします、というよくある但し書きをつけておきます。参考にしたページは以下です。(参考というより、必要な部分だけ削り出したような感じですが。)
PInvoke.NETの方はほとんど書き終わった後で必要なコードほぼ全部書いてるじゃん、と気づいてしまいました。中身はC++をそのまま移植しただけです。PowerShellと見せかけてC#そのままです。


