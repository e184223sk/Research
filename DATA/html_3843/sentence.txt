More than 1 year has passed since last update.NLog には呼び出し元情報をログに出力する機能があります。既定の動作ではスタックトレースを利用しますので、ロガークラスのログ出力メソッドを呼び出した一つ前のスタックフレームの情報が出力されます。なお、NLog のバージョンは 4.5.10 です。アプリケーションコードとログ出力メソッドの間に拡張メソッドやラッパークラスを挟むと、（実装としては正しい動作ですが、）プログラマが期待している呼び出し元情報は出力されません。ログ出力時にロガーの型を指定することによって、呼び出し元情報の取得動作を変えることができます。スタックトレースを遡る過程で、指定されたロガーの型が現れるフレームの次のフレームが呼び出し元であると見なされます。【A certain engineer "COMPLEX"】開発メモ その30 LoggerServiceを実装する スタックトレースを使用する以上、実行ディレクトリに pdb ファイルが必要です。pdb ファイルがない場合は呼び出し元情報は取得されません。NLog では、明示的に呼び出し元情報が指定されている場合にはスタックトレースからの情報を使用しないように実装されています。.NET Framework 4.5 で追加された CallerInfo 属性を使用します。これらの属性を使用すると、呼び出し時に引数が省略された場合にコンパイラによってリテラル値が埋め込まれます。実行時のコストがなくなるのが特徴です。ただ、残念ながら提供されているのは CallerMemberName CallerFilePath CallerLineNumber の三つのみです。クラス名に対応した属性は提供されていません。今後のバージョンアップで追加されることを期待します。呼び出し元クラス名を取得できる属性はないため、仕方なくスタックトレースから取得しています。コンパイラや JIT の動作によって変わる可能性があり、実用的にはこのままの実装では問題があると思います。指定した呼び出し元が出力されています。BtnNLogAsync_Click メソッドからの Info メソッドは NLog の既定の動作によって呼び出し元が取得されていますので、呼び出し元メソッド名は MoveNext になっています。log4net もスタックトレースを使用して呼び出し元情報を取得します。ロガーの型を与えることによって取得するフレームを制御することはできますが、呼び出し元情報を直接指定する方法を見つけることはできませんでした。CallerInfo 属性に呼び出し元クラス名を取得できる属性が追加されれば、「明示的に呼び出し元情報を指定する」方法がよいのではないかと思います。
多くのログライブラリには呼び出し元情報を出力する機能がありますが、できれば特定のログライブラリの実装に依存したくはありません。NLog の callsite や log4net の %class のようなライブラリ固有の機能ではなく、CallerInfo 属性を用いてリテラル値で取得し、ログメッセージ文字列やペイロードとして出力するのがよいのではないかと思います・


