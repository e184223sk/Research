<!DOCTYPE html><html><head><meta charset="utf-8" /><title>「オブジェクト指向が5000%理解できる記事(実践編)」の解答編 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/hiki_neet_p/items/d4624635d8baedba44c9" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="xcE8Zlbu3DnjaSOVLObgebhHp8ICm1LMxTs8hNofYpUXNhprTFJXNYVrUEtnJvq86oBj96nSQTl6FsIP1cFB4Q==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@hiki_neet_p" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="「オブジェクト指向が5000%理解できる記事(実践編)」の解答編 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENNNDRLcTQ0T1c0NEs0NDRLbjQ0S3Y0NE9JNW95SDVaQ1I0NEdNTlRBd01DWG5rSWJvcDZQamdhZmpnWTNqZ292b3FKamt1b3NvNWE2ZjZMZTE1N2VvS2VPQWplT0JydWluby1ldGxPZTNxQSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz04MDYwNGYzMmMxMzAwODhlYjYwMTg3NmY4ZjBlMGE0ZQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR2hwYTJsZmJtVmxkRjl3JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9N2U1MGI4OWM0YjlhNjBjMGFiYzRhYTJmMDg0YWIxZDY&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=25c71087457dcba81dd1838fc743685d"><meta property="og:description" content="2018/10/10追記
記事を大きく修正しました。
変更箇所は、お手数ですが「編集履歴」を参照してください。


謝辞

本記事の答えに辿り着くまでに、色々な方にご指摘をいただき、大変助かりました（コメント欄をご覧ください）。

特..."><meta content="https://qiita.com/hiki_neet_p/items/d4624635d8baedba44c9" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,アルゴリズム,オブジェクト指向" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-8af4bf94-37c1-4e44-b957-43535b3267d9"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fhiki_neet_p%2Fitems%2Fd4624635d8baedba44c9">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fhiki_neet_p%2Fitems%2Fd4624635d8baedba44c9">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-8af4bf94-37c1-4e44-b957-43535b3267d9">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-09-30T21:13:00.000+09:00","dateModified":"2018-10-10T12:55:12.000+09:00","headline":"「オブジェクト指向が5000%理解できる記事(実践編)」の解答編","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENNNDRLcTQ0T1c0NEs0NDRLbjQ0S3Y0NE9JNW95SDVaQ1I0NEdNTlRBd01DWG5rSWJvcDZQamdhZmpnWTNqZ292b3FKamt1b3NvNWE2ZjZMZTE1N2VvS2VPQWplT0JydWluby1ldGxPZTNxQSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz04MDYwNGYzMmMxMzAwODhlYjYwMTg3NmY4ZjBlMGE0ZQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR2hwYTJsZmJtVmxkRjl3JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9N2U1MGI4OWM0YjlhNjBjMGFiYzRhYTJmMDg0YWIxZDY\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=25c71087457dcba81dd1838fc743685d","mainEntityOfPage":"https://qiita.com/hiki_neet_p/items/d4624635d8baedba44c9","author":{"@type":"Person","address":"","email":null,"identifier":"hiki_neet_p","name":"hiki_neet_p","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F53668%2Fprofile-images%2F1551575525?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=9bce97088c66ea2aecaab5dff0543fa0","url":"https://qiita.com/hiki_neet_p","description":"プログラミングは趣味でやっていますが、いずれは何かアプリをリリースしたいと思っています。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"hiki_neet_p","type":"items","id":"d4624635d8baedba44c9"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"hiki_neet_p","type":"items","id":"d4624635d8baedba44c9"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"hiki_neet_p","type":"items","id":"d4624635d8baedba44c9"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/hiki_neet_p/items/d4624635d8baedba44c9","location":"/hiki_neet_p/items/d4624635d8baedba44c9","scheme":"https","host":"qiita.com","port":null,"pathname":"/hiki_neet_p/items/d4624635d8baedba44c9","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"68Q4Fc2Ny5zroxLJpzdETroW2s7aJKu9TE6PVPRM6jA5Mx4Y1zFAkI2hYRfs916L6NEe+3FtuEjzY3Hf+5LJRA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-a54adced-7bc2-40aa-bade-53c813771a9c"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/hiki_neet_p/items/d4624635d8baedba44c9/likers" class="css-1iupg5d">34</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">38</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/d4624635d8baedba44c9/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/hiki_neet_p/items/d4624635d8baedba44c9/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/hiki_neet_p/items/d4624635d8baedba44c9/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/hiki_neet_p/items/d4624635d8baedba44c9/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/hiki_neet_p/items/d4624635d8baedba44c9.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/hiki_neet_p"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/53668/profile-images/1551575525" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/hiki_neet_p" class="css-10ougpm">@<!-- -->hiki_neet_p</a><div class="css-1ay9vb9"><span><meta content="2018-09-30T12:13:00Z"/><time dateTime="2018-10-10T03:55:12Z" class="css-m19uds">updated at 2018-10-10</time></span></div></div></div></div></div><h1 class="css-cgzq40">「オブジェクト指向が5000%理解できる記事(実践編)」の解答編</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e3%82%a2%e3%83%ab%e3%82%b4%e3%83%aa%e3%82%ba%e3%83%a0" class="css-4czcte">アルゴリズム</a><a href="/tags/%e3%82%aa%e3%83%96%e3%82%b8%e3%82%a7%e3%82%af%e3%83%88%e6%8c%87%e5%90%91" class="css-4czcte">オブジェクト指向</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><strong>2018/10/10追記</strong><br>
<strong>記事を大きく修正しました。</strong><br>
<strong>変更箇所は、お手数ですが「編集履歴」を参照してください。</strong></p>

<h1>
<span id="謝辞" class="fragment"></span><a href="#%E8%AC%9D%E8%BE%9E"><i class="fa fa-link"></i></a>謝辞</h1>

<p>本記事の答えに辿り着くまでに、色々な方にご指摘をいただき、大変助かりました（コメント欄をご覧ください）。</p>

<p>特に <a href="/sumim" class="user-mention js-hovercard" title="sumim" data-hovercard-target-type="user" data-hovercard-target-name="sumim">@sumim</a> 氏には、問題と解答を提供していただきましたが、これがなければ本記事を仕上げることは叶いませんでした。深く感謝いたします。</p>

<p>試行錯誤する中で、私にとって勉強になることは多く、良い経験になりました。ありがとうございました。</p>

<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>本記事は、<a href="/sumim" class="user-mention js-hovercard" title="sumim" data-hovercard-target-type="user" data-hovercard-target-name="sumim">@sumim</a> 氏が改変して紹介した<strong>インディアン・ポーカーに関するプログラミング問題</strong>の解法を説明しながら、<strong>オブジェクト指向プログラミング</strong>に触れてみるものです。</p>

<p>私がこの問題を目にしたのは、<a href="/gorillab" class="user-mention js-hovercard" title="gorillab" data-hovercard-target-type="user" data-hovercard-target-name="gorillab">@gorillab</a> 氏による以下の記事を読んだときでした。</p>

<p><a href="https://qiita.com/gorillab/items/b2f8e39d7cc23ad505f9" id="reference-8dd1cfa4f82379619de6">オブジェクト指向が5000%理解できる記事</a><br>
<a href="https://qiita.com/gorillab/items/fab2a6637f681221f687" id="reference-657ac2e7f197ce4a345c">オブジェクト指向が5000%理解できる記事(実践編)</a></p>

<p>両記事は大きな反響を生んだため、ご存知の方も多いと思います。この「実践編」にて、インディアン・ポーカー問題が取り上げられていました。</p>

<p>この問題は非情に難しく、また奥が深い問題です。しかし、上記事では大変雑に取り上げられていました。オブジェクト指向の初心者向け解説記事を謳いながら、実質的に何の解決にもならない曖昧な説明で終わっています。</p>

<p>対照的に、コメント欄は盛り上がりました。問題の紹介者である <a href="/sumim" class="user-mention js-hovercard" title="sumim" data-hovercard-target-type="user" data-hovercard-target-name="sumim">@sumim</a> 氏が登場し、解法を示してくださいました。しかし、そこで示された解法が不完全であることに気がついたので、私なりにこの問題を解き、本記事を書こうと思いました。</p>

<h1>
<span id="インディアンポーカー問題" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%82%A2%E3%83%B3%E3%83%9D%E3%83%BC%E3%82%AB%E3%83%BC%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>インディアン・ポーカー問題</h1>

<h2>
<span id="解決対象となる問題" class="fragment"></span><a href="#%E8%A7%A3%E6%B1%BA%E5%AF%BE%E8%B1%A1%E3%81%A8%E3%81%AA%E3%82%8B%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>解決対象となる問題</h2>

<p><a href="https://www.rco.recruit.co.jp/career/engineer/entry/" rel="nofollow noopener" target="_blank">リクルートコミュニケーションズのコーディング試験</a>で過去に出題された問題を、<a href="https://twitter.com/sumim" rel="nofollow noopener" target="_blank">@sumim</a> 氏が改変したものです。</p>

<p>問題はこちら → <a href="https://twitter.com/sumim/status/1043665621433470977" class="autolink" rel="nofollow noopener" target="_blank">https://twitter.com/sumim/status/1043665621433470977</a></p>

<h3>
<span id="問題の要点" class="fragment"></span><a href="#%E5%95%8F%E9%A1%8C%E3%81%AE%E8%A6%81%E7%82%B9"><i class="fa fa-link"></i></a>問題の要点</h3>

<ul>
<li>この問題におけるインディアン・ポーカー

<ul>
<li>2人以上のプレイヤーで行なう。</li>
<li>数字の書かれたカードを用意する（カード数はプレイヤー数以上）。</li>
<li>プレイヤーにカードを配るが、各プレイヤーは自分のカードの数字を見てはいけない。</li>
<li>各プレイヤーはカードを額にかざす。カード数字は自分を除く他プレイヤーに見える状態となる。</li>
<li>この状態で、各プレイヤーは順番に、自分のカードの数字を予想し、宣言してゆく。</li>
<li>宣言の内容は4種類。

<ul>
<li>自分が1番小さい「<code>MIN</code>」</li>
<li>自分が1番大きい「<code>MAX</code>」</li>
<li>自分は最大と最小以外である「<code>MID</code>」</li>
<li>分からない「<code>?</code>」</li>
</ul>
</li>
<li>1人でも答えが分かったらゲーム終了。</li>
<li>プレイヤーは嘘をつかず、最善を尽くす。</li>
<li>
<del>無限ループになる可能性がある。</del> <strong>無限ループは発生せず、答えは必ず求まることが分かりました。</strong>
</li>
</ul>
</li>
</ul>

<h3>
<span id="例" class="fragment"></span><a href="#%E4%BE%8B"><i class="fa fa-link"></i></a>例</h3>

<p>カード <code>{ 1, 2, 3, 4, 5 }</code><br>
プレイヤー <code>{ A, B, C }</code></p>

<ul>
<li>
<p><code>A=1, B=4, C=5</code> の場合</p>

<ul>
<li><code>A=&gt;MIN</code></li>
</ul>
</li>
<li>
<p><code>A=1, B=2, C=4</code> の場合</p>

<ul>
<li><code>A=&gt;?, B=&gt;MID</code></li>
</ul>
</li>
</ul>

<h1>
<span id="問題の解答" class="fragment"></span><a href="#%E5%95%8F%E9%A1%8C%E3%81%AE%E8%A7%A3%E7%AD%94"><i class="fa fa-link"></i></a>問題の解答</h1>

<p>こちらです↓</p>

<p><a href="https://github.com/tana-gh/indian_poker" rel="nofollow noopener" target="_blank">インディアン・ポーカー・ソルバー</a></p>

<p>.NET Core 2.1、C#7.3 です。</p>

<h2>
<span id="動かし方" class="fragment"></span><a href="#%E5%8B%95%E3%81%8B%E3%81%97%E6%96%B9"><i class="fa fa-link"></i></a>動かし方</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>git clone git@github.com:tana-gh/indian_poker.git
cd indian_poker
dotnet run -p IndianPoker.App.Multiple/IndianPoker.App.Multiple.csproj -- 5 3
</code></pre></div></div>

<p>上記 <code>5 3</code> の部分には、それぞれ<strong>カード枚数</strong>、<strong>プレイヤー人数</strong>を指定してください。<br><br>
（大きな数を指定すると計算時間がかかる場合があります）</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>dotnet run -p IndianPoker.App.Multiple/IndianPoker.App.Multiple.csproj -- &lt;カード枚数&gt; &lt;プレイヤー人数&gt;
</code></pre></div></div>

<p>配るカードを指定する場合はこちらです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>dotnet run -p IndianPoker.App.Single/IndianPoker.App.Single.csproj -- &lt;カード枚数&gt; &lt;プレイヤー人数&gt; &lt;カード1&gt; &lt;カード2&gt; ...
</code></pre></div></div>

<h1>
<span id="コードの概要" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%A6%82%E8%A6%81"><i class="fa fa-link"></i></a>コードの概要</h1>

<p>私の書いたコードは 5 つのプロジェクトに分割されています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>IndianPoker.App.Multiple // 実行プログラム（複数ケースを出力）
IndianPoker.App.Single   // 実行プログラム（単一ケースを出力）
IndianPoker.Lib          // 今回のソルバーを含む
IndianPoker.Lib.Utils    // ユーティリティ
IndianPoker.Test         // テスト
</code></pre></div></div>

<p>このうち、<code>IndianPoker.Lib</code> だけが重要なので、以下ではこのプロジェクトについて説明します。クラスをどのように分けるかというのは、一種のパズルです。各クラスがどのような意図を持つのか、想像しながら見ていただけると嬉しいです。</p>

<p>※ 私のコードの書き方で、アクセス修飾子が <code>internal</code> または <code>private</code> のシンボルに <code>_</code> アンダースコアのプレフィックスをつけています。</p>

<h2>
<span id="クラス構成" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%B9%E6%A7%8B%E6%88%90"><i class="fa fa-link"></i></a>クラス構成</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>IndianPoker.Lib

public class Solver          // ゲームを進行し、結果を生成
public struct PlayerAnswer   // プレイヤーの答え
public enum AnswerValue      // 答えの内容
internal class _Card         // カード
internal class _Deck         // カードのデッキ
internal class _Player       // プレイヤー
internal struct _VisibleCard // 見えているカード
internal class _Inference    // 推論に関する情報
internal class _PlayerOrder  // 手番の順序
</code></pre></div></div>

<h2>
<span id="クラス図" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%B9%E5%9B%B3"><i class="fa fa-link"></i></a>クラス図</h2>

<p><a href="https://camo.qiitausercontent.com/9df4b1d19208052924e6ee58f779cbea37d60a79/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35333636382f39623739653635342d666663392d383739322d653834372d6662666431383538663466322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F53668%2F9b79e654-ffc9-8792-e847-fbfd1858f4f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5302ff480069f441901b1f7f75930bf9" alt="classes.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/53668/9b79e654-ffc9-8792-e847-fbfd1858f4f2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F53668%2F9b79e654-ffc9-8792-e847-fbfd1858f4f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c60a8a7e738151d60a4390eac5364cfe 1x" loading="lazy"></a></p>

<h2>
<span id="solver" class="fragment"></span><a href="#solver"><i class="fa fa-link"></i></a><code>Solver</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// ゲームを進行し、結果を生成</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Solver</span>
<span class="p">{</span>
    <span class="c1">// 参加プレイヤーと所持カード</span>
    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;(</span><span class="kt">string</span> <span class="n">playerName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cardNumber</span><span class="p">)&gt;</span> <span class="n">NameAndNumbers</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// allNumbers : 全カードの数字列</span>
    <span class="c1">// deckNumbers: プレイヤーのドローするカードの数字列（与えられた順）</span>
    <span class="c1">// playerNames: プレイヤーの名前列（与えられた順）</span>
    <span class="k">public</span> <span class="nf">Solver</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">allNumbers</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">deckNumbers</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">playerNames</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="c1">// ゲームを進行し、結果を生成する</span>
    <span class="c1">// return: 答え列</span>
    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">PlayerAnswer</span><span class="p">&gt;</span> <span class="nf">Solve</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ゲームの進行を担います。</p>

<p>最初にコンストラクタで、全てのカードに書かれた数字、プレイヤーに配られるカードの数字、全てのプレイヤーの名前、を受け取ります。その情報をもとに、まず <code>_Deck</code> を生成します。<code>_Deck</code> は <code>_Card</code> を生成し、その <code>_Card</code> を <code>_Player</code> コンストラクタに渡します。このとき渡す <code>_Card</code> は、他の <code>_Player</code> が掲げているカードです（このゲームでは、自分のカードを見てはいけない）。</p>

<p><code>Solve</code> メソッドでゲームをシミュレートし、ゲーム中にプレイヤー達が宣言した答えを返します。</p>

<h2>
<span id="playeranswer" class="fragment"></span><a href="#playeranswer"><i class="fa fa-link"></i></a><code>PlayerAnswer</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// プレイヤーの答え</span>
<span class="k">public</span> <span class="k">struct</span> <span class="nc">PlayerAnswer</span>
<span class="p">{</span>
    <span class="c1">// 答えを宣言したプレイヤーの名前（nullable）</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">PlayerName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// 答えの内容</span>
    <span class="k">public</span> <span class="n">AnswerValue</span> <span class="n">Value</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// playerName: 答えを宣言したプレイヤーの名前（nullable）</span>
    <span class="c1">// value: 答えの内容</span>
    <span class="k">public</span> <span class="nf">PlayerAnswer</span><span class="p">(</span><span class="kt">string</span> <span class="n">playerName</span><span class="p">,</span> <span class="n">AnswerValue</span> <span class="k">value</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>プレイヤーの名前と、プレイヤーが宣言した答えです。</p>

<h2>
<span id="answervalue" class="fragment"></span><a href="#answervalue"><i class="fa fa-link"></i></a><code>AnswerValue</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 答えの内容</span>
<span class="k">public</span> <span class="k">enum</span> <span class="n">AnswerValue</span>
<span class="p">{</span>
    <span class="n">Unknown</span><span class="p">,</span> <span class="c1">// ?   に相当</span>
    <span class="n">Min</span><span class="p">,</span>     <span class="c1">// MIN に相当</span>
    <span class="n">Mid</span><span class="p">,</span>     <span class="c1">// MID に相当</span>
    <span class="n">Max</span>      <span class="c1">// MAX に相当</span>
<span class="p">}</span>
</code></pre></div></div>

<p>答えの内容です。</p>

<h2>
<span id="_card" class="fragment"></span><a href="#_card"><i class="fa fa-link"></i></a><code>_Card</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">internal</span> <span class="k">class</span> <span class="nc">_Card</span>
<span class="p">{</span>
    <span class="c1">// カードに書かれた数字</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">Number</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// number: カードに書かれた数字</span>
    <span class="k">public</span> <span class="nf">_Card</span><span class="p">(</span><span class="kt">int</span> <span class="n">number</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>カードです。カードに書かれた数字を取得できます。</p>

<h2>
<span id="_deck" class="fragment"></span><a href="#_deck"><i class="fa fa-link"></i></a><code>_Deck</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// カードのデッキ</span>
<span class="k">internal</span> <span class="k">class</span> <span class="nc">_Deck</span>
<span class="p">{</span>
    <span class="c1">// プレイヤーがドローするカード列</span>
    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_Card</span><span class="p">&gt;</span> <span class="n">DeckCards</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// ソート済みの全カード</span>
    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_Card</span><span class="p">&gt;</span> <span class="n">SortedCards</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// allNumber  : 全カードの数字列</span>
    <span class="c1">// deckNumbers: プレイヤーがドローするカードの数字列</span>
    <span class="k">public</span> <span class="nf">_Deck</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">allNumbers</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">deckNumbers</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>デッキです。<code>DeckCards</code> は、プレイヤーに配られるカードがプレイヤー順に格納されています。対して <code>SortedCards</code> は、全てのカードが昇順に格納されています。</p>

<p><code>DeckCards</code> と <code>SortedCards</code> で共通の数字を持つカードは、同一のインスタンスです。</p>

<h2>
<span id="_player" class="fragment"></span><a href="#_player"><i class="fa fa-link"></i></a><code>_Player</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">internal</span> <span class="k">class</span> <span class="nc">_Player</span>
<span class="p">{</span>
    <span class="c1">// プレイヤーの名前</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// 推論に関する情報</span>
    <span class="k">private</span> <span class="n">_Inference</span> <span class="n">_Inference</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// name: プレイヤーの名前</span>
    <span class="c1">// visibleCards: 他プレイヤーのカード</span>
    <span class="c1">// allCards    : 全カード</span>
    <span class="c1">// order       : 手番の順序</span>
    <span class="k">public</span> <span class="nf">_Player</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_VisibleCard</span><span class="p">&gt;</span> <span class="n">visibleCards</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_Card</span><span class="p">&gt;</span> <span class="n">allCards</span><span class="p">,</span> <span class="n">_PlayerOrder</span> <span class="n">order</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="c1">// 答えを宣言する</span>
    <span class="c1">// orderIndex: _PlayerOrder上における現在の順番</span>
    <span class="k">public</span> <span class="n">PlayerAnswer</span> <span class="nf">SayAnswer</span><span class="p">(</span><span class="kt">int</span> <span class="n">orderIndex</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>プレイヤーです。推論に関する情報である <code>_Inference</code> を内部に持っています。<br>
<code>SayAnswer</code> で、自分の答えを宣言します。</p>

<h2>
<span id="_visiblecard" class="fragment"></span><a href="#_visiblecard"><i class="fa fa-link"></i></a><code>_VisibleCard</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 見えているカード</span>
<span class="k">internal</span> <span class="k">struct</span> <span class="nc">_VisibleCard</span>
<span class="p">{</span>
    <span class="c1">// カードを所持するプレイヤーの名前</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">PlayerName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// 見えているカード</span>
    <span class="k">public</span> <span class="n">_Card</span> <span class="n">Card</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// playerName: カードを所持するプレイヤーの名前</span>
    <span class="c1">// card: 見えているカード</span>
    <span class="k">public</span> <span class="nf">_VisibleCard</span><span class="p">(</span><span class="kt">string</span> <span class="n">playerName</span><span class="p">,</span> <span class="n">_Card</span> <span class="n">card</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>プレイヤーが額にかざしているカードです。プレイヤーの名前とカードがセットになっています。</p>

<h2>
<span id="_inference" class="fragment"></span><a href="#_inference"><i class="fa fa-link"></i></a><code>_Inference</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 推論に関する情報</span>
<span class="k">internal</span> <span class="k">class</span> <span class="nc">_Inference</span>
<span class="p">{</span>
    <span class="c1">// 推論対象のプレイヤーの名前</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">_PlayerName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// プレイヤーに見えているカード列</span>
    <span class="k">private</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_VisibleCard</span><span class="p">&gt;</span> <span class="n">_VisibleCards</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// 全カード列</span>
    <span class="k">private</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_Card</span><span class="p">&gt;</span> <span class="n">_AllCards</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// 手番の順序</span>
    <span class="k">private</span> <span class="n">_PlayerOrder</span> <span class="n">_Order</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// _Inferメソッドのメモ</span>
    <span class="k">private</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="n">_MemoKey</span><span class="p">,</span> <span class="n">PlayerAnswer</span><span class="p">&gt;</span> <span class="n">_Memo</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// playerName  : 推論対象のプレイヤーの名前</span>
    <span class="c1">// visibleCards: プレイヤーに見えているカード列</span>
    <span class="c1">// allCards    : 全カード列</span>
    <span class="c1">// order       : 手番の順序</span>
    <span class="k">public</span> <span class="nf">_Inference</span><span class="p">(</span><span class="kt">string</span> <span class="n">playerName</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_VisibleCard</span><span class="p">&gt;</span> <span class="n">visibleCards</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_Card</span><span class="p">&gt;</span> <span class="n">allCards</span><span class="p">,</span> <span class="n">_PlayerOrder</span> <span class="n">order</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="c1">// 現在の順番に基づき、答えを導出する</span>
    <span class="c1">// orderIndex: _PlayerOrder上における現在の順番</span>
    <span class="c1">// return    : 答え</span>
    <span class="k">public</span> <span class="n">PlayerAnswer</span> <span class="nf">Infer</span><span class="p">(</span><span class="kt">int</span> <span class="n">orderIndex</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>今回のソルバーの推論に関わる、アルゴリズムをまとめたものです。</p>

<p>各プレイヤーがこの <code>_Inference</code> を 1 つずつ持ちます。自プレイヤーが持つ推論情報は、当然自分のカードを知らない状態にあります。与えられた他プレイヤーのカード情報をもとに、最善手で答えを導きます。</p>

<p>答えを導出する <code>Infer</code> メソッドは、<code>orderIndex</code> を受け取りますが、これは、プレイヤーの手番の順序列を生成する <code>_PlayerOrder</code> のインデックスです。</p>

<p>次章では、このクラスがどのようにインディアン・ポーカー問題を解決するのかを見ていきます。</p>

<h2>
<span id="_playerorder" class="fragment"></span><a href="#_playerorder"><i class="fa fa-link"></i></a><code>_PlayerOrder</code>
</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 手番の順序</span>
<span class="k">internal</span> <span class="k">class</span> <span class="nc">_PlayerOrder</span>
<span class="p">{</span>
    <span class="c1">// 全プレイヤーの名前列</span>
    <span class="k">private</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">_PlayerNames</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="c1">// playerNames: 全プレイヤーの名前列</span>
    <span class="k">public</span> <span class="nf">_PlayerOrder</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">playerNames</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="c1">// 手番の順序を生成する</span>
    <span class="c1">// return: 順序付けられたプレイヤーの名前列</span>
    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">GetPlayerNames</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>プレイヤーの手番の順序どおりに、プレイヤー名をイテレートする列挙子を生成します。</p>

<h1>
<span id="アルゴリズム" class="fragment"></span><a href="#%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0"><i class="fa fa-link"></i></a>アルゴリズム</h1>

<h2>
<span id="答えの確定条件" class="fragment"></span><a href="#%E7%AD%94%E3%81%88%E3%81%AE%E7%A2%BA%E5%AE%9A%E6%9D%A1%E4%BB%B6"><i class="fa fa-link"></i></a>答えの確定条件</h2>

<p>ルールをもう一度確認します。プレイヤーには、自分以外のカードが見えており、自分の手番が回ってきたとき、自分のカードを予想します。このとき、嘘を言ってはいけません。</p>

<p>宣言内容は以下のとおりです。</p>

<ul>
<li>自分が1番小さい「<code>MIN</code>」</li>
<li>自分が1番大きい「<code>MAX</code>」</li>
<li>自分は最大と最小以外である「<code>MID</code>」</li>
<li>分からない「<code>?</code>」</li>
</ul>

<p>話を簡単にするため、カードを <code>{ 1, 2, 3, 4, 5 }</code> 、プレイヤーを <code>{ A, B, C }</code> とします。</p>

<p>プレイヤー <code>B</code> の答えが確定するのはどのようなときでしょうか。</p>

<ul>
<li>「<code>MIN</code>」は、他プレイヤー（<code>A</code>、<code>C</code>）が大きい数字に隙間なく固まっている（<code>5</code>、<code>4</code>）とき。</li>
<li>「<code>MAX</code>」は、他プレイヤー（<code>A</code>、<code>C</code>）が小さい数字に隙間なく固まっている（<code>1</code>、<code>2</code>）とき。</li>
<li>「<code>MID</code>」は、他プレイヤー（<code>A</code>、<code>C</code>）が小さい数字と大きい数字に固まっている（<code>1</code>、<code>5</code>）とき。</li>
</ul>

<p>では、<code>A=2, C=5</code> のときはどうでしょうか。これは、「<code>MIN</code>」の可能性と「<code>MID</code>」の可能性がありますので、分からない「<code>?</code>」と答えます。</p>

<p>本当にそうでしょうか。</p>

<p><code>B</code> の手番が回ってくる直前、<code>A</code> は「<code>?</code>」と答えました。もし <code>B=1</code> だったら、<code>A</code> から見て <code>B=1, C=5</code> なので、<code>A</code> は「<code>MID</code>」と答えたはずです。そうならなかったということは、<code>B=1</code> はありえません。</p>

<p>ありえないカードを <code>X</code> で表すと、現在の状態は <code>X=1, A=2, C=5</code> です。これで <code>B</code> の答えは「<code>MID</code>」に確定しました。</p>

<p>このとき答えを確定できたのは、ありえないカードである <code>X</code> の存在があったからです。可能性のあるカードから、ありえないカードを除外してゆくことが、アルゴリズムの要となります。</p>

<p>話を戻しまして、答えが確定する条件を以下のように決めます。</p>

<ul>
<li>「<code>MIN</code>」は、可能性のあるカードが、他プレイヤーのどのカードよりも小さいとき。</li>
<li>「<code>MAX</code>」は、可能性のあるカードが、他プレイヤーのどのカードよりも大きいとき。</li>
<li>「<code>MID</code>」は、可能性のあるカードの最小値が他プレイヤーのカードの最小値よりも大きく、可能性のあるカードの最大値が他プレイヤーのカードの最大値よりも小さいとき。</li>
<li>「<code>?</code>」は、上記以外のとき。</li>
</ul>

<h2>
<span id="推論テーブルの表記" class="fragment"></span><a href="#%E6%8E%A8%E8%AB%96%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E8%A1%A8%E8%A8%98"><i class="fa fa-link"></i></a>推論テーブルの表記</h2>

<p>以下、カードとプレイヤーの対応を、次のように表記します。</p>

<ul>
<li>他プレイヤーのかかげている（<code>Visible</code>）カード「<code>A</code>、<code>B</code>、<code>C</code>、...」（プレイヤー名）</li>
<li>自分のカードである可能性のある（<code>Possible</code>）カード「<code>O</code>」</li>
<li>自分のカードである可能性のない（<code>Impossible</code>）カード「<code>X</code>」</li>
</ul>

<p>以上の記号をこのように表記します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>B
[ 1:X, 2:A, 3:O, 4:O, 5:C ]
</code></pre></div></div>

<p>ここで、<code>B</code> は推論対象プレイヤーです。</p>

<p>この表記を「推論テーブル」と呼ぶことにします。</p>

<h2>
<span id="推論の多重化" class="fragment"></span><a href="#%E6%8E%A8%E8%AB%96%E3%81%AE%E5%A4%9A%E9%87%8D%E5%8C%96"><i class="fa fa-link"></i></a>推論の多重化</h2>

<p>この節では、カードを <code>{ 1, 2, 3, 4, 5, 6, 7 }</code> 、プレイヤーを <code>{ A, B, C }</code> とします。<code>A=3, B=4, C=5</code> のとき、<code>C</code> がどのように推論するのか考えてみましょう。</p>

<p>前述の推論テーブルの表記を用いると、プレイヤー <code>C</code> の推論の初期状態は以下のようになります。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C
[ 1:O, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<h3>
<span id="推論対象プレイヤー-c" class="fragment"></span><a href="#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-c"><i class="fa fa-link"></i></a>推論対象プレイヤー <code>C</code>
</h3>

<p>ここでは、1 つ前の手番である <code>B</code> に着目することにします。<code>B</code> のカードは <code>4</code> です。覚えておきましょう。</p>

<p><code>Possible</code> であるカードを推論の対象とします。<code>Possible</code> であるカードは <code>1</code>、<code>2</code>、<code>5</code>、<code>6</code>、<code>7</code> ですが、ここでは <code>1</code> と <code>2</code> だけに注目してみましょう。推論対象プレイヤー <code>C</code> のカードは <code>1</code> である、もしくは <code>2</code> である、と考えるのです。</p>

<p>ここでは、<code>1</code> を選択してみましょう。<code>C</code> のカードは <code>1</code> である、と仮定します。すると、推論テーブルはいかのようになります。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C
[ 1:C, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>この推論テーブルは、まだ答えの確定条件を満たしていません。次の推論に進みます。<code>B</code> の推論について想像してみましょう。</p>

<h3>
<span id="推論対象プレイヤー-bc-の想像" class="fragment"></span><a href="#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-bc-%E3%81%AE%E6%83%B3%E5%83%8F"><i class="fa fa-link"></i></a>推論対象プレイヤー <code>B</code>（<code>C</code> の想像）</h3>

<p>プレイヤー <code>C</code> が想像する、プレイヤー <code>B</code> の推論テーブルはどうなっているでしょうか。</p>

<p>今、<code>C</code> のカードは <code>1</code> であると仮定しています。そして、<code>B</code> からは <code>B</code> 自身のカードは見えません。推論テーブルは以下のようになります。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C -&gt; B
[ 1:C, 2:O, 3:A, 4:O, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>ここで、<code>C -&gt; B</code> とは <code>C</code> の想像する <code>B</code> の推論テーブルである、という意味です。</p>

<p>先程 <code>C</code> で行なったプロセスを再度やってみましょう。前の手番のプレイヤーは <code>A=3</code> です。<code>Possible</code> なのは <code>2</code>、<code>4</code>、<code>5</code>、<code>6</code>、<code>7</code> ですが、ここでは <code>2</code> に着目します。<code>B</code> のカードは <code>2</code> であると仮定してみましょう。推論テーブルはこうです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C -&gt; B
[ 1:C, 2:B, 3:A, 4:O, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>今度は、答えの確定条件を満たしています。それは「誰の」確定条件かというと、<code>A</code> ですね。この推論テーブルは <code>B</code> のものなので、前の手番のプレイヤーである <code>A</code> の推論に移ります。</p>

<h3>
<span id="推論対象プレイヤー-ac-の-想像の-b-の想像" class="fragment"></span><a href="#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-ac-%E3%81%AE-%E6%83%B3%E5%83%8F%E3%81%AE-b-%E3%81%AE%E6%83%B3%E5%83%8F"><i class="fa fa-link"></i></a>推論対象プレイヤー <code>A</code>（<code>C</code> の 想像の <code>B</code> の想像）</h3>

<p>そろそろ、ややこしくなってきたと思いませんか。私は思います。こんな難しい問題（しかし解ける）、よく考えつくなーと感心しきりです。</p>

<p>今回考えるのは、「「<code>C</code> の想像する <code>B</code>」の想像する <code>A</code>」の推論テーブルです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C -&gt; B -&gt; A
[ 1:C, 2:B, 3:O, 4:O, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>この条件であれば、答えの確定条件を満たしています。<code>A=&gt;MAX</code> ですね。</p>

<p>しかし、思い出してみてください。そもそも、この節で議論を始めたときの前提は <code>A=3, B=4, C=5</code> でした。<code>A</code> は「<code>MAX</code>」ではありませんし、<code>A</code> 自身、それを分かっています。ですから、<code>A</code> は最初の手番で「<code>?</code>」と答えます。</p>

<p>推論テーブルの推論が崩れました。仮定が間違っていたのです。前の推論に戻る必要があります。1 つ前の推論はこうです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C -&gt; B
[ 1:C, 2:B, 3:A, 4:O, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>ここでの仮定 <code>2:B</code> が間違っていたのですね。ですから、正しい推論テーブルはこのようになります。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C -&gt; B
[ 1:C, 2:X, 3:A, 4:O, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>すると、この推論テーブルは確定条件を満たしています。<code>B=&gt;MAX</code> です。</p>

<p>しかし、ここでも推論は正しくありません。前提は <code>A=3, B=4, C=5</code> でした。<code>B</code> は手番で答えられず、「<code>?</code>」と宣言します。</p>

<p>仮定が崩れました。前に戻りましょう。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C
[ 1:C, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>この <code>1:C</code> が間違っていたことになります。正しい推論テーブルはこうです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C
[ 1:X, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>これで最初に戻ってきました。</p>

<p>やってみると分かるのですが、これも <code>B</code> が「<code>?</code>」と答えた時点で、<code>2:X</code> となります。ですから、<code>C</code> の手番が回ってきた時点での推論テーブルは以下のようになっています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>C
[ 1:X, 2:X, 3:A, 4:B, 5:O, 6:O, 7:O ]
</code></pre></div></div>

<p>これは、確定条件を満たしています。今度こそ、<code>C</code> は「<code>MAX</code>」と答えることが可能になります。</p>

<p>ということで、答えは「<code>A=&gt;?, B=&gt;?, C=&gt;MAX</code>」でした。</p>

<h2>
<span id="再帰呼び出しによる実装" class="fragment"></span><a href="#%E5%86%8D%E5%B8%B0%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%81%AB%E3%82%88%E3%82%8B%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>再帰呼び出しによる実装</h2>

<p>前節の考え方をすると、最初の状態から次の推論へと移ってゆく際に分岐が発生するため、データ構造としては木構造を形成します。本記事の投稿当初の方法では、推論テーブルを持つノードを木構造の形で保持する、という愚直な実装でした。しかし、<a href="/sumim" class="user-mention js-hovercard" title="sumim" data-hovercard-target-type="user" data-hovercard-target-name="sumim">@sumim</a> 氏が示した再帰呼び出しによる方法が、よりスマートでした（木構造を構築する方法では、結局正答に至らず）。</p>

<p>アルゴリズムのコア部分となるメソッドを掲載します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 現在の順番に基づき、答えを導出する</span>
<span class="c1">// orderIndex: _PlayerOrder上における現在の順番</span>
<span class="c1">// return    : 答え</span>
<span class="k">public</span> <span class="n">PlayerAnswer</span> <span class="nf">Infer</span><span class="p">(</span><span class="kt">int</span> <span class="n">orderIndex</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nf">_Infer</span><span class="p">(</span><span class="n">_PlayerName</span><span class="p">,</span> <span class="n">_VisibleCards</span><span class="p">,</span> <span class="n">orderIndex</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 答えを導出する</span>
<span class="c1">// targetPlayerName: 推論対象のプレイヤーの名前</span>
<span class="c1">// visibleCards    : プレイヤーに見えているカード列</span>
<span class="c1">// orderIndex      : _PlayerOrder上における現在の順番</span>
<span class="c1">// return          : 答え</span>
<span class="k">public</span> <span class="n">PlayerAnswer</span> <span class="nf">_Infer</span><span class="p">(</span><span class="kt">string</span> <span class="n">targetPlayerName</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">_VisibleCard</span><span class="p">&gt;</span> <span class="n">visibleCards</span><span class="p">,</span> <span class="kt">int</span> <span class="n">limit</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">memoKey</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">_MemoKey</span><span class="p">(</span><span class="n">targetPlayerName</span><span class="p">,</span> <span class="n">visibleCards</span><span class="p">,</span> <span class="n">limit</span><span class="p">);</span>

    <span class="c1">// メモより取得</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">_Memo</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="n">memoKey</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">_Memo</span><span class="p">[</span><span class="n">memoKey</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1">// 自分のカードである可能性のあるカード列（あとで削除するためリストにする）</span>
    <span class="kt">var</span> <span class="n">possibleCardList</span> <span class="p">=</span> <span class="n">_AllCards</span><span class="p">.</span><span class="nf">Except</span><span class="p">(</span><span class="n">visibleCards</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Card</span><span class="p">))</span>
                                    <span class="p">.</span><span class="nf">ToList</span><span class="p">();</span>

    <span class="kt">var</span> <span class="n">playerNames</span> <span class="p">=</span> <span class="n">_Order</span><span class="p">.</span><span class="nf">GetPlayerNames</span><span class="p">().</span><span class="nf">Select</span><span class="p">((</span><span class="n">playerName</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">playerName</span><span class="p">,</span> <span class="n">index</span><span class="p">));</span>

    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="p">(</span><span class="n">playerName</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="k">in</span> <span class="n">playerNames</span><span class="p">.</span><span class="nf">Take</span><span class="p">(</span><span class="n">limit</span> <span class="p">+</span> <span class="m">1</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="c1">// 前の手番が存在するなら</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">&gt;=</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">prevIndex</span> <span class="p">=</span> <span class="n">index</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">prevPlayerName</span> <span class="p">=</span> <span class="n">_Order</span><span class="p">.</span><span class="nf">GetPlayerNames</span><span class="p">().</span><span class="nf">ElementAt</span><span class="p">(</span><span class="n">prevIndex</span><span class="p">);</span>

            <span class="c1">// possibleCardListのクローンでループ</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">p</span> <span class="k">in</span> <span class="n">possibleCardList</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="c1">// 前の手番を仮定する</span>
                <span class="kt">var</span> <span class="n">candidates</span> <span class="p">=</span> <span class="n">visibleCards</span><span class="p">.</span><span class="nf">Concat</span><span class="p">(</span><span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="k">new</span> <span class="nf">_VisibleCard</span><span class="p">(</span><span class="n">targetPlayerName</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="p">})</span>
                                             <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">PlayerName</span> <span class="p">!=</span> <span class="n">prevPlayerName</span><span class="p">)</span>
                                             <span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">PlayerName</span><span class="p">)</span>
                                             <span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>

                <span class="c1">// 仮定を元に答えを導出する</span>
                <span class="kt">var</span> <span class="n">inferred</span> <span class="p">=</span> <span class="nf">_Infer</span><span class="p">(</span><span class="n">prevPlayerName</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="n">prevIndex</span><span class="p">);</span>

                <span class="c1">// 答えの食い違い</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">inferred</span><span class="p">.</span><span class="n">Value</span> <span class="p">!=</span> <span class="n">AnswerValue</span><span class="p">.</span><span class="n">Unknown</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">possibleCardList</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">var</span> <span class="n">answer</span> <span class="p">=</span> <span class="nf">_GetAnswer</span><span class="p">(</span><span class="n">targetPlayerName</span><span class="p">,</span> <span class="n">possibleCardList</span><span class="p">,</span> <span class="n">visibleCards</span><span class="p">);</span>
    <span class="n">_Memo</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">memoKey</span><span class="p">,</span> <span class="n">answer</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">answer</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>処理の流れはコメントの通りです。</p>

<p>計算量が多いため、メモ化により高速化を図っています。</p>

<h1>
<span id="出力例" class="fragment"></span><a href="#%E5%87%BA%E5%8A%9B%E4%BE%8B"><i class="fa fa-link"></i></a>出力例</h1>

<p>最後に、カード <code>5</code> 枚、プレイヤー <code>3</code> 人の場合の出力例をお見せします。</p>

<p>順列の生成は <code>IndianPoker.Lib.Utils</code> に含まれています。また、各行の最後に付加された <code>OK</code> ですが、これはデバッグのため、宣言された答えが配られたカードと比較して正しいかどうかを出力したものです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>&lt;A=1, B=2, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MAX : OK
&lt;A=1, B=2, C=4&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=1, B=2, C=5&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=1, B=3, C=2&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=1, B=3, C=4&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=1, B=3, C=5&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=1, B=4, C=2&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=1, B=4, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=1, B=4, C=5&gt; A=&gt;MIN : OK
&lt;A=1, B=5, C=2&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=1, B=5, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=1, B=5, C=4&gt; A=&gt;MIN : OK
&lt;A=2, B=1, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MAX : OK
&lt;A=2, B=1, C=4&gt; A=&gt;?, B=&gt;?, C=&gt;MAX : OK
&lt;A=2, B=1, C=5&gt; A=&gt;MID : OK
&lt;A=2, B=3, C=1&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=2, B=3, C=4&gt; A=&gt;?, B=&gt;?, C=&gt;MAX : OK
&lt;A=2, B=3, C=5&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=2, B=4, C=1&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=2, B=4, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=2, B=4, C=5&gt; A=&gt;MIN : OK
&lt;A=2, B=5, C=1&gt; A=&gt;MID : OK
&lt;A=2, B=5, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=2, B=5, C=4&gt; A=&gt;MIN : OK
&lt;A=3, B=1, C=2&gt; A=&gt;MAX : OK
&lt;A=3, B=1, C=4&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=3, B=1, C=5&gt; A=&gt;MID : OK
&lt;A=3, B=2, C=1&gt; A=&gt;MAX : OK
&lt;A=3, B=2, C=4&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=3, B=2, C=5&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=3, B=4, C=1&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=3, B=4, C=2&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=3, B=4, C=5&gt; A=&gt;MIN : OK
&lt;A=3, B=5, C=1&gt; A=&gt;MID : OK
&lt;A=3, B=5, C=2&gt; A=&gt;?, B=&gt;MAX : OK
&lt;A=3, B=5, C=4&gt; A=&gt;MIN : OK
&lt;A=4, B=1, C=2&gt; A=&gt;MAX : OK
&lt;A=4, B=1, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=4, B=1, C=5&gt; A=&gt;MID : OK
&lt;A=4, B=2, C=1&gt; A=&gt;MAX : OK
&lt;A=4, B=2, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=4, B=2, C=5&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=4, B=3, C=1&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=4, B=3, C=2&gt; A=&gt;?, B=&gt;?, C=&gt;MIN : OK
&lt;A=4, B=3, C=5&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=4, B=5, C=1&gt; A=&gt;MID : OK
&lt;A=4, B=5, C=2&gt; A=&gt;?, B=&gt;?, C=&gt;MIN : OK
&lt;A=4, B=5, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MIN : OK
&lt;A=5, B=1, C=2&gt; A=&gt;MAX : OK
&lt;A=5, B=1, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=5, B=1, C=4&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=5, B=2, C=1&gt; A=&gt;MAX : OK
&lt;A=5, B=2, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MID : OK
&lt;A=5, B=2, C=4&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=5, B=3, C=1&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=5, B=3, C=2&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=5, B=3, C=4&gt; A=&gt;?, B=&gt;MIN : OK
&lt;A=5, B=4, C=1&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=5, B=4, C=2&gt; A=&gt;?, B=&gt;MID : OK
&lt;A=5, B=4, C=3&gt; A=&gt;?, B=&gt;?, C=&gt;MIN : OK
</code></pre></div></div>

<h1>
<span id="考察" class="fragment"></span><a href="#%E8%80%83%E5%AF%9F"><i class="fa fa-link"></i></a>考察</h1>

<p>コメント欄で議論となりましたが、答えが出るまでのターン数は結局求まりませんでした。<code>Impossible</code> の条件が複雑で追いきれませんでした。</p>

<p>実装したプログラムでは、前述の通りのやり方で必ず収束するため、ターン数は不要となりました。</p>

<h1>
<span id="課題" class="fragment"></span><a href="#%E8%AA%B2%E9%A1%8C"><i class="fa fa-link"></i></a>課題</h1>

<p>計算量が膨大なため、実行時間がかかります。</p>

<p>本物のインディアン・ポーカーはカード数 <code>53</code> 枚ですが、プレイヤー数 <code>2</code> のときは答えを導けるものの、それ以上の人数では <code>53</code> 枚に対応することはできませんでした。</p>

<p>LINQ を多用しているため、元々速度は最適化されていませんが、計算量のオーダー自体に問題があると思います。</p>

<h1>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p>オブジェクト指向は大変難しいです。特に、このような難解な問題を解こうとする場合、答えが分かっていないと、確固たる設計をするのは不可能です。</p>

<p>しかし、オブジェクト指向はまた、このようなケースに対してアルゴリズム部分をブラックボックス化する力も持っています。ですから、最初に設計を決めることは可能で、しかし作り込んでゆくうちに設計が変化してゆく場合がほとんどだと思います。</p>

<p>よく、コードを書かない SE の存在を耳にしますが、コードを書かずに設計なんてできないというのが私の考えです。</p>

<p>コードを書いてオブジェクト指向力を磨きましょう。私も精進します。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fhiki_neet_p%2Fitems%2Fd4624635d8baedba44c9&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fhiki_neet_p%2Fitems%2Fd4624635d8baedba44c9&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/hiki_neet_p/items/d4624635d8baedba44c9/likers" class="css-1iupg5d">34</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">38</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/d4624635d8baedba44c9/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/hiki_neet_p/items/d4624635d8baedba44c9/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/hiki_neet_p/items/d4624635d8baedba44c9/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/hiki_neet_p/items/d4624635d8baedba44c9/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/hiki_neet_p/items/d4624635d8baedba44c9.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-a54adced-7bc2-40aa-bade-53c813771a9c">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-d52e6d6d-7f5f-417e-8004-1db36762798b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-d52e6d6d-7f5f-417e-8004-1db36762798b">{}</script>
      
<div id="LoginModal-react-component-0a063e23-12c7-47af-946c-589d3d8a2843"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-0a063e23-12c7-47af-946c-589d3d8a2843">{}</script>
      
<div id="StockModal-react-component-5e9c9062-f89a-446e-8f7c-868ab0131a90"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-5e9c9062-f89a-446e-8f7c-868ab0131a90">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;m9PMTcCvjwmzfipjwb6Bqr5aFg91LYSK9kzUE9fPeS9JJOpA2hMEBdV8Wb2Kfptv7J3SOt5kl39JYSqY2BFaWw==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003cstrong\u003e2018/10/10追記\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e記事を大きく修正しました。\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e変更箇所は、お手数ですが「編集履歴」を参照してください。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"謝辞\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AC%9D%E8%BE%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e謝辞\u003c/h1\u003e\n\n\u003cp\u003e本記事の答えに辿り着くまでに、色々な方にご指摘をいただき、大変助かりました（コメント欄をご覧ください）。\u003c/p\u003e\n\n\u003cp\u003e特に \u003ca href=\"/sumim\" class=\"user-mention js-hovercard\" title=\"sumim\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"sumim\"\u003e@sumim\u003c/a\u003e 氏には、問題と解答を提供していただきましたが、これがなければ本記事を仕上げることは叶いませんでした。深く感謝いたします。\u003c/p\u003e\n\n\u003cp\u003e試行錯誤する中で、私にとって勉強になることは多く、良い経験になりました。ありがとうございました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e本記事は、\u003ca href=\"/sumim\" class=\"user-mention js-hovercard\" title=\"sumim\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"sumim\"\u003e@sumim\u003c/a\u003e 氏が改変して紹介した\u003cstrong\u003eインディアン・ポーカーに関するプログラミング問題\u003c/strong\u003eの解法を説明しながら、\u003cstrong\u003eオブジェクト指向プログラミング\u003c/strong\u003eに触れてみるものです。\u003c/p\u003e\n\n\u003cp\u003e私がこの問題を目にしたのは、\u003ca href=\"/gorillab\" class=\"user-mention js-hovercard\" title=\"gorillab\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"gorillab\"\u003e@gorillab\u003c/a\u003e 氏による以下の記事を読んだときでした。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/gorillab/items/b2f8e39d7cc23ad505f9\" id=\"reference-8dd1cfa4f82379619de6\"\u003eオブジェクト指向が5000%理解できる記事\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/gorillab/items/fab2a6637f681221f687\" id=\"reference-657ac2e7f197ce4a345c\"\u003eオブジェクト指向が5000%理解できる記事(実践編)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e両記事は大きな反響を生んだため、ご存知の方も多いと思います。この「実践編」にて、インディアン・ポーカー問題が取り上げられていました。\u003c/p\u003e\n\n\u003cp\u003eこの問題は非情に難しく、また奥が深い問題です。しかし、上記事では大変雑に取り上げられていました。オブジェクト指向の初心者向け解説記事を謳いながら、実質的に何の解決にもならない曖昧な説明で終わっています。\u003c/p\u003e\n\n\u003cp\u003e対照的に、コメント欄は盛り上がりました。問題の紹介者である \u003ca href=\"/sumim\" class=\"user-mention js-hovercard\" title=\"sumim\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"sumim\"\u003e@sumim\u003c/a\u003e 氏が登場し、解法を示してくださいました。しかし、そこで示された解法が不完全であることに気がついたので、私なりにこの問題を解き、本記事を書こうと思いました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"インディアンポーカー問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%82%A2%E3%83%B3%E3%83%9D%E3%83%BC%E3%82%AB%E3%83%BC%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eインディアン・ポーカー問題\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"解決対象となる問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E6%B1%BA%E5%AF%BE%E8%B1%A1%E3%81%A8%E3%81%AA%E3%82%8B%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解決対象となる問題\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.rco.recruit.co.jp/career/engineer/entry/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eリクルートコミュニケーションズのコーディング試験\u003c/a\u003eで過去に出題された問題を、\u003ca href=\"https://twitter.com/sumim\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@sumim\u003c/a\u003e 氏が改変したものです。\u003c/p\u003e\n\n\u003cp\u003e問題はこちら → \u003ca href=\"https://twitter.com/sumim/status/1043665621433470977\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://twitter.com/sumim/status/1043665621433470977\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"問題の要点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%95%8F%E9%A1%8C%E3%81%AE%E8%A6%81%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e問題の要点\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eこの問題におけるインディアン・ポーカー\n\n\u003cul\u003e\n\u003cli\u003e2人以上のプレイヤーで行なう。\u003c/li\u003e\n\u003cli\u003e数字の書かれたカードを用意する（カード数はプレイヤー数以上）。\u003c/li\u003e\n\u003cli\u003eプレイヤーにカードを配るが、各プレイヤーは自分のカードの数字を見てはいけない。\u003c/li\u003e\n\u003cli\u003e各プレイヤーはカードを額にかざす。カード数字は自分を除く他プレイヤーに見える状態となる。\u003c/li\u003e\n\u003cli\u003eこの状態で、各プレイヤーは順番に、自分のカードの数字を予想し、宣言してゆく。\u003c/li\u003e\n\u003cli\u003e宣言の内容は4種類。\n\n\u003cul\u003e\n\u003cli\u003e自分が1番小さい「\u003ccode\u003eMIN\u003c/code\u003e」\u003c/li\u003e\n\u003cli\u003e自分が1番大きい「\u003ccode\u003eMAX\u003c/code\u003e」\u003c/li\u003e\n\u003cli\u003e自分は最大と最小以外である「\u003ccode\u003eMID\u003c/code\u003e」\u003c/li\u003e\n\u003cli\u003e分からない「\u003ccode\u003e?\u003c/code\u003e」\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e1人でも答えが分かったらゲーム終了。\u003c/li\u003e\n\u003cli\u003eプレイヤーは嘘をつかず、最善を尽くす。\u003c/li\u003e\n\u003cli\u003e\n\u003cdel\u003e無限ループになる可能性がある。\u003c/del\u003e \u003cstrong\u003e無限ループは発生せず、答えは必ず求まることが分かりました。\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e例\u003c/h3\u003e\n\n\u003cp\u003eカード \u003ccode\u003e{ 1, 2, 3, 4, 5 }\u003c/code\u003e\u003cbr\u003e\nプレイヤー \u003ccode\u003e{ A, B, C }\u003c/code\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eA=1, B=4, C=5\u003c/code\u003e の場合\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eA=\u0026gt;MIN\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eA=1, B=2, C=4\u003c/code\u003e の場合\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eA=\u0026gt;?, B=\u0026gt;MID\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"問題の解答\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%95%8F%E9%A1%8C%E3%81%AE%E8%A7%A3%E7%AD%94\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e問題の解答\u003c/h1\u003e\n\n\u003cp\u003eこちらです↓\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/tana-gh/indian_poker\" rel=\"nofollow noopener\" target=\"_blank\"\u003eインディアン・ポーカー・ソルバー\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e.NET Core 2.1、C#7.3 です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"動かし方\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E3%81%8B%E3%81%97%E6%96%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e動かし方\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003egit clone git@github.com:tana-gh/indian_poker.git\ncd indian_poker\ndotnet run -p IndianPoker.App.Multiple/IndianPoker.App.Multiple.csproj -- 5 3\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e上記 \u003ccode\u003e5 3\u003c/code\u003e の部分には、それぞれ\u003cstrong\u003eカード枚数\u003c/strong\u003e、\u003cstrong\u003eプレイヤー人数\u003c/strong\u003eを指定してください。\u003cbr\u003e\u003cbr\u003e\n（大きな数を指定すると計算時間がかかる場合があります）\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003edotnet run -p IndianPoker.App.Multiple/IndianPoker.App.Multiple.csproj -- \u0026lt;カード枚数\u0026gt; \u0026lt;プレイヤー人数\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e配るカードを指定する場合はこちらです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003edotnet run -p IndianPoker.App.Single/IndianPoker.App.Single.csproj -- \u0026lt;カード枚数\u0026gt; \u0026lt;プレイヤー人数\u0026gt; \u0026lt;カード1\u0026gt; \u0026lt;カード2\u0026gt; ...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コードの概要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%A6%82%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコードの概要\u003c/h1\u003e\n\n\u003cp\u003e私の書いたコードは 5 つのプロジェクトに分割されています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eIndianPoker.App.Multiple // 実行プログラム（複数ケースを出力）\nIndianPoker.App.Single   // 実行プログラム（単一ケースを出力）\nIndianPoker.Lib          // 今回のソルバーを含む\nIndianPoker.Lib.Utils    // ユーティリティ\nIndianPoker.Test         // テスト\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのうち、\u003ccode\u003eIndianPoker.Lib\u003c/code\u003e だけが重要なので、以下ではこのプロジェクトについて説明します。クラスをどのように分けるかというのは、一種のパズルです。各クラスがどのような意図を持つのか、想像しながら見ていただけると嬉しいです。\u003c/p\u003e\n\n\u003cp\u003e※ 私のコードの書き方で、アクセス修飾子が \u003ccode\u003einternal\u003c/code\u003e または \u003ccode\u003eprivate\u003c/code\u003e のシンボルに \u003ccode\u003e_\u003c/code\u003e アンダースコアのプレフィックスをつけています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クラス構成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E6%A7%8B%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクラス構成\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eIndianPoker.Lib\n\npublic class Solver          // ゲームを進行し、結果を生成\npublic struct PlayerAnswer   // プレイヤーの答え\npublic enum AnswerValue      // 答えの内容\ninternal class _Card         // カード\ninternal class _Deck         // カードのデッキ\ninternal class _Player       // プレイヤー\ninternal struct _VisibleCard // 見えているカード\ninternal class _Inference    // 推論に関する情報\ninternal class _PlayerOrder  // 手番の順序\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クラス図\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E5%9B%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクラス図\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/9df4b1d19208052924e6ee58f779cbea37d60a79/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35333636382f39623739653635342d666663392d383739322d653834372d6662666431383538663466322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F53668%2F9b79e654-ffc9-8792-e847-fbfd1858f4f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5302ff480069f441901b1f7f75930bf9\" alt=\"classes.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/53668/9b79e654-ffc9-8792-e847-fbfd1858f4f2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F53668%2F9b79e654-ffc9-8792-e847-fbfd1858f4f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c60a8a7e738151d60a4390eac5364cfe 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"solver\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#solver\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eSolver\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// ゲームを進行し、結果を生成\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSolver\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 参加プレイヤーと所持カード\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecardNumber\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eNameAndNumbers\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// allNumbers : 全カードの数字列\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// deckNumbers: プレイヤーのドローするカードの数字列（与えられた順）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// playerNames: プレイヤーの名前列（与えられた順）\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eSolver\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eallNumbers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edeckNumbers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerNames\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// ゲームを進行し、結果を生成する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// return: 答え列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ePlayerAnswer\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eSolve\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eゲームの進行を担います。\u003c/p\u003e\n\n\u003cp\u003e最初にコンストラクタで、全てのカードに書かれた数字、プレイヤーに配られるカードの数字、全てのプレイヤーの名前、を受け取ります。その情報をもとに、まず \u003ccode\u003e_Deck\u003c/code\u003e を生成します。\u003ccode\u003e_Deck\u003c/code\u003e は \u003ccode\u003e_Card\u003c/code\u003e を生成し、その \u003ccode\u003e_Card\u003c/code\u003e を \u003ccode\u003e_Player\u003c/code\u003e コンストラクタに渡します。このとき渡す \u003ccode\u003e_Card\u003c/code\u003e は、他の \u003ccode\u003e_Player\u003c/code\u003e が掲げているカードです（このゲームでは、自分のカードを見てはいけない）。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eSolve\u003c/code\u003e メソッドでゲームをシミュレートし、ゲーム中にプレイヤー達が宣言した答えを返します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"playeranswer\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#playeranswer\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003ePlayerAnswer\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// プレイヤーの答え\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003ePlayerAnswer\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 答えを宣言したプレイヤーの名前（nullable）\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ePlayerName\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 答えの内容\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eAnswerValue\u003c/span\u003e \u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// playerName: 答えを宣言したプレイヤーの名前（nullable）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// value: 答えの内容\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003ePlayerAnswer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAnswerValue\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eプレイヤーの名前と、プレイヤーが宣言した答えです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"answervalue\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#answervalue\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eAnswerValue\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 答えの内容\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eenum\u003c/span\u003e \u003cspan class=\"n\"\u003eAnswerValue\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnknown\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ?   に相当\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMin\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e     \u003cspan class=\"c1\"\u003e// MIN に相当\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e     \u003cspan class=\"c1\"\u003e// MID に相当\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMax\u003c/span\u003e      \u003cspan class=\"c1\"\u003e// MAX に相当\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e答えの内容です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"_card\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_card\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003e_Card\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003e_Card\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// カードに書かれた数字\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eNumber\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// number: カードに書かれた数字\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003e_Card\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enumber\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eカードです。カードに書かれた数字を取得できます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"_deck\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_deck\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003e_Deck\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// カードのデッキ\u003c/span\u003e\n\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003e_Deck\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// プレイヤーがドローするカード列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_Card\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDeckCards\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// ソート済みの全カード\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_Card\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eSortedCards\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// allNumber  : 全カードの数字列\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// deckNumbers: プレイヤーがドローするカードの数字列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003e_Deck\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eallNumbers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edeckNumbers\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eデッキです。\u003ccode\u003eDeckCards\u003c/code\u003e は、プレイヤーに配られるカードがプレイヤー順に格納されています。対して \u003ccode\u003eSortedCards\u003c/code\u003e は、全てのカードが昇順に格納されています。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eDeckCards\u003c/code\u003e と \u003ccode\u003eSortedCards\u003c/code\u003e で共通の数字を持つカードは、同一のインスタンスです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"_player\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_player\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003e_Player\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003e_Player\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// プレイヤーの名前\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 推論に関する情報\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003e_Inference\u003c/span\u003e \u003cspan class=\"n\"\u003e_Inference\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// name: プレイヤーの名前\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// visibleCards: 他プレイヤーのカード\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// allCards    : 全カード\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// order       : 手番の順序\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003e_Player\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_VisibleCard\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_Card\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eallCards\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_PlayerOrder\u003c/span\u003e \u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 答えを宣言する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// orderIndex: _PlayerOrder上における現在の順番\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003ePlayerAnswer\u003c/span\u003e \u003cspan class=\"nf\"\u003eSayAnswer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eorderIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eプレイヤーです。推論に関する情報である \u003ccode\u003e_Inference\u003c/code\u003e を内部に持っています。\u003cbr\u003e\n\u003ccode\u003eSayAnswer\u003c/code\u003e で、自分の答えを宣言します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"_visiblecard\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_visiblecard\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003e_VisibleCard\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 見えているカード\u003c/span\u003e\n\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003e_VisibleCard\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// カードを所持するプレイヤーの名前\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ePlayerName\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 見えているカード\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003e_Card\u003c/span\u003e \u003cspan class=\"n\"\u003eCard\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// playerName: カードを所持するプレイヤーの名前\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// card: 見えているカード\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003e_VisibleCard\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_Card\u003c/span\u003e \u003cspan class=\"n\"\u003ecard\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eプレイヤーが額にかざしているカードです。プレイヤーの名前とカードがセットになっています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"_inference\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_inference\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003e_Inference\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 推論に関する情報\u003c/span\u003e\n\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003e_Inference\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 推論対象のプレイヤーの名前\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003e_PlayerName\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// プレイヤーに見えているカード列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_VisibleCard\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_VisibleCards\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 全カード列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_Card\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_AllCards\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 手番の順序\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003e_PlayerOrder\u003c/span\u003e \u003cspan class=\"n\"\u003e_Order\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// _Inferメソッドのメモ\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_MemoKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePlayerAnswer\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_Memo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// playerName  : 推論対象のプレイヤーの名前\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// visibleCards: プレイヤーに見えているカード列\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// allCards    : 全カード列\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// order       : 手番の順序\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003e_Inference\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_VisibleCard\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_Card\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eallCards\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_PlayerOrder\u003c/span\u003e \u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 現在の順番に基づき、答えを導出する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// orderIndex: _PlayerOrder上における現在の順番\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// return    : 答え\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003ePlayerAnswer\u003c/span\u003e \u003cspan class=\"nf\"\u003eInfer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eorderIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e今回のソルバーの推論に関わる、アルゴリズムをまとめたものです。\u003c/p\u003e\n\n\u003cp\u003e各プレイヤーがこの \u003ccode\u003e_Inference\u003c/code\u003e を 1 つずつ持ちます。自プレイヤーが持つ推論情報は、当然自分のカードを知らない状態にあります。与えられた他プレイヤーのカード情報をもとに、最善手で答えを導きます。\u003c/p\u003e\n\n\u003cp\u003e答えを導出する \u003ccode\u003eInfer\u003c/code\u003e メソッドは、\u003ccode\u003eorderIndex\u003c/code\u003e を受け取りますが、これは、プレイヤーの手番の順序列を生成する \u003ccode\u003e_PlayerOrder\u003c/code\u003e のインデックスです。\u003c/p\u003e\n\n\u003cp\u003e次章では、このクラスがどのようにインディアン・ポーカー問題を解決するのかを見ていきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"_playerorder\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_playerorder\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003e_PlayerOrder\u003c/code\u003e\n\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 手番の順序\u003c/span\u003e\n\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003e_PlayerOrder\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 全プレイヤーの名前列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_PlayerNames\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// playerNames: 全プレイヤーの名前列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003e_PlayerOrder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerNames\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 手番の順序を生成する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// return: 順序付けられたプレイヤーの名前列\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetPlayerNames\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eプレイヤーの手番の順序どおりに、プレイヤー名をイテレートする列挙子を生成します。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"アルゴリズム\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアルゴリズム\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"答えの確定条件\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88%E3%81%AE%E7%A2%BA%E5%AE%9A%E6%9D%A1%E4%BB%B6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答えの確定条件\u003c/h2\u003e\n\n\u003cp\u003eルールをもう一度確認します。プレイヤーには、自分以外のカードが見えており、自分の手番が回ってきたとき、自分のカードを予想します。このとき、嘘を言ってはいけません。\u003c/p\u003e\n\n\u003cp\u003e宣言内容は以下のとおりです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e自分が1番小さい「\u003ccode\u003eMIN\u003c/code\u003e」\u003c/li\u003e\n\u003cli\u003e自分が1番大きい「\u003ccode\u003eMAX\u003c/code\u003e」\u003c/li\u003e\n\u003cli\u003e自分は最大と最小以外である「\u003ccode\u003eMID\u003c/code\u003e」\u003c/li\u003e\n\u003cli\u003e分からない「\u003ccode\u003e?\u003c/code\u003e」\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e話を簡単にするため、カードを \u003ccode\u003e{ 1, 2, 3, 4, 5 }\u003c/code\u003e 、プレイヤーを \u003ccode\u003e{ A, B, C }\u003c/code\u003e とします。\u003c/p\u003e\n\n\u003cp\u003eプレイヤー \u003ccode\u003eB\u003c/code\u003e の答えが確定するのはどのようなときでしょうか。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e「\u003ccode\u003eMIN\u003c/code\u003e」は、他プレイヤー（\u003ccode\u003eA\u003c/code\u003e、\u003ccode\u003eC\u003c/code\u003e）が大きい数字に隙間なく固まっている（\u003ccode\u003e5\u003c/code\u003e、\u003ccode\u003e4\u003c/code\u003e）とき。\u003c/li\u003e\n\u003cli\u003e「\u003ccode\u003eMAX\u003c/code\u003e」は、他プレイヤー（\u003ccode\u003eA\u003c/code\u003e、\u003ccode\u003eC\u003c/code\u003e）が小さい数字に隙間なく固まっている（\u003ccode\u003e1\u003c/code\u003e、\u003ccode\u003e2\u003c/code\u003e）とき。\u003c/li\u003e\n\u003cli\u003e「\u003ccode\u003eMID\u003c/code\u003e」は、他プレイヤー（\u003ccode\u003eA\u003c/code\u003e、\u003ccode\u003eC\u003c/code\u003e）が小さい数字と大きい数字に固まっている（\u003ccode\u003e1\u003c/code\u003e、\u003ccode\u003e5\u003c/code\u003e）とき。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eでは、\u003ccode\u003eA=2, C=5\u003c/code\u003e のときはどうでしょうか。これは、「\u003ccode\u003eMIN\u003c/code\u003e」の可能性と「\u003ccode\u003eMID\u003c/code\u003e」の可能性がありますので、分からない「\u003ccode\u003e?\u003c/code\u003e」と答えます。\u003c/p\u003e\n\n\u003cp\u003e本当にそうでしょうか。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eB\u003c/code\u003e の手番が回ってくる直前、\u003ccode\u003eA\u003c/code\u003e は「\u003ccode\u003e?\u003c/code\u003e」と答えました。もし \u003ccode\u003eB=1\u003c/code\u003e だったら、\u003ccode\u003eA\u003c/code\u003e から見て \u003ccode\u003eB=1, C=5\u003c/code\u003e なので、\u003ccode\u003eA\u003c/code\u003e は「\u003ccode\u003eMID\u003c/code\u003e」と答えたはずです。そうならなかったということは、\u003ccode\u003eB=1\u003c/code\u003e はありえません。\u003c/p\u003e\n\n\u003cp\u003eありえないカードを \u003ccode\u003eX\u003c/code\u003e で表すと、現在の状態は \u003ccode\u003eX=1, A=2, C=5\u003c/code\u003e です。これで \u003ccode\u003eB\u003c/code\u003e の答えは「\u003ccode\u003eMID\u003c/code\u003e」に確定しました。\u003c/p\u003e\n\n\u003cp\u003eこのとき答えを確定できたのは、ありえないカードである \u003ccode\u003eX\u003c/code\u003e の存在があったからです。可能性のあるカードから、ありえないカードを除外してゆくことが、アルゴリズムの要となります。\u003c/p\u003e\n\n\u003cp\u003e話を戻しまして、答えが確定する条件を以下のように決めます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e「\u003ccode\u003eMIN\u003c/code\u003e」は、可能性のあるカードが、他プレイヤーのどのカードよりも小さいとき。\u003c/li\u003e\n\u003cli\u003e「\u003ccode\u003eMAX\u003c/code\u003e」は、可能性のあるカードが、他プレイヤーのどのカードよりも大きいとき。\u003c/li\u003e\n\u003cli\u003e「\u003ccode\u003eMID\u003c/code\u003e」は、可能性のあるカードの最小値が他プレイヤーのカードの最小値よりも大きく、可能性のあるカードの最大値が他プレイヤーのカードの最大値よりも小さいとき。\u003c/li\u003e\n\u003cli\u003e「\u003ccode\u003e?\u003c/code\u003e」は、上記以外のとき。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"推論テーブルの表記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8E%A8%E8%AB%96%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E8%A1%A8%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e推論テーブルの表記\u003c/h2\u003e\n\n\u003cp\u003e以下、カードとプレイヤーの対応を、次のように表記します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e他プレイヤーのかかげている（\u003ccode\u003eVisible\u003c/code\u003e）カード「\u003ccode\u003eA\u003c/code\u003e、\u003ccode\u003eB\u003c/code\u003e、\u003ccode\u003eC\u003c/code\u003e、...」（プレイヤー名）\u003c/li\u003e\n\u003cli\u003e自分のカードである可能性のある（\u003ccode\u003ePossible\u003c/code\u003e）カード「\u003ccode\u003eO\u003c/code\u003e」\u003c/li\u003e\n\u003cli\u003e自分のカードである可能性のない（\u003ccode\u003eImpossible\u003c/code\u003e）カード「\u003ccode\u003eX\u003c/code\u003e」\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e以上の記号をこのように表記します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eB\n[ 1:X, 2:A, 3:O, 4:O, 5:C ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここで、\u003ccode\u003eB\u003c/code\u003e は推論対象プレイヤーです。\u003c/p\u003e\n\n\u003cp\u003eこの表記を「推論テーブル」と呼ぶことにします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"推論の多重化\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8E%A8%E8%AB%96%E3%81%AE%E5%A4%9A%E9%87%8D%E5%8C%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e推論の多重化\u003c/h2\u003e\n\n\u003cp\u003eこの節では、カードを \u003ccode\u003e{ 1, 2, 3, 4, 5, 6, 7 }\u003c/code\u003e 、プレイヤーを \u003ccode\u003e{ A, B, C }\u003c/code\u003e とします。\u003ccode\u003eA=3, B=4, C=5\u003c/code\u003e のとき、\u003ccode\u003eC\u003c/code\u003e がどのように推論するのか考えてみましょう。\u003c/p\u003e\n\n\u003cp\u003e前述の推論テーブルの表記を用いると、プレイヤー \u003ccode\u003eC\u003c/code\u003e の推論の初期状態は以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC\n[ 1:O, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"推論対象プレイヤー-c\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-c\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e推論対象プレイヤー \u003ccode\u003eC\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003eここでは、1 つ前の手番である \u003ccode\u003eB\u003c/code\u003e に着目することにします。\u003ccode\u003eB\u003c/code\u003e のカードは \u003ccode\u003e4\u003c/code\u003e です。覚えておきましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ePossible\u003c/code\u003e であるカードを推論の対象とします。\u003ccode\u003ePossible\u003c/code\u003e であるカードは \u003ccode\u003e1\u003c/code\u003e、\u003ccode\u003e2\u003c/code\u003e、\u003ccode\u003e5\u003c/code\u003e、\u003ccode\u003e6\u003c/code\u003e、\u003ccode\u003e7\u003c/code\u003e ですが、ここでは \u003ccode\u003e1\u003c/code\u003e と \u003ccode\u003e2\u003c/code\u003e だけに注目してみましょう。推論対象プレイヤー \u003ccode\u003eC\u003c/code\u003e のカードは \u003ccode\u003e1\u003c/code\u003e である、もしくは \u003ccode\u003e2\u003c/code\u003e である、と考えるのです。\u003c/p\u003e\n\n\u003cp\u003eここでは、\u003ccode\u003e1\u003c/code\u003e を選択してみましょう。\u003ccode\u003eC\u003c/code\u003e のカードは \u003ccode\u003e1\u003c/code\u003e である、と仮定します。すると、推論テーブルはいかのようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC\n[ 1:C, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこの推論テーブルは、まだ答えの確定条件を満たしていません。次の推論に進みます。\u003ccode\u003eB\u003c/code\u003e の推論について想像してみましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"推論対象プレイヤー-bc-の想像\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-bc-%E3%81%AE%E6%83%B3%E5%83%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e推論対象プレイヤー \u003ccode\u003eB\u003c/code\u003e（\u003ccode\u003eC\u003c/code\u003e の想像）\u003c/h3\u003e\n\n\u003cp\u003eプレイヤー \u003ccode\u003eC\u003c/code\u003e が想像する、プレイヤー \u003ccode\u003eB\u003c/code\u003e の推論テーブルはどうなっているでしょうか。\u003c/p\u003e\n\n\u003cp\u003e今、\u003ccode\u003eC\u003c/code\u003e のカードは \u003ccode\u003e1\u003c/code\u003e であると仮定しています。そして、\u003ccode\u003eB\u003c/code\u003e からは \u003ccode\u003eB\u003c/code\u003e 自身のカードは見えません。推論テーブルは以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC -\u0026gt; B\n[ 1:C, 2:O, 3:A, 4:O, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここで、\u003ccode\u003eC -\u0026gt; B\u003c/code\u003e とは \u003ccode\u003eC\u003c/code\u003e の想像する \u003ccode\u003eB\u003c/code\u003e の推論テーブルである、という意味です。\u003c/p\u003e\n\n\u003cp\u003e先程 \u003ccode\u003eC\u003c/code\u003e で行なったプロセスを再度やってみましょう。前の手番のプレイヤーは \u003ccode\u003eA=3\u003c/code\u003e です。\u003ccode\u003ePossible\u003c/code\u003e なのは \u003ccode\u003e2\u003c/code\u003e、\u003ccode\u003e4\u003c/code\u003e、\u003ccode\u003e5\u003c/code\u003e、\u003ccode\u003e6\u003c/code\u003e、\u003ccode\u003e7\u003c/code\u003e ですが、ここでは \u003ccode\u003e2\u003c/code\u003e に着目します。\u003ccode\u003eB\u003c/code\u003e のカードは \u003ccode\u003e2\u003c/code\u003e であると仮定してみましょう。推論テーブルはこうです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC -\u0026gt; B\n[ 1:C, 2:B, 3:A, 4:O, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e今度は、答えの確定条件を満たしています。それは「誰の」確定条件かというと、\u003ccode\u003eA\u003c/code\u003e ですね。この推論テーブルは \u003ccode\u003eB\u003c/code\u003e のものなので、前の手番のプレイヤーである \u003ccode\u003eA\u003c/code\u003e の推論に移ります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"推論対象プレイヤー-ac-の-想像の-b-の想像\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-ac-%E3%81%AE-%E6%83%B3%E5%83%8F%E3%81%AE-b-%E3%81%AE%E6%83%B3%E5%83%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e推論対象プレイヤー \u003ccode\u003eA\u003c/code\u003e（\u003ccode\u003eC\u003c/code\u003e の 想像の \u003ccode\u003eB\u003c/code\u003e の想像）\u003c/h3\u003e\n\n\u003cp\u003eそろそろ、ややこしくなってきたと思いませんか。私は思います。こんな難しい問題（しかし解ける）、よく考えつくなーと感心しきりです。\u003c/p\u003e\n\n\u003cp\u003e今回考えるのは、「「\u003ccode\u003eC\u003c/code\u003e の想像する \u003ccode\u003eB\u003c/code\u003e」の想像する \u003ccode\u003eA\u003c/code\u003e」の推論テーブルです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC -\u0026gt; B -\u0026gt; A\n[ 1:C, 2:B, 3:O, 4:O, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこの条件であれば、答えの確定条件を満たしています。\u003ccode\u003eA=\u0026gt;MAX\u003c/code\u003e ですね。\u003c/p\u003e\n\n\u003cp\u003eしかし、思い出してみてください。そもそも、この節で議論を始めたときの前提は \u003ccode\u003eA=3, B=4, C=5\u003c/code\u003e でした。\u003ccode\u003eA\u003c/code\u003e は「\u003ccode\u003eMAX\u003c/code\u003e」ではありませんし、\u003ccode\u003eA\u003c/code\u003e 自身、それを分かっています。ですから、\u003ccode\u003eA\u003c/code\u003e は最初の手番で「\u003ccode\u003e?\u003c/code\u003e」と答えます。\u003c/p\u003e\n\n\u003cp\u003e推論テーブルの推論が崩れました。仮定が間違っていたのです。前の推論に戻る必要があります。1 つ前の推論はこうです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC -\u0026gt; B\n[ 1:C, 2:B, 3:A, 4:O, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここでの仮定 \u003ccode\u003e2:B\u003c/code\u003e が間違っていたのですね。ですから、正しい推論テーブルはこのようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC -\u0026gt; B\n[ 1:C, 2:X, 3:A, 4:O, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eすると、この推論テーブルは確定条件を満たしています。\u003ccode\u003eB=\u0026gt;MAX\u003c/code\u003e です。\u003c/p\u003e\n\n\u003cp\u003eしかし、ここでも推論は正しくありません。前提は \u003ccode\u003eA=3, B=4, C=5\u003c/code\u003e でした。\u003ccode\u003eB\u003c/code\u003e は手番で答えられず、「\u003ccode\u003e?\u003c/code\u003e」と宣言します。\u003c/p\u003e\n\n\u003cp\u003e仮定が崩れました。前に戻りましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC\n[ 1:C, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこの \u003ccode\u003e1:C\u003c/code\u003e が間違っていたことになります。正しい推論テーブルはこうです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC\n[ 1:X, 2:O, 3:A, 4:B, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれで最初に戻ってきました。\u003c/p\u003e\n\n\u003cp\u003eやってみると分かるのですが、これも \u003ccode\u003eB\u003c/code\u003e が「\u003ccode\u003e?\u003c/code\u003e」と答えた時点で、\u003ccode\u003e2:X\u003c/code\u003e となります。ですから、\u003ccode\u003eC\u003c/code\u003e の手番が回ってきた時点での推論テーブルは以下のようになっています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eC\n[ 1:X, 2:X, 3:A, 4:B, 5:O, 6:O, 7:O ]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれは、確定条件を満たしています。今度こそ、\u003ccode\u003eC\u003c/code\u003e は「\u003ccode\u003eMAX\u003c/code\u003e」と答えることが可能になります。\u003c/p\u003e\n\n\u003cp\u003eということで、答えは「\u003ccode\u003eA=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MAX\u003c/code\u003e」でした。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"再帰呼び出しによる実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%86%8D%E5%B8%B0%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%81%AB%E3%82%88%E3%82%8B%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e再帰呼び出しによる実装\u003c/h2\u003e\n\n\u003cp\u003e前節の考え方をすると、最初の状態から次の推論へと移ってゆく際に分岐が発生するため、データ構造としては木構造を形成します。本記事の投稿当初の方法では、推論テーブルを持つノードを木構造の形で保持する、という愚直な実装でした。しかし、\u003ca href=\"/sumim\" class=\"user-mention js-hovercard\" title=\"sumim\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"sumim\"\u003e@sumim\u003c/a\u003e 氏が示した再帰呼び出しによる方法が、よりスマートでした（木構造を構築する方法では、結局正答に至らず）。\u003c/p\u003e\n\n\u003cp\u003eアルゴリズムのコア部分となるメソッドを掲載します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 現在の順番に基づき、答えを導出する\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// orderIndex: _PlayerOrder上における現在の順番\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// return    : 答え\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003ePlayerAnswer\u003c/span\u003e \u003cspan class=\"nf\"\u003eInfer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eorderIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003e_Infer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_PlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_VisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eorderIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// 答えを導出する\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// targetPlayerName: 推論対象のプレイヤーの名前\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// visibleCards    : プレイヤーに見えているカード列\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// orderIndex      : _PlayerOrder上における現在の順番\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// return          : 答え\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003ePlayerAnswer\u003c/span\u003e \u003cspan class=\"nf\"\u003e_Infer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etargetPlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003e_VisibleCard\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003elimit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ememoKey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003e_MemoKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetPlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elimit\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// メモより取得\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_Memo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContainsKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ememoKey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003e_Memo\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ememoKey\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 自分のカードである可能性のあるカード列（あとで削除するためリストにする）\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epossibleCardList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_AllCards\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExcept\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCard\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                                    \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToList\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerNames\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_Order\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetPlayerNames\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eplayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eplayerNames\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTake\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elimit\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 前の手番が存在するなら\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eprevIndex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eprevPlayerName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_Order\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetPlayerNames\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eElementAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprevIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// possibleCardListのクローンでループ\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003epossibleCardList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 前の手番を仮定する\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecandidates\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eConcat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003e_VisibleCard\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetPlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n                                             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePlayerName\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eprevPlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                                             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOrderBy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                                             \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 仮定を元に答えを導出する\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003einferred\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003e_Infer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprevPlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecandidates\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprevIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 答えの食い違い\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einferred\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eAnswerValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUnknown\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003epossibleCardList\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRemove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eanswer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003e_GetAnswer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetPlayerName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epossibleCardList\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evisibleCards\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003e_Memo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ememoKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eanswer\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eanswer\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e処理の流れはコメントの通りです。\u003c/p\u003e\n\n\u003cp\u003e計算量が多いため、メモ化により高速化を図っています。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"出力例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%87%BA%E5%8A%9B%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e出力例\u003c/h1\u003e\n\n\u003cp\u003e最後に、カード \u003ccode\u003e5\u003c/code\u003e 枚、プレイヤー \u003ccode\u003e3\u003c/code\u003e 人の場合の出力例をお見せします。\u003c/p\u003e\n\n\u003cp\u003e順列の生成は \u003ccode\u003eIndianPoker.Lib.Utils\u003c/code\u003e に含まれています。また、各行の最後に付加された \u003ccode\u003eOK\u003c/code\u003e ですが、これはデバッグのため、宣言された答えが配られたカードと比較して正しいかどうかを出力したものです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u0026lt;A=1, B=2, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MAX : OK\n\u0026lt;A=1, B=2, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=1, B=2, C=5\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=1, B=3, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=1, B=3, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=1, B=3, C=5\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=1, B=4, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=1, B=4, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=1, B=4, C=5\u0026gt; A=\u0026gt;MIN : OK\n\u0026lt;A=1, B=5, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=1, B=5, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=1, B=5, C=4\u0026gt; A=\u0026gt;MIN : OK\n\u0026lt;A=2, B=1, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MAX : OK\n\u0026lt;A=2, B=1, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MAX : OK\n\u0026lt;A=2, B=1, C=5\u0026gt; A=\u0026gt;MID : OK\n\u0026lt;A=2, B=3, C=1\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=2, B=3, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MAX : OK\n\u0026lt;A=2, B=3, C=5\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=2, B=4, C=1\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=2, B=4, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=2, B=4, C=5\u0026gt; A=\u0026gt;MIN : OK\n\u0026lt;A=2, B=5, C=1\u0026gt; A=\u0026gt;MID : OK\n\u0026lt;A=2, B=5, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=2, B=5, C=4\u0026gt; A=\u0026gt;MIN : OK\n\u0026lt;A=3, B=1, C=2\u0026gt; A=\u0026gt;MAX : OK\n\u0026lt;A=3, B=1, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=3, B=1, C=5\u0026gt; A=\u0026gt;MID : OK\n\u0026lt;A=3, B=2, C=1\u0026gt; A=\u0026gt;MAX : OK\n\u0026lt;A=3, B=2, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=3, B=2, C=5\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=3, B=4, C=1\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=3, B=4, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=3, B=4, C=5\u0026gt; A=\u0026gt;MIN : OK\n\u0026lt;A=3, B=5, C=1\u0026gt; A=\u0026gt;MID : OK\n\u0026lt;A=3, B=5, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;MAX : OK\n\u0026lt;A=3, B=5, C=4\u0026gt; A=\u0026gt;MIN : OK\n\u0026lt;A=4, B=1, C=2\u0026gt; A=\u0026gt;MAX : OK\n\u0026lt;A=4, B=1, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=4, B=1, C=5\u0026gt; A=\u0026gt;MID : OK\n\u0026lt;A=4, B=2, C=1\u0026gt; A=\u0026gt;MAX : OK\n\u0026lt;A=4, B=2, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=4, B=2, C=5\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=4, B=3, C=1\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=4, B=3, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MIN : OK\n\u0026lt;A=4, B=3, C=5\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=4, B=5, C=1\u0026gt; A=\u0026gt;MID : OK\n\u0026lt;A=4, B=5, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MIN : OK\n\u0026lt;A=4, B=5, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MIN : OK\n\u0026lt;A=5, B=1, C=2\u0026gt; A=\u0026gt;MAX : OK\n\u0026lt;A=5, B=1, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=5, B=1, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=5, B=2, C=1\u0026gt; A=\u0026gt;MAX : OK\n\u0026lt;A=5, B=2, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MID : OK\n\u0026lt;A=5, B=2, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=5, B=3, C=1\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=5, B=3, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=5, B=3, C=4\u0026gt; A=\u0026gt;?, B=\u0026gt;MIN : OK\n\u0026lt;A=5, B=4, C=1\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=5, B=4, C=2\u0026gt; A=\u0026gt;?, B=\u0026gt;MID : OK\n\u0026lt;A=5, B=4, C=3\u0026gt; A=\u0026gt;?, B=\u0026gt;?, C=\u0026gt;MIN : OK\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"考察\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%80%83%E5%AF%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e考察\u003c/h1\u003e\n\n\u003cp\u003eコメント欄で議論となりましたが、答えが出るまでのターン数は結局求まりませんでした。\u003ccode\u003eImpossible\u003c/code\u003e の条件が複雑で追いきれませんでした。\u003c/p\u003e\n\n\u003cp\u003e実装したプログラムでは、前述の通りのやり方で必ず収束するため、ターン数は不要となりました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"課題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AA%B2%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e課題\u003c/h1\u003e\n\n\u003cp\u003e計算量が膨大なため、実行時間がかかります。\u003c/p\u003e\n\n\u003cp\u003e本物のインディアン・ポーカーはカード数 \u003ccode\u003e53\u003c/code\u003e 枚ですが、プレイヤー数 \u003ccode\u003e2\u003c/code\u003e のときは答えを導けるものの、それ以上の人数では \u003ccode\u003e53\u003c/code\u003e 枚に対応することはできませんでした。\u003c/p\u003e\n\n\u003cp\u003eLINQ を多用しているため、元々速度は最適化されていませんが、計算量のオーダー自体に問題があると思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h1\u003e\n\n\u003cp\u003eオブジェクト指向は大変難しいです。特に、このような難解な問題を解こうとする場合、答えが分かっていないと、確固たる設計をするのは不可能です。\u003c/p\u003e\n\n\u003cp\u003eしかし、オブジェクト指向はまた、このようなケースに対してアルゴリズム部分をブラックボックス化する力も持っています。ですから、最初に設計を決めることは可能で、しかし作り込んでゆくうちに設計が変化してゆく場合がほとんどだと思います。\u003c/p\u003e\n\n\u003cp\u003eよく、コードを書かない SE の存在を耳にしますが、コードを書かずに設計なんてできないというのが私の考えです。\u003c/p\u003e\n\n\u003cp\u003eコードを書いてオブジェクト指向力を磨きましょう。私も精進します。\u003c/p\u003e\n","createdAt":"2018-09-30T12:13:00Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"OQ+j3csO6an28kbCF/gCiNOegOAtPg0V--L2W/WgnuBXTH6z77--XSourS1yT97CmBt6mFZ7Xg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2018-10-10T03:55:12Z","likesCount":34,"linkUrl":"https://qiita.com/hiki_neet_p/items/d4624635d8baedba44c9","organization":null,"originalId":700258,"stockedCount":38,"title":"「オブジェクト指向が5000%理解できる記事(実践編)」の解答編","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AC%9D%E8%BE%9E\"\u003e謝辞\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%82%A2%E3%83%B3%E3%83%9D%E3%83%BC%E3%82%AB%E3%83%BC%E5%95%8F%E9%A1%8C\"\u003eインディアン・ポーカー問題\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A7%A3%E6%B1%BA%E5%AF%BE%E8%B1%A1%E3%81%A8%E3%81%AA%E3%82%8B%E5%95%8F%E9%A1%8C\"\u003e解決対象となる問題\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%95%8F%E9%A1%8C%E3%81%AE%E8%A6%81%E7%82%B9\"\u003e問題の要点\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BE%8B\"\u003e例\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%95%8F%E9%A1%8C%E3%81%AE%E8%A7%A3%E7%AD%94\"\u003e問題の解答\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8B%95%E3%81%8B%E3%81%97%E6%96%B9\"\u003e動かし方\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%A6%82%E8%A6%81\"\u003eコードの概要\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E6%A7%8B%E6%88%90\"\u003eクラス構成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E5%9B%B3\"\u003eクラス図\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#solver\"\u003eSolver\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#playeranswer\"\u003ePlayerAnswer\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#answervalue\"\u003eAnswerValue\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#_card\"\u003e_Card\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#_deck\"\u003e_Deck\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#_player\"\u003e_Player\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#_visiblecard\"\u003e_VisibleCard\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#_inference\"\u003e_Inference\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#_playerorder\"\u003e_PlayerOrder\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0\"\u003eアルゴリズム\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%AD%94%E3%81%88%E3%81%AE%E7%A2%BA%E5%AE%9A%E6%9D%A1%E4%BB%B6\"\u003e答えの確定条件\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8E%A8%E8%AB%96%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E8%A1%A8%E8%A8%98\"\u003e推論テーブルの表記\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8E%A8%E8%AB%96%E3%81%AE%E5%A4%9A%E9%87%8D%E5%8C%96\"\u003e推論の多重化\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-c\"\u003e推論対象プレイヤー C\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-bc-%E3%81%AE%E6%83%B3%E5%83%8F\"\u003e推論対象プレイヤー B（C の想像）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8E%A8%E8%AB%96%E5%AF%BE%E8%B1%A1%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC-ac-%E3%81%AE-%E6%83%B3%E5%83%8F%E3%81%AE-b-%E3%81%AE%E6%83%B3%E5%83%8F\"\u003e推論対象プレイヤー A（C の 想像の B の想像）\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%86%8D%E5%B8%B0%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%81%AB%E3%82%88%E3%82%8B%E5%AE%9F%E8%A3%85\"\u003e再帰呼び出しによる実装\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%87%BA%E5%8A%9B%E4%BE%8B\"\u003e出力例\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%80%83%E5%AF%9F\"\u003e考察\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AA%B2%E9%A1%8C\"\u003e課題\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":6060,"uuid":"d4624635d8baedba44c9","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"wKH4e+BvCcnV9wQZqiEmf+CWATE=--/+u9opdC44WKSZwl--orqZH+aIgbMPukJrv4FcDQ==","originalId":53668,"description":"プログラミングは趣味でやっていますが、いずれは何かアプリをリリースしたいと思っています。","facebookUrl":null,"githubUrl":"https://github.com/tana-gh","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/53668/profile-images/1551575525","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F53668%2Fprofile-images%2F1551575525?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=a5800eda5f39f10b753ac3c7e66e8650","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F53668%2Fprofile-images%2F1551575525?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=9bce97088c66ea2aecaab5dff0543fa0","urlName":"hiki_neet_p","websiteUrl":"","twitterUrl":"https://twitter.com/hiki_neet_p","twitterUrlName":"hiki_neet_p","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"アルゴリズム","urlName":"%e3%82%a2%e3%83%ab%e3%82%b4%e3%83%aa%e3%82%ba%e3%83%a0"},{"name":"オブジェクト指向","urlName":"%e3%82%aa%e3%83%96%e3%82%b8%e3%82%a7%e3%82%af%e3%83%88%e6%8c%87%e5%90%91"}],"followingLikers":{"edges":[]},"comments":{"totalCount":19}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
