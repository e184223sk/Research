子プロセスを起動するようなアプリケーションでは、ゾンビ化しないように確実に子プロセスが終了するようにしたい。やり方自体は枯れた情報だけどQiitaに記事がなかったし、C/C++だと例があるがC#だとあまり日本語での情報があまり引掛からないので書いてみた。注意点としては、 JOBOBJECT_BASIC_LIMIT_INFORMATION::LimitFlags でフラグを設定するのに、SetInformationJobObject 関数では JobObjectExtendedLimitInformationと JOBOBJECT_EXTENDED_LIMIT_INFORMATION 構造体を使用しなければならないこと。おすすめはしないが、Interop.Excelに応用するとしたらApplicationClass.HwndからGetWindowThreadProcessId関数でプロセスIDを取得すれば対応できるはず。


