More than 3 years have passed since last update.C++のコードからさらにコードを生成するようなVisualStudioのaddinを作ってるのですが
C#でEnvDTEのVCCodeFunctionから宣言を取得しようとDeclarationTextを取得すると
たまに落ちることがあります。
どういうときに落ちるか判明したので以下記載。以下のようなコードだとDeclarationTextが取得できる。以下のようなコードだとDeclarationTextが取得できない。
(例外ArgumentExceptionが発行される。)DeclarationTextにアクセスする際にtry-catchで包むと回避できます。
またTypenameとDisplayname使うと定義を何となく作ることができます。が、上記の方法ではvirtualやoverrideキーワードが取得できないのが悩ましいところです。
誰か解決策知ってたら教えてください…


