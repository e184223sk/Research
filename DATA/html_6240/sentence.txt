More than 3 years have passed since last update.Microsoft の Bot Framework を使った Botアプリケーションの開発にハマっています（楽しい方の意味で）。まず、このあたりの情報を元に、まで行うことができました。さて、私が本当にやりたいのは「定期的にBotからユーザーへメッセージを送る（時報とか）」ことです。
が、 Visual Studio の Bot Application のプロジェクトテンプレートでは?（あるいは「Botアプリケーション」では）、処理の起点は必ずユーザー(クライアント)からBotへのメッセージ送信をBotが受信するところから始まるようです（違ってたら教えてください）。Bot Framework の REST API には Send and receive messages もあるので、任意のタイミングでメッセージを送信することも可能なはず。いろいろ探していたらという情報を発見。おお、コンソールアプリからメッセージを送信できれば、これをcron的なものやAzure Functionsで定期的に実行させられそうです。コード例を元に悪戦苦闘した結果、下のようなコードでメッセージ送信ができました。以下、ポイントこのプログラムを実行すると、 userAccount が示すSkypeユーザー(ここでは私)に「こんにちわ」のメッセージが送信されます、やった！今作りたいと思っているのは「タイムカード打刻BOT」で、月末に EXCEL に退勤時間を書くのが面倒なので、毎日、18:00 になったら、Botに「仕事おわった？」と聞いて欲しいのです。「はい」と回答すればその時刻を打刻、「いいえ」と答えたら１時間後にまた聞いてくる・・・、という感じで（弊社は Skype 常時起動させてるから Skype で試してるけど Bot Connector により Slack などの別ツールにも対応できるはず）。これを行うには、クライアント起点の対話でなく、BOT起点の対話が必要で、コンソールアプリからメッセージ送信することができたので、次はAzure Functionでやってみようかと思います。BOT開発、しばらく楽しめそうです。


