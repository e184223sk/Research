More than 1 year has passed since last update.こちら で紹介されているように PowerShell で Add-Type コマンドレットを介して C# のコードが実行できます。上記の記事でもふれられているように C# コードを修正して Add-Type を再実行するとなるエラーがでます。ワーク アラウンドとしては
* 別プロセスの powershell.exe を起動して Add-Type しなおす。
* Start-Job をつかう。ただし、Console.Write() などのコンソールへの直接的出力はすてられるという制限あり。別プロセスの powershell.exe を起動して Add-Type しなおすのはめんどうなので、多少なりともの自動化として、ラッパー関数をかいてみました。ここ のサンプル コードもエラーなしで実行できるように culture にもきをくばってみました。上記の記事よりおかりしまして、自分の用途としては Visual Studio などいれられない、いれたくない環境でもサンプル コードをきがるに「写経」できることです。よって、 -FilePath パラメーターを多用します。Console.Write() などのコンソールへの直接的出力はすてられるという制限があります。この C# コードを「ふつうに」実行すると「太郎さん、おはよう」が二行でます。一行目は Console.WriteLine(msg); から、二行目は return msg; からのです。しかし、この Start-Job をかませた実行では  return msg; からのぶんしかでてきません。コードを実行させたいだけならとすれば .\example.exe が生成されるのでした (2020 年 7 月現在) 。ただ、このばあい ここ のサンプル コードは Main() の最初にを追加することでしか正常に実行させられませんでした。 PS のコマンドラインでとするのは効果がありませんでした。


