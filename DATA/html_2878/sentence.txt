TimelineにBlendShapeでキャラに表情つけたものを保存した表情をキーを設定してほしいと言われたので、実装したのを自分が忘れないように書いた記事です。たぶん、もっといいやり方はあるはず。。なので、もっといい方法あったら教えてくださいこの記事は2021/08/16に書いています。
timelineの1.5.6で作業しています。
[追記]　2021/08/18
初めに投稿した物だと、いろいろ不具合あったの修正します。。
主にアニメーションカーブ再設定の部分とTimeline editor Repaint周りのあたりを。。[追記]　2021/08/19
親オブジェクトからアニメーション指定できるようにしました。
あと、一部エラーだったものを修正

※例ではニコニ立体ちゃんのVRMのBlendShapeで設定してある、表情を表示してます。
BlendShapeでそれぞれ表情をボタン押して、unityの別ウインドウで表情のが見れますが、この表情の値をtimelineでキーを打ってほしいって言うものです。timelineのPlayableDirectorから、timelineの情報の引き出して
SkinnedMeshRendererの値を比較して、値設定してあるものtimelineのアニメーションクリップに保存してます。
あとは、アニメーションクリップを打ってもtimelineエディタを再描画してあげないと表示しなかったのでRepaint処理もしてます。Repaintの処理に関しては、コガネブログさんの記事を参考に書きました。timelineをスクリプトで一気に作るTipsアニメーションクリップを作るるのが分からなかったので参考に下記の部分ね
 animationClip.SetCurve("", typeof(SkinnedMeshRenderer), _propertyName, curve);
上記の場合skinnedMeshRendererインデックスから名前取れるので
"blendShape." + _skinnedMeshRenderer.sharedMesh.GetBlendShapeName(_blendShapeIndex);
blendShape.bs_face.eye_TT
と言う文字列が取れます。timlineの右側の歯車の設定等々は上記からいろいろ調べられるようです。
キーフレームとプロパティ値の設定を見て、アニメーションカーブを再設定する部分の参考に同じように悩んでいる人が昔いたみたいです。。timelineエディタを再更新する際に参考に最近はunityのエディタ改造が主になっているので、調べてもあんまり前例がなくて組み合わせで何とか
することが多いくてちゃんとどんなサイトから調べたかを書いておかないと自分が忘れちゃう。。


