<!DOCTYPE html><html><head><meta charset="utf-8" /><title>【C#】 GDI+でカラー オーバーレイ (ColorMatrixでリベンジ) - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/libraplanet/items/bb4df396f21a5dbfa445" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="TYZON9C96FGlE2cu8852trSAKyD6kyaBLPwDRWFoz+b9f6NzjI6HsA7yL/NeD3jUvdQZabbKbGtdMw+nl2bRYQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="【C#】 GDI+でカラー オーバーレイ (ColorMatrixでリベンジ) - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRUXlQamdKRWdSMFJKSy1PQnAtT0NxLU9EcWVPRHZDRGpncXJqZzd6amc1RGpnN3pqZzZ6amdxUWdLRU52Ykc5eVRXRjBjbWw0NDRHbjQ0T3E0NE9aNDRPejQ0SzRLUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz04Y2I3NjU0YTlkMjc2Y2Y2OGQzZjk4YTQ4NDRkMGIxZQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3hwWW5KaGNHeGhibVYwJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ODBjMDAyOGY2YmFkYzcwMjgxYzkxYmZiZWM0NWNmYTc&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=fdf9155208124830dbb50999aa60bea8"><meta property="og:description" content="

概要

以前、こちらの記事 で オーバーレイ(風) にチャレンジしたのだけど。今回は ColorMatrix を利用して オーバーレイ に再チャレンジ。前回の (風) とは違い、今回はちゃんと望み動きが出来た。

どちらかというと..."><meta content="https://qiita.com/libraplanet/items/bb4df396f21a5dbfa445" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,.NET,画像処理,GDI+" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-da270424-4127-4158-8766-32dbc4e32d25"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Flibraplanet%2Fitems%2Fbb4df396f21a5dbfa445">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Flibraplanet%2Fitems%2Fbb4df396f21a5dbfa445">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-da270424-4127-4158-8766-32dbc4e32d25">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-08-31T10:13:01.000+09:00","dateModified":"2020-09-02T23:13:54.000+09:00","headline":"【C#】 GDI+でカラー オーバーレイ (ColorMatrixでリベンジ)","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRUXlQamdKRWdSMFJKSy1PQnAtT0NxLU9EcWVPRHZDRGpncXJqZzd6amc1RGpnN3pqZzZ6amdxUWdLRU52Ykc5eVRXRjBjbWw0NDRHbjQ0T3E0NE9aNDRPejQ0SzRLUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz04Y2I3NjU0YTlkMjc2Y2Y2OGQzZjk4YTQ4NDRkMGIxZQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3hwWW5KaGNHeGhibVYwJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ODBjMDAyOGY2YmFkYzcwMjgxYzkxYmZiZWM0NWNmYTc\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=fdf9155208124830dbb50999aa60bea8","mainEntityOfPage":"https://qiita.com/libraplanet/items/bb4df396f21a5dbfa445","author":{"@type":"Person","address":null,"email":null,"identifier":"libraplanet","name":"libraplanet","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F72257%2Fe381e2f4dd7851e2a001bfbed66153a131d5e78b%2Fx_large.png%3F1598304169?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d426188a19b67fbd8a5ed5d14dbfe64d","url":"https://qiita.com/libraplanet","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"libraplanet","type":"items","id":"bb4df396f21a5dbfa445"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"libraplanet","type":"items","id":"bb4df396f21a5dbfa445"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"libraplanet","type":"items","id":"bb4df396f21a5dbfa445"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/libraplanet/items/bb4df396f21a5dbfa445","location":"/libraplanet/items/bb4df396f21a5dbfa445","scheme":"https","host":"qiita.com","port":null,"pathname":"/libraplanet/items/bb4df396f21a5dbfa445","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"lNhQ0/uocKfCa/38PxjikFtyHzK1Fmz+9TEqst3xEiYkIb2Xp5sfRmmKtSGS2ezyUiYte/lPJhSE/iZQK/8MoQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-3907accd-bcaa-4437-80c6-ca47bc8017fd"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/libraplanet/items/bb4df396f21a5dbfa445/likers" class="css-1iupg5d">1</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">0</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/bb4df396f21a5dbfa445/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/libraplanet/items/bb4df396f21a5dbfa445/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/libraplanet/items/bb4df396f21a5dbfa445/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/libraplanet/items/bb4df396f21a5dbfa445/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/libraplanet/items/bb4df396f21a5dbfa445.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/libraplanet"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/72257/e381e2f4dd7851e2a001bfbed66153a131d5e78b/x_large.png?1598304169" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/libraplanet" class="css-10ougpm">@<!-- -->libraplanet</a><div class="css-1ay9vb9"><span><meta content="2020-08-31T01:13:01Z"/><time dateTime="2020-09-02T14:13:54Z" class="css-m19uds">updated at 2020-09-02</time></span></div></div></div></div></div><h1 class="css-cgzq40">【C#】 GDI+でカラー オーバーレイ (ColorMatrixでリベンジ)</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/.net" class="css-4czcte">.NET</a><a href="/tags/%e7%94%bb%e5%83%8f%e5%87%a6%e7%90%86" class="css-4czcte">画像処理</a><a href="/tags/gdi%2b" class="css-4czcte">GDI+</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="概要" class="fragment"></span><a href="#%E6%A6%82%E8%A6%81"><i class="fa fa-link"></i></a>概要</h1>

<p>以前、<a href="https://qiita.com/libraplanet/items/a5c8a313a1f7e7bbc86a" id="reference-ba32123656272d8f8569">こちらの記事</a> で <strong>オーバーレイ(風)</strong> にチャレンジしたのだけど。今回は <code>ColorMatrix</code> を利用して <code>オーバーレイ</code> に再チャレンジ。前回の <strong>(風)</strong> とは違い、今回はちゃんと望み動きが出来た。</p>

<p>どちらかというと数学寄りの話。といっても私もにわかなので、そんなに難しくない話。</p>

<h1>
<span id="カラー-オーバーレイ-とは" class="fragment"></span><a href="#%E3%82%AB%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4-%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a><code>カラー オーバーレイ</code> とは？</h1>

<p>Photoshopの <code>レイヤー効果</code> でおなじみ(？)のやつ。<br>
レイヤーの描画ピクセルの色情報を任意の色に上書きするやつ。<br>
私はよくレイヤーの描画モードを <code>スクリーン</code> にした単色レイヤーを重ね合わせえて色味調整を行うことがよくあるのだけど。<code>カラー オーバーレイ</code> だとカラーピッカーで選択中の色がリアルタイムで反映されるので、 <code>スクリーン</code> レイヤーの色味調整でよく使ってる。</p>

<p><a href="https://camo.qiitausercontent.com/e15b1f8b3d3489c6e9f8f5a8458bcc2901c8ddfd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f36393935626638302d373430342d326230662d303761382d6665646134643566623865322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F6995bf80-7404-2b0f-07a8-feda4d5fb8e2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=47b3cd87323c862ece1b5a65795d0e47" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/6995bf80-7404-2b0f-07a8-feda4d5fb8e2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F6995bf80-7404-2b0f-07a8-feda4d5fb8e2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bf4d670a9536dc3d686fe446613f045b 1x" loading="lazy"></a></p>

<h1>
<span id="カーラー-オーバーレイを行うための行列" class="fragment"></span><a href="#%E3%82%AB%E3%83%BC%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4%E3%82%92%E8%A1%8C%E3%81%86%E3%81%9F%E3%82%81%E3%81%AE%E8%A1%8C%E5%88%97"><i class="fa fa-link"></i></a>カーラー オーバーレイを行うための行列</h1>

<p><code>ColorMatrix</code> は <code>行列(Matrix)</code> を使って色味を調整する。</p>

<ul>
<li>ColorMatrixによる色の変換 - C# - hesperus.net<br>
<a href="https://www.hesperus.net/csharp/color_matrix.aspx" class="autolink" rel="nofollow noopener" target="_blank">https://www.hesperus.net/csharp/color_matrix.aspx</a>
</li>
</ul>

<p>まず早速、その <code>行列</code> のための配列。</p>

<p>ジャグ配列... (´・ω・｀)</p>

<h2>
<span id="通常" class="fragment"></span><a href="#%E9%80%9A%E5%B8%B8"><i class="fa fa-link"></i></a>通常</h2>

<p>シンプルに指定色に置き換える。</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">color overlay.cs</span></div>
<div class="highlight"><pre><code><span class="k">new</span> <span class="nf">ColorMatrix</span><span class="p">(</span><span class="k">new</span> <span class="kt">float</span><span class="p">[][]{</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">1.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span>    <span class="n">r</span><span class="p">,</span>    <span class="n">g</span><span class="p">,</span>    <span class="n">b</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">1.0f</span> <span class="p">},</span>
<span class="p">});</span>
</code></pre></div>
</div>

<h2>
<span id="指定色のアルファを加味する場合" class="fragment"></span><a href="#%E6%8C%87%E5%AE%9A%E8%89%B2%E3%81%AE%E3%82%A2%E3%83%AB%E3%83%95%E3%82%A1%E3%82%92%E5%8A%A0%E5%91%B3%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>指定色のアルファを加味する場合</h2>

<p>アルファによって、オーバーレイを加減をする。<br>
(適応量を線形補間。)</p>

<ul>
<li>0.0の時は塗りつぶしが行われない。</li>
<li>1.0の時はで完全塗りつぶし。</li>
</ul>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">color overlay + a.cs</span></div>
<div class="highlight"><pre><code><span class="k">new</span> <span class="nf">ColorMatrix</span><span class="p">(</span><span class="k">new</span> <span class="kt">float</span><span class="p">[][]{</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span> <span class="m">1</span> <span class="p">-</span> <span class="n">a</span><span class="p">,</span>  <span class="m">0.0f</span><span class="p">,</span>  <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span>  <span class="m">0.0f</span><span class="p">,</span> <span class="m">1</span> <span class="p">-</span> <span class="n">a</span><span class="p">,</span>  <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span>  <span class="m">0.0f</span><span class="p">,</span>  <span class="m">0.0f</span><span class="p">,</span> <span class="m">1</span> <span class="p">-</span> <span class="n">a</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span>  <span class="m">0.0f</span><span class="p">,</span>  <span class="m">0.0f</span><span class="p">,</span>  <span class="m">0.0f</span><span class="p">,</span> <span class="m">1.0f</span><span class="p">,</span> <span class="m">0.0f</span> <span class="p">},</span>
    <span class="k">new</span> <span class="kt">float</span><span class="p">[]{</span> <span class="n">r</span> <span class="p">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">g</span> <span class="p">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">*</span> <span class="n">a</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="m">1.0f</span> <span class="p">},</span>
<span class="p">});</span>
</code></pre></div>
</div>

<h1>
<span id="表示例" class="fragment"></span><a href="#%E8%A1%A8%E7%A4%BA%E4%BE%8B"><i class="fa fa-link"></i></a>表示例</h1>

<p>参考のイラストは、Pixivでは18年齢制限の制限がついてしまっているので、本記事では一応何となく一部にモザイクをかけております (苦笑)。</p>

<h2>
<span id="サンプル-プロジェクト" class="fragment"></span><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88"><i class="fa fa-link"></i></a>サンプル プロジェクト</h2>

<ul>
<li>libraplanet / coloroverlaycs — Bitbucket<br>
<a href="https://bitbucket.org/libraplanet/coloroverlaycs/" class="autolink" rel="nofollow noopener" target="_blank">https://bitbucket.org/libraplanet/coloroverlaycs/</a>
</li>
</ul>

<h2>
<span id="単色でのカラー-オーバーレイ" class="fragment"></span><a href="#%E5%8D%98%E8%89%B2%E3%81%A7%E3%81%AE%E3%82%AB%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4"><i class="fa fa-link"></i></a>単色でのカラー オーバーレイ</h2>

<p>単純に黒で塗りつぶし。<br>
(人によっては背景が透明に見える)<br>
<a href="https://camo.qiitausercontent.com/a3ea0212f21320fd709be938523a543134007fc9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f30646332653264632d383030662d383939612d313537332d3561383338303837333430642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F0dc2e2dc-800f-899a-1573-5a838087340d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a8fe0fe49d38cddff440464e6a3c0f63" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/0dc2e2dc-800f-899a-1573-5a838087340d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F0dc2e2dc-800f-899a-1573-5a838087340d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7273ad23b7d906216da5d40dded28ceb 1x" loading="lazy"></a><br>
<a href="https://camo.qiitausercontent.com/8e58e06c2db735677b4d9cc6cb18fb3f018be4ce/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f37313364663933322d333263632d373965312d313135332d6461336265363065376239362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F713df932-32cc-79e1-1153-da3be60e7b96.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ef5934b27d6ffdde5c47dc4030ed659d" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/713df932-32cc-79e1-1153-da3be60e7b96.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F713df932-32cc-79e1-1153-da3be60e7b96.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=63476558697dcc84738b8dd5811deee9 1x" loading="lazy"></a></p>

<h2>
<span id="-α" class="fragment"></span><a href="#-%CE%B1"><i class="fa fa-link"></i></a>+ α</h2>

<p>色に透明度(α)も追加。<br>
※ <code>アルファ ブレンディング (加算)</code> ではない。<br>
<a href="https://camo.qiitausercontent.com/a26bb4666b779ad1d5a9affe3424feeb10d06107/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f35343239663565632d653639362d643763632d373061622d3064373835376366373064652e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F5429f5ec-e696-d7cc-70ab-0d7857cf70de.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=50a76f897778595ef9b437790fc8a4f8" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/5429f5ec-e696-d7cc-70ab-0d7857cf70de.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F5429f5ec-e696-d7cc-70ab-0d7857cf70de.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=928c12e1ea35263d7b208d3f12d0d11b 1x" loading="lazy"></a><br>
<a href="https://camo.qiitausercontent.com/ea2fa18db510db64612a99219539ae473fdac200/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f34353361323130382d323665332d653065642d396362342d3634306564326261303565312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F453a2108-26e3-e0ed-9cb4-640ed2ba05e1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8a6e5fbd116d5454093d7861144db72c" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/453a2108-26e3-e0ed-9cb4-640ed2ba05e1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F453a2108-26e3-e0ed-9cb4-640ed2ba05e1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=93db4bc2595247dba75401eac6d1832d 1x" loading="lazy"></a></p>

<h2>
<span id="おまけパターン" class="fragment"></span><a href="#%E3%81%8A%E3%81%BE%E3%81%91%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>おまけパターン</h2>

<p>絵も背景も単色で塗りつぶし。<br>
なんか、一昔の <del>エロゲ</del> ゲームの 立ち絵 + とアルファ チャンネルみたい (苦笑)<br>
<a href="https://camo.qiitausercontent.com/74d6376e3c552cce8b24482e2c2a82b525725f6f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f34623438653664382d636630662d643765302d353165642d6137616134356530636238382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F4b48e6d8-cf0f-d7e0-51ed-a7aa45e0cb88.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c609c20d1347138e3f80b427fe69e44d" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/4b48e6d8-cf0f-d7e0-51ed-a7aa45e0cb88.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F4b48e6d8-cf0f-d7e0-51ed-a7aa45e0cb88.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8e88e2a8187ba30644f3c0d44be427c2 1x" loading="lazy"></a><br>
<a href="https://camo.qiitausercontent.com/614cffc0d8321cfec5358985eaa1e60b580553d2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f64636363333164612d313834372d366134312d383232302d6265353966333439303664332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2Fdccc31da-1847-6a41-8220-be59f34906d3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c8234e0bf55987debbb870aaf50b2854" alt="SS.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/dccc31da-1847-6a41-8220-be59f34906d3.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2Fdccc31da-1847-6a41-8220-be59f34906d3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5591fb402d68e1fb6f2132a8e88a3c3e 1x" loading="lazy"></a></p>

<h1>
<span id="解説" class="fragment"></span><a href="#%E8%A7%A3%E8%AA%AC"><i class="fa fa-link"></i></a>解説</h1>

<h2>
<span id="行列-matrix-とは" class="fragment"></span><a href="#%E8%A1%8C%E5%88%97-matrix-%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>行列 (Matrix) とは</h2>

<p>高校数学あたりでやる、あの行列。行列演算は3Dなどで大変活用されており、機械学習など様々に応用されているので、最早言わずもがな、というくらい。</p>

<p>こんな計算するやつ。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{bmatrix}
x &amp; y \\
\end{bmatrix}
\times
\begin{bmatrix}
a &amp; b &amp; c\\
d &amp; e &amp; f\\
\end{bmatrix}
= 
\begin{bmatrix}
\Bigr((x \times a) + (y \times d)\Bigr) &amp; \Bigr((x \times b) + (y \times e)\Bigr) &amp; \Bigr((x \times c) + (y \times f)\Bigr)\\
\end{bmatrix}\\
</code></pre></div></div>

<p>例えば3Dの場合、行列1つの4x4の行列で、<code>回転情報 (Rotatioin)</code>、<code>拡縮情報 (Scale)</code>、<code>平行移動情報 (Translation)</code> を持つことができ、座標情報(Vector) や 他の行列 と掛け合わせることで、<code>頂点座標を変換</code>したり、 <code>回転情報を伝播</code> したりなと、多様される。正直、当時は何となく習っただけの内容だけど、3Dで再会したときの衝撃はびっくりした。<code>CSS Transform 3D</code> も基礎は全く同じなので、ほんと行列すごい。</p>

<p>今回の <code>ColorMatrix</code> では色情報を変換するのフィルターとして行列演算が使われている感じ。</p>

<h2>
<span id="colormatrixでは5x5の正方行列を使う" class="fragment"></span><a href="#colormatrix%E3%81%A7%E3%81%AF5x5%E3%81%AE%E6%AD%A3%E6%96%B9%E8%A1%8C%E5%88%97%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>ColorMatrixでは5x5の正方行列を使う</h2>

<ul>
<li>ColorMatrix クラス (System.Drawing.Imaging) | Microsoft Docs<br>
<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5</a>
</li>
</ul>

<p>より。入出力とフィルターとなるMatrixでの計算式はこんな感じ。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{bmatrix}
R &amp; G &amp; B &amp; A &amp; W \\
\end{bmatrix}
\times
\begin{bmatrix}
Rr &amp; Gr &amp; Br &amp; Ar &amp; Wr \\
Rg &amp; Gg &amp; Bg &amp; Ag &amp; Wg \\
Rb &amp; Gb &amp; Bb &amp; Ab &amp; Wb \\
Ra &amp; Ga &amp; Ba &amp; Aa &amp; Wa \\
Rw &amp; Gw &amp; Bw &amp; Aw &amp; Ww \\
\end{bmatrix}
= 
\begin{bmatrix}
R' &amp; G' &amp; B' &amp; A' &amp; W' \\
\end{bmatrix}
</code></pre></div></div>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{align}
R' &amp;= (R * Rr) + (G * Rg) + (B * Rb) + (A * Ra)  + (W * Rw) \\
G' &amp;= (R * Gr) + (G * Gg) + (B * Gb) + (A * Ga)  + (W * Gw) \\
B' &amp;= (R * Br) + (G * Bg) + (B * Bb) + (A * Ba)  + (W * Bw) \\
A' &amp;= (R * Ar) + (G * Ag) + (B * Ab) + (A * Aa)  + (W * Aw) \\
W' &amp;= (R * Wr) + (G * Wg) + (B * Wb) + (A * Wa)  + (W * Ww) \\
\end{align}
</code></pre></div></div>

<p>入力パラメータが <strong>要素数5</strong> の <code>5次元ベクトル</code> なので、行列は <code>5x5の正方行列</code> が利用される。これを使って色味の調整ができる。</p>

<h3>
<span id="単位行列-何しない行列" class="fragment"></span><a href="#%E5%8D%98%E4%BD%8D%E8%A1%8C%E5%88%97-%E4%BD%95%E3%81%97%E3%81%AA%E3%81%84%E8%A1%8C%E5%88%97"><i class="fa fa-link"></i></a>単位行列 (何しない行列)</h3>

<p>正方行列で主対角線上の要素が1で、他が0のベクトルは <code>単位行列</code> と呼ばれる。細かい条件はあると思うが、今回の様にベクトルの次元数(要素数)と同じ行数・列数を持つ <code>正方行列</code> の場合、 <code>単位行列</code> との積の場合、同じ値が得られる。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>単位行列 = 
\begin{bmatrix}
\color{red}{1} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \color{red}{1} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \color{red}{1} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \color{red}{1} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \color{red}{1} \\
\end{bmatrix}
</code></pre></div></div>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{align}
ベクトルV \times 単位行列 &amp;= ベクトルV (値が変わらない) \\
行列M \times 単位行列 &amp;= 行列M (値が変わらない) \\
\end{align}
</code></pre></div></div>

<p>一応確認。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{bmatrix}
R &amp; G &amp; B &amp; A &amp; W \\
\end{bmatrix}
\times
\begin{bmatrix}
\color{red}{1} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \color{red}{1} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \color{red}{1} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \color{red}{1} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \color{red}{1} \\
\end{bmatrix}
= 
\begin{bmatrix}
R' &amp; G' &amp; B' &amp; A' &amp; W' \\
\end{bmatrix}
</code></pre></div></div>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{align}
R' &amp;= (R * \color{red}{1}) + (G * 0) + (B * 0) + (A * 0)  + (W * 0) = R \\
G' &amp;= (R * 0) + (G * \color{red}{1}) + (B * 0) + (A * 0)  + (W * 0) = G \\
B' &amp;= (R * 0) + (G * 0) + (B * \color{red}{1}) + (A * 0)  + (W * 0) = B \\
A' &amp;= (R * 0) + (G * 0) + (B * 0) + (A * \color{red}{1})  + (W * 0) = A \\
W' &amp;= (R * 0) + (G * 0) + (B * 0) + (A * 0)  + (W * \color{red}{1}) = W \\

\end{align}
</code></pre></div></div>

<p>ほんとだ！<br>
だいたいここから値を変えながら色々と試行していく。</p>

<p>※ ちなみに、行列は <code>交換法則</code> は成り立たないが、単位行列との積については <code>交換法則</code> は成り立たつらしい。</p>

<h3>
<span id="入力値-w1-で任意の値に置換する" class="fragment"></span><a href="#%E5%85%A5%E5%8A%9B%E5%80%A4-w1-%E3%81%A7%E4%BB%BB%E6%84%8F%E3%81%AE%E5%80%A4%E3%81%AB%E7%BD%AE%E6%8F%9B%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>入力値 『W(1)』 で任意の値に置換する。</h3>

<p>今回の主役。</p>

<ul>
<li>ColorMatrix クラス (System.Drawing.Imaging) | Microsoft Docs<br>
<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5</a>
</li>
</ul>

<blockquote>
<p>行列係数は、ARGB 同種値の変換に使用される 5 x 5 線形変換を構成します。 たとえば、ARGB ベクターは、赤、緑、青、アルファ、w として表されます。 w は常に1です。</p>
</blockquote>

<p>MSの説明をみて、なんのコッチャ？と思った人少なくないのでは、と思う。</p>

<p>行列の積では基本は乗算のため、ARGB値に係数を掛け合わせるだけでは、特定の値に置き換えることが出来ない。しかし、<code>Wには固定値 1</code> がくるのでWで任意の値を作ることが可能。更に 　<code>他の係数を 0</code> にすれば元の値を潰せるので、置き換えることができる。</p>

<p><code>ColorMatrix</code> は色情報を <code>0.0～1.0</code> で表現するため、 <code>rgb(229,153,76)<span class="inline-code-color" style="background-color: rgb(229,153,76);"></span></code> に置き換える場合。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{align}
R &amp;= 229 \div 255 &amp;= 0.8980... &amp;\fallingdotseq \color{red}{0.9} \\
G &amp;= 153 \div 255 &amp;&amp;= \color{red}{0.6} \\
B &amp;= 76  \div 255 &amp;= 0.2980... &amp;\fallingdotseq \color{red}{0.3} \\
\end{align}
</code></pre></div></div>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{bmatrix}
R &amp; G &amp; B &amp; A &amp; \color{red}{1} \\
\end{bmatrix}
\times
\begin{bmatrix}
0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 \\
0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 \\
0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 \\
0.0 &amp; 0.0 &amp; 0.0 &amp; \color{red}{1.0} &amp; 0.0 \\
\color{red}{0.9} &amp; \color{red}{0.6} &amp; \color{red}{0.3} &amp; 0.0 &amp; 0.0 \\
\end{bmatrix}
= 
\begin{bmatrix}
\color{red}{0.9} &amp; \color{red}{0.6} &amp; \color{red}{0.3} &amp; \color{red}{A} &amp; W' \\
\end{bmatrix}
\\
\\
\begin{align}
R' &amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * 0.0)  + (\color{red}{W} * \color{red}{0.9}) = \color{red}{0.9} (置換) \\
G' &amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * 0.0)  + (\color{red}{W} * \color{red}{0.6}) = \color{red}{0.6} (置換) \\
B' &amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * 0.0)  + (\color{red}{W} * \color{red}{0.3}) = \color{red}{0.3} (置換) \\
A' &amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * \color{red}{1.0})  + (W * 0.0) = \color{red}{A} (通過) \\
W' &amp;= \color{gray}{(捨てられるので省略)}
\end{align}
</code></pre></div></div>

<p>という計算式で置き換えることができる。<br>
<code>W</code> ありがてぇ。</p>

<h3>
<span id="おまけ-正方行列の理由" class="fragment"></span><a href="#%E3%81%8A%E3%81%BE%E3%81%91-%E6%AD%A3%E6%96%B9%E8%A1%8C%E5%88%97%E3%81%AE%E7%90%86%E7%94%B1"><i class="fa fa-link"></i></a>(おまけ) 正方行列の理由</h3>

<p>前述で一部省略はしているが、 <code>出力 W'</code> は使われない。入力で<code>(R G B A W)</code>の <strong>5次元ベクトル</strong> のため、行列は <strong>5行</strong> 必要だが、出力は <code>(R' G' B' A')</code> の <strong>4次元ベクトル</strong> のため、行列は <strong>4列</strong> で十分だったりする。</p>

<div class="code-frame" data-lang="math"><div class="highlight"><pre><code>\begin{bmatrix}
R &amp; G &amp; B &amp; A &amp; W \\
\end{bmatrix}
\times
\begin{bmatrix}
Rr &amp; Gr &amp; Br &amp; Ar &amp; \color{red}{(Wr)} \\
Rg &amp; Gg &amp; Bg &amp; Ag &amp; \color{red}{(Wg)} \\
Rb &amp; Gb &amp; Bb &amp; Ab &amp; \color{red}{(Wb)} \\
Ra &amp; Ga &amp; Ba &amp; Aa &amp; \color{red}{(Wa)} \\
Rw &amp; Gw &amp; Bw &amp; Aw &amp; \color{red}{(Ww)} \\
\end{bmatrix}
= 
\begin{bmatrix}
R' &amp; G' &amp; B' &amp; A' &amp; \color{red}{(W')}\\
\end{bmatrix}
</code></pre></div></div>

<p><img alt=":thinking:" class="emoji" height="20" src="https://cdn.qiita.com/emoji/twemoji/unicode/1f914.png" title=":thinking:" width="20" loading="lazy"> W’無駄じゃね？</p>

<p>しかし、<code>正方行列</code> であることに利点がある様で、<strong>多少無駄な計算をさせても、作業のしやすさを取った</strong> 形だと考えている。3Dでも <code>4x4の正方行列</code> が一般的に使われるけど、最後の列が不要らしい。<code>4x3の行列</code> の3Dエンジンのゲーム機もあった。(今はどうしているかわからないけど。流石に正方行列の波に飲まれていると予想)。行列演算だと <code>単位行列</code>、 <code>逆行列</code>、 <code>行列の積</code> などで、沢山の行列同士を計算する上で、<code>正方行列</code> のほうが確かに都合が良さそうなので。</p>

<h1>
<span id="感想" class="fragment"></span><a href="#%E6%84%9F%E6%83%B3"><i class="fa fa-link"></i></a>感想</h1>

<p>満足の行くカラー オーバーレイがGDI+で出来てよかった。<code>Matrix (行列)</code>を使うのは意外だったけど、やっぱすげーな、Matrix。しかし、Matrix より、サンプル プロジェクトを作る方が時間かかった(爆) 2つのコントロール間ので値を相互的な連動とか。今更ながら、DataBindingsにチャレンジ出来たのは良い機会だった。しかし、色の画面表示用にPanel使ってみたけどTabStop出来なかったので、そっちの方法とかもいずれ調べてみたい。</p>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<ul>
<li><p>【.NET】カラー行列(ColorMatrix)で画像のRGBの値を調整する - CommentOut?<br>
<a href="http://www.r-nakai.com/archives/30" class="autolink" rel="nofollow noopener" target="_blank">http://www.r-nakai.com/archives/30</a></p></li>
<li><p>ColorMatrixによる色の変換 - C# - hesperus.net<br>
<a href="https://www.hesperus.net/csharp/color_matrix.aspx" class="autolink" rel="nofollow noopener" target="_blank">https://www.hesperus.net/csharp/color_matrix.aspx</a></p></li>
<li><p>ColorMatrix クラス (System.Drawing.Imaging) | Microsoft Docs<br><br>
<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5</a></p></li>
<li><p>ImageAttributes.SetColorMatrix メソッド (System.Drawing.Imaging) | Microsoft Docs<br>
<a href="https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.imageattributes.setcolormatrix?view=netframework-4.5" class="autolink" rel="nofollow noopener" target="_blank">https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.imageattributes.setcolormatrix?view=netframework-4.5</a></p></li>
<li><p>コントロールのデータ連結機能(Control.DataBindings, Binding, データバインディング) - いろいろ備忘録日記<br>
<a href="https://devlights.hatenablog.com/entry/20070413/p1" class="autolink" rel="nofollow noopener" target="_blank">https://devlights.hatenablog.com/entry/20070413/p1</a></p></li>
<li><p>Data Binding With INotifyPropertyChanged Interface<br>
<a href="https://www.c-sharpcorner.com/UploadFile/020f8f/data-binding-with-inotifypropertychanged-interface/" class="autolink" rel="nofollow noopener" target="_blank">https://www.c-sharpcorner.com/UploadFile/020f8f/data-binding-with-inotifypropertychanged-interface/</a></p></li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Flibraplanet%2Fitems%2Fbb4df396f21a5dbfa445&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Flibraplanet%2Fitems%2Fbb4df396f21a5dbfa445&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/libraplanet/items/bb4df396f21a5dbfa445/likers" class="css-1iupg5d">1</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">0</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/bb4df396f21a5dbfa445/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/libraplanet/items/bb4df396f21a5dbfa445/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/libraplanet/items/bb4df396f21a5dbfa445/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/libraplanet/items/bb4df396f21a5dbfa445/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/libraplanet/items/bb4df396f21a5dbfa445.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-3907accd-bcaa-4437-80c6-ca47bc8017fd">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-f239f61f-d966-48db-b4da-8fa460d2c6cf"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-f239f61f-d966-48db-b4da-8fa460d2c6cf">{}</script>
      
<div id="LoginModal-react-component-9a0d7920-81bf-4800-a414-29817447ef62"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-9a0d7920-81bf-4800-a414-29817447ef62">{}</script>
      
<div id="StockModal-react-component-b0b4d5a3-dfba-4b18-b69e-e51591a44a44"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-b0b4d5a3-dfba-4b18-b69e-e51591a44a44">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;idbbV8eg59tDMkZgEz1ElAP3iZ+bxqcnCKvPYWmWot05LzYTm5OIOujTDr2+/Er2CqO71tef7c15ZMODn5i8Wg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"概要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e概要\u003c/h1\u003e\n\n\u003cp\u003e以前、\u003ca href=\"https://qiita.com/libraplanet/items/a5c8a313a1f7e7bbc86a\" id=\"reference-ba32123656272d8f8569\"\u003eこちらの記事\u003c/a\u003e で \u003cstrong\u003eオーバーレイ(風)\u003c/strong\u003e にチャレンジしたのだけど。今回は \u003ccode\u003eColorMatrix\u003c/code\u003e を利用して \u003ccode\u003eオーバーレイ\u003c/code\u003e に再チャレンジ。前回の \u003cstrong\u003e(風)\u003c/strong\u003e とは違い、今回はちゃんと望み動きが出来た。\u003c/p\u003e\n\n\u003cp\u003eどちらかというと数学寄りの話。といっても私もにわかなので、そんなに難しくない話。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"カラー-オーバーレイ-とは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AB%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4-%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eカラー オーバーレイ\u003c/code\u003e とは？\u003c/h1\u003e\n\n\u003cp\u003ePhotoshopの \u003ccode\u003eレイヤー効果\u003c/code\u003e でおなじみ(？)のやつ。\u003cbr\u003e\nレイヤーの描画ピクセルの色情報を任意の色に上書きするやつ。\u003cbr\u003e\n私はよくレイヤーの描画モードを \u003ccode\u003eスクリーン\u003c/code\u003e にした単色レイヤーを重ね合わせえて色味調整を行うことがよくあるのだけど。\u003ccode\u003eカラー オーバーレイ\u003c/code\u003e だとカラーピッカーで選択中の色がリアルタイムで反映されるので、 \u003ccode\u003eスクリーン\u003c/code\u003e レイヤーの色味調整でよく使ってる。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e15b1f8b3d3489c6e9f8f5a8458bcc2901c8ddfd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f36393935626638302d373430342d326230662d303761382d6665646134643566623865322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F6995bf80-7404-2b0f-07a8-feda4d5fb8e2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=47b3cd87323c862ece1b5a65795d0e47\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/6995bf80-7404-2b0f-07a8-feda4d5fb8e2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F6995bf80-7404-2b0f-07a8-feda4d5fb8e2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bf4d670a9536dc3d686fe446613f045b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"カーラー-オーバーレイを行うための行列\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AB%E3%83%BC%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4%E3%82%92%E8%A1%8C%E3%81%86%E3%81%9F%E3%82%81%E3%81%AE%E8%A1%8C%E5%88%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eカーラー オーバーレイを行うための行列\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003eColorMatrix\u003c/code\u003e は \u003ccode\u003e行列(Matrix)\u003c/code\u003e を使って色味を調整する。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eColorMatrixによる色の変換 - C# - hesperus.net\u003cbr\u003e\n\u003ca href=\"https://www.hesperus.net/csharp/color_matrix.aspx\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.hesperus.net/csharp/color_matrix.aspx\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eまず早速、その \u003ccode\u003e行列\u003c/code\u003e のための配列。\u003c/p\u003e\n\n\u003cp\u003eジャグ配列... (´・ω・｀)\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"通常\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%80%9A%E5%B8%B8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e通常\u003c/h2\u003e\n\n\u003cp\u003eシンプルに指定色に置き換える。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecolor overlay.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eColorMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[][]{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e    \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e    \u003cspan class=\"n\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e    \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"指定色のアルファを加味する場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%8C%87%E5%AE%9A%E8%89%B2%E3%81%AE%E3%82%A2%E3%83%AB%E3%83%95%E3%82%A1%E3%82%92%E5%8A%A0%E5%91%B3%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e指定色のアルファを加味する場合\u003c/h2\u003e\n\n\u003cp\u003eアルファによって、オーバーレイを加減をする。\u003cbr\u003e\n(適応量を線形補間。)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e0.0の時は塗りつぶしが行われない。\u003c/li\u003e\n\u003cli\u003e1.0の時はで完全塗りつぶし。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecolor overlay + a.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eColorMatrix\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[][]{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e[]{\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eg\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1.0f\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"表示例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A1%A8%E7%A4%BA%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e表示例\u003c/h1\u003e\n\n\u003cp\u003e参考のイラストは、Pixivでは18年齢制限の制限がついてしまっているので、本記事では一応何となく一部にモザイクをかけております (苦笑)。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サンプル-プロジェクト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサンプル プロジェクト\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003elibraplanet / coloroverlaycs — Bitbucket\u003cbr\u003e\n\u003ca href=\"https://bitbucket.org/libraplanet/coloroverlaycs/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://bitbucket.org/libraplanet/coloroverlaycs/\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"単色でのカラー-オーバーレイ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8D%98%E8%89%B2%E3%81%A7%E3%81%AE%E3%82%AB%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e単色でのカラー オーバーレイ\u003c/h2\u003e\n\n\u003cp\u003e単純に黒で塗りつぶし。\u003cbr\u003e\n(人によっては背景が透明に見える)\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/a3ea0212f21320fd709be938523a543134007fc9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f30646332653264632d383030662d383939612d313537332d3561383338303837333430642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F0dc2e2dc-800f-899a-1573-5a838087340d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a8fe0fe49d38cddff440464e6a3c0f63\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/0dc2e2dc-800f-899a-1573-5a838087340d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F0dc2e2dc-800f-899a-1573-5a838087340d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7273ad23b7d906216da5d40dded28ceb 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/8e58e06c2db735677b4d9cc6cb18fb3f018be4ce/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f37313364663933322d333263632d373965312d313135332d6461336265363065376239362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F713df932-32cc-79e1-1153-da3be60e7b96.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ef5934b27d6ffdde5c47dc4030ed659d\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/713df932-32cc-79e1-1153-da3be60e7b96.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F713df932-32cc-79e1-1153-da3be60e7b96.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=63476558697dcc84738b8dd5811deee9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"-α\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-%CE%B1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e+ α\u003c/h2\u003e\n\n\u003cp\u003e色に透明度(α)も追加。\u003cbr\u003e\n※ \u003ccode\u003eアルファ ブレンディング (加算)\u003c/code\u003e ではない。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/a26bb4666b779ad1d5a9affe3424feeb10d06107/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f35343239663565632d653639362d643763632d373061622d3064373835376366373064652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F5429f5ec-e696-d7cc-70ab-0d7857cf70de.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=50a76f897778595ef9b437790fc8a4f8\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/5429f5ec-e696-d7cc-70ab-0d7857cf70de.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F5429f5ec-e696-d7cc-70ab-0d7857cf70de.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=928c12e1ea35263d7b208d3f12d0d11b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/ea2fa18db510db64612a99219539ae473fdac200/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f34353361323130382d323665332d653065642d396362342d3634306564326261303565312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F453a2108-26e3-e0ed-9cb4-640ed2ba05e1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8a6e5fbd116d5454093d7861144db72c\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/453a2108-26e3-e0ed-9cb4-640ed2ba05e1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F453a2108-26e3-e0ed-9cb4-640ed2ba05e1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=93db4bc2595247dba75401eac6d1832d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"おまけパターン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%81%BE%E3%81%91%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおまけパターン\u003c/h2\u003e\n\n\u003cp\u003e絵も背景も単色で塗りつぶし。\u003cbr\u003e\nなんか、一昔の \u003cdel\u003eエロゲ\u003c/del\u003e ゲームの 立ち絵 + とアルファ チャンネルみたい (苦笑)\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/74d6376e3c552cce8b24482e2c2a82b525725f6f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f34623438653664382d636630662d643765302d353165642d6137616134356530636238382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F4b48e6d8-cf0f-d7e0-51ed-a7aa45e0cb88.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c609c20d1347138e3f80b427fe69e44d\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/4b48e6d8-cf0f-d7e0-51ed-a7aa45e0cb88.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2F4b48e6d8-cf0f-d7e0-51ed-a7aa45e0cb88.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8e88e2a8187ba30644f3c0d44be427c2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/614cffc0d8321cfec5358985eaa1e60b580553d2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f37323235372f64636363333164612d313834372d366134312d383232302d6265353966333439303664332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2Fdccc31da-1847-6a41-8220-be59f34906d3.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c8234e0bf55987debbb870aaf50b2854\" alt=\"SS.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/72257/dccc31da-1847-6a41-8220-be59f34906d3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F72257%2Fdccc31da-1847-6a41-8220-be59f34906d3.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5591fb402d68e1fb6f2132a8e88a3c3e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"解説\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"行列-matrix-とは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A1%8C%E5%88%97-matrix-%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e行列 (Matrix) とは\u003c/h2\u003e\n\n\u003cp\u003e高校数学あたりでやる、あの行列。行列演算は3Dなどで大変活用されており、機械学習など様々に応用されているので、最早言わずもがな、というくらい。\u003c/p\u003e\n\n\u003cp\u003eこんな計算するやつ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{bmatrix}\nx \u0026amp; y \\\\\n\\end{bmatrix}\n\\times\n\\begin{bmatrix}\na \u0026amp; b \u0026amp; c\\\\\nd \u0026amp; e \u0026amp; f\\\\\n\\end{bmatrix}\n= \n\\begin{bmatrix}\n\\Bigr((x \\times a) + (y \\times d)\\Bigr) \u0026amp; \\Bigr((x \\times b) + (y \\times e)\\Bigr) \u0026amp; \\Bigr((x \\times c) + (y \\times f)\\Bigr)\\\\\n\\end{bmatrix}\\\\\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e例えば3Dの場合、行列1つの4x4の行列で、\u003ccode\u003e回転情報 (Rotatioin)\u003c/code\u003e、\u003ccode\u003e拡縮情報 (Scale)\u003c/code\u003e、\u003ccode\u003e平行移動情報 (Translation)\u003c/code\u003e を持つことができ、座標情報(Vector) や 他の行列 と掛け合わせることで、\u003ccode\u003e頂点座標を変換\u003c/code\u003eしたり、 \u003ccode\u003e回転情報を伝播\u003c/code\u003e したりなと、多様される。正直、当時は何となく習っただけの内容だけど、3Dで再会したときの衝撃はびっくりした。\u003ccode\u003eCSS Transform 3D\u003c/code\u003e も基礎は全く同じなので、ほんと行列すごい。\u003c/p\u003e\n\n\u003cp\u003e今回の \u003ccode\u003eColorMatrix\u003c/code\u003e では色情報を変換するのフィルターとして行列演算が使われている感じ。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"colormatrixでは5x5の正方行列を使う\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#colormatrix%E3%81%A7%E3%81%AF5x5%E3%81%AE%E6%AD%A3%E6%96%B9%E8%A1%8C%E5%88%97%E3%82%92%E4%BD%BF%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eColorMatrixでは5x5の正方行列を使う\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eColorMatrix クラス (System.Drawing.Imaging) | Microsoft Docs\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eより。入出力とフィルターとなるMatrixでの計算式はこんな感じ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{bmatrix}\nR \u0026amp; G \u0026amp; B \u0026amp; A \u0026amp; W \\\\\n\\end{bmatrix}\n\\times\n\\begin{bmatrix}\nRr \u0026amp; Gr \u0026amp; Br \u0026amp; Ar \u0026amp; Wr \\\\\nRg \u0026amp; Gg \u0026amp; Bg \u0026amp; Ag \u0026amp; Wg \\\\\nRb \u0026amp; Gb \u0026amp; Bb \u0026amp; Ab \u0026amp; Wb \\\\\nRa \u0026amp; Ga \u0026amp; Ba \u0026amp; Aa \u0026amp; Wa \\\\\nRw \u0026amp; Gw \u0026amp; Bw \u0026amp; Aw \u0026amp; Ww \\\\\n\\end{bmatrix}\n= \n\\begin{bmatrix}\nR' \u0026amp; G' \u0026amp; B' \u0026amp; A' \u0026amp; W' \\\\\n\\end{bmatrix}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\nR' \u0026amp;= (R * Rr) + (G * Rg) + (B * Rb) + (A * Ra)  + (W * Rw) \\\\\nG' \u0026amp;= (R * Gr) + (G * Gg) + (B * Gb) + (A * Ga)  + (W * Gw) \\\\\nB' \u0026amp;= (R * Br) + (G * Bg) + (B * Bb) + (A * Ba)  + (W * Bw) \\\\\nA' \u0026amp;= (R * Ar) + (G * Ag) + (B * Ab) + (A * Aa)  + (W * Aw) \\\\\nW' \u0026amp;= (R * Wr) + (G * Wg) + (B * Wb) + (A * Wa)  + (W * Ww) \\\\\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e入力パラメータが \u003cstrong\u003e要素数5\u003c/strong\u003e の \u003ccode\u003e5次元ベクトル\u003c/code\u003e なので、行列は \u003ccode\u003e5x5の正方行列\u003c/code\u003e が利用される。これを使って色味の調整ができる。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"単位行列-何しない行列\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8D%98%E4%BD%8D%E8%A1%8C%E5%88%97-%E4%BD%95%E3%81%97%E3%81%AA%E3%81%84%E8%A1%8C%E5%88%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e単位行列 (何しない行列)\u003c/h3\u003e\n\n\u003cp\u003e正方行列で主対角線上の要素が1で、他が0のベクトルは \u003ccode\u003e単位行列\u003c/code\u003e と呼ばれる。細かい条件はあると思うが、今回の様にベクトルの次元数(要素数)と同じ行数・列数を持つ \u003ccode\u003e正方行列\u003c/code\u003e の場合、 \u003ccode\u003e単位行列\u003c/code\u003e との積の場合、同じ値が得られる。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e単位行列 = \n\\begin{bmatrix}\n\\color{red}{1} \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\\\\n0 \u0026amp; \\color{red}{1} \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\\\\n0 \u0026amp; 0 \u0026amp; \\color{red}{1} \u0026amp; 0 \u0026amp; 0 \\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; \\color{red}{1} \u0026amp; 0 \\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; \\color{red}{1} \\\\\n\\end{bmatrix}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\nベクトルV \\times 単位行列 \u0026amp;= ベクトルV (値が変わらない) \\\\\n行列M \\times 単位行列 \u0026amp;= 行列M (値が変わらない) \\\\\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e一応確認。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{bmatrix}\nR \u0026amp; G \u0026amp; B \u0026amp; A \u0026amp; W \\\\\n\\end{bmatrix}\n\\times\n\\begin{bmatrix}\n\\color{red}{1} \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\\\\n0 \u0026amp; \\color{red}{1} \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\\\\n0 \u0026amp; 0 \u0026amp; \\color{red}{1} \u0026amp; 0 \u0026amp; 0 \\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; \\color{red}{1} \u0026amp; 0 \\\\\n0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; \\color{red}{1} \\\\\n\\end{bmatrix}\n= \n\\begin{bmatrix}\nR' \u0026amp; G' \u0026amp; B' \u0026amp; A' \u0026amp; W' \\\\\n\\end{bmatrix}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\nR' \u0026amp;= (R * \\color{red}{1}) + (G * 0) + (B * 0) + (A * 0)  + (W * 0) = R \\\\\nG' \u0026amp;= (R * 0) + (G * \\color{red}{1}) + (B * 0) + (A * 0)  + (W * 0) = G \\\\\nB' \u0026amp;= (R * 0) + (G * 0) + (B * \\color{red}{1}) + (A * 0)  + (W * 0) = B \\\\\nA' \u0026amp;= (R * 0) + (G * 0) + (B * 0) + (A * \\color{red}{1})  + (W * 0) = A \\\\\nW' \u0026amp;= (R * 0) + (G * 0) + (B * 0) + (A * 0)  + (W * \\color{red}{1}) = W \\\\\n\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eほんとだ！\u003cbr\u003e\nだいたいここから値を変えながら色々と試行していく。\u003c/p\u003e\n\n\u003cp\u003e※ ちなみに、行列は \u003ccode\u003e交換法則\u003c/code\u003e は成り立たないが、単位行列との積については \u003ccode\u003e交換法則\u003c/code\u003e は成り立たつらしい。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"入力値-w1-で任意の値に置換する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%A5%E5%8A%9B%E5%80%A4-w1-%E3%81%A7%E4%BB%BB%E6%84%8F%E3%81%AE%E5%80%A4%E3%81%AB%E7%BD%AE%E6%8F%9B%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e入力値 『W(1)』 で任意の値に置換する。\u003c/h3\u003e\n\n\u003cp\u003e今回の主役。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eColorMatrix クラス (System.Drawing.Imaging) | Microsoft Docs\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e行列係数は、ARGB 同種値の変換に使用される 5 x 5 線形変換を構成します。 たとえば、ARGB ベクターは、赤、緑、青、アルファ、w として表されます。 w は常に1です。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eMSの説明をみて、なんのコッチャ？と思った人少なくないのでは、と思う。\u003c/p\u003e\n\n\u003cp\u003e行列の積では基本は乗算のため、ARGB値に係数を掛け合わせるだけでは、特定の値に置き換えることが出来ない。しかし、\u003ccode\u003eWには固定値 1\u003c/code\u003e がくるのでWで任意の値を作ることが可能。更に 　\u003ccode\u003e他の係数を 0\u003c/code\u003e にすれば元の値を潰せるので、置き換えることができる。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eColorMatrix\u003c/code\u003e は色情報を \u003ccode\u003e0.0～1.0\u003c/code\u003e で表現するため、 \u003ccode\u003ergb(229,153,76)\u003cspan class=\"inline-code-color\" style=\"background-color: rgb(229,153,76);\"\u003e\u003c/span\u003e\u003c/code\u003e に置き換える場合。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\nR \u0026amp;= 229 \\div 255 \u0026amp;= 0.8980... \u0026amp;\\fallingdotseq \\color{red}{0.9} \\\\\nG \u0026amp;= 153 \\div 255 \u0026amp;\u0026amp;= \\color{red}{0.6} \\\\\nB \u0026amp;= 76  \\div 255 \u0026amp;= 0.2980... \u0026amp;\\fallingdotseq \\color{red}{0.3} \\\\\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{bmatrix}\nR \u0026amp; G \u0026amp; B \u0026amp; A \u0026amp; \\color{red}{1} \\\\\n\\end{bmatrix}\n\\times\n\\begin{bmatrix}\n0.0 \u0026amp; 0.0 \u0026amp; 0.0 \u0026amp; 0.0 \u0026amp; 0.0 \\\\\n0.0 \u0026amp; 0.0 \u0026amp; 0.0 \u0026amp; 0.0 \u0026amp; 0.0 \\\\\n0.0 \u0026amp; 0.0 \u0026amp; 0.0 \u0026amp; 0.0 \u0026amp; 0.0 \\\\\n0.0 \u0026amp; 0.0 \u0026amp; 0.0 \u0026amp; \\color{red}{1.0} \u0026amp; 0.0 \\\\\n\\color{red}{0.9} \u0026amp; \\color{red}{0.6} \u0026amp; \\color{red}{0.3} \u0026amp; 0.0 \u0026amp; 0.0 \\\\\n\\end{bmatrix}\n= \n\\begin{bmatrix}\n\\color{red}{0.9} \u0026amp; \\color{red}{0.6} \u0026amp; \\color{red}{0.3} \u0026amp; \\color{red}{A} \u0026amp; W' \\\\\n\\end{bmatrix}\n\\\\\n\\\\\n\\begin{align}\nR' \u0026amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * 0.0)  + (\\color{red}{W} * \\color{red}{0.9}) = \\color{red}{0.9} (置換) \\\\\nG' \u0026amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * 0.0)  + (\\color{red}{W} * \\color{red}{0.6}) = \\color{red}{0.6} (置換) \\\\\nB' \u0026amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * 0.0)  + (\\color{red}{W} * \\color{red}{0.3}) = \\color{red}{0.3} (置換) \\\\\nA' \u0026amp;= (R * 0.0) + (G * 0.0) + (B * 0.0) + (A * \\color{red}{1.0})  + (W * 0.0) = \\color{red}{A} (通過) \\\\\nW' \u0026amp;= \\color{gray}{(捨てられるので省略)}\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eという計算式で置き換えることができる。\u003cbr\u003e\n\u003ccode\u003eW\u003c/code\u003e ありがてぇ。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"おまけ-正方行列の理由\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%81%BE%E3%81%91-%E6%AD%A3%E6%96%B9%E8%A1%8C%E5%88%97%E3%81%AE%E7%90%86%E7%94%B1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e(おまけ) 正方行列の理由\u003c/h3\u003e\n\n\u003cp\u003e前述で一部省略はしているが、 \u003ccode\u003e出力 W'\u003c/code\u003e は使われない。入力で\u003ccode\u003e(R G B A W)\u003c/code\u003eの \u003cstrong\u003e5次元ベクトル\u003c/strong\u003e のため、行列は \u003cstrong\u003e5行\u003c/strong\u003e 必要だが、出力は \u003ccode\u003e(R' G' B' A')\u003c/code\u003e の \u003cstrong\u003e4次元ベクトル\u003c/strong\u003e のため、行列は \u003cstrong\u003e4列\u003c/strong\u003e で十分だったりする。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{bmatrix}\nR \u0026amp; G \u0026amp; B \u0026amp; A \u0026amp; W \\\\\n\\end{bmatrix}\n\\times\n\\begin{bmatrix}\nRr \u0026amp; Gr \u0026amp; Br \u0026amp; Ar \u0026amp; \\color{red}{(Wr)} \\\\\nRg \u0026amp; Gg \u0026amp; Bg \u0026amp; Ag \u0026amp; \\color{red}{(Wg)} \\\\\nRb \u0026amp; Gb \u0026amp; Bb \u0026amp; Ab \u0026amp; \\color{red}{(Wb)} \\\\\nRa \u0026amp; Ga \u0026amp; Ba \u0026amp; Aa \u0026amp; \\color{red}{(Wa)} \\\\\nRw \u0026amp; Gw \u0026amp; Bw \u0026amp; Aw \u0026amp; \\color{red}{(Ww)} \\\\\n\\end{bmatrix}\n= \n\\begin{bmatrix}\nR' \u0026amp; G' \u0026amp; B' \u0026amp; A' \u0026amp; \\color{red}{(W')}\\\\\n\\end{bmatrix}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cimg alt=\":thinking:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f914.png\" title=\":thinking:\" width=\"20\" loading=\"lazy\"\u003e W’無駄じゃね？\u003c/p\u003e\n\n\u003cp\u003eしかし、\u003ccode\u003e正方行列\u003c/code\u003e であることに利点がある様で、\u003cstrong\u003e多少無駄な計算をさせても、作業のしやすさを取った\u003c/strong\u003e 形だと考えている。3Dでも \u003ccode\u003e4x4の正方行列\u003c/code\u003e が一般的に使われるけど、最後の列が不要らしい。\u003ccode\u003e4x3の行列\u003c/code\u003e の3Dエンジンのゲーム機もあった。(今はどうしているかわからないけど。流石に正方行列の波に飲まれていると予想)。行列演算だと \u003ccode\u003e単位行列\u003c/code\u003e、 \u003ccode\u003e逆行列\u003c/code\u003e、 \u003ccode\u003e行列の積\u003c/code\u003e などで、沢山の行列同士を計算する上で、\u003ccode\u003e正方行列\u003c/code\u003e のほうが確かに都合が良さそうなので。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"感想\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%84%9F%E6%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e感想\u003c/h1\u003e\n\n\u003cp\u003e満足の行くカラー オーバーレイがGDI+で出来てよかった。\u003ccode\u003eMatrix (行列)\u003c/code\u003eを使うのは意外だったけど、やっぱすげーな、Matrix。しかし、Matrix より、サンプル プロジェクトを作る方が時間かかった(爆) 2つのコントロール間ので値を相互的な連動とか。今更ながら、DataBindingsにチャレンジ出来たのは良い機会だった。しかし、色の画面表示用にPanel使ってみたけどTabStop出来なかったので、そっちの方法とかもいずれ調べてみたい。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e【.NET】カラー行列(ColorMatrix)で画像のRGBの値を調整する - CommentOut?\u003cbr\u003e\n\u003ca href=\"http://www.r-nakai.com/archives/30\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://www.r-nakai.com/archives/30\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eColorMatrixによる色の変換 - C# - hesperus.net\u003cbr\u003e\n\u003ca href=\"https://www.hesperus.net/csharp/color_matrix.aspx\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.hesperus.net/csharp/color_matrix.aspx\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eColorMatrix クラス (System.Drawing.Imaging) | Microsoft Docs\u003cbr\u003e\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.colormatrix?view=netframework-4.5\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eImageAttributes.SetColorMatrix メソッド (System.Drawing.Imaging) | Microsoft Docs\u003cbr\u003e\n\u003ca href=\"https://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.imageattributes.setcolormatrix?view=netframework-4.5\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://docs.microsoft.com/ja-jp/dotnet/api/system.drawing.imaging.imageattributes.setcolormatrix?view=netframework-4.5\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eコントロールのデータ連結機能(Control.DataBindings, Binding, データバインディング) - いろいろ備忘録日記\u003cbr\u003e\n\u003ca href=\"https://devlights.hatenablog.com/entry/20070413/p1\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://devlights.hatenablog.com/entry/20070413/p1\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eData Binding With INotifyPropertyChanged Interface\u003cbr\u003e\n\u003ca href=\"https://www.c-sharpcorner.com/UploadFile/020f8f/data-binding-with-inotifypropertychanged-interface/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.c-sharpcorner.com/UploadFile/020f8f/data-binding-with-inotifypropertychanged-interface/\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2020-08-31T01:13:01Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"Bz2viuCoA1PUmWao7clU0+Jc9Vj8t3JiGg==--ml5WOKspW4pmckQs--1+m4UkkuG+rMNSj6gy6Tzg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-09-02T14:13:54Z","likesCount":1,"linkUrl":"https://qiita.com/libraplanet/items/bb4df396f21a5dbfa445","organization":null,"originalId":1291445,"stockedCount":0,"title":"【C#】 GDI+でカラー オーバーレイ (ColorMatrixでリベンジ)","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e概要\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AB%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4-%E3%81%A8%E3%81%AF\"\u003eカラー オーバーレイ とは？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AB%E3%83%BC%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4%E3%82%92%E8%A1%8C%E3%81%86%E3%81%9F%E3%82%81%E3%81%AE%E8%A1%8C%E5%88%97\"\u003eカーラー オーバーレイを行うための行列\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%80%9A%E5%B8%B8\"\u003e通常\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%8C%87%E5%AE%9A%E8%89%B2%E3%81%AE%E3%82%A2%E3%83%AB%E3%83%95%E3%82%A1%E3%82%92%E5%8A%A0%E5%91%B3%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88\"\u003e指定色のアルファを加味する場合\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A1%A8%E7%A4%BA%E4%BE%8B\"\u003e表示例\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88\"\u003eサンプル プロジェクト\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8D%98%E8%89%B2%E3%81%A7%E3%81%AE%E3%82%AB%E3%83%A9%E3%83%BC-%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4\"\u003e単色でのカラー オーバーレイ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#-%CE%B1\"\u003e+ α\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%81%BE%E3%81%91%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003eおまけパターン\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A7%A3%E8%AA%AC\"\u003e解説\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A1%8C%E5%88%97-matrix-%E3%81%A8%E3%81%AF\"\u003e行列 (Matrix) とは\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#colormatrix%E3%81%A7%E3%81%AF5x5%E3%81%AE%E6%AD%A3%E6%96%B9%E8%A1%8C%E5%88%97%E3%82%92%E4%BD%BF%E3%81%86\"\u003eColorMatrixでは5x5の正方行列を使う\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8D%98%E4%BD%8D%E8%A1%8C%E5%88%97-%E4%BD%95%E3%81%97%E3%81%AA%E3%81%84%E8%A1%8C%E5%88%97\"\u003e単位行列 (何しない行列)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%A5%E5%8A%9B%E5%80%A4-w1-%E3%81%A7%E4%BB%BB%E6%84%8F%E3%81%AE%E5%80%A4%E3%81%AB%E7%BD%AE%E6%8F%9B%E3%81%99%E3%82%8B\"\u003e入力値 『W(1)』 で任意の値に置換する。\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%81%BE%E3%81%91-%E6%AD%A3%E6%96%B9%E8%A1%8C%E5%88%97%E3%81%AE%E7%90%86%E7%94%B1\"\u003e(おまけ) 正方行列の理由\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%84%9F%E6%83%B3\"\u003e感想\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":691,"uuid":"bb4df396f21a5dbfa445","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"jeRDYrr0lsrchOJDhW8ERrprx/8=--RhCJDjsTJXYhl1Rt--VMehBXB704tWHIm9p4g9sA==","originalId":72257,"description":"","facebookUrl":null,"githubUrl":"https://github.com/libraplanet","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/72257/e381e2f4dd7851e2a001bfbed66153a131d5e78b/x_large.png?1598304169","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F72257%2Fe381e2f4dd7851e2a001bfbed66153a131d5e78b%2Fx_large.png%3F1598304169?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=4b2e0d9f9a7bd97f8b438c91caa6c265","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F72257%2Fe381e2f4dd7851e2a001bfbed66153a131d5e78b%2Fx_large.png%3F1598304169?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=d426188a19b67fbd8a5ed5d14dbfe64d","urlName":"libraplanet","websiteUrl":null,"twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":".NET","urlName":".net"},{"name":"画像処理","urlName":"%e7%94%bb%e5%83%8f%e5%87%a6%e7%90%86"},{"name":"GDI+","urlName":"gdi%2b"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
