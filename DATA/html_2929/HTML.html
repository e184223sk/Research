<!DOCTYPE html><html><head><meta charset="utf-8" /><title>Unityでテストコードを書いて会得した最強のTips(苦肉の策ともいう) - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="sruY8iBuKXIaXofR6cLuhsxEwM2ck+9LFU6SLf6A58kQ+NnA4yNg6PKirbJ04DJdnFsXyWUHZGIct/E94U7Jmw==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@yukiarrr" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="Unityでテストコードを書いて会得した最強のTips(苦肉の策ともいう) - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhuamdhZmpnNGJqZ3Juamc0ampnclBqZzd6amc0bmpncExtbTdqamdZVGpnYWJrdkpybHZwZmpnWmZqZ1pfbW5JRGx2TGZqZ2E1VWFYQnpLT2lMcHVpQ2llT0JydWV0bHVPQnFPT0NndU9CaE9PQmhpayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz00NjllZGFmZjU4MGJmNWRhZTAzOTJlZjMyNDI2OWQ4MQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGwxYTJsaGNuSnkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz00ZWJkNWZiYWJlY2I0NTgxZGVmM2Y4NzZhMWVlMmI4Yw&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=99352d44f65d2b8bebb2243d46815740"><meta property="og:description" content="

最強のTips(苦肉の策)が生まれるきっかけ

自分が現在開発に携わっているゲームでは、作中に多くのシナリオが含まれています。
その数はデータにして200を超えていますが、このデータが増えるにつれて、ある問題が発生しました。

そ..."><meta content="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="test,C#,テスト,Unity,UnityTestRunner" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-35916fbb-bcfc-4e82-bda4-5970b12241e4"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fyukiarrr%2Fitems%2Ffe3a97d38a4473f5c8c2">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fyukiarrr%2Fitems%2Ffe3a97d38a4473f5c8c2">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-35916fbb-bcfc-4e82-bda4-5970b12241e4">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/test","name":"test"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-08-20T13:06:48.000+09:00","dateModified":"2019-08-21T00:45:52.000+09:00","headline":"Unityでテストコードを書いて会得した最強のTips(苦肉の策ともいう)","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVzVwZEhuamdhZmpnNGJqZ3Juamc0ampnclBqZzd6amc0bmpncExtbTdqamdZVGpnYWJrdkpybHZwZmpnWmZqZ1pfbW5JRGx2TGZqZ2E1VWFYQnpLT2lMcHVpQ2llT0JydWV0bHVPQnFPT0NndU9CaE9PQmhpayZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz00NjllZGFmZjU4MGJmNWRhZTAzOTJlZjMyNDI2OWQ4MQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSGwxYTJsaGNuSnkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz00ZWJkNWZiYWJlY2I0NTgxZGVmM2Y4NzZhMWVlMmI4Yw\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=99352d44f65d2b8bebb2243d46815740","mainEntityOfPage":"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2","author":{"@type":"Person","address":null,"email":null,"identifier":"yukiarrr","name":"yukiarrr","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F253997%2F762bfdd40a2cc135b89eb6140334223144d4f5f9%2Flarge.png%3F1573562503?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=54095ac4d77bef3e69d6266243ade629","url":"https://qiita.com/yukiarrr","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita&amp;utm_medium=header-banner">クラウド型AI-OCRの技術者が語る、研究開発寄りのプロダクト開発のやりがい</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yukiarrr","type":"items","id":"fe3a97d38a4473f5c8c2"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"クラウド型AI-OCRの技術者が語る、研究開発寄りのプロダクト開発のやりがい","url":"https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yukiarrr","type":"items","id":"fe3a97d38a4473f5c8c2"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"クラウド型AI-OCRの技術者が語る、研究開発寄りのプロダクト開発のやりがい","url":"https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"yukiarrr","type":"items","id":"fe3a97d38a4473f5c8c2"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"クラウド型AI-OCRの技術者が語る、研究開発寄りのプロダクト開発のやりがい","url":"https://zine.qiita.com/interview/202107-hitachi/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2","location":"/yukiarrr/items/fe3a97d38a4473f5c8c2","scheme":"https","host":"qiita.com","port":null,"pathname":"/yukiarrr/items/fe3a97d38a4473f5c8c2","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"BDkFzI1UHvdUSk+n+wb9lnDDf7EQjEZNTR3ot4NmTWSmekT+ThlXbby2ZcRmJCFNINyotekYzWRE5IunnKhjNg==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-c1488567-56b0-49d4-9b39-f927831c0832"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/likers" class="css-1iupg5d">23</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">26</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/fe3a97d38a4473f5c8c2/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/yukiarrr"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/253997/762bfdd40a2cc135b89eb6140334223144d4f5f9/large.png?1573562503" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/yukiarrr" class="css-10ougpm">@<!-- -->yukiarrr</a><div class="css-1ay9vb9"><span><meta content="2019-08-20T04:06:48Z"/><time dateTime="2019-08-20T15:45:52Z" class="css-m19uds">updated at 2019-08-20</time></span></div></div></div></div></div><h1 class="css-cgzq40">Unityでテストコードを書いて会得した最強のTips(苦肉の策ともいう)</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/test" class="css-4czcte">test</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e3%83%86%e3%82%b9%e3%83%88" class="css-4czcte">テスト</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/unitytestrunner" class="css-4czcte">UnityTestRunner</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="最強のtips苦肉の策が生まれるきっかけ" class="fragment"></span><a href="#%E6%9C%80%E5%BC%B7%E3%81%AEtips%E8%8B%A6%E8%82%89%E3%81%AE%E7%AD%96%E3%81%8C%E7%94%9F%E3%81%BE%E3%82%8C%E3%82%8B%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91"><i class="fa fa-link"></i></a><ruby>最強のTips<rp>(</rp><rt>苦肉の策</rt><rp>)</rp></ruby>が生まれるきっかけ</h1>

<p>自分が現在開発に携わっているゲームでは、作中に多くのシナリオが含まれています。<br>
その数はデータにして200を超えていますが、このデータが増えるにつれて、ある問題が発生しました。</p>

<p>それは、<strong>シナリオデータの数が多すぎて、不具合のあるデータがあることに気付けない</strong>ということです。<br>
（特定の選択肢を選ぶと、進行不能になるデータがいくつか見られました）</p>

<p>これに対処するため、<strong>「全シナリオの動作チェックを行うUIのテストコードを書こう！」</strong>と思ったのが、事の始まりです。</p>

<p>まさか、あんな苦肉の策を取ることになるとは、この時は考えてもいませんでした…</p>

<h1>
<span id="目次tips一覧" class="fragment"></span><a href="#%E7%9B%AE%E6%AC%A1tips%E4%B8%80%E8%A6%A7"><i class="fa fa-link"></i></a>目次（Tips一覧）</h1>

<p>自分がテストコードを書いて会得したTipsを紹介します。</p>

<p>ちなみに、<ruby>最強のTips<rp>(</rp><rt>苦肉の策</rt><rp>)</rp></ruby>は「<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B">6. テストの失敗が後続のテストにまで影響を与えないようにする</a>」です。<br>
それ以外は、まとも（のはず…）なTipsになります。</p>

<p><a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#1-play-mode%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E4%BD%BF%E3%81%86attribute%E3%81%A8%E3%81%9D%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9">1. Play Modeテストで使うAttributeとその注意点</a><br>
<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#2-%E3%83%86%E3%82%B9%E3%83%88%E6%99%82%E9%96%93%E3%82%92%E7%9F%AD%E7%B8%AE%E3%81%99%E3%82%8B">2. テスト時間を短縮する</a><br>
<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#3-%E6%89%8B%E8%BB%BD%E3%81%ABui%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B">3. 手軽にUIテストをできるようにする</a><br>
<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#4-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%82%92%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B">4. テストの失敗をハンドリングする</a><br>
<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#5-%E3%82%B3%E3%83%BC%E3%83%89%E5%81%B4%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B">5. コード側からTest Runnerを制御する</a><br>
<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B">6. テストの失敗が後続のテストにまで影響を与えないようにする</a><br>
<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#7-commandline%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B">7. CommandLineからTest Runnerを実行する</a></p>

<h1>
<span id="tipsを紹介する前に" class="fragment"></span><a href="#tips%E3%82%92%E7%B4%B9%E4%BB%8B%E3%81%99%E3%82%8B%E5%89%8D%E3%81%AB"><i class="fa fa-link"></i></a>Tipsを紹介する前に</h1>

<p>テストコードを書くにあたって、Unity上でテストできるというメリットから、Unityに標準で付属している<strong><a href="https://docs.unity3d.com/ja/current/Manual/testing-editortestsrunner.html" rel="nofollow noopener" target="_blank">Test Runner</a></strong>のPlay Modeテストを使用しています。</p>

<p>Play Modeテストはコルーチンを使って記述され、このコルーチンが最後までエラーを吐かずに終了すればテストが成功扱いになるという、とてもシンプルなものです。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">Run</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"テスト開始"</span><span class="p">);</span>

        <span class="c1">// シナリオの再生処理</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">RunScenario</span><span class="p">();</span>

        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"最後までいったのでテスト成功！！"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>これはUnityエディタから実行できるようになっており、実行すると自動的にUnityがPlay状態になり、直後にコルーチンを実行する仕組みとなっています。</p>

<p><a href="https://camo.qiitausercontent.com/4db10b9992f9695a333ed7ece251838a0bb9bc6e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3235333939372f36363336346236622d633135612d393164322d346334392d3765343761396637363762372e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2F66364b6b-c15a-91d2-4c49-7e47a9f767b7.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8d2513de8586320331d690d15a0919af" alt="test.gif" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/253997/66364b6b-c15a-91d2-4c49-7e47a9f767b7.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2F66364b6b-c15a-91d2-4c49-7e47a9f767b7.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f07e81ea9625f542b2547f4417511195 1x" loading="lazy"></a></p>

<p>そしてもちろん、CommandLineからの実行にも対応しています。完璧ですね。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code>Unity.exe <span class="nt">-projectPath</span> &lt;projectPath&gt; <span class="nt">-batchmode</span> <span class="nt">-runTests</span> <span class="nt">-testPlatform</span> playmode <span class="nt">-testResults</span> &lt;resultPath&gt;
</code></pre></div></div>

<p>　<br>
これから紹介するTipsは、このTest RunnerのPlay Modeテストを行う際のTipsとなります。</p>

<h1>
<span id="tips" class="fragment"></span><a href="#tips"><i class="fa fa-link"></i></a>Tips</h1>

<h2>
<span id="1-play-modeテストで使うattributeとその注意点" class="fragment"></span><a href="#1-play-mode%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E4%BD%BF%E3%81%86attribute%E3%81%A8%E3%81%9D%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9"><i class="fa fa-link"></i></a>1. Play Modeテストで使うAttributeとその注意点</h2>

<p>Test Runnerを使う際に覚えておきたいAttributeがあります。<br>
また、Play Modeテストにおいて注意すべき点もあるので、それも交えて紹介します。</p>

<h3>
<span id="テストメソッド用" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E7%94%A8"><i class="fa fa-link"></i></a>テストメソッド用</h3>

<ul>
<li>
<code>[UnityTest]</code>

<ul>
<li>テストしたいコルーチンに必ず付ける必要がある</li>
</ul>
</li>
<li>
<code>[TestCase]</code>

<ul>
<li>テストケースを定義する</li>
</ul>
</li>
<li>
<code>[TestCaseSource]</code>

<ul>
<li>テストケースをリストで定義する（動的に定義することができる）</li>
</ul>
</li>
<li>
<code>[Timeout]</code>

<ul>
<li>テストのタイムアウト時間を指定する</li>
</ul>
</li>
</ul>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span>
<span class="p">{</span>
    <span class="c1">// テストしたいコルーチンに必ず付ける必要がある</span>
    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">Run</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">RunScenario</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="c1">// コルーチンに引数として値を渡すことができる（複数指定可）</span>
    <span class="c1">// この例だと、RunWithTestCase("file_0001")、RunWithTestCase("file_0002")として扱われる</span>
    <span class="c1">// 【注意】 コルーチンに[TestCase]を使う場合、ExpectedResult = null を記述しないとエラーになる</span>
    <span class="p">[</span><span class="nf">TestCase</span><span class="p">(</span><span class="s">"file_0001"</span><span class="p">,</span> <span class="n">ExpectedResult</span> <span class="p">=</span> <span class="k">null</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">TestCase</span><span class="p">(</span><span class="s">"file_0002"</span><span class="p">,</span> <span class="n">ExpectedResult</span> <span class="p">=</span> <span class="k">null</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">RunWithTestCase</span><span class="p">(</span><span class="kt">string</span> <span class="n">file</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">RunScenarioWithFile</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
    <span class="p">}</span>



    <span class="c1">// [TestCaseSource]に渡すリスト</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">IEnumerable</span> <span class="n">FILES</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">path</span> <span class="k">in</span> <span class="n">Directory</span><span class="p">.</span><span class="nf">GetFiles</span><span class="p">(</span><span class="s">"&lt;path&gt;"</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="c1">//  【注意】 [TestCase]同様、Returns(null) を記述しないとエラーになる</span>
                <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">TestCaseData</span><span class="p">(</span><span class="n">path</span><span class="p">).</span><span class="nf">Returns</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// [TestCase]をリストで管理できるようにしたもの（動的に定義したい場合などで有用）</span>
    <span class="c1">// 各要素ごとを渡したテストとして扱われる</span>
    <span class="c1">// Directory.GetFilesから取得できる文字列がfile_0001、file_0002とすると、</span>
    <span class="c1">// RunWithTestCaseSource("file_0001")、RunWithTestCaseSource("file_0002")となる</span>
    <span class="p">[</span><span class="nf">TestCaseSource</span><span class="p">(</span><span class="s">"FILES"</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">RunWithTestCaseSource</span><span class="p">(</span><span class="kt">string</span> <span class="n">file</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">RunScenarioWithFile</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
    <span class="p">}</span>



    <span class="c1">// テストのタイムアウト時間を指定する</span>
    <span class="c1">// デフォルトだと30秒</span>
    <span class="c1">// ms単位で指定（この例だと5分になる）</span>
    <span class="p">[</span><span class="nf">Timeout</span><span class="p">(</span><span class="m">300000</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">RunWithTimeout</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">RunScenario</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ちなみにUnityエディタ上ではこう見えています。</p>

<p><a href="https://camo.qiitausercontent.com/b3acad13dd9623ca22a41b07f703c7eb2ade1712/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3235333939372f61303033653063392d363038352d303037382d633836642d3963343763356534663138322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fa003e0c9-6085-0078-c86d-9c47c5e4f182.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a16866472b4faa6cdcd30f213f45c580" alt="gui.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/253997/a003e0c9-6085-0078-c86d-9c47c5e4f182.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fa003e0c9-6085-0078-c86d-9c47c5e4f182.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c3c9530b113f04e110bca517857b2d9b 1x" loading="lazy"></a></p>

<h3>
<span id="コールバック" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF"><i class="fa fa-link"></i></a>コールバック</h3>

<ul>
<li>
<code>[OneTimeSetUp]</code>

<ul>
<li>クラス内で最初のテストが実行される前に一度だけ呼ばれる</li>
</ul>
</li>
<li>
<code>[SetUp]</code>

<ul>
<li>各テストの最初に呼ばれる</li>
</ul>
</li>
<li>
<code>[TearDown]</code>

<ul>
<li>各テストの最後に呼ばれる（テストが失敗しても呼ばれる）</li>
</ul>
</li>
<li>
<code>[OneTimeTearDown]</code>

<ul>
<li>クラス内で最後のテストが実行された後に一度だけ呼ばれる</li>
</ul>
</li>
</ul>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span>
<span class="p">{</span>
    <span class="c1">// クラス内で最初のテストが実行される前に一度だけ呼ばれる</span>
    <span class="p">[</span><span class="n">OneTimeSetUp</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OneTimeSetUp</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"テスト開始"</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="c1">// 各テストの最初に呼ばれる</span>
    <span class="p">[</span><span class="n">SetUp</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">SetUp</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"file_0001 のテスト開始"</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="c1">// 各テストの最後に呼ばれる（テストが失敗しても呼ばれる）</span>
    <span class="p">[</span><span class="n">TearDown</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">TearDown</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"file_0001 のテスト終了"</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="c1">// クラス内で最後のテストが実行された後に一度だけ呼ばれる</span>
    <span class="p">[</span><span class="n">OneTimeTearDown</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OneTimeTearDown</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"テスト終了"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>なお、Test Runnerには<a href="https://nunit.org/" rel="nofollow noopener" target="_blank">NUnit</a>と呼ばれるテストフレームワークが使われているため、もっと知りたい方は<a href="https://github.com/nunit/docs/wiki/Attributes" rel="nofollow noopener" target="_blank">NUnitのドキュメント</a>を参照ください。</p>

<h2>
<span id="2-テスト時間を短縮する" class="fragment"></span><a href="#2-%E3%83%86%E3%82%B9%E3%83%88%E6%99%82%E9%96%93%E3%82%92%E7%9F%AD%E7%B8%AE%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>2. テスト時間を短縮する</h2>

<p>Play Modeテストでは、UnityをPlay状態にしてテストを実行するため、最速でも実プレイと同じ速度しか出ません。</p>

<p>そこで、ゲーム内速度やFPSを上げることでスピードUPを図ります。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span>
<span class="p">{</span>
    <span class="c1">// クラス内で最初のテストが実行される前に一度だけ呼ばれる</span>
    <span class="p">[</span><span class="n">OneTimeSetUp</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OneTimeSetUp</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// テスト時間短縮のために高速化する</span>
        <span class="n">Application</span><span class="p">.</span><span class="n">targetFrameRate</span> <span class="p">=</span> <span class="m">60</span><span class="p">;</span>
        <span class="n">Time</span><span class="p">.</span><span class="n">timeScale</span> <span class="p">=</span> <span class="m">2.0f</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>これだけで、テスト時間を大幅に削減することができます。<br>
Play Modeテストならではの手法ですね。</p>

<h2>
<span id="3-手軽にuiテストをできるようにする" class="fragment"></span><a href="#3-%E6%89%8B%E8%BB%BD%E3%81%ABui%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>3. 手軽にUIテストをできるようにする</h2>

<p>シナリオの動作チェックのようなUIテストを行う場合、画面タップなどのUIの操作が必要となります。</p>

<p>ただ、これを自前で実装するのは手間になるため、すでにある<a href="https://github.com/taphos/unity-uitest" rel="nofollow noopener" target="_blank">Unity UI Test Automation Framework</a>というフレームワークを使用することをオススメします。</p>

<p>これを使えば、</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span> <span class="p">:</span> <span class="n">UITest</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">Run</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// targetという名前のボタンを押す</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">Press</span><span class="p">(</span><span class="s">"target"</span><span class="p">);</span>

        <span class="c1">// Scenarioシーンをロードする</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">LoadScene</span><span class="p">(</span><span class="s">"Scenario"</span><span class="p">);</span>

        <span class="c1">// targetというオブジェクトが登場するまで待機する</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="nf">WaitFor</span><span class="p">(</span><span class="k">new</span> <span class="nf">ObjectAppeared</span><span class="p">(</span><span class="s">"target"</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>といったことが簡単にできるようになります。</p>

<h2>
<span id="4-テストの失敗をハンドリングする" class="fragment"></span><a href="#4-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%82%92%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>4. テストの失敗をハンドリングする</h2>

<p>テストコードを書いていて、テストが失敗した場合のみ特定の処理をしたい、ということがあると思います。</p>

<p>もし、<code>[TearDown]</code>で指定したメソッドに引数として情報が渡ってきたり、テスト失敗時に呼ばれるコールバックなどがあればよかったのですが、NUnitのドキュメントを見た限りなさそうでした。</p>

<p>ではどうするか。<br>
Play Modeテストはエラーログが出れば失敗となるので、Unityのログメッセージを取得することでハンドリングできるようになります。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">_errorLogs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>

    <span class="c1">// クラス内で最初のテストが実行される前に一度だけ呼ばれる</span>
    <span class="p">[</span><span class="n">OneTimeSetUp</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OneTimeSetUp</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ログを残す</span>
        <span class="n">Application</span><span class="p">.</span><span class="n">logMessageReceived</span> <span class="p">+=</span> <span class="n">Log</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Log</span><span class="p">(</span><span class="kt">string</span> <span class="n">logString</span><span class="p">,</span> <span class="kt">string</span> <span class="n">stackTrace</span><span class="p">,</span> <span class="n">LogType</span> <span class="n">type</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// エラーログを保持しておく</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="p">==</span> <span class="n">LogType</span><span class="p">.</span><span class="n">Error</span> <span class="p">||</span> <span class="n">type</span> <span class="p">==</span> <span class="n">LogType</span><span class="p">.</span><span class="n">Exception</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_errorLogs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">logString</span><span class="p">}</span><span class="s">\n</span><span class="p">{</span><span class="n">stackTrace</span><span class="p">}</span><span class="s">\n"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">Run</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// 各テストの頭でクリアする</span>
        <span class="n">_errorLogs</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

        <span class="k">yield</span> <span class="k">return</span> <span class="nf">RunScenario</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// 各テストの最後に呼ばれる（テストが失敗しても呼ばれる）</span>
    <span class="p">[</span><span class="n">TearDown</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">TearDown</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// エラーログがあるならテスト失敗</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_errorLogs</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"テスト失敗"</span><span class="p">);</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">"\n"</span><span class="p">,</span> <span class="n">_errorLogs</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">()));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>こうすれば、失敗時のみ処理をすることができます。</p>

<h2>
<span id="5-コード側からtest-runnerを制御する" class="fragment"></span><a href="#5-%E3%82%B3%E3%83%BC%E3%83%89%E5%81%B4%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>5. コード側からTest Runnerを制御する</h2>

<p>Test RunnerがUnityエディタやCommandLineから実行できる術を用意しているとしても、やはり自前で拡張したい時はあります。</p>

<p>そういった場合、コード側からTest Runnerを制御することになると思いますが、実はこれがかなり面倒です。<br>
理由は単純。Test RunnerのAPIが公開されていないからです。</p>

<p>そのため、リフレクションを使って無理やり実行することになります。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTestCommand</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Execute</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// テスト情報を追加する</span>
        <span class="kt">var</span> <span class="n">engineAssembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">"UnityEngine.TestRunner"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">testFilterType</span> <span class="p">=</span> <span class="n">engineAssembly</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"UnityEngine.TestTools.TestRunner.GUI.TestRunnerFilter"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">testFilter</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">testFilterType</span><span class="p">);</span>
        <span class="c1">// テストの名前を使って実行する</span>
        <span class="c1">// 実行するテスト名(メソッド名)は名前空間とクラス名も含めること</span>
        <span class="kt">var</span> <span class="n">testNamesField</span> <span class="p">=</span> <span class="n">testFilterType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"testNames"</span><span class="p">);</span>
        <span class="n">testNamesField</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">testFilter</span><span class="p">,</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"ScenarioTest.Run(\"file_0001\")"</span><span class="p">,</span> <span class="s">"ScenarioTest.Run(\"file_0002\")"</span> <span class="p">});</span>

        <span class="c1">// Test Runnerを実行できるクラスを参照する</span>
        <span class="kt">var</span> <span class="n">editorAssembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">"UnityEditor.TestRunner"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">runnerWindowType</span> <span class="p">=</span> <span class="n">editorAssembly</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"UnityEditor.TestTools.TestRunner.TestRunnerWindow"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">runnerWindow</span> <span class="p">=</span> <span class="n">runnerWindowType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"s_Instance"</span><span class="p">,</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Static</span><span class="p">).</span><span class="nf">GetValue</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">listGUIField</span> <span class="p">=</span> <span class="n">runnerWindowType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"m_PlayModeTestListGUI"</span><span class="p">,</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Instance</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">listGUI</span> <span class="p">=</span> <span class="n">runnerWindow</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">?</span> <span class="n">listGUIField</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">runnerWindow</span><span class="p">)</span> <span class="p">:</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">listGUIField</span><span class="p">.</span><span class="n">FieldType</span><span class="p">);</span>

        <span class="c1">// Test Runnerを実行する</span>
        <span class="kt">var</span> <span class="n">runMethod</span> <span class="p">=</span> <span class="n">listGUIField</span><span class="p">.</span><span class="n">FieldType</span><span class="p">.</span><span class="nf">GetMethod</span><span class="p">(</span><span class="s">"RunTests"</span><span class="p">,</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Instance</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span><span class="p">);</span>
        <span class="n">runMethod</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="n">listGUI</span><span class="p">,</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span> <span class="n">testFilter</span> <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>正直「何やっているんだ、このコードは」状態になると思うので、<a href="https://github.com/0xd4d/dnSpy" rel="nofollow noopener" target="_blank">dnSpy</a>などのデコンパイラを使ってTestRunner.dllの中身を見ることをオススメします。</p>

<h2>
<span id="6-テストの失敗が後続のテストにまで影響を与えないようにする" class="fragment"></span><a href="#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>6. テストの失敗が後続のテストにまで影響を与えないようにする</h2>

<p>Play Modeテストでは、複数のテストを実行した場合も、同じPlay状態でテストを実行します。<br>
そのため、変数などで状態を持っていれば、それは後続のテストにも引き継がれることになります。</p>

<p>この特性は、途中のテストが失敗した時に厄介で、</p>

<ol>
<li>テストAが失敗する</li>
<li>テストAが途中で失敗したので、途中の状態が保持されたままになる</li>
<li>次のテストBに移る</li>
<li>想定しない状態が保持されていることで、問題ないはずのテストBが落ちてしまう</li>
</ol>

<p>ということが起きてしまいます。</p>

<p><a href="https://camo.qiitausercontent.com/40ca0983351000036de6a838813e4d7c4044940b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3235333939372f62623562666662372d326134612d393837662d336536312d6362636561646265616464612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fbb5bffb7-2a4a-987f-3e61-cbceadbeadda.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3eef24b08cc6c9ffa3713a7b73c50c69" alt="fail.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/253997/bb5bffb7-2a4a-987f-3e61-cbceadbeadda.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fbb5bffb7-2a4a-987f-3e61-cbceadbeadda.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a2b228fecd19803daedea47c7c5732f4 1x" loading="lazy"></a></p>

<p>これに対処するには、各テストが正しく初期化された状態で実行される必要があります。<br>
ただ、もしstaticやDontDestroyOnLoadをよく使っているプロジェクトであれば、これは困難を極めます。</p>

<p>シーンの再ロードなどでは初期化できず、しらみつぶしに初期化されていないところを探していくしかないからです。<br>
自分が現在開発に携わっているゲームも同じ状況で、初めはしらみつぶしに探していましたが、途方もなく途中で断念しました。</p>

<p>打開策はないか…そう思案して、考えついた<ruby>最強のTips<rp>(</rp><rt>苦肉の策</rt><rp>)</rp></ruby>、それが</p>

<p><strong>一旦UnityのPlay状態を止めて再度Play状態にすれば、事実上初期化されたことと同義になる！！（スマホのタスクキルと同じ）</strong></p>

<p>というものでした。</p>

<p>実際のコードを見てみましょう。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="kt">object</span> <span class="n">_testFilter</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">_errorLogs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
    <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">_runTestNames</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>

    <span class="c1">// クラス内で最初のテストが実行される前に一度だけ呼ばれる</span>
    <span class="p">[</span><span class="n">OneTimeSetUp</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OneTimeSetUp</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// 【注意】 この例では、Logメソッドを省略</span>
        <span class="n">Application</span><span class="p">.</span><span class="n">logMessageReceived</span> <span class="p">+=</span> <span class="n">Log</span><span class="p">;</span>

        <span class="c1">// Restartするため、テスト情報を保持しておく</span>
        <span class="kt">var</span> <span class="n">assembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">"UnityEngine.TestRunner"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">controllerType</span> <span class="p">=</span> <span class="n">assembly</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"UnityEngine.TestTools.TestRunner.PlaymodeTestsController"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">controllerObject</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">"Code-based tests runner"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">controller</span> <span class="p">=</span> <span class="n">controllerObject</span><span class="p">.</span><span class="nf">GetComponent</span><span class="p">(</span><span class="n">controllerType</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">settingsField</span> <span class="p">=</span> <span class="n">controllerType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"settings"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">settings</span> <span class="p">=</span> <span class="n">settingsField</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">controller</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">settingsType</span> <span class="p">=</span> <span class="n">assembly</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"UnityEngine.TestTools.TestRunner.PlaymodeTestsControllerSettings"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">filterField</span> <span class="p">=</span> <span class="n">settingsType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"filter"</span><span class="p">);</span>
        <span class="n">_testFilter</span> <span class="p">=</span> <span class="n">filterField</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">settings</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// 【注意】 この例では、FILES変数の宣言は省略</span>
    <span class="p">[</span><span class="nf">TestCaseSource</span><span class="p">(</span><span class="s">"FILES"</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">UnityTest</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IEnumerator</span> <span class="nf">Run</span><span class="p">(</span><span class="kt">string</span> <span class="n">file</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 前回のテストが失敗していたら、UnityのPlay状態を止める</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_errorLogs</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">_testFilter</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 【注意】 テスト情報の更新処理（今回は名前で更新しているが、カテゴリーなら別の処理が必要）</span>
            <span class="kt">var</span> <span class="n">assembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">"UnityEngine.TestRunner"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">testFilterType</span> <span class="p">=</span> <span class="n">assembly</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"UnityEngine.TestTools.TestRunner.GUI.TestRunnerFilter"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">testNamesField</span> <span class="p">=</span> <span class="n">testFilterType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"testNames"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">testNames</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">[])</span><span class="n">testNamesField</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">_testFilter</span><span class="p">);</span>
            <span class="c1">// すでに実行しているテストは削除する</span>
            <span class="n">testNames</span> <span class="p">=</span> <span class="n">testNames</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">testName</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="n">_runTestNames</span><span class="p">.</span><span class="nf">Any</span><span class="p">(</span><span class="n">runTestName</span> <span class="p">=&gt;</span> <span class="n">testName</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">runTestName</span><span class="p">))).</span><span class="nf">ToArray</span><span class="p">();</span>
            <span class="n">testNamesField</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">_testFilter</span><span class="p">,</span> <span class="n">testNames</span><span class="p">);</span>

            <span class="c1">// Unityを止めて、Test Runnerを再び実行する</span>
            <span class="n">EditorApplication</span><span class="p">.</span><span class="n">isPlaying</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="n">EditorApplication</span><span class="p">.</span><span class="n">update</span> <span class="p">+=</span> <span class="n">OnRestart</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">_errorLogs</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
        <span class="n">_runTestNames</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

        <span class="k">yield</span> <span class="k">return</span> <span class="nf">RunScenarioWithFile</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">OnRestart</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">Restart</span><span class="p">(</span><span class="n">_testFilter</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// コード側からTest Runnerを実行する</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Restart</span><span class="p">(</span><span class="kt">object</span> <span class="n">testFilter</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">assembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">"UnityEditor.TestRunner"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">runnerWindowType</span> <span class="p">=</span> <span class="n">assembly</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"UnityEditor.TestTools.TestRunner.TestRunnerWindow"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">runnerWindow</span> <span class="p">=</span> <span class="n">runnerWindowType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"s_Instance"</span><span class="p">,</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Static</span><span class="p">).</span><span class="nf">GetValue</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">listGUIField</span> <span class="p">=</span> <span class="n">runnerWindowType</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"m_PlayModeTestListGUI"</span><span class="p">,</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Instance</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">listGUI</span> <span class="p">=</span> <span class="n">runnerWindow</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">?</span> <span class="n">listGUIField</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">runnerWindow</span><span class="p">)</span> <span class="p">:</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">listGUIField</span><span class="p">.</span><span class="n">FieldType</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">runMethod</span> <span class="p">=</span> <span class="n">listGUIField</span><span class="p">.</span><span class="n">FieldType</span><span class="p">.</span><span class="nf">GetMethod</span><span class="p">(</span><span class="s">"RunTests"</span><span class="p">,</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Instance</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span><span class="p">);</span>
        <span class="n">runMethod</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="n">listGUI</span><span class="p">,</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span> <span class="n">testFilter</span> <span class="p">});</span>
        <span class="n">EditorApplication</span><span class="p">.</span><span class="n">update</span> <span class="p">-=</span> <span class="n">OnRestart</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>やっていることは、以下の通りです。</p>

<ol>
<li>テスト開始時にTest Runnerからテスト情報を抜き出す</li>
<li>各テスト開始時、前回のテストが失敗したか確認する</li>
<li>テストに失敗していれば、すでにテスト済みのものを、開始時の保持しておいたテスト情報から削除する</li>
<li>UnityのPlay状態を止め、更新したテスト情報をもとにTest Runnerを再実行する</li>
</ol>

<p>Test Runnerを実行すれば、UnityはPlay状態になるため、事実上の初期化が完成です。</p>

<p>注意として、テスト情報が名前ではなくカテゴリーで管理されていることもあるため、その際は別の更新処理が必要です。<br>
　<br>
　<br>
苦肉の策ではありますが、これで全シナリオのテストが可能となりました。</p>

<p>ただ一点、この方法で問題になることがありました。<br>
次のTipsに移ります。</p>

<h2>
<span id="7-commandlineからtest-runnerを実行する" class="fragment"></span><a href="#7-commandline%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>7. CommandLineからTest Runnerを実行する</h2>

<h3>
<span id="通常のケース" class="fragment"></span><a href="#%E9%80%9A%E5%B8%B8%E3%81%AE%E3%82%B1%E3%83%BC%E3%82%B9"><i class="fa fa-link"></i></a>通常のケース</h3>

<p>冒頭でも記述した、Test Runnerで用意されているコマンドで実行可能です。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code>Unity.exe <span class="nt">-projectPath</span> &lt;projectPath&gt; <span class="nt">-batchmode</span> <span class="nt">-runTests</span> <span class="nt">-testPlatform</span> playmode <span class="nt">-testResults</span> &lt;resultPath&gt;
</code></pre></div></div>

<p>これに<code>-quit</code>が指定されていないことにお気づきでしょうか？</p>

<p>実は、このコマンドを実行すると、テスト終了時にUnityが自動的に終了するようになっています。<br>
逆に、<code>-quit</code>を付けると失敗してしまうためご注意ください。</p>

<h3>
<span id="特殊なケース" class="fragment"></span><a href="#%E7%89%B9%E6%AE%8A%E3%81%AA%E3%82%B1%E3%83%BC%E3%82%B9"><i class="fa fa-link"></i></a>特殊なケース</h3>

<p>「<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B">6. テストの失敗が後続のテストにまで影響を与えないようにする</a>」で紹介した方法だと、通常のケースと同じコマンドを実行しても上手くいきません。</p>

<p>問題は2つあります。<br>
解決策とともに、一つずつ紹介していきます。</p>

<h4>
<span id="unityが終了しない問題" class="fragment"></span><a href="#unity%E3%81%8C%E7%B5%82%E4%BA%86%E3%81%97%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>Unityが終了しない問題</h4>

<p>通常のケースにて紹介した、<code>-quit</code>を指定せずとも、テスト終了時にUnityが自動的に終了する機能。<br>
本来であれば問題がないこの挙動ですが、先ほど紹介した一旦Play状態を止める方法だと厄介です。</p>

<p>というのも、一旦Play状態を止めるという動作は、Test Runnerが不正終了したとみなされ、その機能が働かなくなってしまうからです。</p>

<p>このままでは、CommandLineからの実行時、途中でテストに失敗すると、Unityが終了されません。</p>

<p>そこで、batchmodeでの実行であれば、全テスト終了時にUnityを終了するようにしました。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioTest</span>
<span class="p">{</span>
    <span class="c1">// クラス内で最後のテストが実行された後に一度だけ呼ばれる</span>
    <span class="p">[</span><span class="n">OneTimeTearDown</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OneTimeTearDown</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// batchmodeなら終了させる</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Environment</span><span class="p">.</span><span class="n">CommandLine</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"-batchmode"</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="c1">// エラー扱いにするため、1以上を返しても良い</span>
            <span class="n">EditorApplication</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>途中でテストが失敗しPlay状態が止められても、<code>[OneTimeTearDown]</code>は呼ばれないことが肝ですね。<br>
（複数のクラスが存在する場合は、他のクラスのテストが終了しているかのチェックが必要になります）</p>

<h4>
<span id="無限に同じテストを実行され続ける問題" class="fragment"></span><a href="#%E7%84%A1%E9%99%90%E3%81%AB%E5%90%8C%E3%81%98%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%95%E3%82%8C%E7%B6%9A%E3%81%91%E3%82%8B%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>無限に同じテストを実行され続ける問題</h4>

<p>もしこの記事のコードをそのまま使っている場合、無限に同じテストが実行され続けてしまいます。</p>

<p>これは、</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code>Unity.exe <span class="nt">-projectPath</span> &lt;projectPath&gt; <span class="nt">-batchmode</span> <span class="nt">-runTests</span> <span class="nt">-testPlatform</span> playmode <span class="nt">-testResults</span> &lt;resultPath&gt;
</code></pre></div></div>

<p>このコマンドで作成されるテスト情報は名前で管理されていないため、記事のコードのように、すでに実行したテストの名前を削除しても意味がないためです。</p>

<p>もし、この記事のコードを使い回したい場合は、名前で管理されているテスト情報を作成しTest Runnerで実行するメソッドを、CommandLineから呼ぶことをオススメします。</p>

<div class="code-frame" data-lang="sh"><div class="highlight"><pre class="with-code"><code>Unity.exe <span class="nt">-projectPath</span> &lt;projectPath&gt; <span class="nt">-batchmode</span> <span class="nt">-executeMethod</span> ScenarioTestCommand.Execute
</code></pre></div></div>

<p>実行している<code>ScenarioTestCommand.Execute</code>メソッドは、「<a href="https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#5-%E3%82%B3%E3%83%BC%E3%83%89%E5%81%B4%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B">5. コード側からTest Runnerを制御する</a>」で紹介しているコードを参照してください。<br>
こちらのサンプルコードは、名前で管理されているテスト情報を作成し、実行しています。</p>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<p>自分の開発しているゲームでは、この全シナリオ動作テストを毎朝走らせ、失敗すればslackに通知するようにしています。</p>

<p>今回テストコードを入れたことで、シナリオデータの不具合が消えただけでなく、シナリオ再生用のコードを変更するハードルが下がったことも嬉しいポイントです。</p>

<p>ゲーム開発だとテストコードを書く機会も少なかったですが、この機会に今後も積極的に取り組んでいきたいと思います。</p>

<p>Twitter: <a href="https://twitter.com/yukiarrr" rel="nofollow noopener" target="_blank">@yukiarrr</a></p>

<h1>
<span id="その他参考文献" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><i class="fa fa-link"></i></a>その他参考文献</h1>

<ul>
<li><a href="https://qiita.com/su10/items/560302ceafa6bf43a13e" id="reference-a49e32f4e339f61bb1ad">Unityでちゃんとテストを書きたい人のためのまとめ</a></li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fyukiarrr%2Fitems%2Ffe3a97d38a4473f5c8c2&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fyukiarrr%2Fitems%2Ffe3a97d38a4473f5c8c2&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/likers" class="css-1iupg5d">23</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">26</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/fe3a97d38a4473f5c8c2/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/yukiarrr/items/fe3a97d38a4473f5c8c2.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-c1488567-56b0-49d4-9b39-f927831c0832">{"authorAnalyticsTrackingId":"UA-145398484-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-ad982599-b6a3-461e-a3cf-57989f60f8ca"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-ad982599-b6a3-461e-a3cf-57989f60f8ca">{}</script>
      
<div id="LoginModal-react-component-f42a07ab-b750-406e-9f3b-99d8df7715e7"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-f42a07ab-b750-406e-9f3b-99d8df7715e7">{}</script>
      
<div id="StockModal-react-component-7ad454af-ccc6-400d-88df-c8c06d92dc3b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-7ad454af-ccc6-400d-88df-c8c06d92dc3b">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;dg6eSCT/8DpEc4SsBxqhpo/+V5NYN9agAEEV8WIjq7DUTd9657K5oKyPrs+aOH193+GAl6GjXYkJuHbhfe2F4g==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"最強のtips苦肉の策が生まれるきっかけ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%BC%B7%E3%81%AEtips%E8%8B%A6%E8%82%89%E3%81%AE%E7%AD%96%E3%81%8C%E7%94%9F%E3%81%BE%E3%82%8C%E3%82%8B%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cruby\u003e最強のTips\u003crp\u003e(\u003c/rp\u003e\u003crt\u003e苦肉の策\u003c/rt\u003e\u003crp\u003e)\u003c/rp\u003e\u003c/ruby\u003eが生まれるきっかけ\u003c/h1\u003e\n\n\u003cp\u003e自分が現在開発に携わっているゲームでは、作中に多くのシナリオが含まれています。\u003cbr\u003e\nその数はデータにして200を超えていますが、このデータが増えるにつれて、ある問題が発生しました。\u003c/p\u003e\n\n\u003cp\u003eそれは、\u003cstrong\u003eシナリオデータの数が多すぎて、不具合のあるデータがあることに気付けない\u003c/strong\u003eということです。\u003cbr\u003e\n（特定の選択肢を選ぶと、進行不能になるデータがいくつか見られました）\u003c/p\u003e\n\n\u003cp\u003eこれに対処するため、\u003cstrong\u003e「全シナリオの動作チェックを行うUIのテストコードを書こう！」\u003c/strong\u003eと思ったのが、事の始まりです。\u003c/p\u003e\n\n\u003cp\u003eまさか、あんな苦肉の策を取ることになるとは、この時は考えてもいませんでした…\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"目次tips一覧\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%9B%AE%E6%AC%A1tips%E4%B8%80%E8%A6%A7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e目次（Tips一覧）\u003c/h1\u003e\n\n\u003cp\u003e自分がテストコードを書いて会得したTipsを紹介します。\u003c/p\u003e\n\n\u003cp\u003eちなみに、\u003cruby\u003e最強のTips\u003crp\u003e(\u003c/rp\u003e\u003crt\u003e苦肉の策\u003c/rt\u003e\u003crp\u003e)\u003c/rp\u003e\u003c/ruby\u003eは「\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e6. テストの失敗が後続のテストにまで影響を与えないようにする\u003c/a\u003e」です。\u003cbr\u003e\nそれ以外は、まとも（のはず…）なTipsになります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#1-play-mode%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E4%BD%BF%E3%81%86attribute%E3%81%A8%E3%81%9D%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9\"\u003e1. Play Modeテストで使うAttributeとその注意点\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#2-%E3%83%86%E3%82%B9%E3%83%88%E6%99%82%E9%96%93%E3%82%92%E7%9F%AD%E7%B8%AE%E3%81%99%E3%82%8B\"\u003e2. テスト時間を短縮する\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#3-%E6%89%8B%E8%BB%BD%E3%81%ABui%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e3. 手軽にUIテストをできるようにする\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#4-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%82%92%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B\"\u003e4. テストの失敗をハンドリングする\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#5-%E3%82%B3%E3%83%BC%E3%83%89%E5%81%B4%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B\"\u003e5. コード側からTest Runnerを制御する\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e6. テストの失敗が後続のテストにまで影響を与えないようにする\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#7-commandline%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\"\u003e7. CommandLineからTest Runnerを実行する\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"tipsを紹介する前に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tips%E3%82%92%E7%B4%B9%E4%BB%8B%E3%81%99%E3%82%8B%E5%89%8D%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTipsを紹介する前に\u003c/h1\u003e\n\n\u003cp\u003eテストコードを書くにあたって、Unity上でテストできるというメリットから、Unityに標準で付属している\u003cstrong\u003e\u003ca href=\"https://docs.unity3d.com/ja/current/Manual/testing-editortestsrunner.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTest Runner\u003c/a\u003e\u003c/strong\u003eのPlay Modeテストを使用しています。\u003c/p\u003e\n\n\u003cp\u003ePlay Modeテストはコルーチンを使って記述され、このコルーチンが最後までエラーを吐かずに終了すればテストが成功扱いになるという、とてもシンプルなものです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"テスト開始\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// シナリオの再生処理\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunScenario\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"最後までいったのでテスト成功！！\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれはUnityエディタから実行できるようになっており、実行すると自動的にUnityがPlay状態になり、直後にコルーチンを実行する仕組みとなっています。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4db10b9992f9695a333ed7ece251838a0bb9bc6e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3235333939372f36363336346236622d633135612d393164322d346334392d3765343761396637363762372e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2F66364b6b-c15a-91d2-4c49-7e47a9f767b7.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8d2513de8586320331d690d15a0919af\" alt=\"test.gif\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/253997/66364b6b-c15a-91d2-4c49-7e47a9f767b7.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2F66364b6b-c15a-91d2-4c49-7e47a9f767b7.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f07e81ea9625f542b2547f4417511195 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eそしてもちろん、CommandLineからの実行にも対応しています。完璧ですね。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eUnity.exe \u003cspan class=\"nt\"\u003e-projectPath\u003c/span\u003e \u0026lt;projectPath\u0026gt; \u003cspan class=\"nt\"\u003e-batchmode\u003c/span\u003e \u003cspan class=\"nt\"\u003e-runTests\u003c/span\u003e \u003cspan class=\"nt\"\u003e-testPlatform\u003c/span\u003e playmode \u003cspan class=\"nt\"\u003e-testResults\u003c/span\u003e \u0026lt;resultPath\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e　\u003cbr\u003e\nこれから紹介するTipsは、このTest RunnerのPlay Modeテストを行う際のTipsとなります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"tips\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tips\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTips\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"1-play-modeテストで使うattributeとその注意点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1-play-mode%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E4%BD%BF%E3%81%86attribute%E3%81%A8%E3%81%9D%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1. Play Modeテストで使うAttributeとその注意点\u003c/h2\u003e\n\n\u003cp\u003eTest Runnerを使う際に覚えておきたいAttributeがあります。\u003cbr\u003e\nまた、Play Modeテストにおいて注意すべき点もあるので、それも交えて紹介します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"テストメソッド用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテストメソッド用\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e[UnityTest]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eテストしたいコルーチンに必ず付ける必要がある\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[TestCase]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eテストケースを定義する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[TestCaseSource]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eテストケースをリストで定義する（動的に定義することができる）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[Timeout]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eテストのタイムアウト時間を指定する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// テストしたいコルーチンに必ず付ける必要がある\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunScenario\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// コルーチンに引数として値を渡すことができる（複数指定可）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// この例だと、RunWithTestCase(\"file_0001\")、RunWithTestCase(\"file_0002\")として扱われる\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 【注意】 コルーチンに[TestCase]を使う場合、ExpectedResult = null を記述しないとエラーになる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eTestCase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"file_0001\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpectedResult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eTestCase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"file_0002\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eExpectedResult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunWithTestCase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunScenarioWithFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n\n    \u003cspan class=\"c1\"\u003e// [TestCaseSource]に渡すリスト\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e \u003cspan class=\"n\"\u003eFILES\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eget\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetFiles\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;path\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e//  【注意】 [TestCase]同様、Returns(null) を記述しないとエラーになる\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestCaseData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eReturns\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// [TestCase]をリストで管理できるようにしたもの（動的に定義したい場合などで有用）\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 各要素ごとを渡したテストとして扱われる\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Directory.GetFilesから取得できる文字列がfile_0001、file_0002とすると、\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// RunWithTestCaseSource(\"file_0001\")、RunWithTestCaseSource(\"file_0002\")となる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eTestCaseSource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"FILES\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunWithTestCaseSource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunScenarioWithFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n\n    \u003cspan class=\"c1\"\u003e// テストのタイムアウト時間を指定する\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// デフォルトだと30秒\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// ms単位で指定（この例だと5分になる）\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e300000\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunWithTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunScenario\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eちなみにUnityエディタ上ではこう見えています。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b3acad13dd9623ca22a41b07f703c7eb2ade1712/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3235333939372f61303033653063392d363038352d303037382d633836642d3963343763356534663138322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fa003e0c9-6085-0078-c86d-9c47c5e4f182.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a16866472b4faa6cdcd30f213f45c580\" alt=\"gui.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/253997/a003e0c9-6085-0078-c86d-9c47c5e4f182.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fa003e0c9-6085-0078-c86d-9c47c5e4f182.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c3c9530b113f04e110bca517857b2d9b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"コールバック\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコールバック\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e[OneTimeSetUp]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eクラス内で最初のテストが実行される前に一度だけ呼ばれる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[SetUp]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e各テストの最初に呼ばれる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[TearDown]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e各テストの最後に呼ばれる（テストが失敗しても呼ばれる）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[OneTimeTearDown]\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003eクラス内で最後のテストが実行された後に一度だけ呼ばれる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// クラス内で最初のテストが実行される前に一度だけ呼ばれる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"テスト開始\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// 各テストの最初に呼ばれる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"file_0001 のテスト開始\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// 各テストの最後に呼ばれる（テストが失敗しても呼ばれる）\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"file_0001 のテスト終了\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// クラス内で最後のテストが実行された後に一度だけ呼ばれる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eOneTimeTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOneTimeTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"テスト終了\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eなお、Test Runnerには\u003ca href=\"https://nunit.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eNUnit\u003c/a\u003eと呼ばれるテストフレームワークが使われているため、もっと知りたい方は\u003ca href=\"https://github.com/nunit/docs/wiki/Attributes\" rel=\"nofollow noopener\" target=\"_blank\"\u003eNUnitのドキュメント\u003c/a\u003eを参照ください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"2-テスト時間を短縮する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2-%E3%83%86%E3%82%B9%E3%83%88%E6%99%82%E9%96%93%E3%82%92%E7%9F%AD%E7%B8%AE%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2. テスト時間を短縮する\u003c/h2\u003e\n\n\u003cp\u003ePlay Modeテストでは、UnityをPlay状態にしてテストを実行するため、最速でも実プレイと同じ速度しか出ません。\u003c/p\u003e\n\n\u003cp\u003eそこで、ゲーム内速度やFPSを上げることでスピードUPを図ります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// クラス内で最初のテストが実行される前に一度だけ呼ばれる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// テスト時間短縮のために高速化する\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etargetFrameRate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e60\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etimeScale\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれだけで、テスト時間を大幅に削減することができます。\u003cbr\u003e\nPlay Modeテストならではの手法ですね。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"3-手軽にuiテストをできるようにする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3-%E6%89%8B%E8%BB%BD%E3%81%ABui%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3. 手軽にUIテストをできるようにする\u003c/h2\u003e\n\n\u003cp\u003eシナリオの動作チェックのようなUIテストを行う場合、画面タップなどのUIの操作が必要となります。\u003c/p\u003e\n\n\u003cp\u003eただ、これを自前で実装するのは手間になるため、すでにある\u003ca href=\"https://github.com/taphos/unity-uitest\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnity UI Test Automation Framework\u003c/a\u003eというフレームワークを使用することをオススメします。\u003c/p\u003e\n\n\u003cp\u003eこれを使えば、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUITest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// targetという名前のボタンを押す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003ePress\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"target\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Scenarioシーンをロードする\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eLoadScene\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Scenario\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// targetというオブジェクトが登場するまで待機する\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eWaitFor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eObjectAppeared\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"target\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eといったことが簡単にできるようになります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"4-テストの失敗をハンドリングする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#4-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%82%92%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e4. テストの失敗をハンドリングする\u003c/h2\u003e\n\n\u003cp\u003eテストコードを書いていて、テストが失敗した場合のみ特定の処理をしたい、ということがあると思います。\u003c/p\u003e\n\n\u003cp\u003eもし、\u003ccode\u003e[TearDown]\u003c/code\u003eで指定したメソッドに引数として情報が渡ってきたり、テスト失敗時に呼ばれるコールバックなどがあればよかったのですが、NUnitのドキュメントを見た限りなさそうでした。\u003c/p\u003e\n\n\u003cp\u003eではどうするか。\u003cbr\u003e\nPlay Modeテストはエラーログが出れば失敗となるので、Unityのログメッセージを取得することでハンドリングできるようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// クラス内で最初のテストが実行される前に一度だけ呼ばれる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// ログを残す\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elogMessageReceived\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003elogString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estackTrace\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eLogType\u003c/span\u003e \u003cspan class=\"n\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// エラーログを保持しておく\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etype\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eLogType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eError\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003etype\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eLogType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003elogString\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\\n\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003estackTrace\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 各テストの頭でクリアする\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunScenario\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 各テストの最後に呼ばれる（テストが失敗しても呼ばれる）\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// エラーログがあるならテスト失敗\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"テスト失敗\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eJoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e()));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこうすれば、失敗時のみ処理をすることができます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"5-コード側からtest-runnerを制御する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#5-%E3%82%B3%E3%83%BC%E3%83%89%E5%81%B4%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e5. コード側からTest Runnerを制御する\u003c/h2\u003e\n\n\u003cp\u003eTest RunnerがUnityエディタやCommandLineから実行できる術を用意しているとしても、やはり自前で拡張したい時はあります。\u003c/p\u003e\n\n\u003cp\u003eそういった場合、コード側からTest Runnerを制御することになると思いますが、実はこれがかなり面倒です。\u003cbr\u003e\n理由は単純。Test RunnerのAPIが公開されていないからです。\u003c/p\u003e\n\n\u003cp\u003eそのため、リフレクションを使って無理やり実行することになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTestCommand\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eExecute\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// テスト情報を追加する\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eengineAssembly\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEngine.TestRunner\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilterType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eengineAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEngine.TestTools.TestRunner.GUI.TestRunnerFilter\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eActivator\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etestFilterType\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// テストの名前を使って実行する\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 実行するテスト名(メソッド名)は名前空間とクラス名も含めること\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestNamesField\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilterType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"testNames\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etestNamesField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etestFilter\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ScenarioTest.Run(\\\"file_0001\\\")\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ScenarioTest.Run(\\\"file_0002\\\")\"\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Test Runnerを実行できるクラスを参照する\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeditorAssembly\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEditor.TestRunner\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindowType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eeditorAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEditor.TestTools.TestRunner.TestRunnerWindow\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindowType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"s_Instance\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNonPublic\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatic\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindowType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"m_PlayModeTestListGUI\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInstance\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNonPublic\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUI\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erunnerWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eActivator\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFieldType\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Test Runnerを実行する\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erunMethod\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFieldType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"RunTests\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInstance\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNonPublic\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erunMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elistGUI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e正直「何やっているんだ、このコードは」状態になると思うので、\u003ca href=\"https://github.com/0xd4d/dnSpy\" rel=\"nofollow noopener\" target=\"_blank\"\u003ednSpy\u003c/a\u003eなどのデコンパイラを使ってTestRunner.dllの中身を見ることをオススメします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"6-テストの失敗が後続のテストにまで影響を与えないようにする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e6. テストの失敗が後続のテストにまで影響を与えないようにする\u003c/h2\u003e\n\n\u003cp\u003ePlay Modeテストでは、複数のテストを実行した場合も、同じPlay状態でテストを実行します。\u003cbr\u003e\nそのため、変数などで状態を持っていれば、それは後続のテストにも引き継がれることになります。\u003c/p\u003e\n\n\u003cp\u003eこの特性は、途中のテストが失敗した時に厄介で、\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eテストAが失敗する\u003c/li\u003e\n\u003cli\u003eテストAが途中で失敗したので、途中の状態が保持されたままになる\u003c/li\u003e\n\u003cli\u003e次のテストBに移る\u003c/li\u003e\n\u003cli\u003e想定しない状態が保持されていることで、問題ないはずのテストBが落ちてしまう\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eということが起きてしまいます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/40ca0983351000036de6a838813e4d7c4044940b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3235333939372f62623562666662372d326134612d393837662d336536312d6362636561646265616464612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fbb5bffb7-2a4a-987f-3e61-cbceadbeadda.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3eef24b08cc6c9ffa3713a7b73c50c69\" alt=\"fail.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/253997/bb5bffb7-2a4a-987f-3e61-cbceadbeadda.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F253997%2Fbb5bffb7-2a4a-987f-3e61-cbceadbeadda.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a2b228fecd19803daedea47c7c5732f4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれに対処するには、各テストが正しく初期化された状態で実行される必要があります。\u003cbr\u003e\nただ、もしstaticやDontDestroyOnLoadをよく使っているプロジェクトであれば、これは困難を極めます。\u003c/p\u003e\n\n\u003cp\u003eシーンの再ロードなどでは初期化できず、しらみつぶしに初期化されていないところを探していくしかないからです。\u003cbr\u003e\n自分が現在開発に携わっているゲームも同じ状況で、初めはしらみつぶしに探していましたが、途方もなく途中で断念しました。\u003c/p\u003e\n\n\u003cp\u003e打開策はないか…そう思案して、考えついた\u003cruby\u003e最強のTips\u003crp\u003e(\u003c/rp\u003e\u003crt\u003e苦肉の策\u003c/rt\u003e\u003crp\u003e)\u003c/rp\u003e\u003c/ruby\u003e、それが\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e一旦UnityのPlay状態を止めて再度Play状態にすれば、事実上初期化されたことと同義になる！！（スマホのタスクキルと同じ）\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eというものでした。\u003c/p\u003e\n\n\u003cp\u003e実際のコードを見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003e_testFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003e_runTestNames\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// クラス内で最初のテストが実行される前に一度だけ呼ばれる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOneTimeSetUp\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 【注意】 この例では、Logメソッドを省略\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elogMessageReceived\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// Restartするため、テスト情報を保持しておく\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eassembly\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEngine.TestRunner\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econtrollerType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eassembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEngine.TestTools.TestRunner.PlaymodeTestsController\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econtrollerObject\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGameObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Code-based tests runner\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003econtroller\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtrollerObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtrollerType\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esettingsField\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtrollerType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"settings\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esettings\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esettingsField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtroller\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esettingsType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eassembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEngine.TestTools.TestRunner.PlaymodeTestsControllerSettings\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003efilterField\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esettingsType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"filter\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_testFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efilterField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esettings\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// 【注意】 この例では、FILES変数の宣言は省略\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nf\"\u003eTestCaseSource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"FILES\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eUnityTest\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerator\u003c/span\u003e \u003cspan class=\"nf\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 前回のテストが失敗していたら、UnityのPlay状態を止める\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003e_testFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 【注意】 テスト情報の更新処理（今回は名前で更新しているが、カテゴリーなら別の処理が必要）\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eassembly\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEngine.TestRunner\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilterType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eassembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEngine.TestTools.TestRunner.GUI.TestRunnerFilter\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestNamesField\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilterType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"testNames\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestNames\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[])\u003c/span\u003e\u003cspan class=\"n\"\u003etestNamesField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_testFilter\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// すでに実行しているテストは削除する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etestNames\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etestNames\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etestName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003e_runTestNames\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erunTestName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etestName\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erunTestName\u003c/span\u003e\u003cspan class=\"p\"\u003e))).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etestNamesField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_testFilter\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etestNames\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// Unityを止めて、Test Runnerを再び実行する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eEditorApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eisPlaying\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eEditorApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eupdate\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eOnRestart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003e_errorLogs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClear\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_runTestNames\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunScenarioWithFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnRestart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eRestart\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_testFilter\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// コード側からTest Runnerを実行する\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRestart\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilter\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eassembly\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEditor.TestRunner\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindowType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eassembly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"UnityEditor.TestTools.TestRunner.TestRunnerWindow\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindowType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"s_Instance\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNonPublic\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatic\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindowType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"m_PlayModeTestListGUI\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInstance\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNonPublic\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUI\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erunnerWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erunnerWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eActivator\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFieldType\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erunMethod\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elistGUIField\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFieldType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"RunTests\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInstance\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003eBindingFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNonPublic\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erunMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elistGUI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003etestFilter\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eEditorApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eupdate\u003c/span\u003e \u003cspan class=\"p\"\u003e-=\u003c/span\u003e \u003cspan class=\"n\"\u003eOnRestart\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eやっていることは、以下の通りです。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eテスト開始時にTest Runnerからテスト情報を抜き出す\u003c/li\u003e\n\u003cli\u003e各テスト開始時、前回のテストが失敗したか確認する\u003c/li\u003e\n\u003cli\u003eテストに失敗していれば、すでにテスト済みのものを、開始時の保持しておいたテスト情報から削除する\u003c/li\u003e\n\u003cli\u003eUnityのPlay状態を止め、更新したテスト情報をもとにTest Runnerを再実行する\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eTest Runnerを実行すれば、UnityはPlay状態になるため、事実上の初期化が完成です。\u003c/p\u003e\n\n\u003cp\u003e注意として、テスト情報が名前ではなくカテゴリーで管理されていることもあるため、その際は別の更新処理が必要です。\u003cbr\u003e\n　\u003cbr\u003e\n　\u003cbr\u003e\n苦肉の策ではありますが、これで全シナリオのテストが可能となりました。\u003c/p\u003e\n\n\u003cp\u003eただ一点、この方法で問題になることがありました。\u003cbr\u003e\n次のTipsに移ります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"7-commandlineからtest-runnerを実行する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#7-commandline%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e7. CommandLineからTest Runnerを実行する\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"通常のケース\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%80%9A%E5%B8%B8%E3%81%AE%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e通常のケース\u003c/h3\u003e\n\n\u003cp\u003e冒頭でも記述した、Test Runnerで用意されているコマンドで実行可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eUnity.exe \u003cspan class=\"nt\"\u003e-projectPath\u003c/span\u003e \u0026lt;projectPath\u0026gt; \u003cspan class=\"nt\"\u003e-batchmode\u003c/span\u003e \u003cspan class=\"nt\"\u003e-runTests\u003c/span\u003e \u003cspan class=\"nt\"\u003e-testPlatform\u003c/span\u003e playmode \u003cspan class=\"nt\"\u003e-testResults\u003c/span\u003e \u0026lt;resultPath\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれに\u003ccode\u003e-quit\u003c/code\u003eが指定されていないことにお気づきでしょうか？\u003c/p\u003e\n\n\u003cp\u003e実は、このコマンドを実行すると、テスト終了時にUnityが自動的に終了するようになっています。\u003cbr\u003e\n逆に、\u003ccode\u003e-quit\u003c/code\u003eを付けると失敗してしまうためご注意ください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"特殊なケース\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%89%B9%E6%AE%8A%E3%81%AA%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e特殊なケース\u003c/h3\u003e\n\n\u003cp\u003e「\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e6. テストの失敗が後続のテストにまで影響を与えないようにする\u003c/a\u003e」で紹介した方法だと、通常のケースと同じコマンドを実行しても上手くいきません。\u003c/p\u003e\n\n\u003cp\u003e問題は2つあります。\u003cbr\u003e\n解決策とともに、一つずつ紹介していきます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"unityが終了しない問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unity%E3%81%8C%E7%B5%82%E4%BA%86%E3%81%97%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUnityが終了しない問題\u003c/h4\u003e\n\n\u003cp\u003e通常のケースにて紹介した、\u003ccode\u003e-quit\u003c/code\u003eを指定せずとも、テスト終了時にUnityが自動的に終了する機能。\u003cbr\u003e\n本来であれば問題がないこの挙動ですが、先ほど紹介した一旦Play状態を止める方法だと厄介です。\u003c/p\u003e\n\n\u003cp\u003eというのも、一旦Play状態を止めるという動作は、Test Runnerが不正終了したとみなされ、その機能が働かなくなってしまうからです。\u003c/p\u003e\n\n\u003cp\u003eこのままでは、CommandLineからの実行時、途中でテストに失敗すると、Unityが終了されません。\u003c/p\u003e\n\n\u003cp\u003eそこで、batchmodeでの実行であれば、全テスト終了時にUnityを終了するようにしました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eScenarioTest\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// クラス内で最後のテストが実行された後に一度だけ呼ばれる\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eOneTimeTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOneTimeTearDown\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// batchmodeなら終了させる\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCommandLine\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eContains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"-batchmode\"\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// エラー扱いにするため、1以上を返しても良い\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eEditorApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e途中でテストが失敗しPlay状態が止められても、\u003ccode\u003e[OneTimeTearDown]\u003c/code\u003eは呼ばれないことが肝ですね。\u003cbr\u003e\n（複数のクラスが存在する場合は、他のクラスのテストが終了しているかのチェックが必要になります）\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"無限に同じテストを実行され続ける問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%84%A1%E9%99%90%E3%81%AB%E5%90%8C%E3%81%98%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%95%E3%82%8C%E7%B6%9A%E3%81%91%E3%82%8B%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e無限に同じテストを実行され続ける問題\u003c/h4\u003e\n\n\u003cp\u003eもしこの記事のコードをそのまま使っている場合、無限に同じテストが実行され続けてしまいます。\u003c/p\u003e\n\n\u003cp\u003eこれは、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eUnity.exe \u003cspan class=\"nt\"\u003e-projectPath\u003c/span\u003e \u0026lt;projectPath\u0026gt; \u003cspan class=\"nt\"\u003e-batchmode\u003c/span\u003e \u003cspan class=\"nt\"\u003e-runTests\u003c/span\u003e \u003cspan class=\"nt\"\u003e-testPlatform\u003c/span\u003e playmode \u003cspan class=\"nt\"\u003e-testResults\u003c/span\u003e \u0026lt;resultPath\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのコマンドで作成されるテスト情報は名前で管理されていないため、記事のコードのように、すでに実行したテストの名前を削除しても意味がないためです。\u003c/p\u003e\n\n\u003cp\u003eもし、この記事のコードを使い回したい場合は、名前で管理されているテスト情報を作成しTest Runnerで実行するメソッドを、CommandLineから呼ぶことをオススメします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eUnity.exe \u003cspan class=\"nt\"\u003e-projectPath\u003c/span\u003e \u0026lt;projectPath\u0026gt; \u003cspan class=\"nt\"\u003e-batchmode\u003c/span\u003e \u003cspan class=\"nt\"\u003e-executeMethod\u003c/span\u003e ScenarioTestCommand.Execute\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e実行している\u003ccode\u003eScenarioTestCommand.Execute\u003c/code\u003eメソッドは、「\u003ca href=\"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2#5-%E3%82%B3%E3%83%BC%E3%83%89%E5%81%B4%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B\"\u003e5. コード側からTest Runnerを制御する\u003c/a\u003e」で紹介しているコードを参照してください。\u003cbr\u003e\nこちらのサンプルコードは、名前で管理されているテスト情報を作成し、実行しています。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003e自分の開発しているゲームでは、この全シナリオ動作テストを毎朝走らせ、失敗すればslackに通知するようにしています。\u003c/p\u003e\n\n\u003cp\u003e今回テストコードを入れたことで、シナリオデータの不具合が消えただけでなく、シナリオ再生用のコードを変更するハードルが下がったことも嬉しいポイントです。\u003c/p\u003e\n\n\u003cp\u003eゲーム開発だとテストコードを書く機会も少なかったですが、この機会に今後も積極的に取り組んでいきたいと思います。\u003c/p\u003e\n\n\u003cp\u003eTwitter: \u003ca href=\"https://twitter.com/yukiarrr\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@yukiarrr\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"その他参考文献\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその他参考文献\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/su10/items/560302ceafa6bf43a13e\" id=\"reference-a49e32f4e339f61bb1ad\"\u003eUnityでちゃんとテストを書きたい人のためのまとめ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2019-08-20T04:06:48Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"IZBtKmbxrm0Qh6GBU8juxerp/smjvjXehg==--xoEYibR9afYqV6Ex--ixGpy++fF6mxFoVYH0tGmg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-08-20T15:45:52Z","likesCount":23,"linkUrl":"https://qiita.com/yukiarrr/items/fe3a97d38a4473f5c8c2","organization":null,"originalId":1002385,"stockedCount":26,"title":"Unityでテストコードを書いて会得した最強のTips(苦肉の策ともいう)","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E5%BC%B7%E3%81%AEtips%E8%8B%A6%E8%82%89%E3%81%AE%E7%AD%96%E3%81%8C%E7%94%9F%E3%81%BE%E3%82%8C%E3%82%8B%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91\"\u003e最強のTips(苦肉の策)が生まれるきっかけ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%9B%AE%E6%AC%A1tips%E4%B8%80%E8%A6%A7\"\u003e目次（Tips一覧）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#tips%E3%82%92%E7%B4%B9%E4%BB%8B%E3%81%99%E3%82%8B%E5%89%8D%E3%81%AB\"\u003eTipsを紹介する前に\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#tips\"\u003eTips\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1-play-mode%E3%83%86%E3%82%B9%E3%83%88%E3%81%A7%E4%BD%BF%E3%81%86attribute%E3%81%A8%E3%81%9D%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9\"\u003e1. Play Modeテストで使うAttributeとその注意点\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E7%94%A8\"\u003eテストメソッド用\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF\"\u003eコールバック\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2-%E3%83%86%E3%82%B9%E3%83%88%E6%99%82%E9%96%93%E3%82%92%E7%9F%AD%E7%B8%AE%E3%81%99%E3%82%8B\"\u003e2. テスト時間を短縮する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#3-%E6%89%8B%E8%BB%BD%E3%81%ABui%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e3. 手軽にUIテストをできるようにする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#4-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%82%92%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B\"\u003e4. テストの失敗をハンドリングする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#5-%E3%82%B3%E3%83%BC%E3%83%89%E5%81%B4%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B\"\u003e5. コード側からTest Runnerを制御する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#6-%E3%83%86%E3%82%B9%E3%83%88%E3%81%AE%E5%A4%B1%E6%95%97%E3%81%8C%E5%BE%8C%E7%B6%9A%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%BE%E3%81%A7%E5%BD%B1%E9%9F%BF%E3%82%92%E4%B8%8E%E3%81%88%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e6. テストの失敗が後続のテストにまで影響を与えないようにする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#7-commandline%E3%81%8B%E3%82%89test-runner%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\"\u003e7. CommandLineからTest Runnerを実行する\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%80%9A%E5%B8%B8%E3%81%AE%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e通常のケース\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%89%B9%E6%AE%8A%E3%81%AA%E3%82%B1%E3%83%BC%E3%82%B9\"\u003e特殊なケース\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#unity%E3%81%8C%E7%B5%82%E4%BA%86%E3%81%97%E3%81%AA%E3%81%84%E5%95%8F%E9%A1%8C\"\u003eUnityが終了しない問題\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%84%A1%E9%99%90%E3%81%AB%E5%90%8C%E3%81%98%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%95%E3%82%8C%E7%B6%9A%E3%81%91%E3%82%8B%E5%95%8F%E9%A1%8C\"\u003e無限に同じテストを実行され続ける問題\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003eその他参考文献\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":4263,"uuid":"fe3a97d38a4473f5c8c2","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"VkRZbSeHKH7TPlNfejbu5i5zyUcN--KwlPLcQdV/dh8wNv--WSxSoLNoqWdaZYSOqp0/TQ==","originalId":253997,"description":"","facebookUrl":null,"githubUrl":"https://github.com/yukiarrr","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/253997/762bfdd40a2cc135b89eb6140334223144d4f5f9/large.png?1573562503","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F253997%2F762bfdd40a2cc135b89eb6140334223144d4f5f9%2Flarge.png%3F1573562503?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=7a9daec64b93114b8d831236cf1efbf5","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F253997%2F762bfdd40a2cc135b89eb6140334223144d4f5f9%2Flarge.png%3F1573562503?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=54095ac4d77bef3e69d6266243ade629","urlName":"yukiarrr","websiteUrl":null,"twitterUrl":"https://twitter.com/yukiarrr","twitterUrlName":"yukiarrr","revealedOrganizations":{"edges":[]}},"tags":[{"name":"test","urlName":"test"},{"name":"C#","urlName":"csharp"},{"name":"テスト","urlName":"%e3%83%86%e3%82%b9%e3%83%88"},{"name":"Unity","urlName":"unity"},{"name":"UnityTestRunner","urlName":"unitytestrunner"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
