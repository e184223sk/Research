ふと気になったので ASP.NET MVC を ASP.NET Core MVC にしてみようと思います。とりあえずいきなり巨大なものをコンバートすると心が折れるので ASP.NET MVC のプロジェクトを新規作成したものを、ASP.NET Core MVC に変換するということをやってみようと思います。とりあえずどれくらい大変なのかを体験するために ASP.NET MVC から ASP.NET Core MVC への移行ドキュメントなどはチェックせずにやってみます。新規作成したプロジェクトはこんな感じです。packages.config などがあるのがドキっとしますね！とりあえず、後から参照が無い系エラーになったとき用に packages.config を消すのは最後にしようと思います。まずは、プロジェクトファイルを以下の内容に書き換えます。一度プロジェクトをアンロードしてから読み込みましょう。再オープンしてリビルドをしてみると以下のように 22 個のコンパイルエラーが出ました。AssemblyCompanyAttribute などの最初の 6 個のエラーは WPF のプロジェクトを変換したときに見たことがあるエラーですね。AssemblyInfo.cs が自動生成されるようになったため、.NET Framework のプロジェクトにある AssemblyInfo.cs と内容が重複してしまうために起きるエラーですね。これはプロジェクトファイルに GenerateAssemblyInfo タグを追加して false を設定しましょう。以下のようになります。不要な using などがあったりする部分もあるので、一旦プロジェクトに対してコードのクリーンナップを実行して綺麗にします。HomeController クラスには using Microsoft.AspNetCore.Mvc; を追加します。残りのエラーが 4 つになりました。どれもアプリの構成系のファイルで起きています。というか Global.asax.cs ってありましたね。懐かしい…BundleConfig.cs ではスクリプトのバンドルを作ってますが、この機能は ASP.NET Core MVC では見た記憶が無いので無いのでしょう。普通にスクリプトをそのまま参照します。FilterConfig.cs では HandleErrorAttribute をフィルターに追加しています。RouteConfig.cs はルートの構成ですね。ここらへんは ASP.NET Core MVC では Startup.cs で書くので Startup.cs と エントリーポイントの Program.cs を追加して App_Start フォルダーと Global.asax は消してしまいます。追加したファイルは以下の 2 つです。手っ取り早く ASP.NET Core MVC のプロジェクトを新規作成して、そこからコピペしてきました。この状態でビルドするとエラーが以下の内容に変化しました！何かのエラーを解決する調査をしているときもそうですけど、エラー内容が変わると進捗を感じますね！これはスクリプトバンドルが無くなったせいですね。なので、Conetnt フォルダーの中身を wwwroot/css に移動させて Scripts フォルダーを wwwroot/js フォルダーに移動させて、fonts フォルダーを wwwroot/fonts に移動させて favicon.ico を wwwroot フォルダーに移動させます。以下のようになりました。そしてエラーの出ている _Layout.cshtml を以下の内容から直接ファイルを参照するように変更します。この時点でビルドするとエラーが消えます。とりあえずデバッグ実行してみましょう。あっ、動いた…詳細ページや問い合わせページも動きました。もうちょっと詰まるかと思ったら思ったよりあっさりいってびっくりしました。ASP.NET から ASP.NET Core への移行ドキュメントを見てもアプローチは異なりますが、やっていることは大体同じでした。.NET Framework でなくなった機能を踏んでいない限りは割と機械的に移植できそうですね。ASP.NET MVC から ASP.NET Core MVC への移行


