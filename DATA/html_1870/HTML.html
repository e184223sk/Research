<!DOCTYPE html><html><head><meta charset="utf-8" /><title>クラスやパッケージの有無で処理を切り替える - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/sator_imaging/items/efc12675d4f452a64350" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="42ky2ESciiThj7vgpxE0gXcEKv6fM7yn1gT1IVqy6ecCCasGReS7ZDUOx5ZMelQfuxoM7+Rl37uPfH3vqQ1OjA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="クラスやパッケージの有無で処理を切り替える - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NEt2NDRPcDQ0SzU0NEtFNDRPUjQ0T0Q0NEt4NDRPODQ0SzQ0NEd1NXB5SjU0U2g0NEduNVllbTU1Q0c0NEtTNVlpSDQ0S0s1cHVfNDRHSTQ0S0wmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ZmI4OTNkMDllZDA2MGI0MjU4YTQzNDVkN2Y3ODE0OWM&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE5oZEc5eVgybHRZV2RwYm1jJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NDJhYzAzYzMzMDZlMzgwOTU2N2U4ZmMyY2JmOGJlNjc&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=d1058235b6d2cafb48f870d6e6070a60"><meta property="og:description" content="Unity 標準機能のパッケージ化によって、#if UNITY_2018_4_OR_NEWER 等、バージョンだけ見れば良いという状況から、「インストールされているか？」「バージョンは？」など、パッケージのインストール状況やバージョン..."><meta content="https://qiita.com/sator_imaging/items/efc12675d4f452a64350" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity3D,Unity,Unity拡張,UnityEditor" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-544873c1-35cb-4c5e-90a2-879370e997bd"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fsator_imaging%2Fitems%2Fefc12675d4f452a64350">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fsator_imaging%2Fitems%2Fefc12675d4f452a64350">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-544873c1-35cb-4c5e-90a2-879370e997bd">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2021-06-14T21:37:33.000+09:00","dateModified":"2021-06-14T21:37:33.000+09:00","headline":"クラスやパッケージの有無で処理を切り替える","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NEt2NDRPcDQ0SzU0NEtFNDRPUjQ0T0Q0NEt4NDRPODQ0SzQ0NEd1NXB5SjU0U2g0NEduNVllbTU1Q0c0NEtTNVlpSDQ0S0s1cHVfNDRHSTQ0S0wmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ZmI4OTNkMDllZDA2MGI0MjU4YTQzNDVkN2Y3ODE0OWM\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE5oZEc5eVgybHRZV2RwYm1jJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NDJhYzAzYzMzMDZlMzgwOTU2N2U4ZmMyY2JmOGJlNjc\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=d1058235b6d2cafb48f870d6e6070a60","mainEntityOfPage":"https://qiita.com/sator_imaging/items/efc12675d4f452a64350","author":{"@type":"Person","address":"Tokyo","email":null,"identifier":"sator_imaging","name":"sator_imaging","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F376963%2Faf7b578f6aab199d121531bba6ca592a8d402113%2Fx_large.png%3F1607555152?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=beed13fd9146a150a27368ef4f63c0a0","url":"https://qiita.com/sator_imaging","description":"作業用のメモや、読んだ資料のまとめが置いてあります。\r\n\r\nアメドラ好き。　最近は　・プリプロ　・演出シーンやアセットの制作　が半々ぐらいです。　◆ 短編アニメシリーズ　◆ VR進撃の巨人 THE HUMAN RACE　◆ 出資向けVTuber　◆ 版権物スマホゲー","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"sator_imaging","type":"items","id":"efc12675d4f452a64350"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"sator_imaging","type":"items","id":"efc12675d4f452a64350"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"sator_imaging","type":"items","id":"efc12675d4f452a64350"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/sator_imaging/items/efc12675d4f452a64350","location":"/sator_imaging/items/efc12675d4f452a64350","scheme":"https","host":"qiita.com","port":null,"pathname":"/sator_imaging/items/efc12675d4f452a64350","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"NkR3jWrHNhOuNUUpPxblqxpyzryXRtsNqsip+0M3mkfXJO5Ta78HU3q0OV/UfYU11mzorewQuBHzsCE1sIg9LA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-67e0e05d-3c2a-445f-9057-a611aa5c0c13"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/sator_imaging/items/efc12675d4f452a64350/likers" class="css-1iupg5d">0</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">1</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/efc12675d4f452a64350/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/sator_imaging/items/efc12675d4f452a64350/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/sator_imaging/items/efc12675d4f452a64350/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/sator_imaging/items/efc12675d4f452a64350/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/sator_imaging/items/efc12675d4f452a64350.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/sator_imaging"><img class="css-100alwu eyfquo10" src="https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/376963/af7b578f6aab199d121531bba6ca592a8d402113/x_large.png?1607555152" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/sator_imaging" class="css-10ougpm">@<!-- -->sator_imaging</a><div class="css-1ay9vb9"><time dateTime="2021-06-14T12:37:33Z" class="css-m19uds">posted at 2021-06-14</time></div></div></div></div></div><h1 class="css-cgzq40">クラスやパッケージの有無で処理を切り替える</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity3d" class="css-4czcte">Unity3D</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/unity%e6%8b%a1%e5%bc%b5" class="css-4czcte">Unity拡張</a><a href="/tags/unityeditor" class="css-4czcte">UnityEditor</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>Unity 標準機能のパッケージ化によって、<code>#if UNITY_2018_4_OR_NEWER</code> 等、バージョンだけ見れば良いという状況から、「インストールされているか？」「バージョンは？」など、パッケージのインストール状況やバージョン、クラスの有無で処理を切り替えたい、というのは結構あるあるなシチュエーションになってきましたね。</p>

<h3>
<span id="もくじ" class="fragment"></span><a href="#%E3%82%82%E3%81%8F%E3%81%98"><i class="fa fa-link"></i></a>もくじ</h3>

<ul>
<li><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</a></li>
<li><a href="#unity-2019-%E4%BB%A5%E9%99%8D%E3%81%A7%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E6%A9%9F%E8%83%BD%E9%99%90%E5%AE%9A%E3%81%AE%E6%89%8B%E6%B3%95">Unity 2019 以降でパッケージ化されている機能限定の手法</a></li>
<li>
<a href="#%E5%8F%A4%E3%81%84-unity-%E3%82%84%E9%80%A3%E6%90%BA%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88">古い Unity や連携対象がパッケージ化されていない場合</a>

<ul>
<li><a href="#%E9%80%A3%E6%90%BA%E5%85%83%E3%81%AE%E5%AE%9F%E8%A3%85">連携元の実装</a></li>
<li><a href="#%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E6%9C%AC%E4%BD%93">連携機能の本体</a></li>
<li><a href="#%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E6%9C%89%E7%84%A1%E3%81%A7%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%82%92%E8%A1%8C%E3%81%86">クラスの有無で連携機能の切り替えを行う</a></li>
</ul>
</li>
<li><a href="#%E8%B5%B7%E3%81%8D%E3%81%86%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C">起きうるエラーへの対応</a></li>
<li><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB">おわりに</a></li>
</ul>

<h2>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h2>



<p>方法は様々あると思いますが、ここでは、</p>

<ul>
<li><strong>エンドユーザーにファイルのコピーや削除以上の操作を求めない</strong></li>
<li><strong>連携元だけで完結できる（連携される側は相手の存在を知らなくて良い）</strong></li>
</ul>

<p>という点に主眼を置いています。</p>

<p>--</p>

<p>結局よくある形の実装に着地したので、なんだこの内容って感じで書き捨てていたんですが、以下に示す <code>Assembly Definition &gt; Version Defines</code> を Unity 2019 のマニュアルで見かけて掘り起こしました。</p>

<p>Version Defines でまかなえない場合の手法も合わせて紹介していますよ。</p>



<h2>
<span id="unity-2019-以降でパッケージ化されている機能限定の手法" class="fragment"></span><a href="#unity-2019-%E4%BB%A5%E9%99%8D%E3%81%A7%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E6%A9%9F%E8%83%BD%E9%99%90%E5%AE%9A%E3%81%AE%E6%89%8B%E6%B3%95"><i class="fa fa-link"></i></a>Unity 2019 以降でパッケージ化されている機能限定の手法</h2>

<p>Unity 2019 以降かつパッケージ化されている機能であれば、<code>Assembly Definition</code> にプリプロセッサーシンボルを設定する機能が追加されているので、その機能を利用して実現可能です。</p>

<ul>
<li><a href="https://docs.unity3d.com/2019.4/Documentation/Manual/ScriptCompilationAssemblyDefinitionFiles.html#define-symbols" rel="nofollow noopener" target="_blank">Unity - Manual: Assembly definitions # Defining symbols based on project packages</a></li>
</ul>

<p>設定箇所は <code>Assembly Definition</code> のインスペクターですが、対象の機能に <code>Assembly Definition</code> が設定されていれば良いだけではなく、<code>package.json</code> が存在し <code>Packages/</code> 以下に読み込まれている必要があります。</p>

<blockquote>
<p>※アセットストア由来のモノだとパッケージ化されていない事が殆どなので使いどころが難しいですね。</p>
</blockquote>

<h2>
<span id="古い-unity-や連携対象がパッケージ化されていない場合" class="fragment"></span><a href="#%E5%8F%A4%E3%81%84-unity-%E3%82%84%E9%80%A3%E6%90%BA%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>古い Unity や連携対象がパッケージ化されていない場合</h2>

<p>上に示した <code>Assembly Definition &gt; Version Defines</code> ではまかなえない場合にどうするか。</p>

<p><strong><a href="https://sator-imaging.booth.pm/items/2254383" rel="nofollow noopener" target="_blank">VRM Tool Kit</a></strong> というパッケージで <strong><a href="https://sator-imaging.booth.pm/items/1381822" rel="nofollow noopener" target="_blank">Pose Editor</a></strong> と連携する機能を実現した際の手法は以下の通りです。</p>

<ul>
<li>
<p>VRM Tool Kit（連携元アセット）</p>

<ul>
<li><code>PluginManager</code></li>
</ul>
</li>
<li>
<p><strong>Pose Editor Plugin</strong>（このフォルダーがあれば連携する）</p>

<ul>
<li><code>PluginInitializer</code></li>
<li>
<code>PoseEditorPlugin</code>（連携機能の本体）</li>
</ul>
</li>
<li>
<p>Pose Editor</p>

<ul>
<li>※ 連携先はあっても無くても良い</li>
</ul>
</li>
</ul>

<p>--</p>

<p>この構成でユーザーが行うインストール作業は、</p>

<ul>
<li>連携する場合は <code>Pose Editor</code> と <code>Plugin</code> をインストール</li>
<li>連携させたくない場合は <code>Pose Editor</code> および <code>Plugin</code> を削除</li>
<li>それぞれ単独で使いたい場合は <code>Plugin</code> を削除</li>
</ul>

<p>どのように使う場合でも、どんなユーザーでもミスが起きにくい状態です。</p>

<p>--</p>

<p>開発する上でも恩恵があって、連携するパッケージのバージョンによって変更が必要な部分があっても、プラグインだけを複数バージョン用意すれば良いので手間を最小限に抑えられます。</p>

<p>※ Unity 公式パッケージと連携する場合、プロジェクト都合で使用するバージョンが選べない状況がある。</p>

<h3>
<span id="連携元の実装" class="fragment"></span><a href="#%E9%80%A3%E6%90%BA%E5%85%83%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>連携元の実装</h3>

<p>連携元は以下の通り。</p>

<p>※ Unity 依存の <code>Action</code> や <code>Event</code> ではなく <code>delegate</code> でも大丈夫。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">PluginManager</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">Action</span> <span class="n">DoSomething</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code><span class="k">void</span> <span class="nf">DoIt</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// 連携先の呼び出し、なければ何もしない</span>
    <span class="n">PluginManager</span><span class="p">?.</span><span class="n">DoSomething</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">();</span>

    <span class="c1">// UIの無効化など</span>
    <span class="k">if</span><span class="p">(</span><span class="n">PluginManager</span><span class="p">?.</span><span class="n">DoSomething</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nf">DisableSomething</span><span class="p">();</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="連携機能の本体" class="fragment"></span><a href="#%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E6%9C%AC%E4%BD%93"><i class="fa fa-link"></i></a>連携機能の本体</h3>

<p>みんな大好き <code>InitializeOnLoadMethod</code> / <code>RuntimeInitializeOnLoadMethod</code> で連携機能を登録。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code><span class="p">[</span><span class="n">InitializeOnLoadMethod</span><span class="p">]</span>
<span class="p">[</span><span class="n">RuntimeInitializeOnLoadMethod</span><span class="p">]</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Initialize</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">PluginManager</span><span class="p">.</span><span class="n">DoSomething</span> <span class="p">=</span> <span class="n">DoSomething_Impl</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">DoSomething_Impl</span><span class="p">()</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="クラスの有無で連携機能の切り替えを行う" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E6%9C%89%E7%84%A1%E3%81%A7%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%82%92%E8%A1%8C%E3%81%86"><i class="fa fa-link"></i></a>クラスの有無で連携機能の切り替えを行う</h3>

<p><strong><a href="https://sator-imaging.booth.pm/items/2254383" rel="nofollow noopener" target="_blank">VRM Tool Kit</a></strong> では考えすぎていて、実際のところ複雑な連携はしなかったのでプラグインも本体に同梱してしまっています。</p>

<p>↓ ↓ ↓</p>

<p>パッケージとして読み込まれているとは限らない、または必要に応じて <code>.asmdef</code> を削除している可能性も考慮して、手あたり次第に対象クラスを探して対象パッケージが存在すれば連携機能を登録します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code><span class="k">static</span> <span class="n">Type</span> <span class="n">TPoseEditorManager</span> <span class="p">=</span>
    <span class="n">Type</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"PoseEditorManager"</span><span class="p">)</span> <span class="p">??</span>
    <span class="n">Type</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"PoseEditorManager, Assembly-CSharp"</span><span class="p">)</span> <span class="p">??</span>
    <span class="n">Type</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"PoseEditorManager, Assembly-CSharp-Editor"</span><span class="p">)</span> <span class="p">??</span>
    <span class="n">Type</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"PoseEditorManager, PoseEditor"</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="n">TPoseEditorManager</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">PluginManager</span><span class="p">.</span><span class="n">DoSomething</span> <span class="p">=</span> <span class="n">DoSomething_Impl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4>
<span id="c-の対象バージョン" class="fragment"></span><a href="#c-%E3%81%AE%E5%AF%BE%E8%B1%A1%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3"><i class="fa fa-link"></i></a>C# の対象バージョン</h4>

<p>Unity 2017 LTS が EOL でサポート対象外になって、現行の Unity はすべて C# 7.3 以上を採用という情勢です。</p>

<p>が、現行バージョンよりも古い Unity にも対応する場合、<code>?.</code>（null条件演算子）や <code>??</code>（null合体演算子）は C# バージョン６で追加された演算子なので修正する必要があります。</p>

<h2>
<span id="起きうるエラーへの対応" class="fragment"></span><a href="#%E8%B5%B7%E3%81%8D%E3%81%86%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C"><i class="fa fa-link"></i></a>起きうるエラーへの対応</h2>

<p>この構成で開発を進めた場合、連携元と連携プラグインだけがある状態や、プラグインだけを読み込んだ場合にエラーが出ます。</p>

<p>が、「プラグインを削除してください」でユーザーは対応可能なので許容しています。</p>

<blockquote>
<p>※上で示したように文字列ベースで処理をすればエラーを防げますが、入力補完など開発環境の恩恵を受けることが出来なくなるデバフがかかってしまいます。</p>
</blockquote>

<p>そもそもそういう状態になりにくい構成＆エラー対応に必要な操作もファイルの追加や削除だけなのであまり問題とはならず、また、ユーザーもフォルダー構成や名前から容易にエラーの原因を特定できるので大丈夫でしょう。</p>

<p>Bridge、Adapter、Provider 等々（？）界隈的には適切な命名規則があると思いますが、エンドユーザーに馴染みのある「プラグイン」としているのもそのあたりが理由です。</p>

<h2>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h2>

<p>Unity に限らず C# 界隈でもクラスの有無でプリプロセッサーシンボルの定義をしたがってる人、結構いるみたいですね。調べても方法は見つかりませんでしたが。。。</p>

<p>C# はそもそもプリプロセッサーにあまり機能を持たせたくない、という設計思想があるようで、今後もそんな機能が実装されることは無さそうです。</p>

<p>Unity の <code>Assembly Definition &gt; Version Defines</code> は必要だけど C# にその機能がない、という問題に対処するために追加された感じがしますね。こういう機能ないと困る！ という人は多かったハズ。</p>

<p>--</p>

<p>以上です。お疲れ様でした。</p>


</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fsator_imaging%2Fitems%2Fefc12675d4f452a64350&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fsator_imaging%2Fitems%2Fefc12675d4f452a64350&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/sator_imaging/items/efc12675d4f452a64350/likers" class="css-1iupg5d">0</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">1</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/efc12675d4f452a64350/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/sator_imaging/items/efc12675d4f452a64350/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/sator_imaging/items/efc12675d4f452a64350/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/sator_imaging/items/efc12675d4f452a64350/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/sator_imaging/items/efc12675d4f452a64350.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-67e0e05d-3c2a-445f-9057-a611aa5c0c13">{"authorAnalyticsTrackingId":"UA-3341541-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-b688fe3f-e517-41de-b86b-cc8660a68b5e"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-b688fe3f-e517-41de-b86b-cc8660a68b5e">{}</script>
      
<div id="LoginModal-react-component-d14e11d9-7c57-4191-990b-54909139ea69"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-d14e11d9-7c57-4191-990b-54909139ea69">{}</script>
      
<div id="StockModal-react-component-9e1e48f6-1ee7-473b-b3cc-f063b39553f0"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-9e1e48f6-1ee7-473b-b3cc-f063b39553f0">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;BsDceQ2EVTmLTAi2XByWbK6fRmdqQCTX9YyYJreLYB7noEWnDPxkeV/NdMC3d/byYoFgdhEWR8us9BDoRDTHdQ==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eUnity 標準機能のパッケージ化によって、\u003ccode\u003e#if UNITY_2018_4_OR_NEWER\u003c/code\u003e 等、バージョンだけ見れば良いという状況から、「インストールされているか？」「バージョンは？」など、パッケージのインストール状況やバージョン、クラスの有無で処理を切り替えたい、というのは結構あるあるなシチュエーションになってきましたね。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"もくじ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%82%E3%81%8F%E3%81%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eもくじ\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#unity-2019-%E4%BB%A5%E9%99%8D%E3%81%A7%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E6%A9%9F%E8%83%BD%E9%99%90%E5%AE%9A%E3%81%AE%E6%89%8B%E6%B3%95\"\u003eUnity 2019 以降でパッケージ化されている機能限定の手法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%A4%E3%81%84-unity-%E3%82%84%E9%80%A3%E6%90%BA%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88\"\u003e古い Unity や連携対象がパッケージ化されていない場合\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E9%80%A3%E6%90%BA%E5%85%83%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e連携元の実装\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E6%9C%AC%E4%BD%93\"\u003e連携機能の本体\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E6%9C%89%E7%84%A1%E3%81%A7%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%82%92%E8%A1%8C%E3%81%86\"\u003eクラスの有無で連携機能の切り替えを行う\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E8%B5%B7%E3%81%8D%E3%81%86%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C\"\u003e起きうるエラーへの対応\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h2\u003e\n\n\n\n\u003cp\u003e方法は様々あると思いますが、ここでは、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eエンドユーザーにファイルのコピーや削除以上の操作を求めない\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e連携元だけで完結できる（連携される側は相手の存在を知らなくて良い）\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eという点に主眼を置いています。\u003c/p\u003e\n\n\u003cp\u003e--\u003c/p\u003e\n\n\u003cp\u003e結局よくある形の実装に着地したので、なんだこの内容って感じで書き捨てていたんですが、以下に示す \u003ccode\u003eAssembly Definition \u0026gt; Version Defines\u003c/code\u003e を Unity 2019 のマニュアルで見かけて掘り起こしました。\u003c/p\u003e\n\n\u003cp\u003eVersion Defines でまかなえない場合の手法も合わせて紹介していますよ。\u003c/p\u003e\n\n\n\n\u003ch2\u003e\n\u003cspan id=\"unity-2019-以降でパッケージ化されている機能限定の手法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unity-2019-%E4%BB%A5%E9%99%8D%E3%81%A7%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E6%A9%9F%E8%83%BD%E9%99%90%E5%AE%9A%E3%81%AE%E6%89%8B%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUnity 2019 以降でパッケージ化されている機能限定の手法\u003c/h2\u003e\n\n\u003cp\u003eUnity 2019 以降かつパッケージ化されている機能であれば、\u003ccode\u003eAssembly Definition\u003c/code\u003e にプリプロセッサーシンボルを設定する機能が追加されているので、その機能を利用して実現可能です。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.unity3d.com/2019.4/Documentation/Manual/ScriptCompilationAssemblyDefinitionFiles.html#define-symbols\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnity - Manual: Assembly definitions # Defining symbols based on project packages\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e設定箇所は \u003ccode\u003eAssembly Definition\u003c/code\u003e のインスペクターですが、対象の機能に \u003ccode\u003eAssembly Definition\u003c/code\u003e が設定されていれば良いだけではなく、\u003ccode\u003epackage.json\u003c/code\u003e が存在し \u003ccode\u003ePackages/\u003c/code\u003e 以下に読み込まれている必要があります。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e※アセットストア由来のモノだとパッケージ化されていない事が殆どなので使いどころが難しいですね。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"古い-unity-や連携対象がパッケージ化されていない場合\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%A4%E3%81%84-unity-%E3%82%84%E9%80%A3%E6%90%BA%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e古い Unity や連携対象がパッケージ化されていない場合\u003c/h2\u003e\n\n\u003cp\u003e上に示した \u003ccode\u003eAssembly Definition \u0026gt; Version Defines\u003c/code\u003e ではまかなえない場合にどうするか。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://sator-imaging.booth.pm/items/2254383\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVRM Tool Kit\u003c/a\u003e\u003c/strong\u003e というパッケージで \u003cstrong\u003e\u003ca href=\"https://sator-imaging.booth.pm/items/1381822\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePose Editor\u003c/a\u003e\u003c/strong\u003e と連携する機能を実現した際の手法は以下の通りです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eVRM Tool Kit（連携元アセット）\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ePluginManager\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003ePose Editor Plugin\u003c/strong\u003e（このフォルダーがあれば連携する）\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ePluginInitializer\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ePoseEditorPlugin\u003c/code\u003e（連携機能の本体）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePose Editor\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e※ 連携先はあっても無くても良い\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e--\u003c/p\u003e\n\n\u003cp\u003eこの構成でユーザーが行うインストール作業は、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e連携する場合は \u003ccode\u003ePose Editor\u003c/code\u003e と \u003ccode\u003ePlugin\u003c/code\u003e をインストール\u003c/li\u003e\n\u003cli\u003e連携させたくない場合は \u003ccode\u003ePose Editor\u003c/code\u003e および \u003ccode\u003ePlugin\u003c/code\u003e を削除\u003c/li\u003e\n\u003cli\u003eそれぞれ単独で使いたい場合は \u003ccode\u003ePlugin\u003c/code\u003e を削除\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eどのように使う場合でも、どんなユーザーでもミスが起きにくい状態です。\u003c/p\u003e\n\n\u003cp\u003e--\u003c/p\u003e\n\n\u003cp\u003e開発する上でも恩恵があって、連携するパッケージのバージョンによって変更が必要な部分があっても、プラグインだけを複数バージョン用意すれば良いので手間を最小限に抑えられます。\u003c/p\u003e\n\n\u003cp\u003e※ Unity 公式パッケージと連携する場合、プロジェクト都合で使用するバージョンが選べない状況がある。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"連携元の実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%80%A3%E6%90%BA%E5%85%83%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e連携元の実装\u003c/h3\u003e\n\n\u003cp\u003e連携元は以下の通り。\u003c/p\u003e\n\n\u003cp\u003e※ Unity 依存の \u003ccode\u003eAction\u003c/code\u003e や \u003ccode\u003eEvent\u003c/code\u003e ではなく \u003ccode\u003edelegate\u003c/code\u003e でも大丈夫。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePluginManager\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eAction\u003c/span\u003e \u003cspan class=\"n\"\u003eDoSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoIt\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 連携先の呼び出し、なければ何もしない\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ePluginManager\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"n\"\u003eDoSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// UIの無効化など\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePluginManager\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"n\"\u003eDoSomething\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nf\"\u003eDisableSomething\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"連携機能の本体\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E6%9C%AC%E4%BD%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e連携機能の本体\u003c/h3\u003e\n\n\u003cp\u003eみんな大好き \u003ccode\u003eInitializeOnLoadMethod\u003c/code\u003e / \u003ccode\u003eRuntimeInitializeOnLoadMethod\u003c/code\u003e で連携機能を登録。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eInitializeOnLoadMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eRuntimeInitializeOnLoadMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ePluginManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDoSomething\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDoSomething_Impl\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDoSomething_Impl\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"クラスの有無で連携機能の切り替えを行う\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E6%9C%89%E7%84%A1%E3%81%A7%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%82%92%E8%A1%8C%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクラスの有無で連携機能の切り替えを行う\u003c/h3\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://sator-imaging.booth.pm/items/2254383\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVRM Tool Kit\u003c/a\u003e\u003c/strong\u003e では考えすぎていて、実際のところ複雑な連携はしなかったのでプラグインも本体に同梱してしまっています。\u003c/p\u003e\n\n\u003cp\u003e↓ ↓ ↓\u003c/p\u003e\n\n\u003cp\u003eパッケージとして読み込まれているとは限らない、または必要に応じて \u003ccode\u003e.asmdef\u003c/code\u003e を削除している可能性も考慮して、手あたり次第に対象クラスを探して対象パッケージが存在すれば連携機能を登録します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"n\"\u003eTPoseEditorManager\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PoseEditorManager\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e??\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PoseEditorManager, Assembly-CSharp\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e??\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PoseEditorManager, Assembly-CSharp-Editor\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e??\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PoseEditorManager, PoseEditor\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTPoseEditorManager\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ePluginManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDoSomething\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDoSomething_Impl\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"c-の対象バージョン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#c-%E3%81%AE%E5%AF%BE%E8%B1%A1%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eC# の対象バージョン\u003c/h4\u003e\n\n\u003cp\u003eUnity 2017 LTS が EOL でサポート対象外になって、現行の Unity はすべて C# 7.3 以上を採用という情勢です。\u003c/p\u003e\n\n\u003cp\u003eが、現行バージョンよりも古い Unity にも対応する場合、\u003ccode\u003e?.\u003c/code\u003e（null条件演算子）や \u003ccode\u003e??\u003c/code\u003e（null合体演算子）は C# バージョン６で追加された演算子なので修正する必要があります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"起きうるエラーへの対応\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%B5%B7%E3%81%8D%E3%81%86%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e起きうるエラーへの対応\u003c/h2\u003e\n\n\u003cp\u003eこの構成で開発を進めた場合、連携元と連携プラグインだけがある状態や、プラグインだけを読み込んだ場合にエラーが出ます。\u003c/p\u003e\n\n\u003cp\u003eが、「プラグインを削除してください」でユーザーは対応可能なので許容しています。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e※上で示したように文字列ベースで処理をすればエラーを防げますが、入力補完など開発環境の恩恵を受けることが出来なくなるデバフがかかってしまいます。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eそもそもそういう状態になりにくい構成＆エラー対応に必要な操作もファイルの追加や削除だけなのであまり問題とはならず、また、ユーザーもフォルダー構成や名前から容易にエラーの原因を特定できるので大丈夫でしょう。\u003c/p\u003e\n\n\u003cp\u003eBridge、Adapter、Provider 等々（？）界隈的には適切な命名規則があると思いますが、エンドユーザーに馴染みのある「プラグイン」としているのもそのあたりが理由です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h2\u003e\n\n\u003cp\u003eUnity に限らず C# 界隈でもクラスの有無でプリプロセッサーシンボルの定義をしたがってる人、結構いるみたいですね。調べても方法は見つかりませんでしたが。。。\u003c/p\u003e\n\n\u003cp\u003eC# はそもそもプリプロセッサーにあまり機能を持たせたくない、という設計思想があるようで、今後もそんな機能が実装されることは無さそうです。\u003c/p\u003e\n\n\u003cp\u003eUnity の \u003ccode\u003eAssembly Definition \u0026gt; Version Defines\u003c/code\u003e は必要だけど C# にその機能がない、という問題に対処するために追加された感じがしますね。こういう機能ないと困る！ という人は多かったハズ。\u003c/p\u003e\n\n\u003cp\u003e--\u003c/p\u003e\n\n\u003cp\u003e以上です。お疲れ様でした。\u003c/p\u003e\n\n\n","createdAt":"2021-06-14T12:37:33Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"xAt/U4nT022cwbrVCl87A7UvI2xCIQEkVg==--d/jLKtdaVZQpMCui--/6UCFvu1AlLOT2QbBAH6LQ==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2021-06-14T12:37:33Z","likesCount":0,"linkUrl":"https://qiita.com/sator_imaging/items/efc12675d4f452a64350","organization":null,"originalId":1448952,"stockedCount":1,"title":"クラスやパッケージの有無で処理を切り替える","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%82%E3%81%8F%E3%81%98\"\u003eもくじ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#unity-2019-%E4%BB%A5%E9%99%8D%E3%81%A7%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E6%A9%9F%E8%83%BD%E9%99%90%E5%AE%9A%E3%81%AE%E6%89%8B%E6%B3%95\"\u003eUnity 2019 以降でパッケージ化されている機能限定の手法\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%A4%E3%81%84-unity-%E3%82%84%E9%80%A3%E6%90%BA%E5%AF%BE%E8%B1%A1%E3%81%8C%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88\"\u003e古い Unity や連携対象がパッケージ化されていない場合\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%80%A3%E6%90%BA%E5%85%83%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e連携元の実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E6%9C%AC%E4%BD%93\"\u003e連携機能の本体\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E6%9C%89%E7%84%A1%E3%81%A7%E9%80%A3%E6%90%BA%E6%A9%9F%E8%83%BD%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%82%92%E8%A1%8C%E3%81%86\"\u003eクラスの有無で連携機能の切り替えを行う\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#c-%E3%81%AE%E5%AF%BE%E8%B1%A1%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3\"\u003eC# の対象バージョン\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%B5%B7%E3%81%8D%E3%81%86%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%B8%E3%81%AE%E5%AF%BE%E5%BF%9C\"\u003e起きうるエラーへの対応\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%9B%AE%E6%8C%87%E3%81%99%E3%82%82%E3%81%AE\"\u003e目指すもの\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E7%8F%BE%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF\"\u003e実現するには\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%83%BC%E6%A7%8B%E6%88%90\"\u003eフォルダー構成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A8%B1%E5%AE%B9%E3%81%99%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC\"\u003e許容するエラー\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":879,"uuid":"efc12675d4f452a64350","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"Mmnc5Quy46wvVo7pr5pMQn2P1QGm--F5UtiMo8+qRxmHzT--UgQ1EJNSBzyp2BrMC6iedg==","originalId":376963,"description":"作業用のメモや、読んだ資料のまとめが置いてあります。\r\n\r\nアメドラ好き。　最近は　・プリプロ　・演出シーンやアセットの制作　が半々ぐらいです。　◆ 短編アニメシリーズ　◆ VR進撃の巨人 THE HUMAN RACE　◆ 出資向けVTuber　◆ 版権物スマホゲー","facebookUrl":null,"githubUrl":"https://github.com/sator-imaging","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"サトー","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/376963/af7b578f6aab199d121531bba6ca592a8d402113/x_large.png?1607555152","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F376963%2Faf7b578f6aab199d121531bba6ca592a8d402113%2Fx_large.png%3F1607555152?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=7f3083a2ecdea113ad772e84cd8ce653","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F376963%2Faf7b578f6aab199d121531bba6ca592a8d402113%2Fx_large.png%3F1607555152?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=beed13fd9146a150a27368ef4f63c0a0","urlName":"sator_imaging","websiteUrl":"https://twitter.com/sator_imaging","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity3D","urlName":"unity3d"},{"name":"Unity","urlName":"unity"},{"name":"Unity拡張","urlName":"unity%e6%8b%a1%e5%bc%b5"},{"name":"UnityEditor","urlName":"unityeditor"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
