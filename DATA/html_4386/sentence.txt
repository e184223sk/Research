More than 1 year has passed since last update.次のようなクラスがあり、スタティックの Current プロパティに対して値をセットしたくなりました。ところが、set が private になっているため、通常ではセットできないのでリフレクションを使うことにしました。C# の場合、これは極めて簡単で、Type を取得したのち、値をセットしたり、ゲットしたり、メソッドを実行したりできます。GetProperty と GetMethod 等、アクセスしたい対象に関数メソッドが容易されています。 ポイントとしては、BindingsFlags で、static であること、Public/NonPublic であることを指定して、メソッドやプロパティを検索することです。私が少しだけはまったポイントとしては、Current プロパティは、public ですが、set メソッドが private のため、当初は、NonPublic を指定していました。そうすると、property が null で返ってきてしまいました。この公開レベルは、最初の定義の部分が該当するようですので、それにあわせて、public にすると、property が取得できるようになりました。尚、リフレクションを使うと、private のほうである、set のプロパティも問題なくセットできました。BindingFlags の実装は下記のようになっており、Or をとることで、ビットを立てることで、権限を表現しています。値のセットや取得のリフレクションは極めて簡単でした。ただし、公式ページの CustomBindings の仕様はもう少し理解したいと思っています。これは Azure Functions の内部で使われているものなので、理解したいなと思います。


