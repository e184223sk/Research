More than 1 year has passed since last update.C#のソート方法って色々ありますよね。
検索かけたら、結局どれ使えばいいの？って私はなりました。一項目だけ昇順にソートできればそれでいいって場合や、複数項目を指定したい…って場合あります。
私としては、複数項目をソートしたい場合はLINQが良いと思いました。
超簡単なコンソールアプリ作って理由を説明していきます。上のようなクラスを用意しました。
このクラスのデータを以下のようなルールでソートしたいとします。

・最初に、血液型をO型→A型→AB型→B型の順でソート
・同じ血液型の場合は、組をB組→C組→A組の順でソート
・組も同じ場合は、国語の点数を降順にソート

このような要求があったらどうでしょう？Sortメソッドを使う方法だと結構面倒なんじゃないでしょうか。
少なくとも私は、Sortメソッドを使って引数にComparisonデリゲートを使うやり方を試したら非常につらかったです。ここでLINQが登場するわけです。
上で挙げたルールを満たすLINQを使用したソースコードがこちら。適当にデータをリストに追加したのち、そのデータをソート、表示しております。リストデータの値を調べ、まず血液型がA型の場合は1、Bは3、Oは0、ABは2をresultに代入、リターンします。
リターンしたデータをOrderByは昇順で並べ替えてくれます。つまり、O型→A型→AB型→B型の順ですね。
次に、ThenBy（OrderBy,OrderByDescendingを使うのは最初だけ）でA組所属であれば2、Bは0、Cは1、というように組のソートもOK。
最後にThenByDescendingで国語の成績を降順に評価し並び替えます。この場合は省略していますが、国語の値を返しています。以上のコードでコンソールアプリを構成し、実行した結果がこちら。きちんとルール通り並べ替えられていますね。
ちょっと自分語り入りますが、現在私はこの並び替えルール以上に複雑怪奇な画面表示用データ並び替えを要求されています。
その蹴飛ばしたくなる要求を答えることができたのはLINQの並び替えが強力だったためです。
Sortメソッドも試しましたが、2つ目以降の項目（今回でいうと"組"）の並び替えがどうも辛いというか苦手というか。
ThenByの存在がLINQソートの強みですね。LINQは様々な言語で使えるようです。
駆け出しエンジニアの皆さん、ソートに困ったらLINQ使ってみてください。albireoさんからコメントで保守性の高い書き方を教えて頂きました。以上のような書き方にすることで、
今回出したソートのルールを守ったうえで美しくメンテしやすいコードになりました。htsignさんからタプルを利用する方法を教えて頂きました。例外処理まで含めて簡潔に書けますね。
C#のバージョンが8.0である場合は検討ください。


