More than 1 year has passed since last update.AndroidのToastとかiOSのAlertみたいに、気軽にユーザになにかを通知できるダイアログが欲しくなったので作りました。まずはこんな感じのダイアログを作ってprefabにします。1
ヒエラルキーはまあ適当に。「BackgroundPanel」はダイアログ外のぼんやり灰色っぽくなってる部分です。

一番上のCanvasにDialogHandler.csという自作スクリプトを貼って必要なパーツをinspector上で補填します。
ついでにCanvasのSort Orderへ適当に大きな数字を入れて一番上に表示されるようにします。

完成したらprefabにしてResourcesフォルダに置いときます。
外部に公開するのは以下の3つ。それぞれにコールバックを登録してもらう。
登録の仕方はgif動画を見ながらSampleSceneManager.cs読んでください。
ボタンのコールバックもUnityActionにしようかちょっと迷いましたが、そっちのほうがめんどくさそうなので直に触る方針。ダイアログを呼び出すメソッド。ここだけ読んどけばOK。
デフォルト引数によりボタンの文言がセットされていたらボタンを表示、そうでなかったらボタンを出さない。
ちょっと早くなるかな……と思ってprefabをstaticにキャッシュしている。
static変数を使うといじめられる2Android界隈で育ったのでとても抵抗があるのだけれど、毎回読み込むのも良くない気がするし……ベストプラクティスがよくわからない。
Don't use it.とまで言われたResourcesを使っているが、staticメソッドから手軽にprefab読み込むなら使うしかない気がする。inspectorから登録するEventTriggerがなんか使いづらいので、いつもこうやってスクリプトで登録している。
Android育ちの習性としてViewとロジックが分離されてないとムカつくので。でもUnityの思想的には逆な気はする……。そのまんま。要件で求めたものは達成できたかな、と思います。
ただ、UnityとC#始めて2~3ヶ月の自分が1時間くらいで作った代物なので、Unity熟練者から見たらいろいろアレかなーと……。なんか足りてない気がします。なんか。
AssetStoreで配るまでもないこういう簡単util的なものって需要あると思うので「こうしたらいいよ！」みたいなのあったら教えてください。ていうかもっといいやつ作ってくれたら嬉しいです。おしまい。自分用Unityメモ：EventTriggerにスクリプトからEventを追加する
【Unity】Event Triggerの種類と用途と使い方【保存版】これを見た知人「相変わらず君カラーリングおかしいね」 ↩「あっこいつメンバ変数staticにしてるー！」「うわダッセー！　はいリジェクトー！」 ↩


