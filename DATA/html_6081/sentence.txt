More than 3 years have passed since last update.EntityFrameworkCore下でCodeFirstを使ってテーブルに複合主キーを設定する方法がEntityFramework6下での作法から変わったようなので(今更ですが)正しいやり方を調査しました。下記のようにEntityFramework6の頃の感覚でKeyとColumnのアノテーションで複合主キーの制約を付けたテーブルを書き、DBContextにプロパティ追加してEntityFrameworkCoreを使ったプロジェクトでAdd-Migrationしたところ「複合キーを設定する場合はfluentAPIを使ってください。」とのエラーメッセージが出ました。主キーが1つだけの場合はKeyによる指定もOKぽいですが、複合主キーを設定する場合には使えないようです。残念。ということで今回使えないアノテーションをすべて外し、DBContext側にfluentAPIで複合主キーの制約を書きます。このとき、制約はDBContext.OnModelCreatingをオーバーライドして書き込みます。これで再度Add-Migrationすると...うまく行ったみたいですね！一応Migrationファイルも確認してみます。ちゃんと制約として複合主キーが設定されているようです。よしよし。


