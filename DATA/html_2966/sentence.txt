More than 1 year has passed since last update.SSTPはSakura Script Transfer Protocolです…というお約束を書きつつ。プロトコル、という言葉が出るとついつい特殊な通信方式と捕らえて迷走してしまいますが、フロントエンド風に言えば「JSONでやりとりしてね」(通信自体はHTTP)みたいな感じでしょうか。ヘッダーをBodyに書くのはパケット通信上よく考えれば普通ですが、簡単なHTTPばっかり触っていると思いつかなくなりSSTP通信用のライブラリを探すことに終始してしまいました。まあここを見るのが一番でした。
Pythonで伺かのSSTPを使って通信する方法 - Qiita1あとはここを見てもTCPにのっけるだけということがわかるはず。
Rubyから伺かのSakura Scriptを触る - もち
昔、WindowsのRubyで書いたときは確かにShift_JISにしないと文字化けしました。SSTPに関しては参考元にある
非公式 SSTP/1.x プロトコル仕様書
か
伺か - SSTPプロトコル(テキストエンコードをShift_JISに)
あたりを。This text is sent from Python.(大嘘)C#のTCP通信のコードは以下から
TCPクライアント・サーバープログラムを作成する - .NET Tips (VB.NET,C#...)一応デフォルトのエミリーちゃんでテストしましたが、参考元のPythonのようにちゃんとスクリプトを喋らせることができました。SSP側は事前にちゃんとサーバー設定しておくこと(Windowsなら設定時のファイアーウォールで許可する必要があるかもしれません)C#でもっと手軽に通信するならば、
伺か関連ツール/SSTPLib - Ukiwiki
が有力そうです。
こちらはローカル間での通信を前提として、
SendMessageを使ったプロセス間通信として実現しています。このあたりの単語を押さえておけば調べやすそうです。
ただ、今回はビルド環境がないのと、事前知識がなかったため、既知のTCP通信で送信するスクリプトを作成しました。このようにテキストをゴーストに渡して喋らせたいときはSenderにゴースト名(0側)を渡す。 ↩とあるが、仕様からはいまいち読み取れないので機会があれば要検証。
送信者側なので受けての名前は違和感。


