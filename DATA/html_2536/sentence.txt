More than 1 year has passed since last update.UI AutomationというWindowsのlibraryを使うことで、Windowsフォームを自由に操作することが出来る。これを説明していきたい。まずはUI Automation Spyというソフトウェアをインストールする。
もうバイナリの配布はなくソースコードのみの提供なので、
以下で再配布しているバイナリをダウンロードする。
https://www.code-lab.net/?page_id=21648その後、UI Automation Spyを起動してStartを押す。これにより各フォームのID番号等を得られる。一般的に以下のようなコードからフォームの要素を得ることが出来る。
しかし、UI Automationは全ての子要素を取得しない。これはTree Scopeに何の値を設定してもである。このため、以下のコードからProcessの要素を得る。サンプルコードとして、以下で電卓の計算結果である表示領域から値を持ってくることができる。基本的に全探査してくれるのでIF文を外せば全てのフォームを得られるはずである。よくある手法としては、ProcessStartさせて帰ってきたID番号を取得する方法であるが、複雑なプログラムだと親から子が呼ばれ…等を繰り返すのでプロセスIDが変わることがしばしばある。そこで、起動中のものにアタッチする。


