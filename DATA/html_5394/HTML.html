<!DOCTYPE html><html><head><meta charset="utf-8" /><title>VisualStudioで項目テンプレートを作成する+プロジェクトのプロパティを使う - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/tanitanin/items/0c39169f9e643a03ea1d" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="gbzc0Oe+M2pd/A6h7GwEsEvFer7oiOFlwOwDmV0tG2JviSY9ADMyh2pIduLMlFZFCkerUk4oVAl7OOUqgmrFLQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@tanitanin" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="VisualStudioで項目テンプレートを作成する+プロジェクトのプロパティを使う - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WbWx6ZFdGc1UzUjFaR2x2NDRHbjZhQ0Y1NXV1NDRPRzQ0T3o0NE9YNDRPczQ0Tzg0NE9JNDRLUzVMMmM1b2lRNDRHWjQ0S0xLLU9EbC1PRHJlT0N1T09DcC1PQ3ItT0RpT09CcnVPRGwtT0RyZU9Ea2VPRGh1T0NvLU9Da3VTOXYtT0JoZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz04ZTUwN2QxZjNmOGYxMTAzODNlMGI5MzNjMjdkNDRmZQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSFJoYm1sMFlXNXBiZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWZkNGU0ZDc0N2I1YTQ2MWUyNWMxNWVlNzQwYzJjNzY2&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=79591edb196482725484c58f2f6d26b6"><meta property="og:description" content="

この記事でやること

項目テンプレートの中でcsprojファイルにあるプロパティを使用する方法として↓を順にやる。


項目テンプレートを作成する
VSIXを作成する
ウィザードを作成する
項目テンプレートを修正する



前提
..."><meta content="https://qiita.com/tanitanin/items/0c39169f9e643a03ea1d" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="Windows,C#,VisualStudio2017,vsix" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-876c4dbe-2e10-4b08-8615-5cff3497fb94"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Ftanitanin%2Fitems%2F0c39169f9e643a03ea1d">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Ftanitanin%2Fitems%2F0c39169f9e643a03ea1d">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-876c4dbe-2e10-4b08-8615-5cff3497fb94">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/windows","name":"Windows"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-03-14T01:43:20.000+09:00","dateModified":"2018-03-14T01:43:20.000+09:00","headline":"VisualStudioで項目テンプレートを作成する+プロジェクトのプロパティを使う","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WbWx6ZFdGc1UzUjFaR2x2NDRHbjZhQ0Y1NXV1NDRPRzQ0T3o0NE9YNDRPczQ0Tzg0NE9JNDRLUzVMMmM1b2lRNDRHWjQ0S0xLLU9EbC1PRHJlT0N1T09DcC1PQ3ItT0RpT09CcnVPRGwtT0RyZU9Ea2VPRGh1T0NvLU9Da3VTOXYtT0JoZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz04ZTUwN2QxZjNmOGYxMTAzODNlMGI5MzNjMjdkNDRmZQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSFJoYm1sMFlXNXBiZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWZkNGU0ZDc0N2I1YTQ2MWUyNWMxNWVlNzQwYzJjNzY2\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=79591edb196482725484c58f2f6d26b6","mainEntityOfPage":"https://qiita.com/tanitanin/items/0c39169f9e643a03ea1d","author":{"@type":"Person","address":null,"email":null,"identifier":"tanitanin","name":"tanitanin","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fprofile-images%2F1484370490?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=22239adfeda7562c0bc49bbffc72dfbc","url":"https://qiita.com/tanitanin","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">「作業者の負荷情報の見える化」に取り組む研究者が語る日立の魅力</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tanitanin","type":"items","id":"0c39169f9e643a03ea1d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「作業者の負荷情報の見える化」に取り組む研究者が語る日立の魅力","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tanitanin","type":"items","id":"0c39169f9e643a03ea1d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"「作業者の負荷情報の見える化」に取り組む研究者が語る日立の魅力","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"tanitanin","type":"items","id":"0c39169f9e643a03ea1d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"「作業者の負荷情報の見える化」に取り組む研究者が語る日立の魅力","url":"https://zine.qiita.com/interview/202107-hitachi-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/tanitanin/items/0c39169f9e643a03ea1d","location":"/tanitanin/items/0c39169f9e643a03ea1d","scheme":"https","host":"qiita.com","port":null,"pathname":"/tanitanin/items/0c39169f9e643a03ea1d","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"tSyspC9wJ24FkcBmVFgfnR2DyzOg80pa5Rrsey9c6jJbGVZJyP0mgzIluCV0oE1oXAEa3wZT/zZezgrI8Bs0fQ==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-ef1cd140-d556-4b8e-8bac-f4514fa51771"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/tanitanin/items/0c39169f9e643a03ea1d/likers" class="css-1iupg5d">10</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">17</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/0c39169f9e643a03ea1d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/tanitanin/items/0c39169f9e643a03ea1d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/tanitanin/items/0c39169f9e643a03ea1d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/tanitanin/items/0c39169f9e643a03ea1d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/tanitanin/items/0c39169f9e643a03ea1d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/tanitanin"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/106819/profile-images/1484370490" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/tanitanin" class="css-10ougpm">@<!-- -->tanitanin</a><div class="css-1ay9vb9"><time dateTime="2018-03-13T16:43:20Z" class="css-m19uds">posted at 2018-03-13</time></div></div></div></div></div><h1 class="css-cgzq40">VisualStudioで項目テンプレートを作成する+プロジェクトのプロパティを使う</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/windows" class="css-4czcte">Windows</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/visualstudio2017" class="css-4czcte">VisualStudio2017</a><a href="/tags/vsix" class="css-4czcte">vsix</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="この記事でやること" class="fragment"></span><a href="#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%A7%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>この記事でやること</h1>

<p>項目テンプレートの中でcsprojファイルにあるプロパティを使用する方法として↓を順にやる。</p>

<ul>
<li>項目テンプレートを作成する</li>
<li>VSIXを作成する</li>
<li>ウィザードを作成する</li>
<li>項目テンプレートを修正する</li>
</ul>

<h1>
<span id="前提" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90"><i class="fa fa-link"></i></a>前提</h1>

<p>必要なものは2つ。</p>

<ul>
<li><a href="https://www.visualstudio.com/" rel="nofollow noopener" target="_blank">Visual Studio 2017</a></li>
<li>Visual Studio SDK</li>
</ul>

<h2>
<span id="visual-studio-sdk" class="fragment"></span><a href="#visual-studio-sdk"><i class="fa fa-link"></i></a>Visual Studio SDK</h2>

<p>VisualStudioの拡張機能を作成するためのSDK (以下、VSSDK)。テンプレートだけでなく、Visual Studio のメニューを増やしたりすることもできる。<br>
Visual Studio の Installer から選択してインストールしておく。</p>

<p><a href="https://camo.qiitausercontent.com/d934acd685f7bcd40b4990a94884398e195cbdc6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f63346235643866312d383432612d383839382d373437392d3839646266623734313134662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc4b5d8f1-842a-8898-7479-89dbfb74114f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=691705cca85eff2797f6abbb728374b6" alt="vssdk_installer.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/c4b5d8f1-842a-8898-7479-89dbfb74114f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc4b5d8f1-842a-8898-7479-89dbfb74114f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=570627d05dd8c355ce0eb128f82e2f39 1x" loading="lazy"></a></p>

<p>個別のコンポーネントからも可。</p>

<p><a href="https://camo.qiitausercontent.com/76d85a559010d840c66a5854728c9a7d2fad9d63/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f39303765623065612d656137362d323330662d663632342d3332383733633637383133612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F907eb0ea-ea76-230f-f624-32873c67813a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5871bfca076411f73573d26ed4160181" alt="vssdk_install.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/907eb0ea-ea76-230f-f624-32873c67813a.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F907eb0ea-ea76-230f-f624-32873c67813a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7e5179639f40078980fada1c365990f2 1x" loading="lazy"></a></p>

<p>VSSDKの使い道は↓が参考になる。<br>
<a href="http://tech.tanaka733.net/entry/how-to-find-how-to-develop-vs-sdk" class="autolink" rel="nofollow noopener" target="_blank">http://tech.tanaka733.net/entry/how-to-find-how-to-develop-vs-sdk</a></p>

<h1>
<span id="項目テンプレートとvsix" class="fragment"></span><a href="#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%A8vsix"><i class="fa fa-link"></i></a>項目テンプレートとVSIX</h1>

<p>テンプレートを作成し、拡張機能として「ツール」メニューからインストールできるようにする。</p>

<h2>
<span id="項目テンプレートの作成" class="fragment"></span><a href="#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>項目テンプレートの作成</h2>

<p>C#プロジェクトから、Extensibilityのカテゴリに「C# Item Template」があるので選んでプロジェクトを作成する。</p>

<p><a href="https://camo.qiitausercontent.com/22bb4ba00344647da805e148b6ca57559b56a093/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f34386361623934632d383333332d653232342d343062662d3732663964343663643863322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F48cab94c-8333-e224-40bf-72f9d46cd8c2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8836b79b1c361428cb90bff0f3bafe7e" alt="itemtemplate_proj.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/48cab94c-8333-e224-40bf-72f9d46cd8c2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F48cab94c-8333-e224-40bf-72f9d46cd8c2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a79507e0013b421f6d65073d8270e6c2 1x" loading="lazy"></a></p>

<h3>
<span id="appliestoをわすれない" class="fragment"></span><a href="#appliesto%E3%82%92%E3%82%8F%E3%81%99%E3%82%8C%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>AppliesToをわすれない</h3>

<p>↓のようにプロジェクトが生成される。C#のプロジェクト内で項目を追加できるようにしたい場合は、&lt;AppliesTo&gt;タグを追加してCSharpに指定する。最初の生成時にはないので注意。</p>

<p><a href="https://camo.qiitausercontent.com/66fc58e6ad288f49c1abfc4e06a58bdb0689a895/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f39633634373036392d303031642d393961382d616232352d3062306635616531326661362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9c647069-001d-99a8-ab25-0b0f5ae12fa6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7bb82d5ad69b70fac43d238a1b1336bf" alt="itemtemplate1_app.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/9c647069-001d-99a8-ab25-0b0f5ae12fa6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9c647069-001d-99a8-ab25-0b0f5ae12fa6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=67133a0ecb9684e919b706f293f2f44b 1x" loading="lazy"></a></p>

<p>&lt;ProjectItem&gt;として最初はClass.csが生成される。ReplaceParameter=trueとなっているように、<a href="https://msdn.microsoft.com/ja-jp/library/ms185311.aspx" rel="nofollow noopener" target="_blank">パラメータの置換</a>ができる。<br>
<a href="https://msdn.microsoft.com/ja-jp/library/eehb4faa.aspx" rel="nofollow noopener" target="_blank">使えるパラメータ名</a>には\$itemname\$などあるが、項目テンプレートでは\$projectname\$など使えないものもある。<br>
使えないので仕方なく以降でウィザードをつくる。</p>

<p><a href="https://msdn.microsoft.com/ja-jp/library/eehb4faa.aspx#Anchor_2" rel="nofollow noopener" target="_blank">カスタムパラメータ</a>を使うと自分で置換する組をつくれる。</p>

<h3>
<span id="projectitemはコンテンツにする" class="fragment"></span><a href="#projectitem%E3%81%AF%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ProjectItemはコンテンツにする</h3>

<p>Class.csをProjectItemにしたいときは、ビルドアクションを「コンパイル」から「コンテンツ」にする。(xamlなどでも同じ)</p>

<p><a href="https://camo.qiitausercontent.com/f3f836cfbbc88f4f0830b54101e7ae966859b6f9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f66396532396665342d346464662d633661632d643031652d3236313964316334663763632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Ff9e29fe4-4ddf-c6ac-d01e-2619d1c4f7cc.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8eef1317b643ce5ada4b038e2274cbb2" alt="err.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/f9e29fe4-4ddf-c6ac-d01e-2619d1c4f7cc.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Ff9e29fe4-4ddf-c6ac-d01e-2619d1c4f7cc.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=610009b745955b0f5063daca3d86ede4 1x" loading="lazy"></a></p>

<p>忘れると、\$\$がついたパラメータのままコンパイルされてエラーがたくさん。</p>

<h2>
<span id="vsixの作成" class="fragment"></span><a href="#vsix%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>VSIXの作成</h2>

<p>ただテンプレートを作るだけだとzipを適当な場所に置くことになるが、VSIXをつくっておくと、拡張機能としてインストールとか更新ができるので便利。</p>

<p>ここでは、さっき作成した項目テンプレートのソリューションに新しいプロジェクトを追加する。</p>

<p><a href="https://camo.qiitausercontent.com/0d84b2c3be9cd01e01ea392ebf28cc3da3d39b4b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f30633231383535332d646632622d303737652d386463312d3435316635616265623636352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F0c218553-df2b-077e-8dc1-451f5abeb665.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=bdd003ea00ee8e1accac7447c80cfca5" alt="add_vsix.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/0c218553-df2b-077e-8dc1-451f5abeb665.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F0c218553-df2b-077e-8dc1-451f5abeb665.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2d3f4a6cb94bdd82e1c4b1fd0bf85695 1x" loading="lazy"></a></p>

<p>VSIX Projectを追加したら↓みたいになる。</p>

<p><a href="https://camo.qiitausercontent.com/34e915764c5139e96ef495db4d8d1450a3383aab/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f63356261393062612d653939642d613262312d306665342d6535383538663835366664612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc5ba90ba-e99d-a2b1-0fe4-e5858f856fda.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7351493328ec74b0304aa70a0cb04230" alt="added_vsixproj.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/c5ba90ba-e99d-a2b1-0fe4-e5858f856fda.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc5ba90ba-e99d-a2b1-0fe4-e5858f856fda.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e9b08171f30a66e88526fe29e26a0199 1x" loading="lazy"></a></p>

<h3>
<span id="vsix-projectを作ったらテンプレートを追加" class="fragment"></span><a href="#vsix-project%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%82%89%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E8%BF%BD%E5%8A%A0"><i class="fa fa-link"></i></a>VSIX Projectを作ったら、テンプレートを追加</h3>

<p>生成された「source.extension.vsixmanifest」を選んで↓の1~6の順でItemTemplate1を選ぶとVSIXにテンプレートを追加する。</p>

<p><a href="https://camo.qiitausercontent.com/dfe53cdd424679c6bee2d2a475365943c8e4c286/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f65333630343639392d633239622d653165302d653839312d3963356232366532386133312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fe3604699-c29b-e1e0-e891-9c5b26e28a31.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=aa835ebaed53f81aefca3de9bb0bdc9b" alt="select_itemtemplate.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/e3604699-c29b-e1e0-e891-9c5b26e28a31.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fe3604699-c29b-e1e0-e891-9c5b26e28a31.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=789f7eb47a384e7c690be22857f32c7c 1x" loading="lazy"></a></p>

<p>VSIXをスタートアップ設定してF5でデバッグ実行すると、実験用のVSが立ち上がって拡張機能が追加されているので、項目テンプレートを試しに使ってみることも可。</p>

<h1>
<span id="プロジェクトファイルの情報を使うために" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E4%BD%BF%E3%81%86%E3%81%9F%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>プロジェクトファイルの情報を使うために</h1>

<p>そのままだと使えるパラメータが少ないので、ウィザードを経由して使えるパラメータを増やす。</p>

<h2>
<span id="ウィザードの作成" class="fragment"></span><a href="#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>ウィザードの作成</h2>

<p><qiita-embed-ogp src="https://msdn.microsoft.com/ja-jp/library/ms185301.aspx"></qiita-embed-ogp></p>

<h3>
<span id="テンプレートウィザードはdllを作る" class="fragment"></span><a href="#%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AFdll%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>テンプレートウィザードはdllを作る</h3>

<p>ウィザードはクラスライブラリ(.dll)として作成する。パラメータをユーザが指定するようにしたければ、画面を作ってもよい。(が、パラメータを使いたいだけなので今回はパス。)</p>

<p><a href="https://camo.qiitausercontent.com/f539a74fd1dd03ceaf7b28af358306d154ce8590/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f31346665343833642d643766342d653131642d323565332d3937646135313263333837342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14fe483d-d7f4-e11d-25e3-97da512c3874.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3ece61ce2eca9b8349673643f99fca6e" alt="add_dll.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/14fe483d-d7f4-e11d-25e3-97da512c3874.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14fe483d-d7f4-e11d-25e3-97da512c3874.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bedbdfe51e1490ea2b9b1656446c005c 1x" loading="lazy"></a></p>

<h3>
<span id="iwizardを継承したエントリクラスを作る" class="fragment"></span><a href="#iwizard%E3%82%92%E7%B6%99%E6%89%BF%E3%81%97%E3%81%9F%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AA%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>IWizardを継承したエントリクラスを作る</h3>

<p>IWizardを使うために、クラスライブラリにNuGetでVSSDK.TemplateWizardInterfaceを追加する。参照を右クリック、NuGetパッケージの管理から↓の画面に。</p>

<p><a href="https://camo.qiitausercontent.com/ca4f894626fa04fc5236a8f34ab5151b7234f8e8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f38613533393435632d366163312d643334322d666462302d3965346636636338343162352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F8a53945c-6ac1-d342-fdb0-9e4f6cc841b5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2e7641469b16ac955dfb4b92027f4073" alt="add_nuget.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/8a53945c-6ac1-d342-fdb0-9e4f6cc841b5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F8a53945c-6ac1-d342-fdb0-9e4f6cc841b5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9ac1103c04783842beeac3fc7b13f800 1x" loading="lazy"></a></p>

<p>「Microsoft.VisualStudio.TemplateWizard.IWizard」を継承したクラスをつくる。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">EnvDTE</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.VisualStudio.TemplateWizard</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ClassLibrary1</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span> <span class="p">:</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">VisualStudio</span><span class="p">.</span><span class="n">TemplateWizard</span><span class="p">.</span><span class="n">IWizard</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">BeforeOpeningFile</span><span class="p">(</span><span class="n">ProjectItem</span> <span class="n">projectItem</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">ProjectFinishedGenerating</span><span class="p">(</span><span class="n">Project</span> <span class="n">project</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">ProjectItemFinishedGenerating</span><span class="p">(</span><span class="n">ProjectItem</span> <span class="n">projectItem</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">RunFinished</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">RunStarted</span><span class="p">(</span><span class="kt">object</span> <span class="n">automationObject</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">replacementsDictionary</span><span class="p">,</span> <span class="n">WizardRunKind</span> <span class="n">runKind</span><span class="p">,</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">customParams</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// ここに処理とか画面出したりとかを書く</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">ShouldAddProjectItem</span><span class="p">(</span><span class="kt">string</span> <span class="n">filePath</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// 無条件でProjectItemを生成する</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3>
<span id="プロジェクトのプロパティをとってくる" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E3%81%A8%E3%81%A3%E3%81%A6%E3%81%8F%E3%82%8B"><i class="fa fa-link"></i></a>プロジェクトのプロパティをとってくる</h3>

<p>automationObjectを使って選択中のプロジェクトを探してプロパティを使えるようにするコードを書く。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">RunStarted</span><span class="p">(</span><span class="kt">object</span> <span class="n">automationObject</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">replacementsDictionary</span><span class="p">,</span> <span class="n">WizardRunKind</span> <span class="n">runKind</span><span class="p">,</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">customParams</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 選択中のプロジェクトはActiveSolutionProjectsの配列の先頭にある</span>
    <span class="kt">var</span> <span class="n">dte</span> <span class="p">=</span> <span class="p">(</span><span class="n">EnvDTE</span><span class="p">.</span><span class="n">_DTE</span><span class="p">)</span><span class="n">automationObject</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">array</span> <span class="p">=</span> <span class="n">dte</span><span class="p">.</span><span class="n">ActiveSolutionProjects</span> <span class="k">as</span> <span class="n">Array</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">project</span> <span class="p">=</span> <span class="n">array</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">EnvDTE</span><span class="p">.</span><span class="n">Project</span><span class="p">;</span>

    <span class="c1">// プロジェクトのプロパティをテンプレートで使えるように、置換リストに追加する</span>
    <span class="k">foreach</span><span class="p">(</span><span class="n">Property</span> <span class="n">prop</span> <span class="k">in</span> <span class="n">project</span><span class="p">.</span><span class="n">Properties</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">try</span>
        <span class="p">{</span>
            <span class="n">replacementsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">$"$</span><span class="p">{</span><span class="n">prop</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span><span class="s">$"</span><span class="p">,</span> <span class="n">prop</span><span class="p">.</span><span class="n">Value</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>カスタムテンプレートの辞書に追加したので、項目テンプレートから各パラメータを使用可能になる。</p>

<h3>
<span id="ウィザードを使うにはアセンブリに署名が必要" class="fragment"></span><a href="#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%82%92%E4%BD%BF%E3%81%86%E3%81%AB%E3%81%AF%E3%82%A2%E3%82%BB%E3%83%B3%E3%83%96%E3%83%AA%E3%81%AB%E7%BD%B2%E5%90%8D%E3%81%8C%E5%BF%85%E8%A6%81"><i class="fa fa-link"></i></a>ウィザードを使うにはアセンブリに署名が必要</h3>

<p>クラスライブラリのプロパティから署名を作成します。</p>

<p><a href="https://camo.qiitausercontent.com/6bc055eb7f4045ab1b216e5deeaa0bfb1bd27dc9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f31343631366538612d323934622d636539652d386265312d3137336661306631663166662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14616e8a-294b-ce9e-8be1-173fa0f1f1ff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6de6f4a92bcd0781cff944090d0f4c69" alt="sign.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/14616e8a-294b-ce9e-8be1-173fa0f1f1ff.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14616e8a-294b-ce9e-8be1-173fa0f1f1ff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=99473561b78fb859a9694683dd6caff3 1x" loading="lazy"></a></p>

<p>key.snkが生成されます。ここから、アセンブリの読み込みに必要なパブリックトークンを確認する。(ここ面倒)</p>

<p>参考：「メモ: dllファイルのPublicKeyTokenの確認方法」<br>
 <a href="http://d.hatena.ne.jp/torazuka/20131121/sn" class="autolink" rel="nofollow noopener" target="_blank">http://d.hatena.ne.jp/torazuka/20131121/sn</a></p>

<p>開発者用コマンドプロンプトを開き、sn.exe -T &lt;dllのパス&gt;を使う。</p>

<p><a href="https://camo.qiitausercontent.com/cfaa2a0e6554da6f7f8319a13f94b5a6c44012eb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f63636339663334662d643861632d316265332d356365392d6266656139353132353231372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fccc9f34f-d8ac-1be3-5ce9-bfea95125217.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=aa7b4dfdd3dd61d99fcf130a1d479f05" alt="devcmd.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/ccc9f34f-d8ac-1be3-5ce9-bfea95125217.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fccc9f34f-d8ac-1be3-5ce9-bfea95125217.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=845e410c64621ad078d1498b025393c6 1x" loading="lazy"></a></p>

<p>↓のようにトークンが表示される。あとで使うのでメモしておく。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre class="with-code"><code>Microsoft(R) .NET Framework Strong Name Utility バージョン 4.0.30319.0
Copyright (c) Microsoft Corporation. All rights reserved.

公開キー トークン 7e8b2aa4e85d22d3
</code></pre></div></div>

<h3>
<span id="ウィザードを作成したらvsixに追加" class="fragment"></span><a href="#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%82%92%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%82%89vsix%E3%81%AB%E8%BF%BD%E5%8A%A0"><i class="fa fa-link"></i></a>ウィザードを作成したら、VSIXに追加</h3>

<p>ウィザードが完成したら、今度はAssemblyを選んでVSIXのAssetsに追加する。dllがVSIX内に配置されるようになる。</p>

<p><a href="https://camo.qiitausercontent.com/e72b5141ea625d1799b75b85b5451d0ca85ba489/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f39393230633236312d313739372d323061612d333764352d3833313733656632643466622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9920c261-1797-20aa-37d5-83173ef2d4fb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=08f45af9ab424459aebeb808ce86578a" alt="add_assembly.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/106819/9920c261-1797-20aa-37d5-83173ef2d4fb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9920c261-1797-20aa-37d5-83173ef2d4fb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=152818b5c99cddab603aa7bf6af74141 1x" loading="lazy"></a></p>

<h2>
<span id="項目テンプレートからウィザードが動くようにする" class="fragment"></span><a href="#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%8B%E3%82%89%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%8C%E5%8B%95%E3%81%8F%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>項目テンプレートからウィザードが動くようにする</h2>

<p>ItemTemplate1.vstemplateを開いてWizardExtensionを追加する。</p>

<div class="code-frame" data-lang="xml"><div class="highlight"><pre class="with-code"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;VSTemplate</span> <span class="na">Version=</span><span class="s">"3.0.0"</span> <span class="na">Type=</span><span class="s">"Item"</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/developer/vstemplate/2005"</span> <span class="na">xmlns:sdk=</span><span class="s">"http://schemas.microsoft.com/developer/vstemplate-sdkextension/2010"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;TemplateData&gt;</span>
    <span class="nt">&lt;Name&gt;</span>ItemTemplate1<span class="nt">&lt;/Name&gt;</span>
    ～省略～
  <span class="nt">&lt;/TemplateData&gt;</span>
  <span class="nt">&lt;TemplateContent&gt;</span>
    ～省略～
    <span class="nt">&lt;ProjectItem</span> <span class="na">ReplaceParameters=</span><span class="s">"true"</span><span class="nt">&gt;</span>Class.cs<span class="nt">&lt;/ProjectItem&gt;</span>
  <span class="nt">&lt;/TemplateContent&gt;</span>
  <span class="nt">&lt;WizardExtension&gt;</span>
    <span class="c">&lt;!-- アセンブリ名とバージョン、言語、確認したトークンを入れる --&gt;</span>
    <span class="nt">&lt;Assembly&gt;</span>ClassLibrary1, Version=1.0.0.0, Culture=Neutral, PublicKeyToken=7e8b2aa4e85d22d3<span class="nt">&lt;/Assembly&gt;</span> 
    <span class="c">&lt;!-- IWizardを継承したエントリクラスを名前空間込みで入れる --&gt;</span>
    <span class="nt">&lt;FullClassName&gt;</span>ClassLibrary1.Class1<span class="nt">&lt;/FullClassName&gt;</span>
  <span class="nt">&lt;/WizardExtension&gt;</span>
<span class="nt">&lt;/VSTemplate&gt;</span>
</code></pre></div></div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Ftanitanin%2Fitems%2F0c39169f9e643a03ea1d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Ftanitanin%2Fitems%2F0c39169f9e643a03ea1d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/tanitanin/items/0c39169f9e643a03ea1d/likers" class="css-1iupg5d">10</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">17</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/0c39169f9e643a03ea1d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/tanitanin/items/0c39169f9e643a03ea1d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/tanitanin/items/0c39169f9e643a03ea1d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/tanitanin/items/0c39169f9e643a03ea1d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/tanitanin/items/0c39169f9e643a03ea1d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-ef1cd140-d556-4b8e-8bac-f4514fa51771">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-2b058eb1-5cef-4d54-b957-0da0dea36335"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-2b058eb1-5cef-4d54-b957-0da0dea36335">{}</script>
      
<div id="LoginModal-react-component-6b9ee49d-368e-411d-bf60-35c6a25f1431"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-6b9ee49d-368e-411d-bf60-35c6a25f1431">{}</script>
      
<div id="StockModal-react-component-2791f53b-e093-474e-9412-493a3a155910"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-2791f53b-e093-474e-9412-493a3a155910">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;k/XmcBP8MIFTk8yzJzr4fp8s5CLrWQA7TDRdP4tHNgl9wByd9HExbGQntPAHwqqL3q41zk35tVf34LuMVADoRg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"この記事でやること\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%A7%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eこの記事でやること\u003c/h1\u003e\n\n\u003cp\u003e項目テンプレートの中でcsprojファイルにあるプロパティを使用する方法として↓を順にやる。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e項目テンプレートを作成する\u003c/li\u003e\n\u003cli\u003eVSIXを作成する\u003c/li\u003e\n\u003cli\u003eウィザードを作成する\u003c/li\u003e\n\u003cli\u003e項目テンプレートを修正する\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前提\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提\u003c/h1\u003e\n\n\u003cp\u003e必要なものは2つ。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.visualstudio.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVisual Studio 2017\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eVisual Studio SDK\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"visual-studio-sdk\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#visual-studio-sdk\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eVisual Studio SDK\u003c/h2\u003e\n\n\u003cp\u003eVisualStudioの拡張機能を作成するためのSDK (以下、VSSDK)。テンプレートだけでなく、Visual Studio のメニューを増やしたりすることもできる。\u003cbr\u003e\nVisual Studio の Installer から選択してインストールしておく。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d934acd685f7bcd40b4990a94884398e195cbdc6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f63346235643866312d383432612d383839382d373437392d3839646266623734313134662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc4b5d8f1-842a-8898-7479-89dbfb74114f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=691705cca85eff2797f6abbb728374b6\" alt=\"vssdk_installer.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/c4b5d8f1-842a-8898-7479-89dbfb74114f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc4b5d8f1-842a-8898-7479-89dbfb74114f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=570627d05dd8c355ce0eb128f82e2f39 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e個別のコンポーネントからも可。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/76d85a559010d840c66a5854728c9a7d2fad9d63/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f39303765623065612d656137362d323330662d663632342d3332383733633637383133612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F907eb0ea-ea76-230f-f624-32873c67813a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5871bfca076411f73573d26ed4160181\" alt=\"vssdk_install.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/907eb0ea-ea76-230f-f624-32873c67813a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F907eb0ea-ea76-230f-f624-32873c67813a.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7e5179639f40078980fada1c365990f2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVSSDKの使い道は↓が参考になる。\u003cbr\u003e\n\u003ca href=\"http://tech.tanaka733.net/entry/how-to-find-how-to-develop-vs-sdk\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://tech.tanaka733.net/entry/how-to-find-how-to-develop-vs-sdk\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"項目テンプレートとvsix\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%A8vsix\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e項目テンプレートとVSIX\u003c/h1\u003e\n\n\u003cp\u003eテンプレートを作成し、拡張機能として「ツール」メニューからインストールできるようにする。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"項目テンプレートの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e項目テンプレートの作成\u003c/h2\u003e\n\n\u003cp\u003eC#プロジェクトから、Extensibilityのカテゴリに「C# Item Template」があるので選んでプロジェクトを作成する。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/22bb4ba00344647da805e148b6ca57559b56a093/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f34386361623934632d383333332d653232342d343062662d3732663964343663643863322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F48cab94c-8333-e224-40bf-72f9d46cd8c2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8836b79b1c361428cb90bff0f3bafe7e\" alt=\"itemtemplate_proj.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/48cab94c-8333-e224-40bf-72f9d46cd8c2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F48cab94c-8333-e224-40bf-72f9d46cd8c2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a79507e0013b421f6d65073d8270e6c2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"appliestoをわすれない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#appliesto%E3%82%92%E3%82%8F%E3%81%99%E3%82%8C%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAppliesToをわすれない\u003c/h3\u003e\n\n\u003cp\u003e↓のようにプロジェクトが生成される。C#のプロジェクト内で項目を追加できるようにしたい場合は、\u0026lt;AppliesTo\u0026gt;タグを追加してCSharpに指定する。最初の生成時にはないので注意。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/66fc58e6ad288f49c1abfc4e06a58bdb0689a895/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f39633634373036392d303031642d393961382d616232352d3062306635616531326661362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9c647069-001d-99a8-ab25-0b0f5ae12fa6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7bb82d5ad69b70fac43d238a1b1336bf\" alt=\"itemtemplate1_app.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/9c647069-001d-99a8-ab25-0b0f5ae12fa6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9c647069-001d-99a8-ab25-0b0f5ae12fa6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=67133a0ecb9684e919b706f293f2f44b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;ProjectItem\u0026gt;として最初はClass.csが生成される。ReplaceParameter=trueとなっているように、\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/ms185311.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eパラメータの置換\u003c/a\u003eができる。\u003cbr\u003e\n\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/eehb4faa.aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003e使えるパラメータ名\u003c/a\u003eには\\$itemname\\$などあるが、項目テンプレートでは\\$projectname\\$など使えないものもある。\u003cbr\u003e\n使えないので仕方なく以降でウィザードをつくる。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/eehb4faa.aspx#Anchor_2\" rel=\"nofollow noopener\" target=\"_blank\"\u003eカスタムパラメータ\u003c/a\u003eを使うと自分で置換する組をつくれる。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"projectitemはコンテンツにする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#projectitem%E3%81%AF%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eProjectItemはコンテンツにする\u003c/h3\u003e\n\n\u003cp\u003eClass.csをProjectItemにしたいときは、ビルドアクションを「コンパイル」から「コンテンツ」にする。(xamlなどでも同じ)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f3f836cfbbc88f4f0830b54101e7ae966859b6f9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f66396532396665342d346464662d633661632d643031652d3236313964316334663763632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Ff9e29fe4-4ddf-c6ac-d01e-2619d1c4f7cc.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8eef1317b643ce5ada4b038e2274cbb2\" alt=\"err.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/f9e29fe4-4ddf-c6ac-d01e-2619d1c4f7cc.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Ff9e29fe4-4ddf-c6ac-d01e-2619d1c4f7cc.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=610009b745955b0f5063daca3d86ede4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e忘れると、\\$\\$がついたパラメータのままコンパイルされてエラーがたくさん。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"vsixの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#vsix%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eVSIXの作成\u003c/h2\u003e\n\n\u003cp\u003eただテンプレートを作るだけだとzipを適当な場所に置くことになるが、VSIXをつくっておくと、拡張機能としてインストールとか更新ができるので便利。\u003c/p\u003e\n\n\u003cp\u003eここでは、さっき作成した項目テンプレートのソリューションに新しいプロジェクトを追加する。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0d84b2c3be9cd01e01ea392ebf28cc3da3d39b4b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f30633231383535332d646632622d303737652d386463312d3435316635616265623636352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F0c218553-df2b-077e-8dc1-451f5abeb665.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=bdd003ea00ee8e1accac7447c80cfca5\" alt=\"add_vsix.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/0c218553-df2b-077e-8dc1-451f5abeb665.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F0c218553-df2b-077e-8dc1-451f5abeb665.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2d3f4a6cb94bdd82e1c4b1fd0bf85695 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVSIX Projectを追加したら↓みたいになる。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/34e915764c5139e96ef495db4d8d1450a3383aab/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f63356261393062612d653939642d613262312d306665342d6535383538663835366664612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc5ba90ba-e99d-a2b1-0fe4-e5858f856fda.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7351493328ec74b0304aa70a0cb04230\" alt=\"added_vsixproj.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/c5ba90ba-e99d-a2b1-0fe4-e5858f856fda.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fc5ba90ba-e99d-a2b1-0fe4-e5858f856fda.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e9b08171f30a66e88526fe29e26a0199 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"vsix-projectを作ったらテンプレートを追加\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#vsix-project%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%82%89%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E8%BF%BD%E5%8A%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eVSIX Projectを作ったら、テンプレートを追加\u003c/h3\u003e\n\n\u003cp\u003e生成された「source.extension.vsixmanifest」を選んで↓の1~6の順でItemTemplate1を選ぶとVSIXにテンプレートを追加する。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/dfe53cdd424679c6bee2d2a475365943c8e4c286/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f65333630343639392d633239622d653165302d653839312d3963356232366532386133312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fe3604699-c29b-e1e0-e891-9c5b26e28a31.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=aa835ebaed53f81aefca3de9bb0bdc9b\" alt=\"select_itemtemplate.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/e3604699-c29b-e1e0-e891-9c5b26e28a31.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fe3604699-c29b-e1e0-e891-9c5b26e28a31.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=789f7eb47a384e7c690be22857f32c7c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVSIXをスタートアップ設定してF5でデバッグ実行すると、実験用のVSが立ち上がって拡張機能が追加されているので、項目テンプレートを試しに使ってみることも可。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"プロジェクトファイルの情報を使うために\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E4%BD%BF%E3%81%86%E3%81%9F%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクトファイルの情報を使うために\u003c/h1\u003e\n\n\u003cp\u003eそのままだと使えるパラメータが少ないので、ウィザードを経由して使えるパラメータを増やす。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ウィザードの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eウィザードの作成\u003c/h2\u003e\n\n\u003cp\u003e\u003cqiita-embed-ogp src=\"https://msdn.microsoft.com/ja-jp/library/ms185301.aspx\"\u003e\u003c/qiita-embed-ogp\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"テンプレートウィザードはdllを作る\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AFdll%E3%82%92%E4%BD%9C%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテンプレートウィザードはdllを作る\u003c/h3\u003e\n\n\u003cp\u003eウィザードはクラスライブラリ(.dll)として作成する。パラメータをユーザが指定するようにしたければ、画面を作ってもよい。(が、パラメータを使いたいだけなので今回はパス。)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f539a74fd1dd03ceaf7b28af358306d154ce8590/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f31346665343833642d643766342d653131642d323565332d3937646135313263333837342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14fe483d-d7f4-e11d-25e3-97da512c3874.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3ece61ce2eca9b8349673643f99fca6e\" alt=\"add_dll.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/14fe483d-d7f4-e11d-25e3-97da512c3874.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14fe483d-d7f4-e11d-25e3-97da512c3874.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bedbdfe51e1490ea2b9b1656446c005c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"iwizardを継承したエントリクラスを作る\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#iwizard%E3%82%92%E7%B6%99%E6%89%BF%E3%81%97%E3%81%9F%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AA%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%92%E4%BD%9C%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eIWizardを継承したエントリクラスを作る\u003c/h3\u003e\n\n\u003cp\u003eIWizardを使うために、クラスライブラリにNuGetでVSSDK.TemplateWizardInterfaceを追加する。参照を右クリック、NuGetパッケージの管理から↓の画面に。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/ca4f894626fa04fc5236a8f34ab5151b7234f8e8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f38613533393435632d366163312d643334322d666462302d3965346636636338343162352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F8a53945c-6ac1-d342-fdb0-9e4f6cc841b5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2e7641469b16ac955dfb4b92027f4073\" alt=\"add_nuget.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/8a53945c-6ac1-d342-fdb0-9e4f6cc841b5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F8a53945c-6ac1-d342-fdb0-9e4f6cc841b5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9ac1103c04783842beeac3fc7b13f800 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「Microsoft.VisualStudio.TemplateWizard.IWizard」を継承したクラスをつくる。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eEnvDTE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eMicrosoft.VisualStudio.TemplateWizard\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eClassLibrary1\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eClass1\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMicrosoft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eVisualStudio\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTemplateWizard\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIWizard\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eBeforeOpeningFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProjectItem\u003c/span\u003e \u003cspan class=\"n\"\u003eprojectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eProjectFinishedGenerating\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProject\u003c/span\u003e \u003cspan class=\"n\"\u003eproject\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eProjectItemFinishedGenerating\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProjectItem\u003c/span\u003e \u003cspan class=\"n\"\u003eprojectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunFinished\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunStarted\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003eautomationObject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ereplacementsDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eWizardRunKind\u003c/span\u003e \u003cspan class=\"n\"\u003erunKind\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ecustomParams\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// ここに処理とか画面出したりとかを書く\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eShouldAddProjectItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 無条件でProjectItemを生成する\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"プロジェクトのプロパティをとってくる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E3%81%A8%E3%81%A3%E3%81%A6%E3%81%8F%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクトのプロパティをとってくる\u003c/h3\u003e\n\n\u003cp\u003eautomationObjectを使って選択中のプロジェクトを探してプロパティを使えるようにするコードを書く。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRunStarted\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003eautomationObject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ereplacementsDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eWizardRunKind\u003c/span\u003e \u003cspan class=\"n\"\u003erunKind\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003ecustomParams\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 選択中のプロジェクトはActiveSolutionProjectsの配列の先頭にある\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edte\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEnvDTE\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_DTE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eautomationObject\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edte\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActiveSolutionProjects\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eproject\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eEnvDTE\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eProject\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// プロジェクトのプロパティをテンプレートで使えるように、置換リストに追加する\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProperty\u003c/span\u003e \u003cspan class=\"n\"\u003eprop\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eproject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ereplacementsDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"$\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eprop\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e$\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprop\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eカスタムテンプレートの辞書に追加したので、項目テンプレートから各パラメータを使用可能になる。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ウィザードを使うにはアセンブリに署名が必要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%82%92%E4%BD%BF%E3%81%86%E3%81%AB%E3%81%AF%E3%82%A2%E3%82%BB%E3%83%B3%E3%83%96%E3%83%AA%E3%81%AB%E7%BD%B2%E5%90%8D%E3%81%8C%E5%BF%85%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eウィザードを使うにはアセンブリに署名が必要\u003c/h3\u003e\n\n\u003cp\u003eクラスライブラリのプロパティから署名を作成します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/6bc055eb7f4045ab1b216e5deeaa0bfb1bd27dc9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f31343631366538612d323934622d636539652d386265312d3137336661306631663166662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14616e8a-294b-ce9e-8be1-173fa0f1f1ff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6de6f4a92bcd0781cff944090d0f4c69\" alt=\"sign.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/14616e8a-294b-ce9e-8be1-173fa0f1f1ff.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F14616e8a-294b-ce9e-8be1-173fa0f1f1ff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=99473561b78fb859a9694683dd6caff3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ekey.snkが生成されます。ここから、アセンブリの読み込みに必要なパブリックトークンを確認する。(ここ面倒)\u003c/p\u003e\n\n\u003cp\u003e参考：「メモ: dllファイルのPublicKeyTokenの確認方法」\u003cbr\u003e\n \u003ca href=\"http://d.hatena.ne.jp/torazuka/20131121/sn\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://d.hatena.ne.jp/torazuka/20131121/sn\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e開発者用コマンドプロンプトを開き、sn.exe -T \u0026lt;dllのパス\u0026gt;を使う。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/cfaa2a0e6554da6f7f8319a13f94b5a6c44012eb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f63636339663334662d643861632d316265332d356365392d6266656139353132353231372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fccc9f34f-d8ac-1be3-5ce9-bfea95125217.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=aa7b4dfdd3dd61d99fcf130a1d479f05\" alt=\"devcmd.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/ccc9f34f-d8ac-1be3-5ce9-bfea95125217.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fccc9f34f-d8ac-1be3-5ce9-bfea95125217.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=845e410c64621ad078d1498b025393c6 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e↓のようにトークンが表示される。あとで使うのでメモしておく。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eMicrosoft(R) .NET Framework Strong Name Utility バージョン 4.0.30319.0\nCopyright (c) Microsoft Corporation. All rights reserved.\n\n公開キー トークン 7e8b2aa4e85d22d3\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ウィザードを作成したらvsixに追加\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%82%92%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%82%89vsix%E3%81%AB%E8%BF%BD%E5%8A%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eウィザードを作成したら、VSIXに追加\u003c/h3\u003e\n\n\u003cp\u003eウィザードが完成したら、今度はAssemblyを選んでVSIXのAssetsに追加する。dllがVSIX内に配置されるようになる。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e72b5141ea625d1799b75b85b5451d0ca85ba489/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3130363831392f39393230633236312d313739372d323061612d333764352d3833313733656632643466622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9920c261-1797-20aa-37d5-83173ef2d4fb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=08f45af9ab424459aebeb808ce86578a\" alt=\"add_assembly.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/106819/9920c261-1797-20aa-37d5-83173ef2d4fb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2F9920c261-1797-20aa-37d5-83173ef2d4fb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=152818b5c99cddab603aa7bf6af74141 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"項目テンプレートからウィザードが動くようにする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%8B%E3%82%89%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%8C%E5%8B%95%E3%81%8F%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e項目テンプレートからウィザードが動くようにする\u003c/h2\u003e\n\n\u003cp\u003eItemTemplate1.vstemplateを開いてWizardExtensionを追加する。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\"1.0\" encoding=\"utf-8\"?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;VSTemplate\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"3.0.0\"\u003c/span\u003e \u003cspan class=\"na\"\u003eType=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Item\"\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/developer/vstemplate/2005\"\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:sdk=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"http://schemas.microsoft.com/developer/vstemplate-sdkextension/2010\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;TemplateData\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;Name\u0026gt;\u003c/span\u003eItemTemplate1\u003cspan class=\"nt\"\u003e\u0026lt;/Name\u0026gt;\u003c/span\u003e\n    ～省略～\n  \u003cspan class=\"nt\"\u003e\u0026lt;/TemplateData\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;TemplateContent\u0026gt;\u003c/span\u003e\n    ～省略～\n    \u003cspan class=\"nt\"\u003e\u0026lt;ProjectItem\u003c/span\u003e \u003cspan class=\"na\"\u003eReplaceParameters=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"true\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eClass.cs\u003cspan class=\"nt\"\u003e\u0026lt;/ProjectItem\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/TemplateContent\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;WizardExtension\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c\"\u003e\u0026lt;!-- アセンブリ名とバージョン、言語、確認したトークンを入れる --\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;Assembly\u0026gt;\u003c/span\u003eClassLibrary1, Version=1.0.0.0, Culture=Neutral, PublicKeyToken=7e8b2aa4e85d22d3\u003cspan class=\"nt\"\u003e\u0026lt;/Assembly\u0026gt;\u003c/span\u003e \n    \u003cspan class=\"c\"\u003e\u0026lt;!-- IWizardを継承したエントリクラスを名前空間込みで入れる --\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;FullClassName\u0026gt;\u003c/span\u003eClassLibrary1.Class1\u003cspan class=\"nt\"\u003e\u0026lt;/FullClassName\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/WizardExtension\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/VSTemplate\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n","createdAt":"2018-03-13T16:43:20Z","elapsedYearsFromLastModifiedAt":3,"encryptedId":"0zYDN3WxvXUd7N5sKdTwcjGzz+ap062X--WoOQS/ggjzV0t5ph--2OcEloCSs0Fz3Eg3XixFaw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2018-03-13T16:43:20Z","likesCount":10,"linkUrl":"https://qiita.com/tanitanin/items/0c39169f9e643a03ea1d","organization":null,"originalId":618966,"stockedCount":17,"title":"VisualStudioで項目テンプレートを作成する+プロジェクトのプロパティを使う","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%A7%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8\"\u003eこの記事でやること\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%8F%90\"\u003e前提\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#visual-studio-sdk\"\u003eVisual Studio SDK\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%A8vsix\"\u003e項目テンプレートとVSIX\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e項目テンプレートの作成\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#appliesto%E3%82%92%E3%82%8F%E3%81%99%E3%82%8C%E3%81%AA%E3%81%84\"\u003eAppliesToをわすれない\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#projectitem%E3%81%AF%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E3%81%AB%E3%81%99%E3%82%8B\"\u003eProjectItemはコンテンツにする\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#vsix%E3%81%AE%E4%BD%9C%E6%88%90\"\u003eVSIXの作成\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#vsix-project%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%82%89%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E8%BF%BD%E5%8A%A0\"\u003eVSIX Projectを作ったら、テンプレートを追加\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E4%BD%BF%E3%81%86%E3%81%9F%E3%82%81%E3%81%AB\"\u003eプロジェクトファイルの情報を使うために\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90\"\u003eウィザードの作成\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AFdll%E3%82%92%E4%BD%9C%E3%82%8B\"\u003eテンプレートウィザードはdllを作る\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#iwizard%E3%82%92%E7%B6%99%E6%89%BF%E3%81%97%E3%81%9F%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AA%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%92%E4%BD%9C%E3%82%8B\"\u003eIWizardを継承したエントリクラスを作る\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E3%81%A8%E3%81%A3%E3%81%A6%E3%81%8F%E3%82%8B\"\u003eプロジェクトのプロパティをとってくる\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%82%92%E4%BD%BF%E3%81%86%E3%81%AB%E3%81%AF%E3%82%A2%E3%82%BB%E3%83%B3%E3%83%96%E3%83%AA%E3%81%AB%E7%BD%B2%E5%90%8D%E3%81%8C%E5%BF%85%E8%A6%81\"\u003eウィザードを使うにはアセンブリに署名が必要\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%82%92%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%82%89vsix%E3%81%AB%E8%BF%BD%E5%8A%A0\"\u003eウィザードを作成したら、VSIXに追加\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%A0%85%E7%9B%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%8B%E3%82%89%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%8C%E5%8B%95%E3%81%8F%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\"\u003e項目テンプレートからウィザードが動くようにする\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":6637,"uuid":"0c39169f9e643a03ea1d","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"XXKqXhFjRvKwdHVRZ/+j2mslRhXI--fVvDhG2zEUx5C/NY--0Rig+eoVqjY7CBM+uPi1kg==","originalId":106819,"description":"","facebookUrl":null,"githubUrl":"https://github.com/tanitanin","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/106819/profile-images/1484370490","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fprofile-images%2F1484370490?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=e1c2fd306f9d927792d1a9618dfd0bff","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F106819%2Fprofile-images%2F1484370490?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=22239adfeda7562c0bc49bbffc72dfbc","urlName":"tanitanin","websiteUrl":null,"twitterUrl":"https://twitter.com/tanitanin","twitterUrlName":"tanitanin","revealedOrganizations":{"edges":[]}},"tags":[{"name":"Windows","urlName":"windows"},{"name":"C#","urlName":"csharp"},{"name":"VisualStudio2017","urlName":"visualstudio2017"},{"name":"vsix","urlName":"vsix"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
