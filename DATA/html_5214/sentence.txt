More than 3 years have passed since last update.まあ表題で完結してるんですが、一応事細かに書いて行きたいと思います。
先に言っておくと運用コストとかルールブックの著作権だとかでいろいろ問題があるのでBotの公開はありません。ダイスロールをしてくれるDiscordのBotといえば Sidekick などが有名で、多くのTRPGサーバーで使用されています。
例えば /r 1d100 と打てば100面ダイスのダイスロールをしてくれます。便利ですね。TRPGといえば有名所で言えばSW2.0や、DX3rdですね。僕の参加しているDiscordグループでもやはりこの2つがメジャーです(本当はネクロニカとかアリアンロッドもしたいんですけど)。
そしてSW2.0(ソード・ワールド2.0)でよくやる処理と言えばなどがあります。
DX3rd(ダブルクロス The 3rd Edition)でよくやる処理といえばなどがあります。
これを通常のダイスロールで行うのは面倒です。
まあ、サイコロを1つ1つ転がして一喜一憂する楽しみも否定されるべきではないと思いますが、それなら(Botを)使わなければいいだけの話なので僕は作ります。必要です。C#です。今回Botを制作するにあたりを使っています。まずDiscordのBotをサクッと作ります。
これについてはググれば ■ここ とか ■ここ とか ■ここ とかが出てくるので紹介しません。いわゆる--helpコマンドですね。これはなんてことはなくて、一部抜粋すればみたいに書けばいいだけです。楽でいいわ。ありがとうDiscord.NETの人。これも楽で、App.configに&lt;connectionStrings&gt;を書いていろいろ書いてたらできます。とか書いてコマンドの方からRunSqlを呼び出してあげれば楽でいいです。でいけると思います。最初からUIAutomationに挑むのは難関なので、試しにRemoteTalkという便利なものが用意されている棒読みちゃんに喋らせます。
つまり

Discord -&gt; 拙作プログラム1 -&gt; RemoteTalk.exe -&gt; 棒読みちゃん -&gt; 拙作プログラム2 -&gt; Discord

でやります。Processで呼んであげるだけなので楽です。Nullチェックとか各種検査(例えばmessageに棒読みちゃんに有効なパラメータとかが入ってた場合とか、| rm -rfとか)をしてないのが気になりますが、いいんです。コストがかかるだけです。YAGNIだよ兄貴。これが問題で、まず1つ思いついたのはNET DUETTOの出力を入力にしてくれるデバイスを拝借して、葵ちゃんの出力をマイクとして使用する方法です。

葵ちゃん -&gt; 《NET DUETTO(出力) -&gt; NET DUETTO(入力)》 -&gt; 拙作プログラム2 -&gt; Discord

で、多分これで問題ないと思うんですが、どうやってコード上でBotのマイクを設定すればいいんでしょうか……？そんなニッチな需要のものググっても流石に出てこないだろうしな～～～出ました。神か。…………
(ソースコード)読めない……という訳でバイナリをありがたく拝借し、この項目についてはひとまず完成となりました。詳しく知りたいならDiscord Audio Stream Botのリポジトリを見るといいぞ。僕は諦めました。卓をやっていると、その時間に普段のGeneralなボイチャから、特定のシステムのボイチャに集まりたいことがあります。
ググってもあまり出てこなくて地味にハマったところなので一応。ソースコード中のClientは接続済みのDiscordSocketClientです。でできます。


