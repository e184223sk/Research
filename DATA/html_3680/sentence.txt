アプリ開発をしている際に、サーバーとのネットワークを接続状態をチェックする必要がありましたが、サーバー名(ホストネーム)からIPアドレスを取得しなければいけませんでした。
マイクロソフトのドキュメントにDns.GetHostEntry メソッドがありそれを参考に作成しました。
そこにこんなサンプルがありました。このサンプルだと、ホストネームからアドレスを取得した際に、ipv6とipv4の両方を取得してしまいました。
自分が作成していたアプリでは、取得したアドレスをもとにpingでネットワークを確認するようにしていましたが、ipv6は時間がかかり、パフォーマンスに問題が起きてしまいました。サンプルで取得できたhost.AddressListのうち、どれがipv4か確認する方法がわかればいいです。
調べるとIPAddress.AddressFamily プロパティというものがありました。それを見ると、「IPv4 の場合は InterNetwork、IPv6 の場合は InterNetworkV6 を返します」とありました。
これを参考にして以下のようにサンプルを書き換えました。これで問題なくipv4のアドレスを取得して、ping確認することができるようになりました。


