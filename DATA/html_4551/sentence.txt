More than 1 year has passed since last update.まず、先人にお礼を。
サイボウズガルーンを利用しており、管理等いろいろ簡易化できないかと考えている際に、次の記事を参考にさせて頂きました。ありがとうございました。
VisualStudio2017でガルーンAPIを使ってメッセージを送ってみる
VisualStudio2017でガルーンAPIを使ってファイル添付メッセージを送ってみるQiitaにも初投稿で、過去にクライアントサーバー間の通信プログラムを作ったこともないので、おかしな所があれば教えて下さい。上記記事と同様にAdminBindigクラスからAdmin系のAPIを利用しようとしてもエラーが出てしまうことに直面。調べても次の記事のとおりSOAP通信のレスポンスをうまく取れないと…。なんとかしてAdmin系のAPIを利用したい。
C# ガルーンAPI WSDL参照追加後のコードについて・Visual Studio 2010(古くてごめんなさい)
・サイボウス ガルーン(パッケージ版 Ver 4.2.4)WSDL参照を追加し、Reference.csを修正するまでは、参考にさせて頂いた下記記事と同様です。
VisualStudio2017でガルーンAPIを使ってメッセージを送ってみる本記事では、代表例として、AdminGetUserDetailByIds関数を利用する場合の実装内容を記載します。主に記載するクラスは以下の2つです。
・「SoapAdmin」
・「MyAdminGetUserDetailByIds」
SoapAdminクラスはスーパークラスで、それを継承するMyAdminGetUserDetailByIdsクラスというクラス関係にしています。
これは、各関数ごとにその関数に対応するサブクラスを追加していけば、各関数を利用できるようにしたかったのでこういうクラス関係にしました。細かく書きましたが、一言で言うと、「AdminBindingクラス使えねーから、自作してやんよ。」というお話です。まずはスーパークラスであるSoapAdminクラスを実装。　
次にサブクラスであるMyAdminGetUserDetailByIdsを実装。詳しくは分かりませんが、デシリアライズ時に失敗するので、Reference.csを修正。
XmlTypeAttributeのnamespaceを変更する。
修正箇所は、「//修正start」から「//修正end」まで。他のAPIを利用する際に、レスポンスをデシリアライズした結果が空になってしまう場合は、この修正が必要な場合が多いです。
（自分のデシリアライズの仕方が悪いというのもあると思いますが。）上記が完了すれば準備は終わりです。
利用する方法を次のソースで示します。以上になります。色々試してみたり調べてみたりしましたが、結局AdminBindingを利用した場合にレスポンスが空になる原因は分からず、諦めました。


