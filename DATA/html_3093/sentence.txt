More than 1 year has passed since last update.マッチメイキングの処理はオンラインゲームにはかかせないですよね。でもマッチメイキングを実装しようとすると、やりたいことはプレイヤーに適切なルームやバトルのIDを渡したいだけなんですが、様々なルール（プレイヤーのレベルやレートの考慮、1vs1 or チームバトル or バトルロイヤル）や排他制御を考える必要があって大変です。そんなマッチメイキングを PlayFab を使えば簡単に実装できると聞いたので試してみました。※今回は複雑なルールは取り上げません。
※マッチメイキングは Public Preview の機能です。GameManager へログインし、マルチプレイヤー &gt; マッチメイキング &gt; 新しいキューをクリックします。
キューの構成を変更してキューを作成します。
必須項目は キュー名 と 対戦人数 です。
今回は 1vs1 のマッチングを作りますので、それっぽいキュー名を指定し、対戦人数は必ず2人なので 2to2 に設定しておきます。
キューができました。
GameManager での事前準備はここまでです。
Unity でこんなコードを書いてみました。
これを動かすと先に張ったサンプルのようにシンプルな1vs1のマッチングを行うことができます。実際のゲームではレートやレベル差によって、初心者と上級者のマッチングを分けたりしますよね。PlayFab ではどのように制御すればよいのか試してみました。先程キューを作ったときは最低限の内容しか定義しませんでした。
今回は以下のようなルールを追加してみます。このルールを追加することで、Rate の差が 101 以上のプレイヤー同士はマッチングしなくなります。
先程のコードではチケット内の MatchmakingPlayer には Entity 情報しか含んでいませんでした。
今回は Rate の情報をもたせるために Attributes を使用します。これだけでレートやレベル差を考慮したマッチングを実装することができました。
これは楽で良いですね。今回はマッチメイキングの基本の部分を触ってみました。まだ公式ドキュメントを読み切れていないのですが、PlayFab のマッチメイキング機能はもっと複雑なマッチングルールやチームバトルにも対応しているということですので、引き続き触ってみようと思います。


