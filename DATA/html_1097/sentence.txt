More than 1 year has passed since last update.自分の知識を共有するページを書くのはこれが初めてです。
初心者なので稚拙な文章かもしれません。@ktz_aliasさんにコメントを頂いて、おそらく一番正しい方法が分かったため、記事を修正します。
コメントありがとうございます。「CreateWindowExでウィンドウを生成する時に、追加したWindowClassを指定すると、ウィンドウの生成に失敗する」
という問題の解決必要な部分にCharSet=CharSet.Unicode属性を記述すれば解決します。CreateWindowExの値WindowClassNameは byte配列で受け取る。
WindowClassNameに渡す文字列は Unicode で byte配列に変換して渡す。おそらく、この記事を読んでいる人は
CreateWindowExの定義部分WindowClassNameは string型になっていると思う。実はWindowClassNameを１文字の string 又は char にしてもウィンドウの生成に成功する。
が、複数文字列の string だと失敗する。
難しいことはあまり分からないが、色々試した結果たどり着いた答えは「文字コードの違い」だった。CreateWindowExの定義部分で、WindowClassNameの型をushortにして、
CreateWindowExを呼ぶ時に、RegisterClassExの戻り値をWindowClassに渡すことでも成功する。


