More than 3 years have passed since last update.このご時世、行動予定をクラウド上で管理するということはもう大分浸透していると思いますが、基本的な機能のため、様々な SaaS で実装されている機能でもあります。利用している複数の SaaS に行動予定やカレンダーのような機能が備わっているとしたら、それらを同期しなければなりません。CDataドライバーを利用すれば、こういったデータ同期を行うアプリケーションの作成を行うことができます。このアプリケーションの概要は次の通りです。それでは、このサンプルアプリケーションの開発手順を見ていきます。このサンプルアプリケーションのソースコードはこちらからどうぞ。※ソースコードについて補足
このソースコードでは接続情報をアプリケーションの設定に格納しています。
動作させる際は、アプリケーション設定のConnectionStringSalesforceにSalesforce用の接続文字列を、ConnectionStringSharePointにSharePoint用の接続文字列を設定してください。
それぞれの接続文字列は以下のようになります。
Salesforce → Password=&lt;パスワード&gt;;Security Token=&lt;セキュリティトークン&gt;;User=&lt;ユーザ名&gt;
SharePoint → Password=&lt;パスワード&gt;;Share Point Edition="SharePoint Online";URL=;User=&lt;ユーザ名&gt;まずは CData Software をインストールします。今回必要になるのは、次の2つです。Visual Studio を起動し、新しいWindowsフォームアプリケーションのプロジェクトを作成します。インストールした CData Software の2製品には、いくつかのADO.NETアセンブリが含まれています。
今回必要になるのは次の2つのDLLですので、これらをプロジェクトの参照設定で追加します。Salesforce および SharePoint へのデータ接続を作成します。
以下のオンラインマニュアルを参考にして、2つのデータ接続を作成します。
Salesforce用
SharePoint用メインのフォームを追加します。
このフォームには、次のコンポーネントを追加します。追加したデータグリッドビューに、データソースの設定を行います。
左側のデータグリッドビューで「DataGridView タスク」→「データソースの選択」→「プロジェクト データソースの追加」を選択します。「データソースの種類の選択」では「データベース」を選択して「次へ」ボタンをクリックします。次の画面では「データセット」を選択して「次へ」ボタンをクリックします。データ接続の選択では、データ接続を作成で作成したSalesforceのデータ接続を選択して「次へ」ボタンをクリックします。次の画面で接続文字列をアプリケーションに保存するかどうか選択できますが、ここでは任意に選択し、「次へ」ボタンをクリックします。最後にデータベースオブジェクトの選択を行います。
今回はSalesforceの「行動」を対象としますので、Eventのチェックボックスにチェックを入れます。
データセット名は SalesforceDataSet として、「完了」ボタンをクリックします。同じようにして、SharePoint側もデータソースの設定を行います。
SharePoint側は、作成済みのカレンダー(ここでは"Salesforce予定表")をデータベースオブジェクトとして選択します。これで、データグリッドビューへのデータの読み込みまでが行えるようになりました。ここまで、全くコーディングは必要ありません。
メインフォームには、データ読み込みのためのコードが自動生成されています。※ワンポイント
SharePointのAPIの仕様で、デフォルトでは30日分のデータが取得されます。これをもっと広い期間にしたい場合は、SharePointDataSet.xsdデザイナーで開く → Salesforce予定表を右クリック → 「構成」から構成ウィザードを開く とSQLステートメントを入力できるので、次のようなWHERE句を指定します。フォームデザイナで「インポート」ボタンをダブルクリックして、クリック時の処理を実装します。
ここでは、件名が同じであれば同じデータであると判断します。実装は以上です。アプリケーションを起動すると、データグリッドビューにデータが読み込まれます。移行したい行を選択して「インポート」ボタンをクリックすると、選択したデータが SharePoint に登録されます。


