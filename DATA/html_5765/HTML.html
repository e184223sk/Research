<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#(Unity)でのアダプティブコード入門(デザインパターンとSOLID原則) - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/hareruyanosuke/items/48c82f32a8ecf8bd0c7d" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="NTOkuJ0AFElGI36LoZ75QoiHs1fXkFxl2bCGB5gcMnV0FY2/IZsYkALAd1+GnwWHE4P0loY6wll9/AkozK7THA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="C#(Unity)でのアダプティブコード入門(デザインパターンとSOLID原則) - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReU1vVlc1cGRIa3A0NEduNDRHdTQ0S2k0NE9BNDRPWDQ0T0c0NEtqNDRPVzQ0S3o0NE84NDRPSjVZV2w2WmFBS09PRGgtT0N0dU9DcE9PRHMtT0RrZU9Ddi1PRHZPT0RzLU9CcUZOUFRFbEU1WTZmNVltSEtRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWQ1ZTM2NjFhYmU0YzMxZmI2MDVkYzA1MDIyZDVmYTM3&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR2hoY21WeWRYbGhibTl6ZFd0bCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWQzMmJjZTdmM2IyY2U1MzgwMDZkZWEyYTAzZTY2NDY3&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=2f4248ab25fc5fce9f4bcd9f123292b8"><meta property="og:description" content="この記事は Akatsuki Advent Calendar 2017 の 9 日目の記事です。
8日目: システム障害解析におけるログのあれこれ


概要

今年読んだ記事・本の中で、個人的に最もためになったのがマイクロソフト公式解..."><meta content="https://qiita.com/hareruyanosuke/items/48c82f32a8ecf8bd0c7d" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,デザインパターン,SOLID" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-cf00fdb1-4765-404c-bdf8-f02ff9949792"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fhareruyanosuke%2Fitems%2F48c82f32a8ecf8bd0c7d">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fhareruyanosuke%2Fitems%2F48c82f32a8ecf8bd0c7d">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-cf00fdb1-4765-404c-bdf8-f02ff9949792">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-12-09T16:19:46.000+09:00","dateModified":"2019-02-20T21:01:20.000+09:00","headline":"C#(Unity)でのアダプティブコード入門(デザインパターンとSOLID原則)","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReU1vVlc1cGRIa3A0NEduNDRHdTQ0S2k0NE9BNDRPWDQ0T0c0NEtqNDRPVzQ0S3o0NE84NDRPSjVZV2w2WmFBS09PRGgtT0N0dU9DcE9PRHMtT0RrZU9Ddi1PRHZPT0RzLU9CcUZOUFRFbEU1WTZmNVltSEtRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWQ1ZTM2NjFhYmU0YzMxZmI2MDVkYzA1MDIyZDVmYTM3\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR2hoY21WeWRYbGhibTl6ZFd0bCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWQzMmJjZTdmM2IyY2U1MzgwMDZkZWEyYTAzZTY2NDY3\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=2f4248ab25fc5fce9f4bcd9f123292b8","mainEntityOfPage":"https://qiita.com/hareruyanosuke/items/48c82f32a8ecf8bd0c7d","author":{"@type":"Person","address":"","email":null,"identifier":"hareruyanosuke","name":"hareruyanosuke","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars.githubusercontent.com%2Fu%2F17594708%3Fv%3D3?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=f72281126c79d2811330736fd8dab2bb","url":"https://qiita.com/hareruyanosuke","description":"","memberOf":[{"@type":"Organization","address":"東京都品川区上大崎2-13-30 oak meguro","legalName":"株式会社アカツキ","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/6b9078539946826ea9b0365ebdbc50b888d83d37/original.jpg?1462502511","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/077ebe6bfb994e8a881a54e6443fce69b41a385c/original.jpg?1462502511","identifier":"aktsk","description":"株式会社アカツキは、スマートフォンゲームの企画開発を中心に事業を展開しております。創業以来全てのゲームを内製しているため、高い技術ノウハウが蓄積されています。今後は、新規事業の立ち上げも行ってまいります。"}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"hareruyanosuke","type":"items","id":"48c82f32a8ecf8bd0c7d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"hareruyanosuke","type":"items","id":"48c82f32a8ecf8bd0c7d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"hareruyanosuke","type":"items","id":"48c82f32a8ecf8bd0c7d"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/hareruyanosuke/items/48c82f32a8ecf8bd0c7d","location":"/hareruyanosuke/items/48c82f32a8ecf8bd0c7d","scheme":"https","host":"qiita.com","port":null,"pathname":"/hareruyanosuke/items/48c82f32a8ecf8bd0c7d","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"qvU7ra20kTLPBlN9i9Va8S6C7gM/FwpshddU2+ZYOpPr0xKqES+d64vlWqms1KY0tYapwm69lFAhm9v0surb+g==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-882764f7-aab5-4895-bb78-e800b775bc4f"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/likers" class="css-1iupg5d">74</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">80</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/48c82f32a8ecf8bd0c7d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><a href="/organizations/aktsk"><img src="https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/077ebe6bfb994e8a881a54e6443fce69b41a385c/original.jpg?1462502511" class="it-AdcalRibbon_orgImage"/></a><span><a href="/advent-calendar/2017/aktsk" class="it-AdcalRibbon_title">Akatsuki<!-- --> Advent Calendar<!-- --> <!-- -->2017</a>Day 9</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/hareruyanosuke"><img class="css-100alwu eyfquo10" src="https://avatars.githubusercontent.com/u/17594708?v=3" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/hareruyanosuke" class="css-10ougpm">@<!-- -->hareruyanosuke</a><div class="css-1ay9vb9"><span><meta content="2017-12-09T07:19:46Z"/><time dateTime="2019-02-20T12:01:20Z" class="css-m19uds">updated at 2019-02-20</time></span></div></div></div></div></div><h1 class="css-cgzq40">C#(Unity)でのアダプティブコード入門(デザインパターンとSOLID原則)</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/%e3%83%87%e3%82%b6%e3%82%a4%e3%83%b3%e3%83%91%e3%82%bf%e3%83%bc%e3%83%b3" class="css-4czcte">デザインパターン</a><a href="/tags/solid" class="css-4czcte">SOLID</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>この記事は <a href="https://qiita.com/advent-calendar/2017/aktsk">Akatsuki Advent Calendar 2017</a> の 9 日目の記事です。<br>
8日目: <a href="https://qiita.com/akihiro-nagai/items/103418a244bb308e7e72" id="reference-41f92a42a56f20f716e4">システム障害解析におけるログのあれこれ</a></p>

<h1>
<span id="概要" class="fragment"></span><a href="#%E6%A6%82%E8%A6%81"><i class="fa fa-link"></i></a>概要</h1>

<p>今年読んだ記事・本の中で、個人的に最もためになったのがマイクロソフト公式解説書の「<a href="https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477" rel="nofollow noopener" target="_blank">C#実践開発手法</a>」でした。</p>

<p>内容としては、変化に容易に適応できるコード(アダプティブコード)を実現するために、以下の手法をC#でどのように実践するかを解説する本です。</p>

<ul>
<li>アジャイル開発</li>
<li>デザインパターン</li>
<li>SOLID原則</li>
</ul>

<p>C#に携わって1~2年ぐらいの方には是非おすすめしたいのですが、440ページあったりしてサラッと読むには若干辛いです。<br>
というわけで、宣伝・復習用にUnityのサンプルプロジェクトと共に基本の要点をまとめました。</p>

<p>※ あくまで自分にとって役に立った部分をまとめたもので、書籍より基礎的かつ部分的になります。<br>
※ 興味のある方は本屋さんとかで手にとって読んで頂ければと思います。</p>

<h2>
<span id="この記事が役立つ可能性がある方" class="fragment"></span><a href="#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%8C%E5%BD%B9%E7%AB%8B%E3%81%A4%E5%8F%AF%E8%83%BD%E6%80%A7%E3%81%8C%E3%81%82%E3%82%8B%E6%96%B9"><i class="fa fa-link"></i></a>この記事が役立つ可能性がある方</h2>

<p>C#・Unityを書き始めて1~2年ぐらいで、SOLID原則などは普段使っていない方</p>

<p>※ デザインパターン・SOLID原則に慣れ親しんでいる方には全く役に立ちません</p>

<h2>
<span id="記事を書いている人" class="fragment"></span><a href="#%E8%A8%98%E4%BA%8B%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%84%E3%82%8B%E4%BA%BA"><i class="fa fa-link"></i></a>記事を書いている人</h2>

<p>新卒でUnityのゲーム開発プロジェクトに入って1年5ヵ月目ぐらいの、2年目Lv.1のクライアントエンジニア<br>
Unityでの開発とJenkinsのお世話がお仕事です。</p>

<h1>
<span id="hello-adaptive-code" class="fragment"></span><a href="#hello-adaptive-code"><i class="fa fa-link"></i></a>Hello "Adaptive Code"</h1>

<p>改めてまして、はじめまして、 <a href="/hareruyanosuke" class="user-mention js-hovercard" title="hareruyanosuke" data-hovercard-target-type="user" data-hovercard-target-name="hareruyanosuke">@hareruyanosuke</a> です。<br>
本記事は「アダプティブコード」の入門編の記事になります。(書籍『<a href="https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477" rel="nofollow noopener" target="_blank">C#実践開発手法</a>』の導入です。)<br>
アダプティブコードとは小さな変更量で仕様の変化に対応するコードです。</p>

<p><strong>アダプティブコード＝変化に強いコード</strong></p>

<p>普段、おそらく実務で開発を行っている方も個人で開発を行っている方も、たびたび遭遇するのが<strong>仕様の変更</strong>です。<br>
僕も1年ほど新規開発プロジェクトを通して実感したのですが、まぁとにかく仕様は変わります。<br>
最終的なアウトプットよりも、仕様変更に対応した物量の方が多そうです。</p>

<p>そんなこんなで、アダプティブコードは身に付けるととても有用です。<br>
仕様変更と日夜戦っている方が、この記事の手法を通して少しでも精神的ダメージを減らせてもらえるとうれしいです<br>
(アダプティブコードを身に付けても物理的ダメージは変わらないですが。)</p>

<p>本章では、まずアダプティブコードの真逆、ノンアダプティブコード(不適応なコード)について説明します。</p>

<h2>
<span id="ノンアダプティブコード" class="fragment"></span><a href="#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>ノンアダプティブコード</h2>

<p>アダプティブコードの説明の前に、まずノンアダプティブコード(適応力の低いコード)について見てみましょう。<br>
ノンアダプティブコードには幾つかの特徴が見られることが多いです。</p>

<h3>
<span id="硬直性が高い" class="fragment"></span><a href="#%E7%A1%AC%E7%9B%B4%E6%80%A7%E3%81%8C%E9%AB%98%E3%81%84"><i class="fa fa-link"></i></a>硬直性が高い</h3>

<p>抽象化が欠如していたり責務が混在していることが多いと、コードの変更にリスクが伴い硬直性が高くなります。<br>
抽象化が欠如されたコードは、クラスの実体や内部仕様に依存したコードをクライアント側が書かなければならなくなります。<br>
また、責務が混在したコードでは、目的が1つではないモジュールが含まれることで、どこか1箇所の変更が意図しない他のコードへ波及されることが往々にあります。</p>

<h3>
<span id="テスタビリティの欠如" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%82%BF%E3%83%93%E3%83%AA%E3%83%86%E3%82%A3%E3%81%AE%E6%AC%A0%E5%A6%82"><i class="fa fa-link"></i></a>テスタビリティの欠如</h3>

<p>テストが難しかったり、テストに時間がかかる場合、テストは十分に行われません。<br>
そして、テストが不十分なコードには不具合がありますし、<strong>変更した際のリスクが極端に高くなります。</strong></p>

<h4>
<span id="スカイフックとクレーン" class="fragment"></span><a href="#%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF%E3%81%A8%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>スカイフックとクレーン</h4>

<p>テスタビリティを確認する上で、スカイフックとクレーンの比喩が参考になります。<br>
スカイフックとは、先行条件を参照せずに何かを説明する方法のことです。<br>
これに対し、クレーンは説明可能な先行条件が存在するものを言います。</p>

<p>プログラミングにはテスタビリティを下げるスカイフックが幾つか存在しますが、それらを置き換えられるクレーンも存在します。</p>

<h5>
<span id="プログラミングにおけるスカイフック" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF"><i class="fa fa-link"></i></a>プログラミングにおけるスカイフック</h5>

<ul>
<li>静的メソッド</li>
<li>静的クラス(シングルトンを含む)</li>
<li>newを使用するオブジェクトの生成</li>
<li>拡張メソッド</li>
</ul>

<h5>
<span id="スカイフックを置き換えるクレーン" class="fragment"></span><a href="#%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF%E3%82%92%E7%BD%AE%E3%81%8D%E6%8F%9B%E3%81%88%E3%82%8B%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>スカイフックを置き換えるクレーン</h5>

<ul>
<li>インターフェイス</li>
<li>依存性の注入(DI)</li>
<li>制御の反転</li>
<li>ファクトリ</li>
</ul>

<h3>
<span id="メトリクス的に良くない" class="fragment"></span><a href="#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9%E7%9A%84%E3%81%AB%E8%89%AF%E3%81%8F%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>メトリクス的に良くない</h3>

<ul>
<li>ユニットテストのカバレッジが低い</li>
<li>循環的複雑度が高い</li>
</ul>

<p>上記2つは統計的に不具合数と相関します。</p>

<h2>
<span id="ノンアダプティブコードの実例" class="fragment"></span><a href="#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%AE%9F%E4%BE%8B"><i class="fa fa-link"></i></a>ノンアダプティブコードの実例</h2>

<p>ここまでノンアダプティブコードの特徴を説明しましたが、やけに文字ばっかりで分かりづらいですね。<br>
そこで、具体的な例として、今回は昔の僕のコードを引っ張り出してきました。</p>

<h3>
<span id="サンプルプロジェクトの説明" class="fragment"></span><a href="#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>サンプルプロジェクトの説明</h3>

<p>この記事の説明で用いているコードのリポジトリは以下になります。<br>
<a href="https://github.com/tsukiwo55216/UniDAO" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/tsukiwo55216/UniDAO</a></p>

<p>今回ノンアダプティブコード・アダプティブコードのサンプルとして、<strong>Android・iOSのローカルストレージにデータを保存する機能</strong>を選択しました。<br>
(小さいコードで書けるわりに工夫できるところが多かった。)</p>

<p>また、簡単のためシリアライズ・デシリアライズにはUnityのJsonUtilityを使用しており、<br>
JsonUtilityが対応していないクラスは非対応にする方針を取りました。</p>

<h3>
<span id="昔の実装ノンアダプティブコード" class="fragment"></span><a href="#%E6%98%94%E3%81%AE%E5%AE%9F%E8%A3%85%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>昔の実装(ノンアダプティブコード)</h3>

<p>去年の僕が同等の仕様で作成したコードを作りなおしたものになります。<br>
エラー部分は省き、見せちゃダメな部分は消しました。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">// Scripts/Old/DataAccessObject.cs</span>

<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">UniDAO.Old</span>
<span class="p">{</span>
    <span class="c1">// クライアントのデータ保存・読み込み・削除・存在確認</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DataAccessObject</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">BasePath</span> <span class="p">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">persistentDataPath</span> <span class="p">+</span> <span class="s">"/DAO/"</span><span class="p">;</span>


        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">Extention</span> <span class="p">=</span> <span class="s">".json"</span><span class="p">;</span>


        <span class="c1">// 存在確認</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">Exists</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nf">ExistsFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// カスタムクラスを読み込み</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">T</span> <span class="n">Read</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="nf">ReadFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">default</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="n">FromJson</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// カスタムクラスを保存</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Save</span><span class="p">(</span> <span class="kt">object</span> <span class="n">data</span><span class="p">,</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="nf">ToJson</span><span class="p">(</span> <span class="n">data</span> <span class="p">);</span>
            <span class="nf">OverWriteFile</span><span class="p">(</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// 削除</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Delete</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">DeleteFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>
        <span class="p">}</span>


        <span class="c1">// パスの取得</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">BasePath</span> <span class="p">+</span> <span class="s">"/"</span> <span class="p">+</span> <span class="n">fileName</span> <span class="p">+</span> <span class="n">Extention</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// ファイルの存在確認</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">ExistsFile</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>
            <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// ファイルの読み込み</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">ReadFile</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="nf">ExistsFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">null</span><span class="p">;</span>

            <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// ファイルの上書き</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">OverWriteFile</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">text</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">BasePath</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">Directory</span><span class="p">.</span><span class="nf">CreateDirectory</span><span class="p">(</span> <span class="n">BasePath</span> <span class="p">);</span>

            <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="nf">DeleteFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>
            <span class="n">File</span><span class="p">.</span><span class="nf">WriteAllText</span><span class="p">(</span> <span class="n">path</span><span class="p">,</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// ファイルの削除</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">DeleteFile</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="k">if</span><span class="p">(</span> <span class="nf">Exists</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">File</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="c1">// Scripts/Old/Example/Example.cs</span>
    <span class="c1">// 使用例</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Example</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
    <span class="p">{</span>
        <span class="c1">// データ保存用クラス</span>
        <span class="p">[</span><span class="n">Serializable</span><span class="p">]</span>
        <span class="k">private</span> <span class="k">class</span> <span class="nc">TestData</span>
        <span class="p">{</span>
            <span class="k">public</span> <span class="kt">string</span> <span class="n">testString</span><span class="p">;</span>
            <span class="k">public</span> <span class="kt">int</span>    <span class="n">testInt</span><span class="p">;</span>


            <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="k">return</span>   <span class="s">"Test Data :: "</span>
                       <span class="p">+</span> <span class="s">"Test String : "</span> <span class="p">+</span> <span class="n">testString</span> <span class="p">+</span> <span class="s">", "</span>
                       <span class="p">+</span> <span class="s">"Test Int : "</span> <span class="p">+</span> <span class="n">testInt</span><span class="p">;</span> 
            <span class="p">}</span>
        <span class="p">}</span>


        <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">testData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TestData</span><span class="p">();</span>
            <span class="p">{</span>
                <span class="n">testData</span><span class="p">.</span><span class="n">testString</span> <span class="p">=</span> <span class="s">"string"</span><span class="p">;</span>
                <span class="n">testData</span><span class="p">.</span><span class="n">testInt</span> <span class="p">=</span> <span class="m">15</span><span class="p">;</span>
            <span class="p">}</span>


            <span class="c1">// 保存</span>
            <span class="n">DataAccessObject</span><span class="p">.</span><span class="nf">Save</span><span class="p">(</span> <span class="n">testData</span><span class="p">,</span> <span class="s">"fileName"</span> <span class="p">);</span>

            <span class="c1">// 読み込み</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">DataAccessObject</span><span class="p">.</span><span class="n">Read</span><span class="p">&lt;</span><span class="n">TestData</span><span class="p">&gt;(</span> <span class="s">"fileName"</span> <span class="p">).</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">);</span>

            <span class="c1">// 存在確認</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">DataAccessObject</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="s">"fileName"</span> <span class="p">)</span> <span class="p">);</span>

            <span class="c1">// 削除</span>
            <span class="n">DataAccessObject</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span> <span class="s">"fileName"</span> <span class="p">);</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">DataAccessObject</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="s">"fileName"</span> <span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


</code></pre></div></div>

<h3>
<span id="どこがノンアダプティブか" class="fragment"></span><a href="#%E3%81%A9%E3%81%93%E3%81%8C%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%81%8B"><i class="fa fa-link"></i></a>どこがノンアダプティブか？</h3>

<p>去年の僕はわりとしっかり実装したつもりだったのですが、変化に対応できるかという視点で見ると工夫できる余地はたくさんあります。<br>
ノンアダプティブコードの特徴から考えてみます。</p>

<h4>
<span id="硬直性" class="fragment"></span><a href="#%E7%A1%AC%E7%9B%B4%E6%80%A7"><i class="fa fa-link"></i></a>硬直性</h4>

<p>一見するとコードが短いこともあり、硬直性は低そうですが、各メソッドの責務が多く(ReadメソッドではIO処理・デシリアライズなど)、変更に対する拡張ポイントが用意されていません。</p>

<p>そのため、暗号化・復号化などの処理もこのクラスに追加されていき、結果としてクラスの責務や依存度がどんどん大きくなることが予想されます。<br>
(実際に、これらは追加された仕様です。)</p>

<h4>
<span id="テスタビリティ" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%82%BF%E3%83%93%E3%83%AA%E3%83%86%E3%82%A3"><i class="fa fa-link"></i></a>テスタビリティ</h4>

<p>低いです、問題点としては以下の点があげられます。</p>

<ul>
<li>全ての公開メソッドがIO処理を行っている</li>
<li>メソッドの責務が複数あるため、テストコードが複雑になりがち</li>
</ul>

<p>また、スカイフックである静的メソッド・クラスにも引っかかっていますね。<br>
(ただ、こちらはこのクラスの使用用途を考えるとそこまで問題では無さそうです。)</p>

<h4>
<span id="メトリクス" class="fragment"></span><a href="#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9"><i class="fa fa-link"></i></a>メトリクス</h4>

<p>循環的複雑度は問題無さそう、というか循環度が問題になる規模じゃないですね。<br>
ユニットテストのカバレッジは単体テストを行っていないので0%でした。</p>

<h2>
<span id="アダプティブコード" class="fragment"></span><a href="#%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>アダプティブコード</h2>

<p>ようやくアダプティブコードの説明まで辿り着けましたが、実はアダプティブコードには「適応力が高い」以外にそんなに明確な定義が無さそうです。(書籍から探す限り)</p>

<p>ただ、これだけだとあまりにもふわっとしているので、<strong>個人的に</strong>以下の条件満たしているコードを「良いアダプティブコード」としています。</p>

<ul>
<li>ほどよい拡張ポイントがある＝将来発生しそうな仕様変更に対する拡張ポイントがある</li>
<li>ノンアダプティブコードでは無い</li>
</ul>

<h3>
<span id="ほどよい拡張ポイントがある" class="fragment"></span><a href="#%E3%81%BB%E3%81%A9%E3%82%88%E3%81%84%E6%8B%A1%E5%BC%B5%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%8C%E3%81%82%E3%82%8B"><i class="fa fa-link"></i></a>ほどよい拡張ポイントがある</h3>

<p>適応力を考える上で大事な視点が、「実際に拡張されるかどうか」ということだと思います。<br>
適応力が高くても実際に仕様変更で拡張ポイントが使われなければ意味がありませんし、<br>
拡張ポイントを作るコストが変更コストより高くなっても意味がありません。</p>

<p>というわけであくまで個人的な意見ですが、拡張ポイントに関してはプロジェクト状況的に起こり得て、かつ現実的な工数で出来る程度に作っておくことが良いかと思います。<br>
(ただ、プランナーやディレクターがどういう風に変更したくなるかは運ですが。)</p>

<h3>
<span id="ノンアダプティブコードでは無い" class="fragment"></span><a href="#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E3%81%AF%E7%84%A1%E3%81%84"><i class="fa fa-link"></i></a>ノンアダプティブコードでは無い</h3>

<p>上の方でノンアダプティブコードとはアダプティプではないコードと言っているので「？？？」となりそうです。<br>
しかし、ノンアダプティブコードはアダプティブコードよりも明確な特徴があり、アンチパターンを避けていくと良い感じになるという経験則もあるのでこの要件を採用してます。</p>

<h1>
<span id="try-adaptive-code" class="fragment"></span><a href="#try-adaptive-code"><i class="fa fa-link"></i></a>Try "Adaptive Code"</h1>

<p>本章では、前章で紹介したノンアダプティブコードをアダプティブコードに変更し、主要な手法の説明を行います。</p>

<h2>
<span id="アダプティプコードを実践するための武器" class="fragment"></span><a href="#%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%97%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%AE%9F%E8%B7%B5%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E6%AD%A6%E5%99%A8"><i class="fa fa-link"></i></a>アダプティプコードを実践するための武器</h2>

<p>書籍内では様々な手法が紹介されていますが、大きく分けると次のようになります。</p>

<ul>
<li>依存関係の管理</li>
<li>インターフェイス</li>
<li>デザインパターン</li>
<li>TDD(テスト駆動開発)</li>
<li>SOLID原則

<ul>
<li>
<strong>S</strong>RP : 単一責務の原則(Single Responsibility Principle)</li>
<li>
<strong>O</strong>CP : 開放/閉鎖の原則(Open/Closed Principle)</li>
<li>
<strong>L</strong>SP : リスコフの置換原則(Liskov Substitution Principle)</li>
<li>
<strong>I</strong>SP : インターフェイス分離の原則(the Interface Segregation Principle)</li>
<li>
<strong>D</strong>IP : 依存性反転の原則(Dependency Inversion Principle)</li>
</ul>
</li>
</ul>

<p>次節からは、サンプルプロジェクトで使用した中で特に効果のあった手法の説明を行っていきます。</p>

<h2>
<span id="武器の実例" class="fragment"></span><a href="#%E6%AD%A6%E5%99%A8%E3%81%AE%E5%AE%9F%E4%BE%8B"><i class="fa fa-link"></i></a>武器の実例</h2>

<p>サンプルプロジェクトのReadメソッドは、クライアントのJSONファイルを読み込み指定されたクラスとして返すメソッドです。<br>
とてもシンプルなコードではありますが、今回サンプルプロジェクトで使ったアダプティブコードの武器が全て含まれています。<br>
ですので、ここからはReadメソッドに着目して、変化への適応力を上がるための工夫を説明していきます。</p>

<p>まず、改めて昔のコードをのせます。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">UniDAO.Old</span>
<span class="p">{</span>
    <span class="c1">// Scripts/Old/DataAccessObject.cs</span>
       <span class="c1">// クライアントのデータ読み込み</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DataAccessObject</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">BasePath</span> <span class="p">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">persistentDataPath</span> <span class="p">+</span> <span class="s">"/DAO/"</span><span class="p">;</span>


        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">Extention</span> <span class="p">=</span> <span class="s">".json"</span><span class="p">;</span>



        <span class="k">public</span> <span class="k">static</span> <span class="n">T</span> <span class="n">Read</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="nf">ReadFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">default</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="n">FromJson</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>


        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">BasePath</span> <span class="p">+</span> <span class="s">"/"</span> <span class="p">+</span> <span class="n">fileName</span> <span class="p">+</span> <span class="n">Extention</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">ExistsFile</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>
            <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">ReadFile</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="nf">MakeFilePath</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="nf">ExistsFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">null</span><span class="p">;</span>

            <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>昔のReadメソッドでの問題点を再掲しておきます。<br>
 - IO処理があり、実行環境がテストに影響する。<br>
 - 責務が複数ある。(IO処理・デシリアライズ)<br>
 - 拡張ポイントが無く、仕様変更によりこのメソッドが変更され責務が増大する可能性が高い。</p>

<p>それでは、今回アダプティブコードを意識して作成したサンプルの旧Readメソッドに対応する部分を見てみましょう。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code>
<span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
    <span class="c1">// Scripts/Main/IRead.cs</span>
    <span class="c1">// インターフェイス：読み込み</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="n">T</span> <span class="nf">Read</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="c1">// Scripts/Main/Factory/DaoFactory.cs</span>
    <span class="c1">// IReadの作成</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DaoFactory</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">basePath</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">fileName</span><span class="p">;</span>


        <span class="k">private</span> <span class="nf">DaoFactory</span><span class="p">(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">basePath</span> <span class="p">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">persistentDataPath</span> <span class="p">+</span> <span class="s">"/DAO/"</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">fileName</span> <span class="p">=</span> <span class="n">fileName</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="k">static</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">CreateReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">DaoFactory</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">).</span><span class="n">CreateReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>
        <span class="p">}</span>


        <span class="k">private</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">CreateReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">textReader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TextReader</span><span class="p">(</span> <span class="n">basePath</span><span class="p">,</span> <span class="n">fileName</span> <span class="p">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">DeserializeReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">textReader</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="c1">// Scripts/Main/Read/TextReader.cs</span>
    <span class="c1">// テキストの読み込み</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">TextReader</span> <span class="p">:</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">basePath</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">fileName</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">TextReader</span><span class="p">(</span> <span class="kt">string</span> <span class="n">basePath</span><span class="p">,</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">basePath</span> <span class="p">=</span> <span class="n">basePath</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">fileName</span> <span class="p">=</span> <span class="n">fileName</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="kt">string</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="n">basePath</span> <span class="p">+</span> <span class="n">fileName</span><span class="p">;</span>

            <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">basePath</span> <span class="p">)</span> <span class="p">||</span> <span class="p">!</span><span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">path</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">null</span><span class="p">;</span>

            <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="c1">// Scripts/Main/Read/DeserializeReader.cs</span>
    <span class="c1">// Jsonを指定されたクラスとして読み込み</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DeserializeReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">DeserializeReader</span><span class="p">(</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">stringReader</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="n">T</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">.</span><span class="nf">Read</span><span class="p">();</span>

            <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">default</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="n">FromJson</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="c1">// Scripts/Main/Example/Example.cs</span>
    <span class="c1">// 使用例</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Example</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
    <span class="p">{</span>
        <span class="c1">// データ保存用クラス</span>
        <span class="p">[</span><span class="n">Serializable</span><span class="p">]</span>
        <span class="k">private</span> <span class="k">class</span> <span class="nc">TestData</span>
        <span class="p">{</span>
            <span class="k">public</span> <span class="kt">string</span> <span class="n">testString</span><span class="p">;</span>
            <span class="k">public</span> <span class="kt">int</span>    <span class="n">testInt</span><span class="p">;</span>


            <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="nf">ToString</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="k">return</span>   <span class="s">"Test Data :: "</span>
                       <span class="p">+</span> <span class="s">"Test String : "</span> <span class="p">+</span> <span class="n">testString</span> <span class="p">+</span> <span class="s">", "</span>
                       <span class="p">+</span> <span class="s">"Test Int : "</span> <span class="p">+</span> <span class="n">testInt</span><span class="p">;</span> 
            <span class="p">}</span>
        <span class="p">}</span>


        <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Data Access Objectの取得</span>
            <span class="kt">var</span> <span class="n">testDataDAO</span> <span class="p">=</span> <span class="n">DaoFactory</span><span class="p">.</span><span class="n">Create</span><span class="p">&lt;</span><span class="n">TestData</span><span class="p">&gt;(</span> <span class="s">"fileName"</span> <span class="p">);</span>

            <span class="kt">var</span> <span class="n">testData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TestData</span><span class="p">();</span>
            <span class="p">{</span>
                <span class="n">testData</span><span class="p">.</span><span class="n">testString</span> <span class="p">=</span> <span class="s">"test"</span><span class="p">;</span>
                <span class="n">testData</span><span class="p">.</span><span class="n">testInt</span> <span class="p">=</span> <span class="m">99</span><span class="p">;</span>
            <span class="p">}</span>


            <span class="c1">// 保存</span>
            <span class="n">testDataDAO</span><span class="p">.</span><span class="nf">Save</span><span class="p">(</span> <span class="n">testData</span> <span class="p">);</span>

            <span class="c1">// 読み込み</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">testDataDAO</span><span class="p">.</span><span class="nf">Read</span><span class="p">().</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">);</span>

            <span class="c1">// 存在確認</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">testDataDAO</span><span class="p">.</span><span class="nf">Exists</span><span class="p">()</span> <span class="p">);</span>

            <span class="c1">// 削除</span>
            <span class="n">testDataDAO</span><span class="p">.</span><span class="nf">Delete</span><span class="p">();</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">testDataDAO</span><span class="p">.</span><span class="nf">Exists</span><span class="p">()</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


</code></pre></div></div>

<p>一見するとクラス数もコード量も増えており、複雑になっただけの様な気がしますね。<br>
ここは落ち着いて、武器を見ていきましょう。</p>

<h3>
<span id="武器その1単一責務の原則single-responsibility-principle" class="fragment"></span><a href="#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE1%E5%8D%98%E4%B8%80%E8%B2%AC%E5%8B%99%E3%81%AE%E5%8E%9F%E5%89%87single-responsibility-principle"><i class="fa fa-link"></i></a>武器その1：単一責務の原則(Single Responsibility Principle)</h3>

<p>はじめに使っている武器は、<a href="https://qiita.com/gomi_ningen/items/02c42e2487d035f9c3c8" id="reference-0ee68476b5a03e448172">単一責務の原則</a>です。<br>
単一責務の原則は、「クラスを変更する理由は複数存在してはならない」というものです。<br>
この原則は、複数の責務が割り当てられたクラスをより小さなクラスへ分割します。<br>
今回のサンプルプロジェクトでは、旧Readメソッドが持っていた「ファイルの読み込み」・「デシリアライズ」という責務が、TextReaderとDeserializeReaderへ分離されています。</p>

<p>実際に、クラスの責務が減少すると何が良いのでしょうか？<br>
まず、1つ言えることは単体テストを行いやすくなります。<br>
旧Readメソッドをテストする場合、「ファイルの読み込み」・「デシリアライズ」の処理を組み合わせたテストを書かなければなりません。<br>
しかし、責務の分割によりそれぞれに特化した単体テストを書けるようになります。</p>

<p>また、責務を分割すると自然に処理の委譲が行われ、モックの使用が容易になります。<br>
例えば、DeserializeReaderはテキストの読み込み処理を外部から注入されたオブジェクトに委譲しているので、<br>
以下のMockStringReaderの様なモックを使用することが出来ます。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">// Test/Scripts/MockStringReader.cs</span>
<span class="c1">// 簡単なモック</span>

<span class="k">using</span> <span class="nn">UniDAO</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">UniDAO.Test</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">MockStringReader</span> <span class="p">:</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">cache</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">MockStringReader</span><span class="p">(</span> <span class="kt">string</span> <span class="n">cache</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">cache</span> <span class="p">=</span> <span class="n">cache</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="kt">string</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">cache</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>また、分離されたクラス毎に単体テストを用意しておくことで、デシリアライザをJsonUtilityから変更する場合や<br>
読み込み先をDBに変更する場合にそれぞれのテストを変更するだけで対応できます。</p>

<p>そして、単一責務の原則の最大の利点はクラスが小さくなることかと思います。<br>
小さく役割が明確なクラスは使いやすいですし、何より可読性が高いです。</p>

<h3>
<span id="武器その2decoratorパターン" class="fragment"></span><a href="#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE2decorator%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>武器その2：Decoratorパターン</h3>

<p>単一責務の原則と相性が良いデザインパターンが、<a href="http://www.techscore.com/tech/DesignPattern/Decorator.html/" rel="nofollow noopener" target="_blank">Decoratorパターン</a>です。<br>
Decoratorパターンを使用することで、責務の結びつきが強い部分も別クラスとして分割することが出来ます。</p>

<p>実際に、読み込み時に復号化とログ出力を行うよう変更する場合を考えてみましょう。<br>
従来のコードでは、Readメソッドに追加の処理を行うことが予想されます。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">// そのまま関数を拡張したパターン</span>

<span class="k">namespace</span> <span class="nn">UniDAO.Old</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DataAccessObject</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">T</span> <span class="n">Read</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 読み込まれたテキストは暗号化されている想定</span>
            <span class="kt">string</span> <span class="n">encryptedText</span> <span class="p">=</span> <span class="nf">ReadFile</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="c1">// 何らかの方法で復号化</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="nf">Decrypt</span><span class="p">(</span> <span class="n">encryptedText</span> <span class="p">);</span>

                                                <span class="c1">// ログを出力</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">text</span> <span class="p">);</span>

            <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">default</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="n">FromJson</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>Readメソッドの責務が増大し、テストもしづらくなっているかと思います。<br>
一方、新しいコードで機能追加する場合を見てみましょう。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="c1">// デコレーターで拡張したパターン</span>

<span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
                <span class="c1">// 復号化</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DecryptReader</span> <span class="p">:</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">DecryptReader</span><span class="p">(</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">stringReader</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="kt">string</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nf">Decrypt</span><span class="p">(</span> <span class="n">stringReader</span><span class="p">.</span><span class="nf">Read</span><span class="p">()</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// ログ出力</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">LogReader</span> <span class="p">:</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">LogReader</span><span class="p">(</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">stringReader</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="kt">string</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">str</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">.</span><span class="nf">Read</span><span class="p">();</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span> <span class="n">str</span> <span class="p">);</span>

            <span class="k">return</span> <span class="n">str</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="k">public</span> <span class="k">class</span> <span class="nc">DaoFactory</span>
    <span class="p">{</span>

        <span class="k">private</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">CreateReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">textReader</span>  <span class="p">=</span> <span class="k">new</span> <span class="nf">TextReader</span><span class="p">(</span> <span class="n">basePath</span><span class="p">,</span> <span class="n">fileName</span> <span class="p">);</span>

            <span class="c1">// 復号化機能をデコレーション</span>
            <span class="kt">var</span> <span class="n">decryptReader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DecryptReader</span><span class="p">(</span> <span class="n">textReader</span> <span class="p">);</span>

                                                <span class="c1">// ログ出力機能をデコレーション</span>
            <span class="kt">var</span> <span class="n">logReader</span>  <span class="p">=</span> <span class="k">new</span> <span class="nf">LogReader</span><span class="p">(</span> <span class="n">decryptReader</span> <span class="p">);</span>

            <span class="k">return</span> <span class="k">new</span> <span class="n">DeserializeReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">logReader</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>Decoratorパターンで拡張を行うと、クラス数が増加したりFactoryの組み立て処理が複雑になりますが、<br>
各クラスのテスタビリティは下がりません。<br>
これは、比較的安全に拡張が出来ていることを意味します。</p>

<h3>
<span id="武器その3poor-mans-dependency-injectionパターン" class="fragment"></span><a href="#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE3poor-mans-dependency-injection%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3"><i class="fa fa-link"></i></a>武器その3：Poor Man's Dependency Injectionパターン</h3>

<p>Poor Man's Dependency InjectionパターンはDIパターンの中で最も単純なものになります。<br>
パターンの説明の前に、関連する依存性反転の原則(Dependency Inversion Principle)について少し記載します。</p>

<p>依存性反転の原則は、サンプルプロジェクトではDeserializeReaderに使われています。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
    <span class="c1">// Scripts/Main/Read/DeserializeReader.cs</span>
    <span class="c1">// Jsonを指定されたクラスとして読み込み</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DeserializeReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">DeserializeReader</span><span class="p">(</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">stringReader</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="n">T</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">.</span><span class="nf">Read</span><span class="p">();</span>

            <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">default</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="n">FromJson</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>DeserializeReaderは旧Readメソッドの「デシリアライズ」・「ファイルの読み込み」処理のうち、「ファイルの読み込み」処理を外部から注入するよう変更しています。<br>
この変更により、「ファイルの読み込み」処理以外に、Fileクラスへの依存関係も外部から注入されるようになっております。<br>
つまり、旧ReadメソッドではReadメソッドを使用するクライアントは暗黙的にFileクラスへの依存を行っていたのに対して、DeserializeReaderのクライアントはオブジェクト生成時に明示的にFileクラスへの依存を注入することになり、依存関係が反転します。</p>

<p>依存性の反転によるメリットは、上位レイヤーが下位レイヤーに依存することを防ぎ、クラス間を疎結合に保つことにあります。<br>
例えば、DeserializeReaderはFileクラスへの依存が無くなっているため、読み込み先がデータベースに変わってもコードを変更する必要がありません。</p>

<p>さて、制御の反転を使うことでクラス間の依存度が減り開発者は幸せになりますが、コードを動かすにはどこかで実装を注入しなければならず、注入方法をパターン化したものが俗に言うDI(Dependency Injection)パターンです。<br>
DIパターンの実装にはDIコンテナを使ったものなど様々なものがありますが、今回はオブジェクトの依存関係を自力で解決するPoor Man's Dependency Injectionパターンを用いています。<br>
コードを見てみましょう。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
    <span class="c1">// Scripts/Main/Factory/DaoFactory.cs</span>
    <span class="c1">// IReadの作成</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DaoFactory</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">CreateReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
                                                <span class="c1">// 自力で依存関係を解決</span>
            <span class="kt">var</span> <span class="n">textReader</span>        <span class="p">=</span> <span class="k">new</span> <span class="nf">TextReader</span><span class="p">(</span> <span class="n">basePath</span><span class="p">,</span> <span class="n">fileName</span> <span class="p">);</span>
            <span class="kt">var</span> <span class="n">decryptReader</span>     <span class="p">=</span> <span class="k">new</span> <span class="nf">DecryptReader</span><span class="p">(</span> <span class="n">textReader</span> <span class="p">);</span>
            <span class="kt">var</span> <span class="n">logReader</span>         <span class="p">=</span> <span class="k">new</span> <span class="nf">LogReader</span><span class="p">(</span> <span class="n">decryptReader</span> <span class="p">);</span>
            <span class="kt">var</span> <span class="n">deserializeReader</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DeserializeReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">logReader</span> <span class="p">);</span>

            <span class="k">return</span> <span class="n">deserializeReader</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>CreateReaderメソッドの中で、以下の様に依存関係が解決されていきます。</p>

<ul>
<li>TextReader(Fileクラスへ依存した実装)をDecryptReaderに注入。</li>
<li>DecryptReader(復号化処理へ依存した実装)をLogReaderに注入。</li>
<li>LogReader(ログクラスへ依存した実装)をDeserializeReaderに注入。</li>
<li>最終的にユーザーに渡されるIReadは、「Fileクラス」「復号化処理」「ログクラス」「デシリアライズ処理」に依存しています。</li>
</ul>

<p>一見すると単純なパターンではありますが、Factoryの中で依存関係を解決することでクライアントには実装を隠蔽しつつ柔軟に機能を拡張できる強力なパターンです。</p>

<p>ただし、オブジェクトの依存関係グラフが複雑になるとこのパターンはとてつもなく労力を要します。<br>
その際は、DIコンテナの利用などを検討してみて下さい。<br>
(Poor Man's Dependency InjectionパターンはDIコンテナ等を一切持たないので、"Poor Man"だそうです・・・)</p>

<p>ちなみに、せっかく依存性反転の原則に触れたので、より依存性を減らしたDeserializeReaderも紹介しておきます。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IDeserialize</span><span class="p">&lt;</span><span class="n">TSource</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="n">T</span> <span class="n">Deserialize</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">TSource</span> <span class="n">source</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// JsonUtilityへの依存をなくしたDeserializeReader</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DeserializeReader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IDeserialize</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">deserializer</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">DeserializeReader</span><span class="p">(</span> <span class="n">IRead</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringReader</span><span class="p">,</span> <span class="n">IDeserialize</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">deserializer</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">stringReader</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">deserializer</span> <span class="p">=</span> <span class="n">deserializer</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="n">T</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="n">stringReader</span><span class="p">.</span><span class="nf">Read</span><span class="p">();</span>

            <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">default</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>

            <span class="c1">// IDeserializeにデシリアライズ処理を委譲</span>
            <span class="k">return</span> <span class="n">deserializer</span><span class="p">.</span><span class="n">Deserialize</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>このように、デシリアライズ処理に関しても外部から注入することが可能です。<br>
その結果、DeserializeReaderはUnityEngine以外のC#環境でも使用可能になり、コードの再利用性が高まっています。<br>
(今回のサンプルプロジェクトでは過度な抽象化と判断し、やめました。)</p>

<h3>
<span id="武器その4インターフェイス分離の原則the-interface-segregation-principle" class="fragment"></span><a href="#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE4%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E5%88%86%E9%9B%A2%E3%81%AE%E5%8E%9F%E5%89%87the-interface-segregation-principle"><i class="fa fa-link"></i></a>武器その4：インターフェイス分離の原則(the Interface Segregation Principle)</h3>

<p>ここまでReadメソッドの中身について着目してきましたが、最後にIReadインターフェイスでの工夫を説明します。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
    <span class="c1">// Scripts/Main/IRead.cs</span>
    <span class="c1">// インターフェイス：読み込み</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IRead</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="n">T</span> <span class="nf">Read</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>・・・・・・どんな工夫があるのかわからないコードですね。<br>
まぁ、けど大丈夫です。ここでの工夫はインターフェイスを分離して小さくしていることです。</p>

<p>旧DataAccessObjectでもそうでしたが、データ保存の処理などは同じクラスに存在確認・読み込み・保存・削除をまとめて書くことが多いです。<br>
そのため、DataAccessObject用のインターフェイスを作成すると以下の様になりがちです。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
    <span class="c1">// インターフェイス：存在確認・読み込み・保存・削除</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IDataAccessObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="nf">Exists</span><span class="p">();</span>
        <span class="n">T</span> <span class="nf">Read</span><span class="p">();</span>
        <span class="k">void</span> <span class="nf">Save</span><span class="p">(</span> <span class="n">T</span> <span class="n">data</span> <span class="p">);</span>
        <span class="k">void</span> <span class="nf">Delete</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>一見すると、問題無さそうなIDataAccessObjectですが、デコレーターとの相性が悪いです。<br>
例えば、IDataAccessObjectを用いて、「ファイル処理」「シリアライズ」処理を分割した場合を見てみましょう。</p>

<div class="code-frame" data-lang="c#"><div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">UniDAO</span>
<span class="p">{</span>
    <span class="c1">// テキストの存在確認・読み込み・保存・削除</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">TextDao</span> <span class="p">:</span> <span class="n">IDataAccessObject</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">basePath</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">fileName</span><span class="p">;</span>


        <span class="k">private</span> <span class="kt">string</span> <span class="n">Path</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">basePath</span> <span class="p">+</span> <span class="n">fileName</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="nf">TextDao</span><span class="p">(</span> <span class="kt">string</span> <span class="n">basePath</span><span class="p">,</span> <span class="kt">string</span> <span class="n">fileName</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">basePath</span> <span class="p">=</span> <span class="n">basePath</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">fileName</span> <span class="p">=</span> <span class="n">fileName</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">Exists</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">Path</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="kt">string</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="nf">Exists</span><span class="p">()</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">null</span><span class="p">;</span>

            <span class="k">return</span> <span class="n">File</span><span class="p">.</span><span class="nf">ReadAllText</span><span class="p">(</span> <span class="n">Path</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Save</span><span class="p">(</span> <span class="kt">string</span> <span class="n">text</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span> <span class="n">basePath</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">Directory</span><span class="p">.</span><span class="nf">CreateDirectory</span><span class="p">(</span> <span class="n">basePath</span> <span class="p">);</span>

            <span class="nf">Delete</span><span class="p">();</span>
            <span class="n">File</span><span class="p">.</span><span class="nf">WriteAllText</span><span class="p">(</span> <span class="n">Path</span><span class="p">,</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Delete</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="nf">Exists</span><span class="p">()</span> <span class="p">)</span>
                <span class="n">File</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span> <span class="n">Path</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


                <span class="c1">// シリアライズしたテキストを保存</span>
    <span class="c1">// テキストをデシリアライズして読み込み</span>
    <span class="c1">// テキストの存在確認・削除 ← 委譲しているだけ！</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SerializeDao</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IDataAccessObject</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IDataAccessObject</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringDao</span><span class="p">;</span>


        <span class="k">public</span> <span class="nf">SerializeDao</span><span class="p">(</span> <span class="n">IDataAccessObject</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">stringDao</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">stringDao</span> <span class="p">=</span> <span class="n">stringDao</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">Exists</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// 委譲しているだけ</span>
            <span class="k">return</span> <span class="n">stringDao</span><span class="p">.</span><span class="nf">Exists</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">T</span> <span class="nf">Read</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="n">stringDao</span><span class="p">.</span><span class="nf">Read</span><span class="p">();</span>

            <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="k">default</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="n">FromJson</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">text</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Save</span><span class="p">(</span> <span class="n">T</span> <span class="n">data</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonUtility</span><span class="p">.</span><span class="nf">ToJson</span><span class="p">(</span> <span class="n">data</span> <span class="p">);</span>
            <span class="n">stringDao</span><span class="p">.</span><span class="nf">Save</span><span class="p">(</span> <span class="n">json</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Delete</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// 委譲しているだけ</span>
            <span class="n">stringDao</span><span class="p">.</span><span class="nf">Delete</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>完成したコードはIReadで使っているものとほぼ同一ですが、SerializeDaoのExistsメソッドとDeleteメソッドは処理を委譲しているだけで何もしていません。<br>
このように、責務が多いインターフェイスにDecoratorパターンを使用すると、ただ委譲するだけの処理を何回も書かなくてはなりません。<br>
そのため、工数や可読性とのバランスではあるのですが、基本的には責務が混在したインターフェイスは分割することが推奨されます。</p>

<p>また、補足になりますが、シングルメソッドのインターフェイスは非常に柔軟性が高いので、色々試してみると面白いです。<br>
少ない労力や制約で、様々なデコレーション、合成が可能になります。</p>

<h3>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h3>

<p>ここまで、アダプティブコードを実践するための武器について説明を行ってきました。<br>
アダプティプコードというと、中々新しそうな感じはありますが、実際は今まで積み重ねられてきたオブジェクト指向のベストプラクティスの組み合わせと言った感じです。<br>
(紹介した武器は全て10年以上前から使われている)</p>

<p>ただし、どの武器も本当に使いこなすまでは難しいです。<br>
これだけ小さいプロジェクトでもたくさん工夫できる点はありますし、常に熟慮して判断しないと余計な抽象化を生む可能性もあります。</p>

<h1>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p>本記事は「アダプティブコード」の入門として、書籍『<a href="https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477" rel="nofollow noopener" target="_blank">C#実践開発手法</a>』の導入的な内容をサンプルプロジェクトを通して紹介しました。<br>
様々な、アダプティブコードを実現するための様々な武器を紹介してきましたが、書籍には以下の様なより実践的な内容がありますので、興味を持たれた方は是非読んでみて下さい。</p>

<ul>
<li>依存関係が少ないアセンブリ構成(Stairwayパターン)</li>
<li>アスペクト指向</li>
<li>残りのSOLID原則</li>
<li>発展的なDIパターン(DIコンテナ等)</li>
<li>上記を実現するための、ライブラリなど</li>
</ul>

<p>また、最後にですが一点だけ注意点を。<br>
この記事の中では昔のコードをノンアダプティブコードとして載せましたが、決してあのコードは悪いコードというわけではありません。<br>
基本的にアダプティブコードもコードを書く上での手法というか方針の1つでしかありませんので、絶対的に正ではありません。<br>
(もし似た書き方をされていた方が不快に感じてしまったら、申し訳ありません。)</p>

<h1>
<span id="あとがき" class="fragment"></span><a href="#%E3%81%82%E3%81%A8%E3%81%8C%E3%81%8D"><i class="fa fa-link"></i></a>あとがき</h1>

<p>はじめはアドベントカレンダーのネタがなく、取り敢えず要約するかーというテンションでした。<br>
しかし、取り敢えずぐぐってみると、<a href="http://kyabatalian.hatenablog.com/entry/2017/09/18/145701" rel="nofollow noopener" target="_blank">「夜は寝る」の「『C#実践開発手法』を読んだ」</a>にとても良い要約がありました。(無念)</p>

<p>差別化をはかるために、本記事では具体的なサンプルコードと共に説明することを選択したので、<br>
アダプティブコードに興味を持ってもらえた方は上記要約も参照して頂ければと思います。</p>

<p>また、実際の書籍は以下の構成になっておりますが、アダプティブコードに集中するために本記事は「第2部〜第3部のちょっと」の部分に焦点をあてております。</p>

<ul>
<li>第1部：アジャイルの基礎</li>
<li>第2部：SOLIDコードの記述</li>
<li>第3部：アダプティブサンプル</li>
</ul>

<p>省略してしまいましたが、アジャイルの基礎もアダプティブコードを実現するために必要不可欠な手法でありますので、<br>
そのあたりは誤解が無ければ嬉しいなと思います。</p>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<p>メインの参考元</p>

<ul>
<li><a href="https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477" rel="nofollow noopener" target="_blank">C#実践開発手法</a></li>
</ul>

<p>以下は記事内で使用したリンク先になります。</p>

<ul>
<li><a href="http://kyabatalian.hatenablog.com/entry/2017/09/18/145701" rel="nofollow noopener" target="_blank">夜は寝る : 『C#実践開発手法』を読んだ</a></li>
<li><a href="https://qiita.com/gomi_ningen/items/02c42e2487d035f9c3c8">単一責任の原則（SRP）</a></li>
<li><a href="http://www.techscore.com/tech/DesignPattern/Decorator.html/" rel="nofollow noopener" target="_blank">TECHSCORE : DECORATORパターン</a></li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fhareruyanosuke%2Fitems%2F48c82f32a8ecf8bd0c7d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fhareruyanosuke%2Fitems%2F48c82f32a8ecf8bd0c7d&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/likers" class="css-1iupg5d">74</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">80</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/48c82f32a8ecf8bd0c7d/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/hareruyanosuke/items/48c82f32a8ecf8bd0c7d.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-882764f7-aab5-4895-bb78-e800b775bc4f">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-bc4b0455-ecbe-4a23-94ad-07a0a4f740af"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-bc4b0455-ecbe-4a23-94ad-07a0a4f740af">{}</script>
      
<div id="LoginModal-react-component-2366fa38-ff76-4c9a-9f37-1a6b9b6322d9"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-2366fa38-ff76-4c9a-9f37-1a6b9b6322d9">{}</script>
      
<div id="StockModal-react-component-1794142d-7707-470f-99d2-c0816a364b72"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-1794142d-7707-470f-99d2-c0816a364b72">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;M/AWleWEBJWFHYjf/zKtpjAJPtbE9+62IGMg1sw52TNy1j+SWR8ITMH+gQvYM1Fjqw15F5VdcIqEL6/5mIs4Wg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eこの記事は \u003ca href=\"https://qiita.com/advent-calendar/2017/aktsk\"\u003eAkatsuki Advent Calendar 2017\u003c/a\u003e の 9 日目の記事です。\u003cbr\u003e\n8日目: \u003ca href=\"https://qiita.com/akihiro-nagai/items/103418a244bb308e7e72\" id=\"reference-41f92a42a56f20f716e4\"\u003eシステム障害解析におけるログのあれこれ\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"概要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e概要\u003c/h1\u003e\n\n\u003cp\u003e今年読んだ記事・本の中で、個人的に最もためになったのがマイクロソフト公式解説書の「\u003ca href=\"https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC#実践開発手法\u003c/a\u003e」でした。\u003c/p\u003e\n\n\u003cp\u003e内容としては、変化に容易に適応できるコード(アダプティブコード)を実現するために、以下の手法をC#でどのように実践するかを解説する本です。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eアジャイル開発\u003c/li\u003e\n\u003cli\u003eデザインパターン\u003c/li\u003e\n\u003cli\u003eSOLID原則\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eC#に携わって1~2年ぐらいの方には是非おすすめしたいのですが、440ページあったりしてサラッと読むには若干辛いです。\u003cbr\u003e\nというわけで、宣伝・復習用にUnityのサンプルプロジェクトと共に基本の要点をまとめました。\u003c/p\u003e\n\n\u003cp\u003e※ あくまで自分にとって役に立った部分をまとめたもので、書籍より基礎的かつ部分的になります。\u003cbr\u003e\n※ 興味のある方は本屋さんとかで手にとって読んで頂ければと思います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"この記事が役立つ可能性がある方\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%8C%E5%BD%B9%E7%AB%8B%E3%81%A4%E5%8F%AF%E8%83%BD%E6%80%A7%E3%81%8C%E3%81%82%E3%82%8B%E6%96%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eこの記事が役立つ可能性がある方\u003c/h2\u003e\n\n\u003cp\u003eC#・Unityを書き始めて1~2年ぐらいで、SOLID原則などは普段使っていない方\u003c/p\u003e\n\n\u003cp\u003e※ デザインパターン・SOLID原則に慣れ親しんでいる方には全く役に立ちません\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"記事を書いている人\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A8%98%E4%BA%8B%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%84%E3%82%8B%E4%BA%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e記事を書いている人\u003c/h2\u003e\n\n\u003cp\u003e新卒でUnityのゲーム開発プロジェクトに入って1年5ヵ月目ぐらいの、2年目Lv.1のクライアントエンジニア\u003cbr\u003e\nUnityでの開発とJenkinsのお世話がお仕事です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"hello-adaptive-code\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#hello-adaptive-code\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eHello \"Adaptive Code\"\u003c/h1\u003e\n\n\u003cp\u003e改めてまして、はじめまして、 \u003ca href=\"/hareruyanosuke\" class=\"user-mention js-hovercard\" title=\"hareruyanosuke\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"hareruyanosuke\"\u003e@hareruyanosuke\u003c/a\u003e です。\u003cbr\u003e\n本記事は「アダプティブコード」の入門編の記事になります。(書籍『\u003ca href=\"https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC#実践開発手法\u003c/a\u003e』の導入です。)\u003cbr\u003e\nアダプティブコードとは小さな変更量で仕様の変化に対応するコードです。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eアダプティブコード＝変化に強いコード\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e普段、おそらく実務で開発を行っている方も個人で開発を行っている方も、たびたび遭遇するのが\u003cstrong\u003e仕様の変更\u003c/strong\u003eです。\u003cbr\u003e\n僕も1年ほど新規開発プロジェクトを通して実感したのですが、まぁとにかく仕様は変わります。\u003cbr\u003e\n最終的なアウトプットよりも、仕様変更に対応した物量の方が多そうです。\u003c/p\u003e\n\n\u003cp\u003eそんなこんなで、アダプティブコードは身に付けるととても有用です。\u003cbr\u003e\n仕様変更と日夜戦っている方が、この記事の手法を通して少しでも精神的ダメージを減らせてもらえるとうれしいです\u003cbr\u003e\n(アダプティブコードを身に付けても物理的ダメージは変わらないですが。)\u003c/p\u003e\n\n\u003cp\u003e本章では、まずアダプティブコードの真逆、ノンアダプティブコード(不適応なコード)について説明します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ノンアダプティブコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eノンアダプティブコード\u003c/h2\u003e\n\n\u003cp\u003eアダプティブコードの説明の前に、まずノンアダプティブコード(適応力の低いコード)について見てみましょう。\u003cbr\u003e\nノンアダプティブコードには幾つかの特徴が見られることが多いです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"硬直性が高い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%A1%AC%E7%9B%B4%E6%80%A7%E3%81%8C%E9%AB%98%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e硬直性が高い\u003c/h3\u003e\n\n\u003cp\u003e抽象化が欠如していたり責務が混在していることが多いと、コードの変更にリスクが伴い硬直性が高くなります。\u003cbr\u003e\n抽象化が欠如されたコードは、クラスの実体や内部仕様に依存したコードをクライアント側が書かなければならなくなります。\u003cbr\u003e\nまた、責務が混在したコードでは、目的が1つではないモジュールが含まれることで、どこか1箇所の変更が意図しない他のコードへ波及されることが往々にあります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"テスタビリティの欠如\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%82%BF%E3%83%93%E3%83%AA%E3%83%86%E3%82%A3%E3%81%AE%E6%AC%A0%E5%A6%82\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテスタビリティの欠如\u003c/h3\u003e\n\n\u003cp\u003eテストが難しかったり、テストに時間がかかる場合、テストは十分に行われません。\u003cbr\u003e\nそして、テストが不十分なコードには不具合がありますし、\u003cstrong\u003e変更した際のリスクが極端に高くなります。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"スカイフックとクレーン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF%E3%81%A8%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eスカイフックとクレーン\u003c/h4\u003e\n\n\u003cp\u003eテスタビリティを確認する上で、スカイフックとクレーンの比喩が参考になります。\u003cbr\u003e\nスカイフックとは、先行条件を参照せずに何かを説明する方法のことです。\u003cbr\u003e\nこれに対し、クレーンは説明可能な先行条件が存在するものを言います。\u003c/p\u003e\n\n\u003cp\u003eプログラミングにはテスタビリティを下げるスカイフックが幾つか存在しますが、それらを置き換えられるクレーンも存在します。\u003c/p\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"プログラミングにおけるスカイフック\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプログラミングにおけるスカイフック\u003c/h5\u003e\n\n\u003cul\u003e\n\u003cli\u003e静的メソッド\u003c/li\u003e\n\u003cli\u003e静的クラス(シングルトンを含む)\u003c/li\u003e\n\u003cli\u003enewを使用するオブジェクトの生成\u003c/li\u003e\n\u003cli\u003e拡張メソッド\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"スカイフックを置き換えるクレーン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF%E3%82%92%E7%BD%AE%E3%81%8D%E6%8F%9B%E3%81%88%E3%82%8B%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eスカイフックを置き換えるクレーン\u003c/h5\u003e\n\n\u003cul\u003e\n\u003cli\u003eインターフェイス\u003c/li\u003e\n\u003cli\u003e依存性の注入(DI)\u003c/li\u003e\n\u003cli\u003e制御の反転\u003c/li\u003e\n\u003cli\u003eファクトリ\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メトリクス的に良くない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9%E7%9A%84%E3%81%AB%E8%89%AF%E3%81%8F%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメトリクス的に良くない\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eユニットテストのカバレッジが低い\u003c/li\u003e\n\u003cli\u003e循環的複雑度が高い\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e上記2つは統計的に不具合数と相関します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ノンアダプティブコードの実例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%AE%9F%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eノンアダプティブコードの実例\u003c/h2\u003e\n\n\u003cp\u003eここまでノンアダプティブコードの特徴を説明しましたが、やけに文字ばっかりで分かりづらいですね。\u003cbr\u003e\nそこで、具体的な例として、今回は昔の僕のコードを引っ張り出してきました。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"サンプルプロジェクトの説明\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E8%AA%AC%E6%98%8E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサンプルプロジェクトの説明\u003c/h3\u003e\n\n\u003cp\u003eこの記事の説明で用いているコードのリポジトリは以下になります。\u003cbr\u003e\n\u003ca href=\"https://github.com/tsukiwo55216/UniDAO\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/tsukiwo55216/UniDAO\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e今回ノンアダプティブコード・アダプティブコードのサンプルとして、\u003cstrong\u003eAndroid・iOSのローカルストレージにデータを保存する機能\u003c/strong\u003eを選択しました。\u003cbr\u003e\n(小さいコードで書けるわりに工夫できるところが多かった。)\u003c/p\u003e\n\n\u003cp\u003eまた、簡単のためシリアライズ・デシリアライズにはUnityのJsonUtilityを使用しており、\u003cbr\u003e\nJsonUtilityが対応していないクラスは非対応にする方針を取りました。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"昔の実装ノンアダプティブコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%98%94%E3%81%AE%E5%AE%9F%E8%A3%85%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e昔の実装(ノンアダプティブコード)\u003c/h3\u003e\n\n\u003cp\u003e去年の僕が同等の仕様で作成したコードを作りなおしたものになります。\u003cbr\u003e\nエラー部分は省き、見せちゃダメな部分は消しました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// Scripts/Old/DataAccessObject.cs\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO.Old\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// クライアントのデータ保存・読み込み・削除・存在確認\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDataAccessObject\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eBasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epersistentDataPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/DAO/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eExtention\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\".json\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"c1\"\u003e// 存在確認\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eExistsFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// カスタムクラスを読み込み\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFromJson\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// カスタムクラスを保存\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToJson\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eOverWriteFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// 削除\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eDeleteFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"c1\"\u003e// パスの取得\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eBasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eExtention\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ファイルの存在確認\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eExistsFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ファイルの読み込み\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nf\"\u003eExistsFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ファイルの上書き\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOverWriteFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eBasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eBasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"nf\"\u003eDeleteFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// ファイルの削除\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDeleteFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// Scripts/Old/Example/Example.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 使用例\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExample\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// データ保存用クラス\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializable\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTestData\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etestString\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e    \u003cspan class=\"n\"\u003etestInt\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e   \u003cspan class=\"s\"\u003e\"Test Data :: \"\u003c/span\u003e\n                       \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Test String : \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etestString\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\", \"\u003c/span\u003e\n                       \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Test Int : \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etestInt\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestData\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestData\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etestData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etestString\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"string\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etestData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etestInt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e// 保存\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etestData\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"fileName\"\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 読み込み\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTestData\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"s\"\u003e\"fileName\"\u003c/span\u003e \u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 存在確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s\"\u003e\"fileName\"\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 削除\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s\"\u003e\"fileName\"\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s\"\u003e\"fileName\"\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"どこがノンアダプティブか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%81%93%E3%81%8C%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどこがノンアダプティブか？\u003c/h3\u003e\n\n\u003cp\u003e去年の僕はわりとしっかり実装したつもりだったのですが、変化に対応できるかという視点で見ると工夫できる余地はたくさんあります。\u003cbr\u003e\nノンアダプティブコードの特徴から考えてみます。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"硬直性\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%A1%AC%E7%9B%B4%E6%80%A7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e硬直性\u003c/h4\u003e\n\n\u003cp\u003e一見するとコードが短いこともあり、硬直性は低そうですが、各メソッドの責務が多く(ReadメソッドではIO処理・デシリアライズなど)、変更に対する拡張ポイントが用意されていません。\u003c/p\u003e\n\n\u003cp\u003eそのため、暗号化・復号化などの処理もこのクラスに追加されていき、結果としてクラスの責務や依存度がどんどん大きくなることが予想されます。\u003cbr\u003e\n(実際に、これらは追加された仕様です。)\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"テスタビリティ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%82%BF%E3%83%93%E3%83%AA%E3%83%86%E3%82%A3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテスタビリティ\u003c/h4\u003e\n\n\u003cp\u003e低いです、問題点としては以下の点があげられます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e全ての公開メソッドがIO処理を行っている\u003c/li\u003e\n\u003cli\u003eメソッドの責務が複数あるため、テストコードが複雑になりがち\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eまた、スカイフックである静的メソッド・クラスにも引っかかっていますね。\u003cbr\u003e\n(ただ、こちらはこのクラスの使用用途を考えるとそこまで問題では無さそうです。)\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"メトリクス\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメトリクス\u003c/h4\u003e\n\n\u003cp\u003e循環的複雑度は問題無さそう、というか循環度が問題になる規模じゃないですね。\u003cbr\u003e\nユニットテストのカバレッジは単体テストを行っていないので0%でした。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"アダプティブコード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアダプティブコード\u003c/h2\u003e\n\n\u003cp\u003eようやくアダプティブコードの説明まで辿り着けましたが、実はアダプティブコードには「適応力が高い」以外にそんなに明確な定義が無さそうです。(書籍から探す限り)\u003c/p\u003e\n\n\u003cp\u003eただ、これだけだとあまりにもふわっとしているので、\u003cstrong\u003e個人的に\u003c/strong\u003e以下の条件満たしているコードを「良いアダプティブコード」としています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eほどよい拡張ポイントがある＝将来発生しそうな仕様変更に対する拡張ポイントがある\u003c/li\u003e\n\u003cli\u003eノンアダプティブコードでは無い\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ほどよい拡張ポイントがある\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BB%E3%81%A9%E3%82%88%E3%81%84%E6%8B%A1%E5%BC%B5%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%8C%E3%81%82%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eほどよい拡張ポイントがある\u003c/h3\u003e\n\n\u003cp\u003e適応力を考える上で大事な視点が、「実際に拡張されるかどうか」ということだと思います。\u003cbr\u003e\n適応力が高くても実際に仕様変更で拡張ポイントが使われなければ意味がありませんし、\u003cbr\u003e\n拡張ポイントを作るコストが変更コストより高くなっても意味がありません。\u003c/p\u003e\n\n\u003cp\u003eというわけであくまで個人的な意見ですが、拡張ポイントに関してはプロジェクト状況的に起こり得て、かつ現実的な工数で出来る程度に作っておくことが良いかと思います。\u003cbr\u003e\n(ただ、プランナーやディレクターがどういう風に変更したくなるかは運ですが。)\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ノンアダプティブコードでは無い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E3%81%AF%E7%84%A1%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eノンアダプティブコードでは無い\u003c/h3\u003e\n\n\u003cp\u003e上の方でノンアダプティブコードとはアダプティプではないコードと言っているので「？？？」となりそうです。\u003cbr\u003e\nしかし、ノンアダプティブコードはアダプティブコードよりも明確な特徴があり、アンチパターンを避けていくと良い感じになるという経験則もあるのでこの要件を採用してます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"try-adaptive-code\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#try-adaptive-code\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTry \"Adaptive Code\"\u003c/h1\u003e\n\n\u003cp\u003e本章では、前章で紹介したノンアダプティブコードをアダプティブコードに変更し、主要な手法の説明を行います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"アダプティプコードを実践するための武器\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%97%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%AE%9F%E8%B7%B5%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E6%AD%A6%E5%99%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアダプティプコードを実践するための武器\u003c/h2\u003e\n\n\u003cp\u003e書籍内では様々な手法が紹介されていますが、大きく分けると次のようになります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e依存関係の管理\u003c/li\u003e\n\u003cli\u003eインターフェイス\u003c/li\u003e\n\u003cli\u003eデザインパターン\u003c/li\u003e\n\u003cli\u003eTDD(テスト駆動開発)\u003c/li\u003e\n\u003cli\u003eSOLID原則\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003eS\u003c/strong\u003eRP : 単一責務の原則(Single Responsibility Principle)\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eO\u003c/strong\u003eCP : 開放/閉鎖の原則(Open/Closed Principle)\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eL\u003c/strong\u003eSP : リスコフの置換原則(Liskov Substitution Principle)\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eI\u003c/strong\u003eSP : インターフェイス分離の原則(the Interface Segregation Principle)\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eD\u003c/strong\u003eIP : 依存性反転の原則(Dependency Inversion Principle)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e次節からは、サンプルプロジェクトで使用した中で特に効果のあった手法の説明を行っていきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"武器の実例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%AE%E5%AE%9F%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e武器の実例\u003c/h2\u003e\n\n\u003cp\u003eサンプルプロジェクトのReadメソッドは、クライアントのJSONファイルを読み込み指定されたクラスとして返すメソッドです。\u003cbr\u003e\nとてもシンプルなコードではありますが、今回サンプルプロジェクトで使ったアダプティブコードの武器が全て含まれています。\u003cbr\u003e\nですので、ここからはReadメソッドに着目して、変化への適応力を上がるための工夫を説明していきます。\u003c/p\u003e\n\n\u003cp\u003eまず、改めて昔のコードをのせます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO.Old\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Scripts/Old/DataAccessObject.cs\u003c/span\u003e\n       \u003cspan class=\"c1\"\u003e// クライアントのデータ読み込み\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDataAccessObject\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eBasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epersistentDataPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/DAO/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eExtention\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\".json\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFromJson\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eBasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/\"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eExtention\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eExistsFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eMakeFilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nf\"\u003eExistsFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e昔のReadメソッドでの問題点を再掲しておきます。\u003cbr\u003e\n - IO処理があり、実行環境がテストに影響する。\u003cbr\u003e\n - 責務が複数ある。(IO処理・デシリアライズ)\u003cbr\u003e\n - 拡張ポイントが無く、仕様変更によりこのメソッドが変更され責務が増大する可能性が高い。\u003c/p\u003e\n\n\u003cp\u003eそれでは、今回アダプティブコードを意識して作成したサンプルの旧Readメソッドに対応する部分を見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/IRead.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// インターフェイス：読み込み\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/Factory/DaoFactory.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IReadの作成\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDaoFactory\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nf\"\u003eDaoFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epersistentDataPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/DAO/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDaoFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eCreateReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etextReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTextReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etextReader\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/Read/TextReader.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// テキストの読み込み\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTextReader\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eTextReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/Read/DeserializeReader.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Jsonを指定されたクラスとして読み込み\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFromJson\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/Example/Example.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// 使用例\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExample\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMonoBehaviour\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// データ保存用クラス\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializable\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTestData\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etestString\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e    \u003cspan class=\"n\"\u003etestInt\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n            \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e   \u003cspan class=\"s\"\u003e\"Test Data :: \"\u003c/span\u003e\n                       \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Test String : \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etestString\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\", \"\u003c/span\u003e\n                       \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Test Int : \"\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etestInt\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// Data Access Objectの取得\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestDataDAO\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDaoFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTestData\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"s\"\u003e\"fileName\"\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etestData\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestData\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etestData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etestString\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etestData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etestInt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e99\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e// 保存\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etestDataDAO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etestData\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 読み込み\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etestDataDAO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 存在確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etestDataDAO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 削除\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etestDataDAO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etestDataDAO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e一見するとクラス数もコード量も増えており、複雑になっただけの様な気がしますね。\u003cbr\u003e\nここは落ち着いて、武器を見ていきましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"武器その1単一責務の原則single-responsibility-principle\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE1%E5%8D%98%E4%B8%80%E8%B2%AC%E5%8B%99%E3%81%AE%E5%8E%9F%E5%89%87single-responsibility-principle\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e武器その1：単一責務の原則(Single Responsibility Principle)\u003c/h3\u003e\n\n\u003cp\u003eはじめに使っている武器は、\u003ca href=\"https://qiita.com/gomi_ningen/items/02c42e2487d035f9c3c8\" id=\"reference-0ee68476b5a03e448172\"\u003e単一責務の原則\u003c/a\u003eです。\u003cbr\u003e\n単一責務の原則は、「クラスを変更する理由は複数存在してはならない」というものです。\u003cbr\u003e\nこの原則は、複数の責務が割り当てられたクラスをより小さなクラスへ分割します。\u003cbr\u003e\n今回のサンプルプロジェクトでは、旧Readメソッドが持っていた「ファイルの読み込み」・「デシリアライズ」という責務が、TextReaderとDeserializeReaderへ分離されています。\u003c/p\u003e\n\n\u003cp\u003e実際に、クラスの責務が減少すると何が良いのでしょうか？\u003cbr\u003e\nまず、1つ言えることは単体テストを行いやすくなります。\u003cbr\u003e\n旧Readメソッドをテストする場合、「ファイルの読み込み」・「デシリアライズ」の処理を組み合わせたテストを書かなければなりません。\u003cbr\u003e\nしかし、責務の分割によりそれぞれに特化した単体テストを書けるようになります。\u003c/p\u003e\n\n\u003cp\u003eまた、責務を分割すると自然に処理の委譲が行われ、モックの使用が容易になります。\u003cbr\u003e\n例えば、DeserializeReaderはテキストの読み込み処理を外部から注入されたオブジェクトに委譲しているので、\u003cbr\u003e\n以下のMockStringReaderの様なモックを使用することが出来ます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// Test/Scripts/MockStringReader.cs\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// 簡単なモック\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO.Test\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMockStringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ecache\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMockStringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ecache\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecache\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecache\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ecache\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまた、分離されたクラス毎に単体テストを用意しておくことで、デシリアライザをJsonUtilityから変更する場合や\u003cbr\u003e\n読み込み先をDBに変更する場合にそれぞれのテストを変更するだけで対応できます。\u003c/p\u003e\n\n\u003cp\u003eそして、単一責務の原則の最大の利点はクラスが小さくなることかと思います。\u003cbr\u003e\n小さく役割が明確なクラスは使いやすいですし、何より可読性が高いです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"武器その2decoratorパターン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE2decorator%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e武器その2：Decoratorパターン\u003c/h3\u003e\n\n\u003cp\u003e単一責務の原則と相性が良いデザインパターンが、\u003ca href=\"http://www.techscore.com/tech/DesignPattern/Decorator.html/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eDecoratorパターン\u003c/a\u003eです。\u003cbr\u003e\nDecoratorパターンを使用することで、責務の結びつきが強い部分も別クラスとして分割することが出来ます。\u003c/p\u003e\n\n\u003cp\u003e実際に、読み込み時に復号化とログ出力を行うよう変更する場合を考えてみましょう。\u003cbr\u003e\n従来のコードでは、Readメソッドに追加の処理を行うことが予想されます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// そのまま関数を拡張したパターン\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO.Old\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDataAccessObject\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 読み込まれたテキストは暗号化されている想定\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eencryptedText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eReadFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 何らかの方法で復号化\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eDecrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eencryptedText\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                                                \u003cspan class=\"c1\"\u003e// ログを出力\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFromJson\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eReadメソッドの責務が増大し、テストもしづらくなっているかと思います。\u003cbr\u003e\n一方、新しいコードで機能追加する場合を見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// デコレーターで拡張したパターン\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// 復号化\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDecryptReader\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eDecryptReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eDecrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// ログ出力\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLogReader\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eLogReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDaoFactory\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etextReader\u003c/span\u003e  \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTextReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 復号化機能をデコレーション\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edecryptReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDecryptReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etextReader\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                                                \u003cspan class=\"c1\"\u003e// ログ出力機能をデコレーション\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogReader\u003c/span\u003e  \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eLogReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003edecryptReader\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003elogReader\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eDecoratorパターンで拡張を行うと、クラス数が増加したりFactoryの組み立て処理が複雑になりますが、\u003cbr\u003e\n各クラスのテスタビリティは下がりません。\u003cbr\u003e\nこれは、比較的安全に拡張が出来ていることを意味します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"武器その3poor-mans-dependency-injectionパターン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE3poor-mans-dependency-injection%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e武器その3：Poor Man's Dependency Injectionパターン\u003c/h3\u003e\n\n\u003cp\u003ePoor Man's Dependency InjectionパターンはDIパターンの中で最も単純なものになります。\u003cbr\u003e\nパターンの説明の前に、関連する依存性反転の原則(Dependency Inversion Principle)について少し記載します。\u003c/p\u003e\n\n\u003cp\u003e依存性反転の原則は、サンプルプロジェクトではDeserializeReaderに使われています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/Read/DeserializeReader.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Jsonを指定されたクラスとして読み込み\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFromJson\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eDeserializeReaderは旧Readメソッドの「デシリアライズ」・「ファイルの読み込み」処理のうち、「ファイルの読み込み」処理を外部から注入するよう変更しています。\u003cbr\u003e\nこの変更により、「ファイルの読み込み」処理以外に、Fileクラスへの依存関係も外部から注入されるようになっております。\u003cbr\u003e\nつまり、旧ReadメソッドではReadメソッドを使用するクライアントは暗黙的にFileクラスへの依存を行っていたのに対して、DeserializeReaderのクライアントはオブジェクト生成時に明示的にFileクラスへの依存を注入することになり、依存関係が反転します。\u003c/p\u003e\n\n\u003cp\u003e依存性の反転によるメリットは、上位レイヤーが下位レイヤーに依存することを防ぎ、クラス間を疎結合に保つことにあります。\u003cbr\u003e\n例えば、DeserializeReaderはFileクラスへの依存が無くなっているため、読み込み先がデータベースに変わってもコードを変更する必要がありません。\u003c/p\u003e\n\n\u003cp\u003eさて、制御の反転を使うことでクラス間の依存度が減り開発者は幸せになりますが、コードを動かすにはどこかで実装を注入しなければならず、注入方法をパターン化したものが俗に言うDI(Dependency Injection)パターンです。\u003cbr\u003e\nDIパターンの実装にはDIコンテナを使ったものなど様々なものがありますが、今回はオブジェクトの依存関係を自力で解決するPoor Man's Dependency Injectionパターンを用いています。\u003cbr\u003e\nコードを見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/Factory/DaoFactory.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IReadの作成\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDaoFactory\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                                \u003cspan class=\"c1\"\u003e// 自力で依存関係を解決\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etextReader\u003c/span\u003e        \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eTextReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edecryptReader\u003c/span\u003e     \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDecryptReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etextReader\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogReader\u003c/span\u003e         \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eLogReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003edecryptReader\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edeserializeReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003elogReader\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eCreateReaderメソッドの中で、以下の様に依存関係が解決されていきます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eTextReader(Fileクラスへ依存した実装)をDecryptReaderに注入。\u003c/li\u003e\n\u003cli\u003eDecryptReader(復号化処理へ依存した実装)をLogReaderに注入。\u003c/li\u003e\n\u003cli\u003eLogReader(ログクラスへ依存した実装)をDeserializeReaderに注入。\u003c/li\u003e\n\u003cli\u003e最終的にユーザーに渡されるIReadは、「Fileクラス」「復号化処理」「ログクラス」「デシリアライズ処理」に依存しています。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e一見すると単純なパターンではありますが、Factoryの中で依存関係を解決することでクライアントには実装を隠蔽しつつ柔軟に機能を拡張できる強力なパターンです。\u003c/p\u003e\n\n\u003cp\u003eただし、オブジェクトの依存関係グラフが複雑になるとこのパターンはとてつもなく労力を要します。\u003cbr\u003e\nその際は、DIコンテナの利用などを検討してみて下さい。\u003cbr\u003e\n(Poor Man's Dependency InjectionパターンはDIコンテナ等を一切持たないので、\"Poor Man\"だそうです・・・)\u003c/p\u003e\n\n\u003cp\u003eちなみに、せっかく依存性反転の原則に触れたので、より依存性を減らしたDeserializeReaderも紹介しておきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIDeserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTSource\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eDeserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003eTSource\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// JsonUtilityへの依存をなくしたDeserializeReader\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eIDeserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edeserializer\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eDeserializeReader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIDeserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edeserializer\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estringReader\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edeserializer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edeserializer\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringReader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// IDeserializeにデシリアライズ処理を委譲\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edeserializer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのように、デシリアライズ処理に関しても外部から注入することが可能です。\u003cbr\u003e\nその結果、DeserializeReaderはUnityEngine以外のC#環境でも使用可能になり、コードの再利用性が高まっています。\u003cbr\u003e\n(今回のサンプルプロジェクトでは過度な抽象化と判断し、やめました。)\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"武器その4インターフェイス分離の原則the-interface-segregation-principle\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE4%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E5%88%86%E9%9B%A2%E3%81%AE%E5%8E%9F%E5%89%87the-interface-segregation-principle\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e武器その4：インターフェイス分離の原則(the Interface Segregation Principle)\u003c/h3\u003e\n\n\u003cp\u003eここまでReadメソッドの中身について着目してきましたが、最後にIReadインターフェイスでの工夫を説明します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Scripts/Main/IRead.cs\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// インターフェイス：読み込み\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e・・・・・・どんな工夫があるのかわからないコードですね。\u003cbr\u003e\nまぁ、けど大丈夫です。ここでの工夫はインターフェイスを分離して小さくしていることです。\u003c/p\u003e\n\n\u003cp\u003e旧DataAccessObjectでもそうでしたが、データ保存の処理などは同じクラスに存在確認・読み込み・保存・削除をまとめて書くことが多いです。\u003cbr\u003e\nそのため、DataAccessObject用のインターフェイスを作成すると以下の様になりがちです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// インターフェイス：存在確認・読み込み・保存・削除\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nc\"\u003eIDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e一見すると、問題無さそうなIDataAccessObjectですが、デコレーターとの相性が悪いです。\u003cbr\u003e\n例えば、IDataAccessObjectを用いて、「ファイル処理」「シリアライズ」処理を分割した場合を見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eUnityEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eUniDAO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// テキストの存在確認・読み込み・保存・削除\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTextDao\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ePath\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eget\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eTextDao\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efileName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ePath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ePath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ebasePath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteAllText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ePath\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n                \u003cspan class=\"c1\"\u003e// シリアライズしたテキストを保存\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// テキストをデシリアライズして読み込み\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// テキストの存在確認・削除 ← 委譲しているだけ！\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSerializeDao\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eIDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"n\"\u003eIDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringDao\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eSerializeDao\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eIDataAccessObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estringDao\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estringDao\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringDao\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 委譲しているだけ\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003estringDao\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExists\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estringDao\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNullOrEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFromJson\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToJson\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003estringDao\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 委譲しているだけ\u003c/span\u003e\n            \u003cspan class=\"n\"\u003estringDao\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e完成したコードはIReadで使っているものとほぼ同一ですが、SerializeDaoのExistsメソッドとDeleteメソッドは処理を委譲しているだけで何もしていません。\u003cbr\u003e\nこのように、責務が多いインターフェイスにDecoratorパターンを使用すると、ただ委譲するだけの処理を何回も書かなくてはなりません。\u003cbr\u003e\nそのため、工数や可読性とのバランスではあるのですが、基本的には責務が混在したインターフェイスは分割することが推奨されます。\u003c/p\u003e\n\n\u003cp\u003eまた、補足になりますが、シングルメソッドのインターフェイスは非常に柔軟性が高いので、色々試してみると面白いです。\u003cbr\u003e\n少ない労力や制約で、様々なデコレーション、合成が可能になります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h3\u003e\n\n\u003cp\u003eここまで、アダプティブコードを実践するための武器について説明を行ってきました。\u003cbr\u003e\nアダプティプコードというと、中々新しそうな感じはありますが、実際は今まで積み重ねられてきたオブジェクト指向のベストプラクティスの組み合わせと言った感じです。\u003cbr\u003e\n(紹介した武器は全て10年以上前から使われている)\u003c/p\u003e\n\n\u003cp\u003eただし、どの武器も本当に使いこなすまでは難しいです。\u003cbr\u003e\nこれだけ小さいプロジェクトでもたくさん工夫できる点はありますし、常に熟慮して判断しないと余計な抽象化を生む可能性もあります。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h1\u003e\n\n\u003cp\u003e本記事は「アダプティブコード」の入門として、書籍『\u003ca href=\"https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC#実践開発手法\u003c/a\u003e』の導入的な内容をサンプルプロジェクトを通して紹介しました。\u003cbr\u003e\n様々な、アダプティブコードを実現するための様々な武器を紹介してきましたが、書籍には以下の様なより実践的な内容がありますので、興味を持たれた方は是非読んでみて下さい。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e依存関係が少ないアセンブリ構成(Stairwayパターン)\u003c/li\u003e\n\u003cli\u003eアスペクト指向\u003c/li\u003e\n\u003cli\u003e残りのSOLID原則\u003c/li\u003e\n\u003cli\u003e発展的なDIパターン(DIコンテナ等)\u003c/li\u003e\n\u003cli\u003e上記を実現するための、ライブラリなど\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eまた、最後にですが一点だけ注意点を。\u003cbr\u003e\nこの記事の中では昔のコードをノンアダプティブコードとして載せましたが、決してあのコードは悪いコードというわけではありません。\u003cbr\u003e\n基本的にアダプティブコードもコードを書く上での手法というか方針の1つでしかありませんので、絶対的に正ではありません。\u003cbr\u003e\n(もし似た書き方をされていた方が不快に感じてしまったら、申し訳ありません。)\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"あとがき\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%81%A8%E3%81%8C%E3%81%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあとがき\u003c/h1\u003e\n\n\u003cp\u003eはじめはアドベントカレンダーのネタがなく、取り敢えず要約するかーというテンションでした。\u003cbr\u003e\nしかし、取り敢えずぐぐってみると、\u003ca href=\"http://kyabatalian.hatenablog.com/entry/2017/09/18/145701\" rel=\"nofollow noopener\" target=\"_blank\"\u003e「夜は寝る」の「『C#実践開発手法』を読んだ」\u003c/a\u003eにとても良い要約がありました。(無念)\u003c/p\u003e\n\n\u003cp\u003e差別化をはかるために、本記事では具体的なサンプルコードと共に説明することを選択したので、\u003cbr\u003e\nアダプティブコードに興味を持ってもらえた方は上記要約も参照して頂ければと思います。\u003c/p\u003e\n\n\u003cp\u003eまた、実際の書籍は以下の構成になっておりますが、アダプティブコードに集中するために本記事は「第2部〜第3部のちょっと」の部分に焦点をあてております。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e第1部：アジャイルの基礎\u003c/li\u003e\n\u003cli\u003e第2部：SOLIDコードの記述\u003c/li\u003e\n\u003cli\u003e第3部：アダプティブサンプル\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e省略してしまいましたが、アジャイルの基礎もアダプティブコードを実現するために必要不可欠な手法でありますので、\u003cbr\u003e\nそのあたりは誤解が無ければ嬉しいなと思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cp\u003eメインの参考元\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AA%AC%E6%9B%B8-Gary-McLean-Hall/dp/4822298477\" rel=\"nofollow noopener\" target=\"_blank\"\u003eC#実践開発手法\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e以下は記事内で使用したリンク先になります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://kyabatalian.hatenablog.com/entry/2017/09/18/145701\" rel=\"nofollow noopener\" target=\"_blank\"\u003e夜は寝る : 『C#実践開発手法』を読んだ\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/gomi_ningen/items/02c42e2487d035f9c3c8\"\u003e単一責任の原則（SRP）\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.techscore.com/tech/DesignPattern/Decorator.html/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTECHSCORE : DECORATORパターン\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2017-12-09T07:19:46Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"Ido3zowgV5aMklb6ukCuao/n40mbeTx3--isgH/IduCMxTRfMi--3qJ+PCD/fmEoyJGhb+K3kw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2019-02-20T12:01:20Z","likesCount":74,"linkUrl":"https://qiita.com/hareruyanosuke/items/48c82f32a8ecf8bd0c7d","organization":null,"originalId":585400,"stockedCount":80,"title":"C#(Unity)でのアダプティブコード入門(デザインパターンとSOLID原則)","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e概要\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%93%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%8C%E5%BD%B9%E7%AB%8B%E3%81%A4%E5%8F%AF%E8%83%BD%E6%80%A7%E3%81%8C%E3%81%82%E3%82%8B%E6%96%B9\"\u003eこの記事が役立つ可能性がある方\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A8%98%E4%BA%8B%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%84%E3%82%8B%E4%BA%BA\"\u003e記事を書いている人\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#hello-adaptive-code\"\u003eHello \"Adaptive Code\"\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89\"\u003eノンアダプティブコード\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%A1%AC%E7%9B%B4%E6%80%A7%E3%81%8C%E9%AB%98%E3%81%84\"\u003e硬直性が高い\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%82%BF%E3%83%93%E3%83%AA%E3%83%86%E3%82%A3%E3%81%AE%E6%AC%A0%E5%A6%82\"\u003eテスタビリティの欠如\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF%E3%81%A8%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3\"\u003eスカイフックとクレーン\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF\"\u003eプログラミングにおけるスカイフック\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B9%E3%82%AB%E3%82%A4%E3%83%95%E3%83%83%E3%82%AF%E3%82%92%E7%BD%AE%E3%81%8D%E6%8F%9B%E3%81%88%E3%82%8B%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3\"\u003eスカイフックを置き換えるクレーン\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9%E7%9A%84%E3%81%AB%E8%89%AF%E3%81%8F%E3%81%AA%E3%81%84\"\u003eメトリクス的に良くない\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%AE%9F%E4%BE%8B\"\u003eノンアダプティブコードの実例\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E8%AA%AC%E6%98%8E\"\u003eサンプルプロジェクトの説明\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%98%94%E3%81%AE%E5%AE%9F%E8%A3%85%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89\"\u003e昔の実装(ノンアダプティブコード)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%81%93%E3%81%8C%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%81%8B\"\u003eどこがノンアダプティブか？\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%A1%AC%E7%9B%B4%E6%80%A7\"\u003e硬直性\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%82%BF%E3%83%93%E3%83%AA%E3%83%86%E3%82%A3\"\u003eテスタビリティ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%88%E3%83%AA%E3%82%AF%E3%82%B9\"\u003eメトリクス\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89\"\u003eアダプティブコード\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BB%E3%81%A9%E3%82%88%E3%81%84%E6%8B%A1%E5%BC%B5%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%8C%E3%81%82%E3%82%8B\"\u003eほどよい拡張ポイントがある\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%8E%E3%83%B3%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E3%81%AF%E7%84%A1%E3%81%84\"\u003eノンアダプティブコードでは無い\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#try-adaptive-code\"\u003eTry \"Adaptive Code\"\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%80%E3%83%97%E3%83%86%E3%82%A3%E3%83%97%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%AE%9F%E8%B7%B5%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E6%AD%A6%E5%99%A8\"\u003eアダプティプコードを実践するための武器\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%AE%E5%AE%9F%E4%BE%8B\"\u003e武器の実例\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE1%E5%8D%98%E4%B8%80%E8%B2%AC%E5%8B%99%E3%81%AE%E5%8E%9F%E5%89%87single-responsibility-principle\"\u003e武器その1：単一責務の原則(Single Responsibility Principle)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE2decorator%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e武器その2：Decoratorパターン\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE3poor-mans-dependency-injection%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3\"\u003e武器その3：Poor Man's Dependency Injectionパターン\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%AD%A6%E5%99%A8%E3%81%9D%E3%81%AE4%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E5%88%86%E9%9B%A2%E3%81%AE%E5%8E%9F%E5%89%87the-interface-segregation-principle\"\u003e武器その4：インターフェイス分離の原則(the Interface Segregation Principle)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%82%E3%81%A8%E3%81%8C%E3%81%8D\"\u003eあとがき\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":10248,"uuid":"48c82f32a8ecf8bd0c7d","banReason":null,"adventCalendarItem":{"day":9,"calendar":{"name":"Akatsuki","urlName":"aktsk","year":2017,"organization":{"logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/077ebe6bfb994e8a881a54e6443fce69b41a385c/original.jpg?1462502511","urlName":"aktsk"}}},"author":{"encryptedId":"3Jf61AMFeloGGUni1J540lbGWzv0--t31Bk//LYAoH4lBV--+JUSvs3Rkfcj5dc9UPhZuA==","originalId":148502,"description":"","facebookUrl":null,"githubUrl":"https://github.com/ryosuke-otsuki","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://avatars.githubusercontent.com/u/17594708?v=3","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars.githubusercontent.com%2Fu%2F17594708%3Fv%3D3?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=af09d0b1041d81e66dec08cd9477b02a","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Favatars.githubusercontent.com%2Fu%2F17594708%3Fv%3D3?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=f72281126c79d2811330736fd8dab2bb","urlName":"hareruyanosuke","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[{"node":{"encryptedId":"Vsm+PpoY3UC3uvYD4Jvgc7W6GZo3gY/LBzk=--nrxSCfzv/W9JwpJX--YmKr8F3cu8mn67TbbXMuMA==","isBetaReleaseEnabled":false,"isFollowableByViewer":false,"isFollowedByViewer":false,"name":"株式会社アカツキ","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/077ebe6bfb994e8a881a54e6443fce69b41a385c/original.jpg?1462502511","urlName":"aktsk","description":"株式会社アカツキは、スマートフォンゲームの企画開発を中心に事業を展開しております。創業以来全てのゲームを内製しているため、高い技術ノウハウが蓄積されています。今後は、新規事業の立ち上げも行ってまいります。","url":"http://aktsk.jp/"}}]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"デザインパターン","urlName":"%e3%83%87%e3%82%b6%e3%82%a4%e3%83%b3%e3%83%91%e3%82%bf%e3%83%bc%e3%83%b3"},{"name":"SOLID","urlName":"solid"}],"followingLikers":{"edges":[]},"comments":{"totalCount":1}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
