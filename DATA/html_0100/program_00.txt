using System;
using System.Collections.Generic;
using System.Threading;
using Newtonsoft.Json;

namespace ConsoleApp1
{
    public class Trend
    {
        public string name { get; set; }
        public string url { get; set; }
        public object promoted_content { get; set; }
        public string query { get; set; }
        public int? tweet_volume { get; set; }
    }

    public class Location
    {
        public string name { get; set; }
        public int woeid { get; set; }
    }

    public class JsonData
    {
        public List&lt;Trend&gt; trends { get; set; }
        public DateTime as_of { get; set; }
        public DateTime created_at { get; set; }
        public List&lt;Location&gt; locations { get; set; }
    }

    public class Root
    {
        public List&lt;JsonData&gt; json_data { get; set; }
    }

    class Program
    {
        static void Main(string[] args)
        {
            //API key
            string apiKey = "ï¼œAPIã‚­ãƒ¼ï¼";
            //API secret key
            string apiSecretKey = "ï¼œAPIã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ï¼";
            //Access token
            string accessToken = "ï¼œã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼";
            //Access token secret
            string accessTokenSecret = "ï¼œã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼";

            //èªè¨¼æƒ…å ±
            var tokens = CoreTweet.Tokens.Create(apiKey, apiSecretKey, accessToken, accessTokenSecret);
            //å¤§é˜ªã®ãƒˆãƒ¬ãƒ³ãƒ‰æƒ…å ±å–å¾—
            var TrendsJson = tokens.Trends.Place(15015370); //Osaka

            //JSONãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            string JsonData = TrendsJson.Json.ToString();
            //ã†ã¾ããƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ããªã„ã®ã§ã€ã¡ã‚‡ã¨ãƒ‡ãƒ¼ã‚¿åŠ å·¥ã€‚ã€‚
            JsonData = "{ json_data: " + JsonData + "}";

            //URLãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹
            string UrlDec = System.Web.HttpUtility.UrlDecode(JsonData);
            //JSONæ–‡å­—åˆ—ã‚’ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
            Root TrendData = JsonConvert.DeserializeObject&lt;Root&gt;(UrlDec);

            //ç·´ç¿’æ•°
            int DataCnt = 3;

            //ãƒ„ã‚¤ãƒ¼ãƒˆ
            tokens.Statuses.Update(status =&gt; DataCnt + "å˜èªã®ãƒ•ãƒªãƒƒã‚¯ç·´ç¿’ã‚¹ã‚¿ãƒ¼ãƒˆï¼ğŸ˜¤");
            //1ç§’å¾…ã¤
            Thread.Sleep(1000);

            for (int idx = 0; idx &lt; DataCnt; idx++)
            {
                //å–å¾—ãƒˆãƒ¬ãƒ³ãƒ‰ç·æ•°
                int TrendCnt = TrendData.json_data[0].trends.Count;

                //ãƒ©ãƒ³ãƒ€ãƒ æ•°å€¤ç”Ÿæˆ
                Random Rnd = new Random();
                int TrendRdm = Rnd.Next(0, TrendCnt);

                //ãƒˆãƒ¬ãƒ³ãƒ‰æ–‡å­—åˆ—å–å¾—
                string TrendText = TrendData.json_data[0].trends[TrendRdm].query;
                //#ã¯ã„ã‚‰ãªã„ã®ã§ç½®æ›
                TrendText = TrendText.Replace("#","");

                //ãƒ„ã‚¤ãƒ¼ãƒˆ
                tokens.Statuses.Update(status =&gt; "ã€" + (idx + 1) + "ã€‘" + TrendText);
                //1ç§’å¾…ã¤
                Thread.Sleep(1000);
            }

            //ãƒ„ã‚¤ãƒ¼ãƒˆ
            tokens.Statuses.Update(status =&gt; "çµ‚äº†ğŸ¥´");
        }
    }
}

