More than 3 years have passed since last update.de:code2017アプリとかで気になってた事があってMasterDetail組む時にホーム画面への配慮した方が良いかも。っていう問題。iOSだと意識しなくて良いのだけどAndroidだとバックボタンがあるのでホーム画面に配慮する必要があると思っています。例えばGoogle MapであったりGmailアプリであったりで、ハンバーガーメニューで他の画面へ移動してからバックスペースを押すと最初の画面へ戻ると思います。こうなっていないアプリって結構めんどくさくて例えば設定画面を開いて設定を変更して元の画面に戻る、みたいなケースを想定した時にホーム画面を考慮していないアプリの場合というオペレーションになるのだけどっていう操作をしてアプリが閉じちゃう、みたいな事になったりならなかったり。Xamarin.FormsでCustomRendererを使わずにMasterDetailをホーム画面を意識した感じにはいくつか方法はあるけど、MasterDetailっぽい動作を維持しつつ(開いてるメニューが閉じてDetailが変わる感じ)実現しようとすると、DetailにNavigationPageを二つ重ねる感じで実現できます。VS2017のXamarinテンプレートのMasterDetailを今回の説明方法で修正したイメージはこんな感じです。みたいな感じで構成します。そして重要な点はinnerナビゲーションの下に追加するページはNavigationPage.SetHasNavigationBarでナビゲーションバーを表示しないようにしておきます。これでメニューから例えばAboutページを選択した場合にはInnerにPushAsyncしてという感じにします。こうするとハンバーガーメニューは残ったままDetailが切り替わります。でAndroidのバックボタンを押すとAboutがpopしてHomeに戻ると。Aboutが開いている状態でメニューからHomeを選択した場合にはPopToRootしてあげれば良くて、Aboutが開いている状態で別のメニューを選んだ場合には InnerにPushAsyncした後にAboutをRemovePageする感じでＯＫ。で、ページ遷移させようとした場合にはという感じで、outerにPushAsyncすることでNavigationBarのハンバーガメニューが ←矢印に変わってナビゲーションする感じです。メンドクサイし実装が複雑化するしMVVMフレームワークとかだとできなかったりする場合もあるし、Xamarin.Formsでこの辺にコストをかけるのか？っていう疑問もあるんですけど、でも出来てると良いかも？そんなお話でした。コードをちょっと張り付けておきます。


