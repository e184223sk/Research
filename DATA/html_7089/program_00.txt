&lt;TAG((?!&lt;TAG|/TAG&gt;).|&lt;TAG(?&lt;depth&gt;)|/TAG&gt;(?&lt;-depth&gt;))*(?(depth)(?!))/TAG&gt;

