私ですとある仕事でパワポ（のスライドショー）を制御する羽目になり、初めはRuby（Win32OLE）で書いていたのですが、その後に別のプログラムをC#で書く必要があって、パワポ制御プログラムだけRubyなのもなと思い始めたのでC#に移植しました。せっかくなのでその知見を書きます。なお、C#はあまり詳しくないです。どの言語を使うにしても、Windowsで他のアプリを制御すると言ったらOLEです。
OLEってタグで記事書いてる人いませんね。。。すでに滅びた技術なのかなOLE。
OLEとCOMはどちらが古くからある用語かは私もよく知りません。とりあえず以降ではCOMって方を使います。というわけで「C# OLE」でググりました。引っかかったのがこちらの方の記事。
https://fornext1119.hatenablog.com/entry/20120328/p3一部引用（改行等は修正）え？まじすか？
というわけで少し前にこちらの記事は見つけていたのですが気乗りしないので移植は放置してました。問題点は2つあります。Rubyで書かれたものを移植するのにこんな人間に優しくない表記は嫌なので、せめてもということで以下のヘルパークラスを作りました。このヘルパークラスを使うとなんとかSAN値を下げずにパワポ制御プログラムが書けます。
コメントに書いてあるように結局メソッドを呼び出すときも必要な引数だけで大丈夫なようです。もう一つ重要な点として、コメントにあるように「全てのCOMオブジェクト」を解放しないとパワポウインドウ、というかプロセスは「パワポ制御プログラム」が終了しても終わりません。
その点で言うと元ネタ記事のプログラムは全オブジェクトを解放してないと思うのでちゃんとExcelが終了するのかちょっと気になります（元ネタのプログラムは動かしてない）素のobjectじゃなくてIDisposable実装したラッパークラス作ったりすると幸せになりそうな気がしますが、実際のプログラムではオブジェクトの生成と破棄が別メソッドに分かれているのでラッパークラスは作りませんでした。Workbooks.Openのリファレンスはこちら。よくよく数えてみると引数は15個ありますね。 ↩


