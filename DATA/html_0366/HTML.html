<!DOCTYPE html><html><head><meta charset="utf-8" /><title>細かすぎるUnity最適化の話 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/Nakatomo/items/ace31ac9de2e0bdb87bf" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="KPZ67EopFf/mBGT/+IczM/q1O1Zyh5hhkRQLLwkAjtLgphWc/C3OFnTgdJKc02ioZpVb4UQ+PnbG1fjIbdtcPw==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="細かすぎるUnity最適化の話 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01N1N3NDRHTDQ0R1o0NEdPNDRLTFZXNXBkSG5tbklEcGdhbmxqSmJqZ2E3b3FiRSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1iZDJkNDY1Njc1NjI2MTAyZWNmZTM5MjAyODJhZDY3Mg&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRTVoYTJGMGIyMXYmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz00ZjlkODlkNjQyYjY0YTVmMjgyYTcwNTcwN2QyMTMyMg&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=75bf5a0d8232b56cae9ee1fea8ee4ff0"><meta property="og:description" content="

あばうと

ゲーム大賞アマチュア部門で佳作を受賞したボルカノンで実際に行った最適化を書きます。
紹介動画↓
https://www.youtube.com/watch?v=KWcx2CNQ_ks&amp;amp;ab_channel=aw..."><meta content="https://qiita.com/Nakatomo/items/ace31ac9de2e0bdb87bf" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,Unity,最適化" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-6ddbfa34-5b52-4c83-a926-dad113e33458"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FNakatomo%2Fitems%2Face31ac9de2e0bdb87bf">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FNakatomo%2Fitems%2Face31ac9de2e0bdb87bf">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-6ddbfa34-5b52-4c83-a926-dad113e33458">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-11-05T22:06:27.000+09:00","dateModified":"2020-12-03T07:00:39.000+09:00","headline":"細かすぎるUnity最適化の話","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND01N1N3NDRHTDQ0R1o0NEdPNDRLTFZXNXBkSG5tbklEcGdhbmxqSmJqZ2E3b3FiRSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1iZDJkNDY1Njc1NjI2MTAyZWNmZTM5MjAyODJhZDY3Mg\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRTVoYTJGMGIyMXYmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz00ZjlkODlkNjQyYjY0YTVmMjgyYTcwNTcwN2QyMTMyMg\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=75bf5a0d8232b56cae9ee1fea8ee4ff0","mainEntityOfPage":"https://qiita.com/Nakatomo/items/ace31ac9de2e0bdb87bf","author":{"@type":"Person","address":null,"email":null,"identifier":"Nakatomo","name":"Nakatomo","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F113502%2Fprofile-images%2F1473712282?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=7d08b7383f20977bcd185eda1a615abb","url":"https://qiita.com/Nakatomo","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Nakatomo","type":"items","id":"ace31ac9de2e0bdb87bf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Nakatomo","type":"items","id":"ace31ac9de2e0bdb87bf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Nakatomo","type":"items","id":"ace31ac9de2e0bdb87bf"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"「AirPods Pro」を抽選でプレゼント！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/Nakatomo/items/ace31ac9de2e0bdb87bf","location":"/Nakatomo/items/ace31ac9de2e0bdb87bf","scheme":"https","host":"qiita.com","port":null,"pathname":"/Nakatomo/items/ace31ac9de2e0bdb87bf","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"27aN5bV+AySQSBbCTe7iB+yjhLqhWx0+iAfrA5UkZvET5uKVA3rYzQKsBq8purmccIPkDZfiuynfxhjk8f+0HA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-87ce355d-d00e-4e5a-814d-c0765894d13e"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/likers" class="css-1iupg5d">14</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">3</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/ace31ac9de2e0bdb87bf/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="it-AdcalRibbon"><span><a href="/advent-calendar/2020/life-is-tech" class="it-AdcalRibbon_title">Life is Tech ! #1<!-- --> Advent Calendar<!-- --> <!-- -->2020</a>Day 3</span></div><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/Nakatomo"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/113502/profile-images/1473712282" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/Nakatomo" class="css-10ougpm">@<!-- -->Nakatomo</a><div class="css-1ay9vb9"><span><meta content="2020-11-05T13:06:27Z"/><time dateTime="2020-12-02T22:00:39Z" class="css-m19uds">updated at 2020-12-02</time></span></div></div></div></div></div><h1 class="css-cgzq40">細かすぎるUnity最適化の話</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/unity" class="css-4czcte">Unity</a><a href="/tags/%e6%9c%80%e9%81%a9%e5%8c%96" class="css-4czcte">最適化</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="あばうと" class="fragment"></span><a href="#%E3%81%82%E3%81%B0%E3%81%86%E3%81%A8"><i class="fa fa-link"></i></a>あばうと</h1>

<p>ゲーム大賞アマチュア部門で佳作を受賞したボルカノンで実際に行った最適化を書きます。<br>
紹介動画↓<br>
<a href="https://www.youtube.com/watch?v=KWcx2CNQ_ks&amp;ab_channel=awardsJGA" class="autolink" rel="nofollow noopener" target="_blank">https://www.youtube.com/watch?v=KWcx2CNQ_ks&amp;ab_channel=awardsJGA</a></p>

<p>オンボードのGPU(Iris Plus Graphics 655)、Unityエディタ上で60FPS(平均90、最高120程度)出るように限界まで最適化しました。</p>

<h2>
<span id="ボルカノン" class="fragment"></span><a href="#%E3%83%9C%E3%83%AB%E3%82%AB%E3%83%8E%E3%83%B3"><i class="fa fa-link"></i></a>ボルカノン</h2>

<p>2Dドット+ドット化シェーダーのハイスピードアクション<br>
マグマを注入→噴射してジャンプ、壁に張り付いて縦横無尽に駆け回るゲーム。この記事を書いている時点で非公開<br>
チームメンバー8人(うちプログラマ3人)×4か月のプロジェクト</p>

<p>最低1万ブロック(200*60)以上の面積で、オブジェクト数は数千。その状況でFPSを落としてはいけないという条件で最適化をしていった具体例を紹介します。</p>

<h2>
<span id="基本" class="fragment"></span><a href="#%E5%9F%BA%E6%9C%AC"><i class="fa fa-link"></i></a>基本</h2>

<h3>
<span id="statを見る" class="fragment"></span><a href="#stat%E3%82%92%E8%A6%8B%E3%82%8B"><i class="fa fa-link"></i></a>Statを見る</h3>

<p>見るのは主にFPSの部分。細かい見方は検索してください。<br>
ちなみにこの開発中にFPSの目測が出来るようになりました。<br>
<a href="https://camo.qiitausercontent.com/0b4d40b5b51d9f424a59f9c2bcd1fd7fbcf28432/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f34326433303866302d313338362d313139322d353631332d6535313932386438343365372e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F42d308f0-1386-1192-5613-e51928d843e7.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e97d3fc9f54a12ba3b29fb8b29883427" alt="Stat.JPG" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/42d308f0-1386-1192-5613-e51928d843e7.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F42d308f0-1386-1192-5613-e51928d843e7.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=96a11893e2ea79908240b48dec7967c9 1x" loading="lazy"></a></p>

<h3>
<span id="プロファイラ" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%A9"><i class="fa fa-link"></i></a>プロファイラ</h3>

<p>こちらも見方は検索してください。<br>
見るのはPlayerLoopの中(EditorLoopは仕方がないので)<br>
急に重いフレームが出るのはアクションゲームとして致命的なので検証対象。<br>
その中で何が重いのかを調べ、処理の削減や分散をして最適化をしていきます。<br>
<a href="https://camo.qiitausercontent.com/742f25555a0437d64f8429e06120ce8299890fcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f64656461653939632d623033352d663530662d363230342d3331356637656538323731322e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fdedae99c-b035-f50f-6204-315f7ee82712.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=430404b1abc497272286733091608c66" alt="Profiler.JPG" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/dedae99c-b035-f50f-6204-315f7ee82712.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fdedae99c-b035-f50f-6204-315f7ee82712.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=abc93cb705006b9918dae52c6aa16f0d 1x" loading="lazy"></a></p>

<h3>
<span id="ポストエフェクト" class="fragment"></span><a href="#%E3%83%9D%E3%82%B9%E3%83%88%E3%82%A8%E3%83%95%E3%82%A7%E3%82%AF%E3%83%88"><i class="fa fa-link"></i></a>ポストエフェクト</h3>

<p>ドット化するエフェクトとドット画像を組み合わせて全体として2Dドットにしているので、エフェクトの対象範囲を減らすように(主に3Dモデル部分のみに限定)</p>

<h3>
<span id="ブロック数の調査staticに" class="fragment"></span><a href="#%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E6%95%B0%E3%81%AE%E8%AA%BF%E6%9F%BBstatic%E3%81%AB"><i class="fa fa-link"></i></a>ブロック数の調査→staticに</h3>

<p>仮のステージを作っていくうちに、最低のステージ面積は1万ブロック分は必要ということが判明(かなり広範囲を縦横無尽にハイスピードで動き回るので)<br>
動かないオブジェクトはstaticにする</p>

<h3>
<span id="頂点数を減らす" class="fragment"></span><a href="#%E9%A0%82%E7%82%B9%E6%95%B0%E3%82%92%E6%B8%9B%E3%82%89%E3%81%99"><i class="fa fa-link"></i></a>頂点数を減らす</h3>

<p>ステージを構成するブロックは1×1で大量(1万～3万)に敷き詰める前提なので、一つ一つを限界まで最適化。Spriteは扱いづらいので選択肢から除外。</p>

<table>
<thead>
<tr>
<th>オブジェクト</th>
<th>頂点数</th>
</tr>
</thead>
<tbody>
<tr>
<td>Box</td>
<td>100</td>
</tr>
<tr>
<td>Quad</td>
<td>20</td>
</tr>
<tr>
<td>Plane</td>
<td>609</td>
</tr>
</tbody>
</table>

<p>調査の結果、Quadを選択。裏面を自動的に描画しないなど3Dゲームでは使いづらいが2Dゲームなので逆に加点。</p>

<h3>
<span id="半透明は重い" class="fragment"></span><a href="#%E5%8D%8A%E9%80%8F%E6%98%8E%E3%81%AF%E9%87%8D%E3%81%84"><i class="fa fa-link"></i></a>半透明は重い</h3>

<p>ゲームの描画計算は</p>

<table>
<thead>
<tr>
<th>内容</th>
<th>処理方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>不透明</td>
<td>書き換える(代入)</td>
</tr>
<tr>
<td>半透明</td>
<td>計算して加算</td>
</tr>
<tr>
<td>透明</td>
<td>計算しない</td>
</tr>
</tbody>
</table>

<p>という処理の差があり、半透明の方が重いので基本的に理由がないなら完全不透明か透明にする</p>

<h3>
<span id="画像設定" class="fragment"></span><a href="#%E7%94%BB%E5%83%8F%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>画像設定</h3>

<p>・画像はある程度の粒度で一つにまとめる。読み込む「回数」が重くなる原因なので一つにまとめるとよい<br>
・ブロックとの距離が一定かつドット絵なので、MipMapを生成しないように<br>
・FilterはドットなのでNoPoint(画像処理を挟まない)が良かったが、ちらつくのでTrilinearに<br>
・画像サイズは2の倍数に。さらに一つの画像にまとめる画像数は2の倍数に(4*4など)<br>
・画像の中で半透明は使わず、完全透明or完全不透明に<br>
<a href="https://camo.qiitausercontent.com/ecd499090c65a6549db8ab6cbc3f609bb1e2462d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f65333232373336632d303338302d323261382d336261312d6264373336326437383231662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fe322736c-0380-22a8-3ba1-bd7362d7821f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=784f4c609c63091d949f98732760f87c" alt="Tex_ANormalBlockV1.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/e322736c-0380-22a8-3ba1-bd7362d7821f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fe322736c-0380-22a8-3ba1-bd7362d7821f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=44d2ab2783718348aff09920e88935bc 1x" loading="lazy"></a></p>

<h3>
<span id="カメラ" class="fragment"></span><a href="#%E3%82%AB%E3%83%A1%E3%83%A9"><i class="fa fa-link"></i></a>カメラ</h3>

<p>・ClearフラグはSolidColorに<br>
・ClippingPlanes(描画する範囲)を出来る限り狭く(ボルカノンでは1～200、背景の範囲ぎりぎり)</p>

<h3>
<span id="パーティクル" class="fragment"></span><a href="#%E3%83%91%E3%83%BC%E3%83%86%E3%82%A3%E3%82%AF%E3%83%AB"><i class="fa fa-link"></i></a>パーティクル</h3>

<p>・MaxParticleを、durationを限界まで制限(一番効果あり)<br>
・出来る限り半透明はなし(画像から)<br>
・出来る限りモジュールは不使用(VelocityOverLifetime、ColorOverLifetimeなど)<br>
・色は2進数換算で1の数が少ないもの(0.5、0.25の倍数)<br>
飛んでいる時のマグマのエフェクトだけで3つ、それを10個以上並べていたのでこの改善だけで10FPS以上改善</p>

<h3>
<span id="不必要なrigidbodyの削除" class="fragment"></span><a href="#%E4%B8%8D%E5%BF%85%E8%A6%81%E3%81%AArigidbody%E3%81%AE%E5%89%8A%E9%99%A4"><i class="fa fa-link"></i></a>不必要なRigidbodyの削除</h3>

<p>これは開発中のミス。<br>
OnCollisionからOnTriggerにしていたのでブロック側のRigidbodyを削除。</p>

<h2>
<span id="細かすぎる最適化" class="fragment"></span><a href="#%E7%B4%B0%E3%81%8B%E3%81%99%E3%81%8E%E3%82%8B%E6%9C%80%E9%81%A9%E5%8C%96"><i class="fa fa-link"></i></a>細かすぎる最適化</h2>

<h3>
<span id="material" class="fragment"></span><a href="#material"><i class="fa fa-link"></i></a>Material</h3>

<p>・RenderingModeはCutOutに<br>
・Shaderの優先度はUnlitColor(1色塗りつぶし)→Unlit(光の描画計算しない)→Standard(光の計算する)を使用<br>
・Smoothnessは0</p>

<h3>
<span id="空のstartupdateは削除" class="fragment"></span><a href="#%E7%A9%BA%E3%81%AEstartupdate%E3%81%AF%E5%89%8A%E9%99%A4"><i class="fa fa-link"></i></a>空のStart、Updateは削除</h3>

<p>ブロックのStartの呼び出し×数千で数ms使っていたので関数ごと削除</p>

<h3>
<span id="少しずつ生成する" class="fragment"></span><a href="#%E5%B0%91%E3%81%97%E3%81%9A%E3%81%A4%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>少しずつ生成する</h3>

<p>Colliderがあると触れ始めた一番最初のフレームにチェックが走る(ちょい重い)ので、それが数千オブジェクト同士でやると数フレーム分かかっていたのでロードの時に少しずつ生成して解消</p>

<h3>
<span id="transformのキャッシュ" class="fragment"></span><a href="#transform%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5"><i class="fa fa-link"></i></a>Transformのキャッシュ</h3>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">Sample.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="n">Transform</span> <span class="n">thisTransform</span><span class="p">;</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Awake</span><span class="p">(){</span>
    <span class="n">thisTransform</span> <span class="p">=</span> <span class="n">gameObject</span><span class="p">.</span><span class="n">transform</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>コンポーネント取得関係でtransformはかなり最適化されているが、それでもキャッシュには叶わないらしい。<br>
GetComponentは激重なので同じコンポーネントはキャッシュすること</p>

<p>ちなみに、少人数開発だからできたことだがPlayerやManagerなど一つしかないクラスはシングルトンにし、それのpublicでstaticな変数とすることでGetComponentの数自体を減らしている。</p>

<h3>
<span id="stringbuilder" class="fragment"></span><a href="#stringbuilder"><i class="fa fa-link"></i></a>StringBuilder</h3>

<p>文字列同士の結合は重いのでStringBuilderを使用(詳しくは検索推奨)<br>
主にステージエディタで使用</p>

<h3>
<span id="タグの比較はcomparetag" class="fragment"></span><a href="#%E3%82%BF%E3%82%B0%E3%81%AE%E6%AF%94%E8%BC%83%E3%81%AFcomparetag"><i class="fa fa-link"></i></a>タグの比較はCompareTag</h3>

<p>タグの比較は文字列比較ではなくCompareTagの方が速い</p>

<h3>
<span id="if内ので繋ぐものは最初に満たす確率が小さくなるように" class="fragment"></span><a href="#if%E5%86%85%E3%81%AE%E3%81%A7%E7%B9%8B%E3%81%90%E3%82%82%E3%81%AE%E3%81%AF%E6%9C%80%E5%88%9D%E3%81%AB%E6%BA%80%E3%81%9F%E3%81%99%E7%A2%BA%E7%8E%87%E3%81%8C%E5%B0%8F%E3%81%95%E3%81%8F%E3%81%AA%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB"><i class="fa fa-link"></i></a>if内の&amp;&amp;で繋ぐものは最初に満たす確率が小さくなるように</h3>

<p>これは条件を満たさない時に有効。</p>

<p>例えばnumが2の倍数かつ3の倍数かつ5の倍数であるかどうかを調べるときに<br>
<code>if(num % 2 == 0 &amp;&amp; num % 3 == 0 &amp;&amp; num % 5 == 0)</code><br>
よりも<br>
<code>if(num % 5 == 0 &amp;&amp; num % 3 == 0 &amp;&amp; num % 2 == 0)</code><br>
の方が5の倍数でない(80%)時点で検証が終わるので、上よりも条件を満たさない時に速くなる</p>

<h3>
<span id="phisicsのレイヤー設定を見直す" class="fragment"></span><a href="#phisics%E3%81%AE%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%A8%AD%E5%AE%9A%E3%82%92%E8%A6%8B%E7%9B%B4%E3%81%99"><i class="fa fa-link"></i></a>Phisicsのレイヤー設定を見直す</h3>

<p>Layer同士で衝突判定をするか設定できるので、関係ないレイヤー同士は衝突判定をしないように見直すと軽くなったりする。<br>
ドット化シェーダーを掛けるもの(3Dオブジェクト、プレイヤーと敵)とかけないもの(ブロック)はお互いしか接触しないように設定。気休めだったがデフォルトのチェックボックスびっしりよりはましになった気がする。</p>

<p><a href="https://camo.qiitausercontent.com/cb7552beb50c50786bed182f6acee4c86a2919c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f30303135656439392d646637652d333161352d363431302d3163613664613666366461342e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F0015ed99-df7e-31a5-6410-1ca6da6f6da4.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2e8117a41cea7f6a4cf2324fe52e5eb8" alt="レイヤー設定.JPG" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/0015ed99-df7e-31a5-6410-1ca6da6f6da4.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F0015ed99-df7e-31a5-6410-1ca6da6f6da4.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e607fa6b08eca17552c8015421a01790 1x" loading="lazy"></a></p>

<h2>
<span id="その他" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96"><i class="fa fa-link"></i></a>その他</h2>

<h3>
<span id="宣伝" class="fragment"></span><a href="#%E5%AE%A3%E4%BC%9D"><i class="fa fa-link"></i></a>宣伝</h3>

<p>C#の話ですが拙記事もどうぞ<br>
<a href="https://qiita.com/Nakatomo/items/ed55196f11068689923e" class="autolink" id="reference-2378370119ad9e4d21e1">https://qiita.com/Nakatomo/items/ed55196f11068689923e</a></p>

<h3>
<span id="そもそもunityで最適化しても所詮cじゃん" class="fragment"></span><a href="#%E3%81%9D%E3%82%82%E3%81%9D%E3%82%82unity%E3%81%A7%E6%9C%80%E9%81%A9%E5%8C%96%E3%81%97%E3%81%A6%E3%82%82%E6%89%80%E8%A9%AEc%E3%81%98%E3%82%83%E3%82%93"><i class="fa fa-link"></i></a>そもそもUnityで最適化しても所詮C#じゃん</h3>

<p>Unityはビルド時にIL2CPPというツールでC#をC++に変換しているので、C#ゆえに重いというのはビルド時に解消されるはずです</p>

<h3>
<span id="どうしても重いフレームは暗転で" class="fragment"></span><a href="#%E3%81%A9%E3%81%86%E3%81%97%E3%81%A6%E3%82%82%E9%87%8D%E3%81%84%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%81%AF%E6%9A%97%E8%BB%A2%E3%81%A7"><i class="fa fa-link"></i></a>どうしても重いフレームは暗転で</h3>

<p>これはどうしようもない時の裏技。画面が完全に暗い状態でならカクついても気が付かない</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FNakatomo%2Fitems%2Face31ac9de2e0bdb87bf&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FNakatomo%2Fitems%2Face31ac9de2e0bdb87bf&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/likers" class="css-1iupg5d">14</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">3</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/ace31ac9de2e0bdb87bf/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Nakatomo/items/ace31ac9de2e0bdb87bf.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-87ce355d-d00e-4e5a-814d-c0765894d13e">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-cf7f6ceb-b15a-4ea3-b649-50507f13f93f"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-cf7f6ceb-b15a-4ea3-b649-50507f13f93f">{}</script>
      
<div id="LoginModal-react-component-7856d851-69d7-4ad8-a29d-ecf72d087651"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-7856d851-69d7-4ad8-a29d-ecf72d087651">{}</script>
      
<div id="StockModal-react-component-7fbfc614-0587-456b-9b92-f0c1171f905a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-7fbfc614-0587-456b-9b92-f0c1171f905a">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;ytpucxitxDUxe9rj1ciID7BnwUyvkpA9DOVi2mot9ggCigEDrqkf3KOfyo6xnNOULEeh+5krNipbJJE9DvYk5Q==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"あばうと\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%81%B0%E3%81%86%E3%81%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあばうと\u003c/h1\u003e\n\n\u003cp\u003eゲーム大賞アマチュア部門で佳作を受賞したボルカノンで実際に行った最適化を書きます。\u003cbr\u003e\n紹介動画↓\u003cbr\u003e\n\u003ca href=\"https://www.youtube.com/watch?v=KWcx2CNQ_ks\u0026amp;ab_channel=awardsJGA\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.youtube.com/watch?v=KWcx2CNQ_ks\u0026amp;ab_channel=awardsJGA\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eオンボードのGPU(Iris Plus Graphics 655)、Unityエディタ上で60FPS(平均90、最高120程度)出るように限界まで最適化しました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ボルカノン\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9C%E3%83%AB%E3%82%AB%E3%83%8E%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eボルカノン\u003c/h2\u003e\n\n\u003cp\u003e2Dドット+ドット化シェーダーのハイスピードアクション\u003cbr\u003e\nマグマを注入→噴射してジャンプ、壁に張り付いて縦横無尽に駆け回るゲーム。この記事を書いている時点で非公開\u003cbr\u003e\nチームメンバー8人(うちプログラマ3人)×4か月のプロジェクト\u003c/p\u003e\n\n\u003cp\u003e最低1万ブロック(200*60)以上の面積で、オブジェクト数は数千。その状況でFPSを落としてはいけないという条件で最適化をしていった具体例を紹介します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"基本\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9F%BA%E6%9C%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e基本\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"statを見る\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#stat%E3%82%92%E8%A6%8B%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eStatを見る\u003c/h3\u003e\n\n\u003cp\u003e見るのは主にFPSの部分。細かい見方は検索してください。\u003cbr\u003e\nちなみにこの開発中にFPSの目測が出来るようになりました。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/0b4d40b5b51d9f424a59f9c2bcd1fd7fbcf28432/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f34326433303866302d313338362d313139322d353631332d6535313932386438343365372e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F42d308f0-1386-1192-5613-e51928d843e7.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e97d3fc9f54a12ba3b29fb8b29883427\" alt=\"Stat.JPG\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/42d308f0-1386-1192-5613-e51928d843e7.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F42d308f0-1386-1192-5613-e51928d843e7.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=96a11893e2ea79908240b48dec7967c9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"プロファイラ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%A9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロファイラ\u003c/h3\u003e\n\n\u003cp\u003eこちらも見方は検索してください。\u003cbr\u003e\n見るのはPlayerLoopの中(EditorLoopは仕方がないので)\u003cbr\u003e\n急に重いフレームが出るのはアクションゲームとして致命的なので検証対象。\u003cbr\u003e\nその中で何が重いのかを調べ、処理の削減や分散をして最適化をしていきます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/742f25555a0437d64f8429e06120ce8299890fcd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f64656461653939632d623033352d663530662d363230342d3331356637656538323731322e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fdedae99c-b035-f50f-6204-315f7ee82712.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=430404b1abc497272286733091608c66\" alt=\"Profiler.JPG\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/dedae99c-b035-f50f-6204-315f7ee82712.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fdedae99c-b035-f50f-6204-315f7ee82712.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=abc93cb705006b9918dae52c6aa16f0d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ポストエフェクト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9D%E3%82%B9%E3%83%88%E3%82%A8%E3%83%95%E3%82%A7%E3%82%AF%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eポストエフェクト\u003c/h3\u003e\n\n\u003cp\u003eドット化するエフェクトとドット画像を組み合わせて全体として2Dドットにしているので、エフェクトの対象範囲を減らすように(主に3Dモデル部分のみに限定)\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ブロック数の調査staticに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E6%95%B0%E3%81%AE%E8%AA%BF%E6%9F%BBstatic%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eブロック数の調査→staticに\u003c/h3\u003e\n\n\u003cp\u003e仮のステージを作っていくうちに、最低のステージ面積は1万ブロック分は必要ということが判明(かなり広範囲を縦横無尽にハイスピードで動き回るので)\u003cbr\u003e\n動かないオブジェクトはstaticにする\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"頂点数を減らす\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%A0%82%E7%82%B9%E6%95%B0%E3%82%92%E6%B8%9B%E3%82%89%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e頂点数を減らす\u003c/h3\u003e\n\n\u003cp\u003eステージを構成するブロックは1×1で大量(1万～3万)に敷き詰める前提なので、一つ一つを限界まで最適化。Spriteは扱いづらいので選択肢から除外。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eオブジェクト\u003c/th\u003e\n\u003cth\u003e頂点数\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eBox\u003c/td\u003e\n\u003ctd\u003e100\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eQuad\u003c/td\u003e\n\u003ctd\u003e20\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePlane\u003c/td\u003e\n\u003ctd\u003e609\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e調査の結果、Quadを選択。裏面を自動的に描画しないなど3Dゲームでは使いづらいが2Dゲームなので逆に加点。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"半透明は重い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8D%8A%E9%80%8F%E6%98%8E%E3%81%AF%E9%87%8D%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e半透明は重い\u003c/h3\u003e\n\n\u003cp\u003eゲームの描画計算は\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e内容\u003c/th\u003e\n\u003cth\u003e処理方法\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e不透明\u003c/td\u003e\n\u003ctd\u003e書き換える(代入)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e半透明\u003c/td\u003e\n\u003ctd\u003e計算して加算\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e透明\u003c/td\u003e\n\u003ctd\u003e計算しない\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eという処理の差があり、半透明の方が重いので基本的に理由がないなら完全不透明か透明にする\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"画像設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%94%BB%E5%83%8F%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e画像設定\u003c/h3\u003e\n\n\u003cp\u003e・画像はある程度の粒度で一つにまとめる。読み込む「回数」が重くなる原因なので一つにまとめるとよい\u003cbr\u003e\n・ブロックとの距離が一定かつドット絵なので、MipMapを生成しないように\u003cbr\u003e\n・FilterはドットなのでNoPoint(画像処理を挟まない)が良かったが、ちらつくのでTrilinearに\u003cbr\u003e\n・画像サイズは2の倍数に。さらに一つの画像にまとめる画像数は2の倍数に(4*4など)\u003cbr\u003e\n・画像の中で半透明は使わず、完全透明or完全不透明に\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/ecd499090c65a6549db8ab6cbc3f609bb1e2462d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f65333232373336632d303338302d323261382d336261312d6264373336326437383231662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fe322736c-0380-22a8-3ba1-bd7362d7821f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=784f4c609c63091d949f98732760f87c\" alt=\"Tex_ANormalBlockV1.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/e322736c-0380-22a8-3ba1-bd7362d7821f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2Fe322736c-0380-22a8-3ba1-bd7362d7821f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=44d2ab2783718348aff09920e88935bc 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"カメラ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AB%E3%83%A1%E3%83%A9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eカメラ\u003c/h3\u003e\n\n\u003cp\u003e・ClearフラグはSolidColorに\u003cbr\u003e\n・ClippingPlanes(描画する範囲)を出来る限り狭く(ボルカノンでは1～200、背景の範囲ぎりぎり)\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"パーティクル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%91%E3%83%BC%E3%83%86%E3%82%A3%E3%82%AF%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eパーティクル\u003c/h3\u003e\n\n\u003cp\u003e・MaxParticleを、durationを限界まで制限(一番効果あり)\u003cbr\u003e\n・出来る限り半透明はなし(画像から)\u003cbr\u003e\n・出来る限りモジュールは不使用(VelocityOverLifetime、ColorOverLifetimeなど)\u003cbr\u003e\n・色は2進数換算で1の数が少ないもの(0.5、0.25の倍数)\u003cbr\u003e\n飛んでいる時のマグマのエフェクトだけで3つ、それを10個以上並べていたのでこの改善だけで10FPS以上改善\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"不必要なrigidbodyの削除\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%B8%8D%E5%BF%85%E8%A6%81%E3%81%AArigidbody%E3%81%AE%E5%89%8A%E9%99%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e不必要なRigidbodyの削除\u003c/h3\u003e\n\n\u003cp\u003eこれは開発中のミス。\u003cbr\u003e\nOnCollisionからOnTriggerにしていたのでブロック側のRigidbodyを削除。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"細かすぎる最適化\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B4%B0%E3%81%8B%E3%81%99%E3%81%8E%E3%82%8B%E6%9C%80%E9%81%A9%E5%8C%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e細かすぎる最適化\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"material\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#material\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMaterial\u003c/h3\u003e\n\n\u003cp\u003e・RenderingModeはCutOutに\u003cbr\u003e\n・Shaderの優先度はUnlitColor(1色塗りつぶし)→Unlit(光の描画計算しない)→Standard(光の計算する)を使用\u003cbr\u003e\n・Smoothnessは0\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"空のstartupdateは削除\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%A9%BA%E3%81%AEstartupdate%E3%81%AF%E5%89%8A%E9%99%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e空のStart、Updateは削除\u003c/h3\u003e\n\n\u003cp\u003eブロックのStartの呼び出し×数千で数ms使っていたので関数ごと削除\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"少しずつ生成する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%B0%91%E3%81%97%E3%81%9A%E3%81%A4%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e少しずつ生成する\u003c/h3\u003e\n\n\u003cp\u003eColliderがあると触れ始めた一番最初のフレームにチェックが走る(ちょい重い)ので、それが数千オブジェクト同士でやると数フレーム分かかっていたのでロードの時に少しずつ生成して解消\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"transformのキャッシュ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#transform%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTransformのキャッシュ\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eSample.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eTransform\u003c/span\u003e \u003cspan class=\"n\"\u003ethisTransform\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAwake\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ethisTransform\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egameObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etransform\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eコンポーネント取得関係でtransformはかなり最適化されているが、それでもキャッシュには叶わないらしい。\u003cbr\u003e\nGetComponentは激重なので同じコンポーネントはキャッシュすること\u003c/p\u003e\n\n\u003cp\u003eちなみに、少人数開発だからできたことだがPlayerやManagerなど一つしかないクラスはシングルトンにし、それのpublicでstaticな変数とすることでGetComponentの数自体を減らしている。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"stringbuilder\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#stringbuilder\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eStringBuilder\u003c/h3\u003e\n\n\u003cp\u003e文字列同士の結合は重いのでStringBuilderを使用(詳しくは検索推奨)\u003cbr\u003e\n主にステージエディタで使用\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"タグの比較はcomparetag\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%BF%E3%82%B0%E3%81%AE%E6%AF%94%E8%BC%83%E3%81%AFcomparetag\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eタグの比較はCompareTag\u003c/h3\u003e\n\n\u003cp\u003eタグの比較は文字列比較ではなくCompareTagの方が速い\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"if内ので繋ぐものは最初に満たす確率が小さくなるように\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#if%E5%86%85%E3%81%AE%E3%81%A7%E7%B9%8B%E3%81%90%E3%82%82%E3%81%AE%E3%81%AF%E6%9C%80%E5%88%9D%E3%81%AB%E6%BA%80%E3%81%9F%E3%81%99%E7%A2%BA%E7%8E%87%E3%81%8C%E5%B0%8F%E3%81%95%E3%81%8F%E3%81%AA%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eif内の\u0026amp;\u0026amp;で繋ぐものは最初に満たす確率が小さくなるように\u003c/h3\u003e\n\n\u003cp\u003eこれは条件を満たさない時に有効。\u003c/p\u003e\n\n\u003cp\u003e例えばnumが2の倍数かつ3の倍数かつ5の倍数であるかどうかを調べるときに\u003cbr\u003e\n\u003ccode\u003eif(num % 2 == 0 \u0026amp;\u0026amp; num % 3 == 0 \u0026amp;\u0026amp; num % 5 == 0)\u003c/code\u003e\u003cbr\u003e\nよりも\u003cbr\u003e\n\u003ccode\u003eif(num % 5 == 0 \u0026amp;\u0026amp; num % 3 == 0 \u0026amp;\u0026amp; num % 2 == 0)\u003c/code\u003e\u003cbr\u003e\nの方が5の倍数でない(80%)時点で検証が終わるので、上よりも条件を満たさない時に速くなる\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"phisicsのレイヤー設定を見直す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#phisics%E3%81%AE%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%A8%AD%E5%AE%9A%E3%82%92%E8%A6%8B%E7%9B%B4%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ePhisicsのレイヤー設定を見直す\u003c/h3\u003e\n\n\u003cp\u003eLayer同士で衝突判定をするか設定できるので、関係ないレイヤー同士は衝突判定をしないように見直すと軽くなったりする。\u003cbr\u003e\nドット化シェーダーを掛けるもの(3Dオブジェクト、プレイヤーと敵)とかけないもの(ブロック)はお互いしか接触しないように設定。気休めだったがデフォルトのチェックボックスびっしりよりはましになった気がする。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/cb7552beb50c50786bed182f6acee4c86a2919c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131333530322f30303135656439392d646637652d333161352d363431302d3163613664613666366461342e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F0015ed99-df7e-31a5-6410-1ca6da6f6da4.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2e8117a41cea7f6a4cf2324fe52e5eb8\" alt=\"レイヤー設定.JPG\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/113502/0015ed99-df7e-31a5-6410-1ca6da6f6da4.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F113502%2F0015ed99-df7e-31a5-6410-1ca6da6f6da4.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e607fa6b08eca17552c8015421a01790 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"その他\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその他\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"宣伝\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%A3%E4%BC%9D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e宣伝\u003c/h3\u003e\n\n\u003cp\u003eC#の話ですが拙記事もどうぞ\u003cbr\u003e\n\u003ca href=\"https://qiita.com/Nakatomo/items/ed55196f11068689923e\" class=\"autolink\" id=\"reference-2378370119ad9e4d21e1\"\u003ehttps://qiita.com/Nakatomo/items/ed55196f11068689923e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"そもそもunityで最適化しても所詮cじゃん\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%82%82%E3%81%9D%E3%82%82unity%E3%81%A7%E6%9C%80%E9%81%A9%E5%8C%96%E3%81%97%E3%81%A6%E3%82%82%E6%89%80%E8%A9%AEc%E3%81%98%E3%82%83%E3%82%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eそもそもUnityで最適化しても所詮C#じゃん\u003c/h3\u003e\n\n\u003cp\u003eUnityはビルド時にIL2CPPというツールでC#をC++に変換しているので、C#ゆえに重いというのはビルド時に解消されるはずです\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"どうしても重いフレームは暗転で\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A9%E3%81%86%E3%81%97%E3%81%A6%E3%82%82%E9%87%8D%E3%81%84%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%81%AF%E6%9A%97%E8%BB%A2%E3%81%A7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eどうしても重いフレームは暗転で\u003c/h3\u003e\n\n\u003cp\u003eこれはどうしようもない時の裏技。画面が完全に暗い状態でならカクついても気が付かない\u003c/p\u003e\n","createdAt":"2020-11-05T13:06:27Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"aztDQ9beR9tUKWpmNOVZiZ370+OxCmcqtg==--VWqpDaHNQBLYshQa--WyJebGurjHk4ruA3LC+Yxg==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-12-02T22:00:39Z","likesCount":14,"linkUrl":"https://qiita.com/Nakatomo/items/ace31ac9de2e0bdb87bf","organization":null,"originalId":1331972,"stockedCount":3,"title":"細かすぎるUnity最適化の話","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%82%E3%81%B0%E3%81%86%E3%81%A8\"\u003eあばうと\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9C%E3%83%AB%E3%82%AB%E3%83%8E%E3%83%B3\"\u003eボルカノン\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9F%BA%E6%9C%AC\"\u003e基本\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#stat%E3%82%92%E8%A6%8B%E3%82%8B\"\u003eStatを見る\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%A9\"\u003eプロファイラ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9D%E3%82%B9%E3%83%88%E3%82%A8%E3%83%95%E3%82%A7%E3%82%AF%E3%83%88\"\u003eポストエフェクト\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E6%95%B0%E3%81%AE%E8%AA%BF%E6%9F%BBstatic%E3%81%AB\"\u003eブロック数の調査→staticに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%A0%82%E7%82%B9%E6%95%B0%E3%82%92%E6%B8%9B%E3%82%89%E3%81%99\"\u003e頂点数を減らす\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8D%8A%E9%80%8F%E6%98%8E%E3%81%AF%E9%87%8D%E3%81%84\"\u003e半透明は重い\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%94%BB%E5%83%8F%E8%A8%AD%E5%AE%9A\"\u003e画像設定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AB%E3%83%A1%E3%83%A9\"\u003eカメラ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%91%E3%83%BC%E3%83%86%E3%82%A3%E3%82%AF%E3%83%AB\"\u003eパーティクル\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%B8%8D%E5%BF%85%E8%A6%81%E3%81%AArigidbody%E3%81%AE%E5%89%8A%E9%99%A4\"\u003e不必要なRigidbodyの削除\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B4%B0%E3%81%8B%E3%81%99%E3%81%8E%E3%82%8B%E6%9C%80%E9%81%A9%E5%8C%96\"\u003e細かすぎる最適化\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#material\"\u003eMaterial\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%A9%BA%E3%81%AEstartupdate%E3%81%AF%E5%89%8A%E9%99%A4\"\u003e空のStart、Updateは削除\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%B0%91%E3%81%97%E3%81%9A%E3%81%A4%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B\"\u003e少しずつ生成する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#transform%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5\"\u003eTransformのキャッシュ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#stringbuilder\"\u003eStringBuilder\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%B0%E3%81%AE%E6%AF%94%E8%BC%83%E3%81%AFcomparetag\"\u003eタグの比較はCompareTag\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#if%E5%86%85%E3%81%AE%E3%81%A7%E7%B9%8B%E3%81%90%E3%82%82%E3%81%AE%E3%81%AF%E6%9C%80%E5%88%9D%E3%81%AB%E6%BA%80%E3%81%9F%E3%81%99%E7%A2%BA%E7%8E%87%E3%81%8C%E5%B0%8F%E3%81%95%E3%81%8F%E3%81%AA%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB\"\u003eif内の\u0026amp;\u0026amp;で繋ぐものは最初に満たす確率が小さくなるように\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#phisics%E3%81%AE%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%A8%AD%E5%AE%9A%E3%82%92%E8%A6%8B%E7%9B%B4%E3%81%99\"\u003ePhisicsのレイヤー設定を見直す\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%E4%BB%96\"\u003eその他\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%A3%E4%BC%9D\"\u003e宣伝\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%82%82%E3%81%9D%E3%82%82unity%E3%81%A7%E6%9C%80%E9%81%A9%E5%8C%96%E3%81%97%E3%81%A6%E3%82%82%E6%89%80%E8%A9%AEc%E3%81%98%E3%82%83%E3%82%93\"\u003eそもそもUnityで最適化しても所詮C#じゃん\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%A9%E3%81%86%E3%81%97%E3%81%A6%E3%82%82%E9%87%8D%E3%81%84%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%81%AF%E6%9A%97%E8%BB%A2%E3%81%A7\"\u003eどうしても重いフレームは暗転で\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":18121,"uuid":"ace31ac9de2e0bdb87bf","banReason":null,"adventCalendarItem":{"day":3,"calendar":{"name":"Life is Tech ! #1","urlName":"life-is-tech","year":2020,"organization":null}},"author":{"encryptedId":"HOwszfwkuhbt9IwBVdjp9f2jc1T9--jFxqo+no+n5mnmZG--gR9eZqoXdt/Zhp8al1WWpQ==","originalId":113502,"description":"","facebookUrl":null,"githubUrl":"https://github.com/nakatomo3","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/113502/profile-images/1473712282","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F113502%2Fprofile-images%2F1473712282?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=960322bf6e6a9927509b17506c688cb3","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F113502%2Fprofile-images%2F1473712282?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=7d08b7383f20977bcd185eda1a615abb","urlName":"Nakatomo","websiteUrl":null,"twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"Unity","urlName":"unity"},{"name":"最適化","urlName":"%e6%9c%80%e9%81%a9%e5%8c%96"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
