More than 3 years have passed since last update.エクセルの条件付き書式をコードに落とし込むために
現在の情報を取得しようとしたところ、LineStyleの取得の部分で
以下のようなエラーが発生してしまいました。以下のコードで再現しました。通常のセル(Range)に罫線をセットする場合、以下の場所が選択できます。参照: MSDN XlBordersIndex 列挙 (Excel)しかし、条件付き書式における罫線は上下左右の４つしかありません。
ここで再現コードのの部分に戻ると、xlEdgeTop は上記の表で 8 になるので、対応する Border がないために
値の取得ができないんですね。xlEdgeTop 等の列挙子を使わず、1～4の数字で指定すると取得できました。位置と数字は以下のように対応します。C# では型キャストが必要です。Excel Q&amp;Aサロンで回答いただきました。ありがとうございました。一応解決はできたんですが、なにかもっと正しい方法があるような気もします。
ご存知の方はぜひコメントください。


