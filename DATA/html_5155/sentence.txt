More than 3 years have passed since last update.macOSでC#の逆コンパイルの記事のをに置き換えて、ILSpyのインストールを行う。Unite2018の講演「さては非同期だなオメー！async/await完全に理解しよう」でasync/awaitのコードを逆コンパイルしていたので、実際に自分もやってみようと思った。
手元にあるPCがmacOSだったので、オープンソースのデコンパイラであるILSpyを利用した逆コンパイル方法を調べ、macOSでC#の逆コンパイルの記事にまとめた。しかし、ILSpyのCLIツールでは、なぜかasync/awaitの逆コンパイル結果が表示されず。。
ILSpyのコードを読んでみると、CLIツールではasync/awaitの逆コンパイル結果が表示されないようなオプションとなっていることが分かった。ということで、と修正を行ったところ、async/awaitの逆コンパイル結果が表示されるようになった
元レポジトリをforkして修正したブランチはこちら
https://github.com/tatsumack/ILSpy/tree/visible_async_await_decompileasync/awaitを逆コンパイルしてみると、state machineが内部に生成されていることが分かる。コンパイル前逆コンパイル後解説は下記ページが参考になると思います。
https://www.slideshare.net/UnityTechnologiesJapan/unite-tokyo-2018asyncawait
http://blog.xin9le.net/entry/2012/08/06/123916


