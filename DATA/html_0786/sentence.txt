データ型クラスのプロパティメンバを、リストのようにインデクサでアクセス出来るようにしたい。下記のUserInfoクラスのプロパティを、インデクサでアクセス出来るようにする。このプロパティを追加することで、添字によるアクセスが可能になる。↑GetValueの戻り値はobject型なので、string型に変換している。このままだとあまり意味が無いので、インデクサでアクセス出来るようにする。下記をUserInfoクラスに追加NameListはプロパティ名一覧が入ったリスト(プロパティ名のインデックス用途)として使います。this[string propertyName]をラッパー。
NameList[num]でthis[string propertyName]の添字に変換します。これにより、インデクサでのアクセスが出来るようになります。ただ、これだけでは列挙型として使うことができません。IEnumerableを継承し、IEnumerableインターフェイスを作成。GetEnumeratorを実装することで、列挙型として扱えるようになります。インデクサでのアクセス、foreachでのループが出来るようになりました。
出来ましたが、手順が多く冗長な気がします。
もっといいやり方があれば教えて頂けるとありがたいです。【C#】プロパティ名でプロパティにアクセスする


