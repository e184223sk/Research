More than 1 year has passed since last update.Parallel LINQ (PLINQ) ってどうなのとふと思ってので速度チェック。
配列全てに同じ処理をかけて値を加工します。
数字と'の違いは並列数を絞っているかどうか（8コア環境なので8に設定）。
1と2は並列毎にオブジェクト作成 vs オブジェクトを共有の違いです。ということでPLINQの方が速くて並列数とオブジェクト共有はほぼ同じになりました。試しにN=1千万件、Sleepなし（件数が多くタスクが軽い）でやってみました。N=1000件、Sleep(10)（件数が少なくタスクが重い）でやってみました。PLINQを使いつつ、件数が多い時はオブジェクトを共有することや並列数を絞ることは忘れないのが大体のパターンで通用しそうな感じです。
逆に共有しなかったり絞らないことで得られるメリットはあんまり無さそうな感じ。
共有はスレッドセーフかどうかも問題ですけどね。簡単なところはこの方針で。
LINQの内容によってはまたStopwatchで調べておきたいですね。


