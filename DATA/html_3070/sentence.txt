More than 1 year has passed since last update.久しぶりにネタが出来たので書いてみました。お仕事では入力項目に入ったバーコードリーダーの値をEnterキーイベント時に取得するようにしていました。「その３のキー押下の処理」を利用しています。ところが50回に数回くらいサーバーに送られた値と違う(桁数が足りない)現象が見受けられました。
※RS-232Cの入力データをキー入力に変換するソフトを使用していたり、処理能力が低いPCなどで発生しているので一般的なPCでは発生することはないと思われます。CefSharpのWebコンポーネント側での入力途中のタイミングで、先にEnterキーイベントで入力値を取得してしまうことが原因と思われます。IEのWebブラウザコンポーネントではpreviewkeydownイベントが専用にあったため問題にならなったのかな、やっていることは一緒なはずなんだが・・・サーバーに送られた値は正しいのでリクエストの値を取得できればいいと考えました。
調べるとCefSharpのWebコンポーネントには、RequestHandlerがあることが分かりました。サンプルは、「WinFormsでChromiumブラウザコンポーネント(CefSharp)を使ってみる その２」で使用した「Keisan 生活や実務に役立つ計算サイト - 体脂肪率」で、サイト読み込み完了直後に体脂肪率なら身長と体重を自動入力し、リクエストされた身長と体重と体脂肪率の結果を表示します。C#版はSharpDevelopでVBから変換したものです。リクエストした身長と体重を取得することが出来ています。リクエストした値をクライアント側で取得することはあまりない用途だと思います。この値をシリアルポートに送信して機器を動かすということをしています。一般的にOnBeforeResourceLoadの用途はリクエストヘッダーの値を変更するとかくらいでしょうかね。


