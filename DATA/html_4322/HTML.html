<!DOCTYPE html><html><head><meta charset="utf-8" /><title>.NET Core2.1でスマートメーターと戯れる Part1 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/HiroyukiSakoh/items/a93a76db89a9d6b80108" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="PzN3N9qcbIKXxy8deQTewEGApIo527sWOBlIeCiJCslhLGdo9amhGY1pWJRuVmyQaDZwu2yzh/Ha5ciAhSOpig==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content=".NET Core2.1でスマートメーターと戯れる Part1 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1MazVGVkNCRGIzSmxNaTR4NDRHbjQ0SzU0NE9lNDRPODQ0T0k0NE9oNDRPODQ0S180NE84NDRHbzVvaXY0NEtNNDRLTElGQmhjblF4JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWM4ZDEwNzJlYzQyZjg1Y2Q4YjFjYjg1Yjg2ZGM3Zjkz&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRWhwY205NWRXdHBVMkZyYjJnJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZGMyNzg5YmE3MzAwZmJjMjk5NDcxNDNhYTJkMDUxNWU&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=e93729ee97f771fb2c5f48d12f00d6af"><meta property="og:description" content="

はじめに

家の電力メーターがスマートメーターに変わりました。
Bルートなるサービスで、瞬間電力量が取得できるらしいです。

Wi-SUNとECHONET Liteとかいう聞いたことなかったプロトコルを扱う必要がありますが、
C、..."><meta content="https://qiita.com/HiroyukiSakoh/items/a93a76db89a9d6b80108" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,RaspberryPi,.NETCore,ECHONET" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-f5c39e3e-8da4-4fd7-8454-9c66e0828db3"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FHiroyukiSakoh%2Fitems%2Fa93a76db89a9d6b80108">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FHiroyukiSakoh%2Fitems%2Fa93a76db89a9d6b80108">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-f5c39e3e-8da4-4fd7-8454-9c66e0828db3">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-11-27T23:48:46.000+09:00","dateModified":"2018-11-27T23:48:46.000+09:00","headline":".NET Core2.1でスマートメーターと戯れる Part1","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1MazVGVkNCRGIzSmxNaTR4NDRHbjQ0SzU0NE9lNDRPODQ0T0k0NE9oNDRPODQ0S180NE84NDRHbzVvaXY0NEtNNDRLTElGQmhjblF4JnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWM4ZDEwNzJlYzQyZjg1Y2Q4YjFjYjg1Yjg2ZGM3Zjkz\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRWhwY205NWRXdHBVMkZyYjJnJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZGMyNzg5YmE3MzAwZmJjMjk5NDcxNDNhYTJkMDUxNWU\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=e93729ee97f771fb2c5f48d12f00d6af","mainEntityOfPage":"https://qiita.com/HiroyukiSakoh/items/a93a76db89a9d6b80108","author":{"@type":"Person","address":"Nagoya, Japan","email":null,"identifier":"HiroyukiSakoh","name":"HiroyukiSakoh","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F260166%2Fprofile-images%2F1528494638?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13d50dba0601ecf78dddde89d4000e1c","url":"https://qiita.com/HiroyukiSakoh","description":"Hi!","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"HiroyukiSakoh","type":"items","id":"a93a76db89a9d6b80108"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"HiroyukiSakoh","type":"items","id":"a93a76db89a9d6b80108"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_1","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"HiroyukiSakoh","type":"items","id":"a93a76db89a9d6b80108"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":2,"pos_id":"header_text_message_2","message":"【9/9(木)開催】Qiitaの過去と未来についてお話しします！Qiita エンジニアフェスタ 2021 Online Meetup","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/HiroyukiSakoh/items/a93a76db89a9d6b80108","location":"/HiroyukiSakoh/items/a93a76db89a9d6b80108","scheme":"https","host":"qiita.com","port":null,"pathname":"/HiroyukiSakoh/items/a93a76db89a9d6b80108","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"erOu9hYDMarIRPz7S6pVB8Kped296EKGtqglWXo8K8kkrL6pOTb8MdLqi3Jc+OdX6x+t7OiAfmFUVKWh15aIig==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-7c709019-4127-48be-b442-315db2dd0b0c"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/likers" class="css-1iupg5d">6</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">9</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/a93a76db89a9d6b80108/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/HiroyukiSakoh"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/260166/profile-images/1528494638" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/HiroyukiSakoh" class="css-10ougpm">@<!-- -->HiroyukiSakoh</a><div class="css-1ay9vb9"><time dateTime="2018-11-27T14:48:46Z" class="css-m19uds">posted at 2018-11-27</time></div></div></div></div></div><h1 class="css-cgzq40">.NET Core2.1でスマートメーターと戯れる Part1</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/raspberrypi" class="css-4czcte">RaspberryPi</a><a href="/tags/.netcore" class="css-4czcte">.NETCore</a><a href="/tags/echonet" class="css-4czcte">ECHONET</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>家の電力メーターがスマートメーターに変わりました。<br>
Bルートなるサービスで、瞬間電力量が取得できるらしいです。</p>

<p>Wi-SUNとECHONET Liteとかいう聞いたことなかったプロトコルを扱う必要がありますが、<br>
C、Java、NodeあたりのSDKしか見つかりませんでした。</p>

<p>今回 .NET Coreで各プロトコルスタックをライブラリ化し、実装/公開しました。</p>

<h1>
<span id="前提知識" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E7%9F%A5%E8%AD%98"><i class="fa fa-link"></i></a>前提知識</h1>

<h2>
<span id="bルートとは" class="fragment"></span><a href="#b%E3%83%AB%E3%83%BC%E3%83%88%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>Bルートとは</h2>

<ul>
<li>スマートメーターが計量したデータを送るルートの種類

<ul>
<li>Aルートは電力会社（送配電事業者）</li>
<li>Bルートは家庭（HEMS）</li>
</ul>
</li>
<li>電力会社へ申し込みが必要。以下が詳しい

<ul>
<li><a href="http://route-b.iij.ad.jp/archives/157" rel="nofollow noopener" target="_blank">Bルートを利用するまでの流れについて</a></li>
</ul>
</li>
</ul>

<h2>
<span id="wi-sunとは" class="fragment"></span><a href="#wi-sun%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>Wi-SUNとは</h2>

<h3>
<span id="規格" class="fragment"></span><a href="#%E8%A6%8F%E6%A0%BC"><i class="fa fa-link"></i></a>規格</h3>

<ul>
<li>特定小電力無線と呼ばれる920MHz帯の無線通信規格</li>
<li>
<p>IEEE 802.15.4g/eとして規格化されている。以下が詳しい</p>

<ul>
<li><a href="http://iot-jp.com/iotsummary/iotstandard/iot%E8%A6%8F%E6%A0%BC%E3%80%80wi-sun-han%E3%81%A8%E3%81%AF%EF%BC%9F/.html" rel="nofollow noopener" target="_blank">IOT規格　Wi-SUN HANとは？</a></li>
<li><a href="http://iot-jp.com/iotsummary/iotstandard/iot%E8%A6%8F%E6%A0%BC%E3%80%80wi-sun-profile-for-echonet-lite%E3%81%A8%E3%81%AF%EF%BC%9F/.html" rel="nofollow noopener" target="_blank">IoT規格　Wi-SUN Profile for ECHONET Liteとは？</a></li>
</ul>
</li>
</ul>

<h3>
<span id="ドングル" class="fragment"></span><a href="#%E3%83%89%E3%83%B3%E3%82%B0%E3%83%AB"><i class="fa fa-link"></i></a>ドングル</h3>

<ul>
<li>以下のようなUSB接続タイプのドングルが販売されています

<ul>
<li>
<a href="https://www.rohm.co.jp/products/wireless-communication/specified-low-power-radio-modules/information" rel="nofollow noopener" target="_blank">ローム BP35C2</a> ￥20,000 → Bルート/HAN デュアルスタック</li>
<li>
<a href="https://www.tessera.co.jp/rl7023stick-d_ips.html" rel="nofollow noopener" target="_blank">テセラ・テクノロジー RL7023 Stick-D/DSS</a> ￥15,000 →Bルート/HAN デュアルスタック</li>
<li>
<a href="https://www2.satori.co.jp/wireless/products_solutions/920mhz/920mhz02/6lowpan_howto.html" rel="nofollow noopener" target="_blank">佐鳥電機 LPR9202 03-U1</a> ￥14,000 →Bルートのみ</li>
<li>JORJIN WSR35A1-00 →Bルートのみ</li>
<li>
<a href="https://www.tessera.co.jp/rl7023stick-d_ips.html" rel="nofollow noopener" target="_blank">テセラ・テクノロジー RL7023 Stick-D/IPS</a> ￥8,000 →Bルートのみ</li>
<li>
<a href="https://web116.jp/shop/netki/miruene_usb/miruene_usb_00.html" rel="nofollow noopener" target="_blank">フレッツ・ミルエネ UDG-1-WSNE</a> ￥5,000 →Bルート/HAN デュアルスタック？(フレッツ・ミルエネの契約が必要)
## SK STACK IP</li>
</ul>
</li>
<li><a href="http://www.skyley.com/products/skstack_ip.html" class="autolink" rel="nofollow noopener" target="_blank">http://www.skyley.com/products/skstack_ip.html</a></li>
<li>Wi-SUN Profile for ECHONET Lite（TTC JJ-300.10 A方式）のリファレンス実装（らしい）</li>
<li>上記ドングルはたいていこのコマンド内臓している（ぽい）</li>
<li>デュアルスタック系と、Bルートのみでコマンド体系が若干異なる（らしい）ので注意</li>
<li>SKSTACKを実装したデバイスをJavaで扱うためのライブラリが公開されています

<ul>
<li>
<a href="https://github.com/SkyleyNetworks/SKSTACK_API" rel="nofollow noopener" target="_blank">GitHub SkyleyNetworks/SKSTACK_API</a>/<a href="http://www.skyley.com/wiki/index.php?SKSTACK%20API%20for%20Java" rel="nofollow noopener" target="_blank">Wiki</a>
</li>
</ul>
</li>
<li>ドングル買わないとコマンドリファレンスは見れないぽい。

<ul>
<li><del><code>BP35A1 コマンドリファレンスマニュアル</code>でぐぐるといいよ</del></li>
</ul>
</li>
</ul>

<h2>
<span id="echonet-liteとは" class="fragment"></span><a href="#echonet-lite%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>ECHONET Liteとは</h2>

<ul>
<li>
<a href="https://ja.wikipedia.org/wiki/ECHONET_Lite" rel="nofollow noopener" target="_blank">Wikipedia</a>によると、<code>エコーネットコンソーシアムが策定した通信プロトコル</code>で、<code>スマートハウス向け制御プロトコルおよびセンサーネットプロトコル</code>らしい。</li>
<li>OSI参照モデル的には、5~7が仕様上定義されていて、4以下は仕様がない。</li>
<li>以下のオープンソース実装がある

<ul>
<li>
<a href="https://github.com/SonyCSL/OpenECHO" rel="nofollow noopener" target="_blank">OpenECHO</a> Java実装 GPL3</li>
<li>
<a href="https://www.toppers.jp/ecnl.html" rel="nofollow noopener" target="_blank">TOPPERS/ECNL</a> C実装？ BSD？</li>
<li>
<a href="http://sh-center.org/sdk" rel="nofollow noopener" target="_blank">HEMS（EchonetLite)認証支援センターのSDKとか</a> Node実装 MIT?</li>
<li>
<a href="https://github.com/Hiroshi-Sugimura/ELSwift" rel="nofollow noopener" target="_blank">ELSwift</a> Swift実装 MIT</li>
</ul>
</li>
</ul>

<h3>
<span id="echonet-lite-通信ミドルウェア仕様" class="fragment"></span><a href="#echonet-lite-%E9%80%9A%E4%BF%A1%E3%83%9F%E3%83%89%E3%83%AB%E3%82%A6%E3%82%A7%E3%82%A2%E4%BB%95%E6%A7%98"><i class="fa fa-link"></i></a>ECHONET Lite 通信ミドルウェア仕様</h3>

<ul>
<li>
<a href="https://echonet.jp/spec_v113_lite/" rel="nofollow noopener" target="_blank">ECHONET Lite規格書</a> 第2部 ECHONET Lite 通信ミドルウェア仕様にて規定</li>
<li>フレームフォーマット(電文構成)、オブジェクト操作のシーケンスを規定している</li>
<li>ざっくりいうと、オブジェクトインスタンスがあって、そのプロパティをGET/SETもしくはANNOUCEする</li>
</ul>

<h3>
<span id="echonet機器オブジェクト" class="fragment"></span><a href="#echonet%E6%A9%9F%E5%99%A8%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88"><i class="fa fa-link"></i></a>ECHONET機器オブジェクト</h3>

<ul>
<li>具体的な機器のこと。</li>
<li>クラスグループ

<ul>
<li>機器クラスのグルーピング。１バイトのコードがグループに割り当てられており、以下のような分類となっている。</li>
<li>センサ関連機器、住宅設備関連機器(0x02)、健康関連機器、空調関連機器、管理操作関連機器、調理家事関連機器、ＡＶ関連機器</li>
</ul>
</li>
<li>
<p>クラス</p>

<ul>
<li>具体的な機器の種類、全体で200強のクラスがある。1バイトのコードがクラスに割り当てられている。</li>
<li>例えば、低圧スマート電力量メータは0x88（住宅設備関連機器(0x02)）</li>
</ul>
</li>
<li><p><a href="https://echonet.jp/spec_object_rk/" rel="nofollow noopener" target="_blank">APPENDIX ECHONET機器オブジェクト詳細規定</a></p></li>
<li>
<p>550ページ以上あるPDFファイル</p>

<ul>
<li><del>公式データソースがPDFだけとか、普及させる気がないと思う。</del></li>
</ul>
</li>
</ul>

<h1>
<span id="本編" class="fragment"></span><a href="#%E6%9C%AC%E7%B7%A8"><i class="fa fa-link"></i></a>本編</h1>

<p>さて、前提知識はこのあたりにして、本題です</p>

<p>今回やりたいことは<code>スマートメーターから瞬間電力量を取りたい</code></p>

<p>そのためには、Wi-SUNドングルを使って、SK STACK IPコマンドをたたき、<br>
スマートメーターの認証を通して、ECHONETLiteフレームのやり取りを行う必要があります。</p>

<h2>
<span id="プロトコルつくったもの-全体像" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%E3%81%A4%E3%81%8F%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE-%E5%85%A8%E4%BD%93%E5%83%8F"><i class="fa fa-link"></i></a>プロトコル/つくったもの 全体像</h2>

<p><a href="https://camo.qiitausercontent.com/adb125b3cc28b63cd4cf8d73dce80e24c855c69b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3236303136362f31323631303061622d353436372d396630332d386438382d6431613038653036663564322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F260166%2F126100ab-5467-9f03-8d88-d1a08e06f5d2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a65927351cfd0357a919dad12e87cdfa" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/260166/126100ab-5467-9f03-8d88-d1a08e06f5d2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F260166%2F126100ab-5467-9f03-8d88-d1a08e06f5d2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=73d0d12d48ceb6066036c49576a8409c 1x" loading="lazy"></a></p>

<h2>
<span id="sk-stack-ip15層" class="fragment"></span><a href="#sk-stack-ip15%E5%B1%A4"><i class="fa fa-link"></i></a>SK STACK IP(1～5層)</h2>

<p>SK STACK IPはコマンド/レスポンス+イベント形式のプロトコルです。<br>
USBドングルはOSからは、シリアル通信用のポートとして認識されます。<br>
ですので、すべての通信はシリアルポート経由となります。</p>

<h3>
<span id="シリアル通信" class="fragment"></span><a href="#%E3%82%B7%E3%83%AA%E3%82%A2%E3%83%AB%E9%80%9A%E4%BF%A1"><i class="fa fa-link"></i></a>シリアル通信</h3>

<p>.NET Core 2.1を使用するため、.NET Core 2.1では、Windowsしかシリアル通信ができません。<br>
最終的にラズパイ上でも動作させたいため、今回はLinuxにも対応している<a href="https://github.com/jcurl/SerialPortStream" rel="nofollow noopener" target="_blank">SerialPortStream</a>を使用します。</p>

<ul>
<li>Linux上で動作させる場合

<ul>
<li>
<a href="https://github.com/jcurl/SerialPortStream#linux" rel="nofollow noopener" target="_blank">こちら</a>に記載の通り、サポート・ライブラリー<code>libnserial.so</code>をコンパイルする必要があります</li>
<li>また、libnserial.so.1.1をlibnserial.so.1にリネームして、アセンブリ<code>SkstackIpDotNet.dll</code>と同じフォルダに配置する必要があります<a href="https://github.com/dotnet/core/issues/740" rel="nofollow noopener" target="_blank">このへん?</a>
</li>
</ul>
</li>
</ul>

<h3>
<span id="出来上がったもの" class="fragment"></span><a href="#%E5%87%BA%E6%9D%A5%E4%B8%8A%E3%81%8C%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE"><i class="fa fa-link"></i></a>出来上がったもの</h3>

<p>SKSTACK-IPのAPIラッパーライブラリを作成しました。</p>

<p>RL7023 Stick-D/IPSに付属のコマンドリファレンスマニュアルをもとに全コマンドを実装しています。<br>
GitHubにて公開しています。<br>
→<a href="https://github.com/HiroyukiSakoh/EchoDotNetLite/tree/master/SkstackIpDotNet" rel="nofollow noopener" target="_blank">SkstackIpDotNet</a></p>

<h3>
<span id="使い方ざっくり" class="fragment"></span><a href="#%E4%BD%BF%E3%81%84%E6%96%B9%E3%81%96%E3%81%A3%E3%81%8F%E3%82%8A"><i class="fa fa-link"></i></a>使い方ざっくり</h3>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">抜粋</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//Windows</span>
<span class="kt">string</span> <span class="n">devicePort</span> <span class="p">=</span> <span class="s">"COM3"</span><span class="p">;</span>
<span class="c1">//こんな分岐でいいのだろうか(不安) そもそも ポートってどう選択すべき…？</span>
<span class="k">if</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Environment</span><span class="p">.</span><span class="n">OSVersion</span><span class="p">.</span><span class="n">Platform</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">!=</span> <span class="s">"Win32NT"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//Linux等(Raspbian Stretchで動作確認)</span>
    <span class="n">devicePort</span> <span class="p">=</span> <span class="s">"/dev/ttyUSB0"</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//SKDeviceクラスをインスタンス化します</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">skdevice</span> <span class="p">=</span> <span class="n">serviceProvider</span><span class="p">.</span><span class="n">GetService</span><span class="p">&lt;</span><span class="n">SKDevice</span><span class="p">&gt;())</span>
<span class="p">{</span>
    <span class="c1">//シリアル通信を開く</span>
    <span class="n">skdevice</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="n">devicePort</span><span class="p">,</span> <span class="m">115200</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">Parity</span><span class="p">.</span><span class="n">None</span><span class="p">,</span> <span class="n">StopBits</span><span class="p">.</span><span class="n">One</span><span class="p">);</span>
    <span class="c1">//EVENTのイベントハンドラを登録</span>
    <span class="n">skdevice</span><span class="p">.</span><span class="n">OnEVENTReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">LogDebug</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
    <span class="p">};</span>
    <span class="c1">//ERXUDP(UDP受信)のイベントハンドラを登録</span>
    <span class="n">skdevice</span><span class="p">.</span><span class="n">OnERXUDPReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">LogDebug</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
    <span class="p">};</span>

    <span class="c1">//各種コマンドはSKDeviceクラスにメソッドとして実装</span>
    <span class="kt">var</span> <span class="n">eInfo</span> <span class="p">=</span> <span class="k">await</span> <span class="n">skDevice</span><span class="p">.</span><span class="nf">SKInfoAsync</span><span class="p">();</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">LogInformation</span><span class="p">(</span><span class="n">eInfo</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>

    <span class="kt">var</span> <span class="n">eVer</span> <span class="p">=</span> <span class="k">await</span> <span class="n">skDevice</span><span class="p">.</span><span class="nf">SKVerAsync</span><span class="p">();</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">LogInformation</span><span class="p">(</span><span class="n">eVer</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>詳細は以下<br>
→<a href="https://github.com/HiroyukiSakoh/EchoDotNetLite/tree/master/SkstackIpDotNet/SkstackIpDotNet.Example" rel="nofollow noopener" target="_blank">SkstackIpDotNet.Example</a><br>
→<a href="https://github.com/HiroyukiSakoh/EchoDotNetLite/tree/master/EchoDotNetLiteSkstackIpBridge" rel="nofollow noopener" target="_blank">EchoDotNetLiteSkstackIpBridge</a></p>

<h3>
<span id="ハマったポイント" class="fragment"></span><a href="#%E3%83%8F%E3%83%9E%E3%81%A3%E3%81%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88"><i class="fa fa-link"></i></a>ハマったポイント</h3>

<p>UDP受信＝ERXUDPイベントのペイロードは16進数文字列なのに、<br>
UDP送信＝SKSENDTOコマンドのペイロードはバイナリっていう。<br>
コマンドリファレンス上は両方ともCHAR[]なのに…</p>

<h3>
<span id="skコマンド" class="fragment"></span><a href="#sk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89"><i class="fa fa-link"></i></a>SKコマンド</h3>

<p>Bルートで必要となるSKコマンドはそこまで多くありません。</p>

<table>
<thead>
<tr>
<th style="text-align: left">コマンド</th>
<th style="text-align: left">説明</th>
<th style="text-align: left">用途</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">SKINFO</td>
<td style="text-align: left">ドングルの通信設定値を取得するコマンド<br>レスポンスはEINFO</td>
<td style="text-align: left">リンクローカルアドレスを取得し、<br>自ノードの識別に使用する</td>
</tr>
<tr>
<td style="text-align: left">SKSETPWD</td>
<td style="text-align: left">パスワードを設定するコマンド</td>
<td style="text-align: left">Bルートのパスワードを設定する</td>
</tr>
<tr>
<td style="text-align: left">SKSETRBID</td>
<td style="text-align: left">RouteBIDを設定するコマンド<br>PairingID（SAレジスタ）に値が設定される<br>（スキャン時の応答が該当メーターのみに絞られる？）</td>
<td style="text-align: left">BルートのIDを設定する</td>
</tr>
<tr>
<td style="text-align: left">SKSCAN</td>
<td style="text-align: left">PANをスキャンするコマンド。</td>
<td style="text-align: left">メーターをスキャンする</td>
</tr>
<tr>
<td style="text-align: left">SKSREG</td>
<td style="text-align: left">レジスタに値を設定するコマンド</td>
<td style="text-align: left">スキャンの結果から、S02(自端末が使用する周波数の論理チャンネル番号)、<br>S03(自端末の PAN ID）を設定する</td>
</tr>
<tr>
<td style="text-align: left">SKLL64</td>
<td style="text-align: left">64 ビット MAC アドレスを IPv6 リンクローカルアドレスに変換するコマンド</td>
<td style="text-align: left">スキャンの結果から、メーターのIPv6アドレスを取得する</td>
</tr>
<tr>
<td style="text-align: left">SKJOIN</td>
<td style="text-align: left">PANA 認証クライアントとして、PANA接続シーケンスを行う<br>接続結果はイベント(EVENT)で通知される。</td>
<td style="text-align: left">メーターへの接続、認証を行う</td>
</tr>
<tr>
<td style="text-align: left">SKSENDTO</td>
<td style="text-align: left">UDPでデータを送信するコマンド</td>
<td style="text-align: left">ECHONETLiteフレームの送信を行う</td>
</tr>
<tr>
<td style="text-align: left">ERXUDP</td>
<td style="text-align: left">コマンドではなく、イベント<br>UDP(マルチキャストも含む)を受信すると通知される</td>
<td style="text-align: left">ECHONETLiteフレームの受信を行う</td>
</tr>
</tbody>
</table>

<h3>
<span id="メーターとの接続完了までのコマンドシーケンスの例" class="fragment"></span><a href="#%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%A8%E3%81%AE%E6%8E%A5%E7%B6%9A%E5%AE%8C%E4%BA%86%E3%81%BE%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%B7%E3%83%BC%E3%82%B1%E3%83%B3%E3%82%B9%E3%81%AE%E4%BE%8B"><i class="fa fa-link"></i></a>メーターとの接続完了までのコマンド/シーケンスの例</h3>

<p><details><summary>通信シーケンス</summary><div>

<div class="code-frame" data-lang="powershell"><div class="highlight"><pre class="with-code"><code><span class="c">#自ノードIPv6アドレスの取得</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKINFO</span><span class="w">
</span><span class="nx">SKINFO</span><span class="w">
</span><span class="n">EINFO</span><span class="w"> </span><span class="p">[</span><span class="err">自ノード</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">100723FFFEA07461</span><span class="w"> </span><span class="nx">3B</span><span class="w"> </span><span class="nx">1094</span><span class="w"> </span><span class="nx">FFFE</span><span class="w">
</span><span class="n">OK</span><span class="w">
</span><span class="c">#パスワードの設定</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKSETPWD</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="nx">XXXXXXXXXXXX</span><span class="w">
</span><span class="n">SKSETPWD</span><span class="w"> </span><span class="nx">C</span><span class="w"> </span><span class="nx">XXXXXXXXXXXX</span><span class="w">
</span><span class="n">OK</span><span class="w">
</span><span class="c">#IDの設定</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKSETRBID</span><span class="w"> </span><span class="nx">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="w">
</span><span class="n">SKSETRBID</span><span class="w"> </span><span class="nx">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="w">
</span><span class="n">OK</span><span class="w">
</span><span class="c">#スキャン開始</span><span class="w">
</span><span class="c">#スキャン時間:4</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKSCAN</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="nx">FFFFFFFF</span><span class="w"> </span><span class="nx">4</span><span class="w">
</span><span class="n">SKSCAN</span><span class="w"> </span><span class="nx">2</span><span class="w"> </span><span class="nx">FFFFFFFF</span><span class="w"> </span><span class="nx">4</span><span class="w">
</span><span class="n">OK</span><span class="w">
</span><span class="nx">EVENT</span><span class="w"> </span><span class="nx">20</span><span class="w"> </span><span class="p">[</span><span class="err">自ノード</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="n">EPANDESC</span><span class="w">
  </span><span class="nx">Channel:3B</span><span class="w">
  </span><span class="n">Channel</span><span class="w"> </span><span class="nx">Page:09</span><span class="w">
  </span><span class="n">Pan</span><span class="w"> </span><span class="nx">ID:1094</span><span class="w">
  </span><span class="n">Addr:</span><span class="p">[</span><span class="err">メーター</span><span class="n">MAC</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
  </span><span class="n">LQI:1D</span><span class="w">
  </span><span class="nx">PairID:005B23E3</span><span class="w">
</span><span class="n">EVENT</span><span class="w"> </span><span class="nx">22</span><span class="w"> </span><span class="p">[</span><span class="err">自ノード</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="c">#PAN発見: 論理チャンネル番号:3B,チャンネルページ:09,PAN ID:1094,アドレス:[メーターMACアドレス],RSSI:1D,PairingID:005B23E3</span><span class="w">
</span><span class="c">#S02(自端末が使用する周波数の論理チャンネル番号)設定</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKSREG</span><span class="w"> </span><span class="nx">S2</span><span class="w"> </span><span class="nx">3B</span><span class="w">
</span><span class="n">SKSREG</span><span class="w"> </span><span class="nx">S2</span><span class="w"> </span><span class="nx">3B</span><span class="w">
</span><span class="n">OK</span><span class="w">
</span><span class="c">#S03(自端末の PAN ID）設定</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKSREG</span><span class="w"> </span><span class="nx">S3</span><span class="w"> </span><span class="nx">1094</span><span class="w">
</span><span class="n">SKSREG</span><span class="w"> </span><span class="nx">S3</span><span class="w"> </span><span class="nx">1094</span><span class="w">
</span><span class="n">OK</span><span class="w">
</span><span class="c">#メーターのIPv6アドレスを取得</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKLL64</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">MAC</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="n">SKLL64</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">MAC</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="c">#PANA接続シーケンス開始</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">SKJOIN</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="n">SKJOIN</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="n">OK</span><span class="w">
</span><span class="nx">EVENT</span><span class="w"> </span><span class="nx">21</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">02</span><span class="w">
</span><span class="n">EVENT</span><span class="w"> </span><span class="nx">02</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span><span class="c"># 鍵交換など(SKJOINのコマンドで勝手に行われる)</span><span class="w">
</span><span class="n">ERXUDP</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="err">自ノード</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">MAC</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">0028</span><span class="w"> </span><span class="nx">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="w">
</span><span class="n">EVENT</span><span class="w"> </span><span class="nx">21</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">00</span><span class="w">
</span><span class="n">ERXUDP</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="err">自ノード</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">MAC</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">0068</span><span class="w"> </span><span class="nx">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="w">
</span><span class="n">EVENT</span><span class="w"> </span><span class="nx">21</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">00</span><span class="w">
</span><span class="n">ERXUDP</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="err">自ノード</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">MAC</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">0054</span><span class="w"> </span><span class="nx">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="w">
</span><span class="n">EVENT</span><span class="w"> </span><span class="nx">21</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">00</span><span class="w">
</span><span class="n">ERXUDP</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="err">自ノード</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="nx">02CC</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">MAC</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">0058</span><span class="w"> </span><span class="nx">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="w">
</span><span class="n">EVENT</span><span class="w"> </span><span class="nx">21</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w"> </span><span class="nx">00</span><span class="w">
</span><span class="c">#EVENT ID＝0x25:PANA による接続が完了</span><span class="w">
</span><span class="n">EVENT</span><span class="w"> </span><span class="nx">25</span><span class="w"> </span><span class="p">[</span><span class="err">メーター</span><span class="n">IPv6</span><span class="err">アドレス</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p></p>
</div></details></p>

<h1>
<span id="echonet-lite67層" class="fragment"></span><a href="#echonet-lite67%E5%B1%A4"><i class="fa fa-link"></i></a>ECHONET Lite(6～7層)</h1>

<p>長くなったので次回に続きます</p>

<h1>
<span id="動作確認環境" class="fragment"></span><a href="#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>動作確認環境</h1>

<ul>
<li>OS:Windows10/Raspbian Stretch</li>
<li>ミドルウェア:.NET Core 2.1 Runtime v2.1.6</li>
<li>Wi-SUNモジュール： <a href="https://www.tessera.co.jp/rl7023stick-d_ips.html" rel="nofollow noopener" target="_blank">RL7023 Stick-D/IPS</a>
</li>
<li>低圧スマート電力量メータ:中部電力管内(2機)</li>
</ul>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<ul>
<li><a href="https://qiita.com/rukihena/items/82266ed3a43e4b652adb" id="reference-0f011c30beb2fb07330a">スマートメーターの情報を最安ハードウェアで引っこ抜く</a></li>
<li><a href="http://route-b.iij.ad.jp/archives/128" rel="nofollow noopener" target="_blank">スマートメーターとECHONET Liteで通信できるようになるまで</a></li>
<li><a href="http://www.meti.go.jp/committee/kenkyukai/shoujo/smart_house/pdf/009_s03_00.pdf" rel="nofollow noopener" target="_blank">HEMS-スマートメーターBルート(低圧電力メーター)運用ガイドライン第4.0版</a></li>
<li><a href="https://echonet.jp/spec_g/" rel="nofollow noopener" target="_blank">エコーネット規格　（一般公開）</a></li>
<li><a href="https://github.com/SonyCSL/MoekadenRoom/blob/master/README.jp.md" rel="nofollow noopener" target="_blank">MoekadenRoom (機器オブジェクトエミュレーター)</a></li>
<li><a href="https://github.com/SkyleyNetworks/SKSTACK_API" rel="nofollow noopener" target="_blank">GitHub SkyleyNetworks/SKSTACK_API</a></li>
<li><a href="https://github.com/SonyCSL/OpenECHO" rel="nofollow noopener" target="_blank">OpenECHO (ECHONET Liteのjava実装)</a></li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FHiroyukiSakoh%2Fitems%2Fa93a76db89a9d6b80108&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FHiroyukiSakoh%2Fitems%2Fa93a76db89a9d6b80108&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/likers" class="css-1iupg5d">6</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">9</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/a93a76db89a9d6b80108/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/HiroyukiSakoh/items/a93a76db89a9d6b80108.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-7c709019-4127-48be-b442-315db2dd0b0c">{"authorAnalyticsTrackingId":"UA-137730942-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-2123d839-ea14-48f9-ba80-dfafb9d4d08b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-2123d839-ea14-48f9-ba80-dfafb9d4d08b">{}</script>
      
<div id="LoginModal-react-component-f89ad02d-a9f9-4418-98eb-b5a48f4e1e76"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-f89ad02d-a9f9-4418-98eb-b5a48f4e1e76">{}</script>
      
<div id="StockModal-react-component-cdd763dc-c18c-4268-a339-aae622b5fe89"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-cdd763dc-c18c-4268-a339-aae622b5fe89">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;i6/bUHOSaHgl0zp5SQGxIXA5aP8MhRwIEnqmKIpJUVXVsMsPXKel4z99TfBeUwNxWY+8zlntIO/whibQJ+PyFg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003e家の電力メーターがスマートメーターに変わりました。\u003cbr\u003e\nBルートなるサービスで、瞬間電力量が取得できるらしいです。\u003c/p\u003e\n\n\u003cp\u003eWi-SUNとECHONET Liteとかいう聞いたことなかったプロトコルを扱う必要がありますが、\u003cbr\u003e\nC、Java、NodeあたりのSDKしか見つかりませんでした。\u003c/p\u003e\n\n\u003cp\u003e今回 .NET Coreで各プロトコルスタックをライブラリ化し、実装/公開しました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前提知識\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90%E7%9F%A5%E8%AD%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提知識\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"bルートとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#b%E3%83%AB%E3%83%BC%E3%83%88%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eBルートとは\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eスマートメーターが計量したデータを送るルートの種類\n\n\u003cul\u003e\n\u003cli\u003eAルートは電力会社（送配電事業者）\u003c/li\u003e\n\u003cli\u003eBルートは家庭（HEMS）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e電力会社へ申し込みが必要。以下が詳しい\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://route-b.iij.ad.jp/archives/157\" rel=\"nofollow noopener\" target=\"_blank\"\u003eBルートを利用するまでの流れについて\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"wi-sunとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#wi-sun%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWi-SUNとは\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"規格\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A6%8F%E6%A0%BC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e規格\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e特定小電力無線と呼ばれる920MHz帯の無線通信規格\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIEEE 802.15.4g/eとして規格化されている。以下が詳しい\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://iot-jp.com/iotsummary/iotstandard/iot%E8%A6%8F%E6%A0%BC%E3%80%80wi-sun-han%E3%81%A8%E3%81%AF%EF%BC%9F/.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eIOT規格　Wi-SUN HANとは？\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://iot-jp.com/iotsummary/iotstandard/iot%E8%A6%8F%E6%A0%BC%E3%80%80wi-sun-profile-for-echonet-lite%E3%81%A8%E3%81%AF%EF%BC%9F/.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eIoT規格　Wi-SUN Profile for ECHONET Liteとは？\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ドングル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%89%E3%83%B3%E3%82%B0%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eドングル\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e以下のようなUSB接続タイプのドングルが販売されています\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://www.rohm.co.jp/products/wireless-communication/specified-low-power-radio-modules/information\" rel=\"nofollow noopener\" target=\"_blank\"\u003eローム BP35C2\u003c/a\u003e ￥20,000 → Bルート/HAN デュアルスタック\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://www.tessera.co.jp/rl7023stick-d_ips.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eテセラ・テクノロジー RL7023 Stick-D/DSS\u003c/a\u003e ￥15,000 →Bルート/HAN デュアルスタック\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://www2.satori.co.jp/wireless/products_solutions/920mhz/920mhz02/6lowpan_howto.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e佐鳥電機 LPR9202 03-U1\u003c/a\u003e ￥14,000 →Bルートのみ\u003c/li\u003e\n\u003cli\u003eJORJIN WSR35A1-00 →Bルートのみ\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://www.tessera.co.jp/rl7023stick-d_ips.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eテセラ・テクノロジー RL7023 Stick-D/IPS\u003c/a\u003e ￥8,000 →Bルートのみ\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://web116.jp/shop/netki/miruene_usb/miruene_usb_00.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eフレッツ・ミルエネ UDG-1-WSNE\u003c/a\u003e ￥5,000 →Bルート/HAN デュアルスタック？(フレッツ・ミルエネの契約が必要)\n## SK STACK IP\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.skyley.com/products/skstack_ip.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://www.skyley.com/products/skstack_ip.html\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eWi-SUN Profile for ECHONET Lite（TTC JJ-300.10 A方式）のリファレンス実装（らしい）\u003c/li\u003e\n\u003cli\u003e上記ドングルはたいていこのコマンド内臓している（ぽい）\u003c/li\u003e\n\u003cli\u003eデュアルスタック系と、Bルートのみでコマンド体系が若干異なる（らしい）ので注意\u003c/li\u003e\n\u003cli\u003eSKSTACKを実装したデバイスをJavaで扱うためのライブラリが公開されています\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://github.com/SkyleyNetworks/SKSTACK_API\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGitHub SkyleyNetworks/SKSTACK_API\u003c/a\u003e/\u003ca href=\"http://www.skyley.com/wiki/index.php?SKSTACK%20API%20for%20Java\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWiki\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eドングル買わないとコマンドリファレンスは見れないぽい。\n\n\u003cul\u003e\n\u003cli\u003e\u003cdel\u003e\u003ccode\u003eBP35A1 コマンドリファレンスマニュアル\u003c/code\u003eでぐぐるといいよ\u003c/del\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"echonet-liteとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#echonet-lite%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eECHONET Liteとは\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://ja.wikipedia.org/wiki/ECHONET_Lite\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWikipedia\u003c/a\u003eによると、\u003ccode\u003eエコーネットコンソーシアムが策定した通信プロトコル\u003c/code\u003eで、\u003ccode\u003eスマートハウス向け制御プロトコルおよびセンサーネットプロトコル\u003c/code\u003eらしい。\u003c/li\u003e\n\u003cli\u003eOSI参照モデル的には、5~7が仕様上定義されていて、4以下は仕様がない。\u003c/li\u003e\n\u003cli\u003e以下のオープンソース実装がある\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://github.com/SonyCSL/OpenECHO\" rel=\"nofollow noopener\" target=\"_blank\"\u003eOpenECHO\u003c/a\u003e Java実装 GPL3\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://www.toppers.jp/ecnl.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTOPPERS/ECNL\u003c/a\u003e C実装？ BSD？\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"http://sh-center.org/sdk\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHEMS（EchonetLite)認証支援センターのSDKとか\u003c/a\u003e Node実装 MIT?\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://github.com/Hiroshi-Sugimura/ELSwift\" rel=\"nofollow noopener\" target=\"_blank\"\u003eELSwift\u003c/a\u003e Swift実装 MIT\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"echonet-lite-通信ミドルウェア仕様\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#echonet-lite-%E9%80%9A%E4%BF%A1%E3%83%9F%E3%83%89%E3%83%AB%E3%82%A6%E3%82%A7%E3%82%A2%E4%BB%95%E6%A7%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eECHONET Lite 通信ミドルウェア仕様\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://echonet.jp/spec_v113_lite/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eECHONET Lite規格書\u003c/a\u003e 第2部 ECHONET Lite 通信ミドルウェア仕様にて規定\u003c/li\u003e\n\u003cli\u003eフレームフォーマット(電文構成)、オブジェクト操作のシーケンスを規定している\u003c/li\u003e\n\u003cli\u003eざっくりいうと、オブジェクトインスタンスがあって、そのプロパティをGET/SETもしくはANNOUCEする\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"echonet機器オブジェクト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#echonet%E6%A9%9F%E5%99%A8%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eECHONET機器オブジェクト\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e具体的な機器のこと。\u003c/li\u003e\n\u003cli\u003eクラスグループ\n\n\u003cul\u003e\n\u003cli\u003e機器クラスのグルーピング。１バイトのコードがグループに割り当てられており、以下のような分類となっている。\u003c/li\u003e\n\u003cli\u003eセンサ関連機器、住宅設備関連機器(0x02)、健康関連機器、空調関連機器、管理操作関連機器、調理家事関連機器、ＡＶ関連機器\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eクラス\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e具体的な機器の種類、全体で200強のクラスがある。1バイトのコードがクラスに割り当てられている。\u003c/li\u003e\n\u003cli\u003e例えば、低圧スマート電力量メータは0x88（住宅設備関連機器(0x02)）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca href=\"https://echonet.jp/spec_object_rk/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAPPENDIX ECHONET機器オブジェクト詳細規定\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e550ページ以上あるPDFファイル\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cdel\u003e公式データソースがPDFだけとか、普及させる気がないと思う。\u003c/del\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"本編\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%AC%E7%B7%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e本編\u003c/h1\u003e\n\n\u003cp\u003eさて、前提知識はこのあたりにして、本題です\u003c/p\u003e\n\n\u003cp\u003e今回やりたいことは\u003ccode\u003eスマートメーターから瞬間電力量を取りたい\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eそのためには、Wi-SUNドングルを使って、SK STACK IPコマンドをたたき、\u003cbr\u003e\nスマートメーターの認証を通して、ECHONETLiteフレームのやり取りを行う必要があります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"プロトコルつくったもの-全体像\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%E3%81%A4%E3%81%8F%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE-%E5%85%A8%E4%BD%93%E5%83%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロトコル/つくったもの 全体像\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/adb125b3cc28b63cd4cf8d73dce80e24c855c69b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3236303136362f31323631303061622d353436372d396630332d386438382d6431613038653036663564322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F260166%2F126100ab-5467-9f03-8d88-d1a08e06f5d2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a65927351cfd0357a919dad12e87cdfa\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/260166/126100ab-5467-9f03-8d88-d1a08e06f5d2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F260166%2F126100ab-5467-9f03-8d88-d1a08e06f5d2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=73d0d12d48ceb6066036c49576a8409c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"sk-stack-ip15層\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sk-stack-ip15%E5%B1%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSK STACK IP(1～5層)\u003c/h2\u003e\n\n\u003cp\u003eSK STACK IPはコマンド/レスポンス+イベント形式のプロトコルです。\u003cbr\u003e\nUSBドングルはOSからは、シリアル通信用のポートとして認識されます。\u003cbr\u003e\nですので、すべての通信はシリアルポート経由となります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"シリアル通信\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B7%E3%83%AA%E3%82%A2%E3%83%AB%E9%80%9A%E4%BF%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eシリアル通信\u003c/h3\u003e\n\n\u003cp\u003e.NET Core 2.1を使用するため、.NET Core 2.1では、Windowsしかシリアル通信ができません。\u003cbr\u003e\n最終的にラズパイ上でも動作させたいため、今回はLinuxにも対応している\u003ca href=\"https://github.com/jcurl/SerialPortStream\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSerialPortStream\u003c/a\u003eを使用します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eLinux上で動作させる場合\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"https://github.com/jcurl/SerialPortStream#linux\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eに記載の通り、サポート・ライブラリー\u003ccode\u003elibnserial.so\u003c/code\u003eをコンパイルする必要があります\u003c/li\u003e\n\u003cli\u003eまた、libnserial.so.1.1をlibnserial.so.1にリネームして、アセンブリ\u003ccode\u003eSkstackIpDotNet.dll\u003c/code\u003eと同じフォルダに配置する必要があります\u003ca href=\"https://github.com/dotnet/core/issues/740\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこのへん?\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"出来上がったもの\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%87%BA%E6%9D%A5%E4%B8%8A%E3%81%8C%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e出来上がったもの\u003c/h3\u003e\n\n\u003cp\u003eSKSTACK-IPのAPIラッパーライブラリを作成しました。\u003c/p\u003e\n\n\u003cp\u003eRL7023 Stick-D/IPSに付属のコマンドリファレンスマニュアルをもとに全コマンドを実装しています。\u003cbr\u003e\nGitHubにて公開しています。\u003cbr\u003e\n→\u003ca href=\"https://github.com/HiroyukiSakoh/EchoDotNetLite/tree/master/SkstackIpDotNet\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSkstackIpDotNet\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"使い方ざっくり\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%BF%E3%81%84%E6%96%B9%E3%81%96%E3%81%A3%E3%81%8F%E3%82%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e使い方ざっくり\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e抜粋\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//Windows\u003c/span\u003e\n\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003edevicePort\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"COM3\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//こんな分岐でいいのだろうか(不安) そもそも ポートってどう選択すべき…？\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOSVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePlatform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"Win32NT\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//Linux等(Raspbian Stretchで動作確認)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edevicePort\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/dev/ttyUSB0\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//SKDeviceクラスをインスタンス化します\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eskdevice\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserviceProvider\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetService\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eSKDevice\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;())\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//シリアル通信を開く\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eskdevice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edevicePort\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e115200\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eParity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eStopBits\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOne\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//EVENTのイベントハンドラを登録\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eskdevice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOnEVENTReceived\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//ERXUDP(UDP受信)のイベントハンドラを登録\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eskdevice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOnERXUDPReceived\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//各種コマンドはSKDeviceクラスにメソッドとして実装\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eskDevice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSKInfoAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eeInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeVer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eskDevice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSKVerAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eeVer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e詳細は以下\u003cbr\u003e\n→\u003ca href=\"https://github.com/HiroyukiSakoh/EchoDotNetLite/tree/master/SkstackIpDotNet/SkstackIpDotNet.Example\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSkstackIpDotNet.Example\u003c/a\u003e\u003cbr\u003e\n→\u003ca href=\"https://github.com/HiroyukiSakoh/EchoDotNetLite/tree/master/EchoDotNetLiteSkstackIpBridge\" rel=\"nofollow noopener\" target=\"_blank\"\u003eEchoDotNetLiteSkstackIpBridge\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ハマったポイント\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%8F%E3%83%9E%E3%81%A3%E3%81%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eハマったポイント\u003c/h3\u003e\n\n\u003cp\u003eUDP受信＝ERXUDPイベントのペイロードは16進数文字列なのに、\u003cbr\u003e\nUDP送信＝SKSENDTOコマンドのペイロードはバイナリっていう。\u003cbr\u003e\nコマンドリファレンス上は両方ともCHAR[]なのに…\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"skコマンド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSKコマンド\u003c/h3\u003e\n\n\u003cp\u003eBルートで必要となるSKコマンドはそこまで多くありません。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003eコマンド\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e説明\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e用途\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKINFO\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eドングルの通信設定値を取得するコマンド\u003cbr\u003eレスポンスはEINFO\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eリンクローカルアドレスを取得し、\u003cbr\u003e自ノードの識別に使用する\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKSETPWD\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eパスワードを設定するコマンド\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eBルートのパスワードを設定する\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKSETRBID\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eRouteBIDを設定するコマンド\u003cbr\u003ePairingID（SAレジスタ）に値が設定される\u003cbr\u003e（スキャン時の応答が該当メーターのみに絞られる？）\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eBルートのIDを設定する\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKSCAN\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ePANをスキャンするコマンド。\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eメーターをスキャンする\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKSREG\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eレジスタに値を設定するコマンド\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eスキャンの結果から、S02(自端末が使用する周波数の論理チャンネル番号)、\u003cbr\u003eS03(自端末の PAN ID）を設定する\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKLL64\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e64 ビット MAC アドレスを IPv6 リンクローカルアドレスに変換するコマンド\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eスキャンの結果から、メーターのIPv6アドレスを取得する\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKJOIN\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ePANA 認証クライアントとして、PANA接続シーケンスを行う\u003cbr\u003e接続結果はイベント(EVENT)で通知される。\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eメーターへの接続、認証を行う\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eSKSENDTO\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eUDPでデータを送信するコマンド\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eECHONETLiteフレームの送信を行う\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eERXUDP\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eコマンドではなく、イベント\u003cbr\u003eUDP(マルチキャストも含む)を受信すると通知される\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eECHONETLiteフレームの受信を行う\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メーターとの接続完了までのコマンドシーケンスの例\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%A8%E3%81%AE%E6%8E%A5%E7%B6%9A%E5%AE%8C%E4%BA%86%E3%81%BE%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%B7%E3%83%BC%E3%82%B1%E3%83%B3%E3%82%B9%E3%81%AE%E4%BE%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメーターとの接続完了までのコマンド/シーケンスの例\u003c/h3\u003e\n\n\u003cp\u003e\u003cdetails\u003e\u003csummary\u003e通信シーケンス\u003c/summary\u003e\u003cdiv\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"powershell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e#自ノードIPv6アドレスの取得\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKINFO\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nx\"\u003eSKINFO\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEINFO\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e自ノード\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e100723FFFEA07461\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e3B\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e1094\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eFFFE\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#パスワードの設定\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKSETPWD\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eSKSETPWD\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#IDの設定\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKSETRBID\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eSKSETRBID\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#スキャン開始\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#スキャン時間:4\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKSCAN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eFFFFFFFF\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eSKSCAN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eFFFFFFFF\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nx\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e20\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e自ノード\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEPANDESC\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"nx\"\u003eChannel:3B\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"n\"\u003eChannel\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ePage:09\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"n\"\u003ePan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eID:1094\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"n\"\u003eAddr:\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eMAC\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"n\"\u003eLQI:1D\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"nx\"\u003ePairID:005B23E3\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e22\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e自ノード\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#PAN発見: 論理チャンネル番号:3B,チャンネルページ:09,PAN ID:1094,アドレス:[メーターMACアドレス],RSSI:1D,PairingID:005B23E3\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#S02(自端末が使用する周波数の論理チャンネル番号)設定\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKSREG\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eS2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e3B\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eSKSREG\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eS2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e3B\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#S03(自端末の PAN ID）設定\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKSREG\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eS3\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e1094\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eSKSREG\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eS3\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e1094\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#メーターのIPv6アドレスを取得\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKLL64\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eMAC\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eSKLL64\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eMAC\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#PANA接続シーケンス開始\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSKJOIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eSKJOIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"nx\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e21\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e# 鍵交換など(SKJOINのコマンドで勝手に行われる)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eERXUDP\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e自ノード\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eMAC\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0028\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e21\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e00\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eERXUDP\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e自ノード\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eMAC\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0068\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e21\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e00\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eERXUDP\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e自ノード\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eMAC\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0054\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e21\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e00\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eERXUDP\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e自ノード\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e02CC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eMAC\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e0058\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e21\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e00\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"c\"\u003e#EVENT ID＝0x25:PANA による接続が完了\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"n\"\u003eEVENT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003e25\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003eメーター\u003c/span\u003e\u003cspan class=\"n\"\u003eIPv6\u003c/span\u003e\u003cspan class=\"err\"\u003eアドレス\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/details\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"echonet-lite67層\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#echonet-lite67%E5%B1%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eECHONET Lite(6～7層)\u003c/h1\u003e\n\n\u003cp\u003e長くなったので次回に続きます\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"動作確認環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e動作確認環境\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eOS:Windows10/Raspbian Stretch\u003c/li\u003e\n\u003cli\u003eミドルウェア:.NET Core 2.1 Runtime v2.1.6\u003c/li\u003e\n\u003cli\u003eWi-SUNモジュール： \u003ca href=\"https://www.tessera.co.jp/rl7023stick-d_ips.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRL7023 Stick-D/IPS\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e低圧スマート電力量メータ:中部電力管内(2機)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/rukihena/items/82266ed3a43e4b652adb\" id=\"reference-0f011c30beb2fb07330a\"\u003eスマートメーターの情報を最安ハードウェアで引っこ抜く\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://route-b.iij.ad.jp/archives/128\" rel=\"nofollow noopener\" target=\"_blank\"\u003eスマートメーターとECHONET Liteで通信できるようになるまで\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.meti.go.jp/committee/kenkyukai/shoujo/smart_house/pdf/009_s03_00.pdf\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHEMS-スマートメーターBルート(低圧電力メーター)運用ガイドライン第4.0版\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://echonet.jp/spec_g/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eエコーネット規格　（一般公開）\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/SonyCSL/MoekadenRoom/blob/master/README.jp.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMoekadenRoom (機器オブジェクトエミュレーター)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/SkyleyNetworks/SKSTACK_API\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGitHub SkyleyNetworks/SKSTACK_API\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/SonyCSL/OpenECHO\" rel=\"nofollow noopener\" target=\"_blank\"\u003eOpenECHO (ECHONET Liteのjava実装)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2018-11-27T14:48:46Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"LCMDLTf2r5mCB9rCattQ2DrR9OuTV5b8--VQtWwZXtzNdBplbJ--L36AAzjLHL1qvL4GWUaR+g==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2018-11-27T14:48:46Z","likesCount":6,"linkUrl":"https://qiita.com/HiroyukiSakoh/items/a93a76db89a9d6b80108","organization":null,"originalId":728438,"stockedCount":9,"title":".NET Core2.1でスマートメーターと戯れる Part1","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%89%8D%E6%8F%90%E7%9F%A5%E8%AD%98\"\u003e前提知識\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#b%E3%83%AB%E3%83%BC%E3%83%88%E3%81%A8%E3%81%AF\"\u003eBルートとは\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#wi-sun%E3%81%A8%E3%81%AF\"\u003eWi-SUNとは\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%A6%8F%E6%A0%BC\"\u003e規格\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%89%E3%83%B3%E3%82%B0%E3%83%AB\"\u003eドングル\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#echonet-lite%E3%81%A8%E3%81%AF\"\u003eECHONET Liteとは\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#echonet-lite-%E9%80%9A%E4%BF%A1%E3%83%9F%E3%83%89%E3%83%AB%E3%82%A6%E3%82%A7%E3%82%A2%E4%BB%95%E6%A7%98\"\u003eECHONET Lite 通信ミドルウェア仕様\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#echonet%E6%A9%9F%E5%99%A8%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88\"\u003eECHONET機器オブジェクト\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%AC%E7%B7%A8\"\u003e本編\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%E3%81%A4%E3%81%8F%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE-%E5%85%A8%E4%BD%93%E5%83%8F\"\u003eプロトコル/つくったもの 全体像\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sk-stack-ip15%E5%B1%A4\"\u003eSK STACK IP(1～5層)\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B7%E3%83%AA%E3%82%A2%E3%83%AB%E9%80%9A%E4%BF%A1\"\u003eシリアル通信\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%87%BA%E6%9D%A5%E4%B8%8A%E3%81%8C%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE\"\u003e出来上がったもの\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BD%BF%E3%81%84%E6%96%B9%E3%81%96%E3%81%A3%E3%81%8F%E3%82%8A\"\u003e使い方ざっくり\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%8F%E3%83%9E%E3%81%A3%E3%81%9F%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\"\u003eハマったポイント\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sk%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\"\u003eSKコマンド\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%A8%E3%81%AE%E6%8E%A5%E7%B6%9A%E5%AE%8C%E4%BA%86%E3%81%BE%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%B7%E3%83%BC%E3%82%B1%E3%83%B3%E3%82%B9%E3%81%AE%E4%BE%8B\"\u003eメーターとの接続完了までのコマンド/シーケンスの例\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#echonet-lite67%E5%B1%A4\"\u003eECHONET Lite(6～7層)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D%E7%92%B0%E5%A2%83\"\u003e動作確認環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e参考\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":2836,"uuid":"a93a76db89a9d6b80108","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"/N+b+77l4gl4uQuNl5UN2m8zDD7c--xY6VAA/IeFjYO2G2--stNQ48YSnrGAjU+ZiTRnCQ==","originalId":260166,"description":"Hi!","facebookUrl":null,"githubUrl":"https://github.com/HiroyukiSakoh","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"Hiroyuki Sakoh","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/260166/profile-images/1528494638","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F260166%2Fprofile-images%2F1528494638?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=0dad7c949d3ecfc8b98437ae148c077e","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F260166%2Fprofile-images%2F1528494638?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=13d50dba0601ecf78dddde89d4000e1c","urlName":"HiroyukiSakoh","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"RaspberryPi","urlName":"raspberrypi"},{"name":".NETCore","urlName":".netcore"},{"name":"ECHONET","urlName":"echonet"}],"followingLikers":{"edges":[]},"comments":{"totalCount":3}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
