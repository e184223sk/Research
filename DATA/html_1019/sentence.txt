More than 1 year has passed since last update.初投稿になります。普段はC#er1でガチガチのデスクトップアプリの開発をしていますのですが知見を広めるべくpythonに取り組んでみます。フロントエンド？それ喰えるのか？という世界に生きてますのでPythonは結構新鮮。MMD2にどっぷりな我が娘がファイル形式の変換をいちいち変換サイトにいってファイルをアップロードして・・とやっているのでそんな面倒なことせずとも自分のPCだけで完結するやんという話をしましてコンバータを作ることになりました。
今回はMMDで使うためのMP3→WAV変換になります。「python mp3 wav」でググるとどうやらpydubというライブラリを使えば変換できるらしいので早速導入。えーと、ffmpegが必要？なるほど、ffmpegのラッパー的なライブラリなのか。ffmpegのコマンドを自分でチョイスして書けばいいのだろうけど折角なのでpydubのお世話になることに。拡張子を挿げ替えたいだけなのになんかめんどくさいコードになってしまいました。本質的には・・・だけなんですけどね。
C#erとしてはimport osと書いてるのになぜos.path...と書かねばならないのか疑問。さて、期待通り動くことは確認できましたがこのmp32wav.pyをデスクトップに置いてもD&amp;Dできるわけではないのでバッチファイルを用意します。このバッチファイルのショートカットをデスクトップに作り、変換したい.mp3をD&amp;Dすれば元ファイルと同じフォルダに.wavが生成されます。めでたし。どうやらこれは既知の問題のようですが、全角スペースを含むファイル名を与えるとそこでぶった切られてしまうようです。半角スペースもクォートしてやれば問題ありませんしD&amp;Dの時には勝手にクォートしたものがコマンドライン引数として渡されるようですが全角スペースの場合はうまくやってくれません。
テストコードをC#で書いてみますがさらにこれをバッチファイルから呼び出すようにして"aaa bbb.txt"(半角スペース)と"aaa　bbb.txt"(全角スペース)を喰わせてみるととなります。尤も普通はフォルダ名・ファイル名に全角スペースを使いませんがそういう名前をOSが許容してますし中には半角スペースと全角スペースを全く意識しない人もいるでしょうから何かしらの対処は必要かなと考えています。
娘にはフォルダ名・ファイル名には半角スペースのみ使ってよいと伝え、当面運用で回避です(一応回避案はないこともない・・・)C#が7.5のVB6が2.0のVB.NETが0.5でしょうか。 ↩MikuMikuDance ↩


