More than 3 years have passed since last update.今日も自分の学びに対するメモです。Azure Functions を書いていると必ず出てくる Attributes ですが、カスタムの Attributes を書くときにどんなコードになるのか知りたかったので調べて書いてみました。題材として、被告人がいて、自分がズラかどうかを告白するのですが、Attributes によってそれを見破るプログラムを作ってみました。Attributes の定義は次のようになっていて。単なる普通のクラスです。コンストラクタを書いておくと、クラスやメソッドに対して、Attributes をつけられるようになる様子です。　AttributeUsage でAttribute であることを明確にします。Attribute 名は、Attribute の接尾句を省略したものになるので、ここでは、[GHDetect] という Attribute が使えるようになります。全く同じクラスを定義して、ほぼ同じ結果を返すメソッドを定義した２つのクラスを定義します。片方には、カツラをtrue にし、そのカツラのメーカー名の情報を持たせておきます。一方は、カツラではないということにしておきましょう。クラスの型がわかれば、定義された Attribute が取得できます。ちなみに、メソッドに定義した場合は、リフレクションを使ってメソッドを取得してから、Attributes が取れる様子です。まずは簡単のためクラスのみでやってみます。 MemberInfo を渡すと、Attribute を返すようにしています。ちなみに、Attribute[] を返すようにもできます。（複数のアトリビュートがある場合）。クラスのタイプだったり、MethodInfo を引数として渡すことができます。Attribute が取れれば、これは単なるクラスですので、値を取得してロジックを書きます。これでカツラかどうかを判別できるようになるはずです。では次のメインを書いて実行。めでたしめでたし。


