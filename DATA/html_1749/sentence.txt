More than 1 year has passed since last update.　ControlのLocationメソッド、PointToScreenメソッド、そしてPointToClientメソッドの使い方をまとめる。本記事では、特に下の写真－１のように複数のControl(ここではPanel)が入れ子上になっている状態での、あるコントロールの座標を他のコントロールの座標系で表す方法について重点を置く。
　　　　　　　　　　　　　　　　　　　　　　　写真－１　０．前提条件
　上の写真－１では、フォームの上にpanel1から4までのパネルが計４枚配置されている。それぞれの関係は次のとおり、フォームの上にpanel1(黄色)とpanel4(ライトグリーン）の二枚のパネルが配置され、さらにpanel1の上にpanel2(水色）が一枚配置され、そのpanel2のパネルの上にpanel3(ピング)が一枚配置されている。１．座標系
　この写真－１のスクリーン（モニタ）画面の中には、下の写真－２のように６つの座標系が含まれている。
　　　　　ａ．スクリーン（モニタ）の座標系
　　　　　ｂ．フォーム(this)の座標系
　　　　　ｃ．panel1の座標系
　　　　　ｄ．panle2の座標系
　　　　　ｅ．panel3の座標系
　　　　　ｆ．panel4の座標系
　　
　それぞれの座標系は、それぞれの領域の左上が原点になり、またそれぞれの座標軸の方向に従って座標を持つ。
　　　　　　　　　　　　　　　　　　　　　　　写真－２２．Locationプロパティで得られる値
　写真－２において、それぞれのコントロール（panel1～4）のLocationプロパティで得られる値は、その親の座標系で表される値である。すなわち、
　　　panel1.Locationであれば、フォーム(this)の座標系であり、
　　　panel2.Locationであれば、panel1の座標系、
　　　panel3.locationであれば、panel2の座標系になる。
　また、
　　　panel4.Locationであれば、前提条件からこれもpanel1同様フォーム(this)の座標系になる。
　　
　実際にその使い方は、３．PointToScreenメソッドの使い方
　PointToScreenメソッドは、あるコントロールの座標系で表された点の位置を、スクリーン（モニタ）の左上を原点(0,0)とした座標系に変換するメソッドである。
　基本的な使い方は、　例えば写真－２を例に挙げるならば、panel1の(左上の角の)位置をスクリーンの座標系で表す時は、次のようになる　また、panel2の位置をスクリーン座標系で表す時は、　ここで、注意しなければならないのは、PointToScreen()の前のオブジェクトは、PointToScreen()のパラメータに与えられる点が含まれるオブジェクトでなければならないことである。すなわち繰り返しになるが、panel1(の左上の点)が含まれるおbジェクトはフォーム(this)オブジェクトであり、またpanel2の(左上の点）が含まれるのはpanel1であるから、上記のような記述になる。
　では、panel3は、どのように記述されるであろうか。panel3のコントロールの親のコントロールはpanel2であるから、スクリーン座標系でpanel3の位置を表すと、となる。　それならばpanel4の場合は、親がpanel1と同様にフォーム(this)であるから、となる。４．PointToClientメソッド
　PointToClientメソッドは、スクリーン座標系で表された(コントロールの左上の角の)点を、別のコントロールの座標系に変換するメソッドである。
　基本的な使い方は、　また写真－２を例に挙げて説明する。
　panel1の(左上の角の)位置を、Locationプロパティで表したフォームの座標系、PointToScreenメソッドで用いたスクリーンの座標系、スクリーン座標をPointToClientメソッドでフォームの座標系で表した例を示す。　こので注意しなければならないのは、PointToClientメソッドの前のオブジェクトは、表したい座標系のオブジェクトでなければならないのであり、この場合はフォームを表すthisでなければならない。　次にpanel2の(左上の角の)位置を、Locationプロパティで表したフォームの座標系、PointToScreenメソッドで用いたスクリーンの座標系、スクリーン座標をPointToClientメソッドでフォームの座標系、panel1の座標系、panel2の座標系に変換して表した例を示す。　ここで注意しなければならないのは、panel2の左上の点をpanel2の座標系で表した点p25は、その座標が(0,0)になることである。（当然の話ではあるが、、、）　さらに次に、panel4をpanel1からpanel3の座標系で表す例を示す。panel4は、panel1同様、前提条件からフォーム(this)に属している。しかし、panel2とpanel3とは、直接的な関係はない。しかし、一方でスクリーン座標系を通して変換することができる。４．以上をまとめたソースコード
　以上をまとめたソースコードを次に示す。コンパイルすると写真－１で示したフォームの実行ファイルができる。それを起動し、そのフォームをドラッグして動かすと、スクリーン座標系で表されたコントロールの座標の値が変わる。またスクリーン座標をPointToClientメソッドそれぞれの座標系に変換された座標が表示される。　　　　　　　　　　　　　　　   　ソースコード以上


