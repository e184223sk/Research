More than 1 year has passed since last update.C# と Database ではそれぞれミリ秒の保持の仕方が異なります。上手く Assert するには比較用のクラスを作って、 Assert の Parameter に渡してあげれば OK です。C# の DateTime ではミリ秒を正しく保持しています。C#: 2013-05-01 23:59:59.991しかし、これを SQL Server の datetime に入れるとこうなります。SQL Server: 2013-05-01 23:59:59.990これには理由があって、ミリ秒の精度が .000、.003、.007 であるためです。よって、このまま Assert.Equals すると Fail してしまいます。比較用のクラスをパラメーターで渡してあげて、多少の時間を許容するようにします。いくつか用意してあるので合ったものを使ってください。また、このクラスでは 10 秒までの差は許容しているので、この設定値は Constructor で受け取れるようにするなどすれば、別の比較 (e.g. DateTime が DI 出来なくて死ぬ Unit Test など) にも使えると思います。DATETIME データ型のミリ秒に関する注意事項 – Microsoft SQL Server Japan Support Team Blog


