<!DOCTYPE html><html><head><meta charset="utf-8" /><title>【VB6・VB】古いコードのリプレース　その２　旧関数いろいろ - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/so_rei/items/e207edebe835cb1286cd" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Lp/ta9sNG7z7GJVWrzhmlfMHh7oNwHstBXhW48ZpDMV8NcQV8ebVAP1jha/0Qs+oe4FfS8wI1u3u67Hl4x+7XA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@so_rei" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="【VB6・VB】古いコードのリプレース　その２　旧関数いろいろ - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRVmtJMjQ0TzdWa0xqZ0pIbGo2VGpnWVRqZ3JQamc3empnNG5qZ2E3amc2cmpnNWZqZzZ6amc3empncm5qZ0lEamdaM2pnYTd2dkpMamdJRG1sNmZwbHFMbWxiRGpnWVRqZ28zamdZVGpnbzAmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ZDlkMzUxOTg0ZGJkYjEwZWZkNTBmNjNlOTRmYzE5NmU&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE52WDNKbGFRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9YTU4OTRiYThmNzZiNzc4YzBmYWEzNDFjNjFmNDdlMmQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=0abfe465b2a6c32971c7f7f9d02e8d8e"><meta property="og:description" content="※この記事は【VB6・VB】古いコードのリプレース のシリーズその２です。


その２　旧関数いろいろ

サポートされなくなった関数・今は推奨されない関数の対処まとめです。
今後書き足す予定(2018/11/11現在3まで)

1.I..."><meta content="https://qiita.com/so_rei/items/e207edebe835cb1286cd" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="VB.Net,C#,VB6.0" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-990edfc3-5e6d-473f-8409-1e90cfcbcc3d"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fso_rei%2Fitems%2Fe207edebe835cb1286cd">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fso_rei%2Fitems%2Fe207edebe835cb1286cd">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-990edfc3-5e6d-473f-8409-1e90cfcbcc3d">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/vb.net","name":"VB.Net"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-11-11T01:24:47.000+09:00","dateModified":"2018-11-17T14:32:09.000+09:00","headline":"【VB6・VB】古いコードのリプレース　その２　旧関数いろいろ","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NENRVmtJMjQ0TzdWa0xqZ0pIbGo2VGpnWVRqZ3JQamc3empnNG5qZ2E3amc2cmpnNWZqZzZ6amc3empncm5qZ0lEamdaM2pnYTd2dkpMamdJRG1sNmZwbHFMbWxiRGpnWVRqZ28zamdZVGpnbzAmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ZDlkMzUxOTg0ZGJkYjEwZWZkNTBmNjNlOTRmYzE5NmU\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSE52WDNKbGFRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9YTU4OTRiYThmNzZiNzc4YzBmYWEzNDFjNjFmNDdlMmQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=0abfe465b2a6c32971c7f7f9d02e8d8e","mainEntityOfPage":"https://qiita.com/so_rei/items/e207edebe835cb1286cd","author":{"@type":"Person","address":"","email":null,"identifier":"so_rei","name":"so_rei","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F310602%2Fprofile-images%2F1610894100?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=24b2f89a85b14a3d97cc33ccb7266a3a","url":"https://qiita.com/so_rei","description":"C#/VB 派遣工場系システムer4年\r\n→ASP.NET+js Webアプリケーション作成　1年目(現職)","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"so_rei","type":"items","id":"e207edebe835cb1286cd"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"so_rei","type":"items","id":"e207edebe835cb1286cd"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"so_rei","type":"items","id":"e207edebe835cb1286cd"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/so_rei/items/e207edebe835cb1286cd","location":"/so_rei/items/e207edebe835cb1286cd","scheme":"https","host":"qiita.com","port":null,"pathname":"/so_rei/items/e207edebe835cb1286cd","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"gngkpJsj3R+EsP30C3pj5MKXzsM7qJdHNR7hrJnMkOPQ0g3ascgTo4LL7Q1QAMrZShEWMvpgOofejQaqvLoneg==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-ea295fb0-49dc-4d01-af89-34d613a570f6"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/so_rei/items/e207edebe835cb1286cd/likers" class="css-1iupg5d">4</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">4</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/e207edebe835cb1286cd/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/so_rei/items/e207edebe835cb1286cd/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/so_rei/items/e207edebe835cb1286cd/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/so_rei/items/e207edebe835cb1286cd/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/so_rei/items/e207edebe835cb1286cd.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/so_rei"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/310602/profile-images/1610894100" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/so_rei" class="css-10ougpm">@<!-- -->so_rei</a><div class="css-1ay9vb9"><span><meta content="2018-11-10T16:24:47Z"/><time dateTime="2018-11-17T05:32:09Z" class="css-m19uds">updated at 2018-11-17</time></span></div></div></div></div></div><h1 class="css-cgzq40">【VB6・VB】古いコードのリプレース　その２　旧関数いろいろ</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/vb.net" class="css-4czcte">VB.Net</a><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/vb6.0" class="css-4czcte">VB6.0</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><strong>※この記事は<a href="https://qiita.com/so_rei/items/62a0327d321a5e0dd279" id="reference-2d8e0864aa47aae6feaa">【VB6・VB】古いコードのリプレース</a> のシリーズその２です。</strong></p>

<h1>
<span id="その２旧関数いろいろ" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%EF%BC%92%E6%97%A7%E9%96%A2%E6%95%B0%E3%81%84%E3%82%8D%E3%81%84%E3%82%8D"><i class="fa fa-link"></i></a>その２　旧関数いろいろ</h1>

<p>サポートされなくなった関数・今は推奨されない関数の対処まとめです。<br>
今後書き足す予定(2018/11/11現在3まで)</p>

<p><strong><a href="#1integerlongvb6">1.Integer,Long【VB6】</a></strong><br>
<strong><a href="#2iifandorvb">2.IIf,And,Or【VB】</a></strong><br>
<strong><a href="#3%E5%AE%A3%E8%A8%80%E7%9C%81%E7%95%A5vb6">3.宣言省略【VB6】</a></strong><br>
<strong><a href="#4%E9%85%8D%E5%88%97%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA">4.配列のサイズ</a></strong></p>

<h2>
<span id="1integerlongvb6" class="fragment"></span><a href="#1integerlongvb6"><i class="fa fa-link"></i></a>1.Integer,Long【VB6】</h2>

<p>コンバージョンツールを使っていれば問題はないと思いますが、一応。<br>
VB6のInteger型 = VB・c#のShort型。-32768~32767の範囲。<br>
VB6のLong型 = VB・c#のInteger/int型。</p>

<h2>
<span id="2iifandorvb" class="fragment"></span><a href="#2iifandorvb"><i class="fa fa-link"></i></a>2.IIf,And,Or【VB】</h2>

<p>VBのIIF、AndとAndAlsoは違う。</p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">VB：NG</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="c1">'これはNG</span>
    <span class="k">Dim</span> <span class="nv">number</span> <span class="n">as</span> <span class="kt">Integer</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">IIf</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="kt">Integer</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
    <span class="c1">'これもNG</span>
    <span class="k">If</span> <span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="ow">And</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="n">number</span> <span class="o">=</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">VB：OK</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="c1">'これはOK</span>
    <span class="n">number</span> <span class="o">=</span> <span class="k">If</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="kt">Integer</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
    <span class="c1">'これもOK</span>
    <span class="k">If</span> <span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="ow">AndAlso</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="n">number</span> <span class="o">=</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
</code></pre></div>
</div>

<h4>
<span id="理由" class="fragment"></span><a href="#%E7%90%86%E7%94%B1"><i class="fa fa-link"></i></a>理由：</h4>

<p>IIF関数はTrueのときもFalseの時の式を評価してしまう。<br>
And・Or演算子は前がTrueでなくとも2つ目の式を評価してしまう。<br>
なのでTextBox1.Text=""のときもInteger.Parse()を評価してしまいエラーになる。</p>

<p>AndAlso・OrElse演算子ならそういうことは起きないため安全。<br>
AndAlso・OrElseを使わないためだけにひたすらIfを重ね書きしてる古いソースをたびたび見る。</p>

<div class="code-frame" data-lang="vb6.0">
<div class="code-lang"><span class="bold">VB6：古いソースの例</span></div>
<div class="highlight"><pre class="with-code"><code>   Dim hoge As String

   'hogeに値を入れる......

   If IsNothing(hoge) = False Then
        If hoge &lt;&gt; "" Then
            Dim i As Integer
            i = CInt(hoge)
            If i &gt; 0 Then
                'ここからようやく値の評価が始まる
</code></pre></div>
</div>

<p>こういうのはさっさと書き換えましょう。<br>
書き換えていると、例のように<strong>「CIntで型変換出来ないケースが考慮されてない問題」</strong>とかが埋もれてることに気づけるという副産物もあります。</p>

<p><em>「既存が動いてるから型変換できないような値は来ないはず！だから大丈夫！」</em><br>
まぁそうなんですけど……バグの温床は潰すに越したことはないです……ないよね……？</p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">VB：変更後</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="c1">'こっちは省略できない</span>
    <span class="k">If</span> <span class="kt">Integer</span><span class="p">.</span><span class="n">TryParse</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">ToString</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">AndAlso</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="c1">'値の評価が終わってもうiに入っている</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">C#：変更後</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="k">if</span> <span class="p">(</span><span class="kt">int</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">hoge</span><span class="p">,</span> <span class="k">out</span> <span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">i</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="c1">//iの宣言もインライン化できる</span>
        <span class="c1">//値の評価が終わってもうiに入っている</span>
</code></pre></div>
</div>

<h2>
<span id="3宣言省略vb6" class="fragment"></span><a href="#3%E5%AE%A3%E8%A8%80%E7%9C%81%E7%95%A5vb6"><i class="fa fa-link"></i></a>3.宣言省略【VB6】</h2>

<p>意外と面倒なやつ。</p>

<p>VB6では以下のようなコードが許されていた。</p>

<div class="code-frame" data-lang="vb6.0">
<div class="code-lang"><span class="bold">VB6：古いソースの例</span></div>
<div class="highlight"><pre class="with-code"><code>        Dim hoge() As String
        hoge = {"file1", "file2", "file3"}
        For i = 0 To 3
            hoge(i) = hoge(i) + ".txt"
        Next        
</code></pre></div>
</div>

<p><strong>いや、iって誰だよ！</strong></p>

<h4>
<span id="対処法" class="fragment"></span><a href="#%E5%AF%BE%E5%87%A6%E6%B3%95"><i class="fa fa-link"></i></a>対処法：</h4>

<p>こういうコードに出会った場合は、１つ１つ中にどういう値が入りうるか、その関数内を全て確認して、問題がなさそうな宣言を入れるべき。</p>

<p>これがiみたいなわかり易い名前ならまだ良いですが、中身が全く推測できないような名前の関数の場合もあるんですよね……<br>
コンバージョンツールなどで置き換えた後、Option Strict Onにすればすぐ見つけることが出来るとはいえ、面倒です。</p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">VB：OK</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="c1">'このケースならIntegerでいけるだろう</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">c#：OK</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">//このケースならintでいけるだろう</span>
</code></pre></div>
</div>

<p>調べるのが面倒だからといって、Optionをいじるのは非推奨。【VB】<br>
(私がやってきた案件では絶対NGでした)</p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">VB：非推奨</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="kd">Option Explicit Off</span>
    <span class="c1">'または</span>
    <span class="k">Option</span> <span class="n">Strict</span> <span class="n">off</span>
    <span class="c1">'...</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Object</span>
</code></pre></div>
</div>

<p>c#ならとりあえずvarで宣言して、初期値に最初に使ってる値でも入れとけば多分大丈夫っていう逃げ方も。【c#】</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">c#：多分大丈夫</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="c1">//最初に0が入ってるんだからこれでいいじゃないか</span>
</code></pre></div>
</div>

<h2>
<span id="4配列のサイズ" class="fragment"></span><a href="#4%E9%85%8D%E5%88%97%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA"><i class="fa fa-link"></i></a>4.配列のサイズ</h2>

<p>色んな方法で配列のサイズをいじくるソースがあります。</p>

<ul>
<li>Array.Resize【VB6,VB】</li>
<li>Redim【VB6,VB】</li>
</ul>

<div class="code-frame" data-lang="vb6.0">
<div class="code-lang"><span class="bold">古いソースの例</span></div>
<div class="highlight"><pre class="with-code"><code>        Dim i(3) As Integer
        Dim k(100) As Integer

        'kにいろいろ値を入れる...

        'kのうち、正の値のものだけ配列iの後ろに付け足す
        Dim iNewSize As Integer
        For kLoop As Integer = 0 To k.Count - 1
            If k(kLoop) &gt; 0 Then
                'Array.Resizeの場合
                iNewSize = i.Length + 1
                Array.Resize(i, iNewSize)

                'Redim Preserveの場合
                iNewSize = i.Length
                Redim Preserve i(iNewSize)

                i1(iNewSize - 1) = k(kLoop)
            End If
        Next
</code></pre></div>
</div>

<p>こういうのは出来れば全部List(Of T)にしたい。<br>
特に量が多くて実行速度を考える場合、配列をリサイズするコストはバカにならない。</p>

<h4>
<span id="実行速度を以下の例で調べてみた" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E9%80%9F%E5%BA%A6%E3%82%92%E4%BB%A5%E4%B8%8B%E3%81%AE%E4%BE%8B%E3%81%A7%E8%AA%BF%E3%81%B9%E3%81%A6%E3%81%BF%E3%81%9F"><i class="fa fa-link"></i></a>実行速度を以下の例で調べてみた。</h4>

<div class="code-frame" data-lang="VB">
<div class="code-lang"><span class="bold">VB：Array.Resize／Redim／List(OfT)の実行速度確認</span></div>
<div class="highlight"><pre class="with-code"><code>        <span class="c1">'サイズ=3で初期化</span>
        <span class="k">Dim</span> <span class="nv">i1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
        <span class="k">Dim</span> <span class="nv">i2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
        <span class="k">Dim</span> <span class="nv">i3</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">List</span><span class="p">(</span><span class="k">Of</span> <span class="kt">Integer</span><span class="p">)</span>
        <span class="n">i3</span><span class="p">.</span><span class="n">AddRange</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">})</span>

        <span class="c1">'kにいろいろ値を入れる...</span>
        <span class="k">Dim</span> <span class="nv">k</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
        <span class="k">Dim</span> <span class="nv">r</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Random</span>
        <span class="k">For</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="n">k</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">k</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">Next</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">Next</span>

        <span class="c1">'タイマースタート*********************</span>
        <span class="k">Dim</span> <span class="nv">sw</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="n">Stopwatch</span><span class="p">()</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Start</span><span class="p">()</span>
        <span class="c1">'*************************************</span>

        <span class="c1">'■パターン１：Array.Resize</span>
        <span class="c1">'kのうち、正の値のものだけ配列iの後ろに付け足す</span>
        <span class="k">Dim</span> <span class="nv">iNewSize</span> <span class="ow">As</span> <span class="kt">Integer</span>
        <span class="k">For</span> <span class="n">kLoop</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="n">k</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">If</span> <span class="n">k</span><span class="p">(</span><span class="n">kLoop</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
                <span class="n">iNewSize</span> <span class="o">=</span> <span class="n">i1</span><span class="p">.</span><span class="n">Length</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">Array</span><span class="p">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">iNewSize</span><span class="p">)</span>
                <span class="n">i1</span><span class="p">(</span><span class="n">iNewSize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">kLoop</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>

        <span class="c1">'タイマーストップ*********************</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Stop</span><span class="p">()</span>
        <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="s">"Array.Resize : "</span> <span class="o">+</span> <span class="n">sw</span><span class="p">.</span><span class="n">Elapsed</span><span class="p">.</span><span class="n">ToString</span><span class="p">)</span>
        <span class="c1">'*************************************</span>

        <span class="n">sw</span><span class="p">.</span><span class="n">Restart</span><span class="p">()</span> <span class="c1">'タイマー再開*************************</span>

        <span class="c1">'■パターン２：Redim Preserve</span>
        <span class="c1">'kのうち、正の値のものだけ配列iの後ろに付け足す</span>
        <span class="k">Dim</span> <span class="nv">iNewSize2</span> <span class="ow">As</span> <span class="kt">Integer</span>
        <span class="k">For</span> <span class="n">kLoop</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="n">k</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">If</span> <span class="n">k</span><span class="p">(</span><span class="n">kLoop</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
                <span class="n">iNewSize2</span> <span class="o">=</span> <span class="n">i2</span><span class="p">.</span><span class="n">Length</span>
                <span class="k">ReDim</span> <span class="n">Preserve</span> <span class="n">i2</span><span class="p">(</span><span class="n">iNewSize2</span><span class="p">)</span>
                <span class="n">i2</span><span class="p">(</span><span class="n">iNewSize2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">kLoop</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>

        <span class="c1">'タイマーストップ*********************</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Stop</span><span class="p">()</span>
        <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="s">"ReDim Preserve : "</span> <span class="o">+</span> <span class="n">sw</span><span class="p">.</span><span class="n">Elapsed</span><span class="p">.</span><span class="n">ToString</span><span class="p">)</span>
        <span class="c1">'*************************************</span>

        <span class="n">sw</span><span class="p">.</span><span class="n">Restart</span><span class="p">()</span> <span class="c1">'タイマー再開*************************</span>

        <span class="c1">'■パターン３：List(Of T)とAddRange</span>
        <span class="c1">'kのうち、正の値のものだけ配列iの後ろに付け足す</span>
        <span class="k">For</span> <span class="n">kLoop</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="n">k</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">If</span> <span class="n">k</span><span class="p">(</span><span class="n">kLoop</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
                <span class="n">i3</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">k</span><span class="p">(</span><span class="n">kLoop</span><span class="p">))</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>

        <span class="c1">'タイマーストップ*********************</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Stop</span><span class="p">()</span>
        <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="s">"List(Of T) : "</span> <span class="o">+</span> <span class="n">sw</span><span class="p">.</span><span class="n">Elapsed</span><span class="p">.</span><span class="n">ToString</span><span class="p">)</span>
        <span class="c1">'*************************************</span>
</code></pre></div>
</div>

<h4>
<span id="実行結果" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C"><i class="fa fa-link"></i></a>実行結果</h4>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre class="with-code"><code>Array.Resize : 00:00:03.2530918
ReDim Preserve : 00:00:06.0734898
List(Of T) : 00:00:00.0009194
</code></pre></div>
</div>

<p>見ての通り、List(Of T)＆Addの組み合わせは処理条件自体も一緒に１行で書ける上、<br>
実行速度も数百倍早いです。<br>
ということで使わない理由がありません。</p>

<blockquote>
<p><strong>更に、List(Of T)にはAddRangeというメソッドも用意されているので、ラムダ式を組み合わせれば処理全てを１行で書けます。</strong></p>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">VB：List(OfT)&amp;AddRange&amp;ラムダ式</span></div>
<div class="highlight"><pre class="with-code"><code>        <span class="n">i3</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="k">Function</span><span class="err">(</span><span class="nf">p</span><span class="p">)</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
</code></pre></div>
</div>

<p>※ただし、ラムダ式は少し実行速度的には劣ります。<br>
試してみたところ、実行結果はこんな値になりました。</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">実行結果</span></div>
<div class="highlight"><pre class="with-code"><code>List(Of T)&amp;AddRange : 00:00:00.0049192
</code></pre></div>
</div>

<p>５倍は時間かかってますね。<br>
けど、これぐらいならソースコードが１行になるメリットのほうが大きいと思います。</p>
</blockquote>

<h4>
<span id="あとたまーにarraylistを使っているソースがあります" class="fragment"></span><a href="#%E3%81%82%E3%81%A8%E3%81%9F%E3%81%BE%E3%83%BC%E3%81%ABarraylist%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99"><i class="fa fa-link"></i></a>あとたまーにArrayListを使っているソースがあります。</h4>

<ul>
<li>ArrayList【VB】</li>
</ul>

<div class="code-frame" data-lang="vb">
<div class="code-lang"><span class="bold">VB：ArrayListの例</span></div>
<div class="highlight"><pre class="with-code"><code>    <span class="k">Dim</span> <span class="nv">p</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">ArrayList</span>
    <span class="n">p</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">"4"</span><span class="p">)</span>
</code></pre></div>
</div>

<p>これは.NET FrameWork1.0の頃に出た動的にサイズを変更できる配列的な何かですが、<br>
↑のようにObject型で入るのでかなり使いにくいです。(Object型なので当然、実行速度も遅い)<br>
こっちもList(Of T)に変更することを推奨します。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fso_rei%2Fitems%2Fe207edebe835cb1286cd&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fso_rei%2Fitems%2Fe207edebe835cb1286cd&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/so_rei/items/e207edebe835cb1286cd/likers" class="css-1iupg5d">4</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">4</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/e207edebe835cb1286cd/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/so_rei/items/e207edebe835cb1286cd/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/so_rei/items/e207edebe835cb1286cd/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/so_rei/items/e207edebe835cb1286cd/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/so_rei/items/e207edebe835cb1286cd.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-ea295fb0-49dc-4d01-af89-34d613a570f6">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-4720df31-e90e-440d-a211-30b7735fb14f"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-4720df31-e90e-440d-a211-30b7735fb14f">{}</script>
      
<div id="LoginModal-react-component-92c4d366-b0a0-4c52-bbfd-18bda12f4d0c"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-92c4d366-b0a0-4c52-bbfd-18bda12f4d0c">{}</script>
      
<div id="StockModal-react-component-febfd75a-5123-48c5-bed8-4edf27bf3587"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-febfd75a-5123-48c5-bed8-4edf27bf3587">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;y7IkJUKIJWHiphhRCjWvEJRfuVGANpiJFSsczDez7p+ZGA1baGPr3eTdCKhRTwYtHNlhoEH+NUn+uPvKEsVZBg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003cstrong\u003e※この記事は\u003ca href=\"https://qiita.com/so_rei/items/62a0327d321a5e0dd279\" id=\"reference-2d8e0864aa47aae6feaa\"\u003e【VB6・VB】古いコードのリプレース\u003c/a\u003e のシリーズその２です。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"その２旧関数いろいろ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%92%E6%97%A7%E9%96%A2%E6%95%B0%E3%81%84%E3%82%8D%E3%81%84%E3%82%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eその２　旧関数いろいろ\u003c/h1\u003e\n\n\u003cp\u003eサポートされなくなった関数・今は推奨されない関数の対処まとめです。\u003cbr\u003e\n今後書き足す予定(2018/11/11現在3まで)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"#1integerlongvb6\"\u003e1.Integer,Long【VB6】\u003c/a\u003e\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e\u003ca href=\"#2iifandorvb\"\u003e2.IIf,And,Or【VB】\u003c/a\u003e\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e\u003ca href=\"#3%E5%AE%A3%E8%A8%80%E7%9C%81%E7%95%A5vb6\"\u003e3.宣言省略【VB6】\u003c/a\u003e\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e\u003ca href=\"#4%E9%85%8D%E5%88%97%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA\"\u003e4.配列のサイズ\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"1integerlongvb6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1integerlongvb6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1.Integer,Long【VB6】\u003c/h2\u003e\n\n\u003cp\u003eコンバージョンツールを使っていれば問題はないと思いますが、一応。\u003cbr\u003e\nVB6のInteger型 = VB・c#のShort型。-32768~32767の範囲。\u003cbr\u003e\nVB6のLong型 = VB・c#のInteger/int型。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"2iifandorvb\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2iifandorvb\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2.IIf,And,Or【VB】\u003c/h2\u003e\n\n\u003cp\u003eVBのIIF、AndとAndAlsoは違う。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：NG\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"c1\"\u003e'これはNG\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003enumber\u003c/span\u003e \u003cspan class=\"n\"\u003eas\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\n    \u003cspan class=\"n\"\u003enumber\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eIIf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e'これもNG\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"ow\"\u003eAnd\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enumber\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：OK\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"c1\"\u003e'これはOK\u003c/span\u003e\n    \u003cspan class=\"n\"\u003enumber\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e'これもOK\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enumber\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"理由\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%90%86%E7%94%B1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e理由：\u003c/h4\u003e\n\n\u003cp\u003eIIF関数はTrueのときもFalseの時の式を評価してしまう。\u003cbr\u003e\nAnd・Or演算子は前がTrueでなくとも2つ目の式を評価してしまう。\u003cbr\u003e\nなのでTextBox1.Text=\"\"のときもInteger.Parse()を評価してしまいエラーになる。\u003c/p\u003e\n\n\u003cp\u003eAndAlso・OrElse演算子ならそういうことは起きないため安全。\u003cbr\u003e\nAndAlso・OrElseを使わないためだけにひたすらIfを重ね書きしてる古いソースをたびたび見る。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb6.0\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB6：古いソースの例\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e   Dim hoge As String\n\n   'hogeに値を入れる......\n\n   If IsNothing(hoge) = False Then\n        If hoge \u0026lt;\u0026gt; \"\" Then\n            Dim i As Integer\n            i = CInt(hoge)\n            If i \u0026gt; 0 Then\n                'ここからようやく値の評価が始まる\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこういうのはさっさと書き換えましょう。\u003cbr\u003e\n書き換えていると、例のように\u003cstrong\u003e「CIntで型変換出来ないケースが考慮されてない問題」\u003c/strong\u003eとかが埋もれてることに気づけるという副産物もあります。\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003e「既存が動いてるから型変換できないような値は来ないはず！だから大丈夫！」\u003c/em\u003e\u003cbr\u003e\nまぁそうなんですけど……バグの温床は潰すに越したことはないです……ないよね……？\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：変更後\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"c1\"\u003e'こっちは省略できない\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTryParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAndAlso\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'値の評価が終わってもうiに入っている\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eC#：変更後\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTryParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eout\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//iの宣言もインライン化できる\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//値の評価が終わってもうiに入っている\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"3宣言省略vb6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3%E5%AE%A3%E8%A8%80%E7%9C%81%E7%95%A5vb6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3.宣言省略【VB6】\u003c/h2\u003e\n\n\u003cp\u003e意外と面倒なやつ。\u003c/p\u003e\n\n\u003cp\u003eVB6では以下のようなコードが許されていた。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb6.0\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB6：古いソースの例\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        Dim hoge() As String\n        hoge = {\"file1\", \"file2\", \"file3\"}\n        For i = 0 To 3\n            hoge(i) = hoge(i) + \".txt\"\n        Next        \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eいや、iって誰だよ！\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"対処法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AF%BE%E5%87%A6%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e対処法：\u003c/h4\u003e\n\n\u003cp\u003eこういうコードに出会った場合は、１つ１つ中にどういう値が入りうるか、その関数内を全て確認して、問題がなさそうな宣言を入れるべき。\u003c/p\u003e\n\n\u003cp\u003eこれがiみたいなわかり易い名前ならまだ良いですが、中身が全く推測できないような名前の関数の場合もあるんですよね……\u003cbr\u003e\nコンバージョンツールなどで置き換えた後、Option Strict Onにすればすぐ見つけることが出来るとはいえ、面倒です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：OK\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"c1\"\u003e'このケースならIntegerでいけるだろう\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ec#：OK\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//このケースならintでいけるだろう\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e調べるのが面倒だからといって、Optionをいじるのは非推奨。【VB】\u003cbr\u003e\n(私がやってきた案件では絶対NGでした)\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：非推奨\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"kd\"\u003eOption Explicit Off\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e'または\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eOption\u003c/span\u003e \u003cspan class=\"n\"\u003eStrict\u003c/span\u003e \u003cspan class=\"n\"\u003eoff\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e'...\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eObject\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003ec#ならとりあえずvarで宣言して、初期値に最初に使ってる値でも入れとけば多分大丈夫っていう逃げ方も。【c#】\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ec#：多分大丈夫\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//最初に0が入ってるんだからこれでいいじゃないか\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"4配列のサイズ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#4%E9%85%8D%E5%88%97%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e4.配列のサイズ\u003c/h2\u003e\n\n\u003cp\u003e色んな方法で配列のサイズをいじくるソースがあります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eArray.Resize【VB6,VB】\u003c/li\u003e\n\u003cli\u003eRedim【VB6,VB】\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb6.0\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e古いソースの例\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        Dim i(3) As Integer\n        Dim k(100) As Integer\n\n        'kにいろいろ値を入れる...\n\n        'kのうち、正の値のものだけ配列iの後ろに付け足す\n        Dim iNewSize As Integer\n        For kLoop As Integer = 0 To k.Count - 1\n            If k(kLoop) \u0026gt; 0 Then\n                'Array.Resizeの場合\n                iNewSize = i.Length + 1\n                Array.Resize(i, iNewSize)\n\n                'Redim Preserveの場合\n                iNewSize = i.Length\n                Redim Preserve i(iNewSize)\n\n                i1(iNewSize - 1) = k(kLoop)\n            End If\n        Next\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこういうのは出来れば全部List(Of T)にしたい。\u003cbr\u003e\n特に量が多くて実行速度を考える場合、配列をリサイズするコストはバカにならない。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"実行速度を以下の例で調べてみた\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E9%80%9F%E5%BA%A6%E3%82%92%E4%BB%A5%E4%B8%8B%E3%81%AE%E4%BE%8B%E3%81%A7%E8%AA%BF%E3%81%B9%E3%81%A6%E3%81%BF%E3%81%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行速度を以下の例で調べてみた。\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"VB\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：Array.Resize／Redim／List(OfT)の実行速度確認\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e'サイズ=3で初期化\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ei1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ei2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ei3\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eOf\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ei3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'kにいろいろ値を入れる...\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e100000\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003er\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eRandom\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eTo\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'タイマースタート*********************\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003esw\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDiagnostics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStopwatch\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'*************************************\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'■パターン１：Array.Resize\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'kのうち、正の値のものだけ配列iの後ろに付け足す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eiNewSize\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eTo\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eiNewSize\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ei1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eiNewSize\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ei1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eiNewSize\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'タイマーストップ*********************\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Array.Resize : \"\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eElapsed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'*************************************\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRestart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e'タイマー再開*************************\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'■パターン２：Redim Preserve\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'kのうち、正の値のものだけ配列iの後ろに付け足す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003eiNewSize2\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eTo\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eiNewSize2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ei2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eReDim\u003c/span\u003e \u003cspan class=\"n\"\u003ePreserve\u003c/span\u003e \u003cspan class=\"n\"\u003ei2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eiNewSize2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ei2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eiNewSize2\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'タイマーストップ*********************\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ReDim Preserve : \"\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eElapsed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'*************************************\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRestart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e'タイマー再開*************************\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'■パターン３：List(Of T)とAddRange\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'kのうち、正の値のものだけ配列iの後ろに付け足す\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eFor\u003c/span\u003e \u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eInteger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eTo\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eIf\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eThen\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ei3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"k\"\u003eIf\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eNext\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e'タイマーストップ*********************\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eDebug\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"List(Of T) : \"\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003esw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eElapsed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e'*************************************\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"実行結果\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行結果\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e実行結果\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eArray.Resize : 00:00:03.2530918\nReDim Preserve : 00:00:06.0734898\nList(Of T) : 00:00:00.0009194\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e見ての通り、List(Of T)＆Addの組み合わせは処理条件自体も一緒に１行で書ける上、\u003cbr\u003e\n実行速度も数百倍早いです。\u003cbr\u003e\nということで使わない理由がありません。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e更に、List(Of T)にはAddRangeというメソッドも用意されているので、ラムダ式を組み合わせれば処理全てを１行で書けます。\u003c/strong\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：List(OfT)\u0026amp;AddRange\u0026amp;ラムダ式\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e        \u003cspan class=\"n\"\u003ei3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAddRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eFunction\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e※ただし、ラムダ式は少し実行速度的には劣ります。\u003cbr\u003e\n試してみたところ、実行結果はこんな値になりました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e実行結果\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003eList(Of T)\u0026amp;AddRange : 00:00:00.0049192\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e５倍は時間かかってますね。\u003cbr\u003e\nけど、これぐらいならソースコードが１行になるメリットのほうが大きいと思います。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"あとたまーにarraylistを使っているソースがあります\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%81%A8%E3%81%9F%E3%81%BE%E3%83%BC%E3%81%ABarraylist%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあとたまーにArrayListを使っているソースがあります。\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eArrayList【VB】\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"vb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eVB：ArrayListの例\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003eDim\u003c/span\u003e \u003cspan class=\"nv\"\u003ep\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"k\"\u003eNew\u003c/span\u003e \u003cspan class=\"n\"\u003eArrayList\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"4\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれは.NET FrameWork1.0の頃に出た動的にサイズを変更できる配列的な何かですが、\u003cbr\u003e\n↑のようにObject型で入るのでかなり使いにくいです。(Object型なので当然、実行速度も遅い)\u003cbr\u003e\nこっちもList(Of T)に変更することを推奨します。\u003c/p\u003e\n","createdAt":"2018-11-10T16:24:47Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"DS8mbo517pnuVbv7Q4eDhMT8UoZm3TM5--0fbcC8ISaazy26F8--3sMKJRR3THyHVV+GlKh3Lw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2018-11-17T05:32:09Z","likesCount":4,"linkUrl":"https://qiita.com/so_rei/items/e207edebe835cb1286cd","organization":null,"originalId":721390,"stockedCount":4,"title":"【VB6・VB】古いコードのリプレース　その２　旧関数いろいろ","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9D%E3%81%AE%EF%BC%92%E6%97%A7%E9%96%A2%E6%95%B0%E3%81%84%E3%82%8D%E3%81%84%E3%82%8D\"\u003eその２　旧関数いろいろ\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#1integerlongvb6\"\u003e1.Integer,Long【VB6】\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#2iifandorvb\"\u003e2.IIf,And,Or【VB】\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%90%86%E7%94%B1\"\u003e理由：\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#3%E5%AE%A3%E8%A8%80%E7%9C%81%E7%95%A5vb6\"\u003e3.宣言省略【VB6】\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AF%BE%E5%87%A6%E6%B3%95\"\u003e対処法：\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cli\u003e\n\u003ca href=\"#4%E9%85%8D%E5%88%97%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA\"\u003e4.配列のサイズ\u003c/a\u003e\n\u003cul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E9%80%9F%E5%BA%A6%E3%82%92%E4%BB%A5%E4%B8%8B%E3%81%AE%E4%BE%8B%E3%81%A7%E8%AA%BF%E3%81%B9%E3%81%A6%E3%81%BF%E3%81%9F\"\u003e実行速度を以下の例で調べてみた。\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AE%9F%E8%A1%8C%E7%B5%90%E6%9E%9C\"\u003e実行結果\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%82%E3%81%A8%E3%81%9F%E3%81%BE%E3%83%BC%E3%81%ABarraylist%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99\"\u003eあとたまーにArrayListを使っているソースがあります。\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\n\n\n\n\n","totalPv":3605,"uuid":"e207edebe835cb1286cd","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"f7fNwAdDJphSnTk56V1B8ZHPMcC3--eGn2MM0ZPkwDvjIH--78CcTe/ymQAwCIIsjMjOUw==","originalId":310602,"description":"C#/VB 派遣工場系システムer4年\r\n→ASP.NET+js Webアプリケーション作成　1年目(現職)","facebookUrl":null,"githubUrl":"https://github.com/So-rei","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"So-rei","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/310602/profile-images/1610894100","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F310602%2Fprofile-images%2F1610894100?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=55978a90dd98dc191b5b9795626e18b6","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F310602%2Fprofile-images%2F1610894100?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=24b2f89a85b14a3d97cc33ccb7266a3a","urlName":"so_rei","websiteUrl":"","twitterUrl":"https://twitter.com/so_rei","twitterUrlName":"so_rei","revealedOrganizations":{"edges":[]}},"tags":[{"name":"VB.Net","urlName":"vb.net"},{"name":"C#","urlName":"csharp"},{"name":"VB6.0","urlName":"vb6.0"}],"followingLikers":{"edges":[]},"comments":{"totalCount":2}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
