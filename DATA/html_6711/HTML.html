<!DOCTYPE html><html><head><meta charset="utf-8" /><title>テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/Azleep/items/242a7208f120c5199913" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ZyVwVVb6Fj2pDmN+mwrQufMZdnnmIGLleYbLeS41gcYkWys22Lo2MmOJeNcRzMuUdphm3CAr5y2vxG5ab9S3CQ==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NE9HNDRLNTQ0T0k2SWVxNVl1VjVZeVc0NEdyNTV1dTZLYWE0NEtCNDRHZjc3eUJJRWxSTVRBdzQ0R3U1YVd6NWEyUTZhdVk1NVNmNDRHdTVZV0k2THlwNDRHTDQ0S0o1WS1YNDRHUjQ0R2Y1NG01NktpVDc3eVQ3N3lRNVlpRyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz00Y2U0M2Y1N2QxODA2ZTNmZWVmYTU5YzQ5YjNjMTBmYw&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRUY2YkdWbGNBJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZTQyNzY0NzRkZmYyZjI1Y2Y0NGY3YzQ2MTZjZTcxODQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=afe5253e6ea721e68784fe8c66232c38"><meta property="og:description" content="

はじめに

　2015年の暮れに、結合テスト自動化ツール「Friendly」についての小説仕立ての解説記事を内輪向けに書きました。そのまま腐らせておくのももったいないし、もし誰かの参考になるのならと思い、思い切って公開することにし..."><meta content="https://qiita.com/Azleep/items/242a7208f120c5199913" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,WPF,Friendly,自動化ポエム" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-4738144c-5b7b-49f9-9af7-1e6f6e7a30de"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FAzleep%2Fitems%2F242a7208f120c5199913">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FAzleep%2Fitems%2F242a7208f120c5199913">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-4738144c-5b7b-49f9-9af7-1e6f6e7a30de">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2016-12-28T00:05:28.000+09:00","dateModified":"2017-01-04T10:51:57.000+09:00","headline":"テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NE9HNDRLNTQ0T0k2SWVxNVl1VjVZeVc0NEdyNTV1dTZLYWE0NEtCNDRHZjc3eUJJRWxSTVRBdzQ0R3U1YVd6NWEyUTZhdVk1NVNmNDRHdTVZV0k2THlwNDRHTDQ0S0o1WS1YNDRHUjQ0R2Y1NG01NktpVDc3eVQ3N3lRNVlpRyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz00Y2U0M2Y1N2QxODA2ZTNmZWVmYTU5YzQ5YjNjMTBmYw\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRUY2YkdWbGNBJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9ZTQyNzY0NzRkZmYyZjI1Y2Y0NGY3YzQ2MTZjZTcxODQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=afe5253e6ea721e68784fe8c66232c38","mainEntityOfPage":"https://qiita.com/Azleep/items/242a7208f120c5199913","author":{"@type":"Person","address":"","email":null,"identifier":"Azleep","name":"Azleep","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2Fprofile-images%2F1551460335?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=1cde60e09ba9f6556ef25d307bbee87b","url":"https://qiita.com/Azleep","description":"C#/WPFやってる物書き志望IT土方。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202106-uzabase-3/">経済情報で世界を変えていけているユーザベースの可能性</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202106-uzabase-3/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Azleep","type":"items","id":"242a7208f120c5199913"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"経済情報で世界を変えていけているユーザベースの可能性","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Azleep","type":"items","id":"242a7208f120c5199913"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"経済情報で世界を変えていけているユーザベースの可能性","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Azleep","type":"items","id":"242a7208f120c5199913"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"経済情報で世界を変えていけているユーザベースの可能性","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/Azleep/items/242a7208f120c5199913","location":"/Azleep/items/242a7208f120c5199913","scheme":"https","host":"qiita.com","port":null,"pathname":"/Azleep/items/242a7208f120c5199913","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"rhs0xZLBSoYkviirPgOlCwTCDQM70giBXHoHaG3pzN3tZW+mHIFqie45MwK0xb4mgUMdpv3ZjUmKOKJLLAj6Eg==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-8ddfb745-387a-4864-961c-b2b63d35abea"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Azleep/items/242a7208f120c5199913/likers" class="css-1iupg5d">33</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">46</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/242a7208f120c5199913/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Azleep/items/242a7208f120c5199913/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Azleep/items/242a7208f120c5199913/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Azleep/items/242a7208f120c5199913/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Azleep/items/242a7208f120c5199913.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/Azleep"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/67050/profile-images/1551460335" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/Azleep" class="css-10ougpm">@<!-- -->Azleep</a><div class="css-1ay9vb9"><span><meta content="2016-12-27T15:05:28Z"/><time dateTime="2017-01-04T01:51:57Z" class="css-m19uds">updated at 2017-01-04</time></span></div></div></div></div></div><h1 class="css-cgzq40">テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/wpf" class="css-4czcte">WPF</a><a href="/tags/friendly" class="css-4czcte">Friendly</a><a href="/tags/%e8%87%aa%e5%8b%95%e5%8c%96%e3%83%9d%e3%82%a8%e3%83%a0" class="css-4czcte">自動化ポエム</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h2>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h2>

<p>　2015年の暮れに、結合テスト自動化ツール「<a href="http://www.codeer.co.jp/AutoTest" rel="nofollow noopener" target="_blank">Friendly</a>」についての小説仕立ての解説記事を内輪向けに書きました。そのまま腐らせておくのももったいないし、もし誰かの参考になるのならと思い、思い切って公開することにしました。<br>
　したがって記事の内容は2015年当時のものであり、それ以降はFriendlyの動向もあまり追いかけていないので、<strong>現時点ですでに情報が古い可能性がある</strong>ことに留意してください。</p>

<p>　なお、本記事は「<a href="http://kenokabe-techwriting.blogspot.jp/2015/04/iq145.html" rel="nofollow noopener" target="_blank">関数型プログラミングに目覚めた！ IQ145の女子高生の先輩から受けた特訓５日間</a>」とは一切関係ありません。</p>

<h2>
<span id="テスト自動化に目覚めた-iq100の女子高生の先輩から受けた特訓３０分" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%AB%E7%9B%AE%E8%A6%9A%E3%82%81%E3%81%9F-iq100%E3%81%AE%E5%A5%B3%E5%AD%90%E9%AB%98%E7%94%9F%E3%81%AE%E5%85%88%E8%BC%A9%E3%81%8B%E3%82%89%E5%8F%97%E3%81%91%E3%81%9F%E7%89%B9%E8%A8%93%EF%BC%93%EF%BC%90%E5%88%86"><i class="fa fa-link"></i></a>テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分</h2>

<h3>
<span id="プロローグ" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%83%AD%E3%83%BC%E3%82%B0"><i class="fa fa-link"></i></a>プロローグ</h3>

<p>「ずいぶんとダサいコードを書いてるのね」<br>
　不意に背後から声をかけられた。セキナが振り向くと白い首筋が目の前にあった。同時に蜂蜜の甘い香りがした。この地方には蜂蜜を髪に塗りこむ風習はないから、これはきっとシャンプーの香りだ。<br>
「はっ、ササクラ先輩！」<br>
　ササクラ先輩は、セキナの背後から前かがみにモニターを覗き込んでいた。たいして身長の高くない彼女の足はバレリーナのようにつま先立ちで、モニターの文字を目で追いながらプルプルと震えていた。<br>
　セキナが椅子を横にずらして場所を譲ると、ササクラ先輩は「ありがとう」と礼を言ってディスプレイの前に陣取った。<br>
　放課後のコンピュータ室（かつて電子計算機室と呼ばれていた部屋だ）は、コンピュータ部が自由に使用していいという取り決めがなされていた。今日は他の部員は誰も来ていない。ずっとセキナ一人きりで黙々と作業をしていたのだが、いつのまにか元部長であるササクラが様子を見に来ていたようだ<br>
　ちなみにササクラは高校三年生で、今は十二月だからセンター試験まであと一ヶ月もないはずだ。本来はこんなところに顔を出せるほど暇な人ではないのだが。部長の肩書も、二学期に入ってからは二年生の部員に譲られていた。<br>
「セキヤ君は何のプロジェクトやってるんだっけ？」<br>
「セキナです。今は何もしてません。ちょっと個人的に、WPFを使ってアプリを作ってました。あと先輩、受験大丈夫ですか？」<br>
「どんなアプリ？」<br>
「ええと、人の名前とか年齢とか誕生日とか、そういうデータを管理するようなアプリです。名鑑ですね」</p>

<p><a href="https://camo.qiitausercontent.com/96692b88b7fcd41da0daea2e1d20000731c220f9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36373035302f63633930386566322d333166662d663831632d376636612d6463656537353166363239322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2Fcc908ef2-31ff-f81c-7f6a-dcee751f6292.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b5e1c1e1d4837b3b683849997cdddbb3" alt="アプリのイメージ.PNG" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/67050/cc908ef2-31ff-f81c-7f6a-dcee751f6292.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2Fcc908ef2-31ff-f81c-7f6a-dcee751f6292.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2d2dc3b024d9da6bccad93ced498bbf7 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/4a445d1a678ae4cc057a17e1d82611f41c517b26/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36373035302f32336637353934332d306234392d623465622d366564342d3136333436346232333239342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2F23f75943-0b49-b4eb-6ed4-163464b23294.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=2bab7eca959763fceaf2f1ec3c760bf8" alt="追加.PNG" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/67050/23f75943-0b49-b4eb-6ed4-163464b23294.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2F23f75943-0b49-b4eb-6ed4-163464b23294.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cdf9c378b1f191c9f30aac27916334f4 1x" loading="lazy"></a></p>

<p>「ふうん。ゴミね」<br>
　バッサリ切り捨てられた。<br>
「まあ、まだ作りかけなので……。今はベースとなる部分を組み立てているところです。機能追加はあとでやろうと思ってるんで」<br>
「さっき後ろから見てたら、ちょっとコードを書くたびにウィンドウを出したりボタンを押したり閉じたりしてたけど、あれは？」<br>
「動作確認ですよ。ちょっと改造したら、これまで作った部分がちゃんと動くかどうかを一通り操作して確かめるんです。じゃないと、どこでデグレしたか分からないですからね」<br>
「ゴミね。まるでゴミね。ゴミという言葉すらもったいないくらい。喩えるなら……そう、これは……すごく……ゴミね」<br>
「『ゴミ』から一歩も外に出てませんけど」<br>
　ササクラは語彙が貧弱だった。<br>
「セキナ君はVisual Studioでアプリを作っているけど、Visual Studioのテストプロジェクトは知ってる？」<br>
「知ってますけど、今のアプリのテストには使えませんよ。データ処理の機能を実装したらそこだけテストできますけど、今はまだUIの部分しか作ってないので」<br>
「UI層の単体テストを作ればいいじゃない」<br>
「確かに、UIAutomationみたいなUI操作をエミュレートするライブラリを使えば画面操作を自動実行することはできますけど、でもアプリ開発を進めるとすぐにテストが壊れちゃいますし、UI操作で内部の状態がどう変わったかがテスト側で判定できないじゃないですか。それじゃあ総合テストくらいにしか使えないですよ。あとUIテストって、ボタン押すタイミングとかですぐに失敗するし……」<br>
「そう、セキナ君はFriendlyを知らないのね」<br>
「Friendly？」<br>
　聞き慣れない単語だった。ササクラは得意気に頷いた。<br>
「教えてあげようか？」<br>
「いえ、別に大丈夫です」</p>

<h2>
<span id="導入" class="fragment"></span><a href="#%E5%B0%8E%E5%85%A5"><i class="fa fa-link"></i></a>導入</h2>

<p>「まずは導入方法から。Nugetはもちろん知ってるわね？　Nugetから『Friendly』、『Friendly.Windows』、『Friendly.Windows.Grasp』、『Friendly.WPFStandardControls』を検索するの」<br>
「勝手に始めるんですね。……はい、ありました」<br>
「それじゃ、ダウンロードボタンをポチっとな」<br>
「あんたほんとに女子高生か」<br>
　言われたとおり、セキナはテストプロジェクトにFriendly、Friendly.Windows、Friendly.Windows.Grasp、Friendly.WPFStandardControlsのパッケージを追加した。<br>
「これ、どういうライブラリなんですか？」<br>
「Friendlyはね、実行中の他のプロセスに介入して、外から操作を行うためのライブラリよ」<br>
「他のプロセス……？　でもそれって、他のGUIテスト自動化ライブラリでもそうですよね。UIAutomationとか」<br>
「そうね。ただ、さっきセキナ君が言った通り、他のプロセスを操作するテストライブラリにはタイミング依存で失敗するという弱点があったわ。テスト対象のプロセス――プロダクトプロセスに対して、OSを介してマウス操作やキーボード入力をエミュレートすることはできても、そのプロセスが入力に対しての処理を完了したかどうかを、テストプロセスから判別する方法がなかったの。だからそういうときは、Thread.Sleepメソッドで一定時間テストプロセスを待機させたりした後に次の処理を行うようにしてたのだけど――」<br>
「処理にかかる時間って、マシンやタイミングでも変わりますからね。それに、処理が終わるまで十分な時間をいちいち待機させていたらテストに時間がかかって仕方ないです」<br>
「Friendlyはプロダクトプロセスに対して同期的にUI操作をエミュレートできるという利点があるの。だから、UI操作をエミュレートしたとき、その操作に対するプロダクトプロセスの反応が終わったら自動的に次のテスト処理が実行されるわ。それからもうひとつ、Friendlyはプロダクトプロセス内にテストプロセスのメソッドを送り込むという非常に強力な機能を持っている」<br>
「送り込む……って、どういう意味ですか？」<br>
「そのことは順番に話すとして……まずは基本的な使い方から説明するわ」<br>
　そう言うとササクラは、立ったままの状態で、テストプロジェクトのソースファイルにキーボードでコードを打ち始めた。</p>

<h2>
<span id="プロセスへのアタッチ" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%B8%E3%81%AE%E3%82%A2%E3%82%BF%E3%83%83%E3%83%81"><i class="fa fa-link"></i></a>プロセスへのアタッチ</h2>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Friendly用APPクラス</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="n">WindowsAppFriend</span> <span class="n">_app</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// テスト対象に存在するMainWindowインスタンス</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="kt">dynamic</span> <span class="n">_main</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// テスト開始前の処理</span>
        <span class="c1">/// ここで、テスト対象のプロセスにアタッチする</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="p">[</span><span class="n">TestInitialize</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestInitialize</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// 外部プロセスにアタッチ</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_app</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WindowsAppFriend</span><span class="p">(</span><span class="n">Process</span><span class="p">.</span><span class="nf">Start</span><span class="p">(</span><span class="s">"WPFApp.exe"</span><span class="p">));</span>

            <span class="c1">// MainWindowを取得</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_main</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>　"WPFApp.exe"というのはセキナが作っている名鑑アプリの実行ファイルの名前である。<br>
「こんな風に、WindowsAppFriendクラスのコンストラクタにSystem.Diagnostics.Processクラスのインスタンスを渡せば準備完了よ」<br>
「『MainWindowを取得』と書いてあるのは？」<br>
「Friendlyでは、アタッチしたプロセスの空間にあるStaticなメソッドを自由に呼び出す方法が提供されているの。二つ目に書いた、『MainWindowを取得』の部分は、staticなApplicationクラスのCurrentメソッドを呼び出しているところね」<br>
「『アタッチしたプロセスの空間にある』……？」<br>
「今ここに書いてあるこのコードが動いているプロセスと、Process.Startで起動したWPFApp.exeが動いているプロセスは別のプロセス……ここまではいいわね？」<br>
「何とか」<br>
　Process.Startは別プロセスを起動するメソッドだ。単体テストのメソッドで、例えばWPFAppのMainWindowクラスのインスタンスを作る（newする）のとはわけが違う。<br>
「テストコードでApplication.Current.MainWindowを呼び出しても、それで呼び出されるのはテストコードが動いているプロセスのApplication.Current.MainWindowでしかない。別のプロセスのstaticメソッドを呼び出す方法はないわ。……普通はね」<br>
「Friendlyならそれができる……ですか」<br>
「そう。そして、staticなメソッドを呼び出せるということはMainWindowを取得できるということ。MainWindowを取得できるということは、WPFならばそのプロセスに存在するあらゆるオブジェクトにアクセスできるということ。つまり、Friendlyを使えばプロダクトプロセスのすべてを見通すことができるのよ。まさに透視……！　圧倒的透視力……！」<br>
　めちゃくちゃ顔を近づけてササクラは言った。頭突きされたらひとたまりもない距離だ。セキナはざわざわした。<br>
「この、二つ目のコードの戻り値……_mainフィールドがdynamic型なのはどうしてですか？」<br>
「ここで取得したMainWindowクラスのインスタンスへの参照は、あくまでプロダクトプロセス――今回の場合は、単体テストが動いているプロセスとは別のプロセスで動いている"WPFApp.exe"の中に存在しているものよ。そして、他プロセスの中に存在するものへは、Friendlyはdynamic型を使うことでアクセスできるようにしているの」<br>
「dynamicだとインテリセンスきかないんですけど」<br>
「インテリセンスは死んだわ」<br>
　真顔で言われた。現実は非情である。<br>
「ところで、Friendlyは他プロセスの変数の値をこちら側のプロセスの方に取ってくる機能があるんだけど、それはプロセス間通信を使って実現しているの。例えばWPFApp.exeのMainWindowクラスのTitle属性を、テストプロセスの側にstring型の変数として取得できるわ。ただし、プロセス間通信でやりとりできるものはシリアライズが可能な型だけで、たとえばWindowクラスをそのままテストプロセスにコピーすることはできないわ」<br>
「プロセス間通信でやりとりできる型って何ですか？」<br>
「intやstring型なんかは普通に取得できるわね。……ところで、このdynamic型の参照――実際にはDynamicAppVar型っていうFriendlyで定義されたクラスなんだけど、それはともかく――これを、例えばintやstringなどの実際の型にキャストした時点で、プロダクトプロセスにあるオブジェクトがコピーされて、テストプロセスに送られてきて実体となるの」<br>
　途中からササクラが何を言っているのか分からなくなってきたのでセキナは生返事を返した。それを敏感に察したのか、ササクラも「まあ具体的な書き方については後で見せるわ」と説明を打ち切った。</p>

<h2>
<span id="たとえばボタンクリックのエミュレート" class="fragment"></span><a href="#%E3%81%9F%E3%81%A8%E3%81%88%E3%81%B0%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>たとえばボタンクリックのエミュレート</h2>

<p>「それじゃ、まずは簡単なところから――『追加』ボタンを押したときの挙動をテストする場合を考えてみましょうか」<br>
　ササクラは顔をディスプレイに向けるとものすごいスピードでコードをタイプし始めた。タイプしながらセキナに対して言葉で説明する。<br>
「『追加』ボタンを押すと、データを追加するためのダイアログが出てくる――ダイアログが出てくるのを確認するためのテストを書く、という想定で考えてみるわ。こんな感じかしら」<br>
　ササクラは体をディスプレイの前から動かし、セキナにコードを見るように促した。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 「追加」ボタンを押すと項目の追加画面が出てくるかどうかをテスト</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestAddButton</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// ボタンを押す前は、Windowは１つだけなのを確認</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>

            <span class="c1">// ボタンの特定方法１：コントロールに指定された"Name"から特定</span>
            <span class="kt">var</span> <span class="n">buttonAdd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">_main</span><span class="p">.</span><span class="n">addButton</span><span class="p">);</span>
            <span class="c1">// クリック操作を非同期でエミュレート</span>
            <span class="n">Async</span> <span class="n">a</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Async</span><span class="p">();</span>
            <span class="n">buttonAdd</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>

            <span class="c1">// 詳細ウィンドウが出てきたのを確認</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>

            <span class="c1">// "新規追加"というタイトルのウィンドウが見つからなかったらNG</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">WindowControl</span><span class="p">.</span><span class="nf">IdentifyFromWindowText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="s">"新規追加"</span><span class="p">));</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>「WPFButtonBaseというのは、Friendlyでボタンを扱うためのラッパークラスのようなもので……このクラスを介して、例えばボタンならクリック操作をエミュレートすることができるわ。『Friendly.WPFStandardControls』にはButton以外にもTextBoxやDataGridのようなコントロールへの操作をエミュレートするクラスが揃っているの」<br>
　ButtonBase、という名前が気になったが、よく考えればButtonクラスの基底クラスがButtonBaseクラスだったはずだ。つまり、ButtonBaseクラスを継承して作った（標準のButtonを拡張するような）独自のコントロールに対してもWPFButtonBaseが使えるということだ。<br>
　ササクラが、メソッドの最後の方をディスプレイの上から指で押さえた。<br>
「このテストメソッドの最後、"新規追加"ウィンドウを取得しているところで使っているWindowControlクラスは、Windowクラスのラッパーみたいなものね。これは『Friendly.Windows.Grasp』の方にあるクラスよ。『Friendly.Windows.Grasp』にはウィンドウに対する操作を楽にするためのクラスが揃っているわ。ちなみにこれ、タイトルの文字列でウィンドウを特定しているけど、他にもクラス名や、トップレベルにあるウィンドウを取得、なんてこともできるわ」</p>

<h2>
<span id="コントロールの特定" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A"><i class="fa fa-link"></i></a>コントロールの特定</h2>

<p>「ここのコメントのところに『ボタンの特定方法１：コントロールに指定された"Name"から特定』……って書いてあるのは？」<br>
「まず、WPFButtonBaseクラスのコンストラクタにはAppVarのインスタンスを渡すことになっているのね」<br>
「AppVarクラスって何ですか？」<br>
「プロダクトプロセスに存在している変数への参照を意味するクラスね。上の方でちょっと教えたDynamicAppVarクラスと同じようなものよ。プロダクトプロセスに存在している変数はすべてAppVar型かDynamicAppVar型になるわけ。OK？」<br>
「えーっと……AppVar型とDynamicAppVar型の違いは何ですか？」<br>
「意味は同じよ。違いといえば、DynamicAppVar型はdynamic型になるというくらい。AppVar型は操作するのがちょっと面倒なの。だから、AppVar型のインスタンスを操作しやすくるために、後からDynamicAppVar型がFriendlyに追加されたの」<br>
「なるほど。OKです」<br>
「さて問題はWindowからControlのインスタンスをどうやって取ってくるか。一番簡単な方法は、Viewを定義するときにNameプロパティを設定して、Windowクラスからコントロールのフィールドの名前を指定してアクセスする方法よ。ほら、MainWindowのUIの定義を見ると、追加ボタンには"addButton"という名前がついているでしょう」<br>
　ササクラはMainWindow.xamlを開いて指で示した。すなわちこれは、セキナがさっきまで書いていた、WPFAppのコードだ。</p>

<div class="code-frame" data-lang="xml"><div class="highlight"><pre><code>            <span class="nt">&lt;Button</span> <span class="na">Name=</span><span class="s">"addButton"</span>
                    <span class="na">Command=</span><span class="s">"{Binding AddCommand}"</span>
                    <span class="na">Content=</span><span class="s">"追加"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>「じゃ、さっそくこれを実行してみましょうか」<br>
　ササクラはマウスを操作して、単体テスト"TestAddButton"を実行した。一瞬で名鑑アプリのウィンドウが立ち上がると、データ追加用のサブウィンドウが開いた、ように見えた。すぐに親ウィンドウごと名鑑アプリは終了した。テスト結果を見ると、「テスト 成功」の文字があった。<br>
「おお、すごい。勝手に起動した」<br>
「UIテストなんだから当たり前でしょう」<br>
　ササクラは冷めた反応を返した。<br>
「『クリック操作を非同期でエミュレート』というのは？　同期的にエミュレートできないんですか？」<br>
「できるけど、『追加』ボタンを押すとウィンドウが出てくるでしょう？　このボタンを同期的にエミュレートすると、このウィンドウが閉じるまで制御が戻ってくれないの。もちろん、Asyncクラスのインスタンスを引数に渡さなければ同期的にエミュレートされるから、ちゃんと制御が戻るならわざわざ同期的に呼び出す必要はないわ」</p>

<h2>
<span id="バインドからコントロールの特定" class="fragment"></span><a href="#%E3%83%90%E3%82%A4%E3%83%B3%E3%83%89%E3%81%8B%E3%82%89%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A"><i class="fa fa-link"></i></a>バインドからコントロールの特定</h2>

<p>「まあとにかく、こんな風に『ボタンを押す』と『ウィンドウが出てくる』という仕様をテストすることができるわ」<br>
「『ボタンの特定方法１』って書いてますけど、『ボタンの特定方法２』はあるんですか？」<br>
「せっかちね。せっかちな男は嫌いよ」<br>
「じゃあ質問を撤回します」<br>
「のんびりした男はもっと嫌いよ」<br>
　軽口を叩いている間も、ササクラは休むことなくキーボードを叩いていた。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 削除ボタンの活性状態をテスト</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestDeleteButton_Enable</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// 未選択状態のときは削除ボタンを押せないことをテスト</span>
            <span class="n">AppVar</span> <span class="n">mainVar</span> <span class="p">=</span> <span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">;</span>

            <span class="c1">// ボタンの特定方法２：コントロールに指定されたバインディングから特定</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">mainVar</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">deleteButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"DeleteCommand"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>

            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsFalse</span><span class="p">(</span><span class="n">deleteButton</span><span class="p">.</span><span class="n">IsEnabled</span><span class="p">);</span>

            <span class="c1">// リストから選択する操作を実行</span>
            <span class="c1">// DataGridを取得</span>
            <span class="kt">var</span> <span class="n">dataGrid</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFDataGrid</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"PeopleModel.People"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="c1">// DataGridの最初の行を取得して選択操作をエミュレート</span>
            <span class="kt">var</span> <span class="n">row</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetRow</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">EmulateChangeSelected</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>

            <span class="c1">// 削除ボタンを押せるようになっていればOK</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsTrue</span><span class="p">(</span><span class="n">deleteButton</span><span class="p">.</span><span class="n">IsEnabled</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>「次のテストはこれよ。人名の一覧を選択して『削除』ボタンを押すと、そのデータが削除されるけど、リストで何も選択していないときは『削除』ボタンは非活性状態で押せないようになっている――という仕様をテストするためのコードね」<br>
「『ボタンの特定方法２：コントロールに指定されたバインディングから特定』……バインディング対象で取得できるんですか？」<br>
　ササクラは再びMainWindow.xamlを開き、該当の場所を示した。</p>

<div class="code-frame" data-lang="xml"><div class="highlight"><pre><code>            <span class="nt">&lt;Button</span> <span class="na">Command=</span><span class="s">"{Binding DeleteCommand}"</span> <span class="na">Content=</span><span class="s">"削除"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>　削除ボタンの方にはNameプロパティを設定していなかった。セキナにとってこれは単なる書き忘れである。意図があってそうしたわけではなかった。<br>
「削除ボタンにはNameが指定されていないけど、CommandにViewModelの"DeleteCommand"がバインドされているでしょう。Friendlyが提供するByBindingメソッドを使えば、LogicalTreeの中にあるコントロールの中から、バインド対象が"DeleteCommand"になっているコントロールを検索することができるわ。ちなみにLogicalTreeを取得する便利な拡張メソッドがあるから、それを使えば一発よ」<br>
「複数のコントロールが同じ対象にバインドしていた場合はどうなるんです？」<br>
「最後に.Single()を呼び出しているところに注目なさい。つまりlogicalTree.ByBindingの戻り値はコレクションで、LINQを使った絞り込みができるのよ」<br>
「なるほど……必要があれば、さらに条件を追加して検索することができる、と」<br>
「そういうことね」<br>
　ササクラは頷いた。</p>

<h2>
<span id="コントロールの特定方法裏技" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95%E8%A3%8F%E6%8A%80"><i class="fa fa-link"></i></a>コントロールの特定方法（裏技）</h2>

<p>「コントロールの特定方法は２つだけですか？」<br>
「もうひとつあるわ。裏技がね……。クククク」<br>
　ササクラは怪しく笑った。直後、猛烈な勢いでキーボードを叩き、新しいテストコードを書き始めた。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 編集ボタンの活性状態をテスト</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestEditButton_Enable</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// ボタンの特定方法３：相手プロセスでボタンを特定するstaticメソッドを実行する</span>
            <span class="n">WindowsAppExpander</span><span class="p">.</span><span class="nf">LoadAssembly</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="n">Assembly</span><span class="p">);</span> <span class="c1">// ←DLLインジェクション</span>
            <span class="kt">var</span> <span class="n">targetButton</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="nf">Type</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">GetType</span><span class="p">())</span>
                                   <span class="p">.</span><span class="nf">GetButton</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">,</span>
                                              <span class="s">"編集"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">editButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">targetButton</span><span class="p">);</span>

            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsFalse</span><span class="p">(</span><span class="n">editButton</span><span class="p">.</span><span class="n">IsEnabled</span><span class="p">);</span>

            <span class="c1">// リストから選択する操作を実行</span>
            <span class="c1">// DataGridを取得</span>
            <span class="n">AppVar</span> <span class="n">mainVar</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">mainVar</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">dataGrid</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFDataGrid</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"PeopleModel.People"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="c1">// DataGridの最初の行を取得して選択操作をエミュレート</span>
            <span class="kt">var</span> <span class="n">row</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetRow</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">EmulateChangeSelected</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>

            <span class="c1">// 編集ボタンを押せるようになっていればOK</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsTrue</span><span class="p">(</span><span class="n">editButton</span><span class="p">.</span><span class="n">IsEnabled</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 指定されたWindow配下を検索し、指定された文字列とContentが一致するボタンを取得します</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="window"&gt;検索対象となるWindow&lt;/param&gt;</span>
        <span class="c1">/// &lt;param name="label"&gt;検索する文字列&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;一致したボタン&lt;/returns&gt;</span>
        <span class="k">static</span> <span class="n">Button</span> <span class="nf">GetButton</span><span class="p">(</span><span class="n">Window</span> <span class="n">window</span><span class="p">,</span> <span class="kt">string</span> <span class="n">label</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">window</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">Button</span><span class="p">)</span><span class="n">logicalTree</span><span class="p">.</span><span class="n">ByType</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;().</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> 
                <span class="p">{</span>
                    <span class="kt">string</span> <span class="n">content</span> <span class="p">=</span> <span class="n">c</span><span class="p">.</span><span class="n">Content</span> <span class="k">as</span> <span class="kt">string</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">content</span> <span class="p">==</span> <span class="n">label</span><span class="p">;</span>
                <span class="p">});</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>　どうやら今度は「編集」ボタンの活性状態をテストするためのコードらしい。テストメソッドの中に「ボタンの特定方法３：相手プロセスでボタンを特定するstaticメソッドを実行する」の記述を見つけた。<br>
「『相手プロセスで』……？　つまり、あらかじめ名鑑アプリに、ボタンを取得するようなstaticメソッドを用意しておくということですか？」<br>
「もちろんその方法でも取得できるけど、その場合は『テストのためにプロダクトを変更する』ということになって、美しくないわ」<br>
「美しさですか」<br>
「プログラムには美しさが必要よ」<br>
　ササクラが気取って答えた。</p>

<h2>
<span id="dllインジェクション" class="fragment"></span><a href="#dll%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"><i class="fa fa-link"></i></a>DLLインジェクション</h2>

<p>「Friendlyには、テストプロセスにあるstaticメソッドを、プロダクトプロセスの中で実行する機能があるの。つまり、単体テストプロジェクトで定義したstaticメソッドを、名鑑アプリの世界に『送り込んで』、『名鑑アプリの中で実行する』ということね。そのためにはまず、送り込む先のプロセスに、こちらのDLLを読みこませる操作が必要よ」<br>
　ササクラが指で、その場所を示した。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>            <span class="n">WindowsAppExpander</span><span class="p">.</span><span class="nf">LoadAssembly</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="n">Assembly</span><span class="p">);</span> <span class="c1">// ←DLLインジェクション</span>
</code></pre></div></div>

<p>「LoadAssemblyで渡したのは単体テストプロジェクトのDLLよ。こうすれば、以降はこのプロジェクトにあるstaticなメソッドを自由に相手プロセスの中で実行できるわ。こんなふうにね」</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>            <span class="kt">var</span> <span class="n">targetButton</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="nf">Type</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">GetType</span><span class="p">())</span>
                                   <span class="p">.</span><span class="nf">GetButton</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">,</span>
                                              <span class="s">"編集"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">editButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">targetButton</span><span class="p">);</span>
</code></pre></div></div>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 指定されたWindow配下を検索し、指定された文字列とContentが一致するボタンを取得します</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="window"&gt;検索対象となるWindow&lt;/param&gt;</span>
        <span class="c1">/// &lt;param name="label"&gt;検索する文字列&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;一致したボタン&lt;/returns&gt;</span>
        <span class="k">static</span> <span class="n">Button</span> <span class="nf">GetButton</span><span class="p">(</span><span class="n">Window</span> <span class="n">window</span><span class="p">,</span> <span class="kt">string</span> <span class="n">label</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">window</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">Button</span><span class="p">)</span><span class="n">logicalTree</span><span class="p">.</span><span class="n">ByType</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;().</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> 
                <span class="p">{</span>
                    <span class="kt">string</span> <span class="n">content</span> <span class="p">=</span> <span class="n">c</span><span class="p">.</span><span class="n">Content</span> <span class="k">as</span> <span class="kt">string</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">content</span> <span class="p">==</span> <span class="n">label</span><span class="p">;</span>
                <span class="p">});</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>「このGetButtonメソッドは、単体テストプロジェクトに定義されているstaticなメソッドね。見ればわかるけど、ちゃんと引数も与えられるし戻り値も受け取れる。ただし、渡す引数は『シリアライズ可能な型のインスタンスをテストプロジェクトの方から渡す』か、『すでに名鑑アプリの中に存在するインスタンスを指定する』のどちらかである必要があるわ。このコードだと、名鑑アプリの中に存在するMainWidowクラスのインスタンスを引数に渡しているわ」<br>
「すごいですね、これ……相手のプロセスで何でも実行できるなら、困ったら全部これで解決できそうですね」<br>
「まあね。相手のプロセスで実行するのだからプロセス間の壁なんてないし。どこでもお触り自由よ」<br>
「女子高生がそのたとえはどうかと思いますが……」</p>

<h2>
<span id="応用問題" class="fragment"></span><a href="#%E5%BF%9C%E7%94%A8%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>応用問題</h2>

<p>「それじゃ、今まで教えたことの応用ね。名鑑アプリの人名一覧からひとつ選択して『編集』ボタンを押す、そしたら詳細ダイアログが出てきて、そこで『名前』欄を書き換えて『適用』ボタンを押す。すると、最初の人名一覧の名前がちゃんと書き換わっている――というシナリオでテストを書いてみるわ」<br>
　今度のコードは長かった。何度かデバッグモードでテストメソッドを動かして、完成したのがこのコードだった。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 名前を編集できるかテスト</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestEditName</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// テストのシナリオ</span>
            <span class="c1">// 1.リストの先頭を選択</span>
            <span class="c1">// 2.「編集」ボタンをクリック</span>
            <span class="c1">// 3.「名前」テキストボックスを書き換える</span>
            <span class="c1">// 4.「確定」ボタンを押す</span>

            <span class="c1">// 編集ボタンを取得</span>
            <span class="n">AppVar</span> <span class="n">mainVar</span> <span class="p">=</span> <span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">mainVar</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">editButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"EditCommand"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>

            <span class="c1">// 1.リストの先頭を選択</span>
            <span class="kt">var</span> <span class="n">dataGrid</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFDataGrid</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"PeopleModel.People"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="kt">var</span> <span class="n">row</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetRow</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">EmulateChangeSelected</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
            <span class="c1">// 編集対象の名前を退避</span>
            <span class="kt">string</span> <span class="n">name</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetCellText</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>

            <span class="c1">// 2.「編集」ボタンをクリック</span>
            <span class="n">editButton</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">(</span><span class="k">new</span> <span class="nf">Async</span><span class="p">());</span>

            <span class="n">AppVar</span> <span class="n">subWindow</span> <span class="p">=</span> <span class="n">WindowControl</span><span class="p">.</span><span class="nf">IdentifyFromWindowText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="n">name</span> <span class="p">+</span> <span class="s">" - 編集"</span><span class="p">).</span><span class="n">AppVar</span><span class="p">;</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">subWindow</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">subLogicalTree</span> <span class="p">=</span> <span class="n">subWindow</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>


            <span class="c1">// 名前入力テキストボックスを取得</span>
            <span class="kt">var</span> <span class="n">nameTextBox</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFTextBox</span><span class="p">(</span><span class="n">subLogicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"Name.Value"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="c1">// 3.「名前」テキストボックスを書き換える</span>
            <span class="n">nameTextBox</span><span class="p">.</span><span class="nf">EmulateChangeText</span><span class="p">(</span><span class="n">name</span> <span class="p">+</span> <span class="s">"変更後"</span><span class="p">);</span>

            <span class="c1">// 確定ボタンを取得</span>
            <span class="kt">var</span> <span class="n">commitButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">subLogicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"CommitCommand"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="c1">// 4.「確定」ボタンを押す</span>
            <span class="n">commitButton</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">(</span><span class="k">new</span> <span class="nf">Async</span><span class="p">());</span>

            <span class="c1">// ちゃんと名前が書き換わっていることを確認</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="n">name</span> <span class="p">+</span> <span class="s">"変更後"</span><span class="p">,</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetCellText</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">));</span>

            <span class="c1">// ViewModelも書き換わっていることを確認</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="n">name</span> <span class="p">+</span> <span class="s">"変更後"</span><span class="p">,</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="n">_main</span><span class="p">.</span><span class="n">DataContext</span><span class="p">.</span><span class="n">SelectedItem</span><span class="p">.</span><span class="n">Value</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>

            <span class="c1">// ついでにModelが書き換わっていることを確認</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="n">name</span> <span class="p">+</span> <span class="s">"変更後"</span><span class="p">,</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="n">_main</span><span class="p">.</span><span class="n">DataContext</span><span class="p">.</span><span class="n">PeopleModel</span><span class="p">.</span><span class="n">PeopleSource</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">_Name</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>「基本的に、今まで説明した内容をつなぎあわせただけだから、特に説明の必要はないと思うけど」<br>
「WPFDataGridというのは、WPFButtonBaseのDataGrid版ですか」<br>
「そう。前にも言ったけど、WPFの基本的なコントロールについてはラッパークラスが揃っているから、それぞれ必要に応じて使い分ければいいわ」</p>

<h2>
<span id="ユーザーコントロールの特定方法" class="fragment"></span><a href="#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>ユーザーコントロールの特定方法</h2>

<p>「複数のコントロールを組み合わせて作ったみたいなユーザーコントロールについてはどうなんですか？　僕、詳細ダイアログの『年齢』のところは、普通のテキストボックスじゃなくてxceedのtoolkitってライブラリのコントロールを使ってるんですけど……」<br>
　年齢の入力にはXceed.Wpf.Toolkit.IntegerUpDownというクラスを使っていた。これは、数値しか入力できないテキストボックスと、その値をインクリメントしたりデクリメントするためのスピンボタンが１つになったコントロールだ。<br>
「まったくのゼロから標準コントロールを何も使わずに作ったコントロールだとどうしようもないけど、例えば標準のTextBoxを継承して改造したり、ボタンを付けて拡張したりしたくらいなら十分に対応可能よ」</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 年齢をテキストボックスから編集できるかテスト</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestEditAgeByTextBox</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">AppVar</span> <span class="n">mainVar</span> <span class="p">=</span> <span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">mainVar</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">editButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"EditCommand"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>

            <span class="kt">var</span> <span class="n">dataGrid</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFDataGrid</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"PeopleModel.People"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="kt">var</span> <span class="n">row</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetRow</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">EmulateChangeSelected</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
            <span class="kt">string</span> <span class="n">name</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetCellText</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>

            <span class="n">editButton</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">(</span><span class="k">new</span> <span class="nf">Async</span><span class="p">());</span>

            <span class="n">AppVar</span> <span class="n">subWindow</span> <span class="p">=</span> <span class="n">WindowControl</span><span class="p">.</span><span class="nf">IdentifyFromWindowText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="n">name</span> <span class="p">+</span> <span class="s">" - 編集"</span><span class="p">).</span><span class="n">AppVar</span><span class="p">;</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">subWindow</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">subLogicalTree</span> <span class="p">=</span> <span class="n">subWindow</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>

            <span class="c1">// インジェクション</span>
            <span class="c1">// WPFToolKitのIntegerUpDownのように複数の標準コントロールを組み合わせたコントロールは</span>
            <span class="c1">// 取得できないため、VisualTreeからTextBox部分のみを取り出す</span>
            <span class="n">WindowsAppExpander</span><span class="p">.</span><span class="nf">LoadAssembly</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="nf">GetType</span><span class="p">().</span><span class="n">Assembly</span><span class="p">);</span>

            <span class="p">{</span> <span class="c1">//テキストボックスから編集</span>
                <span class="kt">var</span> <span class="n">targetTextBox</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="nf">Type</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">GetType</span><span class="p">())</span>
                                        <span class="p">.</span><span class="nf">GetAgeTextBox</span><span class="p">(</span><span class="n">subWindow</span><span class="p">);</span>
                <span class="kt">var</span> <span class="n">ageTextBox</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFTextBox</span><span class="p">(</span><span class="n">targetTextBox</span><span class="p">);</span>

                <span class="c1">// 年齢を99に変更</span>
                <span class="n">ageTextBox</span><span class="p">.</span><span class="nf">EmulateChangeText</span><span class="p">(</span><span class="s">"99"</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 確定</span>
            <span class="kt">var</span> <span class="n">commitButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">subLogicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"CommitCommand"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="n">commitButton</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">(</span><span class="k">new</span> <span class="nf">Async</span><span class="p">());</span>

            <span class="c1">// ちゃんと年齢が書き換わっていることを確認</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"99"</span><span class="p">,</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetCellText</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 「年齢」のテキストボックス部分のみを取得します</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="window"&gt;詳細ウィンドウ&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;「年齢」のテキストボックス部分&lt;/returns&gt;</span>
        <span class="k">static</span> <span class="n">TextBox</span> <span class="nf">GetAgeTextBox</span><span class="p">(</span><span class="n">Window</span> <span class="n">window</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">window</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="n">DependencyObject</span> <span class="n">IntegerUpDown</span> <span class="p">=</span> <span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"Age.Value"</span><span class="p">).</span><span class="nf">Single</span><span class="p">();</span>

            <span class="c1">// IntegerUpDownのVisualTreeから検索</span>
            <span class="k">return</span> <span class="n">IntegerUpDown</span><span class="p">.</span><span class="n">Descendants</span><span class="p">&lt;</span><span class="n">TextBox</span><span class="p">&gt;().</span><span class="nf">Single</span><span class="p">();</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>「例えばユーザーがキーボードからテキストボックスに文字を入力するシナリオを考えるなら、コントロールの中にあるTextBoxの部分『のみ』を取り出せば十分でしょう。コントロールの中にある部品をどうやって取り出すかは、まあ色々あるけど、相手プロセスに検索用のメソッドを送り込んで、テキストボックスの部分のみを返してもらうのが楽ね。このコードだとstaticなGetAgeTextBoxメソッドを名鑑アプリに送り込んで実行しているわ。IntegerUpDownにはテキストボックスは１つしかないから、TextBoxクラスを継承するコントロールを、VisualTreeの中から探せばいいわ。ちなみにGetAgeTextBoxメソッドの中で使っているDescendantsメソッドというのは、テストクラスで定義している拡張メソッドよ」</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">DependencyObjectExtensions</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// VisualTreeの子要素を取得</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="obj"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">DependencyObject</span><span class="p">&gt;</span> <span class="nf">Children</span><span class="p">(</span><span class="k">this</span> <span class="n">DependencyObject</span> <span class="n">obj</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">obj</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="s">"obj"</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">count</span> <span class="p">=</span> <span class="n">VisualTreeHelper</span><span class="p">.</span><span class="nf">GetChildrenCount</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
                <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">child</span> <span class="p">=</span> <span class="n">VisualTreeHelper</span><span class="p">.</span><span class="nf">GetChild</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">child</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="k">return</span> <span class="n">child</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// VisualTreeの子孫要素を取得</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="obj"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">DependencyObject</span><span class="p">&gt;</span> <span class="nf">Descendants</span><span class="p">(</span><span class="k">this</span> <span class="n">DependencyObject</span> <span class="n">obj</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">obj</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="s">"obj"</span><span class="p">);</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">child</span> <span class="k">in</span> <span class="n">obj</span><span class="p">.</span><span class="nf">Children</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="k">yield</span> <span class="k">return</span> <span class="n">child</span><span class="p">;</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">grandChild</span> <span class="k">in</span> <span class="n">child</span><span class="p">.</span><span class="nf">Descendants</span><span class="p">())</span>
                    <span class="k">yield</span> <span class="k">return</span> <span class="n">grandChild</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 指定した型の子要素を取得</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span class="c1">/// &lt;param name="obj"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Children</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">DependencyObject</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="n">DependencyObject</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">.</span><span class="nf">Children</span><span class="p">().</span><span class="n">OfType</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 指定した型の子孫要素を取得</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span class="c1">/// &lt;param name="obj"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Descendants</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">DependencyObject</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="n">DependencyObject</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">.</span><span class="nf">Descendants</span><span class="p">().</span><span class="n">OfType</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>「やってることは、VisualTreeの子要素を取り出して中身を再帰的に検索してるだけのコードだから説明はしないけど。こういう、VisualTreeの中からメソッドを検索する方法を用意しておくと、標準じゃないコントロールに対するテストも書きやすくなるからおすすめよ」<br>
「上下のスピンボタンも同じように取り出せますね」<br>
「セキナ君、ちょっと書いてみて」<br>
「え、あ、僕がですか？」<br>
　突然命じられてセキナは戸惑った。正直面倒くさいなと思ったが、ここで「できません」というのもちょっと格好悪い。ササクラはすでに一歩横に移動して、セキナにディスプレイの正面に来るようにジェスチャで促していた。<br>
　仕方なく、椅子ごとディスプレイの前に移動して、テスト用の新しいメソッドを作り始めた。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 年齢をスピンボタンから編集できるかテスト</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestEditAgeBySpinButton</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">AppVar</span> <span class="n">mainVar</span> <span class="p">=</span> <span class="n">_app</span><span class="p">.</span><span class="n">Type</span><span class="p">&lt;</span><span class="n">Application</span><span class="p">&gt;().</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">mainVar</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">editButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"EditCommand"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>

            <span class="kt">var</span> <span class="n">dataGrid</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFDataGrid</span><span class="p">(</span><span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"PeopleModel.People"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="kt">var</span> <span class="n">row</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetRow</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">EmulateChangeSelected</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
            <span class="kt">string</span> <span class="n">name</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetCellText</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>

            <span class="c1">// 元の年齢を取得</span>
            <span class="kt">string</span> <span class="n">age</span> <span class="p">=</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetCellText</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>

            <span class="n">editButton</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">(</span><span class="k">new</span> <span class="nf">Async</span><span class="p">());</span>

            <span class="n">AppVar</span> <span class="n">subWindow</span> <span class="p">=</span> <span class="n">WindowControl</span><span class="p">.</span><span class="nf">IdentifyFromWindowText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="n">name</span> <span class="p">+</span> <span class="s">" - 編集"</span><span class="p">).</span><span class="n">AppVar</span><span class="p">;</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">subWindow</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">subLogicalTree</span> <span class="p">=</span> <span class="n">subWindow</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>

            <span class="c1">// インジェクション</span>
            <span class="c1">// WPFToolKitのIntegerUpDownのように複数の標準コントロールを組み合わせたコントロールは</span>
            <span class="c1">// 取得できないため、VisualTreeからTextBox部分のみを取り出す</span>
            <span class="n">WindowsAppExpander</span><span class="p">.</span><span class="nf">LoadAssembly</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">,</span> <span class="nf">GetType</span><span class="p">().</span><span class="n">Assembly</span><span class="p">);</span>

            <span class="p">{</span> <span class="c1">// スピンボタンから編集</span>
                <span class="kt">var</span> <span class="n">targetButtons</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">_app</span><span class="p">.</span><span class="nf">Type</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">GetType</span><span class="p">())</span>
                                        <span class="p">.</span><span class="nf">GetAgeSpinButton</span><span class="p">(</span><span class="n">subWindow</span><span class="p">);</span>
                <span class="kt">var</span> <span class="n">up</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">targetButtons</span><span class="p">.</span><span class="n">Item1</span><span class="p">);</span>
                <span class="kt">var</span> <span class="n">dw</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">targetButtons</span><span class="p">.</span><span class="n">Item2</span><span class="p">);</span>

                <span class="c1">// ５回Upする</span>
                <span class="n">up</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">();</span>
                <span class="n">up</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">();</span>
                <span class="n">up</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">();</span>
                <span class="n">up</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">();</span>
                <span class="n">up</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">();</span>
                <span class="c1">// ２回Downする</span>
                <span class="n">dw</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">();</span>
                <span class="n">dw</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="c1">// 確定</span>
            <span class="kt">var</span> <span class="n">commitButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WPFButtonBase</span><span class="p">(</span><span class="n">subLogicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"CommitCommand"</span><span class="p">).</span><span class="nf">Single</span><span class="p">());</span>
            <span class="n">commitButton</span><span class="p">.</span><span class="nf">EmulateClick</span><span class="p">(</span><span class="k">new</span> <span class="nf">Async</span><span class="p">());</span>

            <span class="c1">// ちゃんと年齢が書き換わっている（元の値から+5、-2されている）ことを確認</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">((</span><span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="p">+</span> <span class="m">5</span> <span class="p">-</span> <span class="m">2</span><span class="p">).</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">,</span> <span class="n">dataGrid</span><span class="p">.</span><span class="nf">GetCellText</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 「年齢」のスピンボタン部分のみを取得します</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="window"&gt;詳細ウィンドウ&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;</span>
        <span class="c1">/// item1：増やす方</span>
        <span class="c1">/// item2：減らす方</span>
        <span class="c1">/// &lt;/returns&gt;</span>
        <span class="k">static</span> <span class="n">Tuple</span><span class="p">&lt;</span><span class="n">ButtonBase</span><span class="p">,</span> <span class="n">ButtonBase</span><span class="p">&gt;</span> <span class="nf">GetAgeSpinButton</span><span class="p">(</span><span class="n">Window</span> <span class="n">window</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">logicalTree</span> <span class="p">=</span> <span class="n">window</span><span class="p">.</span><span class="nf">LogicalTree</span><span class="p">();</span>
            <span class="n">DependencyObject</span> <span class="n">IntegerUpDown</span> <span class="p">=</span> <span class="n">logicalTree</span><span class="p">.</span><span class="nf">ByBinding</span><span class="p">(</span><span class="s">"Age.Value"</span><span class="p">).</span><span class="nf">Single</span><span class="p">();</span>

            <span class="c1">// IntegerUpDownのVisualTreeから検索</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">Tuple</span><span class="p">&lt;</span><span class="n">ButtonBase</span><span class="p">,</span> <span class="n">ButtonBase</span><span class="p">&gt;(</span><span class="n">IntegerUpDown</span><span class="p">.</span><span class="n">Descendants</span><span class="p">&lt;</span><span class="n">ButtonBase</span><span class="p">&gt;().</span><span class="nf">First</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">"PART_IncreaseButton"</span><span class="p">),</span>
                                                     <span class="n">IntegerUpDown</span><span class="p">.</span><span class="n">Descendants</span><span class="p">&lt;</span><span class="n">ButtonBase</span><span class="p">&gt;().</span><span class="nf">First</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">"PART_DecreaseButton"</span><span class="p">));</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>「ええと、IntegerUpDownの中をLINQで検索して……最終的にはVisualTeeの中を覗いて、名前で検索をかけてみました」<br>
　各ボタンの名前はIntegerUpDownの定義から調べたものである。部品の名前が分からないライブラリの場合は、このあたりの処理がもう少し煩雑になるかもしれない。<br>
「それでもいいわね。……とにかく大事なことは、相手プロセスにメソッドを送り込めば、コントロールのVisualTreeやらLogicalTreeやらを検索して、いくらでもやりたいことを実行できるということよ」</p>

<h2>
<span id="終わりに" class="fragment"></span><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>終わりに</h2>

<p>「実は他にも色々説明したいことはあるけど、とりあえずここまでの知識があれば簡単なUIテストはできるはずよ。ちなみに言うと、ここまではずっとWPFのコントロールについての操作をエミュレートしてきたけど、Friendlyはネイティブなウィンドウに対する操作もサポートしているから調べてみるといいわ。Windows標準のメッセージボックスなんかはWPFのコントロールじゃないから、ここまでのやり方じゃ操作できないわよ」<br>
「どうやって調べればいいですか？」<br>
「公式サイトを見に行きなさい。そこそこ丁寧な解説とサンプルコードがあるから。あとFriendlyをテーマにしたAdvent Calendarがまとまっていて便利よ」<br>
「先輩、『テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分』という記事を見つけました！」<br>
「それはただのポエムだから見るだけ時間の無駄よ」</p>

<h2>
<span id="あとがき" class="fragment"></span><a href="#%E3%81%82%E3%81%A8%E3%81%8C%E3%81%8D"><i class="fa fa-link"></i></a>あとがき</h2>

<p>　今回のコードはプロダクトコード、テストコード含めて以下に上げてあります。このポエム読むよりもこっちのコードを直接見る方がわかりやすいと思います。<br>
<a href="https://github.com/anareta/2015AC" rel="nofollow noopener" target="_blank">https://github.com/anareta/2015AC</a><br>
　そしてこのコード見るよりネットで情報探すほうがもっとわか（以下略</p>

<h3>
<span id="なんでこんなの書いたの" class="fragment"></span><a href="#%E3%81%AA%E3%82%93%E3%81%A7%E3%81%93%E3%82%93%E3%81%AA%E3%81%AE%E6%9B%B8%E3%81%84%E3%81%9F%E3%81%AE"><i class="fa fa-link"></i></a>なんでこんなの書いたの？</h3>

<p>　気の迷い。</p>

<h2>
<span id="参考文献" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><i class="fa fa-link"></i></a>参考文献</h2>

<p>Friendly（配布元）<br>
<a href="http://www.codeer.co.jp/AutoTest" rel="nofollow noopener" target="_blank">http://www.codeer.co.jp/AutoTest</a></p>

<p>Friendly Advent Calendar 2014<br>
<a href="http://qiita.com/advent-calendar/2014/friendly">http://qiita.com/advent-calendar/2014/friendly</a></p>

<p>VisualTreeの子孫要素を取得する<br>
<a href="http://blog.xin9le.net/entry/2013/10/29/222336" rel="nofollow noopener" target="_blank">http://blog.xin9le.net/entry/2013/10/29/222336</a></p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FAzleep%2Fitems%2F242a7208f120c5199913&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FAzleep%2Fitems%2F242a7208f120c5199913&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Azleep/items/242a7208f120c5199913/likers" class="css-1iupg5d">33</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">46</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/242a7208f120c5199913/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Azleep/items/242a7208f120c5199913/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Azleep/items/242a7208f120c5199913/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Azleep/items/242a7208f120c5199913/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Azleep/items/242a7208f120c5199913.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-8ddfb745-387a-4864-961c-b2b63d35abea">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-6942db06-e345-45e4-b6d3-5577597dd44b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-6942db06-e345-45e4-b6d3-5577597dd44b">{}</script>
      
<div id="LoginModal-react-component-4a4a9059-009b-42a8-88e1-dac7217afb6b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-4a4a9059-009b-42a8-88e1-dac7217afb6b">{}</script>
      
<div id="StockModal-react-component-8d4d65ba-3af3-40d7-aa41-c7d5b4a50bfd"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-8d4d65ba-3af3-40d7-aa41-c7d5b4a50bfd">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;zpUrxw6adhbGNfuiTcFX5SJVkNfPS13gLzDs8MlhAzqN63CkgNpWGQyy4AvHB0zIp9SAcglA2Cj5cknTiIA19Q==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch2\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h2\u003e\n\n\u003cp\u003e　2015年の暮れに、結合テスト自動化ツール「\u003ca href=\"http://www.codeer.co.jp/AutoTest\" rel=\"nofollow noopener\" target=\"_blank\"\u003eFriendly\u003c/a\u003e」についての小説仕立ての解説記事を内輪向けに書きました。そのまま腐らせておくのももったいないし、もし誰かの参考になるのならと思い、思い切って公開することにしました。\u003cbr\u003e\n　したがって記事の内容は2015年当時のものであり、それ以降はFriendlyの動向もあまり追いかけていないので、\u003cstrong\u003e現時点ですでに情報が古い可能性がある\u003c/strong\u003eことに留意してください。\u003c/p\u003e\n\n\u003cp\u003e　なお、本記事は「\u003ca href=\"http://kenokabe-techwriting.blogspot.jp/2015/04/iq145.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e関数型プログラミングに目覚めた！ IQ145の女子高生の先輩から受けた特訓５日間\u003c/a\u003e」とは一切関係ありません。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"テスト自動化に目覚めた-iq100の女子高生の先輩から受けた特訓３０分\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%AB%E7%9B%AE%E8%A6%9A%E3%82%81%E3%81%9F-iq100%E3%81%AE%E5%A5%B3%E5%AD%90%E9%AB%98%E7%94%9F%E3%81%AE%E5%85%88%E8%BC%A9%E3%81%8B%E3%82%89%E5%8F%97%E3%81%91%E3%81%9F%E7%89%B9%E8%A8%93%EF%BC%93%EF%BC%90%E5%88%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"プロローグ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%AD%E3%83%BC%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロローグ\u003c/h3\u003e\n\n\u003cp\u003e「ずいぶんとダサいコードを書いてるのね」\u003cbr\u003e\n　不意に背後から声をかけられた。セキナが振り向くと白い首筋が目の前にあった。同時に蜂蜜の甘い香りがした。この地方には蜂蜜を髪に塗りこむ風習はないから、これはきっとシャンプーの香りだ。\u003cbr\u003e\n「はっ、ササクラ先輩！」\u003cbr\u003e\n　ササクラ先輩は、セキナの背後から前かがみにモニターを覗き込んでいた。たいして身長の高くない彼女の足はバレリーナのようにつま先立ちで、モニターの文字を目で追いながらプルプルと震えていた。\u003cbr\u003e\n　セキナが椅子を横にずらして場所を譲ると、ササクラ先輩は「ありがとう」と礼を言ってディスプレイの前に陣取った。\u003cbr\u003e\n　放課後のコンピュータ室（かつて電子計算機室と呼ばれていた部屋だ）は、コンピュータ部が自由に使用していいという取り決めがなされていた。今日は他の部員は誰も来ていない。ずっとセキナ一人きりで黙々と作業をしていたのだが、いつのまにか元部長であるササクラが様子を見に来ていたようだ\u003cbr\u003e\n　ちなみにササクラは高校三年生で、今は十二月だからセンター試験まであと一ヶ月もないはずだ。本来はこんなところに顔を出せるほど暇な人ではないのだが。部長の肩書も、二学期に入ってからは二年生の部員に譲られていた。\u003cbr\u003e\n「セキヤ君は何のプロジェクトやってるんだっけ？」\u003cbr\u003e\n「セキナです。今は何もしてません。ちょっと個人的に、WPFを使ってアプリを作ってました。あと先輩、受験大丈夫ですか？」\u003cbr\u003e\n「どんなアプリ？」\u003cbr\u003e\n「ええと、人の名前とか年齢とか誕生日とか、そういうデータを管理するようなアプリです。名鑑ですね」\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/96692b88b7fcd41da0daea2e1d20000731c220f9/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36373035302f63633930386566322d333166662d663831632d376636612d6463656537353166363239322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2Fcc908ef2-31ff-f81c-7f6a-dcee751f6292.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b5e1c1e1d4837b3b683849997cdddbb3\" alt=\"アプリのイメージ.PNG\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/67050/cc908ef2-31ff-f81c-7f6a-dcee751f6292.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2Fcc908ef2-31ff-f81c-7f6a-dcee751f6292.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2d2dc3b024d9da6bccad93ced498bbf7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4a445d1a678ae4cc057a17e1d82611f41c517b26/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f36373035302f32336637353934332d306234392d623465622d366564342d3136333436346232333239342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2F23f75943-0b49-b4eb-6ed4-163464b23294.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2bab7eca959763fceaf2f1ec3c760bf8\" alt=\"追加.PNG\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/67050/23f75943-0b49-b4eb-6ed4-163464b23294.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2F23f75943-0b49-b4eb-6ed4-163464b23294.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cdf9c378b1f191c9f30aac27916334f4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「ふうん。ゴミね」\u003cbr\u003e\n　バッサリ切り捨てられた。\u003cbr\u003e\n「まあ、まだ作りかけなので……。今はベースとなる部分を組み立てているところです。機能追加はあとでやろうと思ってるんで」\u003cbr\u003e\n「さっき後ろから見てたら、ちょっとコードを書くたびにウィンドウを出したりボタンを押したり閉じたりしてたけど、あれは？」\u003cbr\u003e\n「動作確認ですよ。ちょっと改造したら、これまで作った部分がちゃんと動くかどうかを一通り操作して確かめるんです。じゃないと、どこでデグレしたか分からないですからね」\u003cbr\u003e\n「ゴミね。まるでゴミね。ゴミという言葉すらもったいないくらい。喩えるなら……そう、これは……すごく……ゴミね」\u003cbr\u003e\n「『ゴミ』から一歩も外に出てませんけど」\u003cbr\u003e\n　ササクラは語彙が貧弱だった。\u003cbr\u003e\n「セキナ君はVisual Studioでアプリを作っているけど、Visual Studioのテストプロジェクトは知ってる？」\u003cbr\u003e\n「知ってますけど、今のアプリのテストには使えませんよ。データ処理の機能を実装したらそこだけテストできますけど、今はまだUIの部分しか作ってないので」\u003cbr\u003e\n「UI層の単体テストを作ればいいじゃない」\u003cbr\u003e\n「確かに、UIAutomationみたいなUI操作をエミュレートするライブラリを使えば画面操作を自動実行することはできますけど、でもアプリ開発を進めるとすぐにテストが壊れちゃいますし、UI操作で内部の状態がどう変わったかがテスト側で判定できないじゃないですか。それじゃあ総合テストくらいにしか使えないですよ。あとUIテストって、ボタン押すタイミングとかですぐに失敗するし……」\u003cbr\u003e\n「そう、セキナ君はFriendlyを知らないのね」\u003cbr\u003e\n「Friendly？」\u003cbr\u003e\n　聞き慣れない単語だった。ササクラは得意気に頷いた。\u003cbr\u003e\n「教えてあげようか？」\u003cbr\u003e\n「いえ、別に大丈夫です」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e導入\u003c/h2\u003e\n\n\u003cp\u003e「まずは導入方法から。Nugetはもちろん知ってるわね？　Nugetから『Friendly』、『Friendly.Windows』、『Friendly.Windows.Grasp』、『Friendly.WPFStandardControls』を検索するの」\u003cbr\u003e\n「勝手に始めるんですね。……はい、ありました」\u003cbr\u003e\n「それじゃ、ダウンロードボタンをポチっとな」\u003cbr\u003e\n「あんたほんとに女子高生か」\u003cbr\u003e\n　言われたとおり、セキナはテストプロジェクトにFriendly、Friendly.Windows、Friendly.Windows.Grasp、Friendly.WPFStandardControlsのパッケージを追加した。\u003cbr\u003e\n「これ、どういうライブラリなんですか？」\u003cbr\u003e\n「Friendlyはね、実行中の他のプロセスに介入して、外から操作を行うためのライブラリよ」\u003cbr\u003e\n「他のプロセス……？　でもそれって、他のGUIテスト自動化ライブラリでもそうですよね。UIAutomationとか」\u003cbr\u003e\n「そうね。ただ、さっきセキナ君が言った通り、他のプロセスを操作するテストライブラリにはタイミング依存で失敗するという弱点があったわ。テスト対象のプロセス――プロダクトプロセスに対して、OSを介してマウス操作やキーボード入力をエミュレートすることはできても、そのプロセスが入力に対しての処理を完了したかどうかを、テストプロセスから判別する方法がなかったの。だからそういうときは、Thread.Sleepメソッドで一定時間テストプロセスを待機させたりした後に次の処理を行うようにしてたのだけど――」\u003cbr\u003e\n「処理にかかる時間って、マシンやタイミングでも変わりますからね。それに、処理が終わるまで十分な時間をいちいち待機させていたらテストに時間がかかって仕方ないです」\u003cbr\u003e\n「Friendlyはプロダクトプロセスに対して同期的にUI操作をエミュレートできるという利点があるの。だから、UI操作をエミュレートしたとき、その操作に対するプロダクトプロセスの反応が終わったら自動的に次のテスト処理が実行されるわ。それからもうひとつ、Friendlyはプロダクトプロセス内にテストプロセスのメソッドを送り込むという非常に強力な機能を持っている」\u003cbr\u003e\n「送り込む……って、どういう意味ですか？」\u003cbr\u003e\n「そのことは順番に話すとして……まずは基本的な使い方から説明するわ」\u003cbr\u003e\n　そう言うとササクラは、立ったままの状態で、テストプロジェクトのソースファイルにキーボードでコードを打ち始めた。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"プロセスへのアタッチ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%B8%E3%81%AE%E3%82%A2%E3%82%BF%E3%83%83%E3%83%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロセスへのアタッチ\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// Friendly用APPクラス\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eWindowsAppFriend\u003c/span\u003e \u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// テスト対象に存在するMainWindowインスタンス\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003edynamic\u003c/span\u003e \u003cspan class=\"n\"\u003e_main\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// テスト開始前の処理\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// ここで、テスト対象のプロセスにアタッチする\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestInitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestInitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 外部プロセスにアタッチ\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWindowsAppFriend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eProcess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"WPFApp.exe\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// MainWindowを取得\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_main\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e　\"WPFApp.exe\"というのはセキナが作っている名鑑アプリの実行ファイルの名前である。\u003cbr\u003e\n「こんな風に、WindowsAppFriendクラスのコンストラクタにSystem.Diagnostics.Processクラスのインスタンスを渡せば準備完了よ」\u003cbr\u003e\n「『MainWindowを取得』と書いてあるのは？」\u003cbr\u003e\n「Friendlyでは、アタッチしたプロセスの空間にあるStaticなメソッドを自由に呼び出す方法が提供されているの。二つ目に書いた、『MainWindowを取得』の部分は、staticなApplicationクラスのCurrentメソッドを呼び出しているところね」\u003cbr\u003e\n「『アタッチしたプロセスの空間にある』……？」\u003cbr\u003e\n「今ここに書いてあるこのコードが動いているプロセスと、Process.Startで起動したWPFApp.exeが動いているプロセスは別のプロセス……ここまではいいわね？」\u003cbr\u003e\n「何とか」\u003cbr\u003e\n　Process.Startは別プロセスを起動するメソッドだ。単体テストのメソッドで、例えばWPFAppのMainWindowクラスのインスタンスを作る（newする）のとはわけが違う。\u003cbr\u003e\n「テストコードでApplication.Current.MainWindowを呼び出しても、それで呼び出されるのはテストコードが動いているプロセスのApplication.Current.MainWindowでしかない。別のプロセスのstaticメソッドを呼び出す方法はないわ。……普通はね」\u003cbr\u003e\n「Friendlyならそれができる……ですか」\u003cbr\u003e\n「そう。そして、staticなメソッドを呼び出せるということはMainWindowを取得できるということ。MainWindowを取得できるということは、WPFならばそのプロセスに存在するあらゆるオブジェクトにアクセスできるということ。つまり、Friendlyを使えばプロダクトプロセスのすべてを見通すことができるのよ。まさに透視……！　圧倒的透視力……！」\u003cbr\u003e\n　めちゃくちゃ顔を近づけてササクラは言った。頭突きされたらひとたまりもない距離だ。セキナはざわざわした。\u003cbr\u003e\n「この、二つ目のコードの戻り値……_mainフィールドがdynamic型なのはどうしてですか？」\u003cbr\u003e\n「ここで取得したMainWindowクラスのインスタンスへの参照は、あくまでプロダクトプロセス――今回の場合は、単体テストが動いているプロセスとは別のプロセスで動いている\"WPFApp.exe\"の中に存在しているものよ。そして、他プロセスの中に存在するものへは、Friendlyはdynamic型を使うことでアクセスできるようにしているの」\u003cbr\u003e\n「dynamicだとインテリセンスきかないんですけど」\u003cbr\u003e\n「インテリセンスは死んだわ」\u003cbr\u003e\n　真顔で言われた。現実は非情である。\u003cbr\u003e\n「ところで、Friendlyは他プロセスの変数の値をこちら側のプロセスの方に取ってくる機能があるんだけど、それはプロセス間通信を使って実現しているの。例えばWPFApp.exeのMainWindowクラスのTitle属性を、テストプロセスの側にstring型の変数として取得できるわ。ただし、プロセス間通信でやりとりできるものはシリアライズが可能な型だけで、たとえばWindowクラスをそのままテストプロセスにコピーすることはできないわ」\u003cbr\u003e\n「プロセス間通信でやりとりできる型って何ですか？」\u003cbr\u003e\n「intやstring型なんかは普通に取得できるわね。……ところで、このdynamic型の参照――実際にはDynamicAppVar型っていうFriendlyで定義されたクラスなんだけど、それはともかく――これを、例えばintやstringなどの実際の型にキャストした時点で、プロダクトプロセスにあるオブジェクトがコピーされて、テストプロセスに送られてきて実体となるの」\u003cbr\u003e\n　途中からササクラが何を言っているのか分からなくなってきたのでセキナは生返事を返した。それを敏感に察したのか、ササクラも「まあ具体的な書き方については後で見せるわ」と説明を打ち切った。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"たとえばボタンクリックのエミュレート\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9F%E3%81%A8%E3%81%88%E3%81%B0%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eたとえばボタンクリックのエミュレート\u003c/h2\u003e\n\n\u003cp\u003e「それじゃ、まずは簡単なところから――『追加』ボタンを押したときの挙動をテストする場合を考えてみましょうか」\u003cbr\u003e\n　ササクラは顔をディスプレイに向けるとものすごいスピードでコードをタイプし始めた。タイプしながらセキナに対して言葉で説明する。\u003cbr\u003e\n「『追加』ボタンを押すと、データを追加するためのダイアログが出てくる――ダイアログが出てくるのを確認するためのテストを書く、という想定で考えてみるわ。こんな感じかしら」\u003cbr\u003e\n　ササクラは体をディスプレイの前から動かし、セキナにコードを見るように促した。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 「追加」ボタンを押すと項目の追加画面が出てくるかどうかをテスト\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestAddButton\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// ボタンを押す前は、Windowは１つだけなのを確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ボタンの特定方法１：コントロールに指定された\"Name\"から特定\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ebuttonAdd\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_main\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eaddButton\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// クリック操作を非同期でエミュレート\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAsync\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebuttonAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 詳細ウィンドウが出てきたのを確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// \"新規追加\"というタイトルのウィンドウが見つからなかったらNG\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNotNull\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindowControl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIdentifyFromWindowText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"新規追加\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「WPFButtonBaseというのは、Friendlyでボタンを扱うためのラッパークラスのようなもので……このクラスを介して、例えばボタンならクリック操作をエミュレートすることができるわ。『Friendly.WPFStandardControls』にはButton以外にもTextBoxやDataGridのようなコントロールへの操作をエミュレートするクラスが揃っているの」\u003cbr\u003e\n　ButtonBase、という名前が気になったが、よく考えればButtonクラスの基底クラスがButtonBaseクラスだったはずだ。つまり、ButtonBaseクラスを継承して作った（標準のButtonを拡張するような）独自のコントロールに対してもWPFButtonBaseが使えるということだ。\u003cbr\u003e\n　ササクラが、メソッドの最後の方をディスプレイの上から指で押さえた。\u003cbr\u003e\n「このテストメソッドの最後、\"新規追加\"ウィンドウを取得しているところで使っているWindowControlクラスは、Windowクラスのラッパーみたいなものね。これは『Friendly.Windows.Grasp』の方にあるクラスよ。『Friendly.Windows.Grasp』にはウィンドウに対する操作を楽にするためのクラスが揃っているわ。ちなみにこれ、タイトルの文字列でウィンドウを特定しているけど、他にもクラス名や、トップレベルにあるウィンドウを取得、なんてこともできるわ」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コントロールの特定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコントロールの特定\u003c/h2\u003e\n\n\u003cp\u003e「ここのコメントのところに『ボタンの特定方法１：コントロールに指定された\"Name\"から特定』……って書いてあるのは？」\u003cbr\u003e\n「まず、WPFButtonBaseクラスのコンストラクタにはAppVarのインスタンスを渡すことになっているのね」\u003cbr\u003e\n「AppVarクラスって何ですか？」\u003cbr\u003e\n「プロダクトプロセスに存在している変数への参照を意味するクラスね。上の方でちょっと教えたDynamicAppVarクラスと同じようなものよ。プロダクトプロセスに存在している変数はすべてAppVar型かDynamicAppVar型になるわけ。OK？」\u003cbr\u003e\n「えーっと……AppVar型とDynamicAppVar型の違いは何ですか？」\u003cbr\u003e\n「意味は同じよ。違いといえば、DynamicAppVar型はdynamic型になるというくらい。AppVar型は操作するのがちょっと面倒なの。だから、AppVar型のインスタンスを操作しやすくるために、後からDynamicAppVar型がFriendlyに追加されたの」\u003cbr\u003e\n「なるほど。OKです」\u003cbr\u003e\n「さて問題はWindowからControlのインスタンスをどうやって取ってくるか。一番簡単な方法は、Viewを定義するときにNameプロパティを設定して、Windowクラスからコントロールのフィールドの名前を指定してアクセスする方法よ。ほら、MainWindowのUIの定義を見ると、追加ボタンには\"addButton\"という名前がついているでしょう」\u003cbr\u003e\n　ササクラはMainWindow.xamlを開いて指で示した。すなわちこれは、セキナがさっきまで書いていた、WPFAppのコードだ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e            \u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e \u003cspan class=\"na\"\u003eName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"addButton\"\u003c/span\u003e\n                    \u003cspan class=\"na\"\u003eCommand=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding AddCommand}\"\u003c/span\u003e\n                    \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"追加\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「じゃ、さっそくこれを実行してみましょうか」\u003cbr\u003e\n　ササクラはマウスを操作して、単体テスト\"TestAddButton\"を実行した。一瞬で名鑑アプリのウィンドウが立ち上がると、データ追加用のサブウィンドウが開いた、ように見えた。すぐに親ウィンドウごと名鑑アプリは終了した。テスト結果を見ると、「テスト 成功」の文字があった。\u003cbr\u003e\n「おお、すごい。勝手に起動した」\u003cbr\u003e\n「UIテストなんだから当たり前でしょう」\u003cbr\u003e\n　ササクラは冷めた反応を返した。\u003cbr\u003e\n「『クリック操作を非同期でエミュレート』というのは？　同期的にエミュレートできないんですか？」\u003cbr\u003e\n「できるけど、『追加』ボタンを押すとウィンドウが出てくるでしょう？　このボタンを同期的にエミュレートすると、このウィンドウが閉じるまで制御が戻ってくれないの。もちろん、Asyncクラスのインスタンスを引数に渡さなければ同期的にエミュレートされるから、ちゃんと制御が戻るならわざわざ同期的に呼び出す必要はないわ」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"バインドからコントロールの特定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%90%E3%82%A4%E3%83%B3%E3%83%89%E3%81%8B%E3%82%89%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eバインドからコントロールの特定\u003c/h2\u003e\n\n\u003cp\u003e「まあとにかく、こんな風に『ボタンを押す』と『ウィンドウが出てくる』という仕様をテストすることができるわ」\u003cbr\u003e\n「『ボタンの特定方法１』って書いてますけど、『ボタンの特定方法２』はあるんですか？」\u003cbr\u003e\n「せっかちね。せっかちな男は嫌いよ」\u003cbr\u003e\n「じゃあ質問を撤回します」\u003cbr\u003e\n「のんびりした男はもっと嫌いよ」\u003cbr\u003e\n　軽口を叩いている間も、ササクラは休むことなくキーボードを叩いていた。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 削除ボタンの活性状態をテスト\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestDeleteButton_Enable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 未選択状態のときは削除ボタンを押せないことをテスト\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ボタンの特定方法２：コントロールに指定されたバインディングから特定\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edeleteButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"DeleteCommand\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edeleteButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// リストから選択する操作を実行\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// DataGridを取得\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFDataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PeopleModel.People\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// DataGridの最初の行を取得して選択操作をエミュレート\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateChangeSelected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 削除ボタンを押せるようになっていればOK\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edeleteButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「次のテストはこれよ。人名の一覧を選択して『削除』ボタンを押すと、そのデータが削除されるけど、リストで何も選択していないときは『削除』ボタンは非活性状態で押せないようになっている――という仕様をテストするためのコードね」\u003cbr\u003e\n「『ボタンの特定方法２：コントロールに指定されたバインディングから特定』……バインディング対象で取得できるんですか？」\u003cbr\u003e\n　ササクラは再びMainWindow.xamlを開き、該当の場所を示した。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"xml\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e            \u003cspan class=\"nt\"\u003e\u0026lt;Button\u003c/span\u003e \u003cspan class=\"na\"\u003eCommand=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"{Binding DeleteCommand}\"\u003c/span\u003e \u003cspan class=\"na\"\u003eContent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"削除\"\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e　削除ボタンの方にはNameプロパティを設定していなかった。セキナにとってこれは単なる書き忘れである。意図があってそうしたわけではなかった。\u003cbr\u003e\n「削除ボタンにはNameが指定されていないけど、CommandにViewModelの\"DeleteCommand\"がバインドされているでしょう。Friendlyが提供するByBindingメソッドを使えば、LogicalTreeの中にあるコントロールの中から、バインド対象が\"DeleteCommand\"になっているコントロールを検索することができるわ。ちなみにLogicalTreeを取得する便利な拡張メソッドがあるから、それを使えば一発よ」\u003cbr\u003e\n「複数のコントロールが同じ対象にバインドしていた場合はどうなるんです？」\u003cbr\u003e\n「最後に.Single()を呼び出しているところに注目なさい。つまりlogicalTree.ByBindingの戻り値はコレクションで、LINQを使った絞り込みができるのよ」\u003cbr\u003e\n「なるほど……必要があれば、さらに条件を追加して検索することができる、と」\u003cbr\u003e\n「そういうことね」\u003cbr\u003e\n　ササクラは頷いた。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コントロールの特定方法裏技\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95%E8%A3%8F%E6%8A%80\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコントロールの特定方法（裏技）\u003c/h2\u003e\n\n\u003cp\u003e「コントロールの特定方法は２つだけですか？」\u003cbr\u003e\n「もうひとつあるわ。裏技がね……。クククク」\u003cbr\u003e\n　ササクラは怪しく笑った。直後、猛烈な勢いでキーボードを叩き、新しいテストコードを書き始めた。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 編集ボタンの活性状態をテスト\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestEditButton_Enable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// ボタンの特定方法３：相手プロセスでボタンを特定するstaticメソッドを実行する\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWindowsAppExpander\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ←DLLインジェクション\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etargetButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n                                   \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                              \u003cspan class=\"s\"\u003e\"編集\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// リストから選択する操作を実行\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// DataGridを取得\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFDataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PeopleModel.People\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// DataGridの最初の行を取得して選択操作をエミュレート\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateChangeSelected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 編集ボタンを押せるようになっていればOK\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIsEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 指定されたWindow配下を検索し、指定された文字列とContentが一致するボタンを取得します\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"window\"\u0026gt;検索対象となるWindow\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"label\"\u0026gt;検索する文字列\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;一致したボタン\u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eButton\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindow\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003elabel\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eButton\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eByType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eButton\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirstOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContent\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003elabel\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e　どうやら今度は「編集」ボタンの活性状態をテストするためのコードらしい。テストメソッドの中に「ボタンの特定方法３：相手プロセスでボタンを特定するstaticメソッドを実行する」の記述を見つけた。\u003cbr\u003e\n「『相手プロセスで』……？　つまり、あらかじめ名鑑アプリに、ボタンを取得するようなstaticメソッドを用意しておくということですか？」\u003cbr\u003e\n「もちろんその方法でも取得できるけど、その場合は『テストのためにプロダクトを変更する』ということになって、美しくないわ」\u003cbr\u003e\n「美しさですか」\u003cbr\u003e\n「プログラムには美しさが必要よ」\u003cbr\u003e\n　ササクラが気取って答えた。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"dllインジェクション\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#dll%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eDLLインジェクション\u003c/h2\u003e\n\n\u003cp\u003e「Friendlyには、テストプロセスにあるstaticメソッドを、プロダクトプロセスの中で実行する機能があるの。つまり、単体テストプロジェクトで定義したstaticメソッドを、名鑑アプリの世界に『送り込んで』、『名鑑アプリの中で実行する』ということね。そのためにはまず、送り込む先のプロセスに、こちらのDLLを読みこませる操作が必要よ」\u003cbr\u003e\n　ササクラが指で、その場所を示した。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e            \u003cspan class=\"n\"\u003eWindowsAppExpander\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ←DLLインジェクション\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「LoadAssemblyで渡したのは単体テストプロジェクトのDLLよ。こうすれば、以降はこのプロジェクトにあるstaticなメソッドを自由に相手プロセスの中で実行できるわ。こんなふうにね」\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etargetButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n                                   \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                              \u003cspan class=\"s\"\u003e\"編集\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 指定されたWindow配下を検索し、指定された文字列とContentが一致するボタンを取得します\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"window\"\u0026gt;検索対象となるWindow\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"label\"\u0026gt;検索する文字列\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;一致したボタン\u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eButton\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindow\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003elabel\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eButton\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eByType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eButton\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirstOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eContent\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003elabel\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「このGetButtonメソッドは、単体テストプロジェクトに定義されているstaticなメソッドね。見ればわかるけど、ちゃんと引数も与えられるし戻り値も受け取れる。ただし、渡す引数は『シリアライズ可能な型のインスタンスをテストプロジェクトの方から渡す』か、『すでに名鑑アプリの中に存在するインスタンスを指定する』のどちらかである必要があるわ。このコードだと、名鑑アプリの中に存在するMainWidowクラスのインスタンスを引数に渡しているわ」\u003cbr\u003e\n「すごいですね、これ……相手のプロセスで何でも実行できるなら、困ったら全部これで解決できそうですね」\u003cbr\u003e\n「まあね。相手のプロセスで実行するのだからプロセス間の壁なんてないし。どこでもお触り自由よ」\u003cbr\u003e\n「女子高生がそのたとえはどうかと思いますが……」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"応用問題\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BF%9C%E7%94%A8%E5%95%8F%E9%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e応用問題\u003c/h2\u003e\n\n\u003cp\u003e「それじゃ、今まで教えたことの応用ね。名鑑アプリの人名一覧からひとつ選択して『編集』ボタンを押す、そしたら詳細ダイアログが出てきて、そこで『名前』欄を書き換えて『適用』ボタンを押す。すると、最初の人名一覧の名前がちゃんと書き換わっている――というシナリオでテストを書いてみるわ」\u003cbr\u003e\n　今度のコードは長かった。何度かデバッグモードでテストメソッドを動かして、完成したのがこのコードだった。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 名前を編集できるかテスト\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestEditName\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// テストのシナリオ\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 1.リストの先頭を選択\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 2.「編集」ボタンをクリック\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 3.「名前」テキストボックスを書き換える\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 4.「確定」ボタンを押す\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 編集ボタンを取得\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"EditCommand\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 1.リストの先頭を選択\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFDataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PeopleModel.People\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateChangeSelected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 編集対象の名前を退避\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCellText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 2.「編集」ボタンをクリック\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowControl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIdentifyFromWindowText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" - 編集\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNotNull\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esubLogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n\n            \u003cspan class=\"c1\"\u003e// 名前入力テキストボックスを取得\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enameTextBox\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Name.Value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 3.「名前」テキストボックスを書き換える\u003c/span\u003e\n            \u003cspan class=\"n\"\u003enameTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateChangeText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"変更後\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 確定ボタンを取得\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecommitButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CommitCommand\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 4.「確定」ボタンを押す\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecommitButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ちゃんと名前が書き換わっていることを確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"変更後\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCellText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ViewModelも書き換わっていることを確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"変更後\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_main\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDataContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSelectedItem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ついでにModelが書き換わっていることを確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"変更後\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_main\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDataContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePeopleModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePeopleSource\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003e_Name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「基本的に、今まで説明した内容をつなぎあわせただけだから、特に説明の必要はないと思うけど」\u003cbr\u003e\n「WPFDataGridというのは、WPFButtonBaseのDataGrid版ですか」\u003cbr\u003e\n「そう。前にも言ったけど、WPFの基本的なコントロールについてはラッパークラスが揃っているから、それぞれ必要に応じて使い分ければいいわ」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ユーザーコントロールの特定方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eユーザーコントロールの特定方法\u003c/h2\u003e\n\n\u003cp\u003e「複数のコントロールを組み合わせて作ったみたいなユーザーコントロールについてはどうなんですか？　僕、詳細ダイアログの『年齢』のところは、普通のテキストボックスじゃなくてxceedのtoolkitってライブラリのコントロールを使ってるんですけど……」\u003cbr\u003e\n　年齢の入力にはXceed.Wpf.Toolkit.IntegerUpDownというクラスを使っていた。これは、数値しか入力できないテキストボックスと、その値をインクリメントしたりデクリメントするためのスピンボタンが１つになったコントロールだ。\u003cbr\u003e\n「まったくのゼロから標準コントロールを何も使わずに作ったコントロールだとどうしようもないけど、例えば標準のTextBoxを継承して改造したり、ボタンを付けて拡張したりしたくらいなら十分に対応可能よ」\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 年齢をテキストボックスから編集できるかテスト\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestEditAgeByTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"EditCommand\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFDataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PeopleModel.People\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateChangeSelected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCellText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowControl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIdentifyFromWindowText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" - 編集\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNotNull\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esubLogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// インジェクション\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// WPFToolKitのIntegerUpDownのように複数の標準コントロールを組み合わせたコントロールは\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 取得できないため、VisualTreeからTextBox部分のみを取り出す\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWindowsAppExpander\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e//テキストボックスから編集\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etargetTextBox\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n                                        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAgeTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eageTextBox\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// 年齢を99に変更\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eageTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateChangeText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"99\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 確定\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecommitButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CommitCommand\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecommitButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ちゃんと年齢が書き換わっていることを確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"99\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCellText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 「年齢」のテキストボックス部分のみを取得します\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"window\"\u0026gt;詳細ウィンドウ\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;「年齢」のテキストボックス部分\u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eTextBox\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetAgeTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindow\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003eIntegerUpDown\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Age.Value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// IntegerUpDownのVisualTreeから検索\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eIntegerUpDown\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTextBox\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「例えばユーザーがキーボードからテキストボックスに文字を入力するシナリオを考えるなら、コントロールの中にあるTextBoxの部分『のみ』を取り出せば十分でしょう。コントロールの中にある部品をどうやって取り出すかは、まあ色々あるけど、相手プロセスに検索用のメソッドを送り込んで、テキストボックスの部分のみを返してもらうのが楽ね。このコードだとstaticなGetAgeTextBoxメソッドを名鑑アプリに送り込んで実行しているわ。IntegerUpDownにはテキストボックスは１つしかないから、TextBoxクラスを継承するコントロールを、VisualTreeの中から探せばいいわ。ちなみにGetAgeTextBoxメソッドの中で使っているDescendantsメソッドというのは、テストクラスで定義している拡張メソッドよ」\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDependencyObjectExtensions\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// VisualTreeの子要素を取得\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"obj\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eChildren\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eArgumentNullException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"obj\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eVisualTreeHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetChildrenCount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecount\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e++)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003echild\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eVisualTreeHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetChild\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echild\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003echild\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// VisualTreeの子孫要素を取得\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"obj\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eArgumentNullException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"obj\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003echild\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eChildren\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003echild\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003egrandChild\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003echild\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003egrandChild\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 指定した型の子要素を取得\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;typeparam name=\"T\"\u0026gt;\u0026lt;/typeparam\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"obj\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eChildren\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewhere\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eChildren\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eOfType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 指定した型の子孫要素を取得\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;typeparam name=\"T\"\u0026gt;\u0026lt;/typeparam\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"obj\"\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIEnumerable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewhere\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eOfType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「やってることは、VisualTreeの子要素を取り出して中身を再帰的に検索してるだけのコードだから説明はしないけど。こういう、VisualTreeの中からメソッドを検索する方法を用意しておくと、標準じゃないコントロールに対するテストも書きやすくなるからおすすめよ」\u003cbr\u003e\n「上下のスピンボタンも同じように取り出せますね」\u003cbr\u003e\n「セキナ君、ちょっと書いてみて」\u003cbr\u003e\n「え、あ、僕がですか？」\u003cbr\u003e\n　突然命じられてセキナは戸惑った。正直面倒くさいなと思ったが、ここで「できません」というのもちょっと格好悪い。ササクラはすでに一歩横に移動して、セキナにディスプレイの正面に来るようにジェスチャで促していた。\u003cbr\u003e\n　仕方なく、椅子ごとディスプレイの前に移動して、テスト用の新しいメソッドを作り始めた。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 年齢をスピンボタンから編集できるかテスト\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eTestMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eTestEditAgeBySpinButton\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emainVar\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"EditCommand\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFDataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"PeopleModel.People\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateChangeSelected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCellText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 元の年齢を取得\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCellText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eeditButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e \u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eWindowControl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIdentifyFromWindowText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\" - 編集\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eAppVar\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNotNull\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003esubLogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// インジェクション\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// WPFToolKitのIntegerUpDownのように複数の標準コントロールを組み合わせたコントロールは\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// 取得できないため、VisualTreeからTextBox部分のみを取り出す\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWindowsAppExpander\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLoadAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003eAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e// スピンボタンから編集\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etargetButtons\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_app\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n                                        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAgeSpinButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eup\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetButtons\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edw\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etargetButtons\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eItem2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// ５回Upする\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// ２回Downする\u003c/span\u003e\n                \u003cspan class=\"n\"\u003edw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003edw\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 確定\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ecommitButton\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eWPFButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"CommitCommand\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecommitButton\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEmulateClick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// ちゃんと年齢が書き換わっている（元の値から+5、-2されている）ことを確認\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAssert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAreEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eage\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edataGrid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCellText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// 「年齢」のスピンボタン部分のみを取得します\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/summary\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;param name=\"window\"\u0026gt;詳細ウィンドウ\u0026lt;/param\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// item1：増やす方\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// item2：減らす方\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e/// \u0026lt;/returns\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetAgeSpinButton\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindow\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eLogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDependencyObject\u003c/span\u003e \u003cspan class=\"n\"\u003eIntegerUpDown\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elogicalTree\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByBinding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Age.Value\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// IntegerUpDownのVisualTreeから検索\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eTuple\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003eIntegerUpDown\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"PART_IncreaseButton\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                                                     \u003cspan class=\"n\"\u003eIntegerUpDown\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDescendants\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eButtonBase\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;().\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\"PART_DecreaseButton\"\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e「ええと、IntegerUpDownの中をLINQで検索して……最終的にはVisualTeeの中を覗いて、名前で検索をかけてみました」\u003cbr\u003e\n　各ボタンの名前はIntegerUpDownの定義から調べたものである。部品の名前が分からないライブラリの場合は、このあたりの処理がもう少し煩雑になるかもしれない。\u003cbr\u003e\n「それでもいいわね。……とにかく大事なことは、相手プロセスにメソッドを送り込めば、コントロールのVisualTreeやらLogicalTreeやらを検索して、いくらでもやりたいことを実行できるということよ」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"終わりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e終わりに\u003c/h2\u003e\n\n\u003cp\u003e「実は他にも色々説明したいことはあるけど、とりあえずここまでの知識があれば簡単なUIテストはできるはずよ。ちなみに言うと、ここまではずっとWPFのコントロールについての操作をエミュレートしてきたけど、Friendlyはネイティブなウィンドウに対する操作もサポートしているから調べてみるといいわ。Windows標準のメッセージボックスなんかはWPFのコントロールじゃないから、ここまでのやり方じゃ操作できないわよ」\u003cbr\u003e\n「どうやって調べればいいですか？」\u003cbr\u003e\n「公式サイトを見に行きなさい。そこそこ丁寧な解説とサンプルコードがあるから。あとFriendlyをテーマにしたAdvent Calendarがまとまっていて便利よ」\u003cbr\u003e\n「先輩、『テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分』という記事を見つけました！」\u003cbr\u003e\n「それはただのポエムだから見るだけ時間の無駄よ」\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"あとがき\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%81%A8%E3%81%8C%E3%81%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあとがき\u003c/h2\u003e\n\n\u003cp\u003e　今回のコードはプロダクトコード、テストコード含めて以下に上げてあります。このポエム読むよりもこっちのコードを直接見る方がわかりやすいと思います。\u003cbr\u003e\n\u003ca href=\"https://github.com/anareta/2015AC\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/anareta/2015AC\u003c/a\u003e\u003cbr\u003e\n　そしてこのコード見るよりネットで情報探すほうがもっとわか（以下略\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"なんでこんなの書いたの\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AA%E3%82%93%E3%81%A7%E3%81%93%E3%82%93%E3%81%AA%E3%81%AE%E6%9B%B8%E3%81%84%E3%81%9F%E3%81%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eなんでこんなの書いたの？\u003c/h3\u003e\n\n\u003cp\u003e　気の迷い。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考文献\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考文献\u003c/h2\u003e\n\n\u003cp\u003eFriendly（配布元）\u003cbr\u003e\n\u003ca href=\"http://www.codeer.co.jp/AutoTest\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://www.codeer.co.jp/AutoTest\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFriendly Advent Calendar 2014\u003cbr\u003e\n\u003ca href=\"http://qiita.com/advent-calendar/2014/friendly\"\u003ehttp://qiita.com/advent-calendar/2014/friendly\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVisualTreeの子孫要素を取得する\u003cbr\u003e\n\u003ca href=\"http://blog.xin9le.net/entry/2013/10/29/222336\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://blog.xin9le.net/entry/2013/10/29/222336\u003c/a\u003e\u003c/p\u003e\n","createdAt":"2016-12-27T15:05:28Z","elapsedYearsFromLastModifiedAt":4,"encryptedId":"PbJTFjuOn+nE2SSba0uEK2sqESQs6gS6--oyIteskG8bbc3iCv--oLrF8f3bgHajZbQxC2WyrA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2017-01-04T01:51:57Z","likesCount":33,"linkUrl":"https://qiita.com/Azleep/items/242a7208f120c5199913","organization":null,"originalId":455950,"stockedCount":46,"title":"テスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E8%87%AA%E5%8B%95%E5%8C%96%E3%81%AB%E7%9B%AE%E8%A6%9A%E3%82%81%E3%81%9F-iq100%E3%81%AE%E5%A5%B3%E5%AD%90%E9%AB%98%E7%94%9F%E3%81%AE%E5%85%88%E8%BC%A9%E3%81%8B%E3%82%89%E5%8F%97%E3%81%91%E3%81%9F%E7%89%B9%E8%A8%93%EF%BC%93%EF%BC%90%E5%88%86\"\u003eテスト自動化に目覚めた！ IQ100の女子高生の先輩から受けた特訓３０分\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%AD%E3%83%BC%E3%82%B0\"\u003eプロローグ\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%B0%8E%E5%85%A5\"\u003e導入\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%B8%E3%81%AE%E3%82%A2%E3%82%BF%E3%83%83%E3%83%81\"\u003eプロセスへのアタッチ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%9F%E3%81%A8%E3%81%88%E3%81%B0%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%88\"\u003eたとえばボタンクリックのエミュレート\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A\"\u003eコントロールの特定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%90%E3%82%A4%E3%83%B3%E3%83%89%E3%81%8B%E3%82%89%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A\"\u003eバインドからコントロールの特定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95%E8%A3%8F%E6%8A%80\"\u003eコントロールの特定方法（裏技）\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#dll%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3\"\u003eDLLインジェクション\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%BF%9C%E7%94%A8%E5%95%8F%E9%A1%8C\"\u003e応用問題\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95\"\u003eユーザーコントロールの特定方法\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e終わりに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%82%E3%81%A8%E3%81%8C%E3%81%8D\"\u003eあとがき\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AA%E3%82%93%E3%81%A7%E3%81%93%E3%82%93%E3%81%AA%E3%81%AE%E6%9B%B8%E3%81%84%E3%81%9F%E3%81%AE\"\u003eなんでこんなの書いたの？\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e参考文献\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":8043,"uuid":"242a7208f120c5199913","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"cKrTILWT7678R7MBT7eoYkvpBh4=--eNuknujjqYzN5E+x--SZVmt7QzKwnlKCjiUsrxdw==","originalId":67050,"description":"C#/WPFやってる物書き志望IT土方。","facebookUrl":null,"githubUrl":"https://github.com/anareta","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/67050/profile-images/1551460335","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2Fprofile-images%2F1551460335?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=4e174453b5a7081492657909ab773a88","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F67050%2Fprofile-images%2F1551460335?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=1cde60e09ba9f6556ef25d307bbee87b","urlName":"Azleep","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"WPF","urlName":"wpf"},{"name":"Friendly","urlName":"friendly"},{"name":"自動化ポエム","urlName":"%e8%87%aa%e5%8b%95%e5%8c%96%e3%83%9d%e3%82%a8%e3%83%a0"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
