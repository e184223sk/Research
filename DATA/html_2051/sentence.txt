More than 1 year has passed since last update.Unityでラジオボタンを作るときに活躍するToggleGroup。
複数のToggleをグルーピングして、選択Toggleを択一（排他）にする機能を提供してくれます。ところがこのToggleGroup、少し曲者です。
というのも、管理しているすべてのToggleを知る手段を提供していないのです。1これは特に問題にならないことも多いですが、例えば、ToggleGroupから選択肢一覧を知りたいときなどに困ります。（結局自分で別管理することになったり…。）
今回はそんなときにどうするのがよいか、考えてみます。主に2つの方法が考えられます。Toggleはgroupという自身が所属するToggleGroupを表すプロパティをもっています。
それならば、シーンにあるToggleを集めてそのgroupを調べればいい…。例として下記のようなコードで実現できます。この取り方はToggleGroupからのアプローチでない故の分かりにくさが欠点かもしれません。
あとは検索コストがかかるため少し無駄を感じます。無理やり何とかしたいときの常套、リフレクションです。
実はuGUIのソースコードはBitbucketで公開されているため、内部でどうToggleをもっているかを知ることができます。
該当のソースコードを見てみるとList&lt;Toggle&gt;型のm_Togglesという名前でprivateフィールドでもっていることが分かりました。フィールド名が分かってしまえば、下記のような拡張メソッドを作ることでいけます。2使うときはこんな感じになります。なお、注意点として、リフレクションの性質上ToggleGroupの内部実装が変わると互換性を失う可能性があります。今回紹介した方法はどちらも素直なやり方という感じはしませんね。
どうせ機能拡張などを見越しているなら、自分でToggleGroupに代わる実装するのがベストなのかもしれません。（中身見れるので参考にもできますしね…。）もちろん選択されているToggleは取得できます（ActiveToggles）。でもなんで戻り値が単一じゃなくコレクションなんだろう…？ ↩本当はToggleGroup.togglesのようにプロパティで書きたいところですが、現時点（C#7.3）には拡張プロパティはないらしいです。 ↩


