<!DOCTYPE html><html><head><meta charset="utf-8" /><title>[C#] Unsafeクラスの各メソッドを簡易解説(逆引き) - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/kenichiuda/items/ce3518c36fe83063a5d9" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="xj2BIXUcBRf6crEkR/hlLZLGE+VXwGsVpEZCHOM1wT0k87lgdp80oiET5kxQOhDKTkH/rgHTe2MdzhNIC4AoDA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="[C#] Unsafeクラスの各メソッドを簡易解説(逆引き) - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XME1qWFNCVmJuTmhabVhqZ3Ffamc2bmpncm5qZ2E3bGtJVGpnNkhqZ3Izamc0UGpnNG5qZ3BMbnNLSG1tSlBvcDZQb3Fxd282WUNHNWJ5VjQ0R05LUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1lNzk4N2Q4MDliYmZkMjM1MGZjMWQ5M2UzMmQ4YmJlYw&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RsYm1samFHbDFaR0UmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1lNzkwMzdmODdkMjg5MzY0MzFlMWYxN2UwOGRiYmVmNw&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=403cdf20748d5c53f2c9d72ea1eb2a81"><meta property="og:description" content="System.Runtime.CompilerServices.Unsafe クラスは一部で大変便利なのですが、ドキュメントを見ても動作が分かりにくいことが多いので、実際のILとC#へ逆コンパイルした結果を併記して簡易解説(メモ)しま..."><meta content="https://qiita.com/kenichiuda/items/ce3518c36fe83063a5d9" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-4eb6c8fb-ce6f-4934-b62b-d8748931429f"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fkenichiuda%2Fitems%2Fce3518c36fe83063a5d9">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fkenichiuda%2Fitems%2Fce3518c36fe83063a5d9">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-4eb6c8fb-ce6f-4934-b62b-d8748931429f">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-07-12T16:52:19.000+09:00","dateModified":"2020-07-29T19:41:09.000+09:00","headline":"[C#] Unsafeクラスの各メソッドを簡易解説(逆引き)","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1XME1qWFNCVmJuTmhabVhqZ3Ffamc2bmpncm5qZ2E3bGtJVGpnNkhqZ3Izamc0UGpnNG5qZ3BMbnNLSG1tSlBvcDZQb3Fxd282WUNHNWJ5VjQ0R05LUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz1lNzk4N2Q4MDliYmZkMjM1MGZjMWQ5M2UzMmQ4YmJlYw\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RR3RsYm1samFHbDFaR0UmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz1lNzkwMzdmODdkMjg5MzY0MzFlMWYxN2UwOGRiYmVmNw\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=403cdf20748d5c53f2c9d72ea1eb2a81","mainEntityOfPage":"https://qiita.com/kenichiuda/items/ce3518c36fe83063a5d9","author":{"@type":"Person","address":"","email":null,"identifier":"kenichiuda","name":"kenichiuda","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124276%2Fprofile-images%2F1473715843?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e374ec0bb7acd755d86a370dc58fbc58","url":"https://qiita.com/kenichiuda","description":"特にありません","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kenichiuda","type":"items","id":"ce3518c36fe83063a5d9"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kenichiuda","type":"items","id":"ce3518c36fe83063a5d9"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kenichiuda","type":"items","id":"ce3518c36fe83063a5d9"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/kenichiuda/items/ce3518c36fe83063a5d9","location":"/kenichiuda/items/ce3518c36fe83063a5d9","scheme":"https","host":"qiita.com","port":null,"pathname":"/kenichiuda/items/ce3518c36fe83063a5d9","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"BIqRZJ3hHUobW5fi9y1Yp39uaGMw2t6cauut2nTDMTLmRKklnmIs/8A6wIrg7y1Ao+mEKGbJzurTY/yOnHbYAw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-12159c33-40fa-4922-8028-9d4713001576"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kenichiuda/items/ce3518c36fe83063a5d9/likers" class="css-1iupg5d">2</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">2</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/ce3518c36fe83063a5d9/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kenichiuda/items/ce3518c36fe83063a5d9/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kenichiuda/items/ce3518c36fe83063a5d9/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kenichiuda/items/ce3518c36fe83063a5d9/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kenichiuda/items/ce3518c36fe83063a5d9.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/kenichiuda"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/124276/profile-images/1473715843" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/kenichiuda" class="css-10ougpm">@<!-- -->kenichiuda</a><div class="css-1ay9vb9"><span><meta content="2020-07-12T07:52:19Z"/><time dateTime="2020-07-29T10:41:09Z" class="css-m19uds">updated at 2020-07-29</time></span></div></div></div></div></div><h1 class="css-cgzq40">[C#] Unsafeクラスの各メソッドを簡易解説(逆引き)</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p><code>System.Runtime.CompilerServices.Unsafe</code> クラスは一部で大変便利なのですが、ドキュメントを見ても動作が分かりにくいことが多いので、実際のILとC#へ逆コンパイルした結果を併記して簡易解説(メモ)します。</p>

<ul>
<li>本質的でない属性は除去しています。<br>
例: <code>.custom instance void System.Runtime.Versioning.NonVersionableAttribute::.ctor() = ( 01 00 00 00 )</code>
</li>
<li>ニュアンスをつかみやすくするため、ILSpy version 6.0.0.5830-rc1 での逆コンパイル結果を併記しています。</li>
<li>逆コンパイル結果がおかしい場合がありますが、ILをC#的に表現できないものがあるので気にしません。</li>
<li>
<a href="https://github.com/dotnet/corefx/blob/eaa464046559e4e1d616e1e3274b60d91432ad3a/src/System.Runtime.CompilerServices.Unsafe/src/System.Runtime.CompilerServices.Unsafe.il" rel="nofollow noopener" target="_blank">ILコードをリポジトリから丸コピー</a>しているので、ライセンスはThe MIT License (MIT)になります。</li>
</ul>

<h2>
<span id="ilについて" class="fragment"></span><a href="#il%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>ILについて</h2>

<ul>
<li>
<code>.</code>で始まるものはディレクティブ</li>
<li>
<code>&amp;</code>はそのまま「参照」。C++/CLIでいうインテリア参照</li>
<li>
<code>!!T</code>は、<code>T</code>という名前のメソッドのジェネリック型引数です。</li>
<li>
<code>native int</code> は<code>IntPtr</code>です。</li>
<li>スタックベースの仮想マシンです。引数はスタックに積まれています。この記事で頻出の命令をメモしておきます。

<ul>
<li>関数の引数は右側を先にスタックに積みます。</li>
<li>
<code>ldarg.N</code>で引数のN番目をスタックにロードします。</li>
<li>
<code>.maxstack N</code> で使用する最大のスタック数を宣言します。</li>
<li>
<code>cpblk</code> スタックから、コピー先、コピー元、バイト数をポップして、コピーする。コピー元とコピー先の領域とが重なっている場合，cpblkの動作は未規定。</li>
</ul>
</li>
<li>詳しくは<a href="https://en.wikipedia.org/wiki/List_of_CIL_instructions" rel="nofollow noopener" target="_blank">Wikipediaのリスト</a>か <a href="https://download.microsoft.com/download/7/3/3/733ad403-90b2-4064-a81e-01035a7fe13c/ms%20partition%20iii.pdf" rel="nofollow noopener" target="_blank">PDF</a>を見てください。</li>
</ul>

<table>
<thead>
<tr>
<th style="text-align: left">用語</th>
<th style="text-align: left">この記事での使い方</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><code>ref</code></td>
<td style="text-align: left">IL的にはマネージドポインターですが、長いのでC#の<code>ref</code>として表記します。</td>
</tr>
<tr>
<td style="text-align: left">ポインター</td>
<td style="text-align: left">「マネージドポインター」以外は、アンマネージドポインターとして用います。</td>
</tr>
<tr>
<td style="text-align: left">オブジェクト参照</td>
<td style="text-align: left">参照型のインスタンス</td>
</tr>
<tr>
<td style="text-align: left">アライメントされた</td>
<td style="text-align: left">アーキテクチャに依存するアドレスに配置された</td>
</tr>
</tbody>
</table>

<h2>
<span id="参照ポインターの再解釈系" class="fragment"></span><a href="#%E5%8F%82%E7%85%A7%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E5%86%8D%E8%A7%A3%E9%87%88%E7%B3%BB"><i class="fa fa-link"></i></a>参照・ポインターの再解釈系</h2>

<p>基本的に<code>ldarg.0</code>して<code>ret</code>する、つまり引数をそのまま戻り値の型として呼び出し元に返すだけ。</p>

<h3>
<span id="ジェネリック型のrefをvoidポインターとして解釈する" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A8%E3%81%97%E3%81%A6%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>をvoidポインターとして解釈する</h3>

<p><code>conv.u</code> で参照をポインターに変換しているっぽい。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span><span class="p">*</span> <span class="n">AsPointer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">AsPointer</span><span class="p">(</span><span class="k">ref</span> <span class="k">value</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void* AsPointer&lt;T&gt;(!!T&amp; 'value') cil managed aggressiveinlining
{
    .maxstack 1
    ldarg.0
    conv.u
    ret
} // end of method Unsafe::AsPointer
</code></pre></div></div>

<h3>
<span id="型チェックをスキップしてobject型を参照型のジェネリック型に再解釈する" class="fragment"></span><a href="#%E5%9E%8B%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%82%92%E3%82%B9%E3%82%AD%E3%83%83%E3%83%97%E3%81%97%E3%81%A6object%E5%9E%8B%E3%82%92%E5%8F%82%E7%85%A7%E5%9E%8B%E3%81%AE%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>型チェックをスキップして、<code>object</code>型を参照型のジェネリック型に再解釈する</h3>

<p>純粋に再解釈するので誤ったキャストも許容される。<br>
キャストの場合は、<code>unbox.any !!T</code>命令が使用される。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="n">T</span> <span class="n">As</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">object</span> <span class="n">o</span><span class="p">)</span> <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="k">class</span>
<span class="err">{</span>
    <span class="nc">return</span> <span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="n">o</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T As&lt;class T&gt;(object o) cil managed aggressiveinlining
{
    .maxstack 1
    ldarg.0
    ret
} // end of method Unsafe::As
</code></pre></div></div>

<h3>
<span id="あるジェネリック型のrefを別のジェネリック型のrefに再解釈する" class="fragment"></span><a href="#%E3%81%82%E3%82%8B%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E5%88%A5%E3%81%AE%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>あるジェネリック型の<code>ref</code>を、別のジェネリック型の<code>ref</code>に再解釈する</h3>

<p>C++でいうと<code>TFrom&amp; source = ...; return (TTo&amp;)source;</code> といったイメージ。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">TTo</span> <span class="n">As</span><span class="p">&lt;</span><span class="n">TFrom</span><span class="p">,</span> <span class="n">TTo</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">TFrom</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">Unsafe</span><span class="p">.</span><span class="n">As</span><span class="p">&lt;</span><span class="n">TFrom</span><span class="p">,</span> <span class="n">TTo</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">source</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!TTo&amp; As&lt;TFrom, TTo&gt;(!!TFrom&amp; source) cil managed aggressiveinlining
{
    .maxstack 1
    ldarg.0
    ret
} // end of method Unsafe::As
</code></pre></div></div>

<h3>
<span id="voidポインターをジェネリック型のrefに再解釈する" class="fragment"></span><a href="#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>voidポインターをジェネリック型の<code>ref</code>に再解釈する</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">AsRef</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="p">*(</span><span class="n">T</span><span class="p">*)</span><span class="n">source</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; AsRef&lt;T&gt;(void* source) cil managed aggressiveinlining
{
// For .NET Core the roundtrip via a local is no longer needed see:
// https://github.com/dotnet/coreclr/issues/13341
// and
// https://github.com/dotnet/coreclr/pull/11218
#ifdef netcoreapp
    .maxstack 1
    ldarg.0
    ret
#else
    .locals (int32&amp;)
    .maxstack 1
    ldarg.0
    // Roundtrip via a local to avoid type mismatch on return that the JIT inliner chokes on.
    stloc.0
    ldloc.0
    ret
#endif
} // end of method Unsafe::AsRef
</code></pre></div></div>

<h3>
<span id="readonly-refをジェネリック型のrefに再解釈する" class="fragment"></span><a href="#readonly-ref%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a><code>readonly ref</code>をジェネリック型の<code>ref</code>に再解釈する</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">AsRef</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">in</span> <span class="n">T</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">source</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code>.param [1]</code> で仮引数1(1オリジン)に属性を適用している。</p>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; AsRef&lt;T&gt;(!!T&amp; source) cil managed aggressiveinlining
{
    .param [1]
#ifdef netcoreapp
    .custom instance void [CORE_ASSEMBLY]System.Runtime.CompilerServices.IsReadOnlyAttribute::.ctor() = ( 01 00 00 00 )
#else
    .custom instance void System.Runtime.CompilerServices.IsReadOnlyAttribute::.ctor() = ( 01 00 00 00 )
#endif
    .maxstack 1
    ldarg.0
    ret
} // end of method Unsafe::AsRef
</code></pre></div></div>

<h2>
<span id="コピー読み取り書き込み系" class="fragment"></span><a href="#%E3%82%B3%E3%83%94%E3%83%BC%E8%AA%AD%E3%81%BF%E5%8F%96%E3%82%8A%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E7%B3%BB"><i class="fa fa-link"></i></a>コピー/読み取り/書き込み系</h2>

<h3>
<span id="アラインメントされたvoidポインターから読んだ値を返す" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%9Fvoid%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99"><i class="fa fa-link"></i></a>アラインメントされたvoidポインターから、読んだ値を返す</h3>

<p>Cでいうと<code>*((T*)source);</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="n">T</span> <span class="n">Read</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">*(</span><span class="n">T</span><span class="p">*)</span><span class="n">source</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T Read&lt;T&gt;(void* source) cil managed aggressiveinlining
{
    .maxstack 1
    ldarg.0
    ldobj !!T
    ret
} // end of method Unsafe::Read
</code></pre></div></div>

<h3>
<span id="アラインメントされていないポインタから読んだ値を返す" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99"><i class="fa fa-link"></i></a>アラインメントされていないポインタから、読んだ値を返す</h3>

<p>IA(x86, x64アーキテクチャ)では、恐らくUnalignedが付かない方を使用しても、(性能以外で)ペナルティはない。<br>
逆コンパイル結果はアライメントされたものと同じだが、C#で表現できないからだろう。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="n">T</span> <span class="n">ReadUnaligned</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">*(</span><span class="n">T</span><span class="p">*)</span><span class="n">source</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T ReadUnaligned&lt;T&gt;(void* source) cil managed aggressiveinlining
{
    .maxstack 1
    ldarg.0        
    unaligned. 0x1
    ldobj !!T
    ret
} // end of method Unsafe::ReadUnaligned
</code></pre></div></div>

<h3>
<span id="アラインメントされていないbyte型のマネージドポインターから読んだ値を返す" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AE%E3%83%9E%E3%83%8D%E3%83%BC%E3%82%B8%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99"><i class="fa fa-link"></i></a>アラインメントされていないbyte型のマネージドポインターから、読んだ値を返す</h3>

<p>逆コンパイル結果はアライメントされたものと同じだが、C#で表現できないからだろう。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="n">T</span> <span class="n">ReadUnaligned</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="kt">byte</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">*(</span><span class="n">T</span><span class="p">*)(&amp;</span><span class="n">source</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T ReadUnaligned&lt;T&gt;(uint8&amp; source) cil managed aggressiveinlining
{
    .maxstack 1
    ldarg.0        
    unaligned. 0x1
    ldobj !!T
    ret
} // end of method Unsafe::ReadUnaligned
</code></pre></div></div>

<h3>
<span id="アラインメントされたvoidポインターへ値を書き込む" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%9Fvoid%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80"><i class="fa fa-link"></i></a>アラインメントされたvoidポインターへ値を書き込む</h3>

<p>Cでいうと<code>*((T*)) = value;</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="n">Write</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">destination</span><span class="p">,</span> <span class="n">T</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">*(</span><span class="n">T</span><span class="p">*)</span><span class="n">destination</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void Write&lt;T&gt;(void* destination,
                                                !!T 'value') cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    stobj !!T
    ret
} // end of method Unsafe::Write
</code></pre></div></div>

<h3>
<span id="アラインメントされていないvoidポインターへ値を書き込む" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80"><i class="fa fa-link"></i></a>アラインメントされていないvoidポインターへ値を書き込む</h3>

<p>Cでいうと<code>*((__unaligned T*)) = value;</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="n">WriteUnaligned</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">destination</span><span class="p">,</span> <span class="n">T</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">*(</span><span class="n">T</span><span class="p">*)</span><span class="n">destination</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void WriteUnaligned&lt;T&gt;(void* destination,
                                                !!T 'value') cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    unaligned. 0x01
    stobj !!T
    ret
} // end of method Unsafe::WriteUnaligned
</code></pre></div></div>

<h3>
<span id="アラインメントされていないbyte型のrefへ値を書き込む" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80"><i class="fa fa-link"></i></a>アラインメントされていないbyte型の<code>ref</code>へ値を書き込む</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="n">WriteUnaligned</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="kt">byte</span> <span class="n">destination</span><span class="p">,</span> <span class="n">T</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">*(</span><span class="n">T</span><span class="p">*)(&amp;</span><span class="n">destination</span><span class="p">)</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void WriteUnaligned&lt;T&gt;(uint8&amp; destination,
                                                !!T 'value') cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1        
    unaligned. 0x01
    stobj !!T
    ret
} // end of method Unsafe::WriteUnaligned
</code></pre></div></div>

<h3>
<span id="ジェネリック型のrefからvoidポインターへコピーする" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>からvoidポインターへコピーする</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="n">Copy</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">destination</span><span class="p">,</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">*(</span><span class="n">T</span><span class="p">*)</span><span class="n">destination</span> <span class="p">=</span> <span class="n">source</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void Copy&lt;T&gt;(void* destination,
                                            !!T&amp; source) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    ldobj !!T
    stobj !!T
    ret
} // end of method Unsafe::Copy
</code></pre></div></div>

<h3>
<span id="voidポインターからジェネリック型のrefへコピーする" class="fragment"></span><a href="#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>voidポインターからジェネリック型の<code>ref</code>へコピーする</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="n">Copy</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">destination</span><span class="p">,</span> <span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">destination</span> <span class="p">=</span> <span class="p">*(</span><span class="n">T</span><span class="p">*)</span><span class="n">source</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void Copy&lt;T&gt;(!!T&amp; destination,
                                            void* source) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    ldobj !!T
    stobj !!T
    ret
} // end of method Unsafe::Copy
</code></pre></div></div>

<h3>
<span id="voidポインターから指定されたバイト数分voidポインターへコピーするcで云うmemcpy" class="fragment"></span><a href="#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8Bc%E3%81%A7%E4%BA%91%E3%81%86memcpy"><i class="fa fa-link"></i></a>voidポインターから指定されたバイト数分、voidポインターへコピーする(Cで云う<code>memcpy</code>)</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CopyBlock</span><span class="p">(</span><span class="k">void</span><span class="p">*</span> <span class="n">destination</span><span class="p">,</span> <span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL cpblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">CopyBlock</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void CopyBlock(void* destination, void* source, uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    cpblk
    ret
} // end of method Unsafe::CopyBlock
</code></pre></div></div>

<h3>
<span id="byte型のrefから指定されたバイト数分byte型のrefへコピーするcで云うmemcpy" class="fragment"></span><a href="#byte%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8Bc%E3%81%A7%E4%BA%91%E3%81%86memcpy"><i class="fa fa-link"></i></a>byte型の<code>ref</code>から指定されたバイト数分、byte型の<code>ref</code>へコピーする(Cで云う<code>memcpy</code>)</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CopyBlock</span><span class="p">(</span><span class="k">ref</span> <span class="kt">byte</span> <span class="n">destination</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">byte</span> <span class="n">source</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL cpblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">CopyBlock</span><span class="p">(</span><span class="k">ref</span> <span class="n">destination</span><span class="p">,</span> <span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void CopyBlock(uint8&amp; destination, uint8&amp; source, uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    cpblk
    ret
} // end of method Unsafe::CopyBlock
</code></pre></div></div>

<h3>
<span id="アラインメントされていないvoidポインターから指定されたバイト数分voidポインターへコピーする" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>アラインメントされていないvoidポインターから指定されたバイト数分、voidポインターへコピーする</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CopyBlockUnaligned</span><span class="p">(</span><span class="k">void</span><span class="p">*</span> <span class="n">destination</span><span class="p">,</span> <span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL cpblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">CopyBlockUnaligned</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void CopyBlockUnaligned(void* destination, void* source, uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    unaligned. 0x1
    cpblk
    ret
} // end of method Unsafe::CopyBlockUnaligned
</code></pre></div></div>

<h3>
<span id="アラインメントされていないbyte型のrefから指定されたバイト数分voidポインターへコピーする" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>アラインメントされていないbyte型の<code>ref</code>から指定されたバイト数分、voidポインターへコピーする</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CopyBlockUnaligned</span><span class="p">(</span><span class="k">ref</span> <span class="kt">byte</span> <span class="n">destination</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">byte</span> <span class="n">source</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL cpblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">CopyBlockUnaligned</span><span class="p">(</span><span class="k">ref</span> <span class="n">destination</span><span class="p">,</span> <span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void CopyBlockUnaligned(uint8&amp; destination, uint8&amp; source, uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    unaligned. 0x1
    cpblk
    ret
} // end of method Unsafe::CopyBlockUnaligned
</code></pre></div></div>

<h3>
<span id="voidポインターへ指定されたバイト数分バイト値を書き込むcで云うmemset" class="fragment"></span><a href="#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset"><i class="fa fa-link"></i></a>voidポインターへ指定されたバイト数分、バイト値を書き込む(Cで云う<code>memset</code>)</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">InitBlock</span><span class="p">(</span><span class="k">void</span><span class="p">*</span> <span class="n">startAddress</span><span class="p">,</span> <span class="kt">byte</span> <span class="k">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL initblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">InitBlock</span><span class="p">(</span><span class="n">startAddress</span><span class="p">,</span> <span class="k">value</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void InitBlock(void* startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    initblk
    ret
} // end of method Unsafe::InitBlock
</code></pre></div></div>

<h3>
<span id="byte型のrefへ指定されたバイト数分バイト値を書き込むcで云うmemset" class="fragment"></span><a href="#byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset"><i class="fa fa-link"></i></a>byte型の<code>ref</code>へ指定されたバイト数分、バイト値を書き込む(Cで云う<code>memset</code>)</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">InitBlock</span><span class="p">(</span><span class="k">ref</span> <span class="kt">byte</span> <span class="n">startAddress</span><span class="p">,</span> <span class="kt">byte</span> <span class="k">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL initblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">InitBlock</span><span class="p">(</span><span class="k">ref</span> <span class="n">startAddress</span><span class="p">,</span> <span class="k">value</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void InitBlock(uint8&amp; startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    initblk
    ret
} // end of method Unsafe::InitBlock
</code></pre></div></div>

<h3>
<span id="アライメントされていないvoidポインターへ指定されたバイト数分バイト値を書き込むcで云うmemset" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset"><i class="fa fa-link"></i></a>アライメントされていないvoidポインターへ指定されたバイト数分、バイト値を書き込む(Cで云う<code>memset</code>)</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">InitBlockUnaligned</span><span class="p">(</span><span class="k">void</span><span class="p">*</span> <span class="n">startAddress</span><span class="p">,</span> <span class="kt">byte</span> <span class="k">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL initblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">InitBlockUnaligned</span><span class="p">(</span><span class="n">startAddress</span><span class="p">,</span> <span class="k">value</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void InitBlockUnaligned(void* startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    unaligned. 0x1
    initblk
    ret
} // end of method Unsafe::InitBlockUnaligned
</code></pre></div></div>

<h3>
<span id="アライメントされていないbyte型のrefへ指定されたバイト数分バイト値を書き込むcで云うmemset" class="fragment"></span><a href="#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset"><i class="fa fa-link"></i></a>アライメントされていないbyte型の<code>ref</code>へ指定されたバイト数分、バイト値を書き込む(Cで云う<code>memset</code>)</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">InitBlockUnaligned</span><span class="p">(</span><span class="k">ref</span> <span class="kt">byte</span> <span class="n">startAddress</span><span class="p">,</span> <span class="kt">byte</span> <span class="k">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">byteCount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// IL initblk instruction</span>
    <span class="n">Unsafe</span><span class="p">.</span><span class="nf">InitBlockUnaligned</span><span class="p">(</span><span class="k">ref</span> <span class="n">startAddress</span><span class="p">,</span> <span class="k">value</span><span class="p">,</span> <span class="n">byteCount</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void InitBlockUnaligned(uint8&amp; startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    ldarg.2
    unaligned. 0x1
    initblk
    ret
} // end of method Unsafe::InitBlockUnaligned
</code></pre></div></div>

<h2>
<span id="アドレス演算系" class="fragment"></span><a href="#%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E6%BC%94%E7%AE%97%E7%B3%BB"><i class="fa fa-link"></i></a>アドレス演算系</h2>

<h3>
<span id="ジェネリック型のrefを要素数分の加算する" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E3%81%AE%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>を要素数分の加算する</h3>

<p>C++で云う<code>(T&amp;)(((T*)&amp;source)+elementOffset)</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">Add</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">source</span><span class="p">,</span> <span class="kt">int</span> <span class="n">elementOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">elementOffset</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; Add&lt;T&gt;(!!T&amp; source, int32 elementOffset) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    sizeof !!T
    conv.i
    mul
    add
    ret
} // end of method Unsafe::Add
</code></pre></div></div>

<h3>
<span id="ジェネリック型のrefを要素数分加算する" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>を要素数分加算する</h3>

<p>こちらはnative int版</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">Add</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">source</span><span class="p">,</span> <span class="n">IntPtr</span> <span class="n">elementOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">elementOffset</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; Add&lt;T&gt;(!!T&amp; source, native int elementOffset) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    sizeof !!T
    mul
    add
    ret
} // end of method Unsafe::Add
</code></pre></div></div>

<h3>
<span id="voidポインターをジェネリック型として要素数分加算する" class="fragment"></span><a href="#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%A8%E3%81%97%E3%81%A6%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>voidポインターをジェネリック型として要素数分加算する</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span><span class="p">*</span> <span class="n">Add</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">,</span> <span class="kt">int</span> <span class="n">elementOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*)</span><span class="n">source</span> <span class="p">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">elementOffset</span> <span class="p">*</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="k">sizeof</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void* Add&lt;T&gt;(void* source, int32 elementOffset) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    sizeof !!T
    conv.i
    mul
    add
    ret
} // end of method Unsafe::Add
</code></pre></div></div>

<h3>
<span id="ジェネリック型のrefへ指定バイト数分加算する" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>へ指定バイト数分加算する</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">AddByteOffset</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">source</span><span class="p">,</span> <span class="n">IntPtr</span> <span class="n">byteOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">AddByteOffset</span><span class="p">(</span><span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">byteOffset</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; AddByteOffset&lt;T&gt;(!!T&amp; source, native int byteOffset) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    add
    ret
} // end of method Unsafe::AddByteOffset
</code></pre></div></div>

<h3>
<span id="ジェネリック型のrefを要素数分減算する" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>を要素数分減算する</h3>

<p><code>ref *(((T*)&amp;source) - elementOffset)</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">Subtract</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">source</span><span class="p">,</span> <span class="kt">int</span> <span class="n">elementOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">Subtract</span><span class="p">(</span><span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">elementOffset</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; Subtract&lt;T&gt;(!!T&amp; source, int32 elementOffset) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    sizeof !!T
    conv.i
    mul
    sub
    ret
} // end of method Unsafe::Subtract
</code></pre></div></div>

<h3>
<span id="ジェネリック型のrefを要素数分加算する-1" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B-1"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>を要素数分加算する</h3>

<p>こちらはnative int版</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">Subtract</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">source</span><span class="p">,</span> <span class="n">IntPtr</span> <span class="n">elementOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">Subtract</span><span class="p">(</span><span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">elementOffset</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; Subtract&lt;T&gt;(!!T&amp; source, native int elementOffset) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    sizeof !!T
    mul
    sub
    ret
} // end of method Unsafe::Subtract
</code></pre></div></div>

<h3>
<span id="voidポインターをジェネリック型として要素数分減算する" class="fragment"></span><a href="#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%A8%E3%81%97%E3%81%A6%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>voidポインターをジェネリック型として要素数分減算する</h3>

<p><code>ref *(((T*)source) - elementOffset)</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="k">void</span><span class="p">*</span> <span class="n">Subtract</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">void</span><span class="p">*</span> <span class="n">source</span><span class="p">,</span> <span class="kt">int</span> <span class="n">elementOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*)</span><span class="n">source</span> <span class="p">-</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">elementOffset</span> <span class="p">*</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="k">sizeof</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static void* Subtract&lt;T&gt;(void* source, int32 elementOffset) cil managed aggressiveinlining
{
    .maxstack 3
    ldarg.0
    ldarg.1
    sizeof !!T
    conv.i
    mul
    sub
    ret
} // end of method Unsafe::Subtract
</code></pre></div></div>

<h3>
<span id="ジェネリック型のrefへ指定バイト数分減算する" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ジェネリック型の<code>ref</code>へ指定バイト数分減算する</h3>

<p><code>ref *((T*)(((byte*)&amp;source) - byteOffset))</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">SubtractByteOffset</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">source</span><span class="p">,</span> <span class="n">IntPtr</span> <span class="n">byteOffset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">ref</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">SubtractByteOffset</span><span class="p">(</span><span class="k">ref</span> <span class="n">source</span><span class="p">,</span> <span class="n">byteOffset</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; SubtractByteOffset&lt;T&gt;(!!T&amp; source, native int byteOffset) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    sub
    ret
} // end of method Unsafe::SubtractByteOffset
</code></pre></div></div>

<h3>
<span id="refと同じ型の別のrefの差を求める" class="fragment"></span><a href="#ref%E3%81%A8%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%88%A5%E3%81%AEref%E3%81%AE%E5%B7%AE%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B"><i class="fa fa-link"></i></a><code>ref</code>と同じ型の別の<code>ref</code>の差を求める</h3>

<p><code>(byte*)(ref right) - (byte*)(ref left)</code></p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="n">IntPtr</span> <span class="n">ByteOffset</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">origin</span><span class="p">,</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">target</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Unsafe</span><span class="p">.</span><span class="nf">ByteOffset</span><span class="p">(</span><span class="k">ref</span> <span class="n">target</span><span class="p">,</span> <span class="k">ref</span> <span class="n">origin</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static native int ByteOffset&lt;T&gt;(!!T&amp; origin, !!T&amp; target) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.1
    ldarg.0
    sub
    ret
} // end of method Unsafe::ByteOffset
</code></pre></div></div>

<h2>
<span id="アドレス比較系" class="fragment"></span><a href="#%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E6%AF%94%E8%BC%83%E7%B3%BB"><i class="fa fa-link"></i></a>アドレス比較系</h2>

<h3>
<span id="refが同じ値かどうかを比較する" class="fragment"></span><a href="#ref%E3%81%8C%E5%90%8C%E3%81%98%E5%80%A4%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a><code>ref</code>が同じ値かどうかを比較する</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">AreSame</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">left</span><span class="p">,</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">right</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">ref</span> <span class="n">left</span><span class="p">)</span> <span class="p">==</span> <span class="p">(</span><span class="k">ref</span> <span class="n">right</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static bool AreSame&lt;T&gt;(!!T&amp; left, !!T&amp; right) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    ceq
    ret 
} // end of method Unsafe::AreSame
</code></pre></div></div>

<h3>
<span id="refが右辺より大きいか比較する" class="fragment"></span><a href="#ref%E3%81%8C%E5%8F%B3%E8%BE%BA%E3%82%88%E3%82%8A%E5%A4%A7%E3%81%8D%E3%81%84%E3%81%8B%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a><code>ref</code>が右辺より大きいか比較する</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">IsAddressGreaterThan</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">left</span><span class="p">,</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">right</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">ref</span> <span class="n">left</span><span class="p">)</span> <span class="p">&gt;</span> <span class="p">(</span><span class="k">ref</span> <span class="n">right</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static bool IsAddressGreaterThan&lt;T&gt;(!!T&amp; left, !!T&amp; right) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    cgt.un
    ret 
} // end of method Unsafe::IsAddressGreaterThan
</code></pre></div></div>

<h3>
<span id="refが右辺より小さいか比較する" class="fragment"></span><a href="#ref%E3%81%8C%E5%8F%B3%E8%BE%BA%E3%82%88%E3%82%8A%E5%B0%8F%E3%81%95%E3%81%84%E3%81%8B%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a><code>ref</code>が右辺より小さいか比較する</h3>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">IsAddressLessThan</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">ref</span> <span class="n">T</span> <span class="n">left</span><span class="p">,</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">right</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">ref</span> <span class="n">left</span><span class="p">)</span> <span class="p">&lt;</span> <span class="p">(</span><span class="k">ref</span> <span class="n">right</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static bool IsAddressLessThan&lt;T&gt;(!!T&amp; left, !!T&amp; right) cil managed aggressiveinlining
{
    .maxstack 2
    ldarg.0
    ldarg.1
    clt.un
    ret 
} // end of method Unsafe::IsAddressLessThan
</code></pre></div></div>

<h2>
<span id="他" class="fragment"></span><a href="#%E4%BB%96"><i class="fa fa-link"></i></a>他</h2>

<h3>
<span id="マーシャリングを考慮しないサイズを求める" class="fragment"></span><a href="#%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0%E3%82%92%E8%80%83%E6%85%AE%E3%81%97%E3%81%AA%E3%81%84%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B"><i class="fa fa-link"></i></a>マーシャリングを考慮しないサイズを求める</h3>

<p>unsafeコンテキストで<code>sizeof()</code>することと同じ。<br>
<code>Marshal.SizeOf()</code>はマーシャリングを考慮する。</p>

<p>個人的には<code>where T : unmanaged</code>をつけて欲しい。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">unsafe</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">SizeOf</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static int32 SizeOf&lt;T&gt;() cil managed aggressiveinlining
{
    .maxstack 1
    sizeof !!T
    ret
} // end of method Unsafe::SizeOf
</code></pre></div></div>

<h2>
<span id="net-core-3以降またはnuget-パッケージの最新少なくとも471以降" class="fragment"></span><a href="#net-core-3%E4%BB%A5%E9%99%8D%E3%81%BE%E3%81%9F%E3%81%AFnuget-%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E6%9C%80%E6%96%B0%E5%B0%91%E3%81%AA%E3%81%8F%E3%81%A8%E3%82%82471%E4%BB%A5%E9%99%8D"><i class="fa fa-link"></i></a>.NET Core 3以降またはNuGet パッケージの最新(少なくとも4.7.1以降)</h2>

<h3>
<span id="box化された構造体オブジェクト参照の内部のrefを取得する" class="fragment"></span><a href="#box%E5%8C%96%E3%81%95%E3%82%8C%E3%81%9F%E6%A7%8B%E9%80%A0%E4%BD%93%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%8F%82%E7%85%A7%E3%81%AE%E5%86%85%E9%83%A8%E3%81%AEref%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>box化された構造体(オブジェクト参照)の内部の<code>ref</code>を取得する</h3>

<p>C++/CLIで云う<code>cli::interior_ptr</code>と等価。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="k">public</span> <span class="k">static</span> <span class="k">ref</span> <span class="n">T</span> <span class="n">Unbox</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">object</span> <span class="n">box</span><span class="p">)</span> <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="k">struct</span>
<span class="err">{</span>
    <span class="nc">return</span> <span class="k">ref</span> <span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="n">box</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>.method public hidebysig static !!T&amp; Unbox&lt;valuetype .ctor ([CORE_ASSEMBLY]System.ValueType) T&gt; (object 'box') cil managed aggressiveinlining
{
    .maxstack 1
    ldarg.0
    unbox !!T
    ret
} // end of method Unsafe::Unbox
</code></pre></div></div>

<h2>
<span id="net-5以降" class="fragment"></span><a href="#net-5%E4%BB%A5%E9%99%8D"><i class="fa fa-link"></i></a>.NET 5以降</h2>

<h3>
<span id="初期化0クリアをスキップして変数宣言する" class="fragment"></span><a href="#%E5%88%9D%E6%9C%9F%E5%8C%960%E3%82%AF%E3%83%AA%E3%82%A2%E3%82%92%E3%82%B9%E3%82%AD%E3%83%83%E3%83%97%E3%81%97%E3%81%A6%E5%A4%89%E6%95%B0%E5%AE%A3%E8%A8%80%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>初期化(0クリア)をスキップして変数宣言する</h3>

<p><del>多分CLRの対応が必要</del> <a href="https://github.com/dotnet/runtime/issues/29905" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/dotnet/runtime/issues/29905</a></p>

<div class="code-frame" data-lang="il"><div class="highlight"><pre class="with-code"><code>  .method public hidebysig static void SkipInit&lt;T&gt; ([out] !!T&amp; 'value') cil managed aggressiveinlining
  {
        .maxstack 0
        ret
  } // end of method Unsafe::SkipInit

</code></pre></div></div>

<h2>
<span id="個人的に欲しいメソッド" class="fragment"></span><a href="#%E5%80%8B%E4%BA%BA%E7%9A%84%E3%81%AB%E6%AC%B2%E3%81%97%E3%81%84%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89"><i class="fa fa-link"></i></a>個人的に欲しいメソッド</h2>

<p>組み合わせれば実現するが、できれば直接欲しいと思っているメソッドの一覧。</p>

<ul>
<li>Cで云う<code>offsetof</code>
</li>
<li>Cで云う<code>memmove</code><br>
<code>cpblk</code>に領域が重なっている場合の保証がないので。</li>
<li>
<code>readonly ref</code>への強制再解釈</li>
<li>全体的に<code>readonly ref</code>版のメソッド
必要無ければ、<code>readonly</code>にしてほしいところだが、オーバーロードできないので多分厳しい。</li>
<li>アライメント判定</li>
<li>Overlaps判定(<code>Span&lt;T&gt;</code>にはあるけど。)</li>
<li>ジェネリック型<code>T where T : unmanaged</code>のマネージドポインターをポインターへの再解釈
<code>
public unsafe static T* ATypedsPointer&lt;T&gt;(ref T value) where T : unmanaged
{
return (T*)Unsafe.AsPointer(ref value);
}
</code>
</li>
</ul>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fkenichiuda%2Fitems%2Fce3518c36fe83063a5d9&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fkenichiuda%2Fitems%2Fce3518c36fe83063a5d9&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/kenichiuda/items/ce3518c36fe83063a5d9/likers" class="css-1iupg5d">2</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">2</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/ce3518c36fe83063a5d9/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/kenichiuda/items/ce3518c36fe83063a5d9/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/kenichiuda/items/ce3518c36fe83063a5d9/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/kenichiuda/items/ce3518c36fe83063a5d9/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/kenichiuda/items/ce3518c36fe83063a5d9.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-12159c33-40fa-4922-8028-9d4713001576">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-c231af32-fed2-4545-ac46-fae9d247f722"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-c231af32-fed2-4545-ac46-fae9d247f722">{}</script>
      
<div id="LoginModal-react-component-f18befb4-fb63-4d12-8847-a952dcd737bd"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-f18befb4-fb63-4d12-8847-a952dcd737bd">{}</script>
      
<div id="StockModal-react-component-b9114ce2-6da5-4211-8643-c43f78c4ee8b"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-b9114ce2-6da5-4211-8643-c43f78c4ee8b">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;f3c6D163WubifNHeDxCa0pueY2YuZeAeVMR8nVHOxDOduQJOXTRrUzkdhrYY0u81RxmPLXh28GjtTC3JuXstAg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e\u003ccode\u003eSystem.Runtime.CompilerServices.Unsafe\u003c/code\u003e クラスは一部で大変便利なのですが、ドキュメントを見ても動作が分かりにくいことが多いので、実際のILとC#へ逆コンパイルした結果を併記して簡易解説(メモ)します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e本質的でない属性は除去しています。\u003cbr\u003e\n例: \u003ccode\u003e.custom instance void System.Runtime.Versioning.NonVersionableAttribute::.ctor() = ( 01 00 00 00 )\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eニュアンスをつかみやすくするため、ILSpy version 6.0.0.5830-rc1 での逆コンパイル結果を併記しています。\u003c/li\u003e\n\u003cli\u003e逆コンパイル結果がおかしい場合がありますが、ILをC#的に表現できないものがあるので気にしません。\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://github.com/dotnet/corefx/blob/eaa464046559e4e1d616e1e3274b60d91432ad3a/src/System.Runtime.CompilerServices.Unsafe/src/System.Runtime.CompilerServices.Unsafe.il\" rel=\"nofollow noopener\" target=\"_blank\"\u003eILコードをリポジトリから丸コピー\u003c/a\u003eしているので、ライセンスはThe MIT License (MIT)になります。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ilについて\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#il%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eILについて\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e.\u003c/code\u003eで始まるものはディレクティブ\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\u0026amp;\u003c/code\u003eはそのまま「参照」。C++/CLIでいうインテリア参照\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e!!T\u003c/code\u003eは、\u003ccode\u003eT\u003c/code\u003eという名前のメソッドのジェネリック型引数です。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003enative int\u003c/code\u003e は\u003ccode\u003eIntPtr\u003c/code\u003eです。\u003c/li\u003e\n\u003cli\u003eスタックベースの仮想マシンです。引数はスタックに積まれています。この記事で頻出の命令をメモしておきます。\n\n\u003cul\u003e\n\u003cli\u003e関数の引数は右側を先にスタックに積みます。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eldarg.N\u003c/code\u003eで引数のN番目をスタックにロードします。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e.maxstack N\u003c/code\u003e で使用する最大のスタック数を宣言します。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ecpblk\u003c/code\u003e スタックから、コピー先、コピー元、バイト数をポップして、コピーする。コピー元とコピー先の領域とが重なっている場合，cpblkの動作は未規定。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e詳しくは\u003ca href=\"https://en.wikipedia.org/wiki/List_of_CIL_instructions\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWikipediaのリスト\u003c/a\u003eか \u003ca href=\"https://download.microsoft.com/download/7/3/3/733ad403-90b2-4064-a81e-01035a7fe13c/ms%20partition%20iii.pdf\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePDF\u003c/a\u003eを見てください。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: left\"\u003e用語\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003eこの記事での使い方\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003e\u003ccode\u003eref\u003c/code\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eIL的にはマネージドポインターですが、長いのでC#の\u003ccode\u003eref\u003c/code\u003eとして表記します。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eポインター\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e「マネージドポインター」以外は、アンマネージドポインターとして用います。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eオブジェクト参照\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003e参照型のインスタンス\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: left\"\u003eアライメントされた\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eアーキテクチャに依存するアドレスに配置された\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参照ポインターの再解釈系\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E7%85%A7%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E5%86%8D%E8%A7%A3%E9%87%88%E7%B3%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参照・ポインターの再解釈系\u003c/h2\u003e\n\n\u003cp\u003e基本的に\u003ccode\u003eldarg.0\u003c/code\u003eして\u003ccode\u003eret\u003c/code\u003eする、つまり引数をそのまま戻り値の型として呼び出し元に返すだけ。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefをvoidポインターとして解釈する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A8%E3%81%97%E3%81%A6%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eをvoidポインターとして解釈する\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003econv.u\u003c/code\u003e で参照をポインターに変換しているっぽい。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eAsPointer\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAsPointer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void* AsPointer\u0026lt;T\u0026gt;(!!T\u0026amp; 'value') cil managed aggressiveinlining\n{\n    .maxstack 1\n    ldarg.0\n    conv.u\n    ret\n} // end of method Unsafe::AsPointer\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"型チェックをスキップしてobject型を参照型のジェネリック型に再解釈する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9E%8B%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%82%92%E3%82%B9%E3%82%AD%E3%83%83%E3%83%97%E3%81%97%E3%81%A6object%E5%9E%8B%E3%82%92%E5%8F%82%E7%85%A7%E5%9E%8B%E3%81%AE%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e型チェックをスキップして、\u003ccode\u003eobject\u003c/code\u003e型を参照型のジェネリック型に再解釈する\u003c/h3\u003e\n\n\u003cp\u003e純粋に再解釈するので誤ったキャストも許容される。\u003cbr\u003e\nキャストの場合は、\u003ccode\u003eunbox.any !!T\u003c/code\u003e命令が使用される。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eAs\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ewhere\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e\n\u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T As\u0026lt;class T\u0026gt;(object o) cil managed aggressiveinlining\n{\n    .maxstack 1\n    ldarg.0\n    ret\n} // end of method Unsafe::As\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"あるジェネリック型のrefを別のジェネリック型のrefに再解釈する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%82%8B%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E5%88%A5%E3%81%AE%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあるジェネリック型の\u003ccode\u003eref\u003c/code\u003eを、別のジェネリック型の\u003ccode\u003eref\u003c/code\u003eに再解釈する\u003c/h3\u003e\n\n\u003cp\u003eC++でいうと\u003ccode\u003eTFrom\u0026amp; source = ...; return (TTo\u0026amp;)source;\u003c/code\u003e といったイメージ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eTTo\u003c/span\u003e \u003cspan class=\"n\"\u003eAs\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTFrom\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTTo\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eTFrom\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAs\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTFrom\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTTo\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!TTo\u0026amp; As\u0026lt;TFrom, TTo\u0026gt;(!!TFrom\u0026amp; source) cil managed aggressiveinlining\n{\n    .maxstack 1\n    ldarg.0\n    ret\n} // end of method Unsafe::As\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"voidポインターをジェネリック型のrefに再解釈する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evoidポインターをジェネリック型の\u003ccode\u003eref\u003c/code\u003eに再解釈する\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eAsRef\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; AsRef\u0026lt;T\u0026gt;(void* source) cil managed aggressiveinlining\n{\n// For .NET Core the roundtrip via a local is no longer needed see:\n// https://github.com/dotnet/coreclr/issues/13341\n// and\n// https://github.com/dotnet/coreclr/pull/11218\n#ifdef netcoreapp\n    .maxstack 1\n    ldarg.0\n    ret\n#else\n    .locals (int32\u0026amp;)\n    .maxstack 1\n    ldarg.0\n    // Roundtrip via a local to avoid type mismatch on return that the JIT inliner chokes on.\n    stloc.0\n    ldloc.0\n    ret\n#endif\n} // end of method Unsafe::AsRef\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"readonly-refをジェネリック型のrefに再解釈する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#readonly-ref%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003ereadonly ref\u003c/code\u003eをジェネリック型の\u003ccode\u003eref\u003c/code\u003eに再解釈する\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eAsRef\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e.param [1]\u003c/code\u003e で仮引数1(1オリジン)に属性を適用している。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; AsRef\u0026lt;T\u0026gt;(!!T\u0026amp; source) cil managed aggressiveinlining\n{\n    .param [1]\n#ifdef netcoreapp\n    .custom instance void [CORE_ASSEMBLY]System.Runtime.CompilerServices.IsReadOnlyAttribute::.ctor() = ( 01 00 00 00 )\n#else\n    .custom instance void System.Runtime.CompilerServices.IsReadOnlyAttribute::.ctor() = ( 01 00 00 00 )\n#endif\n    .maxstack 1\n    ldarg.0\n    ret\n} // end of method Unsafe::AsRef\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コピー読み取り書き込み系\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%94%E3%83%BC%E8%AA%AD%E3%81%BF%E5%8F%96%E3%82%8A%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E7%B3%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコピー/読み取り/書き込み系\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされたvoidポインターから読んだ値を返す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%9Fvoid%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされたvoidポインターから、読んだ値を返す\u003c/h3\u003e\n\n\u003cp\u003eCでいうと\u003ccode\u003e*((T*)source);\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T Read\u0026lt;T\u0026gt;(void* source) cil managed aggressiveinlining\n{\n    .maxstack 1\n    ldarg.0\n    ldobj !!T\n    ret\n} // end of method Unsafe::Read\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされていないポインタから読んだ値を返す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされていないポインタから、読んだ値を返す\u003c/h3\u003e\n\n\u003cp\u003eIA(x86, x64アーキテクチャ)では、恐らくUnalignedが付かない方を使用しても、(性能以外で)ペナルティはない。\u003cbr\u003e\n逆コンパイル結果はアライメントされたものと同じだが、C#で表現できないからだろう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eReadUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T ReadUnaligned\u0026lt;T\u0026gt;(void* source) cil managed aggressiveinlining\n{\n    .maxstack 1\n    ldarg.0        \n    unaligned. 0x1\n    ldobj !!T\n    ret\n} // end of method Unsafe::ReadUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされていないbyte型のマネージドポインターから読んだ値を返す\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AE%E3%83%9E%E3%83%8D%E3%83%BC%E3%82%B8%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされていないbyte型のマネージドポインターから、読んだ値を返す\u003c/h3\u003e\n\n\u003cp\u003e逆コンパイル結果はアライメントされたものと同じだが、C#で表現できないからだろう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eReadUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)(\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T ReadUnaligned\u0026lt;T\u0026gt;(uint8\u0026amp; source) cil managed aggressiveinlining\n{\n    .maxstack 1\n    ldarg.0        \n    unaligned. 0x1\n    ldobj !!T\n    ret\n} // end of method Unsafe::ReadUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされたvoidポインターへ値を書き込む\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%9Fvoid%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされたvoidポインターへ値を書き込む\u003c/h3\u003e\n\n\u003cp\u003eCでいうと\u003ccode\u003e*((T*)) = value;\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003edestination\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void Write\u0026lt;T\u0026gt;(void* destination,\n                                                !!T 'value') cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    stobj !!T\n    ret\n} // end of method Unsafe::Write\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされていないvoidポインターへ値を書き込む\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされていないvoidポインターへ値を書き込む\u003c/h3\u003e\n\n\u003cp\u003eCでいうと\u003ccode\u003e*((__unaligned T*)) = value;\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eWriteUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003edestination\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void WriteUnaligned\u0026lt;T\u0026gt;(void* destination,\n                                                !!T 'value') cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    unaligned. 0x01\n    stobj !!T\n    ret\n} // end of method Unsafe::WriteUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされていないbyte型のrefへ値を書き込む\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされていないbyte型の\u003ccode\u003eref\u003c/code\u003eへ値を書き込む\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eWriteUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)(\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void WriteUnaligned\u0026lt;T\u0026gt;(uint8\u0026amp; destination,\n                                                !!T 'value') cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1        \n    unaligned. 0x01\n    stobj !!T\n    ret\n} // end of method Unsafe::WriteUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefからvoidポインターへコピーする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eからvoidポインターへコピーする\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003edestination\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void Copy\u0026lt;T\u0026gt;(void* destination,\n                                            !!T\u0026amp; source) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    ldobj !!T\n    stobj !!T\n    ret\n} // end of method Unsafe::Copy\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"voidポインターからジェネリック型のrefへコピーする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evoidポインターからジェネリック型の\u003ccode\u003eref\u003c/code\u003eへコピーする\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edestination\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e*(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void Copy\u0026lt;T\u0026gt;(!!T\u0026amp; destination,\n                                            void* source) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    ldobj !!T\n    stobj !!T\n    ret\n} // end of method Unsafe::Copy\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"voidポインターから指定されたバイト数分voidポインターへコピーするcで云うmemcpy\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8Bc%E3%81%A7%E4%BA%91%E3%81%86memcpy\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evoidポインターから指定されたバイト数分、voidポインターへコピーする(Cで云う\u003ccode\u003ememcpy\u003c/code\u003e)\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCopyBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL cpblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopyBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void CopyBlock(void* destination, void* source, uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    cpblk\n    ret\n} // end of method Unsafe::CopyBlock\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"byte型のrefから指定されたバイト数分byte型のrefへコピーするcで云うmemcpy\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#byte%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8Bc%E3%81%A7%E4%BA%91%E3%81%86memcpy\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ebyte型の\u003ccode\u003eref\u003c/code\u003eから指定されたバイト数分、byte型の\u003ccode\u003eref\u003c/code\u003eへコピーする(Cで云う\u003ccode\u003ememcpy\u003c/code\u003e)\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCopyBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL cpblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopyBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void CopyBlock(uint8\u0026amp; destination, uint8\u0026amp; source, uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    cpblk\n    ret\n} // end of method Unsafe::CopyBlock\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされていないvoidポインターから指定されたバイト数分voidポインターへコピーする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされていないvoidポインターから指定されたバイト数分、voidポインターへコピーする\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCopyBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL cpblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopyBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void CopyBlockUnaligned(void* destination, void* source, uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    unaligned. 0x1\n    cpblk\n    ret\n} // end of method Unsafe::CopyBlockUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アラインメントされていないbyte型のrefから指定されたバイト数分voidポインターへコピーする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアラインメントされていないbyte型の\u003ccode\u003eref\u003c/code\u003eから指定されたバイト数分、voidポインターへコピーする\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eCopyBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL cpblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCopyBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void CopyBlockUnaligned(uint8\u0026amp; destination, uint8\u0026amp; source, uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    unaligned. 0x1\n    cpblk\n    ret\n} // end of method Unsafe::CopyBlockUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"voidポインターへ指定されたバイト数分バイト値を書き込むcで云うmemset\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evoidポインターへ指定されたバイト数分、バイト値を書き込む(Cで云う\u003ccode\u003ememset\u003c/code\u003e)\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL initblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInitBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void InitBlock(void* startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    initblk\n    ret\n} // end of method Unsafe::InitBlock\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"byte型のrefへ指定されたバイト数分バイト値を書き込むcで云うmemset\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ebyte型の\u003ccode\u003eref\u003c/code\u003eへ指定されたバイト数分、バイト値を書き込む(Cで云う\u003ccode\u003ememset\u003c/code\u003e)\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL initblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInitBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void InitBlock(uint8\u0026amp; startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    initblk\n    ret\n} // end of method Unsafe::InitBlock\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アライメントされていないvoidポインターへ指定されたバイト数分バイト値を書き込むcで云うmemset\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアライメントされていないvoidポインターへ指定されたバイト数分、バイト値を書き込む(Cで云う\u003ccode\u003ememset\u003c/code\u003e)\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL initblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInitBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void InitBlockUnaligned(void* startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    unaligned. 0x1\n    initblk\n    ret\n} // end of method Unsafe::InitBlockUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"アライメントされていないbyte型のrefへ指定されたバイト数分バイト値を書き込むcで云うmemset\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアライメントされていないbyte型の\u003ccode\u003eref\u003c/code\u003eへ指定されたバイト数分、バイト値を書き込む(Cで云う\u003ccode\u003ememset\u003c/code\u003e)\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eInitBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003euint\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// IL initblk instruction\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInitBlockUnaligned\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003estartAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void InitBlockUnaligned(uint8\u0026amp; startAddress, uint8 'value', uint32 byteCount) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    ldarg.2\n    unaligned. 0x1\n    initblk\n    ret\n} // end of method Unsafe::InitBlockUnaligned\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"アドレス演算系\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E6%BC%94%E7%AE%97%E7%B3%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアドレス演算系\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefを要素数分の加算する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E3%81%AE%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eを要素数分の加算する\u003c/h3\u003e\n\n\u003cp\u003eC++で云う\u003ccode\u003e(T\u0026amp;)(((T*)\u0026amp;source)+elementOffset)\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; Add\u0026lt;T\u0026gt;(!!T\u0026amp; source, int32 elementOffset) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    sizeof !!T\n    conv.i\n    mul\n    add\n    ret\n} // end of method Unsafe::Add\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefを要素数分加算する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eを要素数分加算する\u003c/h3\u003e\n\n\u003cp\u003eこちらはnative int版\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; Add\u0026lt;T\u0026gt;(!!T\u0026amp; source, native int elementOffset) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    sizeof !!T\n    mul\n    add\n    ret\n} // end of method Unsafe::Add\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"voidポインターをジェネリック型として要素数分加算する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%A8%E3%81%97%E3%81%A6%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evoidポインターをジェネリック型として要素数分加算する\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void* Add\u0026lt;T\u0026gt;(void* source, int32 elementOffset) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    sizeof !!T\n    conv.i\n    mul\n    add\n    ret\n} // end of method Unsafe::Add\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefへ指定バイト数分加算する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eへ指定バイト数分加算する\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eAddByteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddByteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; AddByteOffset\u0026lt;T\u0026gt;(!!T\u0026amp; source, native int byteOffset) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    add\n    ret\n} // end of method Unsafe::AddByteOffset\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefを要素数分減算する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eを要素数分減算する\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eref *(((T*)\u0026amp;source) - elementOffset)\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eSubtract\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubtract\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; Subtract\u0026lt;T\u0026gt;(!!T\u0026amp; source, int32 elementOffset) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    sizeof !!T\n    conv.i\n    mul\n    sub\n    ret\n} // end of method Unsafe::Subtract\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefを要素数分加算する-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eを要素数分加算する\u003c/h3\u003e\n\n\u003cp\u003eこちらはnative int版\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eSubtract\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubtract\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; Subtract\u0026lt;T\u0026gt;(!!T\u0026amp; source, native int elementOffset) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    sizeof !!T\n    mul\n    sub\n    ret\n} // end of method Unsafe::Subtract\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"voidポインターをジェネリック型として要素数分減算する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%A8%E3%81%97%E3%81%A6%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evoidポインターをジェネリック型として要素数分減算する\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eref *(((T*)source) - elementOffset)\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eSubtract\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e*)\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eelementOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static void* Subtract\u0026lt;T\u0026gt;(void* source, int32 elementOffset) cil managed aggressiveinlining\n{\n    .maxstack 3\n    ldarg.0\n    ldarg.1\n    sizeof !!T\n    conv.i\n    mul\n    sub\n    ret\n} // end of method Unsafe::Subtract\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ジェネリック型のrefへ指定バイト数分減算する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eジェネリック型の\u003ccode\u003eref\u003c/code\u003eへ指定バイト数分減算する\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eref *((T*)(((byte*)\u0026amp;source) - byteOffset))\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eSubtractByteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSubtractByteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebyteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; SubtractByteOffset\u0026lt;T\u0026gt;(!!T\u0026amp; source, native int byteOffset) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    sub\n    ret\n} // end of method Unsafe::SubtractByteOffset\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"refと同じ型の別のrefの差を求める\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ref%E3%81%A8%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%88%A5%E3%81%AEref%E3%81%AE%E5%B7%AE%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eref\u003c/code\u003eと同じ型の別の\u003ccode\u003eref\u003c/code\u003eの差を求める\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003e(byte*)(ref right) - (byte*)(ref left)\u003c/code\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003eByteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eorigin\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eUnsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eByteOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eorigin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static native int ByteOffset\u0026lt;T\u0026gt;(!!T\u0026amp; origin, !!T\u0026amp; target) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.1\n    ldarg.0\n    sub\n    ret\n} // end of method Unsafe::ByteOffset\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"アドレス比較系\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E6%AF%94%E8%BC%83%E7%B3%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eアドレス比較系\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"refが同じ値かどうかを比較する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ref%E3%81%8C%E5%90%8C%E3%81%98%E5%80%A4%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eref\u003c/code\u003eが同じ値かどうかを比較する\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eAreSame\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static bool AreSame\u0026lt;T\u0026gt;(!!T\u0026amp; left, !!T\u0026amp; right) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    ceq\n    ret \n} // end of method Unsafe::AreSame\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"refが右辺より大きいか比較する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ref%E3%81%8C%E5%8F%B3%E8%BE%BA%E3%82%88%E3%82%8A%E5%A4%A7%E3%81%8D%E3%81%84%E3%81%8B%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eref\u003c/code\u003eが右辺より大きいか比較する\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIsAddressGreaterThan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static bool IsAddressGreaterThan\u0026lt;T\u0026gt;(!!T\u0026amp; left, !!T\u0026amp; right) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    cgt.un\n    ret \n} // end of method Unsafe::IsAddressGreaterThan\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"refが右辺より小さいか比較する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ref%E3%81%8C%E5%8F%B3%E8%BE%BA%E3%82%88%E3%82%8A%E5%B0%8F%E3%81%95%E3%81%84%E3%81%8B%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eref\u003c/code\u003eが右辺より小さいか比較する\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003eIsAddressLessThan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static bool IsAddressLessThan\u0026lt;T\u0026gt;(!!T\u0026amp; left, !!T\u0026amp; right) cil managed aggressiveinlining\n{\n    .maxstack 2\n    ldarg.0\n    ldarg.1\n    clt.un\n    ret \n} // end of method Unsafe::IsAddressLessThan\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"他\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BB%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e他\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"マーシャリングを考慮しないサイズを求める\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0%E3%82%92%E8%80%83%E6%85%AE%E3%81%97%E3%81%AA%E3%81%84%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマーシャリングを考慮しないサイズを求める\u003c/h3\u003e\n\n\u003cp\u003eunsafeコンテキストで\u003ccode\u003esizeof()\u003c/code\u003eすることと同じ。\u003cbr\u003e\n\u003ccode\u003eMarshal.SizeOf()\u003c/code\u003eはマーシャリングを考慮する。\u003c/p\u003e\n\n\u003cp\u003e個人的には\u003ccode\u003ewhere T : unmanaged\u003c/code\u003eをつけて欲しい。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eSizeOf\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static int32 SizeOf\u0026lt;T\u0026gt;() cil managed aggressiveinlining\n{\n    .maxstack 1\n    sizeof !!T\n    ret\n} // end of method Unsafe::SizeOf\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"net-core-3以降またはnuget-パッケージの最新少なくとも471以降\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#net-core-3%E4%BB%A5%E9%99%8D%E3%81%BE%E3%81%9F%E3%81%AFnuget-%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E6%9C%80%E6%96%B0%E5%B0%91%E3%81%AA%E3%81%8F%E3%81%A8%E3%82%82471%E4%BB%A5%E9%99%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e.NET Core 3以降またはNuGet パッケージの最新(少なくとも4.7.1以降)\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"box化された構造体オブジェクト参照の内部のrefを取得する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#box%E5%8C%96%E3%81%95%E3%82%8C%E3%81%9F%E6%A7%8B%E9%80%A0%E4%BD%93%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%8F%82%E7%85%A7%E3%81%AE%E5%86%85%E9%83%A8%E3%81%AEref%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ebox化された構造体(オブジェクト参照)の内部の\u003ccode\u003eref\u003c/code\u003eを取得する\u003c/h3\u003e\n\n\u003cp\u003eC++/CLIで云う\u003ccode\u003ecli::interior_ptr\u003c/code\u003eと等価。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"n\"\u003eUnbox\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ebox\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ewhere\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003estruct\u003c/span\u003e\n\u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eref\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ebox\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e.method public hidebysig static !!T\u0026amp; Unbox\u0026lt;valuetype .ctor ([CORE_ASSEMBLY]System.ValueType) T\u0026gt; (object 'box') cil managed aggressiveinlining\n{\n    .maxstack 1\n    ldarg.0\n    unbox !!T\n    ret\n} // end of method Unsafe::Unbox\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"net-5以降\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#net-5%E4%BB%A5%E9%99%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e.NET 5以降\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"初期化0クリアをスキップして変数宣言する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%9D%E6%9C%9F%E5%8C%960%E3%82%AF%E3%83%AA%E3%82%A2%E3%82%92%E3%82%B9%E3%82%AD%E3%83%83%E3%83%97%E3%81%97%E3%81%A6%E5%A4%89%E6%95%B0%E5%AE%A3%E8%A8%80%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e初期化(0クリア)をスキップして変数宣言する\u003c/h3\u003e\n\n\u003cp\u003e\u003cdel\u003e多分CLRの対応が必要\u003c/del\u003e \u003ca href=\"https://github.com/dotnet/runtime/issues/29905\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/dotnet/runtime/issues/29905\u003c/a\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"il\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e  .method public hidebysig static void SkipInit\u0026lt;T\u0026gt; ([out] !!T\u0026amp; 'value') cil managed aggressiveinlining\n  {\n        .maxstack 0\n        ret\n  } // end of method Unsafe::SkipInit\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"個人的に欲しいメソッド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%80%8B%E4%BA%BA%E7%9A%84%E3%81%AB%E6%AC%B2%E3%81%97%E3%81%84%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e個人的に欲しいメソッド\u003c/h2\u003e\n\n\u003cp\u003e組み合わせれば実現するが、できれば直接欲しいと思っているメソッドの一覧。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCで云う\u003ccode\u003eoffsetof\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eCで云う\u003ccode\u003ememmove\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003ecpblk\u003c/code\u003eに領域が重なっている場合の保証がないので。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ereadonly ref\u003c/code\u003eへの強制再解釈\u003c/li\u003e\n\u003cli\u003e全体的に\u003ccode\u003ereadonly ref\u003c/code\u003e版のメソッド\n必要無ければ、\u003ccode\u003ereadonly\u003c/code\u003eにしてほしいところだが、オーバーロードできないので多分厳しい。\u003c/li\u003e\n\u003cli\u003eアライメント判定\u003c/li\u003e\n\u003cli\u003eOverlaps判定(\u003ccode\u003eSpan\u0026lt;T\u0026gt;\u003c/code\u003eにはあるけど。)\u003c/li\u003e\n\u003cli\u003eジェネリック型\u003ccode\u003eT where T : unmanaged\u003c/code\u003eのマネージドポインターをポインターへの再解釈\n\u003ccode\u003e\npublic unsafe static T* ATypedsPointer\u0026lt;T\u0026gt;(ref T value) where T : unmanaged\n{\nreturn (T*)Unsafe.AsPointer(ref value);\n}\n\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","createdAt":"2020-07-12T07:52:19Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"MQ5a8o9jtZhkzIJrRAF8E2zQCWvFtHT3RQ==--aMJxN3pbuVtoeCcu--Zc+4zF8nL3ZfAJMQirLEeg==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-07-29T10:41:09Z","likesCount":2,"linkUrl":"https://qiita.com/kenichiuda/items/ce3518c36fe83063a5d9","organization":null,"originalId":1263010,"stockedCount":2,"title":"[C#] Unsafeクラスの各メソッドを簡易解説(逆引き)","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#il%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\"\u003eILについて\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E7%85%A7%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AE%E5%86%8D%E8%A7%A3%E9%87%88%E7%B3%BB\"\u003e参照・ポインターの再解釈系\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%A8%E3%81%97%E3%81%A6%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003eジェネリック型のrefをvoidポインターとして解釈する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%9E%8B%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%82%92%E3%82%B9%E3%82%AD%E3%83%83%E3%83%97%E3%81%97%E3%81%A6object%E5%9E%8B%E3%82%92%E5%8F%82%E7%85%A7%E5%9E%8B%E3%81%AE%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003e型チェックをスキップして、object型を参照型のジェネリック型に再解釈する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%82%E3%82%8B%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E5%88%A5%E3%81%AE%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003eあるジェネリック型のrefを、別のジェネリック型のrefに再解釈する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003evoidポインターをジェネリック型のrefに再解釈する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#readonly-ref%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%AB%E5%86%8D%E8%A7%A3%E9%87%88%E3%81%99%E3%82%8B\"\u003ereadonly refをジェネリック型のrefに再解釈する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%94%E3%83%BC%E8%AA%AD%E3%81%BF%E5%8F%96%E3%82%8A%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E7%B3%BB\"\u003eコピー/読み取り/書き込み系\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%9Fvoid%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99\"\u003eアラインメントされたvoidポインターから、読んだ値を返す\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99\"\u003eアラインメントされていないポインタから、読んだ値を返す\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AE%E3%83%9E%E3%83%8D%E3%83%BC%E3%82%B8%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E8%AA%AD%E3%82%93%E3%81%A0%E5%80%A4%E3%82%92%E8%BF%94%E3%81%99\"\u003eアラインメントされていないbyte型のマネージドポインターから、読んだ値を返す\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%9Fvoid%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80\"\u003eアラインメントされたvoidポインターへ値を書き込む\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80\"\u003eアラインメントされていないvoidポインターへ値を書き込む\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80\"\u003eアラインメントされていないbyte型のrefへ値を書き込む\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003eジェネリック型のrefからvoidポインターへコピーする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003evoidポインターからジェネリック型のrefへコピーする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8Bc%E3%81%A7%E4%BA%91%E3%81%86memcpy\"\u003evoidポインターから指定されたバイト数分、voidポインターへコピーする(Cで云うmemcpy)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#byte%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8Bc%E3%81%A7%E4%BA%91%E3%81%86memcpy\"\u003ebyte型のrefから指定されたバイト数分、byte型のrefへコピーする(Cで云うmemcpy)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003eアラインメントされていないvoidポインターから指定されたバイト数分、voidポインターへコピーする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%B3%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%8B%E3%82%89%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B\"\u003eアラインメントされていないbyte型のrefから指定されたバイト数分、voidポインターへコピーする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003evoidポインターへ指定されたバイト数分、バイト値を書き込む(Cで云うmemset)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003ebyte型のrefへ指定されたバイト数分、バイト値を書き込む(Cで云うmemset)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003eアライメントされていないvoidポインターへ指定されたバイト数分、バイト値を書き込む(Cで云うmemset)\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%A9%E3%82%A4%E3%83%A1%E3%83%B3%E3%83%88%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84byte%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%9F%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E3%83%90%E3%82%A4%E3%83%88%E5%80%A4%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%82%80c%E3%81%A7%E4%BA%91%E3%81%86memset\"\u003eアライメントされていないbyte型のrefへ指定されたバイト数分、バイト値を書き込む(Cで云うmemset)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E6%BC%94%E7%AE%97%E7%B3%BB\"\u003eアドレス演算系\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E3%81%AE%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003eジェネリック型のrefを要素数分の加算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003eジェネリック型のrefを要素数分加算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%A8%E3%81%97%E3%81%A6%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003evoidポインターをジェネリック型として要素数分加算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B\"\u003eジェネリック型のrefへ指定バイト数分加算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B\"\u003eジェネリック型のrefを要素数分減算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%82%92%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E5%8A%A0%E7%AE%97%E3%81%99%E3%82%8B-1\"\u003eジェネリック型のrefを要素数分加算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#void%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%82%92%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%A8%E3%81%97%E3%81%A6%E8%A6%81%E7%B4%A0%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B\"\u003evoidポインターをジェネリック型として要素数分減算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AEref%E3%81%B8%E6%8C%87%E5%AE%9A%E3%83%90%E3%82%A4%E3%83%88%E6%95%B0%E5%88%86%E6%B8%9B%E7%AE%97%E3%81%99%E3%82%8B\"\u003eジェネリック型のrefへ指定バイト数分減算する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ref%E3%81%A8%E5%90%8C%E3%81%98%E5%9E%8B%E3%81%AE%E5%88%A5%E3%81%AEref%E3%81%AE%E5%B7%AE%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003erefと同じ型の別のrefの差を求める\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E6%AF%94%E8%BC%83%E7%B3%BB\"\u003eアドレス比較系\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#ref%E3%81%8C%E5%90%8C%E3%81%98%E5%80%A4%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B\"\u003erefが同じ値かどうかを比較する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ref%E3%81%8C%E5%8F%B3%E8%BE%BA%E3%82%88%E3%82%8A%E5%A4%A7%E3%81%8D%E3%81%84%E3%81%8B%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B\"\u003erefが右辺より大きいか比較する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ref%E3%81%8C%E5%8F%B3%E8%BE%BA%E3%82%88%E3%82%8A%E5%B0%8F%E3%81%95%E3%81%84%E3%81%8B%E6%AF%94%E8%BC%83%E3%81%99%E3%82%8B\"\u003erefが右辺より小さいか比較する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BB%96\"\u003e他\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0%E3%82%92%E8%80%83%E6%85%AE%E3%81%97%E3%81%AA%E3%81%84%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B\"\u003eマーシャリングを考慮しないサイズを求める\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#net-core-3%E4%BB%A5%E9%99%8D%E3%81%BE%E3%81%9F%E3%81%AFnuget-%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E6%9C%80%E6%96%B0%E5%B0%91%E3%81%AA%E3%81%8F%E3%81%A8%E3%82%82471%E4%BB%A5%E9%99%8D\"\u003e.NET Core 3以降またはNuGet パッケージの最新(少なくとも4.7.1以降)\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#box%E5%8C%96%E3%81%95%E3%82%8C%E3%81%9F%E6%A7%8B%E9%80%A0%E4%BD%93%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%8F%82%E7%85%A7%E3%81%AE%E5%86%85%E9%83%A8%E3%81%AEref%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\"\u003ebox化された構造体(オブジェクト参照)の内部のrefを取得する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#net-5%E4%BB%A5%E9%99%8D\"\u003e.NET 5以降\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%9D%E6%9C%9F%E5%8C%960%E3%82%AF%E3%83%AA%E3%82%A2%E3%82%92%E3%82%B9%E3%82%AD%E3%83%83%E3%83%97%E3%81%97%E3%81%A6%E5%A4%89%E6%95%B0%E5%AE%A3%E8%A8%80%E3%81%99%E3%82%8B\"\u003e初期化(0クリア)をスキップして変数宣言する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%80%8B%E4%BA%BA%E7%9A%84%E3%81%AB%E6%AC%B2%E3%81%97%E3%81%84%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\"\u003e個人的に欲しいメソッド\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":1064,"uuid":"ce3518c36fe83063a5d9","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"67fZl6fEbMixyEnZutF+825Ny63S--pqqLJMuEt6zmVA4z--SbYDSsybG5LfkeLPIfpR1w==","originalId":124276,"description":"特にありません","facebookUrl":null,"githubUrl":"https://github.com/udaken","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/124276/profile-images/1473715843","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124276%2Fprofile-images%2F1473715843?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=85f8be92213a5912233c16fe6807bef7","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124276%2Fprofile-images%2F1473715843?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e374ec0bb7acd755d86a370dc58fbc58","urlName":"kenichiuda","websiteUrl":"https://github.com/udaken","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
