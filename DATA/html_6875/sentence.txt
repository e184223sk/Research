More than 3 years have passed since last update.本稿はWPF製デスクトップアプリからネットワーク上のMP3ファイルをストリーミング再生する方法を記載した記事になります。
WPFといえばMVVMモデルですので規模が小さいアプリですがMVVMモデルに従います。
C#でオーディオ再生といえばNAudioが有名みたいですね。本稿でもNAudioを使っています。
コードはGithubにおいているのでよかったら落としてみてください。
https://github.com/smbkrysk14/WpfStreaming再生するMP3ファイルはみんな大好きRebuid.fmのMP3ファイルです。Viewです。シンプルにMP3ファイルまでのURLをテキストボックスに入力してそれを「再生」「停止」「一時停止」できるようにそれぞれボタンを置いただけです。これも至ってシンプル。
テキストボックスに入力されたURLをもとに再生させる処理と停止、一時停止させる処理のみです。
http://cache.rebuild.fm/podcast-ep162a.mp3
が今回使うMP3ファイルまでのURLですね。
毎回テキストボックスに入力するのが面倒だったのでコンストラクタで設定しています。ありません。このクラスが肝です。
ダウンロードと再生を並列で処理させるためダウンロード部分は別スレッドで処理させます。
停止したときMemoryStreamのPositionに0を設定し先頭に戻すようにしています。
これを忘れると停止ではなくて一時停止の動きになります。Thread使っているのがあれですがなんとかストリーミング再生できるようになりました。


