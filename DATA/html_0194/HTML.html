<!DOCTYPE html><html><head><meta charset="utf-8" /><title>UWPでBLE心拍センサからデータを受信してリアルタイムにグラフ化する - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/Eater_WhiteEye/items/e3d036634ae4043a1cf7" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="DQ01KLCEI4kH+m4wBH+I0g0yUrP9fPWSeZLsgcP1WT5/5qtlrB/PUhwmZz3OxnnS0J14U8m+AWynIDDIcrnJnA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@Eater_WhiteEye" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="UWPでBLE心拍センサからデータを受信してリアルタイムにグラフ化する - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVmRRNDRHblFreEY1Yi1ENW91TjQ0Szc0NE96NDRLMTQ0R0w0NEtKNDRPSDQ0Tzg0NEtfNDRLUzVZLVg1TC1oNDRHWDQ0R200NE9xNDRLaTQ0T3I0NEtfNDRLazQ0T2c0NEdyNDRLdzQ0T3A0NE9WNVl5VzQ0R1o0NEtMJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWFhZDY0ZGI2YWQ2ZTE5ZjQwY2MzODljMTBhYWE1NWQ1&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRVZoZEdWeVgxZG9hWFJsUlhsbCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWRlZmI4ZDNlNjg4MGE0MzNiMDAwMDZmODUyMGQ2ZmYz&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=cff4e285c114fca25edd02e72e25ceaf"><meta property="og:description" content="この記事は、Kyoto University Advent Calendar 2020の25日目の記事です。

前日の記事はぴかちゅう鰻さんでした。伝聞調で書かれた真偽不明の噂話を淡々とした語り口で書かれると「このページもリロードした..."><meta content="https://qiita.com/Eater_WhiteEye/items/e3d036634ae4043a1cf7" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,BLE,心拍,UWP,LiveCharts" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-61dd8df2-6196-42ad-b7a3-bf6341462cb0"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2FEater_WhiteEye%2Fitems%2Fe3d036634ae4043a1cf7">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2FEater_WhiteEye%2Fitems%2Fe3d036634ae4043a1cf7">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-61dd8df2-6196-42ad-b7a3-bf6341462cb0">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-12-25T00:00:14.000+09:00","dateModified":"2020-12-25T11:33:08.000+09:00","headline":"UWPでBLE心拍センサからデータを受信してリアルタイムにグラフ化する","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1WVmRRNDRHblFreEY1Yi1ENW91TjQ0Szc0NE96NDRLMTQ0R0w0NEtKNDRPSDQ0Tzg0NEtfNDRLUzVZLVg1TC1oNDRHWDQ0R200NE9xNDRLaTQ0T3I0NEtfNDRLazQ0T2c0NEdyNDRLdzQ0T3A0NE9WNVl5VzQ0R1o0NEtMJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWFhZDY0ZGI2YWQ2ZTE5ZjQwY2MzODljMTBhYWE1NWQ1\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRVZoZEdWeVgxZG9hWFJsUlhsbCZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPWRlZmI4ZDNlNjg4MGE0MzNiMDAwMDZmODUyMGQ2ZmYz\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=cff4e285c114fca25edd02e72e25ceaf","mainEntityOfPage":"https://qiita.com/Eater_WhiteEye/items/e3d036634ae4043a1cf7","author":{"@type":"Person","address":null,"email":null,"identifier":"Eater_WhiteEye","name":"Eater_WhiteEye","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fprofile-images%2F1608661365?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=7f523134254900659f50309341cf7efe","url":"https://qiita.com/Eater_WhiteEye","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">運用ではなくサービス運営の課題解決。LINE Growth Technologyに聞くGrowth開発</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Eater_WhiteEye","type":"items","id":"e3d036634ae4043a1cf7"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"運用ではなくサービス運営の課題解決。LINE Growth Technologyに聞くGrowth開発","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Eater_WhiteEye","type":"items","id":"e3d036634ae4043a1cf7"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"運用ではなくサービス運営の課題解決。LINE Growth Technologyに聞くGrowth開発","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"Eater_WhiteEye","type":"items","id":"e3d036634ae4043a1cf7"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"運用ではなくサービス運営の課題解決。LINE Growth Technologyに聞くGrowth開発","url":"https://zine.qiita.com/interview/202107-line-growth-technology/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/Eater_WhiteEye/items/e3d036634ae4043a1cf7","location":"/Eater_WhiteEye/items/e3d036634ae4043a1cf7","scheme":"https","host":"qiita.com","port":null,"pathname":"/Eater_WhiteEye/items/e3d036634ae4043a1cf7","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"M0TqKWrLJYan1caPTA87UnSpJyHtCLwfbDg4KGdu/IZBr3RkdlDJXbwJz4KGtspSqQYNwdnKSOGyiuRh1iJsJA==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-5f36d637-1c58-45ce-bad5-a019e6b82536"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/likers" class="css-1iupg5d">8</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">5</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/e3d036634ae4043a1cf7/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/Eater_WhiteEye"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/profile-images/1608661365" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/Eater_WhiteEye" class="css-10ougpm">@<!-- -->Eater_WhiteEye</a><div class="css-1ay9vb9"><span><meta content="2020-12-24T15:00:14Z"/><time dateTime="2020-12-25T02:33:08Z" class="css-m19uds">updated at 2020-12-25</time></span></div></div></div></div></div><h1 class="css-cgzq40">UWPでBLE心拍センサからデータを受信してリアルタイムにグラフ化する</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/ble" class="css-4czcte">BLE</a><a href="/tags/%e5%bf%83%e6%8b%8d" class="css-4czcte">心拍</a><a href="/tags/uwp" class="css-4czcte">UWP</a><a href="/tags/livecharts" class="css-4czcte">LiveCharts</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>この記事は、<a href="https://adventar.org/calendars/5040" rel="nofollow noopener" target="_blank">Kyoto University Advent Calendar 2020</a>の25日目の記事です。</p>

<p>前日の記事は<a href="https://note.com/pikachu_unagi/n/n78de1efd2d5b" rel="nofollow noopener" target="_blank">ぴかちゅう鰻</a>さんでした。伝聞調で書かれた真偽不明の噂話を淡々とした語り口で書かれると「このページもリロードしたら404にならない？」って気分になりますね。<a href="http://scp-jp.wikidot.com/" rel="nofollow noopener" target="_blank">SCP</a>は良いぞ。<a href="http://scp-jp.wikidot.com/scp-8900-ex" rel="nofollow noopener" target="_blank">『青い、青い空』</a>とか好き。</p>

<p>さてさて今日はクリスマスですね。メリークリスマス！教会暦では日没で日が替わるので厳密には24日日没からクリスマスです。もう始まっちゃってるんでアドカレの25日目なんて言わば後の葵ってやつですよ<sup id="fnref1"><a href="#fn1" title="これは京都大学が京都にあることと京都を代表する祭りである葵祭をかけたとても面白いジョーク。">1</a></sup>。ゆえに僕はトリじゃない！！！トリは昨日だ！！！<br>
……ともあれ町中が華やぐ日です。きっとみなさんは一段と充実した一日をお過ごしになることでしょう<sup id="fnref2"><a href="#fn2" title="感染症には十分お気を付けください">2</a></sup>。僕はボスと仲良く卒論の中間発表！もしかしたら夜景作る側かもしれんな！</p>

<h1>
<span id="概要" class="fragment"></span><a href="#%E6%A6%82%E8%A6%81"><i class="fa fa-link"></i></a>概要</h1>

<p>Q.何作ったんですか？<br>
A.BLE心拍センサ（OH1）から心拍数を受け取ってPCでLiveChartsを使い順次グラフをプロットするプログラムを作成しました。<br>
<a href="https://github.com/Eater-Git/HeartRateVisualizer" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/Eater-Git/HeartRateVisualizer</a></p>

<h1>
<span id="自己紹介" class="fragment"></span><a href="#%E8%87%AA%E5%B7%B1%E7%B4%B9%E4%BB%8B"><i class="fa fa-link"></i></a>自己紹介</h1>

<p>京大電電のEaterです。電子工作を昔からやっていてロボットとか作ってます。下の写真のロボットのアーム部分制御したりとか。この時は「審査締め切り直前に屋外で深夜にデスマをやるととてもきれいな写真が撮れる」という重要な知見が得られました。<br>
<a href="https://camo.qiitausercontent.com/90a10dde3435a05f31ee460b4cc7956909378155/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f33313733343138632d623662392d313762352d313861312d6361633936353866613034622e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F3173418c-b6b9-17b5-18a1-cac9658fa04b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=96b32f4b1e21aae9c184b1dd8ae43832" alt="20190420_152738160_iOS.jpg" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/3173418c-b6b9-17b5-18a1-cac9658fa04b.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F3173418c-b6b9-17b5-18a1-cac9658fa04b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e53d8c37168f723aab656416b694924e 1x" loading="lazy"></a></p>

<h1>
<span id="開発のきっかけ" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E3%81%AE%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91"><i class="fa fa-link"></i></a>開発のきっかけ</h1>

<p>―――深夜テンションって怖いよね―――<br>
それは9月某日、午前4時くらいの事だったと思います。コロナ禍で友人とのゲーム時間が劇的に増加し、その流れでDbD（Dead by Daylight）<sup id="fnref3"><a href="#fn3" title="脱出ゲートの開放を試みる4人の生存者と、彼らを生贄に捧げようとする殺人鬼の非対称PvPゲーム">3</a></sup>を購入して数日のころです。その日も友人らと建てたDiscordのゲームサーバでDbDをプレイしていました。<br>
 <strong>「DbDプレイ中のEaterの心拍取ったら面白そう」</strong><br>
誰が言った言葉だったでしょうか。僕はホラーゲームが大変苦手です。DbDもその例に漏れませんでした。マッチが成立すると同時に鼓動は速くなり、儀式<sup id="fnref4"><a href="#fn4" title="試合のことをそう呼びます">4</a></sup>が始まるとマウスは震え視界はちらつき、殺人鬼に吊られると悲鳴を上げるようなありさまでした。<br>
こんな僕の事ですから心拍数の変動が激しいことは容易に想像がつきます。面白いデータが得られるのは明らかでしょう。即決で心拍センサを購入。1万円を超えていました。金銭感覚はとうの昔に眠りについていたようです。</p>

<p>そんなわけで<a href="https://www.polar.com/ja/products/accessories/oh1-optical-heart-rate-sensor" rel="nofollow noopener" target="_blank"><strong>BLE心拍センサOH1</strong></a>を手に入れました。スマホとの連携はアプリがあるので簡単です。さっそく装着してDbDをプレイしてみます。<br>
<a href="https://camo.qiitausercontent.com/5da774240c0dece49ff2959634a730d2ae56b21b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f61626464656264392d353232652d386536632d643766612d3036643035653931396663302e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fabddebd9-522e-8e6c-d7fa-06d05e919fc0.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=87cd9d84d206a52c4be19fcf4c3ae9d9" alt="unknown_LI.jpg" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/abddebd9-522e-8e6c-d7fa-06d05e919fc0.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fabddebd9-522e-8e6c-d7fa-06d05e919fc0.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=a222b27ad89d2d05cccab21b2fc39275 1x" loading="lazy"></a><br>
<a href="https://camo.qiitausercontent.com/1f1a96a98befe84f7571a353d10a85135ea82199/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f66346438373735662d333665372d333739662d333531332d3636653834303638303861342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Ff4d8775f-36e7-379f-3513-66e8406808a4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=cbb7c594729aace99c323de12ba847a5" alt="IMG_3187.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/f4d8775f-36e7-379f-3513-66e8406808a4.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Ff4d8775f-36e7-379f-3513-66e8406808a4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b285e5116d9abd71b1c6f69bd3b11ce7 1x" loading="lazy"></a><br>
「心拍数120www」<br>
「まともなチェイスができないのもこんな状態なら分かる」<br>
「山の数とプレイ回数同じじゃん」<br>
「全力疾走級の心拍でゲームしてるEaterが面白くないわけがない」</p>

<p>当初はこんな感じでPCにミラーリングしたりスマホのスクショをチャットに貼ったりして盛り上がっていました。しかしミラーリングは接続が不安定です。スクショでは物足りません。見たいのはリアルタイムにビビるさまですからね！！！</p>

<p>―――Eaterは自前でPC用アプリを開発することにした。</p>

<h1>
<span id="ツール選定" class="fragment"></span><a href="#%E3%83%84%E3%83%BC%E3%83%AB%E9%81%B8%E5%AE%9A"><i class="fa fa-link"></i></a>ツール選定</h1>

<p>―――PCアプリなんもわからん―――<br>
「PC(Win10)でBLE心拍センサのデータを受信し、リアルタイムにグラフで表示する」　<br>
やりたいことはこれです。BLEをどうやって受信するのか。グラフはどうやって表示するのか。慣れ親しんでいるのは組み込みマイコンのプログラミングで、PCでの開発はせいぜいUnityをかじった程度です。暗中模索といった感じでした。<br>
<strong>C#</strong>なら<strong>Windows</strong>に強そう。<strong>UWP</strong>は標準で<strong>Bluetooth</strong>使えるじゃん。<strong>LiveCharts</strong>っていう.NET向け<strong>グラフ表示</strong>用のおしゃれなライブラリがあるらしい……。<br>
というわけでプラットフォームはUWPを採用、グラフ表示にはLiveChartsを使うことにしました。</p>

<h1>
<span id="ble通信" class="fragment"></span><a href="#ble%E9%80%9A%E4%BF%A1"><i class="fa fa-link"></i></a>BLE通信</h1>

<p>―――はじめてのBLEつうしん―――<br>
なんもわからんのでとりあえずGoogle大先生のご神託を仰ぎます。いくつか参考になるサイトが見つかりました。<br>
BLEの仕組みは『<a href="https://qiita.com/tera1707/items/e04d86a68a9f96e02fe9" id="reference-4092e63ad3e529d98707">[C#/WinRT]Bluetooth v4(BLE)機器と通信する（BLE基礎メモ）</a>』とかMicrosoftの『<a href="https://docs.microsoft.com/ja-jp/windows/uwp/devices-sensors/bluetooth-low-energy-overview" rel="nofollow noopener" target="_blank">Bluetooth 低エネルギー</a>』とかで勉強しつつ、『<a href="https://qiita.com/gebo/items/41da7474936845d77d06" id="reference-3cecbfcedd6c8b2a195a">WindowsデスクトップアプリでBLEのGATTで体温計と血圧計と通信する</a>』とか『<a href="https://docs.microsoft.com/ja-jp/windows/uwp/devices-sensors/ble-beacon" rel="nofollow noopener" target="_blank">Bluetooth LE アドバタイズ</a>』のコードを参考にコードを書きました。<br>
ざっくり説明してみます。BLEデバイスが提供している機能はServiceという形で表現されます。今回使う心拍センサOH1は<strong>Heart Rate Service</strong>を持っています。Heart Rate Serviceの中にはいくつかの<strong>Characteristic</strong>が含まれており、今回ほしいのは<strong>Heart Rate Measurement</strong>です。<br>
しかしアプリ起動時には通信が確立していません。OH1を探すところから始まります。そこで使うのが<strong>アドバタイズパケット</strong>です。これはデバイス側が自身の情報を発信しているパケットで、待ち受けておけば誰でも受信することができます。<br>
これらを踏まえて今回のコードではまずアドバタイズパケットを待ち受ける設定をしています。受信したらパケットの中身を見てHeart Rate Serviceを持っているか判定しています。持っていればOH1かなんかの心拍センサなのでアドバタイズパケットの待ち受けを停止し、Serviceの持つCharacteristic一覧からHeart Rate Measurementを探して心拍数を受信する設定をしています。説明終わり。<br>
Heart Rate Serviceの中にはほかにもいくつかCharacteristicが含まれているのですがどういうものなのかよくわかっていません。詳しい方がいらっしゃいましたらご教授願えますと幸いです。</p>

<p><details><summary>BLEを読むクラス</summary><div>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">HeartRateConnection.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">using</span> <span class="nn">Windows.Devices.Bluetooth</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Windows.Devices.Bluetooth.Advertisement</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Windows.Devices.Bluetooth.GenericAttributeProfile</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Windows.Devices.Enumeration</span><span class="p">;</span>

<span class="k">using</span> <span class="nn">System.ServiceModel.Channels</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Windows.UI.Xaml.Controls</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Windows.UI.Popups</span><span class="p">;</span>

<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Windows.Devices.Gpio</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Windows.ApplicationModel.Store.Preview.InstallControl</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HeartRateVisualizer</span>
<span class="p">{</span>

    <span class="k">class</span> <span class="nc">HeartRateEventArgs</span> <span class="p">:</span> <span class="n">EventArgs</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">heart_rate</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">datetime</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">HeartRateConnection</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">GattDeviceService</span> <span class="n">Service</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">BluetoothLEAdvertisementWatcher</span> <span class="n">advWatcher</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">event</span> <span class="n">EventHandler</span> <span class="n">ConnectBLE</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">event</span> <span class="n">EventHandler</span> <span class="n">GetHeartRate</span><span class="p">;</span>


        <span class="k">public</span> <span class="kt">int</span> <span class="n">heart_rate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="nf">HeartRateConnection</span><span class="p">()</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">advWatcher</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">BluetoothLEAdvertisementWatcher</span><span class="p">();</span>
            <span class="n">advWatcher</span><span class="p">.</span><span class="n">Received</span> <span class="p">+=</span> <span class="n">WathcerReceived</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">advWatcher</span><span class="p">.</span><span class="n">ScanningMode</span> <span class="p">=</span> <span class="n">BluetoothLEScanningMode</span><span class="p">.</span><span class="n">Active</span><span class="p">;</span>  <span class="c1">//これがないとサービスとかデバイス名の情報が得られないっぽい？</span>
            <span class="n">advWatcher</span><span class="p">.</span><span class="n">SignalStrengthFilter</span><span class="p">.</span><span class="n">SamplingInterval</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromMilliseconds</span><span class="p">(</span><span class="m">700</span><span class="p">);</span><span class="c1">//重さ改善</span>
            <span class="k">this</span><span class="p">.</span><span class="n">advWatcher</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

        <span class="p">}</span>

        <span class="k">private</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">WathcerReceived</span><span class="p">(</span><span class="n">BluetoothLEAdvertisementWatcher</span> <span class="n">sender</span><span class="p">,</span> <span class="n">BluetoothLEAdvertisementReceivedEventArgs</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>

            <span class="c1">// アドバタイズパケット受信→HeartRateサービスを検索</span>
            <span class="kt">bool</span> <span class="n">find</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">bleServiceUUIDs</span> <span class="p">=</span> <span class="n">args</span><span class="p">.</span><span class="n">Advertisement</span><span class="p">.</span><span class="n">ServiceUuids</span><span class="p">;</span>


            <span class="n">BluetoothLEDevice</span> <span class="n">dev</span> <span class="p">=</span> <span class="k">await</span> <span class="n">BluetoothLEDevice</span><span class="p">.</span><span class="nf">FromBluetoothAddressAsync</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">BluetoothAddress</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dev</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 発見</span>
            <span class="n">GattDeviceServicesResult</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">dev</span><span class="p">.</span><span class="nf">GetGattServicesAsync</span><span class="p">(</span><span class="cm">/*GattServiceUuids.HeartRate*/</span><span class="p">);</span>


            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">GattCommunicationStatus</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">services</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Services</span><span class="p">;</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">service</span> <span class="k">in</span> <span class="n">services</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">service</span><span class="p">.</span><span class="n">Uuid</span> <span class="p">==</span> <span class="n">GattServiceUuids</span><span class="p">.</span><span class="n">HeartRate</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">Service</span> <span class="p">=</span> <span class="n">service</span><span class="p">;</span>
                        <span class="n">find</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">advWatcher</span><span class="p">.</span><span class="nf">Stop</span><span class="p">();</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">//発見したデバイスがHeartRateサービスを持っていたら</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">find</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="p">{</span>
                    <span class="kt">var</span> <span class="n">characteristics</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Service</span><span class="p">.</span><span class="nf">GetCharacteristicsForUuidAsync</span><span class="p">(</span><span class="n">GattCharacteristicUuids</span><span class="p">.</span><span class="n">HeartRateMeasurement</span><span class="p">);</span>



                    <span class="k">if</span><span class="p">(</span><span class="n">characteristics</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">GattCommunicationStatus</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
                    <span class="p">{</span>

                        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">chr</span> <span class="k">in</span> <span class="n">characteristics</span><span class="p">.</span><span class="n">Characteristics</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="n">chr</span><span class="p">.</span><span class="n">Uuid</span> <span class="p">==</span> <span class="n">GattCharacteristicUuids</span><span class="p">.</span><span class="n">HeartRateMeasurement</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="k">this</span><span class="p">.</span><span class="n">Characteristic_HeartRate_Measurement</span> <span class="p">=</span> <span class="n">chr</span><span class="p">;</span>

                                <span class="c1">//データの送り方が二種類あるので場合分け。OH1はNotifyなのでそちら側しか動作確認をしていない</span>
                                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Characteristic_HeartRate_Measurement</span><span class="p">.</span><span class="n">CharacteristicProperties</span><span class="p">.</span><span class="nf">HasFlag</span><span class="p">(</span><span class="n">GattCharacteristicProperties</span><span class="p">.</span><span class="n">Indicate</span><span class="p">))</span>
                                <span class="p">{</span>
                                    <span class="k">this</span><span class="p">.</span><span class="n">Characteristic_HeartRate_Measurement</span><span class="p">.</span><span class="n">ValueChanged</span> <span class="p">+=</span> <span class="n">characteristicChanged_HeartRate_Measurement</span><span class="p">;</span>
                                    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="n">Characteristic_HeartRate_Measurement</span><span class="p">.</span><span class="nf">WriteClientCharacteristicConfigurationDescriptorAsync</span><span class="p">(</span><span class="n">GattClientCharacteristicConfigurationDescriptorValue</span><span class="p">.</span><span class="n">Indicate</span><span class="p">);</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Characteristic_HeartRate_Measurement</span><span class="p">.</span><span class="n">CharacteristicProperties</span><span class="p">.</span><span class="nf">HasFlag</span><span class="p">(</span><span class="n">GattCharacteristicProperties</span><span class="p">.</span><span class="n">Notify</span><span class="p">))</span>
                                <span class="p">{</span>
                                    <span class="k">this</span><span class="p">.</span><span class="n">Characteristic_HeartRate_Measurement</span><span class="p">.</span><span class="n">ValueChanged</span> <span class="p">+=</span> <span class="n">characteristicChanged_HeartRate_Measurement</span><span class="p">;</span>
                                    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="n">Characteristic_HeartRate_Measurement</span><span class="p">.</span><span class="nf">WriteClientCharacteristicConfigurationDescriptorAsync</span><span class="p">(</span><span class="n">GattClientCharacteristicConfigurationDescriptorValue</span><span class="p">.</span><span class="n">Notify</span><span class="p">);</span>
                                <span class="p">}</span>
                                <span class="nf">OnConnectBLE</span><span class="p">(</span><span class="n">EventArgs</span><span class="p">.</span><span class="n">Empty</span><span class="p">);</span>
                                <span class="k">break</span><span class="p">;</span>

                            <span class="p">}</span>

                        <span class="p">}</span>

                    <span class="p">}</span>
                    <span class="k">else</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">advWatcher</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
                    <span class="p">}</span>
                <span class="p">}</span>

            <span class="p">}</span>
        <span class="p">}</span>


        <span class="k">private</span> <span class="n">GattCharacteristic</span> <span class="n">Characteristic_HeartRate_Measurement</span><span class="p">;</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">characteristicChanged_HeartRate_Measurement</span><span class="p">(</span><span class="n">GattCharacteristic</span> <span class="n">sender</span><span class="p">,</span> <span class="n">GattValueChangedEventArgs</span> <span class="n">eventArgs</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">data</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="n">eventArgs</span><span class="p">.</span><span class="n">CharacteristicValue</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>
            <span class="n">Windows</span><span class="p">.</span><span class="n">Storage</span><span class="p">.</span><span class="n">Streams</span><span class="p">.</span><span class="n">DataReader</span><span class="p">.</span><span class="nf">FromBuffer</span><span class="p">(</span><span class="n">eventArgs</span><span class="p">.</span><span class="n">CharacteristicValue</span><span class="p">).</span><span class="nf">ReadBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
            <span class="n">heart_rate</span> <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
            <span class="n">HeartRateEventArgs</span> <span class="n">arg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HeartRateEventArgs</span><span class="p">();</span>
            <span class="n">arg</span><span class="p">.</span><span class="n">heart_rate</span> <span class="p">=</span> <span class="n">heart_rate</span><span class="p">;</span>
            <span class="n">arg</span><span class="p">.</span><span class="n">datetime</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
            <span class="nf">OnGetHeartRate</span><span class="p">(</span><span class="n">arg</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnConnectBLE</span><span class="p">(</span><span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ConnectBLE</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnGetHeartRate</span><span class="p">(</span><span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">GetHeartRate</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
</div>

<p></p>
</div></details></p>

<p>長い間ハマっていたのはこの部分です。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="k">this</span><span class="p">.</span><span class="n">advWatcher</span><span class="p">.</span><span class="n">ScanningMode</span> <span class="p">=</span> <span class="n">BluetoothLEScanningMode</span><span class="p">.</span><span class="n">Active</span><span class="p">;</span> 
</code></pre></div></div>

<p>アドバタイズパケットに載っている情報は少ないらしく、アクティブモードでスキャンしないと必要な情報が得られないみたいでした。『<a href="https://qiita.com/gebo/items/2e51bebd3d26a3025d9f" id="reference-1182302d205e2e4d86e8">BLEアドバタイズパケットの中身を調べてみた</a>』が詳しいです。あと<strong>Package.appxmanifest</strong>の<strong>機能</strong>のところでBluetoothにチェックをつけておかないと動きません。</p>

<p>なんやかんやで出来上がったこのクラスをこんな感じで呼べば動きます。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="n">HeartRateConnection</span> <span class="n">OH1</span><span class="p">;</span>
<span class="n">OH1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HeartRateConnection</span><span class="p">();</span>
<span class="n">OH1</span><span class="p">.</span><span class="n">ConnectBLE</span> <span class="p">+=</span> <span class="n">ShowGraph</span><span class="p">;</span><span class="c1">//BLEデバイスとの接続が確立したときに呼んでほしい関数を投げておく。</span>
<span class="n">OH1</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
</code></pre></div></div>

<p><a href="https://camo.qiitausercontent.com/93db06903361230f1531ef666c4abff4066897c5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f62613837343532362d653065332d646563382d313836342d6664386464303933323336362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fba874526-e0e3-dec8-1864-fd8dd0932366.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=be402427f14f95d74aa57db576304cd0" alt="スクリーンショット (311).png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/ba874526-e0e3-dec8-1864-fd8dd0932366.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fba874526-e0e3-dec8-1864-fd8dd0932366.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b7f388ef864715f1031dfa7df4fd67f1 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/0b8def3f62924931cfdcd0944f20338f2876c1cf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f38633266653434382d373935652d356532302d336434392d3737393336666361393561612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8c2fe448-795e-5e20-3d49-77936fca95aa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=65c348dd18978ce79eba74c782384eee" alt="スクリーンショット (312).png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/8c2fe448-795e-5e20-3d49-77936fca95aa.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8c2fe448-795e-5e20-3d49-77936fca95aa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8a3b9fc947da5cd66e404f0411ea1b81 1x" loading="lazy"></a></p>

<p>動いたーーーー！！！</p>

<h1>
<span id="グラフ表示" class="fragment"></span><a href="#%E3%82%B0%E3%83%A9%E3%83%95%E8%A1%A8%E7%A4%BA"><i class="fa fa-link"></i></a>グラフ表示</h1>

<p>―――公式サンプル「コピペで動くといったな。あれは嘘だ」―――<br>
次はグラフ表示です。<strong>LiveCharts</strong>というパッケージを使います。<br>
LiveCharts公式で<a href="https://lvcharts.net/App/examples/v1/uwp/Constant%20Changes" rel="nofollow noopener" target="_blank">おあつらえ向きなサンプルコード</a>を発見しました。コピペしてちょっといじればすぐできそうに思えます。<br>
で、試しました。NuGetパッケージマネージャで<strong>LiveCharts.Uwp</strong>をインストールして、サンプルコードをコピペしたソリューションを立てます。<br>
ビルドボタンをぽちっとな。<br>
<a href="https://camo.qiitausercontent.com/468e0485e2edb65ee9e4e7aaa0fc52fb8b26f2c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f65623964366237342d626566342d343063632d616332632d3633313638323433626665342e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Feb9d6b74-bef4-40cc-ac2c-63168243bfe4.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e53228fe008f07bc0aa78d7a2a3070ec" alt="スクリーンショット (320)_LI.jpg" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/eb9d6b74-bef4-40cc-ac2c-63168243bfe4.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Feb9d6b74-bef4-40cc-ac2c-63168243bfe4.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8efb5a79cb4afae87e33d3da621f6b4e 1x" loading="lazy"></a></p>

<p>なんか見たことないエラー出たが？？？</p>

<p>原因が全然わかりません。xamlファイルを見てみると無効なマークアップとかかれているのでここに原因があるのかなと思っていろいろ試しましたが全然ダメでした。な～んもわからん。<br>
手当たり次第にいろんなところをいじっているとアプリの<strong>ターゲットバージョン</strong>がなぜか最新のWindowsになっていないことに気づきました。<br>
<a href="https://camo.qiitausercontent.com/aaa527bd5033c3e3060ad13510531844a66da68e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f61633439633334622d383864622d323761382d323338662d3638393263323339643565642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fac49c34b-88db-27a8-238f-6892c239d5ed.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3a294df0b53f96d6d785061d53d4dff9" alt="スクリーンショット (321).png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/ac49c34b-88db-27a8-238f-6892c239d5ed.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fac49c34b-88db-27a8-238f-6892c239d5ed.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bd6243ef3c542e5b6fbf92cd1c6e16be 1x" loading="lazy"></a></p>

<p>まさかね。ターゲットバージョンを最新にしただけで動いたら泣くわ。<br>
<a href="https://camo.qiitausercontent.com/1a5e7d9b7711ad06f6a50ac775978a8a0da2ddfd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f35326165656630612d636664342d633263332d376566342d3535663331643033303938632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F52aeef0a-cfd4-c2c3-7ef4-55f31d03098c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=65f735169573e0546a76e60039034547" alt="スクリーンショット (324).png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/52aeef0a-cfd4-c2c3-7ef4-55f31d03098c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F52aeef0a-cfd4-c2c3-7ef4-55f31d03098c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7f7f7ad9dbe64c8845b2bb21830c1e94 1x" loading="lazy"></a></p>

<p>泣いた。時間返して。</p>

<h1>
<span id="別のスレッドにマーシャリングされたインターフェイスを呼び出しました" class="fragment"></span><a href="#%E5%88%A5%E3%81%AE%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%AB%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%95%E3%82%8C%E3%81%9F%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%82%92%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F"><i class="fa fa-link"></i></a>別のスレッドにマーシャリングされたインターフェイスを呼び出しました。</h1>

<p>―――私は誰～～～？ここはどのスレッド～～～？―――<br>
晴れてBLE通信もグラフ表示もできるようになりました。あとはこの二つを組み合わせるだけです！</p>

<div class="code-frame" data-lang="cs">
<div class="code-lang"><span class="bold">MainPage.xaml.cs(一部抜粋)</span></div>
<div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="n">HeartRateConnection</span> <span class="n">OH1</span><span class="p">;</span>

<span class="k">public</span> <span class="nf">MainPage</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">InitializeComponent</span><span class="p">();</span>

    <span class="kt">var</span> <span class="n">mapper</span> <span class="p">=</span> <span class="n">Mappers</span><span class="p">.</span><span class="n">Xy</span><span class="p">&lt;</span><span class="n">MeasureModel</span><span class="p">&gt;()</span>
        <span class="p">.</span><span class="nf">X</span><span class="p">(</span><span class="n">model</span> <span class="p">=&gt;</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">Ticks</span><span class="p">)</span>   <span class="c1">//X軸の設定　nullなら現在時刻</span>
        <span class="p">.</span><span class="nf">Y</span><span class="p">(</span><span class="n">model</span> <span class="p">=&gt;</span> <span class="n">model</span><span class="p">.</span><span class="n">Value</span><span class="p">);</span>           <span class="c1">//Y軸の設定　nullなら0</span>


    <span class="n">Charting</span><span class="p">.</span><span class="n">For</span><span class="p">&lt;</span><span class="n">MeasureModel</span><span class="p">&gt;(</span><span class="n">mapper</span><span class="p">);</span>


    <span class="n">ChartValues</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ChartValues</span><span class="p">&lt;</span><span class="n">MeasureModel</span><span class="p">&gt;();</span>

    <span class="c1">//軸ラベルの設定</span>
    <span class="n">DateTimeFormatter</span> <span class="p">=</span> <span class="k">value</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">((</span><span class="kt">long</span><span class="p">)(</span><span class="k">value</span><span class="p">)).</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"mm:ss"</span><span class="p">);</span>
    <span class="n">BPMFormatter</span> <span class="p">=</span> <span class="k">value</span> <span class="p">=&gt;</span> <span class="p">((</span><span class="kt">long</span><span class="p">)</span><span class="k">value</span><span class="p">).</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"D"</span><span class="p">);</span>

    <span class="c1">//X軸の目盛りの設定</span>
    <span class="n">AxisStep</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">30</span><span class="p">).</span><span class="n">Ticks</span><span class="p">;</span>
    <span class="nf">SetAxisLimits</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">);</span>

    <span class="c1">//Y軸の目盛りの設定</span>
    <span class="n">BPMAxisStep</span> <span class="p">=</span> <span class="m">10</span><span class="p">;</span>
    <span class="n">BPMAxisMax</span> <span class="p">=</span> <span class="m">150</span><span class="p">;</span>
    <span class="n">BPMAxisMin</span> <span class="p">=</span> <span class="m">50</span><span class="p">;</span>


    <span class="n">DataContext</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="c1">//BLE通信</span>
    <span class="n">OH1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HeartRateConnection</span><span class="p">();</span>
    <span class="n">OH1</span><span class="p">.</span><span class="n">ConnectBLE</span> <span class="p">+=</span> <span class="n">ShowGraph</span><span class="p">;</span>
    <span class="n">OH1</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>


<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">ShowGraph</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">object</span> <span class="n">e</span><span class="p">)</span> <span class="c1">//BLE通信が確立したときに呼ばれる</span>
<span class="p">{</span>

    <span class="n">OH1</span><span class="p">.</span><span class="n">GetHeartRate</span> <span class="p">+=</span> <span class="n">AddPlot</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">AddPlot</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">object</span> <span class="n">e</span><span class="p">)</span> <span class="c1">//センサから値を受け取った時に呼ばれる</span>
<span class="p">{</span>
    <span class="n">MeasureModel</span> <span class="n">mm</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MeasureModel</span><span class="p">();</span>
    <span class="n">mm</span><span class="p">.</span><span class="n">DateTime</span> <span class="p">=</span> <span class="p">((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">datetime</span><span class="p">;</span>
    <span class="n">mm</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="p">((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">heart_rate</span><span class="p">;</span>

    <span class="n">ChartValues</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">mm</span><span class="p">);</span><span class="c1">//ここにプロットされる値が保持されている</span>


    <span class="nf">SetAxisLimits</span><span class="p">(((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">datetime</span><span class="p">);</span>    <span class="c1">//X軸を更新</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ChartValues</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Ticks</span> <span class="p">&lt;</span> <span class="n">AxisMin</span><span class="p">)</span>
        <span class="n">ChartValues</span><span class="p">.</span><span class="nf">RemoveAt</span><span class="p">(</span><span class="m">0</span><span class="p">);</span> 

<span class="p">}</span>
</code></pre></div>
</div>

<p>いや～もう勝ったも同然ですね。ビルドも通ったし余裕余裕。<br>
<a href="https://camo.qiitausercontent.com/fa4ff00be0c5e9574de0252234001a0ba7622ab5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f38333737643639362d356262622d326230372d343936652d6136653134336265353966332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8377d696-5bbb-2b07-496e-a6e143be59f3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7aabc317091b4dccd0469753a8986441" alt="スクリーンショット (329).png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/8377d696-5bbb-2b07-496e-a6e143be59f3.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8377d696-5bbb-2b07-496e-a6e143be59f3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0afc34d455f015d4fa6605c94f6b40d1 1x" loading="lazy"></a></p>

<p>デバッガ「<strong>アプリケーションは、別のスレッドにマーシャリングされたインターフェイスを呼び出しました。</strong>」<br>
負けました。<br>
マルチスレッド初めてなんでね。何もわからないですね。少し調べることにしました。<br>
……どうやら<strong>UIスレッド</strong>からしか叩けないものを別スレッドから叩いてしまったようです。<br>
イベント駆動なのにUIスレッドから叩くようにするってどうやってやるんだ……？<br>
ﾃｯﾃﾚｰ!!ディスパッチャー!!!!<br>
詳細はあまりわかっていませんがどうやら<strong>ディスパッチャー</strong>なるもの使うと別のスレッドで動作を実行できるらしいです。これを使ってUIスレッドに投げることにしました。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code>
<span class="k">await</span> <span class="n">Dispatcher</span><span class="p">.</span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">Windows</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
       <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">ChartValues</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">mm</span><span class="p">));</span> <span class="c1">//UIスレッドからしか呼べないらしい</span>
</code></pre></div></div>

<p><a href="https://camo.qiitausercontent.com/d7047fb24e36a687ac4105f2964587cd7969acad/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f65346436313839342d393763362d353332642d333635632d3466643032633338323362622e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fe4d61894-97c6-532d-365c-4fd02c3823bb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=5673df65809f5493a5d10ea7b16884c1" alt="Eooq849VgAMQYtM (2).jpg" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/e4d61894-97c6-532d-365c-4fd02c3823bb.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fe4d61894-97c6-532d-365c-4fd02c3823bb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=680c13dbe38a59c05683670c920e3678 1x" loading="lazy"></a></p>

<p>動くようになりましたね。じゃあこのままちょっとゲームでも……</p>

<p><a href="https://camo.qiitausercontent.com/509c8af7dd3416faec64a159a128c5395d5d2455/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f31306261636430622d613134342d356136612d303665352d3132633434326338313662622e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F10bacd0b-a144-5a6a-06e5-12c442c816bb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e22d096a1120147b907ec08e90d56248" alt="EpGSH0hVgAIfR5f (2).jpg" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/10bacd0b-a144-5a6a-06e5-12c442c816bb.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F10bacd0b-a144-5a6a-06e5-12c442c816bb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cd7c511bfbc09255650fc43bd62a2b36 1x" loading="lazy"></a></p>

<p>　 ∧＿∧ 　　<br>
（　´∀｀）＜　ぬるぽ</p>

<p>　　　Λ＿Λ　　＼＼<br>
　（　・∀・）　　　|　|　ｶﾞｯ<br>
  　と　　　　）　 　 |　|<br>
 　　　 Ｙ　/ノ　　　 人<br>
    　　　 /　）　 　 &lt; 　&gt;_Λ∩<br>
    　 ＿/し'　  ／／. Ｖ｀Д´）/<br>
 （＿フ彡　　　　　 　　/　←&gt;&gt;Eater</p>

<h1>
<span id="マルチスレッドとスレッドセーフ" class="fragment"></span><a href="#%E3%83%9E%E3%83%AB%E3%83%81%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%A8%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%82%BB%E3%83%BC%E3%83%95"><i class="fa fa-link"></i></a>マルチスレッドとスレッドセーフ</h1>

<p>―――スレッドセーフ？なにそれおいしいの？―――<br>
よくわかりませんがヌルポ出そうなところに条件文を片っ端から挿入していきます。</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="kt">var</span> <span class="n">mapper</span> <span class="p">=</span> <span class="n">Mappers</span><span class="p">.</span><span class="n">Xy</span><span class="p">&lt;</span><span class="n">MeasureModel</span><span class="p">&gt;()</span>
    <span class="p">.</span><span class="nf">X</span><span class="p">(</span><span class="n">model</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="n">model</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">?</span> <span class="n">model</span><span class="p">.</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Ticks</span> <span class="p">:</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">Ticks</span><span class="p">;</span> <span class="p">})</span>   <span class="c1">//X軸の設定　nullなら現在時刻</span>
    <span class="p">.</span><span class="nf">Y</span><span class="p">(</span><span class="n">model</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="n">model</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">?</span> <span class="n">model</span><span class="p">.</span><span class="n">Value</span> <span class="p">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">});</span>           <span class="c1">//Y軸の設定　nullなら0</span>
</code></pre></div></div>

<p>こことか、</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code><span class="k">private</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">AddPlot</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">object</span> <span class="n">e</span><span class="p">)</span> <span class="c1">//センサから値を受け取った時に呼ばれる</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span><span class="c1">//ﾇﾙﾎﾟ回避</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="n">MeasureModel</span> <span class="n">mm</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MeasureModel</span><span class="p">();</span>
    <span class="n">mm</span><span class="p">.</span><span class="n">DateTime</span> <span class="p">=</span> <span class="p">((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">datetime</span><span class="p">;</span>
    <span class="n">mm</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="p">((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">heart_rate</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">mm</span><span class="p">.</span><span class="n">DateTime</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span><span class="c1">//ﾇﾙﾎﾟ回避</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="k">await</span> <span class="n">Dispatcher</span><span class="p">.</span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">Windows</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
        <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">ChartValues</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">mm</span><span class="p">));</span> <span class="c1">//UIスレッドからしか呼べないらしい</span>


    <span class="nf">SetAxisLimits</span><span class="p">(((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">datetime</span><span class="p">);</span>    <span class="c1">//X軸を更新</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ChartValues</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="c1">//ﾇﾙﾎﾟ回避</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ChartValues</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Ticks</span> <span class="p">&lt;</span> <span class="n">AxisMin</span><span class="p">)</span>

<span class="p">}</span>
</code></pre></div></div>

<p>こことか。<del>ダブったり常に真だったりして意味ないヌルポ判定もあるなぁ……</del><br>
すると40分以上動作することが確認できました。今度こそ大丈夫じゃない……？<br>
<a href="https://camo.qiitausercontent.com/ac23efc2b10d0bac9153bb5142771a6ac7d6b25d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f62643938623136612d363833612d373465322d626663312d3562613138356232303335352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fbd98b16a-683a-74e2-bfc1-5ba185b20355.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=99b71cf9530a42c3d45eb3b01aa3591b" alt="スクリーンショット (333).png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/bd98b16a-683a-74e2-bfc1-5ba185b20355.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fbd98b16a-683a-74e2-bfc1-5ba185b20355.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d3c37a88608f3eff57fdab0a2d97ee4d 1x" loading="lazy"></a></p>

<p>ダメでした。<br>
見たことないファイルにハイライトついてますね。このファイル誰？<br>
あまりに意味が分からないので友人氏に救援を仰ぎます。</p>

<p>友人氏「Eaterのコードをパクりつつ表示系を作り直してみたけど正しく動いてそう」<br>
友人氏「UWP由来のバグなのかな？暫く動かしてみよう」</p>

<p><a href="https://camo.qiitausercontent.com/b1a944d4fdb59bff38c2a7c90a9de74b68f299f3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f36316131336433302d616132612d303437362d323535382d3063313532303631316330372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F61a13d30-aa2a-0476-2558-0c1520611c07.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ba5d2ee4f7de06a0eb1cfa08e142ceb3" alt="527.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/61a13d30-aa2a-0476-2558-0c1520611c07.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F61a13d30-aa2a-0476-2558-0c1520611c07.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=07aec4cad764ffeec4f5ea426f435af8 1x" loading="lazy"></a></p>

<p>一瞬で同じアプリを別プラットフォームで組みなおすその様はまさに救世主でした。僕の脳内で占星術師は東方に星を<sup id="fnref5"><a href="#fn5" title="マタイによる福音書2章2節">5</a></sup>、羊飼いは天使を見た<sup id="fnref6"><a href="#fn6" title="ルカによる福音書2章9節">6</a></sup>。<br>
その後友人氏の協力のもと<strong>ChartValues</strong>が内部で<strong>辞書型</strong>を使っていること、C#の辞書型が<strong>スレッドセーフでない</strong>ことが判明しました。スレッドセーフでないということは同じスレッドから全部たたけばいいんですね！ディスパッチャーを使いましょう！</p>

<div class="code-frame" data-lang="cs"><div class="highlight"><pre class="with-code"><code>
<span class="k">private</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">AddPlot</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">object</span> <span class="n">e</span><span class="p">)</span> <span class="c1">//センサから値を受け取った時に呼ばれる</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="n">MeasureModel</span> <span class="n">mm</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MeasureModel</span><span class="p">();</span>
    <span class="n">mm</span><span class="p">.</span><span class="n">DateTime</span> <span class="p">=</span> <span class="p">((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">datetime</span><span class="p">;</span>
    <span class="n">mm</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="p">((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">heart_rate</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">mm</span><span class="p">.</span><span class="n">DateTime</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="k">await</span> <span class="n">Dispatcher</span><span class="p">.</span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">Windows</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
        <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">ChartValues</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">mm</span><span class="p">));</span> <span class="c1">//UIスレッドからしか呼べないらしい</span>


    <span class="nf">SetAxisLimits</span><span class="p">(((</span><span class="n">HeartRateEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">datetime</span><span class="p">);</span>    <span class="c1">//X軸を更新</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ChartValues</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="c1">//ﾇﾙﾎﾟ回避</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ChartValues</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Ticks</span> <span class="p">&lt;</span> <span class="n">AxisMin</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">Dispatcher</span><span class="p">.</span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">Windows</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">Core</span><span class="p">.</span><span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
        <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">ChartValues</span><span class="p">.</span><span class="nf">RemoveAt</span><span class="p">(</span><span class="m">0</span><span class="p">));</span> <span class="c1">//ChartValuesの書き換えをUIスレッドでしか行わないようにすることでスレッドセーフでないChartValuesを安全に操作する</span>

<span class="p">}</span>
</code></pre></div></div>

<p>―――そうしてすべてをUIスレッドに投げるコードが誕生した。</p>

<h1>
<span id="動作確認" class="fragment"></span><a href="#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>動作確認</h1>

<p>―――にゃ～ん(ฅ^･ω･^ ฅ)―――<br>
アプリは完成しました。さてせっかくですから動いている動画を撮りたいですね。<br>
しかし大きな問題がありました。<strong>なんとDbDが怖くないのです！</strong><br>
なんかこう普通にゲームとして面白くなっちゃって目がチカチカとかしないしマウスも震えないんですよ。たぶん殺人鬼やってる時のほうが興奮してるので心拍数高い。生存者追いかけてる時のめりこみすぎてモニタに頭ぶつけそうになるレベル。これが血の渇望か。<br>
ビビらないんじゃあんまり面白くないなぁ困ったなぁと思った矢先。</p>

<p>友人氏「そういえばEater が心音公開系Vtuberやるって聞いたんだけど」</p>

<p>と煽られました。我がサーバーでは煽られたら煽り返すのが礼儀なので全力で煽り返しました。そうするとなぜか取れた「やるかぁ～～～～～」という言質。有言実行、彼がホラゲをプレイする動画を録ってもらうことにしました。それがこちら。<br>
<a href="https://www.youtube.com/watch?v=lm48oOyNm4s" class="autolink" rel="nofollow noopener" target="_blank">https://www.youtube.com/watch?v=lm48oOyNm4s</a><br>
</p><blockquote class="twitter-tweet">
<p>ｱﾄﾞﾍﾞﾝﾄｶﾚﾝﾀﾞｰ企画で撮った心音公開実況の切り抜きデス！<a href="https://t.co/2X332ZBhGa" rel="nofollow noopener" target="_blank"></a><a href="https://t.co/2X332ZBhGa" class="autolink" rel="nofollow noopener" target="_blank">https://t.co/2X332ZBhGa</a></p>— 紫希 (@rst_shiki) <a href="https://twitter.com/rst_shiki/status/1342123767640674304?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">December 24, 2020</a>
</blockquote> <script async src="https://platform.twitter.com/widgets.js"></script><br>
想像を超える編集クオリティだった。<br>
編集前の収録をリアルタイムで見てたんですけど面白すぎて涙出ましたね。「覚悟をしてるところだから」って言いながら上がる心拍を見ながら、体は嘘つけないなぁと思うなどしました。<br>
また、ホラーゲームの演出も興味深いです。このゲームだとゲームオーバーの時に一瞬”タメ”があるんですけど、その時にちゃんと心拍が一瞬下がっててそのあとまた上がってるんですよね。その演出が非常に有効であることがよくわかります。このアプリ作ってよかった。笑いが止まらん。

<h1>
<span id="終わりに" class="fragment"></span><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>終わりに</h1>

<p>―――深夜テンションはやっぱり怖い―――<br>
拙文をここまでお読みくださりありがとうございます。一週間くらいかけて毎深夜書き進めていった結果、一週間分の深夜テンションが濃縮されてしまいました。ほんと文字通り駄文。乱文。悪文。読み返したくない。<br>
……さて今後の展望について話をしたいと思います。グラフを出せるようになったのでとりあえずcsvか何かで出力できるようにしたいですね。普通に便利な気がします。そんなに実装難しくないと思う！（フラグ）<br>
あとはいろいろな演出ができるようにしたいです。心拍数に同期して鼓動を鳴らすとか画面を拍動させるとか。いろいろ演出つけて臨場感マシマシになった状態でもっかい友人氏に動画録ってもらいたいな！！！</p>

<p>以上「UWPでBLE心拍センサからデータを受信してリアルタイムにグラフ化する」でした。明日は&amp;#0;さんです。「莠ｬ螟ｧ繧｢繝峨き繝ｬ縺ｯ繧､繝ｼ繧ｿ繝ｼ縺ｧ縺顔ｵゅ＞」とのことですが、どんな記事なんでしょうか？とても讌ｽ縺みで縺縺ｭ！</p>

<h1>
<span id="付録" class="fragment"></span><a href="#%E4%BB%98%E9%8C%B2"><i class="fa fa-link"></i></a>付録</h1>

<p>友人氏に動画収録を投げたときはとても軽い気持ちだったのですが、友人氏は真面目に収録してくれました。いろいろ準備をしてもらっていたようで心拍数を録るいい条件についても調べていたそうです。そんななかで面白そうな論文を教えてもらったので紹介します。<br>
<a href="https://www.jstage.jst.go.jp/article/sswc/19/0/19_KJ00009659930/_pdf/-char/ja" rel="nofollow noopener" target="_blank">加賀山 あかり, 越前 遙, 大沼 ありさ, 鈴木 裕一, &lt;研究ノート&gt;日本人女子大学生の食事に伴うエネルギー代謝と心拍数の変化, 仙台白百合女子大学紀要, 2015, 19 巻, p. 173-178</a><br>
これによると食後2，3時間は心拍数が上がるみたいですね。きれいなビビり動画を録るなら食後を避けましょう。あと友人氏曰く入浴後もあまり良くないとか。</p>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p>これは京都大学が京都にあることと京都を代表する祭りである葵祭をかけたとても面白いジョーク。 <a href="#fnref1">↩</a></p>
</li>

<li id="fn2">
<p>感染症には十分お気を付けください <a href="#fnref2">↩</a></p>
</li>

<li id="fn3">
<p>脱出ゲートの開放を試みる4人の生存者と、彼らを生贄に捧げようとする殺人鬼の非対称PvPゲーム <a href="#fnref3">↩</a></p>
</li>

<li id="fn4">
<p>試合のことをそう呼びます <a href="#fnref4">↩</a></p>
</li>

<li id="fn5">
<p>マタイによる福音書2章2節 <a href="#fnref5">↩</a></p>
</li>

<li id="fn6">
<p>ルカによる福音書2章9節 <a href="#fnref6">↩</a></p>
</li>

</ol>
</div>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2FEater_WhiteEye%2Fitems%2Fe3d036634ae4043a1cf7&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2FEater_WhiteEye%2Fitems%2Fe3d036634ae4043a1cf7&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/likers" class="css-1iupg5d">8</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">5</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/e3d036634ae4043a1cf7/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/Eater_WhiteEye/items/e3d036634ae4043a1cf7.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-5f36d637-1c58-45ce-bad5-a019e6b82536">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-08b6a6ba-549f-45e8-b2f7-06c1d12e15ce"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-08b6a6ba-549f-45e8-b2f7-06c1d12e15ce">{}</script>
      
<div id="LoginModal-react-component-9baec287-8cec-4655-aa9d-f66566c258db"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-9baec287-8cec-4655-aa9d-f66566c258db">{}</script>
      
<div id="StockModal-react-component-1c46a3fd-7ee9-4772-ade5-1d97a36d189a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-1c46a3fd-7ee9-4772-ade5-1d97a36d189a">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;Rf5pYGpKk6QDckUyFY+cTp1Hmow0XZNB7P2ViCxlu3E3FfctdtF/fxiuTD/fNm1OQOiwbACfZ78yT0nBnSkr0w==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eこの記事は、\u003ca href=\"https://adventar.org/calendars/5040\" rel=\"nofollow noopener\" target=\"_blank\"\u003eKyoto University Advent Calendar 2020\u003c/a\u003eの25日目の記事です。\u003c/p\u003e\n\n\u003cp\u003e前日の記事は\u003ca href=\"https://note.com/pikachu_unagi/n/n78de1efd2d5b\" rel=\"nofollow noopener\" target=\"_blank\"\u003eぴかちゅう鰻\u003c/a\u003eさんでした。伝聞調で書かれた真偽不明の噂話を淡々とした語り口で書かれると「このページもリロードしたら404にならない？」って気分になりますね。\u003ca href=\"http://scp-jp.wikidot.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSCP\u003c/a\u003eは良いぞ。\u003ca href=\"http://scp-jp.wikidot.com/scp-8900-ex\" rel=\"nofollow noopener\" target=\"_blank\"\u003e『青い、青い空』\u003c/a\u003eとか好き。\u003c/p\u003e\n\n\u003cp\u003eさてさて今日はクリスマスですね。メリークリスマス！教会暦では日没で日が替わるので厳密には24日日没からクリスマスです。もう始まっちゃってるんでアドカレの25日目なんて言わば後の葵ってやつですよ\u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" title=\"これは京都大学が京都にあることと京都を代表する祭りである葵祭をかけたとても面白いジョーク。\"\u003e1\u003c/a\u003e\u003c/sup\u003e。ゆえに僕はトリじゃない！！！トリは昨日だ！！！\u003cbr\u003e\n……ともあれ町中が華やぐ日です。きっとみなさんは一段と充実した一日をお過ごしになることでしょう\u003csup id=\"fnref2\"\u003e\u003ca href=\"#fn2\" title=\"感染症には十分お気を付けください\"\u003e2\u003c/a\u003e\u003c/sup\u003e。僕はボスと仲良く卒論の中間発表！もしかしたら夜景作る側かもしれんな！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"概要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e概要\u003c/h1\u003e\n\n\u003cp\u003eQ.何作ったんですか？\u003cbr\u003e\nA.BLE心拍センサ（OH1）から心拍数を受け取ってPCでLiveChartsを使い順次グラフをプロットするプログラムを作成しました。\u003cbr\u003e\n\u003ca href=\"https://github.com/Eater-Git/HeartRateVisualizer\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/Eater-Git/HeartRateVisualizer\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"自己紹介\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%87%AA%E5%B7%B1%E7%B4%B9%E4%BB%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e自己紹介\u003c/h1\u003e\n\n\u003cp\u003e京大電電のEaterです。電子工作を昔からやっていてロボットとか作ってます。下の写真のロボットのアーム部分制御したりとか。この時は「審査締め切り直前に屋外で深夜にデスマをやるととてもきれいな写真が撮れる」という重要な知見が得られました。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/90a10dde3435a05f31ee460b4cc7956909378155/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f33313733343138632d623662392d313762352d313861312d6361633936353866613034622e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F3173418c-b6b9-17b5-18a1-cac9658fa04b.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=96b32f4b1e21aae9c184b1dd8ae43832\" alt=\"20190420_152738160_iOS.jpg\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/3173418c-b6b9-17b5-18a1-cac9658fa04b.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F3173418c-b6b9-17b5-18a1-cac9658fa04b.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e53d8c37168f723aab656416b694924e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"開発のきっかけ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%96%8B%E7%99%BA%E3%81%AE%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e開発のきっかけ\u003c/h1\u003e\n\n\u003cp\u003e―――深夜テンションって怖いよね―――\u003cbr\u003e\nそれは9月某日、午前4時くらいの事だったと思います。コロナ禍で友人とのゲーム時間が劇的に増加し、その流れでDbD（Dead by Daylight）\u003csup id=\"fnref3\"\u003e\u003ca href=\"#fn3\" title=\"脱出ゲートの開放を試みる4人の生存者と、彼らを生贄に捧げようとする殺人鬼の非対称PvPゲーム\"\u003e3\u003c/a\u003e\u003c/sup\u003eを購入して数日のころです。その日も友人らと建てたDiscordのゲームサーバでDbDをプレイしていました。\u003cbr\u003e\n \u003cstrong\u003e「DbDプレイ中のEaterの心拍取ったら面白そう」\u003c/strong\u003e\u003cbr\u003e\n誰が言った言葉だったでしょうか。僕はホラーゲームが大変苦手です。DbDもその例に漏れませんでした。マッチが成立すると同時に鼓動は速くなり、儀式\u003csup id=\"fnref4\"\u003e\u003ca href=\"#fn4\" title=\"試合のことをそう呼びます\"\u003e4\u003c/a\u003e\u003c/sup\u003eが始まるとマウスは震え視界はちらつき、殺人鬼に吊られると悲鳴を上げるようなありさまでした。\u003cbr\u003e\nこんな僕の事ですから心拍数の変動が激しいことは容易に想像がつきます。面白いデータが得られるのは明らかでしょう。即決で心拍センサを購入。1万円を超えていました。金銭感覚はとうの昔に眠りについていたようです。\u003c/p\u003e\n\n\u003cp\u003eそんなわけで\u003ca href=\"https://www.polar.com/ja/products/accessories/oh1-optical-heart-rate-sensor\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cstrong\u003eBLE心拍センサOH1\u003c/strong\u003e\u003c/a\u003eを手に入れました。スマホとの連携はアプリがあるので簡単です。さっそく装着してDbDをプレイしてみます。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/5da774240c0dece49ff2959634a730d2ae56b21b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f61626464656264392d353232652d386536632d643766612d3036643035653931396663302e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fabddebd9-522e-8e6c-d7fa-06d05e919fc0.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=87cd9d84d206a52c4be19fcf4c3ae9d9\" alt=\"unknown_LI.jpg\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/abddebd9-522e-8e6c-d7fa-06d05e919fc0.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fabddebd9-522e-8e6c-d7fa-06d05e919fc0.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a222b27ad89d2d05cccab21b2fc39275 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/1f1a96a98befe84f7571a353d10a85135ea82199/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f66346438373735662d333665372d333739662d333531332d3636653834303638303861342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Ff4d8775f-36e7-379f-3513-66e8406808a4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=cbb7c594729aace99c323de12ba847a5\" alt=\"IMG_3187.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/f4d8775f-36e7-379f-3513-66e8406808a4.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Ff4d8775f-36e7-379f-3513-66e8406808a4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b285e5116d9abd71b1c6f69bd3b11ce7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003cbr\u003e\n「心拍数120www」\u003cbr\u003e\n「まともなチェイスができないのもこんな状態なら分かる」\u003cbr\u003e\n「山の数とプレイ回数同じじゃん」\u003cbr\u003e\n「全力疾走級の心拍でゲームしてるEaterが面白くないわけがない」\u003c/p\u003e\n\n\u003cp\u003e当初はこんな感じでPCにミラーリングしたりスマホのスクショをチャットに貼ったりして盛り上がっていました。しかしミラーリングは接続が不安定です。スクショでは物足りません。見たいのはリアルタイムにビビるさまですからね！！！\u003c/p\u003e\n\n\u003cp\u003e―――Eaterは自前でPC用アプリを開発することにした。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ツール選定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%84%E3%83%BC%E3%83%AB%E9%81%B8%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eツール選定\u003c/h1\u003e\n\n\u003cp\u003e―――PCアプリなんもわからん―――\u003cbr\u003e\n「PC(Win10)でBLE心拍センサのデータを受信し、リアルタイムにグラフで表示する」　\u003cbr\u003e\nやりたいことはこれです。BLEをどうやって受信するのか。グラフはどうやって表示するのか。慣れ親しんでいるのは組み込みマイコンのプログラミングで、PCでの開発はせいぜいUnityをかじった程度です。暗中模索といった感じでした。\u003cbr\u003e\n\u003cstrong\u003eC#\u003c/strong\u003eなら\u003cstrong\u003eWindows\u003c/strong\u003eに強そう。\u003cstrong\u003eUWP\u003c/strong\u003eは標準で\u003cstrong\u003eBluetooth\u003c/strong\u003e使えるじゃん。\u003cstrong\u003eLiveCharts\u003c/strong\u003eっていう.NET向け\u003cstrong\u003eグラフ表示\u003c/strong\u003e用のおしゃれなライブラリがあるらしい……。\u003cbr\u003e\nというわけでプラットフォームはUWPを採用、グラフ表示にはLiveChartsを使うことにしました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ble通信\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#ble%E9%80%9A%E4%BF%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eBLE通信\u003c/h1\u003e\n\n\u003cp\u003e―――はじめてのBLEつうしん―――\u003cbr\u003e\nなんもわからんのでとりあえずGoogle大先生のご神託を仰ぎます。いくつか参考になるサイトが見つかりました。\u003cbr\u003e\nBLEの仕組みは『\u003ca href=\"https://qiita.com/tera1707/items/e04d86a68a9f96e02fe9\" id=\"reference-4092e63ad3e529d98707\"\u003e[C#/WinRT]Bluetooth v4(BLE)機器と通信する（BLE基礎メモ）\u003c/a\u003e』とかMicrosoftの『\u003ca href=\"https://docs.microsoft.com/ja-jp/windows/uwp/devices-sensors/bluetooth-low-energy-overview\" rel=\"nofollow noopener\" target=\"_blank\"\u003eBluetooth 低エネルギー\u003c/a\u003e』とかで勉強しつつ、『\u003ca href=\"https://qiita.com/gebo/items/41da7474936845d77d06\" id=\"reference-3cecbfcedd6c8b2a195a\"\u003eWindowsデスクトップアプリでBLEのGATTで体温計と血圧計と通信する\u003c/a\u003e』とか『\u003ca href=\"https://docs.microsoft.com/ja-jp/windows/uwp/devices-sensors/ble-beacon\" rel=\"nofollow noopener\" target=\"_blank\"\u003eBluetooth LE アドバタイズ\u003c/a\u003e』のコードを参考にコードを書きました。\u003cbr\u003e\nざっくり説明してみます。BLEデバイスが提供している機能はServiceという形で表現されます。今回使う心拍センサOH1は\u003cstrong\u003eHeart Rate Service\u003c/strong\u003eを持っています。Heart Rate Serviceの中にはいくつかの\u003cstrong\u003eCharacteristic\u003c/strong\u003eが含まれており、今回ほしいのは\u003cstrong\u003eHeart Rate Measurement\u003c/strong\u003eです。\u003cbr\u003e\nしかしアプリ起動時には通信が確立していません。OH1を探すところから始まります。そこで使うのが\u003cstrong\u003eアドバタイズパケット\u003c/strong\u003eです。これはデバイス側が自身の情報を発信しているパケットで、待ち受けておけば誰でも受信することができます。\u003cbr\u003e\nこれらを踏まえて今回のコードではまずアドバタイズパケットを待ち受ける設定をしています。受信したらパケットの中身を見てHeart Rate Serviceを持っているか判定しています。持っていればOH1かなんかの心拍センサなのでアドバタイズパケットの待ち受けを停止し、Serviceの持つCharacteristic一覧からHeart Rate Measurementを探して心拍数を受信する設定をしています。説明終わり。\u003cbr\u003e\nHeart Rate Serviceの中にはほかにもいくつかCharacteristicが含まれているのですがどういうものなのかよくわかっていません。詳しい方がいらっしゃいましたらご教授願えますと幸いです。\u003c/p\u003e\n\n\u003cp\u003e\u003cdetails\u003e\u003csummary\u003eBLEを読むクラス\u003c/summary\u003e\u003cdiv\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eHeartRateConnection.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections.Generic\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Linq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Text\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Threading.Tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.Devices.Bluetooth\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.Devices.Bluetooth.Advertisement\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.Devices.Bluetooth.GenericAttributeProfile\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.Devices.Enumeration\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.ServiceModel.Channels\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.UI.Xaml.Controls\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.UI.Popups\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Collections\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.Devices.Gpio\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eWindows.ApplicationModel.Store.Preview.InstallControl\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eHeartRateVisualizer\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHeartRateEventArgs\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"n\"\u003edatetime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHeartRateConnection\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eGattDeviceService\u003c/span\u003e \u003cspan class=\"n\"\u003eService\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eBluetoothLEAdvertisementWatcher\u003c/span\u003e \u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eevent\u003c/span\u003e \u003cspan class=\"n\"\u003eEventHandler\u003c/span\u003e \u003cspan class=\"n\"\u003eConnectBLE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eevent\u003c/span\u003e \u003cspan class=\"n\"\u003eEventHandler\u003c/span\u003e \u003cspan class=\"n\"\u003eGetHeartRate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eHeartRateConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eBluetoothLEAdvertisementWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReceived\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eWathcerReceived\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScanningMode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBluetoothLEScanningMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActive\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e//これがないとサービスとかデバイス名の情報が得られないっぽい？\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSignalStrengthFilter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSamplingInterval\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromMilliseconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e700\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//重さ改善\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWathcerReceived\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBluetoothLEAdvertisementWatcher\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBluetoothLEAdvertisementReceivedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// アドバタイズパケット受信→HeartRateサービスを検索\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"n\"\u003efind\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ebleServiceUUIDs\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdvertisement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eServiceUuids\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n            \u003cspan class=\"n\"\u003eBluetoothLEDevice\u003c/span\u003e \u003cspan class=\"n\"\u003edev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eBluetoothLEDevice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromBluetoothAddressAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBluetoothAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edev\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// 発見\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGattDeviceServicesResult\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003edev\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetGattServicesAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"cm\"\u003e/*GattServiceUuids.HeartRate*/\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eGattCommunicationStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eservices\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eServices\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eservice\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eservices\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eservice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUuid\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eGattServiceUuids\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRate\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eService\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eservice\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003efind\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStop\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//発見したデバイスがHeartRateサービスを持っていたら\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003echaracteristics\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eService\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCharacteristicsForUuidAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGattCharacteristicUuids\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateMeasurement\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\n\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echaracteristics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eGattCommunicationStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSuccess\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n                        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003echr\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003echaracteristics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristics\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUuid\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eGattCharacteristicUuids\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateMeasurement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003echr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                                \u003cspan class=\"c1\"\u003e//データの送り方が二種類あるので場合分け。OH1はNotifyなのでそちら側しか動作確認をしていない\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristicProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eHasFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGattCharacteristicProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIndicate\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValueChanged\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003echaracteristicChanged_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                                    \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteClientCharacteristicConfigurationDescriptorAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGattClientCharacteristicConfigurationDescriptorValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eIndicate\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristicProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eHasFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGattCharacteristicProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNotify\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValueChanged\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003echaracteristicChanged_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                                    \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteClientCharacteristicConfigurationDescriptorAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGattClientCharacteristicConfigurationDescriptorValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNotify\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                                \u003cspan class=\"nf\"\u003eOnConnectBLE\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eGattCharacteristic\u003c/span\u003e \u003cspan class=\"n\"\u003eCharacteristic_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003echaracteristicChanged_HeartRate_Measurement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGattCharacteristic\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eGattValueChangedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003eeventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eeventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristicValue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStorage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStreams\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDataReader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromBuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eeventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCharacteristicValue\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eReadBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003earg\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003earg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003earg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edatetime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eOnGetHeartRate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earg\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003evirtual\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnConnectBLE\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConnectBLE\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003evirtual\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eOnGetHeartRate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eGetHeartRate\u003c/span\u003e\u003cspan class=\"p\"\u003e?.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/details\u003e\u003c/p\u003e\n\n\u003cp\u003e長い間ハマっていたのはこの部分です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eadvWatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eScanningMode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBluetoothLEScanningMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActive\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eアドバタイズパケットに載っている情報は少ないらしく、アクティブモードでスキャンしないと必要な情報が得られないみたいでした。『\u003ca href=\"https://qiita.com/gebo/items/2e51bebd3d26a3025d9f\" id=\"reference-1182302d205e2e4d86e8\"\u003eBLEアドバタイズパケットの中身を調べてみた\u003c/a\u003e』が詳しいです。あと\u003cstrong\u003ePackage.appxmanifest\u003c/strong\u003eの\u003cstrong\u003e機能\u003c/strong\u003eのところでBluetoothにチェックをつけておかないと動きません。\u003c/p\u003e\n\n\u003cp\u003eなんやかんやで出来上がったこのクラスをこんな感じで呼べば動きます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eHeartRateConnection\u003c/span\u003e \u003cspan class=\"n\"\u003eOH1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eOH1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eHeartRateConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eOH1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eConnectBLE\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eShowGraph\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//BLEデバイスとの接続が確立したときに呼んでほしい関数を投げておく。\u003c/span\u003e\n\u003cspan class=\"n\"\u003eOH1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/93db06903361230f1531ef666c4abff4066897c5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f62613837343532362d653065332d646563382d313836342d6664386464303933323336362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fba874526-e0e3-dec8-1864-fd8dd0932366.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=be402427f14f95d74aa57db576304cd0\" alt=\"スクリーンショット (311).png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/ba874526-e0e3-dec8-1864-fd8dd0932366.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fba874526-e0e3-dec8-1864-fd8dd0932366.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b7f388ef864715f1031dfa7df4fd67f1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0b8def3f62924931cfdcd0944f20338f2876c1cf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f38633266653434382d373935652d356532302d336434392d3737393336666361393561612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8c2fe448-795e-5e20-3d49-77936fca95aa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=65c348dd18978ce79eba74c782384eee\" alt=\"スクリーンショット (312).png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/8c2fe448-795e-5e20-3d49-77936fca95aa.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8c2fe448-795e-5e20-3d49-77936fca95aa.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8a3b9fc947da5cd66e404f0411ea1b81 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e動いたーーーー！！！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"グラフ表示\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B0%E3%83%A9%E3%83%95%E8%A1%A8%E7%A4%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eグラフ表示\u003c/h1\u003e\n\n\u003cp\u003e―――公式サンプル「コピペで動くといったな。あれは嘘だ」―――\u003cbr\u003e\n次はグラフ表示です。\u003cstrong\u003eLiveCharts\u003c/strong\u003eというパッケージを使います。\u003cbr\u003e\nLiveCharts公式で\u003ca href=\"https://lvcharts.net/App/examples/v1/uwp/Constant%20Changes\" rel=\"nofollow noopener\" target=\"_blank\"\u003eおあつらえ向きなサンプルコード\u003c/a\u003eを発見しました。コピペしてちょっといじればすぐできそうに思えます。\u003cbr\u003e\nで、試しました。NuGetパッケージマネージャで\u003cstrong\u003eLiveCharts.Uwp\u003c/strong\u003eをインストールして、サンプルコードをコピペしたソリューションを立てます。\u003cbr\u003e\nビルドボタンをぽちっとな。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/468e0485e2edb65ee9e4e7aaa0fc52fb8b26f2c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f65623964366237342d626566342d343063632d616332632d3633313638323433626665342e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Feb9d6b74-bef4-40cc-ac2c-63168243bfe4.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e53228fe008f07bc0aa78d7a2a3070ec\" alt=\"スクリーンショット (320)_LI.jpg\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/eb9d6b74-bef4-40cc-ac2c-63168243bfe4.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Feb9d6b74-bef4-40cc-ac2c-63168243bfe4.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=8efb5a79cb4afae87e33d3da621f6b4e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eなんか見たことないエラー出たが？？？\u003c/p\u003e\n\n\u003cp\u003e原因が全然わかりません。xamlファイルを見てみると無効なマークアップとかかれているのでここに原因があるのかなと思っていろいろ試しましたが全然ダメでした。な～んもわからん。\u003cbr\u003e\n手当たり次第にいろんなところをいじっているとアプリの\u003cstrong\u003eターゲットバージョン\u003c/strong\u003eがなぜか最新のWindowsになっていないことに気づきました。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/aaa527bd5033c3e3060ad13510531844a66da68e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f61633439633334622d383864622d323761382d323338662d3638393263323339643565642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fac49c34b-88db-27a8-238f-6892c239d5ed.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3a294df0b53f96d6d785061d53d4dff9\" alt=\"スクリーンショット (321).png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/ac49c34b-88db-27a8-238f-6892c239d5ed.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fac49c34b-88db-27a8-238f-6892c239d5ed.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bd6243ef3c542e5b6fbf92cd1c6e16be 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eまさかね。ターゲットバージョンを最新にしただけで動いたら泣くわ。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/1a5e7d9b7711ad06f6a50ac775978a8a0da2ddfd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f35326165656630612d636664342d633263332d376566342d3535663331643033303938632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F52aeef0a-cfd4-c2c3-7ef4-55f31d03098c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=65f735169573e0546a76e60039034547\" alt=\"スクリーンショット (324).png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/52aeef0a-cfd4-c2c3-7ef4-55f31d03098c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F52aeef0a-cfd4-c2c3-7ef4-55f31d03098c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7f7f7ad9dbe64c8845b2bb21830c1e94 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e泣いた。時間返して。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"別のスレッドにマーシャリングされたインターフェイスを呼び出しました\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%88%A5%E3%81%AE%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%AB%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%95%E3%82%8C%E3%81%9F%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%82%92%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e別のスレッドにマーシャリングされたインターフェイスを呼び出しました。\u003c/h1\u003e\n\n\u003cp\u003e―――私は誰～～～？ここはどのスレッド～～～？―――\u003cbr\u003e\n晴れてBLE通信もグラフ表示もできるようになりました。あとはこの二つを組み合わせるだけです！\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainPage.xaml.cs(一部抜粋)\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eHeartRateConnection\u003c/span\u003e \u003cspan class=\"n\"\u003eOH1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainPage\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003emapper\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMappers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eXy\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eMeasureModel\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTicks\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//X軸の設定　nullなら現在時刻\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eY\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e           \u003cspan class=\"c1\"\u003e//Y軸の設定　nullなら0\u003c/span\u003e\n\n\n    \u003cspan class=\"n\"\u003eCharting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFor\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eMeasureModel\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003emapper\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\n    \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eMeasureModel\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//軸ラベルの設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eDateTimeFormatter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"mm:ss\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eBPMFormatter\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"D\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//X軸の目盛りの設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eAxisStep\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eTicks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eSetAxisLimits\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//Y軸の目盛りの設定\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eBPMAxisStep\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eBPMAxisMax\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e150\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eBPMAxisMin\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\n    \u003cspan class=\"n\"\u003eDataContext\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//BLE通信\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eOH1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eHeartRateConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eOH1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eConnectBLE\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eShowGraph\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eOH1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eShowGraph\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//BLE通信が確立したときに呼ばれる\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eOH1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGetHeartRate\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eAddPlot\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddPlot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//センサから値を受け取った時に呼ばれる\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMeasureModel\u003c/span\u003e \u003cspan class=\"n\"\u003emm\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMeasureModel\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003edatetime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ここにプロットされる値が保持されている\u003c/span\u003e\n\n\n    \u003cspan class=\"nf\"\u003eSetAxisLimits\u003c/span\u003e\u003cspan class=\"p\"\u003e(((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003edatetime\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e    \u003cspan class=\"c1\"\u003e//X軸を更新\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTicks\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eAxisMin\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRemoveAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eいや～もう勝ったも同然ですね。ビルドも通ったし余裕余裕。\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/fa4ff00be0c5e9574de0252234001a0ba7622ab5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f38333737643639362d356262622d326230372d343936652d6136653134336265353966332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8377d696-5bbb-2b07-496e-a6e143be59f3.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=7aabc317091b4dccd0469753a8986441\" alt=\"スクリーンショット (329).png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/8377d696-5bbb-2b07-496e-a6e143be59f3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F8377d696-5bbb-2b07-496e-a6e143be59f3.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0afc34d455f015d4fa6605c94f6b40d1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eデバッガ「\u003cstrong\u003eアプリケーションは、別のスレッドにマーシャリングされたインターフェイスを呼び出しました。\u003c/strong\u003e」\u003cbr\u003e\n負けました。\u003cbr\u003e\nマルチスレッド初めてなんでね。何もわからないですね。少し調べることにしました。\u003cbr\u003e\n……どうやら\u003cstrong\u003eUIスレッド\u003c/strong\u003eからしか叩けないものを別スレッドから叩いてしまったようです。\u003cbr\u003e\nイベント駆動なのにUIスレッドから叩くようにするってどうやってやるんだ……？\u003cbr\u003e\nﾃｯﾃﾚｰ!!ディスパッチャー!!!!\u003cbr\u003e\n詳細はあまりわかっていませんがどうやら\u003cstrong\u003eディスパッチャー\u003c/strong\u003eなるもの使うと別のスレッドで動作を実行できるらしいです。これを使ってUIスレッドに投げることにしました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eDispatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCoreDispatcherPriority\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e//UIスレッドからしか呼べないらしい\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d7047fb24e36a687ac4105f2964587cd7969acad/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f65346436313839342d393763362d353332642d333635632d3466643032633338323362622e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fe4d61894-97c6-532d-365c-4fd02c3823bb.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5673df65809f5493a5d10ea7b16884c1\" alt=\"Eooq849VgAMQYtM (2).jpg\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/e4d61894-97c6-532d-365c-4fd02c3823bb.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fe4d61894-97c6-532d-365c-4fd02c3823bb.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=680c13dbe38a59c05683670c920e3678 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e動くようになりましたね。じゃあこのままちょっとゲームでも……\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/509c8af7dd3416faec64a159a128c5395d5d2455/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f31306261636430622d613134342d356136612d303665352d3132633434326338313662622e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F10bacd0b-a144-5a6a-06e5-12c442c816bb.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e22d096a1120147b907ec08e90d56248\" alt=\"EpGSH0hVgAIfR5f (2).jpg\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/10bacd0b-a144-5a6a-06e5-12c442c816bb.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F10bacd0b-a144-5a6a-06e5-12c442c816bb.jpeg?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cd7c511bfbc09255650fc43bd62a2b36 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e　 ∧＿∧ 　　\u003cbr\u003e\n（　´∀｀）＜　ぬるぽ\u003c/p\u003e\n\n\u003cp\u003e　　　Λ＿Λ　　＼＼\u003cbr\u003e\n　（　・∀・）　　　|　|　ｶﾞｯ\u003cbr\u003e\n  　と　　　　）　 　 |　|\u003cbr\u003e\n 　　　 Ｙ　/ノ　　　 人\u003cbr\u003e\n    　　　 /　）　 　 \u0026lt; 　\u0026gt;_Λ∩\u003cbr\u003e\n    　 ＿/し'　  ／／. Ｖ｀Д´）/\u003cbr\u003e\n （＿フ彡　　　　　 　　/　←\u0026gt;\u0026gt;Eater\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"マルチスレッドとスレッドセーフ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%83%AB%E3%83%81%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%A8%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%82%BB%E3%83%BC%E3%83%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマルチスレッドとスレッドセーフ\u003c/h1\u003e\n\n\u003cp\u003e―――スレッドセーフ？なにそれおいしいの？―――\u003cbr\u003e\nよくわかりませんがヌルポ出そうなところに条件文を片っ端から挿入していきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003emapper\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMappers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eXy\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eMeasureModel\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTicks\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTicks\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e})\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//X軸の設定　nullなら現在時刻\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eY\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodel\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e           \u003cspan class=\"c1\"\u003e//Y軸の設定　nullなら0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこことか、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddPlot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//センサから値を受け取った時に呼ばれる\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ﾇﾙﾎﾟ回避\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMeasureModel\u003c/span\u003e \u003cspan class=\"n\"\u003emm\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMeasureModel\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003edatetime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ﾇﾙﾎﾟ回避\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eDispatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCoreDispatcherPriority\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e//UIスレッドからしか呼べないらしい\u003c/span\u003e\n\n\n    \u003cspan class=\"nf\"\u003eSetAxisLimits\u003c/span\u003e\u003cspan class=\"p\"\u003e(((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003edatetime\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e    \u003cspan class=\"c1\"\u003e//X軸を更新\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//ﾇﾙﾎﾟ回避\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTicks\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eAxisMin\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこことか。\u003cdel\u003eダブったり常に真だったりして意味ないヌルポ判定もあるなぁ……\u003c/del\u003e\u003cbr\u003e\nすると40分以上動作することが確認できました。今度こそ大丈夫じゃない……？\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/ac23efc2b10d0bac9153bb5142771a6ac7d6b25d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f62643938623136612d363833612d373465322d626663312d3562613138356232303335352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fbd98b16a-683a-74e2-bfc1-5ba185b20355.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=99b71cf9530a42c3d45eb3b01aa3591b\" alt=\"スクリーンショット (333).png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/bd98b16a-683a-74e2-bfc1-5ba185b20355.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fbd98b16a-683a-74e2-bfc1-5ba185b20355.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d3c37a88608f3eff57fdab0a2d97ee4d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eダメでした。\u003cbr\u003e\n見たことないファイルにハイライトついてますね。このファイル誰？\u003cbr\u003e\nあまりに意味が分からないので友人氏に救援を仰ぎます。\u003c/p\u003e\n\n\u003cp\u003e友人氏「Eaterのコードをパクりつつ表示系を作り直してみたけど正しく動いてそう」\u003cbr\u003e\n友人氏「UWP由来のバグなのかな？暫く動かしてみよう」\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b1a944d4fdb59bff38c2a7c90a9de74b68f299f3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3339303537352f36316131336433302d616132612d303437362d323535382d3063313532303631316330372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F61a13d30-aa2a-0476-2558-0c1520611c07.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ba5d2ee4f7de06a0eb1cfa08e142ceb3\" alt=\"527.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/61a13d30-aa2a-0476-2558-0c1520611c07.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2F61a13d30-aa2a-0476-2558-0c1520611c07.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=07aec4cad764ffeec4f5ea426f435af8 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e一瞬で同じアプリを別プラットフォームで組みなおすその様はまさに救世主でした。僕の脳内で占星術師は東方に星を\u003csup id=\"fnref5\"\u003e\u003ca href=\"#fn5\" title=\"マタイによる福音書2章2節\"\u003e5\u003c/a\u003e\u003c/sup\u003e、羊飼いは天使を見た\u003csup id=\"fnref6\"\u003e\u003ca href=\"#fn6\" title=\"ルカによる福音書2章9節\"\u003e6\u003c/a\u003e\u003c/sup\u003e。\u003cbr\u003e\nその後友人氏の協力のもと\u003cstrong\u003eChartValues\u003c/strong\u003eが内部で\u003cstrong\u003e辞書型\u003c/strong\u003eを使っていること、C#の辞書型が\u003cstrong\u003eスレッドセーフでない\u003c/strong\u003eことが判明しました。スレッドセーフでないということは同じスレッドから全部たたけばいいんですね！ディスパッチャーを使いましょう！\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"cs\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddPlot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//センサから値を受け取った時に呼ばれる\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eMeasureModel\u003c/span\u003e \u003cspan class=\"n\"\u003emm\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eMeasureModel\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003edatetime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eValue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eheart_rate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eDispatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCoreDispatcherPriority\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e//UIスレッドからしか呼べないらしい\u003c/span\u003e\n\n\n    \u003cspan class=\"nf\"\u003eSetAxisLimits\u003c/span\u003e\u003cspan class=\"p\"\u003e(((\u003c/span\u003e\u003cspan class=\"n\"\u003eHeartRateEventArgs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003edatetime\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e    \u003cspan class=\"c1\"\u003e//X軸を更新\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e//ﾇﾙﾎﾟ回避\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTicks\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eAxisMin\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eDispatcher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRunAsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCore\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCoreDispatcherPriority\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eChartValues\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eRemoveAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e//ChartValuesの書き換えをUIスレッドでしか行わないようにすることでスレッドセーフでないChartValuesを安全に操作する\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e―――そうしてすべてをUIスレッドに投げるコードが誕生した。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"動作確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e動作確認\u003c/h1\u003e\n\n\u003cp\u003e―――にゃ～ん(ฅ^･ω･^ ฅ)―――\u003cbr\u003e\nアプリは完成しました。さてせっかくですから動いている動画を撮りたいですね。\u003cbr\u003e\nしかし大きな問題がありました。\u003cstrong\u003eなんとDbDが怖くないのです！\u003c/strong\u003e\u003cbr\u003e\nなんかこう普通にゲームとして面白くなっちゃって目がチカチカとかしないしマウスも震えないんですよ。たぶん殺人鬼やってる時のほうが興奮してるので心拍数高い。生存者追いかけてる時のめりこみすぎてモニタに頭ぶつけそうになるレベル。これが血の渇望か。\u003cbr\u003e\nビビらないんじゃあんまり面白くないなぁ困ったなぁと思った矢先。\u003c/p\u003e\n\n\u003cp\u003e友人氏「そういえばEater が心音公開系Vtuberやるって聞いたんだけど」\u003c/p\u003e\n\n\u003cp\u003eと煽られました。我がサーバーでは煽られたら煽り返すのが礼儀なので全力で煽り返しました。そうするとなぜか取れた「やるかぁ～～～～～」という言質。有言実行、彼がホラゲをプレイする動画を録ってもらうことにしました。それがこちら。\u003cbr\u003e\n\u003ca href=\"https://www.youtube.com/watch?v=lm48oOyNm4s\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://www.youtube.com/watch?v=lm48oOyNm4s\u003c/a\u003e\u003cbr\u003e\n\u003c/p\u003e\u003cblockquote class=\"twitter-tweet\"\u003e\n\u003cp\u003eｱﾄﾞﾍﾞﾝﾄｶﾚﾝﾀﾞｰ企画で撮った心音公開実況の切り抜きデス！\u003ca href=\"https://t.co/2X332ZBhGa\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003c/a\u003e\u003ca href=\"https://t.co/2X332ZBhGa\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://t.co/2X332ZBhGa\u003c/a\u003e\u003c/p\u003e— 紫希 (@rst_shiki) \u003ca href=\"https://twitter.com/rst_shiki/status/1342123767640674304?ref_src=twsrc%5Etfw\" rel=\"nofollow noopener\" target=\"_blank\"\u003eDecember 24, 2020\u003c/a\u003e\n\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\"\u003e\u003c/script\u003e\u003cbr\u003e\n想像を超える編集クオリティだった。\u003cbr\u003e\n編集前の収録をリアルタイムで見てたんですけど面白すぎて涙出ましたね。「覚悟をしてるところだから」って言いながら上がる心拍を見ながら、体は嘘つけないなぁと思うなどしました。\u003cbr\u003e\nまた、ホラーゲームの演出も興味深いです。このゲームだとゲームオーバーの時に一瞬”タメ”があるんですけど、その時にちゃんと心拍が一瞬下がっててそのあとまた上がってるんですよね。その演出が非常に有効であることがよくわかります。このアプリ作ってよかった。笑いが止まらん。\n\n\u003ch1\u003e\n\u003cspan id=\"終わりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e終わりに\u003c/h1\u003e\n\n\u003cp\u003e―――深夜テンションはやっぱり怖い―――\u003cbr\u003e\n拙文をここまでお読みくださりありがとうございます。一週間くらいかけて毎深夜書き進めていった結果、一週間分の深夜テンションが濃縮されてしまいました。ほんと文字通り駄文。乱文。悪文。読み返したくない。\u003cbr\u003e\n……さて今後の展望について話をしたいと思います。グラフを出せるようになったのでとりあえずcsvか何かで出力できるようにしたいですね。普通に便利な気がします。そんなに実装難しくないと思う！（フラグ）\u003cbr\u003e\nあとはいろいろな演出ができるようにしたいです。心拍数に同期して鼓動を鳴らすとか画面を拍動させるとか。いろいろ演出つけて臨場感マシマシになった状態でもっかい友人氏に動画録ってもらいたいな！！！\u003c/p\u003e\n\n\u003cp\u003e以上「UWPでBLE心拍センサからデータを受信してリアルタイムにグラフ化する」でした。明日は\u0026amp;#0;さんです。「莠ｬ螟ｧ繧｢繝峨き繝ｬ縺ｯ繧､繝ｼ繧ｿ繝ｼ縺ｧ縺顔ｵゅ＞」とのことですが、どんな記事なんでしょうか？とても讌ｽ縺みで縺縺ｭ！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"付録\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BB%98%E9%8C%B2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e付録\u003c/h1\u003e\n\n\u003cp\u003e友人氏に動画収録を投げたときはとても軽い気持ちだったのですが、友人氏は真面目に収録してくれました。いろいろ準備をしてもらっていたようで心拍数を録るいい条件についても調べていたそうです。そんななかで面白そうな論文を教えてもらったので紹介します。\u003cbr\u003e\n\u003ca href=\"https://www.jstage.jst.go.jp/article/sswc/19/0/19_KJ00009659930/_pdf/-char/ja\" rel=\"nofollow noopener\" target=\"_blank\"\u003e加賀山 あかり, 越前 遙, 大沼 ありさ, 鈴木 裕一, \u0026lt;研究ノート\u0026gt;日本人女子大学生の食事に伴うエネルギー代謝と心拍数の変化, 仙台白百合女子大学紀要, 2015, 19 巻, p. 173-178\u003c/a\u003e\u003cbr\u003e\nこれによると食後2，3時間は心拍数が上がるみたいですね。きれいなビビり動画を録るなら食後を避けましょう。あと友人氏曰く入浴後もあまり良くないとか。\u003c/p\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003eこれは京都大学が京都にあることと京都を代表する祭りである葵祭をかけたとても面白いジョーク。 \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn2\"\u003e\n\u003cp\u003e感染症には十分お気を付けください \u003ca href=\"#fnref2\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn3\"\u003e\n\u003cp\u003e脱出ゲートの開放を試みる4人の生存者と、彼らを生贄に捧げようとする殺人鬼の非対称PvPゲーム \u003ca href=\"#fnref3\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn4\"\u003e\n\u003cp\u003e試合のことをそう呼びます \u003ca href=\"#fnref4\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn5\"\u003e\n\u003cp\u003eマタイによる福音書2章2節 \u003ca href=\"#fnref5\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn6\"\u003e\n\u003cp\u003eルカによる福音書2章9節 \u003ca href=\"#fnref6\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","createdAt":"2020-12-24T15:00:14Z","elapsedYearsFromLastModifiedAt":0,"encryptedId":"XJMrTrP8h2nBlBC79UjOHW2T4fNmV9/Ggg==--+J9p00gF971mn7UF--8OK28gf8so3Fhw+8E4NURA==","isBanned":false,"isDeprecated":false,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-12-25T02:33:08Z","likesCount":8,"linkUrl":"https://qiita.com/Eater_WhiteEye/items/e3d036634ae4043a1cf7","organization":null,"originalId":1366336,"stockedCount":5,"title":"UWPでBLE心拍センサからデータを受信してリアルタイムにグラフ化する","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%A6%82%E8%A6%81\"\u003e概要\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%87%AA%E5%B7%B1%E7%B4%B9%E4%BB%8B\"\u003e自己紹介\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%96%8B%E7%99%BA%E3%81%AE%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91\"\u003e開発のきっかけ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%84%E3%83%BC%E3%83%AB%E9%81%B8%E5%AE%9A\"\u003eツール選定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ble%E9%80%9A%E4%BF%A1\"\u003eBLE通信\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B0%E3%83%A9%E3%83%95%E8%A1%A8%E7%A4%BA\"\u003eグラフ表示\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%88%A5%E3%81%AE%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%AB%E3%83%9E%E3%83%BC%E3%82%B7%E3%83%A3%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%95%E3%82%8C%E3%81%9F%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%82%92%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F\"\u003e別のスレッドにマーシャリングされたインターフェイスを呼び出しました。\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%83%AB%E3%83%81%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%A8%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%82%BB%E3%83%BC%E3%83%95\"\u003eマルチスレッドとスレッドセーフ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D\"\u003e動作確認\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e終わりに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E4%BB%98%E9%8C%B2\"\u003e付録\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":1139,"uuid":"e3d036634ae4043a1cf7","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"TInASAxCmTq/Ac9S6nxrLVcEzD2E--Rx4cU/LWgmg5hxPW--slpio/BU77yiNKVYkyxU/Q==","originalId":390575,"description":"","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/390575/profile-images/1608661365","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fprofile-images%2F1608661365?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=bd5c24283736baf03257730222bae35b","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F390575%2Fprofile-images%2F1608661365?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=7f523134254900659f50309341cf7efe","urlName":"Eater_WhiteEye","websiteUrl":null,"twitterUrl":"https://twitter.com/Eater_WhiteEye","twitterUrlName":"Eater_WhiteEye","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"BLE","urlName":"ble"},{"name":"心拍","urlName":"%e5%bf%83%e6%8b%8d"},{"name":"UWP","urlName":"uwp"},{"name":"LiveCharts","urlName":"livecharts"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
