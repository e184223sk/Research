More than 1 year has passed since last update.前回に引き続き、ListViewを使います。
今回はCSVを読み込ませてListViewに表示します。キーワード：ListView, Menu, OpenFileDialog, CSV[注意]
これまでの回で説明済みの操作方法等は、説明を省略したり簡略化している場合があります。郵便番号のCSVデータをListViewに表示するプログラムを作ります。
今回使うデータはこちら。
郵便番号データダウンロード - 日本郵便
CSVデータの仕様はこちら。
郵便番号データの説明 - 日本郵便プロジェクトにクラスを追加します。
名前はZipRecord.csにします。
これがCSV1件分に対応します。Gridを真ん中ぐらいで分割して上の段にMenuを、下の段にListViewを配置します。
Menuのプロパティ、Itemsの「...」からコレクションエディターを表示します。
MenuItemを2つ作ります。
1つ目のHeaderは「ファイル(_F)」、2つ目は「編集(_E)」にします。
追加後。
「ファイル」のMenuItemを選択し、Itemsのコレクションエディターを開きます。
MenuItemで「開く(_O)...」、
Separator、
MenuItemで「終了(_X)」を追加します。
追加後。
「編集」メニューを選択し、今度は「MenuItemの追加」で項目を追加します。
Headerは「クリア(_C)」にします。
「開く」メニューに名前を付けます。
openMenuにします。
同様に「終了」メニューはexitMenuに、「クリア」メニューはclearMenuにします。デザイナでGridの上段をAutoに、下段をStarに設定（やり方は第5回参照）し、
MenuとListViewのレイアウトを「すべてリセット」（やり方は第7回参照）します。WindowのTitleを郵便番号一覧に、ResizeModeをCanResizeWithGripに設定します。
ListViewとCSVデータの入れ物を関連付けます。XamlでListViewを選択し、プロパティのItemsSource横の□メニューから「データバインドの作成」を選択し、「バインドの種類」に「データコンテキスト」を選択します。ListViewの列を設定します。ListViewのColumnsのコレクションエディターを開きます。
GridViewColumnsを以下のように設定します。DisplayMemberBindingは横の□メニューから「データバインドの作成」を選択し、
「バインドの種類」に「データコンテキスト」を選択し、「パス」の欄に表示元データ（ZipRecordクラス）の項目名を入力します。
ここまででListViewは以下のようになります。CSV読み込みの機能を使うために、参照の追加でMicrosoft.VisualBasicを追加します。コードビハインドにCSVを読み込むメソッドを作ります。メニューから「開く」を選択した時の処理を作ります。
ドキュメントアウトラインで「openMenu」を選択し、画面の「開く」メニューをダブルクリックし、以下を入力します。
メニュー項目の「終了」、「クリア」も同様に処理を作ります。起動してみます。
メニューの「ファイル」 - 「開く」でファイル選択ダイアログを表示します。
拡張子のフィルタの初期選択値はCSVになっています。
こちらからダウンロードしたCSVを読み込ませてみます。
表示されました。
メニューの「編集」 - 「クリア」を選択すると一覧がクリアされ、「ファイル」 - 「終了」を選択するとプログラムが終了します。おしまい※次回はこのプログラムをもう少し改善します。まだ捨てないでください。＜＜ 最初の記事 　 ＜ 前の記事 　 次の記事 ＞


