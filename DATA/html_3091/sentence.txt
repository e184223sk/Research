表題の通り
Visual Studio 2019のC#にて、画像をそのままPDFに変換する。
コードのサンプルでございます。特段、NuGetなどで他のプラグインや
別途外部dllを必要としないようにしています。要は、バイナリを以下のように、直接叩いています。
1.PDFのヘッダーの記述
2.ファイルパスからBitmapで読み込む。
3.Bitmapをメモリ上にJpeg形式で保存。
4.PDFファイルに画像情報と共に、画像バイナリも埋める。
5.PDFのフッターの記述。※私は素人ですし
今回のコードは、あくまで最低限の動作する部分にとどめていますので、汚いです。
例外処理や、解放など至らぬ点が、多々ございます。ご了承ください。
もし実際に参考にされる際は、必要個所を必ず訂正してからにしてください。
また、元がJpegファイルなら、2~3項も省略できます。※Python版はこちらです。以前、
Yahoo知恵ノートに似たものを公開していたのですが、
Yahoo知恵ノートが廃止されてしまったため、
こちらに改めて手を加えて、公開させていただこうと思います。下の画像は、今回コードでの作成例です。
・特に、dllを使わず、、バイナリを直接叩いて、PDFを作れないか、やってみた。結果報告・１
・自力で、JPEG画像から、PDFに変換してみた - ニコニコ動画
※リンク先は、私のブログや動画です。気を付けてください。例えば、
以下のようなコードで、ファイルを選択して
変換することが出来ます。以上のコードを実行すると
指定した画像ファイルが、そのまま
指定した画像のフォルダに、PDFに変換されてあると思います。


