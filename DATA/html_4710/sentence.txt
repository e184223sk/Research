More than 3 years have passed since last update.C#でのgaroon SOAP APIのリクエストについて
当初の実装でちょっとハマったのでメモGaroon（ガルーン） SOAP API の概要GRN_UTIL_API_65001
SOAPリクエストが不正です。
"Header" がSOAPリクエストに存在しません。
サイボウズオフィシャルパートナー、または販売元にお問い合わせください。VisualStudio2017でガルーンAPIを使ってメッセージを送ってみる
こちらの記事を参考にメッセージ送信はできたけど、
他のAPI使おうとしたらエラーになる！ｷﾞｴｴｴｴReference.csの修正箇所が足りませんでした。
ちゃんと理解しないまま進めると痛い目見る好例。Reference.csでは下記の構造になっている
各機能(全般/スケジュール/掲示板など):Bindingクラス
各API(ユーザ情報取得など):Bindingクラス内の各メソッド参考にした記事はメッセージ送信なのでMessageBindingクラスのMessageCreateThreadsメソッドにSOAPヘッダーを追加している。
他のAPIにはヘッダー付いてないので、そのまま使おうもんならそりゃあヘッダーないですエラーでるよね〜Garoon SOAP APIの共通仕様
Garoon SOAP APIを使用するには、ガルーンに登録したユーザーで認証する必要があります。認証には、Cookieを使用した方式と、WebServicesSecurity（WS-Security）を使用した方式があります。WS-Securityを用いた認証方式
ログイン名とパスワードを SOAP ヘッダに含めることによって認証を行います。 この認証方式では、リクエストごとに認証を行う必要があります。Cookieを使用しない場合はWS-Securityを用いた認証方式が必要。
（参考記事の実装もこっち）
認証用ログイン名、パスワードがSOAPヘッダに必要だけど、
それが存在しないから認証エラーになってるっぽい例としてログイン名からユーザーを取得するAPIを使用。ちゃんとヘッダ設定したらエラー解消。ハレルヤ。使いたいAPI各メソッドにヘッダ追加処理が必要。
うーむめんどくさい。
どうにかうまいやり方ないかなぁ…
というかReference.csの自動生成時にヘッダ入ってれば楽なのに、入れてないのは何か理由があるんだろうか。


