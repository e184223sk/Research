More than 1 year has passed since last update.Windowsのプリンタのジョブの実態のファイルは、5桁の数字の番号のファイルが2つ、拡張子のみ異なるファイルが2つあります。
1つはこのタイトルのSPLファイル、もう1つはプリンタに実際に送り届けられるデータ（プリンタ専用のデータ）のSHDファイルです。
プリンタを開いて、プリントキューとしてプリンタへの送信待ち一覧に表示される情報は、このSPLファイルのデータのようです。
ですが一般には、利用価値が無いので構造がWindows2003までしかネットに載っていませんでした。
なので、とりあえず簡易にですが、クラスとして取得できるようにしたものを作りました。このSPLファイルをWindows Spoolerがプリンタに送信する前に扱いたいのですが、それにはプリンタを一時停止にするなどして、ジョブのプリンタへの送信をしない状態を作るひつようがあります。
また、外部操作でSPLとSHDファイルを削除しても、PrintSpoolerは何か操作をされないと消えたという情報は反映されないようです。
PrintSpoolerはサービスとして動作するもので、敢えて互換ソフトを作るようなものでもないので、この時点で詰まっていますが、やってみたいことがあるので作っています。
印刷データをプリンタ専用データに変換されたものがSHDファイルですので、プリントサーバーがPDF等を共有フォルダに設置されると、プリントサーバーで既設定のプリンタドライバでSHDファイルにして、そのSHDファイルをプリンタに送信するなり、ストックして後で再印刷する、というものです。
この場合、クライアント側では共有プリンタとする作業が不要なので、PCのセットアップが楽というメリットがあります。
印刷ファイル（DOCXなりPDF）を保存する、ということが必要なので、実用性は微妙かもですが・・・
ダミープリンタドライバのみ登録して、印刷時プロパティの方でプリンタ毎の既設定のボタンをクリック、そして設定に従ってプリンタ・設定の振り分け・・・
ここまでできれば、実務では
1．角2封筒で、印刷は○○○プリンタ
2．A3用紙に中綴じで、フィニッシャ付の複合機○○○
3．普段の印刷は最寄りの小型プリンタ○○○。そしてプロパティ設定をしてから印刷こんな無駄な野望の第一歩です（笑）


