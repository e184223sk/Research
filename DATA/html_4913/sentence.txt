More than 3 years have passed since last update.Google Sheets API v4 と.Net用のライブラリを使ってGoogleスプレッドシートにC#コンソールアプリケーションからデータを書き出します。
営業がExcelでデータを記録していて、だったらアプリ側がGoogleスプレッドシートに書き出せば使いやすいよね、というようなことをやりたかったので。
とりあえず導入メモです。.NET Quickstart | Sheets API | Google Developers に書いてある通りの手順でサンプルコードがきちんと動作するところまで進めます。
以下は実際にやった記録。すでに終わっているならスキップ可。
おおよそ上の手順の和訳。操作や画面は変わり得るので参考程度に。nuget.orgからライブラリを追加します。
VSだったら「表示」-&gt;「その他のウィンドウ」-&gt;「パッケージマネジャーコンソール」で以下の通りに入力。あとは実行すれば動きます。初回はブラウザが立ち上がって、ログインと許可の操作が必要です。
コード中で指定されている通り、credential（認証情報）が個人フォルダの中に「.credentials/sheets.googleapis.com-dotnet-quickstart.json」という形で保存されるのですが不要なので消しておきましょう。上のサンプルコードはデータの読み出ししかしません。こちらとしては末尾の行にデータを書き加えたいです。以下サンプルをちょっといじっただけのコード。データを書き加えたいスプレッドシートのIDを中に入力してください。
事前手順として、
1. 新しいスプレッドシートを作成。ファイル名は何でもいいです、スプレッドシートIDでアクセスするので。
2. スプレッドシートを開いてスプレッドシートIDをコピー。IDはURL内に入っています。
https://docs.google.com/spreadsheets/d/ここの文字列/edit
3. シート名はここでは「Sheet1」に変更
しておきます。


