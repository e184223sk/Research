<!DOCTYPE html><html><head><meta charset="utf-8" /><title>C#のentityframworkで特殊なSQLをためす - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/mink0212/items/4c0fb588e07af41882e3" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="W9jgHGQ+pq9XHvl11lKlJvrZ6u9Ey4Ue9/ORkmgFPFZ+pnLjcUTNmk632gVGNVs+pJlua+vLmaN08+Or6K/51w==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@lie2468" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="C#のentityframworkで特殊なSQLをためす - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E1bGJuUnBkSGxtY21GdGQyOXlhLU9CcC1lSnVlYXVpdU9CcWxOUlRPT0NrdU9Cbi1PQ2dlT0JtUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0yZmFmNjRlMDJiMzUxODVjZTVkMGUwZTUxYWQ3ZTFhZQ&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFwYm1zd01qRXkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz0xNmY0MmY0MDYxZTQ3OTY4Y2Y3Y2FhNTY3M2Q4MDU1MQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=a3ed5e88cd64a0e640ed58e80cc139a9"><meta property="og:description" content="

はじめに

DBから情報取得や登録以外にもレコードを数える関数や取得レコードの数を指定するSQLがあります。そのようなSQLや若干特殊な操作をEntityFramworkで実行して、DBのログに表示されるSQLをまとめました。前回..."><meta content="https://qiita.com/mink0212/items/4c0fb588e07af41882e3" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,.NET,PostgreSQL,EntityFramework" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-06c1e256-2f78-4355-9f13-ecc68ab84495"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fmink0212%2Fitems%2F4c0fb588e07af41882e3">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fmink0212%2Fitems%2F4c0fb588e07af41882e3">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-06c1e256-2f78-4355-9f13-ecc68ab84495">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2019-11-17T22:33:17.000+09:00","dateModified":"2019-11-17T22:33:17.000+09:00","headline":"C#のentityframworkで特殊なSQLをためす","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND1ReVBqZ2E1bGJuUnBkSGxtY21GdGQyOXlhLU9CcC1lSnVlYXVpdU9CcWxOUlRPT0NrdU9Cbi1PQ2dlT0JtUSZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTU0JnR4dC1jbGlwPWVsbGlwc2lzJnR4dC1hbGlnbj1jZW50ZXIlMkNtaWRkbGUmcz0yZmFmNjRlMDJiMzUxODVjZTVkMGUwZTUxYWQ3ZTFhZQ\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFwYm1zd01qRXkmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT00NSZ0eHQtYWxpZ249cmlnaHQlMkNib3R0b20mcz0xNmY0MmY0MDYxZTQ3OTY4Y2Y3Y2FhNTY3M2Q4MDU1MQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=a3ed5e88cd64a0e640ed58e80cc139a9","mainEntityOfPage":"https://qiita.com/mink0212/items/4c0fb588e07af41882e3","author":{"@type":"Person","address":"","email":"mink.lie2468@gmail.com","identifier":"mink0212","name":"mink0212","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Flh4.googleusercontent.com%2F-DxFhtRGhVeI%2FAAAAAAAAAAI%2FAAAAAAAAAAA%2FACHi3rc5LPGspdzDsWGIQ-lHFPVN_FMrcA%2Fs50%2Fphoto.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=360c5b6a6dd8e731f1ee538db9de5f2e","url":"https://qiita.com/mink0212","description":"日々気になったことや勉強したことやノウハウなどをまとめています。\r\nちょっとツールやライブラリの使用方法に偏りがち\r\n開発の考えはHatena Blog（https://mink0212.hatenablog.com/）の方で書いていきます。","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202106-uzabase-3/">経済情報で世界を変えていけているユーザベースの可能性</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202106-uzabase-3/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mink0212","type":"items","id":"4c0fb588e07af41882e3"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"経済情報で世界を変えていけているユーザベースの可能性","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mink0212","type":"items","id":"4c0fb588e07af41882e3"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"経済情報で世界を変えていけているユーザベースの可能性","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"mink0212","type":"items","id":"4c0fb588e07af41882e3"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"経済情報で世界を変えていけているユーザベースの可能性","url":"https://zine.qiita.com/interview/202106-uzabase-3/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/mink0212/items/4c0fb588e07af41882e3","location":"/mink0212/items/4c0fb588e07af41882e3","scheme":"https","host":"qiita.com","port":null,"pathname":"/mink0212/items/4c0fb588e07af41882e3","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"ucCrgU+UwFo3GjK5yEBaQ4H93jkh2QHP/gynrzNCRQ6cvjl+Wu6rby6zEclYJ6Rb371avY7ZHXJ9DNWWs+iAjw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-83b242da-51b1-48cf-a4e8-14ecb2a4c50c"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mink0212/items/4c0fb588e07af41882e3/likers" class="css-1iupg5d">3</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">4</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/4c0fb588e07af41882e3/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mink0212/items/4c0fb588e07af41882e3/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mink0212/items/4c0fb588e07af41882e3/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mink0212/items/4c0fb588e07af41882e3/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mink0212/items/4c0fb588e07af41882e3.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/mink0212"><img class="css-100alwu eyfquo10" src="https://lh4.googleusercontent.com/-DxFhtRGhVeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc5LPGspdzDsWGIQ-lHFPVN_FMrcA/s50/photo.jpg" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/mink0212" class="css-10ougpm">@<!-- -->mink0212</a><div class="css-1ay9vb9"><time dateTime="2019-11-17T13:33:17Z" class="css-m19uds">posted at 2019-11-17</time></div></div></div></div></div><h1 class="css-cgzq40">C#のentityframworkで特殊なSQLをためす</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/.net" class="css-4czcte">.NET</a><a href="/tags/postgresql" class="css-4czcte">PostgreSQL</a><a href="/tags/entityframework" class="css-4czcte">EntityFramework</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>DBから情報取得や登録以外にもレコードを数える関数や取得レコードの数を指定するSQLがあります。そのようなSQLや若干特殊な操作をEntityFramworkで実行して、DBのログに表示されるSQLをまとめました。<a href="https://qiita.com/mink0212/items/fcf4cb16991e11cd2a98" id="reference-0d1ddb804b6494029794">前回</a>と<a href="https://qiita.com/mink0212/items/d3274e070d79071480ab" id="reference-a04210e4f1a5a257d9fc">前々回</a>の続きです。</p>

<h1>
<span id="環境" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>環境</h1>

<ul>
<li>Windows:10</li>
<li>dotnet:3.0.100</li>
</ul>

<h1>
<span id="レコード数を数えるcount" class="fragment"></span><a href="#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%95%B0%E3%82%92%E6%95%B0%E3%81%88%E3%82%8Bcount"><i class="fa fa-link"></i></a>レコード数を数えるCount</h1>

<p>Selectで使用するCountはレコードを数える関数で、SQLとEntityFramwork両方にあります。大抵は、Where句を使用してある条件のレコード数を調べるときに使います。</p>

<h2>
<span id="シンプルなcount" class="fragment"></span><a href="#%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AAcount"><i class="fa fa-link"></i></a>シンプルなCount</h2>

<p>SQLで使用するように、Where句で条件を指定してCount関数でレコード数を取得してみます。</p>

<h3>
<span id="entityframworkでの表現" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>絞り込み関数(Where)でageが4のレコードを絞り込み、Count関数で絞り込み後のレコード数を数えています。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">LinqStandard.EF</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">DBSample</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">LinqEF</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhereCountSample</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">PetCount</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Age</span> <span class="p">==</span> <span class="m">4</span><span class="p">).</span><span class="nf">Count</span><span class="p">();</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"pet count:{0}"</span><span class="p">,</span> <span class="n">PetCount</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>Count文としては、一部を除いて特殊なものはなくWhereで条件を絞り込んでCountで数えています。<br>
ただし、Countの対象カラムは特に指定せず全カラムを指定しており、Int型で返ってくるように指定しているようです。<br>
Int型の指定をしたくないときはLongCount関数を使用します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 08:16:56.625 UTC [33] LOG:  execute &lt;unnamed&gt;: SELECT COUNT(*)::INT
        FROM pets AS p
        WHERE p.age = 4
</code></pre></div></div>

<h2>
<span id="絞り込みありのcount" class="fragment"></span><a href="#%E7%B5%9E%E3%82%8A%E8%BE%BC%E3%81%BF%E3%81%82%E3%82%8A%E3%81%AEcount"><i class="fa fa-link"></i></a>絞り込みありのCount</h2>

<p>EntityFramworkのCountには、引数に与えることでWhere関数のように絞り込み条件を指定することができます。<br>
その時のSQLは変わるのかを見てみます。</p>

<h3>
<span id="entityframworkでの表現-1" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-1"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>Count関数でageが4のレコードを絞り込みと絞り込み後のレコード数を数えています。<br>
関数部のみ記載しています。usingは一番上の例を見てください。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span><span class="err">　</span><span class="nf">CountTargetSample</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">PetCount</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Count</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Age</span> <span class="p">==</span> <span class="m">4</span><span class="p">);</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"pet count:{0}"</span><span class="p">,</span> <span class="n">PetCount</span><span class="p">);</span>
        <span class="p">}</span>

</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-1" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-1"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLとしては、絞り込みにWhere関数を使用した場合もCount関数を使用した場合も同じSQLが発行されていました。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 08:22:36.082 UTC [46] LOG:  execute &lt;unnamed&gt;: SELECT COUNT(*)::INT
        FROM pets AS p
        WHERE p.age = 4
</code></pre></div></div>

<h1>
<span id="selectによる取得値の違い" class="fragment"></span><a href="#select%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%96%E5%BE%97%E5%80%A4%E3%81%AE%E9%81%95%E3%81%84"><i class="fa fa-link"></i></a>selectによる取得値の違い</h1>

<p>Selectは取得したいカラムを指定することができる関数で、SQLとEntityFramwork両方にあります。大抵は、取得したいカラムを指定して取得する値を制限します。</p>

<h2>
<span id="取得カラム指定のselect" class="fragment"></span><a href="#%E5%8F%96%E5%BE%97%E3%82%AB%E3%83%A9%E3%83%A0%E6%8C%87%E5%AE%9A%E3%81%AEselect"><i class="fa fa-link"></i></a>取得カラム指定のselect</h2>

<p>Select関数を指定して取得するカラムを制限しています。これによって、シンプルなリストが返却されるので処理が簡単になります。</p>

<h3>
<span id="entityframworkでの表現-2" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-2"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>Select関数でageカラムを指定してAgeの値を格納したリストを取得しています。その後、ループで全部表示しています。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">SelectSample</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">AgeList</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Age</span><span class="p">);</span>

            <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">AgeList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"item:{0}"</span><span class="p">,</span> <span class="n">item</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-2" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-2"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLもageのみSelect文で取得するようになっていました。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 08:38:10.814 UTC [76] LOG:  execute &lt;unnamed&gt;: SELECT p.age
        FROM pets AS p
</code></pre></div></div>

<h2>
<span id="全カラム指定のselect" class="fragment"></span><a href="#%E5%85%A8%E3%82%AB%E3%83%A9%E3%83%A0%E6%8C%87%E5%AE%9A%E3%81%AEselect"><i class="fa fa-link"></i></a>全カラム指定のselect</h2>

<p>特に意味はないかもしれませんが、全カラムを取得するときは何も指定せずに使用します。</p>

<h3>
<span id="entityframworkでの表現-3" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-3"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>Select関数でPetModelを指定して値を格納したリストを取得しています。その後、ループで全部表示しています。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">SelectAllSample</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">PetList</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">);</span>

            <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">PetList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"item:{0}"</span><span class="p">,</span> <span class="n">item</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-3" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-3"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLは*での全指定ではなく、全カラムの指定をして取得するようになっていました。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 09:45:37.735 UTC [149] LOG:  execute &lt;unnamed&gt;: SELECT p.id, p.age, p.birthday, p.name
        FROM pets AS p
</code></pre></div></div>

<h2>
<span id="レコード条件指定のselect" class="fragment"></span><a href="#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6%E6%8C%87%E5%AE%9A%E3%81%AEselect"><i class="fa fa-link"></i></a>レコード条件指定のselect</h2>

<p>Select関数内に式を入れることにより、その式に一致しているレコードかのリストを取得できます。</p>

<h3>
<span id="entityframworkでの表現-4" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-4"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>Select関数でageが3より大きいという式を指定してTrue/Falseを格納したリストを取得しています。ageが3より大きいレコードに対してはTrue、以下のレコードに対してはFalseが返却されます。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">SelectBool</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">PetList</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Age</span><span class="p">&gt;</span><span class="m">3</span><span class="p">);</span>

            <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">PetList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"item:{0}"</span><span class="p">,</span> <span class="n">item</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-4" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-4"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLでも同じようにage&gt;3という式をselectで指定をして取得するようになっていました。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 09:48:21.145 UTC [153] LOG:  execute &lt;unnamed&gt;: SELECT p.age &gt; 3
        FROM pets AS p
</code></pre></div></div>

<h1>
<span id="レコード条件確認" class="fragment"></span><a href="#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>レコード条件確認</h1>

<p>AllやAnyなどレコードが条件に一致するかを判断する関数がEntityFramworkにあります。大抵は、Whereで条件を絞って関数でそのレコードがあるかをチェックします。</p>

<h2>
<span id="allによるレコード条件" class="fragment"></span><a href="#all%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6"><i class="fa fa-link"></i></a>Allによるレコード条件</h2>

<p>Allは全レコードが全て条件に一致するかを判断する関数です。</p>

<h3>
<span id="entityframworkでの表現-5" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-5"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>All関数でageカラムが2より大きいレコードを指定して、成否の値を取得しています。すべてのレコードのageが2より大きい場合True、一つでも小さいレコードがある場合Falseが返却されます。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">AllSample</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">All</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Age</span> <span class="p">&gt;</span> <span class="m">2</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"result:{0}"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-5" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-5"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLは大きくことなります。SQLとしては、まずWhere句を指定したSelect文でレコードを1つ取得するSQLとEXITST関数で存在有無を確認するSQLの2つを使用しています。内容としては条件を指定して1つでも取得できるレコードがあればFalseが返却されます。取得できなければTrueが返却されます。EntityFramworkで逆にして返却されるようです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 09:56:35.026 UTC [176] LOG:  execute &lt;unnamed&gt;: SELECT NOT EXISTS (
            SELECT 1
            FROM pets AS p
            WHERE p.age &lt;= 2)
</code></pre></div></div>

<h2>
<span id="anyによるレコード条件" class="fragment"></span><a href="#any%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6"><i class="fa fa-link"></i></a>Anyによるレコード条件</h2>

<p>Anyは一部のレコードが条件に一致するかを判断する関数です。</p>

<h3>
<span id="entityframworkでの表現-6" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-6"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>Any関数でageカラムが2より大きいレコードを指定して、成否の値を取得しています。一部のレコードのageが2より大きい場合True、全て小さいレコードの場合Falseが返却されます。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">AnySample</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Any</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Age</span> <span class="p">&gt;</span> <span class="m">2</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"result any:{0}"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-6" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-6"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLは大きくことなります。SQLとしては、Allと似通っていますが、NOT EXISTSがEXISTSに変わっているだけになります。内容としては条件を指定して1つでも取得できるレコードがあればTrueが返却されます。取得できなければFalseが返却されます。Allと異なりそのまま返却されるようです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 10:01:50.327 UTC [205] LOG:  execute &lt;unnamed&gt;: SELECT EXISTS (
            SELECT 1
            FROM pets AS p
            WHERE p.age &gt; 2)
</code></pre></div></div>

<h1>
<span id="取得レコードの指定" class="fragment"></span><a href="#%E5%8F%96%E5%BE%97%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a>取得レコードの指定</h1>

<p>SingleやFirst、Takeなど取得するレコード数を指定する関数がEntityFramworkにあります。</p>

<h2>
<span id="singleによる1レコード取得" class="fragment"></span><a href="#single%E3%81%AB%E3%82%88%E3%82%8B1%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97"><i class="fa fa-link"></i></a>Singleによる1レコード取得</h2>

<p>Singleは1レコードだけ取得する関数です。Countと同じく関数内に絞り込み条件を指定することができSQL的には変わりませんでした。</p>

<h3>
<span id="entityframworkでの表現-7" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-7"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>Single関数は1レコードの情報しか指定できないため、Where句で一意になるように絞り込み取得しています。返却される値はデータクラスになります。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhereSingle</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="c1">// var result = contexts.PetModels.Single(y=&gt;y.Id==1);</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Id</span><span class="p">==</span><span class="m">1</span><span class="p">).</span><span class="nf">Single</span><span class="p">();</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"result name:{0}"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-7" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-7"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLは大きくことなります。ちょっと分かり難いですが、SingleとしてはLIMIT句でレコード数を指定して全カラムを取得しています。なぜLIMITが2なのか分かりません。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 10:11:57.525 UTC [267] LOG:  execute &lt;unnamed&gt;: SELECT p.id, p.age, p.birthday, p.name
        FROM pets AS p
        WHERE p.id = 1
        LIMIT 2
</code></pre></div></div>

<h2>
<span id="firstによる1レコード取得" class="fragment"></span><a href="#first%E3%81%AB%E3%82%88%E3%82%8B1%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97"><i class="fa fa-link"></i></a>Firstによる1レコード取得</h2>

<p>Firstは最初の1レコードだけ取得する関数です。Countと同じく関数内に絞り込み条件を指定することができSQL的には変わりませんでした。</p>

<h3>
<span id="entityframworkでの表現-8" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-8"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>First関数もSingle関数と同じで1レコードの情報しか指定できないため、Where句で一意になるように絞り込み取得しています。返却される値はデータクラスになります。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhereFirst</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="c1">// var result = contexts.PetModels.First(y=&gt;y.Id==1);</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Id</span><span class="p">==</span><span class="m">1</span><span class="p">).</span><span class="nf">First</span><span class="p">();</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"result name:{0}"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-8" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-8"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLは大きくことなります。Singleと同じでLIMIT句でレコード数を指定して全カラムを取得しています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 10:24:35.315 UTC [280] LOG:  execute &lt;unnamed&gt;: SELECT p.id, p.age, p.birthday, p.name
        FROM pets AS p
        WHERE p.id = 1
        LIMIT 1
</code></pre></div></div>

<h2>
<span id="takeによる複数レコード取得" class="fragment"></span><a href="#take%E3%81%AB%E3%82%88%E3%82%8B%E8%A4%87%E6%95%B0%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97"><i class="fa fa-link"></i></a>takeによる複数レコード取得</h2>

<p>takeは指定したレコードだけ取得する関数です。Countと同じく関数内に絞り込み条件を指定することができSQL的には変わりませんでした。</p>

<h3>
<span id="entityframworkでの表現-9" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-9"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>take関数は複数レコードの情報を取得できるので5レコード分取得しています。また、Where句でageが3より大きくなるように絞り込み取得しています。返却される値はデータクラスのリストになります。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhereTake</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">resultList</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Age</span> <span class="p">&gt;</span> <span class="m">3</span><span class="p">).</span><span class="nf">Take</span><span class="p">(</span><span class="m">5</span><span class="p">);</span>

            <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">resultList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"item name:{0}"</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-9" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-9"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLは大きくことなります。Singleと同じでLIMIT句でレコード数を指定して全カラムを取得しています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 10:42:01.769 UTC [390] LOG:  execute &lt;unnamed&gt;: SELECT p.id, p.age, p.birthday, p.name
        FROM pets AS p
        WHERE p.age &gt; 3
        LIMIT $1
2019-11-16 10:42:01.769 UTC [390] DETAIL:  parameters: $1 = '5'
</code></pre></div></div>

<h1>
<span id="レコード順操作" class="fragment"></span><a href="#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E9%A0%86%E6%93%8D%E4%BD%9C"><i class="fa fa-link"></i></a>レコード順操作</h1>

<p>レコード順操作にはOrderByやSkipなどがあります。OrderByではSQLにもあるので特にまとめは必要ないかもしれませんがSkipはSQLにないのでまとめておきます。</p>

<h2>
<span id="skipによるレコード操作" class="fragment"></span><a href="#skip%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%93%8D%E4%BD%9C"><i class="fa fa-link"></i></a>skipによるレコード操作</h2>

<p>Skipはレコードを指定したレコード数を省略して取得します。</p>

<h3>
<span id="entityframworkでの表現-10" class="fragment"></span><a href="#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-10"><i class="fa fa-link"></i></a>EntityFramworkでの表現</h3>

<p>Skip関数を指定して1レコード分スキップして値を取得しています。返却される値はデータクラスのリストになります。</p>

<div class="code-frame" data-lang="c#">
<div class="code-lang"><span class="bold">LinqEF.cs</span></div>
<div class="highlight"><pre><code>        <span class="k">public</span> <span class="k">void</span> <span class="nf">WhereSkip</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PetsContext</span> <span class="n">contexts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PetsContext</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">resultList</span> <span class="p">=</span> <span class="n">contexts</span><span class="p">.</span><span class="n">PetModels</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">Age</span> <span class="p">&gt;</span> <span class="m">3</span><span class="p">).</span><span class="nf">Skip</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>

            <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">resultList</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"item:{0}"</span><span class="p">,</span> <span class="n">item</span><span class="p">);</span>
            <span class="p">}</span>            
        <span class="p">}</span>
</code></pre></div>
</div>

<h3>
<span id="sqlでの表現db側のログ-10" class="fragment"></span><a href="#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-10"><i class="fa fa-link"></i></a>SQLでの表現(DB側のログ)</h3>

<p>SQLは大きくことなります。OFFSET句でスキップレコードを指定しています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>2019-11-16 10:45:36.619 UTC [420] LOG:  execute &lt;unnamed&gt;: SELECT p.id, p.age, p.birthday, p.name
        FROM pets AS p
        WHERE p.age &gt; 3
        ORDER BY (SELECT 1)
        OFFSET $1
2019-11-16 10:45:36.619 UTC [420] DETAIL:  parameters: $1 = '1'
</code></pre></div></div>

<h1>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p>EntityFramworkで色々SQLを見てきましたが、如何に面倒な作業を肩代わりしてくれているかがわかりました。<br>
一方で使い方を正しく理解できないと思わぬSQLを実行してしまう可能性もあり、どこまで理解すれば良いのか悩んでしまいました。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fmink0212%2Fitems%2F4c0fb588e07af41882e3&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fmink0212%2Fitems%2F4c0fb588e07af41882e3&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/mink0212/items/4c0fb588e07af41882e3/likers" class="css-1iupg5d">3</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">4</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/4c0fb588e07af41882e3/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/mink0212/items/4c0fb588e07af41882e3/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/mink0212/items/4c0fb588e07af41882e3/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/mink0212/items/4c0fb588e07af41882e3/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/mink0212/items/4c0fb588e07af41882e3.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-83b242da-51b1-48cf-a4e8-14ecb2a4c50c">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-8b9e4802-8d81-41a2-bb40-2b1011cacc75"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-8b9e4802-8d81-41a2-bb40-2b1011cacc75">{}</script>
      
<div id="LoginModal-react-component-4d575b23-ea10-4075-9fd4-689cc27f858e"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-4d575b23-ea10-4075-9fd4-689cc27f858e">{}</script>
      
<div id="StockModal-react-component-62a47e98-6386-4ee6-8fd4-de90fe48424a"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-62a47e98-6386-4ee6-8fd4-de90fe48424a">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;LTQ35MbFdDtfjZKF7K/jrAg3i6XtIaICcSuFbUZT6H0ISqUb078fDkYksfV8yB20VncPIUIhvr/yK/dUxvkt/A==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eDBから情報取得や登録以外にもレコードを数える関数や取得レコードの数を指定するSQLがあります。そのようなSQLや若干特殊な操作をEntityFramworkで実行して、DBのログに表示されるSQLをまとめました。\u003ca href=\"https://qiita.com/mink0212/items/fcf4cb16991e11cd2a98\" id=\"reference-0d1ddb804b6494029794\"\u003e前回\u003c/a\u003eと\u003ca href=\"https://qiita.com/mink0212/items/d3274e070d79071480ab\" id=\"reference-a04210e4f1a5a257d9fc\"\u003e前々回\u003c/a\u003eの続きです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"環境\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e環境\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows:10\u003c/li\u003e\n\u003cli\u003edotnet:3.0.100\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"レコード数を数えるcount\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%95%B0%E3%82%92%E6%95%B0%E3%81%88%E3%82%8Bcount\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eレコード数を数えるCount\u003c/h1\u003e\n\n\u003cp\u003eSelectで使用するCountはレコードを数える関数で、SQLとEntityFramwork両方にあります。大抵は、Where句を使用してある条件のレコード数を調べるときに使います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"シンプルなcount\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AAcount\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eシンプルなCount\u003c/h2\u003e\n\n\u003cp\u003eSQLで使用するように、Where句で条件を指定してCount関数でレコード数を取得してみます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003e絞り込み関数(Where)でageが4のレコードを絞り込み、Count関数で絞り込み後のレコード数を数えています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.Linq\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eLinqStandard.EF\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDBSample\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLinqEF\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWhereCountSample\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ePetCount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"pet count:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePetCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eCount文としては、一部を除いて特殊なものはなくWhereで条件を絞り込んでCountで数えています。\u003cbr\u003e\nただし、Countの対象カラムは特に指定せず全カラムを指定しており、Int型で返ってくるように指定しているようです。\u003cbr\u003e\nInt型の指定をしたくないときはLongCount関数を使用します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 08:16:56.625 UTC [33] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT COUNT(*)::INT\n        FROM pets AS p\n        WHERE p.age = 4\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"絞り込みありのcount\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%9E%E3%82%8A%E8%BE%BC%E3%81%BF%E3%81%82%E3%82%8A%E3%81%AEcount\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e絞り込みありのCount\u003c/h2\u003e\n\n\u003cp\u003eEntityFramworkのCountには、引数に与えることでWhere関数のように絞り込み条件を指定することができます。\u003cbr\u003e\nその時のSQLは変わるのかを見てみます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eCount関数でageが4のレコードを絞り込みと絞り込み後のレコード数を数えています。\u003cbr\u003e\n関数部のみ記載しています。usingは一番上の例を見てください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e\u003cspan class=\"err\"\u003e　\u003c/span\u003e\u003cspan class=\"nf\"\u003eCountTargetSample\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ePetCount\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"pet count:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePetCount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLとしては、絞り込みにWhere関数を使用した場合もCount関数を使用した場合も同じSQLが発行されていました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 08:22:36.082 UTC [46] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT COUNT(*)::INT\n        FROM pets AS p\n        WHERE p.age = 4\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"selectによる取得値の違い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#select%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%96%E5%BE%97%E5%80%A4%E3%81%AE%E9%81%95%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eselectによる取得値の違い\u003c/h1\u003e\n\n\u003cp\u003eSelectは取得したいカラムを指定することができる関数で、SQLとEntityFramwork両方にあります。大抵は、取得したいカラムを指定して取得する値を制限します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"取得カラム指定のselect\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%96%E5%BE%97%E3%82%AB%E3%83%A9%E3%83%A0%E6%8C%87%E5%AE%9A%E3%81%AEselect\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e取得カラム指定のselect\u003c/h2\u003e\n\n\u003cp\u003eSelect関数を指定して取得するカラムを制限しています。これによって、シンプルなリストが返却されるので処理が簡単になります。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eSelect関数でageカラムを指定してAgeの値を格納したリストを取得しています。その後、ループで全部表示しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSelectSample\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eAgeList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eAgeList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"item:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLもageのみSelect文で取得するようになっていました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 08:38:10.814 UTC [76] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT p.age\n        FROM pets AS p\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"全カラム指定のselect\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%A8%E3%82%AB%E3%83%A9%E3%83%A0%E6%8C%87%E5%AE%9A%E3%81%AEselect\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e全カラム指定のselect\u003c/h2\u003e\n\n\u003cp\u003e特に意味はないかもしれませんが、全カラムを取得するときは何も指定せずに使用します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eSelect関数でPetModelを指定して値を格納したリストを取得しています。その後、ループで全部表示しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSelectAllSample\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ePetList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ePetList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"item:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLは*での全指定ではなく、全カラムの指定をして取得するようになっていました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 09:45:37.735 UTC [149] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT p.id, p.age, p.birthday, p.name\n        FROM pets AS p\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"レコード条件指定のselect\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6%E6%8C%87%E5%AE%9A%E3%81%AEselect\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eレコード条件指定のselect\u003c/h2\u003e\n\n\u003cp\u003eSelect関数内に式を入れることにより、その式に一致しているレコードかのリストを取得できます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eSelect関数でageが3より大きいという式を指定してTrue/Falseを格納したリストを取得しています。ageが3より大きいレコードに対してはTrue、以下のレコードに対してはFalseが返却されます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eSelectBool\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ePetList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSelect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ePetList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"item:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLでも同じようにage\u0026gt;3という式をselectで指定をして取得するようになっていました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 09:48:21.145 UTC [153] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT p.age \u0026gt; 3\n        FROM pets AS p\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"レコード条件確認\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6%E7%A2%BA%E8%AA%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eレコード条件確認\u003c/h1\u003e\n\n\u003cp\u003eAllやAnyなどレコードが条件に一致するかを判断する関数がEntityFramworkにあります。大抵は、Whereで条件を絞って関数でそのレコードがあるかをチェックします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"allによるレコード条件\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#all%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAllによるレコード条件\u003c/h2\u003e\n\n\u003cp\u003eAllは全レコードが全て条件に一致するかを判断する関数です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eAll関数でageカラムが2より大きいレコードを指定して、成否の値を取得しています。すべてのレコードのageが2より大きい場合True、一つでも小さいレコードがある場合Falseが返却されます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAllSample\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAll\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"result:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLは大きくことなります。SQLとしては、まずWhere句を指定したSelect文でレコードを1つ取得するSQLとEXITST関数で存在有無を確認するSQLの2つを使用しています。内容としては条件を指定して1つでも取得できるレコードがあればFalseが返却されます。取得できなければTrueが返却されます。EntityFramworkで逆にして返却されるようです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 09:56:35.026 UTC [176] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT NOT EXISTS (\n            SELECT 1\n            FROM pets AS p\n            WHERE p.age \u0026lt;= 2)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"anyによるレコード条件\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#any%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAnyによるレコード条件\u003c/h2\u003e\n\n\u003cp\u003eAnyは一部のレコードが条件に一致するかを判断する関数です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eAny関数でageカラムが2より大きいレコードを指定して、成否の値を取得しています。一部のレコードのageが2より大きい場合True、全て小さいレコードの場合Falseが返却されます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eAnySample\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"result any:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLは大きくことなります。SQLとしては、Allと似通っていますが、NOT EXISTSがEXISTSに変わっているだけになります。内容としては条件を指定して1つでも取得できるレコードがあればTrueが返却されます。取得できなければFalseが返却されます。Allと異なりそのまま返却されるようです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 10:01:50.327 UTC [205] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT EXISTS (\n            SELECT 1\n            FROM pets AS p\n            WHERE p.age \u0026gt; 2)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"取得レコードの指定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%96%E5%BE%97%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%8C%87%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e取得レコードの指定\u003c/h1\u003e\n\n\u003cp\u003eSingleやFirst、Takeなど取得するレコード数を指定する関数がEntityFramworkにあります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"singleによる1レコード取得\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#single%E3%81%AB%E3%82%88%E3%82%8B1%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSingleによる1レコード取得\u003c/h2\u003e\n\n\u003cp\u003eSingleは1レコードだけ取得する関数です。Countと同じく関数内に絞り込み条件を指定することができSQL的には変わりませんでした。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-7\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eSingle関数は1レコードの情報しか指定できないため、Where句で一意になるように絞り込み取得しています。返却される値はデータクラスになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWhereSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// var result = contexts.PetModels.Single(y=\u0026gt;y.Id==1);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"p\"\u003e==\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSingle\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"result name:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-7\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLは大きくことなります。ちょっと分かり難いですが、SingleとしてはLIMIT句でレコード数を指定して全カラムを取得しています。なぜLIMITが2なのか分かりません。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 10:11:57.525 UTC [267] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT p.id, p.age, p.birthday, p.name\n        FROM pets AS p\n        WHERE p.id = 1\n        LIMIT 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"firstによる1レコード取得\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#first%E3%81%AB%E3%82%88%E3%82%8B1%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eFirstによる1レコード取得\u003c/h2\u003e\n\n\u003cp\u003eFirstは最初の1レコードだけ取得する関数です。Countと同じく関数内に絞り込み条件を指定することができSQL的には変わりませんでした。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-8\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eFirst関数もSingle関数と同じで1レコードの情報しか指定できないため、Where句で一意になるように絞り込み取得しています。返却される値はデータクラスになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWhereFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e// var result = contexts.PetModels.First(y=\u0026gt;y.Id==1);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"p\"\u003e==\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"result name:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-8\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLは大きくことなります。Singleと同じでLIMIT句でレコード数を指定して全カラムを取得しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 10:24:35.315 UTC [280] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT p.id, p.age, p.birthday, p.name\n        FROM pets AS p\n        WHERE p.id = 1\n        LIMIT 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"takeによる複数レコード取得\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#take%E3%81%AB%E3%82%88%E3%82%8B%E8%A4%87%E6%95%B0%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003etakeによる複数レコード取得\u003c/h2\u003e\n\n\u003cp\u003etakeは指定したレコードだけ取得する関数です。Countと同じく関数内に絞り込み条件を指定することができSQL的には変わりませんでした。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-9\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003etake関数は複数レコードの情報を取得できるので5レコード分取得しています。また、Where句でageが3より大きくなるように絞り込み取得しています。返却される値はデータクラスのリストになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWhereTake\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresultList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eTake\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eresultList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"item name:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-9\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLは大きくことなります。Singleと同じでLIMIT句でレコード数を指定して全カラムを取得しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 10:42:01.769 UTC [390] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT p.id, p.age, p.birthday, p.name\n        FROM pets AS p\n        WHERE p.age \u0026gt; 3\n        LIMIT $1\n2019-11-16 10:42:01.769 UTC [390] DETAIL:  parameters: $1 = '5'\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"レコード順操作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E9%A0%86%E6%93%8D%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eレコード順操作\u003c/h1\u003e\n\n\u003cp\u003eレコード順操作にはOrderByやSkipなどがあります。OrderByではSQLにもあるので特にまとめは必要ないかもしれませんがSkipはSQLにないのでまとめておきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"skipによるレコード操作\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#skip%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%93%8D%E4%BD%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eskipによるレコード操作\u003c/h2\u003e\n\n\u003cp\u003eSkipはレコードを指定したレコード数を省略して取得します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"entityframworkでの表現-10\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-10\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEntityFramworkでの表現\u003c/h3\u003e\n\n\u003cp\u003eSkip関数を指定して1レコード分スキップして値を取得しています。返却される値はデータクラスのリストになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"c#\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eLinqEF.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eWhereSkip\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ePetsContext\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003ePetsContext\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eresultList\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePetModels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAge\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eSkip\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eresultList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eConsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"item:{0}\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e            \n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sqlでの表現db側のログ-10\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-10\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQLでの表現(DB側のログ)\u003c/h3\u003e\n\n\u003cp\u003eSQLは大きくことなります。OFFSET句でスキップレコードを指定しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e2019-11-16 10:45:36.619 UTC [420] LOG:  execute \u0026lt;unnamed\u0026gt;: SELECT p.id, p.age, p.birthday, p.name\n        FROM pets AS p\n        WHERE p.age \u0026gt; 3\n        ORDER BY (SELECT 1)\n        OFFSET $1\n2019-11-16 10:45:36.619 UTC [420] DETAIL:  parameters: $1 = '1'\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h1\u003e\n\n\u003cp\u003eEntityFramworkで色々SQLを見てきましたが、如何に面倒な作業を肩代わりしてくれているかがわかりました。\u003cbr\u003e\n一方で使い方を正しく理解できないと思わぬSQLを実行してしまう可能性もあり、どこまで理解すれば良いのか悩んでしまいました。\u003c/p\u003e\n","createdAt":"2019-11-17T13:33:17Z","elapsedYearsFromLastModifiedAt":1,"encryptedId":"NKRGmfOdzz91hje1y8NDbtILcbboleyAqw==--56N0NlcdK0WlGXek--g4zTi6kvrAvRS6ejHUKQLA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2019-11-17T13:33:17Z","likesCount":3,"linkUrl":"https://qiita.com/mink0212/items/4c0fb588e07af41882e3","organization":null,"originalId":1080735,"stockedCount":4,"title":"C#のentityframworkで特殊なSQLをためす","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%92%B0%E5%A2%83\"\u003e環境\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%95%B0%E3%82%92%E6%95%B0%E3%81%88%E3%82%8Bcount\"\u003eレコード数を数えるCount\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AAcount\"\u003eシンプルなCount\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B5%9E%E3%82%8A%E8%BE%BC%E3%81%BF%E3%81%82%E3%82%8A%E3%81%AEcount\"\u003e絞り込みありのCount\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-1\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-1\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#select%E3%81%AB%E3%82%88%E3%82%8B%E5%8F%96%E5%BE%97%E5%80%A4%E3%81%AE%E9%81%95%E3%81%84\"\u003eselectによる取得値の違い\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%96%E5%BE%97%E3%82%AB%E3%83%A9%E3%83%A0%E6%8C%87%E5%AE%9A%E3%81%AEselect\"\u003e取得カラム指定のselect\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-2\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-2\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%A8%E3%82%AB%E3%83%A9%E3%83%A0%E6%8C%87%E5%AE%9A%E3%81%AEselect\"\u003e全カラム指定のselect\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-3\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-3\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6%E6%8C%87%E5%AE%9A%E3%81%AEselect\"\u003eレコード条件指定のselect\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-4\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-4\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6%E7%A2%BA%E8%AA%8D\"\u003eレコード条件確認\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#all%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6\"\u003eAllによるレコード条件\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-5\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-5\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#any%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%9D%A1%E4%BB%B6\"\u003eAnyによるレコード条件\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-6\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-6\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%96%E5%BE%97%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%8C%87%E5%AE%9A\"\u003e取得レコードの指定\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#single%E3%81%AB%E3%82%88%E3%82%8B1%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97\"\u003eSingleによる1レコード取得\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-7\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-7\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#first%E3%81%AB%E3%82%88%E3%82%8B1%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97\"\u003eFirstによる1レコード取得\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-8\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-8\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#take%E3%81%AB%E3%82%88%E3%82%8B%E8%A4%87%E6%95%B0%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E5%8F%96%E5%BE%97\"\u003etakeによる複数レコード取得\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-9\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-9\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E9%A0%86%E6%93%8D%E4%BD%9C\"\u003eレコード順操作\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#skip%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89%E6%93%8D%E4%BD%9C\"\u003eskipによるレコード操作\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#entityframwork%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BE-10\"\u003eEntityFramworkでの表現\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#sql%E3%81%A7%E3%81%AE%E8%A1%A8%E7%8F%BEdb%E5%81%B4%E3%81%AE%E3%83%AD%E3%82%B0-10\"\u003eSQLでの表現(DB側のログ)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":1436,"uuid":"4c0fb588e07af41882e3","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"OTH514nbzLHWXSOqCIii8U5sdS45--UL/cYxKcXkQt8Q2s--hfRcJ1ZkLzMlDlbv6uVmHg==","originalId":481713,"description":"日々気になったことや勉強したことやノウハウなどをまとめています。\r\nちょっとツールやライブラリの使用方法に偏りがち\r\n開発の考えはHatena Blog（https://mink0212.hatenablog.com/）の方で書いていきます。","facebookUrl":"https://facebook.com/shuichi.sagawa.1","githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://lh4.googleusercontent.com/-DxFhtRGhVeI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc5LPGspdzDsWGIQ-lHFPVN_FMrcA/s50/photo.jpg","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Flh4.googleusercontent.com%2F-DxFhtRGhVeI%2FAAAAAAAAAAI%2FAAAAAAAAAAA%2FACHi3rc5LPGspdzDsWGIQ-lHFPVN_FMrcA%2Fs50%2Fphoto.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=bd5365637ad1aa713a8ee5066116f5b5","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Flh4.googleusercontent.com%2F-DxFhtRGhVeI%2FAAAAAAAAAAI%2FAAAAAAAAAAA%2FACHi3rc5LPGspdzDsWGIQ-lHFPVN_FMrcA%2Fs50%2Fphoto.jpg?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=360c5b6a6dd8e731f1ee538db9de5f2e","urlName":"mink0212","websiteUrl":"","twitterUrl":"https://twitter.com/lie2468","twitterUrlName":"lie2468","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":".NET","urlName":".net"},{"name":"PostgreSQL","urlName":"postgresql"},{"name":"EntityFramework","urlName":"entityframework"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
