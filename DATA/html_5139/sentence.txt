More than 3 years have passed since last update.非同期のコードはいくつかパターンがありますが、なるべく一つにしたいため、async/awaitに統一できないか検討するなかで、Process.StartとExitedイベントのパターンをasync/awaitで記述する方法を見つけたのでメモしておきます。下記、stackoverflowを参考にしました。ほぼリンク先の通りです。https://stackoverflow.com/questions/10788982/is-there-any-async-equivalent-of-process-startある2つのファイル(sourceFileName, destinationFileName)に対してFCコマンドを実行し、結果を取得するサンプルです。最終的には、Exitedイベント内で、FCの結果をProcess.ExitCodeで取得したりしていますが、サンプルには含めませんでした。
AsParallelと組み合わせて並列化してみようかとチャレンジしてみましたが、どうも正しくExitCodeが取れず、断念。
結局、この例はあまり非同期実行する意味が無いサンプルになっている状態です。※実際は、もっと時間のかかる自作VBScriptを非同期で実行するために調べていたのですが、サンプルとしてわかりにくくなるかなと思い、Window標準コマンドを実行するサンプルにしました。


