<!DOCTYPE html><html><head><meta charset="utf-8" /><title>デスクトップマスコットの作り方 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/massoumen/items/2985a0fb30472b97a590" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="xC7ajfOz07nVttckopC8Dl8PwQeY+YDMFHAHgpy/no+5Ijzbg5jsieuC8vI2YjgSUTvx61YUbvRfLL5ZXOh6BA==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta content="@massoumen" name="twitter:creator" /><meta property="og:type" content="article"><meta property="og:title" content="デスクトップマスコットの作り方 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NE9INDRLNTQ0S3Y0NE9JNDRPRDQ0T1g0NE9lNDRLNTQ0S3o0NE9ENDRPSTQ0R3U1TDJjNDRLSzVwYTUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ODk5ODBmMzZhYzQxNmNhYWEzMTliYTk5ODIzNDU3ZTY&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFoYzNOdmRXMWxiZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTJhZjA4M2I4NDA1OTE5NWMzNmYwMDM4MGZkNDAzZGY4&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=5d52368bb85b191ffc61389abcc1fd45"><meta property="og:description" content="この記事はCCS Advent Calendar 2017の15日目の記事です。

昨日の記事：なんか旅について記事書きます by ちー(@chii_botti)

(追記)
2018/10/12 記述ミスの修正及び記述の追加(Mic..."><meta content="https://qiita.com/massoumen/items/2985a0fb30472b97a590" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,DXライブラリ,CoreTweet" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-f8e99c92-0b41-436c-b8c2-b4a0042f0849"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Fmassoumen%2Fitems%2F2985a0fb30472b97a590">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Fmassoumen%2Fitems%2F2985a0fb30472b97a590">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-f8e99c92-0b41-436c-b8c2-b4a0042f0849">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2017-12-15T02:14:33.000+09:00","dateModified":"2018-10-12T22:57:12.000+09:00","headline":"デスクトップマスコットの作り方","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NE9INDRLNTQ0S3Y0NE9JNDRPRDQ0T1g0NE9lNDRLNTQ0S3o0NE9ENDRPSTQ0R3U1TDJjNDRLSzVwYTUmdHh0LWNvbG9yPSUyMzMzMyZ0eHQtZm9udD1IaXJhZ2lubyUyMFNhbnMlMjBXNiZ0eHQtc2l6ZT01NCZ0eHQtY2xpcD1lbGxpcHNpcyZ0eHQtYWxpZ249Y2VudGVyJTJDbWlkZGxlJnM9ODk5ODBmMzZhYzQxNmNhYWEzMTliYTk5ODIzNDU3ZTY\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RRzFoYzNOdmRXMWxiZyZ0eHQtY29sb3I9JTIzMzMzJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTQ1JnR4dC1hbGlnbj1yaWdodCUyQ2JvdHRvbSZzPTJhZjA4M2I4NDA1OTE5NWMzNmYwMDM4MGZkNDAzZGY4\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=5d52368bb85b191ffc61389abcc1fd45","mainEntityOfPage":"https://qiita.com/massoumen/items/2985a0fb30472b97a590","author":{"@type":"Person","address":null,"email":null,"identifier":"massoumen","name":"massoumen","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fprofile-images%2F1478095684?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e1d506560a1593fb7a8f83b0ff5b037e","url":"https://qiita.com/massoumen","description":null,"memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita&amp;utm_medium=header-banner">社内改善＝業界革新。GA technologiesの一石三鳥な社内プロダクト開発とは</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"massoumen","type":"items","id":"2985a0fb30472b97a590"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"社内改善＝業界革新。GA technologiesの一石三鳥な社内プロダクト開発とは","url":"https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"massoumen","type":"items","id":"2985a0fb30472b97a590"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"社内改善＝業界革新。GA technologiesの一石三鳥な社内プロダクト開発とは","url":"https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"massoumen","type":"items","id":"2985a0fb30472b97a590"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"社内改善＝業界革新。GA technologiesの一石三鳥な社内プロダクト開発とは","url":"https://zine.qiita.com/interview/202104-ga-technologies/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/massoumen/items/2985a0fb30472b97a590","location":"/massoumen/items/2985a0fb30472b97a590","scheme":"https","host":"qiita.com","port":null,"pathname":"/massoumen/items/2985a0fb30472b97a590","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"tQqgYDfyCuc+pXTTP6AXQcmxeE10q/TCSHsYdArimjjIBkY2R9k11wCRUQWrUpNdx4VIobpGGvoDJ6GvyrV+sw==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-c0d2b73d-8ab6-4408-a4dc-8307bd2ce7d7"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/massoumen/items/2985a0fb30472b97a590/likers" class="css-1iupg5d">92</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">112</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/2985a0fb30472b97a590/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/massoumen/items/2985a0fb30472b97a590/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/massoumen/items/2985a0fb30472b97a590/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/massoumen/items/2985a0fb30472b97a590/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/massoumen/items/2985a0fb30472b97a590.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 1 year has passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/massoumen"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/124566/profile-images/1478095684" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/massoumen" class="css-10ougpm">@<!-- -->massoumen</a><div class="css-1ay9vb9"><span><meta content="2017-12-14T17:14:33Z"/><time dateTime="2018-10-12T13:57:12Z" class="css-m19uds">updated at 2018-10-12</time></span></div></div></div></div></div><h1 class="css-cgzq40">デスクトップマスコットの作り方</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/dx%e3%83%a9%e3%82%a4%e3%83%96%e3%83%a9%e3%83%aa" class="css-4czcte">DXライブラリ</a><a href="/tags/coretweet" class="css-4czcte">CoreTweet</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>この記事は<a href="https://adventar.org/calendars/2551" rel="nofollow noopener" target="_blank">CCS Advent Calendar 2017</a>の15日目の記事です。</p>

<p>昨日の記事：<a href="http://chii-botti.hatenadiary.jp/entry/2017/12/14/175542" rel="nofollow noopener" target="_blank">なんか旅について記事書きます</a> by ちー(<a href="https://twitter.com/chii_botti" rel="nofollow noopener" target="_blank">@chii_botti</a>)</p>

<p>(追記)<br>
2018/10/12 記述ミスの修正及び記述の追加(Michio029さん、ありがとうございます)</p>

<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>まずはこちらをご覧ください。</p>

<p><a href="https://camo.qiitausercontent.com/b121ab73709d24f987eb44ec3d72e0920a599c1b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f63333236343163392d373561302d626634622d636639642d3261343038373530306166382e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/124566/c32641c9-75a0-bf4b-cf9d-2a4087500af8.gif" alt="30.gif" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/c32641c9-75a0-bf4b-cf9d-2a4087500af8.gif" loading="lazy"></a></p>

<p>デスクトップ上に女神が降臨しています。<br>
この記事では上のスクショのようなデスクトップマスコットを作ります。<br>
デスクトップマスコットとは、デスクトップ上にキャラクターが常駐するタイプのソフトウェアです。<br>
単純に癒し効果を期待したり、何か便利な機能が搭載されてたりします。</p>

<p>この記事では表示させるキャラクターにMMDモデルを利用し、まずモデルの描画・モーションの再生を目指します。<br>
その後、ちょっとした機能としてキャラクターに画像をドラッグ&amp;ドロップをする事でTwitterに投稿する機能を実装します。<br>
使用するものはこんな感じです。</p>

<table>
<thead>
<tr>
<th style="text-align: center">名称</th>
<th style="text-align: center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center">VisualStudio2017</td>
<td style="text-align: center">統合開発環境</td>
</tr>
<tr>
<td style="text-align: center">C#</td>
<td style="text-align: center">プログラミング言語</td>
</tr>
<tr>
<td style="text-align: center">DXライブラリ</td>
<td style="text-align: center">ゲームライブラリ</td>
</tr>
<tr>
<td style="text-align: center">CoreTweet</td>
<td style="text-align: center">TwitterAPIライブラリ</td>
</tr>
</tbody>
</table>

<h1>
<span id="目次" class="fragment"></span><a href="#%E7%9B%AE%E6%AC%A1"><i class="fa fa-link"></i></a>目次</h1>

<ul>
<li>プロジェクトの作成</li>
<li>DXライブラリの導入</li>
<li>MMDモデルの描画</li>
<li>全画面化・背景の透明化</li>
<li>モーションの適用</li>
<li>CoreTweetの導入</li>
<li>認証情報の登録</li>
<li>画像の投稿</li>
</ul>

<h1>
<span id="プロジェクトの作成" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>プロジェクトの作成</h1>

<p>VisualStudio2017はインストール済みとします。<br>
(インストールしていない場合は<a href="http://www.softantenna.com/wp/tips/visual-studio-2017-install/" rel="nofollow noopener" target="_blank">このあたり</a>を参考にしながらインストールして下さい。)</p>

<p>まずプロジェクトを作成します。<br>
C#のWindowsフォームアプリケーション(.NET Framework)を選択します。<br>
プロジェクト名と場所はお好みで。</p>

<p><a href="https://camo.qiitausercontent.com/4360816597b812f5c7798b8ea8d1909e6970645a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f37323562333161342d653366662d353939312d663133342d6161323863366565343961302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F725b31a4-e3ff-5991-f134-aa28c6ee49a0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=983d684d0a199891829384c8fc8146fe" alt="1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/725b31a4-e3ff-5991-f134-aa28c6ee49a0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F725b31a4-e3ff-5991-f134-aa28c6ee49a0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c058a46613c3649d9e1bd9fa0f5ee4c2 1x" loading="lazy"></a></p>

<p>プロジェクトを作成すると、Form1.cs[デザイン]が開かれていると思います。<br>
(開いてない場合はForm1.csから開けます。)</p>

<p><a href="https://camo.qiitausercontent.com/6e569d21a8e2f2eebc902758105bed3c8efc09c6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f31386564653132662d633866332d373961612d366261362d3836643966633931386266392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F18ede12f-c8f3-79aa-6ba6-86d9fc918bf9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8ddd039c1b7598964f864f8309abd7e1" alt="8.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/18ede12f-c8f3-79aa-6ba6-86d9fc918bf9.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F18ede12f-c8f3-79aa-6ba6-86d9fc918bf9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=96346b45dc8c3d1eb63ed390b3f5df4c 1x" loading="lazy"></a></p>

<p>次にProgram.csを開きます。<br>
開くといろいろ書いてありますが、後半部分にMain関数があると思います。</p>

<p><a href="https://camo.qiitausercontent.com/90725977adfa91ff264ae066aa11313ca3563fdd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f36346433613832662d633265632d366539322d313635322d3136303133623939363230642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F64d3a82f-c2ec-6e92-1652-16013b99620d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4051287f3591b3d240b56fc5257592b5" alt="2.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/64d3a82f-c2ec-6e92-1652-16013b99620d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F64d3a82f-c2ec-6e92-1652-16013b99620d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=713fa77a362359d2eac11e4d6097a404 1x" loading="lazy"></a></p>

<p>次に「Form1.cs→Form1.Designer.cs→Form1→Form1()」より、Form1.csを開きます。<br>
(少し分かりにくいと思うので注意。)</p>

<p><a href="https://camo.qiitausercontent.com/cce72595710e0ba4764a865fb16e6f95b13097f3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f34313661313133312d393263352d346530302d646537382d6462353562363561666566622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F416a1131-92c5-4e00-de78-db55b65afefb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4b1f56663f4cac663f512485d73d2528" alt="3.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/416a1131-92c5-4e00-de78-db55b65afefb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F416a1131-92c5-4e00-de78-db55b65afefb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e421ee0c7f08a30cd7c5eae0e9d81616 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/102e04cafde929975ce4e03b68478a7595d3c499/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f66393837613465632d396666322d616330352d666362612d6666363339353138356265322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff987a4ec-9ff2-ac05-fcba-ff6395185be2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=dbd54226ee1436dcd9cec68300075642" alt="4.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/f987a4ec-9ff2-ac05-fcba-ff6395185be2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff987a4ec-9ff2-ac05-fcba-ff6395185be2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=0ba31ce4f428c1eea620f33cbcafd0d1 1x" loading="lazy"></a></p>

<p>これらを中心に編集してデスクトップマスコットを作成します。</p>

<h1>
<span id="dxライブラリの導入" class="fragment"></span><a href="#dx%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E5%B0%8E%E5%85%A5"><i class="fa fa-link"></i></a>DXライブラリの導入</h1>

<p>MMDモデルの描画などにDXライブラリというゲームライブラリの関数を使用するので、これを導入します。<br>
DXライブラリを使った事がある人は分かると思いますが、DXライブラリはC/C++用のゲームライブラリで、C#を使う場合は少し勝手が異なります。注意して下さい。<br>
まず、<a href="http://dxlib.o.oo7.jp/dxdload.html" rel="nofollow noopener" target="_blank">公式サイトのダウンロードページ</a>からVisualC#用パッケージをダウンロードします。ダウンロードしたらそれを解凍します。<br>
次に、先ほど作成したC#プロジェクトのフォルダの中で、実行ファイル(.exe)が作成されるフォルダ(基本的には「プロジェクト名/bin/Debug」か「プロジェクト名/bin/Release」)にDxLib.dll、DxLib_x64.dll、DxLibDotNet.dllをコピーします。</p>

<p><a href="https://camo.qiitausercontent.com/4c07de528e3d6564e173b60a002914e43da3651e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f32376335303830622d613961662d336639652d373832642d3739643431316362386161662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27c5080b-a9af-3f9e-782d-79d411cb8aaf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=73ac3665a402ab2ca2d877d61652a134" alt="5.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/27c5080b-a9af-3f9e-782d-79d411cb8aaf.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27c5080b-a9af-3f9e-782d-79d411cb8aaf.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3c878eedf9c6a0ffc3cd449624a2f3ef 1x" loading="lazy"></a></p>

<p>次にVisualStudio上で「プロジェクト→参照の追加」を選択します。<br>
参照マネージャが開くと思うので、それの参照タブを選び、右下の参照からコピーしたDxLibDotNet.dllを選択します。<br>
選択したらOKを押して閉じます。</p>

<p><a href="https://camo.qiitausercontent.com/a50d8adeb8afee7fa4a77276384690078776daa6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f66666235366465352d313633332d323966622d643139322d3365333333386430373163312e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fffb56de5-1633-29fb-d192-3e3338d071c1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1844a8ced322579bf45e363bb50b14a3" alt="6.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/ffb56de5-1633-29fb-d192-3e3338d071c1.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fffb56de5-1633-29fb-d192-3e3338d071c1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cf62fab7081d0753a6bc6282e02a885e 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/d81212d75fbfc575c31f73110056ab7b1e09abd8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f30366566316639612d303033362d306666302d653439362d3033663335653337396461362e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F06ef1f9a-0036-0ff0-e496-03f35e379da6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b98c73d045228f2153fd8047ad34ada8" alt="7.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/06ef1f9a-0036-0ff0-e496-03f35e379da6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F06ef1f9a-0036-0ff0-e496-03f35e379da6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c0e8721244d88234286b0018193d66d5 1x" loading="lazy"></a></p>

<p>設定を終えたので、プログラムを書きます。<br>
Form1.csとProgram.csをそれぞれ以下のように書き換えて下さい。<br>
(スペースの都合上、一部の記述を省略したりします。)</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Form1.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//usingいろいろ</span>
<span class="k">using</span> <span class="nn">DxLibDLL</span><span class="p">;</span><span class="c1">//DxLibを使用</span>

<span class="k">namespace</span> <span class="nn">DesktopMascot</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Form1</span> <span class="p">:</span> <span class="n">Form</span> <span class="p">{</span>
        <span class="c1">//</span>
        <span class="c1">//必要な変数</span>
        <span class="c1">//</span>

        <span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span><span class="c1">//フォームの初期設定</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetOutApplicationLogValidFlag</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//Log.txtを生成しないように設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetUserWindow</span><span class="p">(</span><span class="n">Handle</span><span class="p">);</span><span class="c1">//DxLibの親ウインドウをこのフォームに設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_Init</span><span class="p">();</span><span class="c1">//DxLibの初期化処理</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetDrawScreen</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">DX_SCREEN_BACK</span><span class="p">);</span><span class="c1">//描画先を裏画面に設定</span>

            <span class="c1">//</span>
            <span class="c1">//画像の読み込み等</span>
            <span class="c1">//</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">MainLoop</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">ClearDrawScreen</span><span class="p">();</span><span class="c1">//裏画面を消す</span>

            <span class="c1">//</span>
            <span class="c1">//毎フレーム呼ぶ処理</span>
            <span class="c1">//</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">ScreenFlip</span><span class="p">();</span><span class="c1">//裏画面を表画面にコピー</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_FormClosed</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FormClosedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_End</span><span class="p">();</span><span class="c1">//DxLibの終了処理</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Program.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//usingいろいろ</span>

<span class="k">namespace</span> <span class="nn">DesktopMascot</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">class</span> <span class="nc">Program</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">STAThread</span><span class="p">]</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Application</span><span class="p">.</span><span class="nf">EnableVisualStyles</span><span class="p">();</span>
            <span class="n">Application</span><span class="p">.</span><span class="nf">SetCompatibleTextRenderingDefault</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>

            <span class="n">Form1</span> <span class="n">form</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Form1</span><span class="p">();</span>

            <span class="n">form</span><span class="p">.</span><span class="nf">Show</span><span class="p">();</span>

            <span class="c1">//Application.Runではなく自分でループを作成</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">form</span><span class="p">.</span><span class="n">Created</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">form</span><span class="p">.</span><span class="nf">MainLoop</span><span class="p">();</span>
                <span class="n">Application</span><span class="p">.</span><span class="nf">DoEvents</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>DXライブラリの関数を使用する場合は「using DxLibDLL;」と書きます。<br>
また、関数やマクロの頭に「DX.」が付きます。C#の場合一部使えない関数があるそうですが、基本的な使い方はC/C++の場合と同じです。<br>
この記事ではDXライブラリの細かい使い方や説明については省かせてもらいます。<br>
(MMDモデルの描画など話のメインとなる部分についてはできるだけちゃんと書きます。)<br>
関数の詳細などについては<a href="http://dxlib.o.oo7.jp/dxfunc.html" rel="nofollow noopener" target="_blank">公式サイトの関数リファレンス</a>を参照して下さい。</p>

<p>今回はSetUserWindow関数でDXライブラリの描画先をフォームアプリケーションに設定します。<br>
こうする事でDXライブラリとフォームアプリケーションの両方の機能を利用できます。<br>
(参考：<a href="https://qiita.com/hart_edsf/items/0301f17e2d9acd890c5e">C#でDxLibを使う</a>)</p>

<p>また、ウインドウ(フォーム)が閉じられた時にDXライブラリの終了処理(DxLib_End関数)を実行するために、イベントを設定します。<br>
Form1.cs[デザイン]を開き、右下のプロパティの中のイベント(雷マーク)を選択し、FormClosedという項目にForm1_FormClosed関数を設定します。<br>
こうする事でフォームが閉じられた時にForm1_FormClosed関数が自動で実行されます。この関数ではDxLib_End関数が実行されるようにしているので、フォームが閉じられた時に自動でDXライブラリの終了処理が実行されます。</p>

<p><a href="https://camo.qiitausercontent.com/01f500186e4bf1e89e8885adf01cf2da66a4396e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f31396430663738352d613331622d643537342d343365372d3330643265663330373939302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F19d0f785-a31b-d574-43e7-30d2ef307990.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=644d1edd87be738cd234e7eb2193227e" alt="12.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/19d0f785-a31b-d574-43e7-30d2ef307990.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F19d0f785-a31b-d574-43e7-30d2ef307990.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=22dfa64ca45acca936694bc5c5bbdb27 1x" loading="lazy"></a></p>

<p>この状態で実行すると、以下のような黒い画面が出ると思います。<br>
出たらDXライブラリの導入は成功です。</p>

<p><a href="https://camo.qiitausercontent.com/1ae7f3504672d5df6cbef237e7dd218be49e39fb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f33633464373937332d623030352d633431322d393132612d3461316239303563353336662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3c4d7973-b005-c412-912a-4a1b905c536f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=56b9f8dc2b5cd36cb5e6ed18a0cd5fb1" alt="9.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/3c4d7973-b005-c412-912a-4a1b905c536f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3c4d7973-b005-c412-912a-4a1b905c536f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=299975f643a06294a6b87b955e6b9f88 1x" loading="lazy"></a></p>

<h1>
<span id="mmdモデルの描画" class="fragment"></span><a href="#mmd%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E6%8F%8F%E7%94%BB"><i class="fa fa-link"></i></a>MMDモデルの描画</h1>

<p>まず描画するMMDモデルを用意します。<br>
この記事では<a href="http://www.vocalomakets.com/mmd.html" rel="nofollow noopener" target="_blank">ここ</a>から結月ゆかりのMMDモデルをダウンロードして使用します。<br>
なぜ結月ゆかりを選んだかというと、単に結月ゆかりの事が好きすぎてたまらないからです。<br>
みなさんは好きなキャラのMMDモデルを用意して下さい。<br>
ただし、pmx形式のモデルの場合上手く描画できないケースがあるので注意して下さい。<br>
読み込める3Dモデルの形式については<a href="http://dxlib.o.oo7.jp/function/dxfunc_3d.html#R1N1" rel="nofollow noopener" target="_blank">関数リファレンス</a>を参照。</p>

<p>MMDモデルをダウンロード(+解凍)したら、「プロジェクト名/bin/Debug」を開き、MMDモデルなどを保存するDataフォルダを作ります。<br>
(単に分かりやすくしたいだけなので、しなくても良いです。)</p>

<p><a href="https://camo.qiitausercontent.com/3b1e91b411c6489567d1c57b9064a598d73dae35/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f33656334646562372d646164332d643437362d343339642d3666623535316564646564612e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3ec4deb7-dad3-d476-439d-6fb551eddeda.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=060141299aa351d571f39399dc901276" alt="10.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/3ec4deb7-dad3-d476-439d-6fb551eddeda.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3ec4deb7-dad3-d476-439d-6fb551eddeda.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d432991aa289e831af2937f34662bb4c 1x" loading="lazy"></a></p>

<p>作ったらその中にMMDモデルのデータとテクスチャを入れます。<br>
MMDモデルのファイル名は後で使用するので、必要なら分かりやすく書き換えておいて下さい。</p>

<p><a href="https://camo.qiitausercontent.com/30d543616e71e508bfa9c67e42a0767a17453a68/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f38616664333633382d386339652d646532622d666432342d3436343365353562313235662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F8afd3638-8c9e-de2b-fd24-4643e55b125f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3756b2b66d7d98457b126f5472e35d99" alt="11.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/8afd3638-8c9e-de2b-fd24-4643e55b125f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F8afd3638-8c9e-de2b-fd24-4643e55b125f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=30cce474e04bf5bf8893acdc4a0779d9 1x" loading="lazy"></a></p>

<p>MMDモデルを描画する準備ができたので、実際に描画します。<br>
プログラムを以下のように書き換えて下さい。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Form1.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//usingいろいろ</span>

<span class="k">namespace</span> <span class="nn">DesktopMascot</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Form1</span> <span class="p">:</span> <span class="n">Form</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">modelHandle</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span><span class="c1">//フォームの初期設定</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetOutApplicationLogValidFlag</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//Log.txtを生成しないように設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetUserWindow</span><span class="p">(</span><span class="n">Handle</span><span class="p">);</span><span class="c1">//DxLibの親ウインドウをこのフォームに設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_Init</span><span class="p">();</span><span class="c1">//DxLibの初期化処理</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetDrawScreen</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">DX_SCREEN_BACK</span><span class="p">);</span><span class="c1">//描画先を裏画面に設定</span>

            <span class="n">modelHandle</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1LoadModel</span><span class="p">(</span><span class="s">"Data/結月ゆかり_純.pmd"</span><span class="p">);</span><span class="c1">//3Dモデルの読み込み</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraNearFar</span><span class="p">(</span><span class="m">0.1f</span><span class="p">,</span> <span class="m">1000.0f</span><span class="p">);</span><span class="c1">//奥行0.1～1000をカメラの描画範囲とする</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraPositionAndTarget_UpVecY</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">0.0f</span><span class="p">,</span> <span class="m">10.0f</span><span class="p">,</span> <span class="p">-</span><span class="m">20.0f</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">0.0f</span><span class="p">,</span> <span class="m">10.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">));</span><span class="c1">//第1引数の位置から第2引数の位置を見る角度にカメラを設置</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">MainLoop</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">ClearDrawScreen</span><span class="p">();</span><span class="c1">//裏画面を消す</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">MV1DrawModel</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">);</span><span class="c1">//3Dモデルの描画</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">ScreenFlip</span><span class="p">();</span><span class="c1">//裏画面を表画面にコピー</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_FormClosed</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FormClosedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_End</span><span class="p">();</span><span class="c1">//DxLibの終了処理</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>MV1LoadModel関数でモデルを読み込みます。引数には読み込みたいモデルのパスを指定します。<br>
この関数は読み込んだモデルの識別番号(モデルハンドル)を返すのでそれを変数に保存しておきます。<br>
その後、ループ内でMV1DrawModel関数を実行する事で3Dモデルを描画します。引数には描画したいモデルのモデルハンドルを指定します。先ほど保存したモデルハンドルを与える事で読み込んだモデルを描画できます。</p>

<p>SetCameraNearFar関数はカメラのどの距離からどの距離まで描画するかを決定する関数です。<br>
SetCameraPositionAndTarget_UpVecY関数はカメラの位置を設定する関数です。第1引数の位置から第2引数の位置を見る向きにカメラを設定します。VGetは3次元ベクトル(x,y,z)を表します。<br>
カメラに関しては都合の良い感じに値を調整すればokです。</p>

<p>以下のようにMMDモデルが表示されたら成功です。</p>

<p><a href="https://camo.qiitausercontent.com/d55dde7a06fbe61a4df34ca9dbcb2e852feb060b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f62643163396438612d336434612d396531632d373135652d6136623030623734303037332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fbd1c9d8a-3d4a-9e1c-715e-a6b00b740073.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=872dc4f2fa94c2da7f9d63a9f9dcc96b" alt="13.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/bd1c9d8a-3d4a-9e1c-715e-a6b00b740073.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fbd1c9d8a-3d4a-9e1c-715e-a6b00b740073.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=243cb6fea776cb13807b9e0c0ab82398 1x" loading="lazy"></a></p>

<h1>
<span id="全画面化背景の透明化" class="fragment"></span><a href="#%E5%85%A8%E7%94%BB%E9%9D%A2%E5%8C%96%E8%83%8C%E6%99%AF%E3%81%AE%E9%80%8F%E6%98%8E%E5%8C%96"><i class="fa fa-link"></i></a>全画面化・背景の透明化</h1>

<p>このままだと、この狭いウインドウ内でしかキャラクターが描画されないのと、背景が邪魔です。なので、ウインドウの範囲をディスプレイ全体にし、背景を透明にします。</p>

<p>まずプログラムを以下のように書き換えます。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Form1.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//usingいろいろ</span>
<span class="k">using</span> <span class="nn">DxLibDLL</span><span class="p">;</span><span class="c1">//DxLibを使用</span>

<span class="k">namespace</span> <span class="nn">DesktopMascot</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Form1</span> <span class="p">:</span> <span class="n">Form</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">modelHandle</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span><span class="c1">//フォームの初期設定</span>

            <span class="n">ClientSize</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Size</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span><span class="c1">//画面サイズの設定</span>
            <span class="n">Text</span> <span class="p">=</span> <span class="s">"DesktopMascot"</span><span class="p">;</span><span class="c1">//ウインドウの名前を設定</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetOutApplicationLogValidFlag</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//Log.txtを生成しないように設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetUserWindow</span><span class="p">(</span><span class="n">Handle</span><span class="p">);</span><span class="c1">//DxLibの親ウインドウをこのフォームに設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_Init</span><span class="p">();</span><span class="c1">//DxLibの初期化処理</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetDrawScreen</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">DX_SCREEN_BACK</span><span class="p">);</span><span class="c1">//描画先を裏画面に設定</span>

            <span class="n">modelHandle</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1LoadModel</span><span class="p">(</span><span class="s">"Data/結月ゆかり_純.pmd"</span><span class="p">);</span><span class="c1">//3Dモデルの読み込み</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraNearFar</span><span class="p">(</span><span class="m">0.1f</span><span class="p">,</span> <span class="m">1000.0f</span><span class="p">);</span><span class="c1">//奥行0.1～1000をカメラの描画範囲とする</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraPositionAndTarget_UpVecY</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">0.0f</span><span class="p">,</span> <span class="m">10.0f</span><span class="p">,</span> <span class="p">-</span><span class="m">30.0f</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">0.0f</span><span class="p">,</span> <span class="m">10.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">));</span><span class="c1">//第1引数の位置から第2引数の位置を見る角度にカメラを設置</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">MainLoop</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">ClearDrawScreen</span><span class="p">();</span><span class="c1">//裏画面を消す</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DrawBox</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span><span class="p">,</span> <span class="n">DX</span><span class="p">.</span><span class="nf">GetColor</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="n">TRUE</span><span class="p">);</span><span class="c1">//背景を設定(透過させる)</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">MV1DrawModel</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">);</span><span class="c1">//3Dモデルの描画</span>

            <span class="c1">//ESCキーを押したら終了</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">CheckHitKey</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">KEY_INPUT_ESCAPE</span><span class="p">)</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">Close</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">ScreenFlip</span><span class="p">();</span><span class="c1">//裏画面を表画面にコピー</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_FormClosed</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FormClosedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_End</span><span class="p">();</span><span class="c1">//DxLibの終了処理</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_Shown</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">FormBorderStyle</span> <span class="p">=</span> <span class="n">FormBorderStyle</span><span class="p">.</span><span class="n">None</span><span class="p">;</span><span class="c1">//フォームの枠を非表示にする</span>
            <span class="n">TransparencyKey</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span><span class="c1">//透過色を設定</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>次にForm1.cs[デザイン]を開き、右下のプロパティの中のイベントのFormShownにForm1_Shown関数を設定します。</p>

<p><a href="https://camo.qiitausercontent.com/f96bb61a4b5fb35958feafb1a9d1bd2d309b4381/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f30626235363733312d623265372d363939392d303862632d3232303762623538346532332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F0bb56731-b2e7-6999-08bc-2207bb584e23.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=63ff900aa8d1fe9712f89fc1c2995201" alt="17.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/0bb56731-b2e7-6999-08bc-2207bb584e23.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F0bb56731-b2e7-6999-08bc-2207bb584e23.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d2111a770d57628fac776cd53564a8fe 1x" loading="lazy"></a></p>

<p>Screen.PrimaryScreen.Bounds.WidthとScreen.PrimaryScreen.Bounds.Heightでディスプレイの幅と高さを取得できるので、それをClientSizeに設定する事でウインドウの範囲がディスプレイ全体になります。</p>

<p>また、モデルを描画する前にDrawBox関数でウインドウ全体にTransparencyKeyで設定した透過色を描画します。こうする事で背景が透明になり、モデルだけが表示されます。<br>
(透過色には表示するモデルに使われてなさそうな色を設定して下さい。)</p>

<p>また、フォームの枠を非表示にしたため、右上のバツ印が消えてしまっています。<br>
なので、ESCキーを押したら終了するようにしておきます。(Close関数はフォームを閉じる関数です。)</p>

<p>ウインドウの大きさを変えたため、表示されるモデルの大きさも変わります。<br>
なので、カメラの位置を調整しています。</p>

<p>以下のように背景が透明になったら成功です。</p>

<p><a href="https://camo.qiitausercontent.com/dfad847e205d40a27ee33832286d88e389635dfb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f34653033656563382d623939362d313639332d346561622d3336346439323665633164342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F4e03eec8-b996-1693-4eab-364d926ec1d4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1fb9c035fb47c47bdb1cc251ab690785" alt="14.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/4e03eec8-b996-1693-4eab-364d926ec1d4.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F4e03eec8-b996-1693-4eab-364d926ec1d4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=950a9d11f4a91c845126b27046cf9a39 1x" loading="lazy"></a></p>

<p>…カメラの位置を弄ってたら事故りました。</p>

<p><a href="https://camo.qiitausercontent.com/b4e44728bd16f2ca14fd12a87740df651469fc96/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f39356331336537642d373230302d643334362d653163632d6135316637316365653736332e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F95c13e7d-7200-d346-e1cc-a51f71cee763.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=94e072df44f87ba18746198cad8ff733" alt="15.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/95c13e7d-7200-d346-e1cc-a51f71cee763.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F95c13e7d-7200-d346-e1cc-a51f71cee763.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cb5929d8150fd781e88591679f16c57b 1x" loading="lazy"></a></p>

<p>2018/10/12 追記<br><br>
コンストラクタ(public Form1())内のDXLib_Init()の直前に記述を追加し、以下のようにする事でモデルをより綺麗に描画する事ができるようです。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="n">DX</span><span class="p">.</span><span class="nf">SetOutApplicationLogValidFlag</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//Log.txtを生成しないように設定</span>
<span class="n">DX</span><span class="p">.</span><span class="nf">SetUserWindow</span><span class="p">(</span><span class="n">Handle</span><span class="p">);</span><span class="c1">//DxLibの親ウインドウをこのフォームに設定</span>
<span class="n">DX</span><span class="p">.</span><span class="nf">SetZBufferBitDepth</span><span class="p">(</span><span class="m">24</span><span class="p">);</span><span class="c1">//Zバッファの深度を24bitに変更</span>
<span class="n">DX</span><span class="p">.</span><span class="nf">SetCreateDrawValidGraphZBufferBitDepth</span><span class="p">(</span><span class="m">24</span><span class="p">);</span><span class="c1">//裏画面のZバッファの深度を24bitに変更</span>
<span class="n">DX</span><span class="p">.</span><span class="nf">SetFullSceneAntiAliasingMode</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span><span class="c1">//画面のフルスクリーンアンチエイリアスモードの設定をする</span>
<span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_Init</span><span class="p">();</span><span class="c1">//DxLibの初期化処理</span>
<span class="n">DX</span><span class="p">.</span><span class="nf">SetDrawScreen</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">DX_SCREEN_BACK</span><span class="p">);</span><span class="c1">//描画先を裏画面に設定</span>
</code></pre></div></div>

<p>用いるモデルによりどの程度綺麗になるかは変わると思われますが、今回使用しているモデルの適用前と適用後は以下のようになりました。</p>

<ul>
<li><p>変更前<br><br>
<a href="https://camo.qiitausercontent.com/e69d4625c5721e1996de592cf1906c5b1cdf265a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f35396134613731392d613536372d643738612d353138612d6133383464363330643864342e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F59a4a719-a567-d78a-518a-a384d630d8d4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=441ce7bc19cf99470ecbaf14edf50a4e" alt="before.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/59a4a719-a567-d78a-518a-a384d630d8d4.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F59a4a719-a567-d78a-518a-a384d630d8d4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cc56d95bb29a5f99b8c108015681fa7d 1x" loading="lazy"></a></p></li>
<li><p>変更後<br><br>
<a href="https://camo.qiitausercontent.com/411983ee9df9ab49c9a3df06d61fe6015a8ba1da/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f37633339653263632d356130622d616433322d346132392d3765373039653162376461622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F7c39e2cc-5a0b-ad32-4a29-7e709e1b7dab.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=708d6194851358fcfb7de45dd7a66715" alt="after.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/7c39e2cc-5a0b-ad32-4a29-7e709e1b7dab.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F7c39e2cc-5a0b-ad32-4a29-7e709e1b7dab.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3274bd11816e2f6fbc0f8a4042497355 1x" loading="lazy"></a></p></li>
</ul>

<p>(しょうがないと思っていた)描画の乱れが改善し、なめらかに表示されるようになりました。  </p>

<h1>
<span id="モーションの適用" class="fragment"></span><a href="#%E3%83%A2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E9%81%A9%E7%94%A8"><i class="fa fa-link"></i></a>モーションの適用</h1>

<p>キャラが動いてるところが見たいので、モーションを適用します。<br>
まずはモーションを入手します。<a href="http://www.nicovideo.jp/watch/sm28700654" rel="nofollow noopener" target="_blank">この動画</a>のモーションが気に入ったので、お借りします。<br>
動画説明文のリンクからダウンロードします。解凍パスも動画説明文を参照。<br>
モーションについても好きなモーションがあればそれを使って下さい。<br>
モーションデータを入手したら「プロジェクト名/bin/Debug/Data」を開きその中にモーションデータを入れて下さい。</p>

<p>次に、入れたモーションデータの名前を変更します。名前は「モデル名+000から始まる連番」にします。複数のモーションを入れる場合は以下の画像のように000,001,002,...となります。ループ再生するタイプのモーションについては番号の後にLを付けます。</p>

<p><a href="https://camo.qiitausercontent.com/1bd01fbde04fd1814ab19940bea4ae4296ba01c8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f32643035303737632d363439372d656434302d646132622d3362313132623931336638352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F2d05077c-6497-ed40-da2b-3b112b913f85.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=aec837f7299738058777121f810603c9" alt="18.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/2d05077c-6497-ed40-da2b-3b112b913f85.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F2d05077c-6497-ed40-da2b-3b112b913f85.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9edf103120aa2283f893006b5af05ae7 1x" loading="lazy"></a></p>

<p>これでモーションを適用する準備ができました。<br>
以下のようにプログラムを書き換えて下さい。</p>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Form1.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//usingいろいろ</span>
<span class="k">using</span> <span class="nn">DxLibDLL</span><span class="p">;</span><span class="c1">//DxLibを使用</span>

<span class="k">namespace</span> <span class="nn">DesktopMascot</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Form1</span> <span class="p">:</span> <span class="n">Form</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">modelHandle</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">attachIndex</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">totalTime</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">playTime</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">playSpeed</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span><span class="c1">//フォームの初期設定</span>

            <span class="n">ClientSize</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Size</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span><span class="c1">//画面サイズの設定</span>
            <span class="n">Text</span> <span class="p">=</span> <span class="s">"DesktopMascot"</span><span class="p">;</span><span class="c1">//ウインドウの名前を設定</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetOutApplicationLogValidFlag</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//Log.txtを生成しないように設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetUserWindow</span><span class="p">(</span><span class="n">Handle</span><span class="p">);</span><span class="c1">//DxLibの親ウインドウをこのフォームに設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_Init</span><span class="p">();</span><span class="c1">//DxLibの初期化処理</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetDrawScreen</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">DX_SCREEN_BACK</span><span class="p">);</span><span class="c1">//描画先を裏画面に設定</span>

            <span class="n">modelHandle</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1LoadModel</span><span class="p">(</span><span class="s">"Data/結月ゆかり_純.pmd"</span><span class="p">);</span><span class="c1">//3Dモデルの読み込み</span>
            <span class="n">attachIndex</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1AttachAnim</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//モーションの選択</span>
            <span class="n">totalTime</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1GetAttachAnimTotalTime</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="n">attachIndex</span><span class="p">);</span><span class="c1">//モーションの総再生時間を取得</span>
            <span class="n">playTime</span> <span class="p">=</span> <span class="m">0.0f</span><span class="p">;</span><span class="c1">//モーションの再生位置</span>
            <span class="n">playSpeed</span> <span class="p">=</span> <span class="m">0.2f</span><span class="p">;</span><span class="c1">//モーションの再生位置を進める速度</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraNearFar</span><span class="p">(</span><span class="m">0.1f</span><span class="p">,</span> <span class="m">1000.0f</span><span class="p">);</span><span class="c1">//奥行0.1～1000をカメラの描画範囲とする</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraPositionAndTarget_UpVecY</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">12.0f</span><span class="p">,</span> <span class="m">25.0f</span><span class="p">,</span> <span class="p">-</span><span class="m">35.0f</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">0.0f</span><span class="p">,</span> <span class="m">15.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">));</span><span class="c1">//第1引数の位置から第2引数の位置を見る角度にカメラを設置</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">MainLoop</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">ClearDrawScreen</span><span class="p">();</span><span class="c1">//裏画面を消す</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DrawBox</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span><span class="p">,</span> <span class="n">DX</span><span class="p">.</span><span class="nf">GetColor</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="n">TRUE</span><span class="p">);</span><span class="c1">//背景を設定(透過させる)</span>

            <span class="n">playTime</span> <span class="p">+=</span> <span class="n">playSpeed</span><span class="p">;</span><span class="c1">//時間を進める</span>

            <span class="c1">//モーションの再生位置が終端まで来たら最初に戻す</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">playTime</span> <span class="p">&gt;=</span> <span class="n">totalTime</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">playTime</span> <span class="p">=</span> <span class="m">0.0f</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">MV1SetAttachAnimTime</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="n">attachIndex</span><span class="p">,</span> <span class="n">playTime</span><span class="p">);</span><span class="c1">//モーションの再生位置を設定</span>


            <span class="n">DX</span><span class="p">.</span><span class="nf">MV1DrawModel</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">);</span><span class="c1">//3Dモデルの描画</span>

            <span class="c1">//ESCキーを押したら終了</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">CheckHitKey</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">KEY_INPUT_ESCAPE</span><span class="p">)</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">Close</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">ScreenFlip</span><span class="p">();</span><span class="c1">//裏画面を表画面にコピー</span>
        <span class="p">}</span>

        <span class="c1">//省略</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>MV1AttachAnim関数で適用するモーションを指定します。2つ目の引数で何番目のモーションを使うかを決めます。<br>
モデルを読み込んだ時に「モデル名+000から始まる連番」となっているモーションファイルが自動的に読み込まれています。<br>
今回は000～002まであるので、0,1,2がそれぞれ000,001,002のモーションに対応しています。<br>
上のプログラムでは2番(3つ目のモーション)を選択しています。<br>
MV1AttachAnim関数は選択したモーションの識別番号を返すので、モデルを読み込んだ時と同様に変数に保存します。<br>
MV1SetAttachAnimTime関数でモーションのどの位置の状態を適用するかを決定します。<br>
自動的に再生される訳ではなく、「○秒の状態にする」という関数なので、再生位置(時間)を示す変数を用意し、ループ内で値を増やす事で再生しているように見せています。<br>
また、MV1GetAttachAnimTotalTime関数でモーションの総再生時間を取得し、それを過ぎたら再生位置(時間)をリセットするようにしています。<br>
(このアニメーションの場合、突然上空に移動してしまいますが…)<br>
モーションによりキャラの見え方が変わるので、またカメラの位置を変えて調整しています。<br>
また、PCのスペックなどの差で処理速度が変わるため、playSpeedの値はいい感じに変更して下さい。</p>

<p><a href="https://camo.qiitausercontent.com/5b55339bd09defe4c6bbf9efb74d40d7b7c8f347/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f65343737663864322d616235372d353935382d313964652d3239613563333332323734642e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe477f8d2-ab57-5958-19de-29a5c332274d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c59c279ac905fec9b73464e9f83ed579" alt="19.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/e477f8d2-ab57-5958-19de-29a5c332274d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe477f8d2-ab57-5958-19de-29a5c332274d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=035ce726fccd9f99d65e5da6760da1c4 1x" loading="lazy"></a></p>

<p>…これは事故です。</p>

<p><a href="https://camo.qiitausercontent.com/8c78c2c4c0446ce83be621e9898f4e67d95a4828/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f35656265656236632d313164632d353365382d636465302d3735373031366632656238662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F5ebeeb6c-11dc-53e8-cde0-757016f2eb8f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=05a4c4f203f9e18ec5ffba792ed690fa" alt="20.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/5ebeeb6c-11dc-53e8-cde0-757016f2eb8f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F5ebeeb6c-11dc-53e8-cde0-757016f2eb8f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=619c26872a3b12bba46768ed1e90305d 1x" loading="lazy"></a></p>

<p>いろいろなモーションを試してみると面白いと思います(<br>
<a href="http://www.nicovideo.jp/watch/sm31368233" class="autolink" rel="nofollow noopener" target="_blank">http://www.nicovideo.jp/watch/sm31368233</a></p>

<p><a href="https://camo.qiitausercontent.com/1b7da958854b4bc5fe4088bb660c836871cbcdee/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f66366235636138332d343939662d613333362d313232312d6261393633353339393766382e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff6b5ca83-499f-a336-1221-ba96353997f8.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9819ae7d546215ec6e9170bcb55f519a" alt="29.gif" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/f6b5ca83-499f-a336-1221-ba96353997f8.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff6b5ca83-499f-a336-1221-ba96353997f8.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bb7b03336fcca12120d788de987fe621 1x" loading="lazy"></a></p>

<h1>
<span id="coretweetの導入" class="fragment"></span><a href="#coretweet%E3%81%AE%E5%B0%8E%E5%85%A5"><i class="fa fa-link"></i></a>CoreTweetの導入</h1>

<p>C#でTwitterに画像を投稿するために、CoreTweetというライブラリを導入します。<br>
VisualStudio上で「プロジェクト→NuGetパッケージの管理」を選択します。<br>
NuGetはC#のライブラリを簡単にダウンロード・インストールできる機能です。</p>

<p><a href="https://camo.qiitausercontent.com/f6e01be4c84d2b9805581dae2b255d1afb500ebb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f63333139663330622d633264612d343337312d366433622d3364653239623639666633382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc319f30b-c2da-4371-6d3b-3de29b69ff38.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=c3c1a5f1ecdff1754df54686bbad9134" alt="21.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/c319f30b-c2da-4371-6d3b-3de29b69ff38.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc319f30b-c2da-4371-6d3b-3de29b69ff38.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fa259c07b5f3332c4055fc86deb9b394 1x" loading="lazy"></a></p>

<p>画面が開いたら「参照」を選択し、「CoreTweet」と検索をかけます。<br>
すると、CoreTweetのパッケージが出てくると思うので、インストールします。</p>

<p><a href="https://camo.qiitausercontent.com/55075923d780344a4b00873b46fb7f349876cd1c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f64626130353966312d663039392d303035322d373963362d6161393963373631333134662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdba059f1-f099-0052-79c6-aa99c761314f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a777ff96e2f969279edfe7c584b6b820" alt="22.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/dba059f1-f099-0052-79c6-aa99c761314f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdba059f1-f099-0052-79c6-aa99c761314f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=47ddcf7087823f51ca2cfbf253e29edc 1x" loading="lazy"></a></p>

<h1>
<span id="認証情報の登録" class="fragment"></span><a href="#%E8%AA%8D%E8%A8%BC%E6%83%85%E5%A0%B1%E3%81%AE%E7%99%BB%E9%8C%B2"><i class="fa fa-link"></i></a>認証情報の登録</h1>

<p>Twitterにアプリケーションを登録して画像の投稿などの機能(TwitterAPI)を利用できるようにします。<br>
まず、<a href="https://apps.twitter.com/" rel="nofollow noopener" target="_blank">TwitterApplicationManagement</a>にアクセスします。<br>
その後、自分のアカウントでログインし、「Create New App」を押します。</p>

<p><a href="https://camo.qiitausercontent.com/b713d6521f68fee3f9c92b262a7206013ab31a1f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f61636662643364352d363638392d326233612d376166342d3235653463613131383433352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Facfbd3d5-6689-2b3a-7af4-25e4ca118435.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3acabcf591b9b6868af793fb1bf26096" alt="23.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/acfbd3d5-6689-2b3a-7af4-25e4ca118435.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Facfbd3d5-6689-2b3a-7af4-25e4ca118435.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=80e3f90b1d68800e84c1ee92b10270ad 1x" loading="lazy"></a></p>

<p>登録画面が開いたら、アプリケーションの情報を入力します。</p>

<p><a href="https://camo.qiitausercontent.com/90c4a41de143c1d2ac682ecf8501ba0319cbbdef/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f63306636623066372d653063382d383634642d613363332d3732346331623036393166322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc0f6b0f7-e0c8-864d-a3c3-724c1b0691f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f6ade8df18734b26362137f36e46a9ce" alt="24.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/c0f6b0f7-e0c8-864d-a3c3-724c1b0691f2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc0f6b0f7-e0c8-864d-a3c3-724c1b0691f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=10d9744ff85a7ae1cc440776ad7ad607 1x" loading="lazy"></a></p>

<p>Name、Description、Websiteは必須です。<br>
NameはTweetDeckなどでどこから投稿されたかとして表示されます。なので、見られても大丈夫そうな名前にしておきましょう。<br>
Descriptionは適当にアプリケーションの説明を書きます。<br>
Websiteはアプリに関するサイトを登録するのですが、今回は特にないのでとりあえず自分のTwitterアカウントのURLでも書いておきましょう。<br>
最後に「Developer Agreement」の所にチェックを入れて「Create Your Twitter Application」を考えます。</p>

<p>登録が完了したら、次にアクセストークンを発行します。<br>
(ツイートを許可するためにあらかじめAccess LevelをRead and writeに変更しておいて下さい。「Permissions」から変更できます。)</p>

<p><a href="https://camo.qiitausercontent.com/0c6ef05ed243404f9b7ef09358f41f138cd25704/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f61366337666233392d313730612d313233612d643235632d3638376633626437343866322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fa6c7fb39-170a-123a-d25c-687f3bd748f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1504d5b7784976e1a5581f55bbe066f4" alt="25.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/a6c7fb39-170a-123a-d25c-687f3bd748f2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fa6c7fb39-170a-123a-d25c-687f3bd748f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ba59b1afb707db2275f99b88969ee41b 1x" loading="lazy"></a></p>

<p><a href="https://camo.qiitausercontent.com/a1e018ae17c36f2200c9f1ce471aad0b6a89a9fa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f64636134383032652d333530642d643862322d613563382d6430666539373166306131632e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdca4802e-350d-d8b2-a5c8-d0fe971f0a1c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b0af4f425b95dea8c2a1649b91156d1e" alt="26.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/dca4802e-350d-d8b2-a5c8-d0fe971f0a1c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdca4802e-350d-d8b2-a5c8-d0fe971f0a1c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=85f7f46e357b266717417bead61b4834 1x" loading="lazy"></a></p>

<p>「Keys and Access Tokens」を選択し、下の方の「Create my access token」を押します。<br>
アクセストークンの発行が終了したら、次にプログラム上にこれらの認証情報を入力し、プログラムからTwitterへのツイートや画像投稿ができるようにします。<br>
CoreTweetを使う場合は以下のように記述します。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">//usingいろいろ</span>
<span class="k">using</span> <span class="nn">DxLibDLL</span><span class="p">;</span><span class="c1">//DxLibを使用</span>
<span class="k">using</span> <span class="nn">CoreTweet</span><span class="p">;</span><span class="c1">//CoreTweetを使用</span>

<span class="k">namespace</span> <span class="nn">DesktopMascot</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Form1</span> <span class="p">:</span> <span class="n">Form</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">modelHandle</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">attachIndex</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">totalTime</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">playTime</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">playSpeed</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Tokens</span> <span class="n">tokens</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span><span class="c1">//フォームの初期設定</span>

            <span class="n">ClientSize</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Size</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span><span class="c1">//画面サイズの設定</span>
            <span class="n">Text</span> <span class="p">=</span> <span class="s">"DesktopMascot"</span><span class="p">;</span><span class="c1">//ウインドウの名前を設定</span>

            <span class="n">tokens</span> <span class="p">=</span> <span class="n">Tokens</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"ConsumerKey"</span><span class="p">,</span> <span class="s">"ConsumerSecret"</span><span class="p">,</span> <span class="s">"AccessToken"</span><span class="p">,</span> <span class="s">"AccessSecret"</span><span class="p">);</span><span class="c1">//Twitterアカウントの認証</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetOutApplicationLogValidFlag</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//Log.txtを生成しないように設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetUserWindow</span><span class="p">(</span><span class="n">Handle</span><span class="p">);</span><span class="c1">//DxLibの親ウインドウをこのフォームに設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_Init</span><span class="p">();</span><span class="c1">//DxLibの初期化処理</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetDrawScreen</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">DX_SCREEN_BACK</span><span class="p">);</span><span class="c1">//描画先を裏画面に設定</span>

            <span class="n">modelHandle</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1LoadModel</span><span class="p">(</span><span class="s">"Data/結月ゆかり_純.pmd"</span><span class="p">);</span><span class="c1">//3Dモデルの読み込み</span>
            <span class="n">attachIndex</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1AttachAnim</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//モーションの選択</span>
            <span class="n">totalTime</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1GetAttachAnimTotalTime</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="n">attachIndex</span><span class="p">);</span><span class="c1">//モーションの総再生時間を取得</span>
            <span class="n">playTime</span> <span class="p">=</span> <span class="m">0.0f</span><span class="p">;</span><span class="c1">//モーションの再生位置</span>
            <span class="n">playSpeed</span> <span class="p">=</span> <span class="m">0.2f</span><span class="p">;</span><span class="c1">//モーションの再生位置を進める速度</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraNearFar</span><span class="p">(</span><span class="m">0.1f</span><span class="p">,</span> <span class="m">1000.0f</span><span class="p">);</span><span class="c1">//奥行0.1～1000をカメラの描画範囲とする</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraPositionAndTarget_UpVecY</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">12.0f</span><span class="p">,</span> <span class="m">25.0f</span><span class="p">,</span> <span class="p">-</span><span class="m">35.0f</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">0.0f</span><span class="p">,</span> <span class="m">15.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">));</span><span class="c1">//第1引数の位置から第2引数の位置を見る角度にカメラを設置</span>
        <span class="p">}</span>

        <span class="c1">//省略</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>"ConsumerKey"、"ConsumerSecret"、"AccessToken"、"AccessSecret"にはそれぞれ先ほど登録した時に得られた文字列を入れて下さい。<br>
生成したトークンを用いてプログラムからツイートや画像投稿を行います。</p>

<h1>
<span id="画像の投稿" class="fragment"></span><a href="#%E7%94%BB%E5%83%8F%E3%81%AE%E6%8A%95%E7%A8%BF"><i class="fa fa-link"></i></a>画像の投稿</h1>

<p>実際に画像を投稿できるようにします。プログラムを以下のように書き換えて下さい。</p>

<blockquote>
<p>2018/10/12 追記<br>
プログラムの記述ミスを修正</p>
</blockquote>

<div class="code-frame" data-lang="csharp">
<div class="code-lang"><span class="bold">Form1.cs</span></div>
<div class="highlight"><pre class="with-code"><code><span class="c1">//usingいろいろ</span>
<span class="k">using</span> <span class="nn">DxLibDLL</span><span class="p">;</span><span class="c1">//DxLibを使用</span>
<span class="k">using</span> <span class="nn">CoreTweet</span><span class="p">;</span><span class="c1">//CoreTweetを使用</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span><span class="c1">//FileInfoを使用</span>

<span class="k">namespace</span> <span class="nn">DesktopMascot</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Form1</span> <span class="p">:</span> <span class="n">Form</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">modelHandle</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">attachIndex</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">totalTime</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">playTime</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">float</span> <span class="n">playSpeed</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Tokens</span> <span class="n">tokens</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span><span class="c1">//フォームの初期設定</span>

            <span class="n">ClientSize</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Size</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span><span class="c1">//画面サイズの設定</span>
            <span class="n">Text</span> <span class="p">=</span> <span class="s">"DesktopMascot"</span><span class="p">;</span><span class="c1">//ウインドウの名前を設定</span>
            <span class="n">AllowDrop</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span><span class="c1">//ドラッグ&amp;ドロップを許可</span>

            <span class="n">tokens</span> <span class="p">=</span> <span class="n">Tokens</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"ConsumerKey"</span><span class="p">,</span> <span class="s">"ConsumerSecret"</span><span class="p">,</span> <span class="s">"AccessToken"</span><span class="p">,</span> <span class="s">"AccessSecret"</span><span class="p">);</span><span class="c1">//Twitterアカウント認証</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetOutApplicationLogValidFlag</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//Log.txtを生成しないように設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetUserWindow</span><span class="p">(</span><span class="n">Handle</span><span class="p">);</span><span class="c1">//DxLibの親ウインドウをこのフォームに設定</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_Init</span><span class="p">();</span><span class="c1">//DxLibの初期化処理</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetDrawScreen</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">DX_SCREEN_BACK</span><span class="p">);</span><span class="c1">//描画先を裏画面に設定</span>

            <span class="n">modelHandle</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1LoadModel</span><span class="p">(</span><span class="s">"Data/結月ゆかり_純.pmd"</span><span class="p">);</span><span class="c1">//3Dモデルの読み込み</span>
            <span class="n">attachIndex</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1AttachAnim</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="n">DX</span><span class="p">.</span><span class="n">FALSE</span><span class="p">);</span><span class="c1">//モーションの選択</span>
            <span class="n">totalTime</span> <span class="p">=</span> <span class="n">DX</span><span class="p">.</span><span class="nf">MV1GetAttachAnimTotalTime</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="n">attachIndex</span><span class="p">);</span><span class="c1">//モーションの総再生時間を取得</span>
            <span class="n">playTime</span> <span class="p">=</span> <span class="m">0.0f</span><span class="p">;</span><span class="c1">//モーションの再生位置</span>
            <span class="n">playSpeed</span> <span class="p">=</span> <span class="m">0.2f</span><span class="p">;</span><span class="c1">//モーションの再生位置を進める速度</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraNearFar</span><span class="p">(</span><span class="m">0.1f</span><span class="p">,</span> <span class="m">1000.0f</span><span class="p">);</span><span class="c1">//奥行0.1～1000をカメラの描画範囲とする</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">SetCameraPositionAndTarget_UpVecY</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">12.0f</span><span class="p">,</span> <span class="m">25.0f</span><span class="p">,</span> <span class="p">-</span><span class="m">35.0f</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="nf">VGet</span><span class="p">(</span><span class="m">0.0f</span><span class="p">,</span> <span class="m">15.0f</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">));</span><span class="c1">//第1引数の位置から第2引数の位置を見る角度にカメラを設置</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">MainLoop</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">ClearDrawScreen</span><span class="p">();</span><span class="c1">//裏画面を消す</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DrawBox</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">PrimaryScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span><span class="p">,</span> <span class="n">DX</span><span class="p">.</span><span class="nf">GetColor</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">DX</span><span class="p">.</span><span class="n">TRUE</span><span class="p">);</span><span class="c1">//背景を設定(透過させる)</span>

            <span class="n">playTime</span> <span class="p">+=</span> <span class="n">playSpeed</span><span class="p">;</span><span class="c1">//時間を進める</span>

            <span class="c1">//モーションの再生位置が終端まで来たら最初に戻す</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">playTime</span> <span class="p">&gt;=</span> <span class="n">totalTime</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">playTime</span> <span class="p">=</span> <span class="m">0.0f</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">MV1SetAttachAnimTime</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">,</span> <span class="n">attachIndex</span><span class="p">,</span> <span class="n">playTime</span><span class="p">);</span><span class="c1">//モーションの再生位置を設定</span>


            <span class="n">DX</span><span class="p">.</span><span class="nf">MV1DrawModel</span><span class="p">(</span><span class="n">modelHandle</span><span class="p">);</span><span class="c1">//3Dモデルの描画</span>

            <span class="c1">//ESCキーを押したら終了</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="nf">CheckHitKey</span><span class="p">(</span><span class="n">DX</span><span class="p">.</span><span class="n">KEY_INPUT_ESCAPE</span><span class="p">)</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">Close</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="n">DX</span><span class="p">.</span><span class="nf">ScreenFlip</span><span class="p">();</span><span class="c1">//裏画面を表画面にコピー</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_FormClosed</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FormClosedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">DX</span><span class="p">.</span><span class="nf">DxLib_End</span><span class="p">();</span><span class="c1">//DxLibの終了処理</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_Shown</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">FormBorderStyle</span> <span class="p">=</span> <span class="n">FormBorderStyle</span><span class="p">.</span><span class="n">None</span><span class="p">;</span><span class="c1">//フォームの枠を非表示にする</span>
            <span class="n">TransparencyKey</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span><span class="c1">//透過色を設定</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_DragEnter</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">DragEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//ファイルがドラッグされた場合受け付ける</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="nf">GetDataPresent</span><span class="p">(</span><span class="n">DataFormats</span><span class="p">.</span><span class="n">FileDrop</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="n">Effect</span> <span class="p">=</span> <span class="n">DragDropEffects</span><span class="p">.</span><span class="n">Copy</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="n">Effect</span> <span class="p">=</span> <span class="n">DragDropEffects</span><span class="p">.</span><span class="n">None</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_DragDrop</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">DragEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span><span class="p">[]</span> <span class="n">path</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">[])</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="nf">GetData</span><span class="p">(</span><span class="n">DataFormats</span><span class="p">.</span><span class="n">FileDrop</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span><span class="c1">//ドロップされたファイルのパスを取得(複数可)</span>
            <span class="kt">var</span> <span class="n">ids</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;();</span>

            <span class="c1">//各画像をアップロードしIDを取得</span>
            <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">p</span> <span class="k">in</span> <span class="n">path</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">MediaUploadResult</span> <span class="n">image</span> <span class="p">=</span> <span class="n">tokens</span><span class="p">.</span><span class="n">Media</span><span class="p">.</span><span class="nf">Upload</span><span class="p">(</span><span class="n">media</span><span class="p">:</span> <span class="k">new</span> <span class="nf">FileInfo</span><span class="p">(</span><span class="n">p</span><span class="p">));</span>
                <span class="n">ids</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">MediaId</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">Status</span> <span class="n">s</span> <span class="p">=</span> <span class="n">tokens</span><span class="p">.</span><span class="n">Statuses</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="n">status</span><span class="p">:</span> <span class="s">"upload image"</span><span class="p">,</span> <span class="n">media_ids</span><span class="p">:</span> <span class="n">ids</span><span class="p">);</span><span class="c1">//画像をツイート</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>

<p>AllowDropをtrueにする事でファイルのドラッグ&amp;ドロップを許可しています。<br>
次にForm1.cs[デザイン]から右下のプロパティの中のイベントのDragEnterとDragDropにそれぞれForm1_DragEnter関数とForm1_DragDrop関数を設定します。<br>
これでファイルをドラッグ&amp;ドロップした時に自動でこれらの関数が実行されます。</p>

<p><a href="https://camo.qiitausercontent.com/11bae14607288293558dd10aba0f2e4fc8b96b48/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f32373634316665312d666466342d363537662d366536642d6331383131393166393036622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27641fe1-fdf4-657f-6e6d-c181191f906b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d2a4e2e2050bd2e09b347787dd7c490d" alt="27.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/27641fe1-fdf4-657f-6e6d-c181191f906b.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27641fe1-fdf4-657f-6e6d-c181191f906b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=03155c04567e9387de3dec7e6ebce746 1x" loading="lazy"></a></p>

<p>ファイルがドロップされた場合、ファイルのパスを取得し、そのパスを利用してUpload関数で画像をアップロードし、Update関数で投稿しています。<br>
statusにはツイート文章の文字列を、media_idsにはアップロードした画像ID(MediaIdで取得)の配列をそれぞれ渡します。配列なので、複数枚まとめての投稿にも対応しています。(1ツイート4枚までだったと思います。)</p>

<p>これでキャラクターにドラッグ&amp;ドロップした画像がTwitterに投稿されるようになります。</p>

<p><a href="https://camo.qiitausercontent.com/d5192105d46a034ad2d6b3b70e1b7328bf27aeb3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f65333361383231362d373663622d623135382d336538622d6465633062663265353161332e676966" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe33a8216-76cb-b158-3e8b-dec0bf2e51a3.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a6cdf10528296b0290af151d4acf40ac" alt="28.gif" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/e33a8216-76cb-b158-3e8b-dec0bf2e51a3.gif" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe33a8216-76cb-b158-3e8b-dec0bf2e51a3.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f2f7ab49224b78a57f7076cc5830d1cd 1x" loading="lazy"></a></p>

<p>こんな感じに投稿されます。</p>

<p><a href="https://camo.qiitausercontent.com/97b7448776d1d2e6cd868d75a00fd52d87ecc762/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f38323863366432652d386562342d383134312d316230352d3462333034366364663838662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F828c6d2e-8eb4-8141-1b05-4b3046cdf88f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9ecc5444fca1e1131df5a84fa088568d" alt="24.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/124566/828c6d2e-8eb4-8141-1b05-4b3046cdf88f.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F828c6d2e-8eb4-8141-1b05-4b3046cdf88f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=871a5aa2e51d51bad77c2ad7933c40b7 1x" loading="lazy"></a></p>

<h1>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p>以上、デスクトップマスコットの作り方でした。<br>
ここまで作り方についてあれこれ書いてきたわけですが、実はMMDモデルを用いたデスクトップマスコットは<a href="http://www.nicovideo.jp/watch/sm28925683" rel="nofollow noopener" target="_blank">既に配布されたりしています</a>。<br>
<del>つまりこの記事でやっている事はいわゆる二番煎じ</del></p>

<p>明日の記事はこまつなさん(<a href="https://twitter.com/starealnight" rel="nofollow noopener" target="_blank">@starealnight</a>)の「自作音ゲー紹介・DXライブラリで作る音ゲー」です。<br>
よろしくお願いします。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Fmassoumen%2Fitems%2F2985a0fb30472b97a590&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Fmassoumen%2Fitems%2F2985a0fb30472b97a590&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/massoumen/items/2985a0fb30472b97a590/likers" class="css-1iupg5d">92</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">112</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/2985a0fb30472b97a590/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/massoumen/items/2985a0fb30472b97a590/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/massoumen/items/2985a0fb30472b97a590/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/massoumen/items/2985a0fb30472b97a590/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/massoumen/items/2985a0fb30472b97a590.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-c0d2b73d-8ab6-4408-a4dc-8307bd2ce7d7">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-0120915e-76d6-46b7-92d4-d4f230858b66"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-0120915e-76d6-46b7-92d4-d4f230858b66">{}</script>
      
<div id="LoginModal-react-component-94f9d917-8949-4c2d-8f35-28f2a57d6549"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-94f9d917-8949-4c2d-8f35-28f2a57d6549">{}</script>
      
<div id="StockModal-react-component-e86cc459-0762-4847-af7c-3568b634e88c"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-e86cc459-0762-4847-af7c-3568b634e88c">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;z1F2F6DYx/ccOrJYSvx7Ze7gbHHGOoTeSr5Hu708wMmyXZBB0PP4xyIOl47eDv954NRcnQjXauYB4v5gfWskQg==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003eこの記事は\u003ca href=\"https://adventar.org/calendars/2551\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCCS Advent Calendar 2017\u003c/a\u003eの15日目の記事です。\u003c/p\u003e\n\n\u003cp\u003e昨日の記事：\u003ca href=\"http://chii-botti.hatenadiary.jp/entry/2017/12/14/175542\" rel=\"nofollow noopener\" target=\"_blank\"\u003eなんか旅について記事書きます\u003c/a\u003e by ちー(\u003ca href=\"https://twitter.com/chii_botti\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@chii_botti\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003e(追記)\u003cbr\u003e\n2018/10/12 記述ミスの修正及び記述の追加(Michio029さん、ありがとうございます)\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eまずはこちらをご覧ください。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b121ab73709d24f987eb44ec3d72e0920a599c1b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f63333236343163392d373561302d626634622d636639642d3261343038373530306166382e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/c32641c9-75a0-bf4b-cf9d-2a4087500af8.gif\" alt=\"30.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/c32641c9-75a0-bf4b-cf9d-2a4087500af8.gif\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eデスクトップ上に女神が降臨しています。\u003cbr\u003e\nこの記事では上のスクショのようなデスクトップマスコットを作ります。\u003cbr\u003e\nデスクトップマスコットとは、デスクトップ上にキャラクターが常駐するタイプのソフトウェアです。\u003cbr\u003e\n単純に癒し効果を期待したり、何か便利な機能が搭載されてたりします。\u003c/p\u003e\n\n\u003cp\u003eこの記事では表示させるキャラクターにMMDモデルを利用し、まずモデルの描画・モーションの再生を目指します。\u003cbr\u003e\nその後、ちょっとした機能としてキャラクターに画像をドラッグ\u0026amp;ドロップをする事でTwitterに投稿する機能を実装します。\u003cbr\u003e\n使用するものはこんな感じです。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e名称\u003c/th\u003e\n\u003cth style=\"text-align: center\"\u003e説明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eVisualStudio2017\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003e統合開発環境\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eC#\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eプログラミング言語\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eDXライブラリ\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eゲームライブラリ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003eCoreTweet\u003c/td\u003e\n\u003ctd style=\"text-align: center\"\u003eTwitterAPIライブラリ\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"目次\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%9B%AE%E6%AC%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e目次\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eプロジェクトの作成\u003c/li\u003e\n\u003cli\u003eDXライブラリの導入\u003c/li\u003e\n\u003cli\u003eMMDモデルの描画\u003c/li\u003e\n\u003cli\u003e全画面化・背景の透明化\u003c/li\u003e\n\u003cli\u003eモーションの適用\u003c/li\u003e\n\u003cli\u003eCoreTweetの導入\u003c/li\u003e\n\u003cli\u003e認証情報の登録\u003c/li\u003e\n\u003cli\u003e画像の投稿\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"プロジェクトの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクトの作成\u003c/h1\u003e\n\n\u003cp\u003eVisualStudio2017はインストール済みとします。\u003cbr\u003e\n(インストールしていない場合は\u003ca href=\"http://www.softantenna.com/wp/tips/visual-studio-2017-install/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこのあたり\u003c/a\u003eを参考にしながらインストールして下さい。)\u003c/p\u003e\n\n\u003cp\u003eまずプロジェクトを作成します。\u003cbr\u003e\nC#のWindowsフォームアプリケーション(.NET Framework)を選択します。\u003cbr\u003e\nプロジェクト名と場所はお好みで。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4360816597b812f5c7798b8ea8d1909e6970645a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f37323562333161342d653366662d353939312d663133342d6161323863366565343961302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F725b31a4-e3ff-5991-f134-aa28c6ee49a0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=983d684d0a199891829384c8fc8146fe\" alt=\"1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/725b31a4-e3ff-5991-f134-aa28c6ee49a0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F725b31a4-e3ff-5991-f134-aa28c6ee49a0.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c058a46613c3649d9e1bd9fa0f5ee4c2 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eプロジェクトを作成すると、Form1.cs[デザイン]が開かれていると思います。\u003cbr\u003e\n(開いてない場合はForm1.csから開けます。)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/6e569d21a8e2f2eebc902758105bed3c8efc09c6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f31386564653132662d633866332d373961612d366261362d3836643966633931386266392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F18ede12f-c8f3-79aa-6ba6-86d9fc918bf9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8ddd039c1b7598964f864f8309abd7e1\" alt=\"8.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/18ede12f-c8f3-79aa-6ba6-86d9fc918bf9.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F18ede12f-c8f3-79aa-6ba6-86d9fc918bf9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=96346b45dc8c3d1eb63ed390b3f5df4c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にProgram.csを開きます。\u003cbr\u003e\n開くといろいろ書いてありますが、後半部分にMain関数があると思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/90725977adfa91ff264ae066aa11313ca3563fdd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f36346433613832662d633265632d366539322d313635322d3136303133623939363230642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F64d3a82f-c2ec-6e92-1652-16013b99620d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4051287f3591b3d240b56fc5257592b5\" alt=\"2.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/64d3a82f-c2ec-6e92-1652-16013b99620d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F64d3a82f-c2ec-6e92-1652-16013b99620d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=713fa77a362359d2eac11e4d6097a404 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次に「Form1.cs→Form1.Designer.cs→Form1→Form1()」より、Form1.csを開きます。\u003cbr\u003e\n(少し分かりにくいと思うので注意。)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/cce72595710e0ba4764a865fb16e6f95b13097f3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f34313661313133312d393263352d346530302d646537382d6462353562363561666566622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F416a1131-92c5-4e00-de78-db55b65afefb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4b1f56663f4cac663f512485d73d2528\" alt=\"3.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/416a1131-92c5-4e00-de78-db55b65afefb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F416a1131-92c5-4e00-de78-db55b65afefb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e421ee0c7f08a30cd7c5eae0e9d81616 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/102e04cafde929975ce4e03b68478a7595d3c499/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f66393837613465632d396666322d616330352d666362612d6666363339353138356265322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff987a4ec-9ff2-ac05-fcba-ff6395185be2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=dbd54226ee1436dcd9cec68300075642\" alt=\"4.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/f987a4ec-9ff2-ac05-fcba-ff6395185be2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff987a4ec-9ff2-ac05-fcba-ff6395185be2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0ba31ce4f428c1eea620f33cbcafd0d1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれらを中心に編集してデスクトップマスコットを作成します。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"dxライブラリの導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#dx%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eDXライブラリの導入\u003c/h1\u003e\n\n\u003cp\u003eMMDモデルの描画などにDXライブラリというゲームライブラリの関数を使用するので、これを導入します。\u003cbr\u003e\nDXライブラリを使った事がある人は分かると思いますが、DXライブラリはC/C++用のゲームライブラリで、C#を使う場合は少し勝手が異なります。注意して下さい。\u003cbr\u003e\nまず、\u003ca href=\"http://dxlib.o.oo7.jp/dxdload.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式サイトのダウンロードページ\u003c/a\u003eからVisualC#用パッケージをダウンロードします。ダウンロードしたらそれを解凍します。\u003cbr\u003e\n次に、先ほど作成したC#プロジェクトのフォルダの中で、実行ファイル(.exe)が作成されるフォルダ(基本的には「プロジェクト名/bin/Debug」か「プロジェクト名/bin/Release」)にDxLib.dll、DxLib_x64.dll、DxLibDotNet.dllをコピーします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/4c07de528e3d6564e173b60a002914e43da3651e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f32376335303830622d613961662d336639652d373832642d3739643431316362386161662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27c5080b-a9af-3f9e-782d-79d411cb8aaf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=73ac3665a402ab2ca2d877d61652a134\" alt=\"5.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/27c5080b-a9af-3f9e-782d-79d411cb8aaf.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27c5080b-a9af-3f9e-782d-79d411cb8aaf.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3c878eedf9c6a0ffc3cd449624a2f3ef 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次にVisualStudio上で「プロジェクト→参照の追加」を選択します。\u003cbr\u003e\n参照マネージャが開くと思うので、それの参照タブを選び、右下の参照からコピーしたDxLibDotNet.dllを選択します。\u003cbr\u003e\n選択したらOKを押して閉じます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a50d8adeb8afee7fa4a77276384690078776daa6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f66666235366465352d313633332d323966622d643139322d3365333333386430373163312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fffb56de5-1633-29fb-d192-3e3338d071c1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1844a8ced322579bf45e363bb50b14a3\" alt=\"6.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/ffb56de5-1633-29fb-d192-3e3338d071c1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fffb56de5-1633-29fb-d192-3e3338d071c1.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cf62fab7081d0753a6bc6282e02a885e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d81212d75fbfc575c31f73110056ab7b1e09abd8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f30366566316639612d303033362d306666302d653439362d3033663335653337396461362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F06ef1f9a-0036-0ff0-e496-03f35e379da6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b98c73d045228f2153fd8047ad34ada8\" alt=\"7.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/06ef1f9a-0036-0ff0-e496-03f35e379da6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F06ef1f9a-0036-0ff0-e496-03f35e379da6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c0e8721244d88234286b0018193d66d5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e設定を終えたので、プログラムを書きます。\u003cbr\u003e\nForm1.csとProgram.csをそれぞれ以下のように書き換えて下さい。\u003cbr\u003e\n(スペースの都合上、一部の記述を省略したりします。)\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eForm1.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//usingいろいろ\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDxLibDLL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibを使用\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDesktopMascot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eForm1\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eForm\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//必要な変数\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの初期設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetOutApplicationLogValidFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Log.txtを生成しないように設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetUserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの親ウインドウをこのフォームに設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_Init\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの初期化処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDX_SCREEN_BACK\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//描画先を裏画面に設定\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//画像の読み込み等\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を消す\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//毎フレーム呼ぶ処理\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eScreenFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を表画面にコピー\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_FormClosed\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eFormClosedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_End\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの終了処理\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eProgram.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//usingいろいろ\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDesktopMascot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eProgram\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eSTAThread\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEnableVisualStyles\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCompatibleTextRenderingDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eForm1\u003c/span\u003e \u003cspan class=\"n\"\u003eform\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eShow\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//Application.Runではなく自分でループを作成\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCreated\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMainLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDoEvents\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eDXライブラリの関数を使用する場合は「using DxLibDLL;」と書きます。\u003cbr\u003e\nまた、関数やマクロの頭に「DX.」が付きます。C#の場合一部使えない関数があるそうですが、基本的な使い方はC/C++の場合と同じです。\u003cbr\u003e\nこの記事ではDXライブラリの細かい使い方や説明については省かせてもらいます。\u003cbr\u003e\n(MMDモデルの描画など話のメインとなる部分についてはできるだけちゃんと書きます。)\u003cbr\u003e\n関数の詳細などについては\u003ca href=\"http://dxlib.o.oo7.jp/dxfunc.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式サイトの関数リファレンス\u003c/a\u003eを参照して下さい。\u003c/p\u003e\n\n\u003cp\u003e今回はSetUserWindow関数でDXライブラリの描画先をフォームアプリケーションに設定します。\u003cbr\u003e\nこうする事でDXライブラリとフォームアプリケーションの両方の機能を利用できます。\u003cbr\u003e\n(参考：\u003ca href=\"https://qiita.com/hart_edsf/items/0301f17e2d9acd890c5e\"\u003eC#でDxLibを使う\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eまた、ウインドウ(フォーム)が閉じられた時にDXライブラリの終了処理(DxLib_End関数)を実行するために、イベントを設定します。\u003cbr\u003e\nForm1.cs[デザイン]を開き、右下のプロパティの中のイベント(雷マーク)を選択し、FormClosedという項目にForm1_FormClosed関数を設定します。\u003cbr\u003e\nこうする事でフォームが閉じられた時にForm1_FormClosed関数が自動で実行されます。この関数ではDxLib_End関数が実行されるようにしているので、フォームが閉じられた時に自動でDXライブラリの終了処理が実行されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/01f500186e4bf1e89e8885adf01cf2da66a4396e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f31396430663738352d613331622d643537342d343365372d3330643265663330373939302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F19d0f785-a31b-d574-43e7-30d2ef307990.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=644d1edd87be738cd234e7eb2193227e\" alt=\"12.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/19d0f785-a31b-d574-43e7-30d2ef307990.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F19d0f785-a31b-d574-43e7-30d2ef307990.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=22dfa64ca45acca936694bc5c5bbdb27 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこの状態で実行すると、以下のような黒い画面が出ると思います。\u003cbr\u003e\n出たらDXライブラリの導入は成功です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1ae7f3504672d5df6cbef237e7dd218be49e39fb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f33633464373937332d623030352d633431322d393132612d3461316239303563353336662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3c4d7973-b005-c412-912a-4a1b905c536f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=56b9f8dc2b5cd36cb5e6ed18a0cd5fb1\" alt=\"9.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/3c4d7973-b005-c412-912a-4a1b905c536f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3c4d7973-b005-c412-912a-4a1b905c536f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=299975f643a06294a6b87b955e6b9f88 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"mmdモデルの描画\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mmd%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E6%8F%8F%E7%94%BB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMMDモデルの描画\u003c/h1\u003e\n\n\u003cp\u003eまず描画するMMDモデルを用意します。\u003cbr\u003e\nこの記事では\u003ca href=\"http://www.vocalomakets.com/mmd.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eここ\u003c/a\u003eから結月ゆかりのMMDモデルをダウンロードして使用します。\u003cbr\u003e\nなぜ結月ゆかりを選んだかというと、単に結月ゆかりの事が好きすぎてたまらないからです。\u003cbr\u003e\nみなさんは好きなキャラのMMDモデルを用意して下さい。\u003cbr\u003e\nただし、pmx形式のモデルの場合上手く描画できないケースがあるので注意して下さい。\u003cbr\u003e\n読み込める3Dモデルの形式については\u003ca href=\"http://dxlib.o.oo7.jp/function/dxfunc_3d.html#R1N1\" rel=\"nofollow noopener\" target=\"_blank\"\u003e関数リファレンス\u003c/a\u003eを参照。\u003c/p\u003e\n\n\u003cp\u003eMMDモデルをダウンロード(+解凍)したら、「プロジェクト名/bin/Debug」を開き、MMDモデルなどを保存するDataフォルダを作ります。\u003cbr\u003e\n(単に分かりやすくしたいだけなので、しなくても良いです。)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/3b1e91b411c6489567d1c57b9064a598d73dae35/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f33656334646562372d646164332d643437362d343339642d3666623535316564646564612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3ec4deb7-dad3-d476-439d-6fb551eddeda.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=060141299aa351d571f39399dc901276\" alt=\"10.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/3ec4deb7-dad3-d476-439d-6fb551eddeda.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F3ec4deb7-dad3-d476-439d-6fb551eddeda.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d432991aa289e831af2937f34662bb4c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e作ったらその中にMMDモデルのデータとテクスチャを入れます。\u003cbr\u003e\nMMDモデルのファイル名は後で使用するので、必要なら分かりやすく書き換えておいて下さい。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/30d543616e71e508bfa9c67e42a0767a17453a68/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f38616664333633382d386339652d646532622d666432342d3436343365353562313235662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F8afd3638-8c9e-de2b-fd24-4643e55b125f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3756b2b66d7d98457b126f5472e35d99\" alt=\"11.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/8afd3638-8c9e-de2b-fd24-4643e55b125f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F8afd3638-8c9e-de2b-fd24-4643e55b125f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=30cce474e04bf5bf8893acdc4a0779d9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eMMDモデルを描画する準備ができたので、実際に描画します。\u003cbr\u003e\nプログラムを以下のように書き換えて下さい。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eForm1.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//usingいろいろ\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDesktopMascot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eForm1\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eForm\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの初期設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetOutApplicationLogValidFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Log.txtを生成しないように設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetUserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの親ウインドウをこのフォームに設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_Init\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの初期化処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDX_SCREEN_BACK\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//描画先を裏画面に設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1LoadModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Data/結月ゆかり_純.pmd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの読み込み\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraNearFar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.1f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//奥行0.1～1000をカメラの描画範囲とする\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraPositionAndTarget_UpVecY\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e10.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e20.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e10.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"c1\"\u003e//第1引数の位置から第2引数の位置を見る角度にカメラを設置\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を消す\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1DrawModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの描画\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eScreenFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を表画面にコピー\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_FormClosed\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eFormClosedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_End\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの終了処理\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eMV1LoadModel関数でモデルを読み込みます。引数には読み込みたいモデルのパスを指定します。\u003cbr\u003e\nこの関数は読み込んだモデルの識別番号(モデルハンドル)を返すのでそれを変数に保存しておきます。\u003cbr\u003e\nその後、ループ内でMV1DrawModel関数を実行する事で3Dモデルを描画します。引数には描画したいモデルのモデルハンドルを指定します。先ほど保存したモデルハンドルを与える事で読み込んだモデルを描画できます。\u003c/p\u003e\n\n\u003cp\u003eSetCameraNearFar関数はカメラのどの距離からどの距離まで描画するかを決定する関数です。\u003cbr\u003e\nSetCameraPositionAndTarget_UpVecY関数はカメラの位置を設定する関数です。第1引数の位置から第2引数の位置を見る向きにカメラを設定します。VGetは3次元ベクトル(x,y,z)を表します。\u003cbr\u003e\nカメラに関しては都合の良い感じに値を調整すればokです。\u003c/p\u003e\n\n\u003cp\u003e以下のようにMMDモデルが表示されたら成功です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d55dde7a06fbe61a4df34ca9dbcb2e852feb060b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f62643163396438612d336434612d396531632d373135652d6136623030623734303037332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fbd1c9d8a-3d4a-9e1c-715e-a6b00b740073.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=872dc4f2fa94c2da7f9d63a9f9dcc96b\" alt=\"13.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/bd1c9d8a-3d4a-9e1c-715e-a6b00b740073.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fbd1c9d8a-3d4a-9e1c-715e-a6b00b740073.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=243cb6fea776cb13807b9e0c0ab82398 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"全画面化背景の透明化\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%A8%E7%94%BB%E9%9D%A2%E5%8C%96%E8%83%8C%E6%99%AF%E3%81%AE%E9%80%8F%E6%98%8E%E5%8C%96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e全画面化・背景の透明化\u003c/h1\u003e\n\n\u003cp\u003eこのままだと、この狭いウインドウ内でしかキャラクターが描画されないのと、背景が邪魔です。なので、ウインドウの範囲をディスプレイ全体にし、背景を透明にします。\u003c/p\u003e\n\n\u003cp\u003eまずプログラムを以下のように書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eForm1.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//usingいろいろ\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDxLibDLL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibを使用\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDesktopMascot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eForm1\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eForm\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの初期設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eClientSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//画面サイズの設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"DesktopMascot\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ウインドウの名前を設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetOutApplicationLogValidFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Log.txtを生成しないように設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetUserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの親ウインドウをこのフォームに設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_Init\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの初期化処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDX_SCREEN_BACK\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//描画先を裏画面に設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1LoadModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Data/結月ゆかり_純.pmd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの読み込み\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraNearFar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.1f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//奥行0.1～1000をカメラの描画範囲とする\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraPositionAndTarget_UpVecY\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e10.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e30.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e10.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"c1\"\u003e//第1引数の位置から第2引数の位置を見る角度にカメラを設置\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を消す\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDrawBox\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetColor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTRUE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//背景を設定(透過させる)\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1DrawModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの描画\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//ESCキーを押したら終了\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCheckHitKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKEY_INPUT_ESCAPE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eScreenFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を表画面にコピー\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_FormClosed\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eFormClosedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_End\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの終了処理\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_Shown\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFormBorderStyle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eFormBorderStyle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの枠を非表示にする\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eTransparencyKey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromArgb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//透過色を設定\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e次にForm1.cs[デザイン]を開き、右下のプロパティの中のイベントのFormShownにForm1_Shown関数を設定します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f96bb61a4b5fb35958feafb1a9d1bd2d309b4381/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f30626235363733312d623265372d363939392d303862632d3232303762623538346532332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F0bb56731-b2e7-6999-08bc-2207bb584e23.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=63ff900aa8d1fe9712f89fc1c2995201\" alt=\"17.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/0bb56731-b2e7-6999-08bc-2207bb584e23.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F0bb56731-b2e7-6999-08bc-2207bb584e23.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d2111a770d57628fac776cd53564a8fe 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eScreen.PrimaryScreen.Bounds.WidthとScreen.PrimaryScreen.Bounds.Heightでディスプレイの幅と高さを取得できるので、それをClientSizeに設定する事でウインドウの範囲がディスプレイ全体になります。\u003c/p\u003e\n\n\u003cp\u003eまた、モデルを描画する前にDrawBox関数でウインドウ全体にTransparencyKeyで設定した透過色を描画します。こうする事で背景が透明になり、モデルだけが表示されます。\u003cbr\u003e\n(透過色には表示するモデルに使われてなさそうな色を設定して下さい。)\u003c/p\u003e\n\n\u003cp\u003eまた、フォームの枠を非表示にしたため、右上のバツ印が消えてしまっています。\u003cbr\u003e\nなので、ESCキーを押したら終了するようにしておきます。(Close関数はフォームを閉じる関数です。)\u003c/p\u003e\n\n\u003cp\u003eウインドウの大きさを変えたため、表示されるモデルの大きさも変わります。\u003cbr\u003e\nなので、カメラの位置を調整しています。\u003c/p\u003e\n\n\u003cp\u003e以下のように背景が透明になったら成功です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/dfad847e205d40a27ee33832286d88e389635dfb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f34653033656563382d623939362d313639332d346561622d3336346439323665633164342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F4e03eec8-b996-1693-4eab-364d926ec1d4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1fb9c035fb47c47bdb1cc251ab690785\" alt=\"14.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/4e03eec8-b996-1693-4eab-364d926ec1d4.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F4e03eec8-b996-1693-4eab-364d926ec1d4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=950a9d11f4a91c845126b27046cf9a39 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e…カメラの位置を弄ってたら事故りました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b4e44728bd16f2ca14fd12a87740df651469fc96/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f39356331336537642d373230302d643334362d653163632d6135316637316365653736332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F95c13e7d-7200-d346-e1cc-a51f71cee763.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=94e072df44f87ba18746198cad8ff733\" alt=\"15.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/95c13e7d-7200-d346-e1cc-a51f71cee763.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F95c13e7d-7200-d346-e1cc-a51f71cee763.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cb5929d8150fd781e88591679f16c57b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e2018/10/12 追記\u003cbr\u003e\u003cbr\u003e\nコンストラクタ(public Form1())内のDXLib_Init()の直前に記述を追加し、以下のようにする事でモデルをより綺麗に描画する事ができるようです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetOutApplicationLogValidFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Log.txtを生成しないように設定\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetUserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの親ウインドウをこのフォームに設定\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetZBufferBitDepth\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e24\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Zバッファの深度を24bitに変更\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCreateDrawValidGraphZBufferBitDepth\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e24\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面のZバッファの深度を24bitに変更\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetFullSceneAntiAliasingMode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//画面のフルスクリーンアンチエイリアスモードの設定をする\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_Init\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの初期化処理\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDX_SCREEN_BACK\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//描画先を裏画面に設定\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e用いるモデルによりどの程度綺麗になるかは変わると思われますが、今回使用しているモデルの適用前と適用後は以下のようになりました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e変更前\u003cbr\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/e69d4625c5721e1996de592cf1906c5b1cdf265a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f35396134613731392d613536372d643738612d353138612d6133383464363330643864342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F59a4a719-a567-d78a-518a-a384d630d8d4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=441ce7bc19cf99470ecbaf14edf50a4e\" alt=\"before.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/59a4a719-a567-d78a-518a-a384d630d8d4.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F59a4a719-a567-d78a-518a-a384d630d8d4.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cc56d95bb29a5f99b8c108015681fa7d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e変更後\u003cbr\u003e\u003cbr\u003e\n\u003ca href=\"https://camo.qiitausercontent.com/411983ee9df9ab49c9a3df06d61fe6015a8ba1da/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f37633339653263632d356130622d616433322d346132392d3765373039653162376461622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F7c39e2cc-5a0b-ad32-4a29-7e709e1b7dab.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=708d6194851358fcfb7de45dd7a66715\" alt=\"after.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/7c39e2cc-5a0b-ad32-4a29-7e709e1b7dab.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F7c39e2cc-5a0b-ad32-4a29-7e709e1b7dab.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3274bd11816e2f6fbc0f8a4042497355 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(しょうがないと思っていた)描画の乱れが改善し、なめらかに表示されるようになりました。  \u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"モーションの適用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E9%81%A9%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eモーションの適用\u003c/h1\u003e\n\n\u003cp\u003eキャラが動いてるところが見たいので、モーションを適用します。\u003cbr\u003e\nまずはモーションを入手します。\u003ca href=\"http://www.nicovideo.jp/watch/sm28700654\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこの動画\u003c/a\u003eのモーションが気に入ったので、お借りします。\u003cbr\u003e\n動画説明文のリンクからダウンロードします。解凍パスも動画説明文を参照。\u003cbr\u003e\nモーションについても好きなモーションがあればそれを使って下さい。\u003cbr\u003e\nモーションデータを入手したら「プロジェクト名/bin/Debug/Data」を開きその中にモーションデータを入れて下さい。\u003c/p\u003e\n\n\u003cp\u003e次に、入れたモーションデータの名前を変更します。名前は「モデル名+000から始まる連番」にします。複数のモーションを入れる場合は以下の画像のように000,001,002,...となります。ループ再生するタイプのモーションについては番号の後にLを付けます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1bd01fbde04fd1814ab19940bea4ae4296ba01c8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f32643035303737632d363439372d656434302d646132622d3362313132623931336638352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F2d05077c-6497-ed40-da2b-3b112b913f85.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=aec837f7299738058777121f810603c9\" alt=\"18.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/2d05077c-6497-ed40-da2b-3b112b913f85.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F2d05077c-6497-ed40-da2b-3b112b913f85.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9edf103120aa2283f893006b5af05ae7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこれでモーションを適用する準備ができました。\u003cbr\u003e\n以下のようにプログラムを書き換えて下さい。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eForm1.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//usingいろいろ\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDxLibDLL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibを使用\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDesktopMascot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eForm1\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eForm\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの初期設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eClientSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//画面サイズの設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"DesktopMascot\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ウインドウの名前を設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetOutApplicationLogValidFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Log.txtを生成しないように設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetUserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの親ウインドウをこのフォームに設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_Init\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの初期化処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDX_SCREEN_BACK\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//描画先を裏画面に設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1LoadModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Data/結月ゆかり_純.pmd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの読み込み\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1AttachAnim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの選択\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1GetAttachAnimTotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの総再生時間を取得\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.2f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置を進める速度\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraNearFar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.1f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//奥行0.1～1000をカメラの描画範囲とする\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraPositionAndTarget_UpVecY\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e12.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e25.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e35.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e15.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"c1\"\u003e//第1引数の位置から第2引数の位置を見る角度にカメラを設置\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を消す\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDrawBox\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetColor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTRUE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//背景を設定(透過させる)\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//時間を進める\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//モーションの再生位置が終端まで来たら最初に戻す\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1SetAttachAnimTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置を設定\u003c/span\u003e\n\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1DrawModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの描画\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//ESCキーを押したら終了\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCheckHitKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKEY_INPUT_ESCAPE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eScreenFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を表画面にコピー\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//省略\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eMV1AttachAnim関数で適用するモーションを指定します。2つ目の引数で何番目のモーションを使うかを決めます。\u003cbr\u003e\nモデルを読み込んだ時に「モデル名+000から始まる連番」となっているモーションファイルが自動的に読み込まれています。\u003cbr\u003e\n今回は000～002まであるので、0,1,2がそれぞれ000,001,002のモーションに対応しています。\u003cbr\u003e\n上のプログラムでは2番(3つ目のモーション)を選択しています。\u003cbr\u003e\nMV1AttachAnim関数は選択したモーションの識別番号を返すので、モデルを読み込んだ時と同様に変数に保存します。\u003cbr\u003e\nMV1SetAttachAnimTime関数でモーションのどの位置の状態を適用するかを決定します。\u003cbr\u003e\n自動的に再生される訳ではなく、「○秒の状態にする」という関数なので、再生位置(時間)を示す変数を用意し、ループ内で値を増やす事で再生しているように見せています。\u003cbr\u003e\nまた、MV1GetAttachAnimTotalTime関数でモーションの総再生時間を取得し、それを過ぎたら再生位置(時間)をリセットするようにしています。\u003cbr\u003e\n(このアニメーションの場合、突然上空に移動してしまいますが…)\u003cbr\u003e\nモーションによりキャラの見え方が変わるので、またカメラの位置を変えて調整しています。\u003cbr\u003e\nまた、PCのスペックなどの差で処理速度が変わるため、playSpeedの値はいい感じに変更して下さい。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/5b55339bd09defe4c6bbf9efb74d40d7b7c8f347/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f65343737663864322d616235372d353935382d313964652d3239613563333332323734642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe477f8d2-ab57-5958-19de-29a5c332274d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c59c279ac905fec9b73464e9f83ed579\" alt=\"19.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/e477f8d2-ab57-5958-19de-29a5c332274d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe477f8d2-ab57-5958-19de-29a5c332274d.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=035ce726fccd9f99d65e5da6760da1c4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e…これは事故です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/8c78c2c4c0446ce83be621e9898f4e67d95a4828/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f35656265656236632d313164632d353365382d636465302d3735373031366632656238662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F5ebeeb6c-11dc-53e8-cde0-757016f2eb8f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=05a4c4f203f9e18ec5ffba792ed690fa\" alt=\"20.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/5ebeeb6c-11dc-53e8-cde0-757016f2eb8f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F5ebeeb6c-11dc-53e8-cde0-757016f2eb8f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=619c26872a3b12bba46768ed1e90305d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eいろいろなモーションを試してみると面白いと思います(\u003cbr\u003e\n\u003ca href=\"http://www.nicovideo.jp/watch/sm31368233\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://www.nicovideo.jp/watch/sm31368233\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1b7da958854b4bc5fe4088bb660c836871cbcdee/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f66366235636138332d343939662d613333362d313232312d6261393633353339393766382e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff6b5ca83-499f-a336-1221-ba96353997f8.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9819ae7d546215ec6e9170bcb55f519a\" alt=\"29.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/f6b5ca83-499f-a336-1221-ba96353997f8.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Ff6b5ca83-499f-a336-1221-ba96353997f8.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=bb7b03336fcca12120d788de987fe621 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"coretweetの導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coretweet%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoreTweetの導入\u003c/h1\u003e\n\n\u003cp\u003eC#でTwitterに画像を投稿するために、CoreTweetというライブラリを導入します。\u003cbr\u003e\nVisualStudio上で「プロジェクト→NuGetパッケージの管理」を選択します。\u003cbr\u003e\nNuGetはC#のライブラリを簡単にダウンロード・インストールできる機能です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/f6e01be4c84d2b9805581dae2b255d1afb500ebb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f63333139663330622d633264612d343337312d366433622d3364653239623639666633382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc319f30b-c2da-4371-6d3b-3de29b69ff38.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c3c1a5f1ecdff1754df54686bbad9134\" alt=\"21.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/c319f30b-c2da-4371-6d3b-3de29b69ff38.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc319f30b-c2da-4371-6d3b-3de29b69ff38.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fa259c07b5f3332c4055fc86deb9b394 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e画面が開いたら「参照」を選択し、「CoreTweet」と検索をかけます。\u003cbr\u003e\nすると、CoreTweetのパッケージが出てくると思うので、インストールします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/55075923d780344a4b00873b46fb7f349876cd1c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f64626130353966312d663039392d303035322d373963362d6161393963373631333134662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdba059f1-f099-0052-79c6-aa99c761314f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a777ff96e2f969279edfe7c584b6b820\" alt=\"22.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/dba059f1-f099-0052-79c6-aa99c761314f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdba059f1-f099-0052-79c6-aa99c761314f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=47ddcf7087823f51ca2cfbf253e29edc 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"認証情報の登録\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%AA%8D%E8%A8%BC%E6%83%85%E5%A0%B1%E3%81%AE%E7%99%BB%E9%8C%B2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e認証情報の登録\u003c/h1\u003e\n\n\u003cp\u003eTwitterにアプリケーションを登録して画像の投稿などの機能(TwitterAPI)を利用できるようにします。\u003cbr\u003e\nまず、\u003ca href=\"https://apps.twitter.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTwitterApplicationManagement\u003c/a\u003eにアクセスします。\u003cbr\u003e\nその後、自分のアカウントでログインし、「Create New App」を押します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/b713d6521f68fee3f9c92b262a7206013ab31a1f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f61636662643364352d363638392d326233612d376166342d3235653463613131383433352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Facfbd3d5-6689-2b3a-7af4-25e4ca118435.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3acabcf591b9b6868af793fb1bf26096\" alt=\"23.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/acfbd3d5-6689-2b3a-7af4-25e4ca118435.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Facfbd3d5-6689-2b3a-7af4-25e4ca118435.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=80e3f90b1d68800e84c1ee92b10270ad 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e登録画面が開いたら、アプリケーションの情報を入力します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/90c4a41de143c1d2ac682ecf8501ba0319cbbdef/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f63306636623066372d653063382d383634642d613363332d3732346331623036393166322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc0f6b0f7-e0c8-864d-a3c3-724c1b0691f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=f6ade8df18734b26362137f36e46a9ce\" alt=\"24.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/c0f6b0f7-e0c8-864d-a3c3-724c1b0691f2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fc0f6b0f7-e0c8-864d-a3c3-724c1b0691f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=10d9744ff85a7ae1cc440776ad7ad607 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eName、Description、Websiteは必須です。\u003cbr\u003e\nNameはTweetDeckなどでどこから投稿されたかとして表示されます。なので、見られても大丈夫そうな名前にしておきましょう。\u003cbr\u003e\nDescriptionは適当にアプリケーションの説明を書きます。\u003cbr\u003e\nWebsiteはアプリに関するサイトを登録するのですが、今回は特にないのでとりあえず自分のTwitterアカウントのURLでも書いておきましょう。\u003cbr\u003e\n最後に「Developer Agreement」の所にチェックを入れて「Create Your Twitter Application」を考えます。\u003c/p\u003e\n\n\u003cp\u003e登録が完了したら、次にアクセストークンを発行します。\u003cbr\u003e\n(ツイートを許可するためにあらかじめAccess LevelをRead and writeに変更しておいて下さい。「Permissions」から変更できます。)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/0c6ef05ed243404f9b7ef09358f41f138cd25704/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f61366337666233392d313730612d313233612d643235632d3638376633626437343866322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fa6c7fb39-170a-123a-d25c-687f3bd748f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=1504d5b7784976e1a5581f55bbe066f4\" alt=\"25.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/a6c7fb39-170a-123a-d25c-687f3bd748f2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fa6c7fb39-170a-123a-d25c-687f3bd748f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ba59b1afb707db2275f99b88969ee41b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/a1e018ae17c36f2200c9f1ce471aad0b6a89a9fa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f64636134383032652d333530642d643862322d613563382d6430666539373166306131632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdca4802e-350d-d8b2-a5c8-d0fe971f0a1c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b0af4f425b95dea8c2a1649b91156d1e\" alt=\"26.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/dca4802e-350d-d8b2-a5c8-d0fe971f0a1c.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fdca4802e-350d-d8b2-a5c8-d0fe971f0a1c.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=85f7f46e357b266717417bead61b4834 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「Keys and Access Tokens」を選択し、下の方の「Create my access token」を押します。\u003cbr\u003e\nアクセストークンの発行が終了したら、次にプログラム上にこれらの認証情報を入力し、プログラムからTwitterへのツイートや画像投稿ができるようにします。\u003cbr\u003e\nCoreTweetを使う場合は以下のように記述します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//usingいろいろ\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDxLibDLL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibを使用\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eCoreTweet\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//CoreTweetを使用\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDesktopMascot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eForm1\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eForm\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eTokens\u003c/span\u003e \u003cspan class=\"n\"\u003etokens\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの初期設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eClientSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//画面サイズの設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"DesktopMascot\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ウインドウの名前を設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003etokens\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTokens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ConsumerKey\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ConsumerSecret\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"AccessToken\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"AccessSecret\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Twitterアカウントの認証\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetOutApplicationLogValidFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Log.txtを生成しないように設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetUserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの親ウインドウをこのフォームに設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_Init\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの初期化処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDX_SCREEN_BACK\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//描画先を裏画面に設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1LoadModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Data/結月ゆかり_純.pmd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの読み込み\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1AttachAnim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの選択\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1GetAttachAnimTotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの総再生時間を取得\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.2f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置を進める速度\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraNearFar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.1f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//奥行0.1～1000をカメラの描画範囲とする\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraPositionAndTarget_UpVecY\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e12.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e25.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e35.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e15.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"c1\"\u003e//第1引数の位置から第2引数の位置を見る角度にカメラを設置\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e//省略\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\"ConsumerKey\"、\"ConsumerSecret\"、\"AccessToken\"、\"AccessSecret\"にはそれぞれ先ほど登録した時に得られた文字列を入れて下さい。\u003cbr\u003e\n生成したトークンを用いてプログラムからツイートや画像投稿を行います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"画像の投稿\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%94%BB%E5%83%8F%E3%81%AE%E6%8A%95%E7%A8%BF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e画像の投稿\u003c/h1\u003e\n\n\u003cp\u003e実際に画像を投稿できるようにします。プログラムを以下のように書き換えて下さい。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e2018/10/12 追記\u003cbr\u003e\nプログラムの記述ミスを修正\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eForm1.cs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e//usingいろいろ\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eDxLibDLL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibを使用\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eCoreTweet\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//CoreTweetを使用\u003c/span\u003e\n\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"nn\"\u003eSystem.IO\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//FileInfoを使用\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nn\"\u003eDesktopMascot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003epartial\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eForm1\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eForm\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"n\"\u003eTokens\u003c/span\u003e \u003cspan class=\"n\"\u003etokens\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nf\"\u003eInitializeComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの初期設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eClientSize\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//画面サイズの設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eText\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"DesktopMascot\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ウインドウの名前を設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eAllowDrop\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ドラッグ\u0026amp;ドロップを許可\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003etokens\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTokens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ConsumerKey\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"ConsumerSecret\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"AccessToken\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"AccessSecret\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Twitterアカウント認証\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetOutApplicationLogValidFlag\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Log.txtを生成しないように設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetUserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの親ウインドウをこのフォームに設定\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_Init\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの初期化処理\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDX_SCREEN_BACK\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//描画先を裏画面に設定\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1LoadModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Data/結月ゆかり_純.pmd\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの読み込み\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1AttachAnim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFALSE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの選択\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1GetAttachAnimTotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの総再生時間を取得\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.2f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置を進める速度\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraNearFar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.1f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1000.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//奥行0.1～1000をカメラの描画範囲とする\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCameraPositionAndTarget_UpVecY\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e12.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e25.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"m\"\u003e35.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eVGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e15.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"c1\"\u003e//第1引数の位置から第2引数の位置を見る角度にカメラを設置\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eMainLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eClearDrawScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を消す\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDrawBox\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimaryScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBounds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eHeight\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetColor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTRUE\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//背景を設定(透過させる)\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eplaySpeed\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//時間を進める\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//モーションの再生位置が終端まで来たら最初に戻す\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"n\"\u003etotalTime\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e0.0f\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1SetAttachAnimTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eattachIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eplayTime\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//モーションの再生位置を設定\u003c/span\u003e\n\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMV1DrawModel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emodelHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//3Dモデルの描画\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//ESCキーを押したら終了\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCheckHitKey\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eKEY_INPUT_ESCAPE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e!=\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nf\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eScreenFlip\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//裏画面を表画面にコピー\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_FormClosed\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eFormClosedEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eDX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDxLib_End\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"c1\"\u003e//DxLibの終了処理\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_Shown\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eFormBorderStyle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eFormBorderStyle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"c1\"\u003e//フォームの枠を非表示にする\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eTransparencyKey\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eColor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromArgb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//透過色を設定\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_DragEnter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDragEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e//ファイルがドラッグされた場合受け付ける\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetDataPresent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDataFormats\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileDrop\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEffect\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDragDropEffects\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCopy\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEffect\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDragDropEffects\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eForm1_DragDrop\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eDragEventArgs\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[])\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDataFormats\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eFileDrop\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//ドロップされたファイルのパスを取得(複数可)\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eids\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e//各画像をアップロードしIDを取得\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eMediaUploadResult\u003c/span\u003e \u003cspan class=\"n\"\u003eimage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etokens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMedia\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUpload\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emedia\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eFileInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eids\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAdd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMediaId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eStatus\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etokens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eStatuses\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"upload image\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emedia_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eids\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//画像をツイート\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eAllowDropをtrueにする事でファイルのドラッグ\u0026amp;ドロップを許可しています。\u003cbr\u003e\n次にForm1.cs[デザイン]から右下のプロパティの中のイベントのDragEnterとDragDropにそれぞれForm1_DragEnter関数とForm1_DragDrop関数を設定します。\u003cbr\u003e\nこれでファイルをドラッグ\u0026amp;ドロップした時に自動でこれらの関数が実行されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/11bae14607288293558dd10aba0f2e4fc8b96b48/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f32373634316665312d666466342d363537662d366536642d6331383131393166393036622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27641fe1-fdf4-657f-6e6d-c181191f906b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d2a4e2e2050bd2e09b347787dd7c490d\" alt=\"27.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/27641fe1-fdf4-657f-6e6d-c181191f906b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F27641fe1-fdf4-657f-6e6d-c181191f906b.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=03155c04567e9387de3dec7e6ebce746 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eファイルがドロップされた場合、ファイルのパスを取得し、そのパスを利用してUpload関数で画像をアップロードし、Update関数で投稿しています。\u003cbr\u003e\nstatusにはツイート文章の文字列を、media_idsにはアップロードした画像ID(MediaIdで取得)の配列をそれぞれ渡します。配列なので、複数枚まとめての投稿にも対応しています。(1ツイート4枚までだったと思います。)\u003c/p\u003e\n\n\u003cp\u003eこれでキャラクターにドラッグ\u0026amp;ドロップした画像がTwitterに投稿されるようになります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/d5192105d46a034ad2d6b3b70e1b7328bf27aeb3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f65333361383231362d373663622d623135382d336538622d6465633062663265353161332e676966\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe33a8216-76cb-b158-3e8b-dec0bf2e51a3.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a6cdf10528296b0290af151d4acf40ac\" alt=\"28.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/e33a8216-76cb-b158-3e8b-dec0bf2e51a3.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fe33a8216-76cb-b158-3e8b-dec0bf2e51a3.gif?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f2f7ab49224b78a57f7076cc5830d1cd 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eこんな感じに投稿されます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/97b7448776d1d2e6cd868d75a00fd52d87ecc762/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3132343536362f38323863366432652d386562342d383134312d316230352d3462333034366364663838662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F828c6d2e-8eb4-8141-1b05-4b3046cdf88f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=9ecc5444fca1e1131df5a84fa088568d\" alt=\"24.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/124566/828c6d2e-8eb4-8141-1b05-4b3046cdf88f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2F828c6d2e-8eb4-8141-1b05-4b3046cdf88f.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=871a5aa2e51d51bad77c2ad7933c40b7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h1\u003e\n\n\u003cp\u003e以上、デスクトップマスコットの作り方でした。\u003cbr\u003e\nここまで作り方についてあれこれ書いてきたわけですが、実はMMDモデルを用いたデスクトップマスコットは\u003ca href=\"http://www.nicovideo.jp/watch/sm28925683\" rel=\"nofollow noopener\" target=\"_blank\"\u003e既に配布されたりしています\u003c/a\u003e。\u003cbr\u003e\n\u003cdel\u003eつまりこの記事でやっている事はいわゆる二番煎じ\u003c/del\u003e\u003c/p\u003e\n\n\u003cp\u003e明日の記事はこまつなさん(\u003ca href=\"https://twitter.com/starealnight\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@starealnight\u003c/a\u003e)の「自作音ゲー紹介・DXライブラリで作る音ゲー」です。\u003cbr\u003e\nよろしくお願いします。\u003c/p\u003e\n","createdAt":"2017-12-14T17:14:33Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"mTEB39AsQFF7Kt4p9q78Q/+CB5qPAjvP--1y+aqGRh3ewdRVXW--5genvlUVm8XtVszo3R9Q9w==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2018-10-12T13:57:12Z","likesCount":92,"linkUrl":"https://qiita.com/massoumen/items/2985a0fb30472b97a590","organization":null,"originalId":588516,"stockedCount":112,"title":"デスクトップマスコットの作り方","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%9B%AE%E6%AC%A1\"\u003e目次\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003eプロジェクトの作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#dx%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003eDXライブラリの導入\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#mmd%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E6%8F%8F%E7%94%BB\"\u003eMMDモデルの描画\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%85%A8%E7%94%BB%E9%9D%A2%E5%8C%96%E8%83%8C%E6%99%AF%E3%81%AE%E9%80%8F%E6%98%8E%E5%8C%96\"\u003e全画面化・背景の透明化\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%A2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E9%81%A9%E7%94%A8\"\u003eモーションの適用\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#coretweet%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003eCoreTweetの導入\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%AA%8D%E8%A8%BC%E6%83%85%E5%A0%B1%E3%81%AE%E7%99%BB%E9%8C%B2\"\u003e認証情報の登録\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%94%BB%E5%83%8F%E3%81%AE%E6%8A%95%E7%A8%BF\"\u003e画像の投稿\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":50180,"uuid":"2985a0fb30472b97a590","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"lwOeSfwWV47qLYkQpzT0JzDImEU5--fCGcXn/aqWnvw0Yp--hRXODCkpgxbb/NKG74vcnQ==","originalId":124566,"description":"","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/124566/profile-images/1478095684","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fprofile-images%2F1478095684?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=d456c2e7ea81b8bcdc616349586ec0b5","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F124566%2Fprofile-images%2F1478095684?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=e1d506560a1593fb7a8f83b0ff5b037e","urlName":"massoumen","websiteUrl":null,"twitterUrl":"https://twitter.com/massoumen","twitterUrlName":"massoumen","revealedOrganizations":{"edges":[]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"DXライブラリ","urlName":"dx%e3%83%a9%e3%82%a4%e3%83%96%e3%83%a9%e3%83%aa"},{"name":"CoreTweet","urlName":"coretweet"}],"followingLikers":{"edges":[]},"comments":{"totalCount":5}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
