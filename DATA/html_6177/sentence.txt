More than 3 years have passed since last update.本当は、Moq の続きの記事を書こうと思ったのだが、Moq の次の対象が、Event だった。いろいろな記事やリファレンスを読んだけど、正直複雑で意味がわからなかったので、調べてみた。多分めっちゃ簡単な実装をしてみた。The Simplest C# Events Example Imaginableでやっと理解できたので、それを自分なりに実装してみた。これはクソガキ通報アプリだ。クソガキ何かをしているのを、警察が観察しているけど、クソガキが法にふれたら刑務所にぶち込むというアプリだ。コンソールアプリなので、理解しやすいだろう。結局ポイントは、イベントが発生するとどうなるかだ。イベント発生前に、0. の箇所で、クソガキの、Criminal Handler に、Police 側の Arrest メソッドを登録しておく。(2.)実際に、1. でイベントが発生すると、Event Handler に登録された、メソッドに処理が委譲される。クソガキがしっかり連行された。ちなみにメソッド登録時にこんなコードになっている。リファレンスを見てもよくわからないが、どうやらリストのように、ハンドラにいくつかのメソッドを登録できるっぽい。試してみよう。クソガキを連行して、刑務所にぶち込もう。実行してみる。イベントを監視することで、無事、クソガキを逮捕できました。イベントが実行されるときに、何かの値を渡したいかもしれません。試しに、犯行時間を渡せるようにします。こんな感じに EventArgs を継承したクラスを作ります。それを、先ほど EventArgs と書いていたところと置き換えます。実行結果はこの通り。予想どおり！無事クソガキが逮捕されて、犯行時間が記録されて、尚且つ皆さんの Event の理解につながれば幸いです。
コードは、GitHubに置いておきました。


