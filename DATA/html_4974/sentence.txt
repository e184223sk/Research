More than 1 year has passed since last update.PowerShellで演奏する電子オルゴールを制作してみました。☆関連記事
python3で演奏する電子オルゴール
Golangで演奏する電子オルゴールGitHubにて、ソースコードおよびサンプルの楽譜データも公開しています。
https://github.com/gx3n-inue/PS_PlayBoxMIDI関連のWin32APIを利用するクラスをC#で作成し、PowerShellからinlineで呼び出すことにより、楽譜データを演奏させてみます。プログラムの入力や実行には、コンパイラなどは必要ありません。
テキストエディタで入力して、PowerShell上で実行するだけです。MIDI関連のWin32APIを呼び出すC#のクラスはこんな感じです。次に、PowerShell側のメインプログラムです。楽譜データを入力する際に、ドレミ...もしくはdo,re,mi,...というように
音階で入力できるように、音階データとノート番号の変換表を作成しておきます。次に、演奏させたい曲の楽譜データを下記の書式で並べていきます。『こぎつねこんこん』だとこんな感じになります。
ちなみに、同じ長さの音符であれば、和音も鳴らすことができます。では早速、演奏してみましょう。
PowerShellを起動し、下記の書式でPS_PlayBox.ps1を実行します。timbreはMIDIの音色（楽器）の指定です。1～127の数値で指定してください。
以下は、さきほどの『ごぎつねこんこん』(PB_kitune.txt)をハーモニカ(23)で演奏する例です。


