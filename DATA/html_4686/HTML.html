<!DOCTYPE html><html><head><meta charset="utf-8" /><title>サマータイムに対応したかった（Windows+C#編） - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport" /><meta content="#55c500" name="theme-color" /><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification" /><meta content="telephone=no" name="format-detection" /><link rel="canonical" href="https://qiita.com/rawr/items/f18d8a9fdf0ca74ba48c" /><link href="/manifest.json" rel="manifest" /><link href="/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml" /><link as="script" href="https://www.googletagservices.com/tag/js/gpt.js" rel="preload" /><link href="https://securepubads.g.doubleclick.net" rel="preconnect" /><script async="" src="https://www.googletagservices.com/tag/js/gpt.js"></script><meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="7BubWlOVzD6q7cWbMUHSdXfjpy9P4UjwqTCYB3hHTknu9ZyOs+8piiul3uyZf2hCHyCtovAXit06rhq6Xedxvw==" /><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico" /><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png" /><link rel="stylesheet" media="all" href="https://cdn.qiita.com/assets/public/article-2eaa7dbedc42a8ea65c722cda46d0ebb.min.css" /><script src="https://cdn.qiita.com/assets/public/v3-article-bundle-63de2d91fef827269d3f6b958db2335b.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site" /><meta property="og:type" content="article"><meta property="og:title" content="サマータイムに対応したかった（Windows+C#編） - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NEsxNDRPZTQ0Tzg0NEtfNDRLazQ0T2c0NEdyNWEtLTViLWM0NEdYNDRHZjQ0R0w0NEdqNDRHZjc3eUlWMmx1Wkc5M2N5dERJLWUzcU8tOGlRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWQzODk2MjA5ZTcyOWRmZThiNTFhNmJjZGVhODQwOWMx&amp;mark-align=center%2Cmiddle&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSEpoZDNJJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NWI5MWJmYTE0ZDVjYzJlNTU1N2M2M2VjMGRmY2ExMzQ&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=d3d00d37de0dae540ecea5440d1a69cb"><meta property="og:description" content="

はじめに

サマータイムの制度自体の良し悪しはともかくとして、サマータイムの技術面、というかプログラムについて、何を考慮して何を対応する必要があるのかという話をしようかと思います。OSや言語を限定しないと一般論（OSによる、とか言..."><meta content="https://qiita.com/rawr/items/f18d8a9fdf0ca74ba48c" property="og:url" /><meta content="Qiita" property="og:site_name" /><meta content="564524038" property="fb:admins" /><meta content="C#,サマータイム" name="keywords" /><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '668972150489891');
fbq('track', 'PageView');</script><style data-emotion-css="17jxvjw 11t2ec1 1dvr2p8 18lkoru 1g4cku8 1iupg5d ijvq0v 15cocm3 12rp90f 115f4t 1b8uj5v 79elbk 16hhh7b fcbn8c 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r 1hbd3g7 1nzh4zz 38fzdi helsa7 8qb8m4 2imjyh he5w1s 70qvj9 3ojehk 100alwu 1dtnjt5 10ougpm 1ay9vb9 m19uds cgzq40 1wa99t2 1l3zk9f 4czcte 1yzj1fm 1uv1qiv 109dbrr 5jpx49 mnxgyc 1vlpknv fsjkhv 1b17vb0 7i7f4d"}>.css-17jxvjw{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1200px){.css-17jxvjw{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:992px){.css-17jxvjw{grid-template-columns:80px 452px 300px;-ms-grid-columns:80px 452px 300px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:770px){.css-17jxvjw{display:block;}}@media (max-width:480px){.css-17jxvjw{padding-top:0;}}.css-11t2ec1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:calc(56px + 24px + 16px + 32px - 16px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}.css-11t2ec1:after{content:'';display:table;}.css-11t2ec1:before{content:'';display:table;}@media (max-width:770px){.css-11t2ec1{display:none;}}.css-1dvr2p8{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-18lkoru{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;background-color:#FFFFFF;}.css-1g4cku8{display:inline-block;vertical-align:middle;height:20px;width:20px;fill:#55C500;}.css-1iupg5d{color:#55C500;cursor:pointer;font-size:14px;font-weight:bold;}.css-ijvq0v{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;margin-bottom:16px;}.css-15cocm3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#FFFFFF;border:2px solid #6E6F70;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:2px 0px 0px;width:40px;}.css-12rp90f{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#6E6F70;}.css-115f4t{color:#6E6F70;font-size:14px;font-weight:bold;}.css-1b8uj5v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;margin-bottom:16px;padding:0;}.css-79elbk{position:relative;}.css-16hhh7b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;font-size:20px;height:32px;outline:none;width:32px;padding:0;}.css-fcbn8c{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:calc(-8px - (14px * 1.8) - 16px - 4px);}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-1hbd3g7{height:250px;}.css-1nzh4zz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#FBE69E;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:770px){.css-1nzh4zz{padding:16px;}}.css-38fzdi{color:#CA832A;margin-right:4px;}.css-helsa7{background-color:#FFFFFF;padding:32px;margin-bottom:24px;}@media (max-width:992px){.css-helsa7{margin:0 auto 40px;}}@media (max-width:480px){.css-helsa7{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-he5w1s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;}@media (max-width:770px){.css-he5w1s{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-3ojehk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:4px;}.css-100alwu{display:inline-block;border-radius:50%;line-height:1;overflow:hidden;vertical-align:middle;}.css-1dtnjt5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-10ougpm{color:rgba(0,0,0,0.87);font-size:14px;font-weight:600;line-height:1.8;margin-right:4px;text-wrap:break-word;word-break:break-all;}.css-1ay9vb9{margin-right:16px;}.css-m19uds{color:rgba(0,0,0,0.6);font-size:14px;line-height:1.8;}.css-cgzq40{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;text-wrap:break-word;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-4czcte{margin-right:4px;color:inherit;font-size:14px;line-height:1.8;}.css-4czcte:not(:last-child)::after{content:',';margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-1uv1qiv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:#6E6F70;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-109dbrr{background-color:#F9F9F9;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:770px){.css-109dbrr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-mnxgyc{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1vlpknv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:2px solid #55C500;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:0;width:40px;margin-right:4px;background-color:#FFFFFF;}.css-fsjkhv{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;}.css-1b17vb0{color:#6E6F70;font-size:14px;font-weight:bold;margin-left:4px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style></head><body><div class="allWrapper"><div><div id="GlobalHeader-react-component-db4fc2d7-3731-4be7-a2ea-15ff6d229eb7"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="/" class="st-Header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-Header_communitySelector" tabindex="0"><span class="fa fa-caret-down"></span></div><div class="st-Header_dropdown"><div class="st-Header_dropdownHeading">Qiita Teams that are logged in</div><div class="st-Header_dropdownItemNote">You are not logged in to any team</div><hr class="st-Header_dropdownDivider st-Header_dropdownDivider-shrink"/><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem"><span class="fa fa-fw fa-sign-in st-Header_dropdownItemIcon"></span><div>Log in to Qiita Team</div></a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Community</div><a href="/organizations" class="st-Header_dropdownItem">Organization</a><a href="/official-events/open" class="st-Header_dropdownItem">Event</a><a href="/advent-calendar" class="st-Header_dropdownItem">Advent Calendar</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank">Qiitadon (β)</a><div class="st-Header_dropdownDivider"></div><div class="st-Header_dropdownHeading">Service</div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Zine</a><a href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank">Qiita Blog</a></div><form class="st-Header_search" action="/search" method="get"><span class="fa fa-search st-Header_searchIcon"></span><input type="search" class="st-Header_searchInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form><form class="st-Header_searchModal" action="/search" method="get"><input type="text" class="st-Header_searchModalInput" autoComplete="off" placeholder="Search" value="" name="q" required=""/></form></div><div class="st-Header_end"><div class="st-Header_searchButton"><span class="fa fa-search"></span></div><a class="st-Header_signupButton" href="/signup?redirect_to=%2Frawr%2Fitems%2Ff18d8a9fdf0ca74ba48c">Signup</a><a class="st-Header_loginLink" href="/login?redirect_to=%2Frawr%2Fitems%2Ff18d8a9fdf0ca74ba48c">Login</a></div><div class="st-Header_overlay"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-db4fc2d7-3731-4be7-a2ea-15ff6d229eb7">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/csharp","name":"C#"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2018-08-31T18:20:10.000+09:00","dateModified":"2018-08-31T18:20:10.000+09:00","headline":"サマータイムに対応したかった（Windows+C#編）","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTM4MCZ0eHQ2ND00NEsxNDRPZTQ0Tzg0NEtfNDRLazQ0T2c0NEdyNWEtLTViLWM0NEdYNDRHZjQ0R0w0NEdqNDRHZjc3eUlWMmx1Wkc5M2N5dERJLWUzcU8tOGlRJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTQmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWNlbnRlciUyQ21pZGRsZSZzPWQzODk2MjA5ZTcyOWRmZThiNTFhNmJjZGVhODQwOWMx\u0026mark-align=center%2Cmiddle\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTg0MCZoPTUwMCZ0eHQ2ND1RSEpoZDNJJnR4dC1jb2xvcj0lMjMzMzMmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NDUmdHh0LWFsaWduPXJpZ2h0JTJDYm90dG9tJnM9NWI5MWJmYTE0ZDVjYzJlNTU1N2M2M2VjMGRmY2ExMzQ\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=d3d00d37de0dae540ecea5440d1a69cb","mainEntityOfPage":"https://qiita.com/rawr/items/f18d8a9fdf0ca74ba48c","author":{"@type":"Person","address":null,"email":null,"identifier":"rawr","name":"rawr","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fprofile-images%2F1509075346?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=b1e10ed34e8843471d132ef8abecbc16","url":"https://qiita.com/rawr","description":null,"memberOf":[{"@type":"Organization","address":"〒100-0004 東京都千代田区大手町1-9-2 大手町フィナンシャルシティ グランキューブ","legalName":"株式会社野村総合研究所","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/f2dd24669e58d3692d0523520ea82f9bf51e3012/original.jpg?1605059310","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/2d2d149e908ace5e18742b0ffb417dc5d3426102/original.jpg?1606747309","identifier":"nri","description":"NRIは「コンサルティング」「金融 ITソリューション」「産業 ITソリューション」「IT 基盤サービス」の4事業でお客様のビジネスや快適な社会、暮らしを支えています。※各記事の内容は個人の見解であり、所属する組織の公式見解ではありません。"}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://increments.connpass.com/event/211948/">Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催</a><a target="_blank" id="header_text_message_2" href="https://increments.connpass.com/event/211948/">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"rawr","type":"items","id":"f18d8a9fdf0ca74ba48c"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"rawr","type":"items","id":"f18d8a9fdf0ca74ba48c"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_1","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"rawr","type":"items","id":"f18d8a9fdf0ca74ba48c"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":1,"pos_id":"header_text_message_2","message":"Qiita創業者海野氏登壇！Qiita エンジニアフェスタ 2021 Online Meetupを9/9(木)に開催","url":"https://increments.connpass.com/event/211948/","sub_message":"詳しくはこちら"}}
  )
})</script></div><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","href":"https://qiita.com/rawr/items/f18d8a9fdf0ca74ba48c","location":"/rawr/items/f18d8a9fdf0ca74ba48c","scheme":"https","host":"qiita.com","port":null,"pathname":"/rawr/items/f18d8a9fdf0ca74ba48c","search":null,"httpAcceptLanguage":null,"actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"Rs6ZgN39wjRSNqxLN/TXNz+BikbfUSqpK9fX4CKLwVxEIJ5UPYcngNN+tzyfym0AV0KAy2Cn6IS4SVVdByv+qg==","locale":"en"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-d9f7e360-7c18-4b4b-b4a7-f78d497d5ef8"><div class="p-items_wrapper"><div class=" css-17jxvjw"><div class="css-11t2ec1"><div class="css-1dvr2p8"><button class=" css-18lkoru"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/rawr/items/f18d8a9fdf0ca74ba48c/likers" class="css-1iupg5d">17</a></div><div class="css-ijvq0v"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-115f4t">5</span></div><div class="css-1b8uj5v"><span class="fa fa-twitter"></span></div><div class="css-1b8uj5v"><span class="fa fa-facebook"></span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-fcbn8c"><div class="css-1gj7nt">Improve article</div><a href="/drafts/f18d8a9fdf0ca74ba48c/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/rawr/items/f18d8a9fdf0ca74ba48c/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/rawr/items/f18d8a9fdf0ca74ba48c/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/rawr/items/f18d8a9fdf0ca74ba48c/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/rawr/items/f18d8a9fdf0ca74ba48c.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_toc"><div class="mt-2"><div class="css-1hbd3g7"></div></div></div><div class="p-items_main"><div class="css-1nzh4zz"><span class="fa fa-fw fa-warning css-38fzdi"></span><p>More than 3 years have passed since last update.</p></div><div class="css-helsa7"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-he5w1s"><div class="css-70qvj9"><div class="css-3ojehk"><a href="/rawr"><img class="css-100alwu eyfquo10" src="https://qiita-image-store.s3.amazonaws.com/0/208281/profile-images/1509075346" width="24" height="24" loading="lazy"/></a></div><div class="css-1dtnjt5"><a href="/rawr" class="css-10ougpm">@<!-- -->rawr</a><div class="css-1ay9vb9"><time dateTime="2018-08-31T09:20:10Z" class="css-m19uds">posted at 2018-08-31</time></div></div></div></div></div><h1 class="css-cgzq40">サマータイムに対応したかった（Windows+C#編）</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="/tags/csharp" class="css-4czcte">C#</a><a href="/tags/%e3%82%b5%e3%83%9e%e3%83%bc%e3%82%bf%e3%82%a4%e3%83%a0" class="css-4czcte">サマータイム</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>サマータイムの制度自体の良し悪しはともかくとして、サマータイムの技術面、というかプログラムについて、何を考慮して何を対応する必要があるのかという話をしようかと思います。OSや言語を限定しないと一般論（OSによる、とか言語による、とか）になりそうなので、WindowsとC#に限定した話にしたいと思います。</p>

<h1>
<span id="windowsはどの程度夏時間に対応している" class="fragment"></span><a href="#windows%E3%81%AF%E3%81%A9%E3%81%AE%E7%A8%8B%E5%BA%A6%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AB%E5%AF%BE%E5%BF%9C%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B"><i class="fa fa-link"></i></a>Windowsはどの程度夏時間に対応している？</h1>

<h2>
<span id="windowsにおける夏時間の設定" class="fragment"></span><a href="#windows%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Windowsにおける夏時間の設定</h2>

<p>Windowsの夏時間の設定は、コントロールパネルのタイムゾーンから行うのですが、下絵のように、「自動的に夏時間の調整をする」にチェックすれば、夏時間が設定できます。（下絵はWindows7ですが、Windows10でも見た目は違いますが、同じ設定があります）</p>

<p><a href="https://camo.qiitausercontent.com/8c5827947afbfed21f6136f9a7a7640053b9390e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f65373561306237662d666133642d653766302d666630382d3938663162303064306166662e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fe75a0b7f-fa3d-e7f0-ff08-98f1b00d0aff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e59ec8527c38ed846adc701a0be391db" alt="2018-08-22_143233.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/208281/e75a0b7f-fa3d-e7f0-ff08-98f1b00d0aff.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fe75a0b7f-fa3d-e7f0-ff08-98f1b00d0aff.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=143a5bc5cdd70a6cdc2f6defad44430e 1x" loading="lazy"></a></p>

<p>しかし、夏時間が設定できるのはタイムゾーンによるらしく、日本では夏時間が無いため、設定ができません。（Windows10の場合はグレーアウトされていて、入力できないようになっています）</p>

<p><a href="https://camo.qiitausercontent.com/e954ba3b8094f03f3b65e72fc1ec1d3bb6c77516/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f64633833373832302d623663642d356538642d343363362d6335356634653438363266322e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fdc837820-b6cd-5e8d-43c6-c55f4e4862f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4b765da06202d28cd975c6077c4316f0" alt="2018-08-22_143619.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/208281/dc837820-b6cd-5e8d-43c6-c55f4e4862f2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fdc837820-b6cd-5e8d-43c6-c55f4e4862f2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d76f9f0eba4d1634a1773b164b618164 1x" loading="lazy"></a></p>

<p>つまり、OSで夏時間を設定して対応完了！　ということはできなさそう、ということです。</p>

<h2>
<span id="microsoftは夏時間の対応をしてくれるのか" class="fragment"></span><a href="#microsoft%E3%81%AF%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E5%AF%BE%E5%BF%9C%E3%82%92%E3%81%97%E3%81%A6%E3%81%8F%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>Microsoftは夏時間の対応をしてくれるのか</h2>

<p>日本で本当に夏時間が導入されてしまったら、MicrosoftはWindows Updateで、日本のタイムゾーンでも夏時間の設定ができるようしてくれるかもしれません。私個人的な見解で根拠は無いのですが、おそらくMicrosoftは対応すると思っています。ただ問題は、Microsoftは「ちゃんと」夏時間の設定ができるようにしてくれるのか、ということです。</p>

<p>「ちゃんと」というのは、日本で導入しようとしている夏時間は、通常の１時間ずらすのではなく、２時間ずらす、二重夏時間(BDST - British Double Summer Time)だからです。かつて二重夏時間を採用したことがあるイギリスのタイムゾーン：ロンドンを見ても、二重夏時間を設定できるような箇所はありません。（ただし、イギリスが二重夏時間を導入していた時期は、コンピューターがある時代よりずっと前の時代であり、コンピュータが使われるようになった時代では、二重夏時間を導入している国がないからかもしれません）</p>

<p><a href="https://camo.qiitausercontent.com/e1761d455b946afa42626f9c6f41e21821c9d521/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f34643530616266372d326530342d303262382d306633662d6636383131663830376464622e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F4d50abf7-2e04-02b8-0f3f-f6811f807ddb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=afa5c4286f926bd1c1a6ee9079604d65" alt="2018-08-22_145605.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/208281/4d50abf7-2e04-02b8-0f3f-f6811f807ddb.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F4d50abf7-2e04-02b8-0f3f-f6811f807ddb.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6ce94f8a7cb200b0dcda1291082b4d73 1x" loading="lazy"></a></p>

<p>Microsoftは「日本でも夏時間をWindowsに対応しました」と言いつつ、普通の１時間ずらす夏時間しか設定できない、ということが、非常にありそうだということです。</p>

<h1>
<span id="cで夏時間を扱う" class="fragment"></span><a href="#c%E3%81%A7%E5%A4%8F%E6%99%82%E9%96%93%E3%82%92%E6%89%B1%E3%81%86"><i class="fa fa-link"></i></a>C#で夏時間を扱う</h1>

<p>Windowsが夏時間に対応してくれない場合（あるいは残念な対応しかしてくれない場合）、プログラムでなんとかするしかありません。幸い、C#には（夏時間を表現できる） <code>TimeZoneInfo</code> を作ることが出来ます。</p>

<h2>
<span id="cで日時はどうプログラムするんだっけ" class="fragment"></span><a href="#c%E3%81%A7%E6%97%A5%E6%99%82%E3%81%AF%E3%81%A9%E3%81%86%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%99%E3%82%8B%E3%82%93%E3%81%A0%E3%81%A3%E3%81%91"><i class="fa fa-link"></i></a>C#で日時はどうプログラムするんだっけ？</h2>

<p><code>TimeZoneInfo</code>の前に、まず復習しておきます。C#での日時の扱い方は、入門書や入門サイトで何度も何度も何度も見ていると思いますので、説明は簡単にしておきます。</p>

<p>まず、<strong><code>DateTime</code>はオワコン</strong>なので、存在自体を忘れてください。<br>
<code>DateTimeOffset</code>は「日時」と「UTCからの時差」を保持したクラスです。このクラスは夏時間を考慮していません。<br>
夏時間（とUTCとの時差）の情報は<code>TimeZoneInfo</code>から取得します。</p>

<p>以上から、日時は、時間を表す<code>DateTimeOffset</code>とUTCとの時差を表す<code>TimeZoneInfo</code>の２つを使っていくことになります。しかし、通常日時を処理する場合、次のように<code>TimeZoneInfo</code>はほとんど意識していない思います。（蛇足ですが、特定の日時の<code>DateTimeOffset</code>を生成するとき、最後の引数を <code>TimeSpan.FromHours(9)</code> というように、ハードコーディングしていませんよね？）</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 現在日時</span>
<span class="kt">var</span> <span class="n">now</span> <span class="p">=</span> <span class="n">DateTimeOffset</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span> <span class="c1">// -&gt; 2018/08/31 11:44:04 +09:00</span>

<span class="c1">// 特定の日時</span>
<span class="kt">var</span> <span class="n">dt</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTimeOffset</span><span class="p">(</span><span class="m">2018</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="n">TimeZoneInfo</span><span class="p">.</span><span class="n">Local</span><span class="p">.</span><span class="n">BaseUtcOffset</span><span class="p">);</span>
    <span class="c1">// -&gt; 2018/01/02 03:04:05 +09:00</span>
</code></pre></div></div>

<p>現在日時や特定の日時の出力結果を見て分かるように、使われている<code>TimeZoneInfo</code>は<strong>OSのタイムゾーン</strong>になっています。つまり、Windowsが日本二重夏時間（仮称）に対応してくれれば、プログラムではほとんど考慮しなくて良くなります。（実際には、ユーザーへの画面入出力とった、日本時間自体が重要な箇所においては、単に<code>TimeZoneInfo</code>だけ考慮すれば良い、という訳にはいかない）</p>

<h2>
<span id="日本二重夏時間仮称timezoneinfoを作る" class="fragment"></span><a href="#%E6%97%A5%E6%9C%AC%E4%BA%8C%E9%87%8D%E5%A4%8F%E6%99%82%E9%96%93%E4%BB%AE%E7%A7%B0timezoneinfo%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>日本二重夏時間（仮称）TimeZoneInfoを作る</h2>

<p>Windows(Microsoft)が日本二重夏時間（仮称）に対応してくれない場合、自分で<code>TimeZoneInfo</code>を作る方法もあります。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// (3)</span>
<span class="kt">var</span> <span class="n">transitionStart</span> <span class="p">=</span> <span class="n">TimeZoneInfo</span><span class="p">.</span><span class="n">TransitionTime</span><span class="p">.</span><span class="nf">CreateFixedDateRule</span><span class="p">(</span><span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="m">8</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">transitionEnd</span> <span class="p">=</span> <span class="n">TimeZoneInfo</span><span class="p">.</span><span class="n">TransitionTime</span><span class="p">.</span><span class="nf">CreateFixedDateRule</span><span class="p">(</span><span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="m">9</span><span class="p">,</span> <span class="m">31</span><span class="p">);</span>
<span class="c1">// (2)</span>
<span class="kt">var</span> <span class="n">adjustment</span> <span class="p">=</span> <span class="n">TimeZoneInfo</span><span class="p">.</span><span class="n">AdjustmentRule</span><span class="p">.</span><span class="nf">CreateAdjustmentRule</span><span class="p">(</span>
    <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2018</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2018</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">31</span><span class="p">),</span>
    <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromHours</span><span class="p">(</span><span class="m">2</span><span class="p">),</span>
    <span class="n">transitionStart</span><span class="p">,</span>
    <span class="n">transitionEnd</span><span class="p">);</span>

<span class="c1">// (1)</span>
<span class="kt">var</span> <span class="n">jddtTimeZone</span> <span class="p">=</span> <span class="n">TimeZoneInfo</span><span class="p">.</span><span class="nf">CreateCustomTimeZone</span><span class="p">(</span>
    <span class="s">"Japan Double Daylight Time"</span><span class="p">,</span> 
    <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromHours</span><span class="p">(</span><span class="m">9</span><span class="p">),</span> 
    <span class="s">"(UTC+09:00) Osaka, Sapporo, Tokyo"</span><span class="p">,</span> 
    <span class="s">"Japan Standard Time"</span><span class="p">,</span> 
    <span class="s">"Japan Double Daylight Time"</span><span class="p">,</span>
    <span class="k">new</span> <span class="n">TimeZoneInfo</span><span class="p">.</span><span class="n">AdjustmentRule</span><span class="p">[]</span> <span class="p">{</span> <span class="n">adjustment</span> <span class="p">});</span>

<span class="c1">// (4-1) 現在日時の場合</span>
<span class="kt">var</span> <span class="n">now</span> <span class="p">=</span> <span class="n">DateTimeOffset</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">ddt</span> <span class="p">=</span> <span class="n">TimeZoneInfo</span><span class="p">.</span><span class="nf">ConvertTime</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">jddtTimeZone</span><span class="p">);</span> <span class="c1">// -&gt; 2018/08/31 13:44:05 +11:00</span>

<span class="c1">// (4-2) 特定日時の場合</span>
<span class="kt">var</span> <span class="n">dt1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTimeOffset</span><span class="p">(</span><span class="m">2018</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">34</span><span class="p">,</span> <span class="m">56</span><span class="p">,</span> 
    <span class="n">jddtTimeZone</span><span class="p">.</span><span class="n">BaseUtcOffset</span> <span class="p">+</span> <span class="n">jddtTimeZone</span><span class="p">.</span><span class="nf">GetAdjustmentRules</span><span class="p">()[</span><span class="m">0</span><span class="p">].</span><span class="n">DaylightDelta</span><span class="p">);</span>
    <span class="c1">// -&gt; 2018/09/01 12:34:56 +11:00</span>

<span class="kt">var</span> <span class="n">dt2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2018</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">34</span><span class="p">,</span> <span class="m">56</span><span class="p">);</span>
<span class="c1">//var dt2 = new DateTime(2018, 10, 1, 12, 34, 56);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">jddtTimeZone</span><span class="p">.</span><span class="nf">IsDaylightSavingTime</span><span class="p">(</span><span class="n">dt2</span><span class="p">))</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">dt3</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTimeOffset</span><span class="p">(</span><span class="n">dt2</span><span class="p">,</span> 
        <span class="n">jddtTimeZone</span><span class="p">.</span><span class="n">BaseUtcOffset</span> <span class="p">+</span> <span class="n">jddtTimeZone</span><span class="p">.</span><span class="nf">GetAdjustmentRules</span><span class="p">()[</span><span class="m">0</span><span class="p">].</span><span class="n">DaylightDelta</span><span class="p">);</span>
    <span class="c1">// -&gt; 2018/09/01 12:34:56 +11:00</span>
<span class="p">}</span> <span class="k">else</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">dt3</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTimeOffset</span><span class="p">(</span><span class="n">dt2</span><span class="p">,</span> <span class="n">jddtTimeZone</span><span class="p">.</span><span class="n">BaseUtcOffset</span><span class="p">);</span>
    <span class="c1">// -&gt; 2018/10/01 12:34:56 +09:00</span>
<span class="p">}</span>
</code></pre></div></div>

<p>手順は、いつものように複雑です。</p>

<p>(1) 自作<code>TimeZoneInfo</code> は <code>TimeZoneInfo.CreateCustomTimeZone()</code> メソッドで作ることが出来ます。引数の文字列の部分(４箇所)は表示上の名前です。「日本二重夏時間」の正式名称がないので、勝手に適当に命名しました。第２引数は、標準時間の場合のUTCとの時差なので、ここは <code>+09:00</code> を指定します。最後の引数(adjustmentRules)で、夏時間の定義をします。<br>
(2) <code>TimeZoneInfo.AdjustmentRule</code> は、<code>TimeZoneInfo.AdjustmentRule.CreateAdjustmentRule()</code> メソッドで作ることができます。第１・第２引数は、夏時間が運用される開始と終了年月日を指定します。夏時間の開始日と終了日ではありません。上のコード片では、2018年だけ夏時間が適用される例となります。第３引数は夏時間でずらす時間を指定します。二重夏時間なので、<code>+2</code> を指定しました。第４・第５引数は、夏時間の期間を <code>TimeZoneInfo.TransitionTime</code> 指定します。<br>
(3) <code>TimeZoneInfo.TransitionTime</code> は 夏時間の開始/終了日が固定の場合は <code>CreateFixedDateRule()</code>、「第２月曜日から」のように動的な場合は <code>CreateFloatingDateRule()</code> メソッドを使います。上のコード片では、8/1 1:00～9/31 1:00という固定日の例です。 第１引数は、適用する<strong>時分秒</strong>を指定します。なぜか<code>DateTime</code>を要求していますが、実際に使われるのは時分秒の部分だけです。そのため、上のコード片では、（使われないので）年月日を1/1/1に指定しています。第２・第３引数は夏時間の開始/終了月日を指定します。</p>

<p>(4-1) <code>TimeZoneInfo</code>を作ったので、現在時刻を取得してみます。<code>DateTimeOffset.Now</code>では、夏時間の無い日本時間（というか、OSのタイムゾーン）になってしまうので、これを <code>TimeZoneInfo.ConvertTime()</code> で変換する必要があります。変換した結果は、<code>+11:00</code> となっているので、二重夏時間が適用されています。</p>

<p>(4-2) 特定の日時を指定する場合、<code>TimeZoneInfo#BaseUtcOffset</code> は標準時間とUTCとの時差だけの値であるため（<code>TimeZoneInfo.AdjustmentRule</code> を考慮していない値であるため）、自分で夏時間であるかの判定を行い、<code>TimeZoneInfo.AdjustmentRule</code> の <code>DaylightDelta</code> を加えるしかありません。つまり入力の場合、<strong>一度<code>DateTime</code>で時差情報のない日時オブジェクトを作り、夏時間/通常の判定をしたあと、<code>DateTimeOffset</code> をインスタンス化するとき、適切な <code>TimeSpan</code> を指定しなければならない</strong>ため、とても面倒なことになります。ちなみに出力の場合は、<code>TimeZoneInfo.ConvertTime()</code> で変換すればいいので面倒ではありません。</p>

<h1>
<span id="timezoneinfo-だけでは対処できなさそうなこと" class="fragment"></span><a href="#timezoneinfo-%E3%81%A0%E3%81%91%E3%81%A7%E3%81%AF%E5%AF%BE%E5%87%A6%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%95%E3%81%9D%E3%81%86%E3%81%AA%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a><code>TimeZoneInfo</code> だけでは対処できなさそうなこと</h1>

<p>先ほどちらっと「ユーザーへの画面入(出)力といった、日本時間自体が重要な箇所においては対処できない」と書きました。</p>

<h2>
<span id="夏時間の切り替えで発生する存在しない時間と重複する時間" class="fragment"></span><a href="#%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%81%A7%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B%E5%AD%98%E5%9C%A8%E3%81%97%E3%81%AA%E3%81%84%E6%99%82%E9%96%93%E3%81%A8%E9%87%8D%E8%A4%87%E3%81%99%E3%82%8B%E6%99%82%E9%96%93"><i class="fa fa-link"></i></a>夏時間の切り替えで発生する、存在しない時間と重複する時間</h2>

<p>問題点の話の前に、夏時間の切り替え前後で何が起こるのか、の話を書いておきます。</p>

<h3>
<span id="存在しない時間" class="fragment"></span><a href="#%E5%AD%98%E5%9C%A8%E3%81%97%E3%81%AA%E3%81%84%E6%99%82%E9%96%93"><i class="fa fa-link"></i></a>存在しない時間</h3>

<p>例えば、1:00に通常→夏時間の切り替えが発生したとすると、（1:00の１秒後が3:00:01になるのか、0:59:59の１秒後が3:00:00になるのかは分かりませんが）下絵のように1:00=3:00になり、<strong>1:00～3:00が存在しない時間</strong>になります。１時だと思ったら３時だった…　という状況です。この時間帯のことを、Windows界では Invalid Time と呼ぶそうです。</p>

<ul>
<li>日本時間視点</li>
</ul>

<p><a href="https://camo.qiitausercontent.com/c697f1363d17e88a985f893345be1eecf4710733/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f38383065346531332d646135632d326665382d376431362d6232616263663830346566392e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F880e4e13-da5c-2fe8-7d16-b2abcf804ef9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=32557f057c3155419b218e15f26e44cd" alt="2018-08-30_164130.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/208281/880e4e13-da5c-2fe8-7d16-b2abcf804ef9.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F880e4e13-da5c-2fe8-7d16-b2abcf804ef9.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b8e5a13ea685a720a6194e90c914c37d 1x" loading="lazy"></a></p>

<ul>
<li>UTC視点</li>
</ul>

<p><a href="https://camo.qiitausercontent.com/221f71752053eb80edf812a77130866ac4a41f23/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f64383162323732342d653535612d323766362d386331382d6362306235353032383438302e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fd81b2724-e55a-27f6-8c18-cb0b55028480.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=90e0b8a06751629ee5a026cc67389675" alt="2018-08-30_164209.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/208281/d81b2724-e55a-27f6-8c18-cb0b55028480.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fd81b2724-e55a-27f6-8c18-cb0b55028480.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=cdf3a69dedeb9b3dd518c4eea8a212af 1x" loading="lazy"></a></p>

<h3>
<span id="重複する時間" class="fragment"></span><a href="#%E9%87%8D%E8%A4%87%E3%81%99%E3%82%8B%E6%99%82%E9%96%93"><i class="fa fa-link"></i></a>重複する時間</h3>

<p>逆に夏時間→通常に切り替えのときは、同じ時間が繰り返されます。例えば 3:00 に切り替えがおきたとすると、下絵のように、1:00～3:00が２回発生します。Windows界では、この時間帯を Ambiguous Time と呼びます。</p>

<ul>
<li>日本時間視点</li>
</ul>

<p><a href="https://camo.qiitausercontent.com/1cd69bccba568892960aa224ed017296b8447f8e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f35346233323433312d633232302d343139362d396361612d6435346638663462616265352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F54b32431-c220-4196-9caa-d54f8f4babe5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e9723bbbb7284b0574219b4a2d08c083" alt="2018-08-30_165317.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/208281/54b32431-c220-4196-9caa-d54f8f4babe5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F54b32431-c220-4196-9caa-d54f8f4babe5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3f52545e6d1b17013bd3b0003ee08a6f 1x" loading="lazy"></a></p>

<ul>
<li>UTC視点</li>
</ul>

<p><a href="https://camo.qiitausercontent.com/33768577971cd53821c4dec84e985c4f7c7ed4ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f37343436376531362d303962362d623437382d343433382d3862616131666165663532372e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F74467e16-09b6-b478-4438-8baa1faef527.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6e4f6f2e58dd57f659488defde21df31" alt="2018-08-30_165340.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/208281/74467e16-09b6-b478-4438-8baa1faef527.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F74467e16-09b6-b478-4438-8baa1faef527.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e51aec91c5961a2c09c4f554a1524856 1x" loading="lazy"></a></p>

<h3>
<span id="問題点は" class="fragment"></span><a href="#%E5%95%8F%E9%A1%8C%E7%82%B9%E3%81%AF"><i class="fa fa-link"></i></a>問題点は？</h3>

<p>日時の入力で特定の値を指定された場合、夏時間か通常の時間かの判定を自前でやらなければならない、と書きましたが、それだけではなく、Skipされている時間(Invalid Time)なのか重複する時間なのか(Ambiguous Time)の判定も必要になり、さらにエラー処理も増えるということです。</p>

<p>以下、私がとっさに思いついた問題が起こりそうな箇所を上げてみたいと思います。</p>

<h2>
<span id="時間で検索" class="fragment"></span><a href="#%E6%99%82%E9%96%93%E3%81%A7%E6%A4%9C%E7%B4%A2"><i class="fa fa-link"></i></a>時間で検索</h2>

<p>例えばユーザーが自分のアクセス履歴を見るために、0:30-1:30という時間の範囲指定で検索をしたとしましょう。夏時間→通常の切り替えが 1:00 にある場合、この「1:30」が夏時間中の「1:30(UTC+11:00)」なのか、通常の「1:30(UTC+09:00)」なのか区別が付きません。これに対応するには、画面に「サマータイム？」のチェックボックスを用意するしかないでしょう。つまり、画面の修正と入力項目が１つ増えることになります。</p>

<p>時間入力のエラーチェックも増えます。通常→夏時間の切り替えが 1:00 にある場合、1:00＝3:00になるので、つまり1:01～2:59は存在しない時間になるので、0:30-1:30という検索条件は、時間不正のエラーにする必要があります。0:00～23:59以外で時間の入力値チェックなんてしていないでしょうから、時間入力のある画面/APIにチェックを増やしていく作業が発生します。</p>

<p>いちおうC#には、日時がサマータイムでスキップされている時間であるか（<code>TimeZoneInfo#IsInvalidTime</code> ）、重複している時間であるか（<code>TimeZoneInfo#IsAmbiguousTime</code> ）を調べるメソッドがあります。しかしスキップされる時間範囲と重複する時間範囲を取得するメソッドはありません（簡単に作れますが）。</p>

<h2>
<span id="データベースの時間" class="fragment"></span><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E6%99%82%E9%96%93"><i class="fa fa-link"></i></a>データベースの時間</h2>

<p>時間を格納している型がUTCか、UTCからの時差も含めて格納しているなら、問題なさそうです。しかし、"20190102030405"にように、日本時間を文字列で入れてしまっている場合、問題です。日付型に変換するか、文字列のままにするがUTCにするかしかなさそうです。</p>

<h2>
<span id="１時間後の処理" class="fragment"></span><a href="#%EF%BC%91%E6%99%82%E9%96%93%E5%BE%8C%E3%81%AE%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>「１時間後」の処理</h2>

<p>0:30の１時間後が1:30ではななく3:30の場合があるので、ただ「足す」だけでは問題が起こる場合があります。もし、アプリケーション内部では時間はすべてUTCで扱っているなら、何の問題もありません。文字通り「足せ」ばいいだけです。<code>DateTimeOffset</code> は日時とUTCとの時差を持っているため、通常/夏時間の切り替わりは考えなくても大丈夫です。</p>

<div class="code-frame" data-lang="csharp"><div class="highlight"><pre class="with-code"><code><span class="c1">// 現在時刻の１時間後(夏時間考慮込み)</span>
<span class="kt">var</span> <span class="n">now1</span> <span class="p">=</span> <span class="n">DateTimeOffset</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">AddHours</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
<span class="c1">// 結局出力は(自作した)TimeZoneInfoで変換するので、DateTimeOffsetなら問題ない</span>
<span class="n">jddstTimeZone</span><span class="p">.</span><span class="nf">ConvertTime</span><span class="p">(</span><span class="n">now1</span><span class="p">);</span>
</code></pre></div></div>

<h1>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h1>

<ul>
<li>サマータイムの設定はOS(Windows)に行われるのであり、プログラムやアプリケーションにするものではない。</li>
<li>現状（2018年8月時点）では、Windowsに日本のタイムゾーンはサマータイムの設定はない。しかし、Microsoftはサマータイムの設定をできるようにしてくれるかもしれない。</li>
<li>C#のプログラムでは、<code>DateTimeOffset</code> &amp; <code>TimeZoneInfo</code> を使えば、とりあえずサマータイムの対処はできるようになる。逆に <code>DateTime</code> を使っていると、酷いことになる。</li>
<li>Windowsでサマータイムの設定ができるようにならない場合は、自分で「日本二重夏時間」を表す <code>TimeZoneInfo</code> を作ることが出来る。</li>
<li>それでも外部からの入力値がある場合、自分で夏時間/通常の判定をしなければならないし、不正な時間であるかの判定とエラー処理も加える必要がある。</li>
<li>データベースや時間指定の検索など、日時を使うシステムは、内部ではUTCにしておくのが無難。</li>
<li><del>システム内部で（サマータイムの無い）UTCで時間を扱うなら、サマータイムなんていらないじゃん</del></li>
</ul>

<p>最後に、OSの時間を２時間進める/遅らせるだけ、という対応はやめたほうがいいでしょう。アプリケーションが乗っているサーバーは、大抵NTPで時刻同期をしているでしょうから…</p>

<h1>
<span id="参考文献サイト" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E3%82%B5%E3%82%A4%E3%83%88"><i class="fa fa-link"></i></a>参考文献・サイト</h1>

<ul>
<li><a href="https://www.slideshare.net/atsushikambara/handling-globaldatetime-27589220" rel="nofollow noopener" target="_blank">日時の問題とC#での扱い方の話</a></li>
</ul>

<p>時差の話がメインのようですが、夏時間の話もあります。C#の話に特化しているため、C#のプログラマーなら一読の価値はあります。スライドショーなので30分程度で全部読めますし。</p>

<ul>
<li><a href="https://msdn.microsoft.com/ja-jp/library/system.timezoneinfo(v=vs.110).aspx" rel="nofollow noopener" target="_blank">Microsoftのドキュメント</a></li>
</ul>

<p><code>TimeZoneInfo</code>の使い方なんて、慣れている人はいないでしょうから、一度は見ておいたほうがいいでしょう。</p>
</div></div></section><div class="css-1yzj1fm"><div class="css-1uv1qiv"><span class="fa fa-twitter"></span></div><div class="css-1uv1qiv"><span class="fa fa-facebook"></span></div></div><div class="apm-Content"><div class="apm-Content_title">Why not register and get more from Qiita?</div><ol class="apm-Content_list"><li>We will deliver articles that match you<div class="description">By following users and tags, you can catch up information on technical fields that you are interested in as a whole</div></li><li>you can read useful information later efficiently<div class="description">By &quot;stocking&quot; the articles you like, you can search right away</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>What you can do with signing up</a></div></ol><a href="/signup?callback_action=login_or_signup&amp;redirect_to=%2Frawr%2Fitems%2Ff18d8a9fdf0ca74ba48c&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">Sign up</a><a href="/login?callback_action=login_or_signup&amp;redirect_to=%2Frawr%2Fitems%2Ff18d8a9fdf0ca74ba48c&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">Login</a></div></div><div class="css-helsa7"></div></div></div></div><div class="css-109dbrr"><div class="css-5jpx49"><div class="css-mnxgyc"><button class=" css-1vlpknv"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-1g4cku8 e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button><a href="/rawr/items/f18d8a9fdf0ca74ba48c/likers" class="css-1iupg5d">17</a></div><div class="css-fsjkhv"><button class=" css-15cocm3"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#6E6F70" class="css-12rp90f e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1b17vb0">5</span></div><div class="css-79elbk"><button class="css-16hhh7b"><i class="fa fa-ellipsis-h"></i></button><div class="css-7i7f4d"><div class="css-1gj7nt">Improve article</div><a href="/drafts/f18d8a9fdf0ca74ba48c/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>Send edit request</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">Article information</div><a href="/rawr/items/f18d8a9fdf0ca74ba48c/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>Revisions</a><a href="/rawr/items/f18d8a9fdf0ca74ba48c/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>Edit Requests</a><a href="/rawr/items/f18d8a9fdf0ca74ba48c/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>Show all likers</a><a href="/rawr/items/f18d8a9fdf0ca74ba48c.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Show article in Markdown</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>Report article</div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">Help us understand the problem. What is going on with this article?</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required=""/>It&#x27;s illegal (copyright infringement, privacy infringement, libel, etc.)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required=""/>It&#x27;s socially inappropriate (offensive to public order and morals)</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required=""/>It&#x27;s advertising</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required=""/>It&#x27;s spam</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required=""/>Other than the above, but not suitable for the Qiita community (violation of guidelines)</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="Submit"/></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-d9f7e360-7c18-4b4b-b4a7-f78d497d5ef8">{"authorAnalyticsTrackingId":"UA-156164552-1","organizationAnalyticsTrackingId":null}</script>
      
<footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewbox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28" /><path d="M250.81 29.66h23.48v18.9h-23.48z" /><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z" /><circle cx="216.33" cy="21.4" r="12.28" /></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="/about">About</a><a href="/terms">Terms</a><a href="/privacy">Privacy</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">Guideline</a><a target="_blank" href="https://help.qiita.com/ja/articles/others-brand-guideline">Design Guideline</a></div><div class="st-Footer_column"><a href="/release-notes">Release</a><a href="/api/v2/docs">API</a><a href="/feedback/new">ご意見</a><a href="https://help.qiita.com">Help</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Advertisement</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com">Blog</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-8ba1e73a-e368-4a0b-864a-3115a977d167"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-8ba1e73a-e368-4a0b-864a-3115a977d167">{}</script>
      
<div id="LoginModal-react-component-66d6ca53-4395-43d7-95c8-4697711a9b16"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-66d6ca53-4395-43d7-95c8-4697711a9b16">{}</script>
      
<div id="StockModal-react-component-e20425fe-ee38-4d08-a28f-93a32398275d"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-e20425fe-ee38-4d08-a28f-93a32398275d">{}</script>
      
</div><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;8x0zpwVxQB9QZYSV6zzga7r/OFEzoeEvSv7JPghlzD7x8zRz5Qulq9Etn+JDAlpc0jwy3IxXIwLZYEuDLcXzyA==&quot;,&quot;locale&quot;:&quot;en&quot;},&quot;currentUser&quot;:null}" /></body></html><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003eサマータイムの制度自体の良し悪しはともかくとして、サマータイムの技術面、というかプログラムについて、何を考慮して何を対応する必要があるのかという話をしようかと思います。OSや言語を限定しないと一般論（OSによる、とか言語による、とか）になりそうなので、WindowsとC#に限定した話にしたいと思います。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"windowsはどの程度夏時間に対応している\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#windows%E3%81%AF%E3%81%A9%E3%81%AE%E7%A8%8B%E5%BA%A6%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AB%E5%AF%BE%E5%BF%9C%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWindowsはどの程度夏時間に対応している？\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"windowsにおける夏時間の設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#windows%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWindowsにおける夏時間の設定\u003c/h2\u003e\n\n\u003cp\u003eWindowsの夏時間の設定は、コントロールパネルのタイムゾーンから行うのですが、下絵のように、「自動的に夏時間の調整をする」にチェックすれば、夏時間が設定できます。（下絵はWindows7ですが、Windows10でも見た目は違いますが、同じ設定があります）\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/8c5827947afbfed21f6136f9a7a7640053b9390e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f65373561306237662d666133642d653766302d666630382d3938663162303064306166662e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fe75a0b7f-fa3d-e7f0-ff08-98f1b00d0aff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e59ec8527c38ed846adc701a0be391db\" alt=\"2018-08-22_143233.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/208281/e75a0b7f-fa3d-e7f0-ff08-98f1b00d0aff.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fe75a0b7f-fa3d-e7f0-ff08-98f1b00d0aff.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=143a5bc5cdd70a6cdc2f6defad44430e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eしかし、夏時間が設定できるのはタイムゾーンによるらしく、日本では夏時間が無いため、設定ができません。（Windows10の場合はグレーアウトされていて、入力できないようになっています）\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e954ba3b8094f03f3b65e72fc1ec1d3bb6c77516/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f64633833373832302d623663642d356538642d343363362d6335356634653438363266322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fdc837820-b6cd-5e8d-43c6-c55f4e4862f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4b765da06202d28cd975c6077c4316f0\" alt=\"2018-08-22_143619.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/208281/dc837820-b6cd-5e8d-43c6-c55f4e4862f2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fdc837820-b6cd-5e8d-43c6-c55f4e4862f2.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d76f9f0eba4d1634a1773b164b618164 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eつまり、OSで夏時間を設定して対応完了！　ということはできなさそう、ということです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"microsoftは夏時間の対応をしてくれるのか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#microsoft%E3%81%AF%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E5%AF%BE%E5%BF%9C%E3%82%92%E3%81%97%E3%81%A6%E3%81%8F%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMicrosoftは夏時間の対応をしてくれるのか\u003c/h2\u003e\n\n\u003cp\u003e日本で本当に夏時間が導入されてしまったら、MicrosoftはWindows Updateで、日本のタイムゾーンでも夏時間の設定ができるようしてくれるかもしれません。私個人的な見解で根拠は無いのですが、おそらくMicrosoftは対応すると思っています。ただ問題は、Microsoftは「ちゃんと」夏時間の設定ができるようにしてくれるのか、ということです。\u003c/p\u003e\n\n\u003cp\u003e「ちゃんと」というのは、日本で導入しようとしている夏時間は、通常の１時間ずらすのではなく、２時間ずらす、二重夏時間(BDST - British Double Summer Time)だからです。かつて二重夏時間を採用したことがあるイギリスのタイムゾーン：ロンドンを見ても、二重夏時間を設定できるような箇所はありません。（ただし、イギリスが二重夏時間を導入していた時期は、コンピューターがある時代よりずっと前の時代であり、コンピュータが使われるようになった時代では、二重夏時間を導入している国がないからかもしれません）\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/e1761d455b946afa42626f9c6f41e21821c9d521/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f34643530616266372d326530342d303262382d306633662d6636383131663830376464622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F4d50abf7-2e04-02b8-0f3f-f6811f807ddb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=afa5c4286f926bd1c1a6ee9079604d65\" alt=\"2018-08-22_145605.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/208281/4d50abf7-2e04-02b8-0f3f-f6811f807ddb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F4d50abf7-2e04-02b8-0f3f-f6811f807ddb.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6ce94f8a7cb200b0dcda1291082b4d73 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eMicrosoftは「日本でも夏時間をWindowsに対応しました」と言いつつ、普通の１時間ずらす夏時間しか設定できない、ということが、非常にありそうだということです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"cで夏時間を扱う\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#c%E3%81%A7%E5%A4%8F%E6%99%82%E9%96%93%E3%82%92%E6%89%B1%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eC#で夏時間を扱う\u003c/h1\u003e\n\n\u003cp\u003eWindowsが夏時間に対応してくれない場合（あるいは残念な対応しかしてくれない場合）、プログラムでなんとかするしかありません。幸い、C#には（夏時間を表現できる） \u003ccode\u003eTimeZoneInfo\u003c/code\u003e を作ることが出来ます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"cで日時はどうプログラムするんだっけ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#c%E3%81%A7%E6%97%A5%E6%99%82%E3%81%AF%E3%81%A9%E3%81%86%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%99%E3%82%8B%E3%82%93%E3%81%A0%E3%81%A3%E3%81%91\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eC#で日時はどうプログラムするんだっけ？\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eTimeZoneInfo\u003c/code\u003eの前に、まず復習しておきます。C#での日時の扱い方は、入門書や入門サイトで何度も何度も何度も見ていると思いますので、説明は簡単にしておきます。\u003c/p\u003e\n\n\u003cp\u003eまず、\u003cstrong\u003e\u003ccode\u003eDateTime\u003c/code\u003eはオワコン\u003c/strong\u003eなので、存在自体を忘れてください。\u003cbr\u003e\n\u003ccode\u003eDateTimeOffset\u003c/code\u003eは「日時」と「UTCからの時差」を保持したクラスです。このクラスは夏時間を考慮していません。\u003cbr\u003e\n夏時間（とUTCとの時差）の情報は\u003ccode\u003eTimeZoneInfo\u003c/code\u003eから取得します。\u003c/p\u003e\n\n\u003cp\u003e以上から、日時は、時間を表す\u003ccode\u003eDateTimeOffset\u003c/code\u003eとUTCとの時差を表す\u003ccode\u003eTimeZoneInfo\u003c/code\u003eの２つを使っていくことになります。しかし、通常日時を処理する場合、次のように\u003ccode\u003eTimeZoneInfo\u003c/code\u003eはほとんど意識していない思います。（蛇足ですが、特定の日時の\u003ccode\u003eDateTimeOffset\u003c/code\u003eを生成するとき、最後の引数を \u003ccode\u003eTimeSpan.FromHours(9)\u003c/code\u003e というように、ハードコーディングしていませんよね？）\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 現在日時\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTimeOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// -\u0026gt; 2018/08/31 11:44:04 +09:00\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// 特定の日時\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTimeOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2018\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeZoneInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLocal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUtcOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// -\u0026gt; 2018/01/02 03:04:05 +09:00\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e現在日時や特定の日時の出力結果を見て分かるように、使われている\u003ccode\u003eTimeZoneInfo\u003c/code\u003eは\u003cstrong\u003eOSのタイムゾーン\u003c/strong\u003eになっています。つまり、Windowsが日本二重夏時間（仮称）に対応してくれれば、プログラムではほとんど考慮しなくて良くなります。（実際には、ユーザーへの画面入出力とった、日本時間自体が重要な箇所においては、単に\u003ccode\u003eTimeZoneInfo\u003c/code\u003eだけ考慮すれば良い、という訳にはいかない）\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"日本二重夏時間仮称timezoneinfoを作る\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%97%A5%E6%9C%AC%E4%BA%8C%E9%87%8D%E5%A4%8F%E6%99%82%E9%96%93%E4%BB%AE%E7%A7%B0timezoneinfo%E3%82%92%E4%BD%9C%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e日本二重夏時間（仮称）TimeZoneInfoを作る\u003c/h2\u003e\n\n\u003cp\u003eWindows(Microsoft)が日本二重夏時間（仮称）に対応してくれない場合、自分で\u003ccode\u003eTimeZoneInfo\u003c/code\u003eを作る方法もあります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// (3)\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etransitionStart\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeZoneInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateFixedDateRule\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"m\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003etransitionEnd\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeZoneInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateFixedDateRule\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"m\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e31\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// (2)\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eadjustment\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeZoneInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdjustmentRule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateAdjustmentRule\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2018\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2018\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e31\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromHours\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etransitionStart\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etransitionEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// (1)\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeZoneInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreateCustomTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"Japan Double Daylight Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eTimeSpan\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromHours\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \n    \u003cspan class=\"s\"\u003e\"(UTC+09:00) Osaka, Sapporo, Tokyo\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"s\"\u003e\"Japan Standard Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"s\"\u003e\"Japan Double Daylight Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeZoneInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAdjustmentRule\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eadjustment\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// (4-1) 現在日時の場合\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enow\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTimeOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eddt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTimeZoneInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eConvertTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// -\u0026gt; 2018/08/31 13:44:05 +11:00\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// (4-2) 特定日時の場合\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edt1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTimeOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2018\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e34\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e56\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n    \u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUtcOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAdjustmentRules\u003c/span\u003e\u003cspan class=\"p\"\u003e()[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eDaylightDelta\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// -\u0026gt; 2018/09/01 12:34:56 +11:00\u003c/span\u003e\n\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edt2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2018\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e34\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e56\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//var dt2 = new DateTime(2018, 10, 1, 12, 34, 56);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsDaylightSavingTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edt2\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edt3\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTimeOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edt2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \n        \u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUtcOffset\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAdjustmentRules\u003c/span\u003e\u003cspan class=\"p\"\u003e()[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"n\"\u003eDaylightDelta\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// -\u0026gt; 2018/09/01 12:34:56 +11:00\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003edt3\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eDateTimeOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edt2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ejddtTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eBaseUtcOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// -\u0026gt; 2018/10/01 12:34:56 +09:00\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e手順は、いつものように複雑です。\u003c/p\u003e\n\n\u003cp\u003e(1) 自作\u003ccode\u003eTimeZoneInfo\u003c/code\u003e は \u003ccode\u003eTimeZoneInfo.CreateCustomTimeZone()\u003c/code\u003e メソッドで作ることが出来ます。引数の文字列の部分(４箇所)は表示上の名前です。「日本二重夏時間」の正式名称がないので、勝手に適当に命名しました。第２引数は、標準時間の場合のUTCとの時差なので、ここは \u003ccode\u003e+09:00\u003c/code\u003e を指定します。最後の引数(adjustmentRules)で、夏時間の定義をします。\u003cbr\u003e\n(2) \u003ccode\u003eTimeZoneInfo.AdjustmentRule\u003c/code\u003e は、\u003ccode\u003eTimeZoneInfo.AdjustmentRule.CreateAdjustmentRule()\u003c/code\u003e メソッドで作ることができます。第１・第２引数は、夏時間が運用される開始と終了年月日を指定します。夏時間の開始日と終了日ではありません。上のコード片では、2018年だけ夏時間が適用される例となります。第３引数は夏時間でずらす時間を指定します。二重夏時間なので、\u003ccode\u003e+2\u003c/code\u003e を指定しました。第４・第５引数は、夏時間の期間を \u003ccode\u003eTimeZoneInfo.TransitionTime\u003c/code\u003e 指定します。\u003cbr\u003e\n(3) \u003ccode\u003eTimeZoneInfo.TransitionTime\u003c/code\u003e は 夏時間の開始/終了日が固定の場合は \u003ccode\u003eCreateFixedDateRule()\u003c/code\u003e、「第２月曜日から」のように動的な場合は \u003ccode\u003eCreateFloatingDateRule()\u003c/code\u003e メソッドを使います。上のコード片では、8/1 1:00～9/31 1:00という固定日の例です。 第１引数は、適用する\u003cstrong\u003e時分秒\u003c/strong\u003eを指定します。なぜか\u003ccode\u003eDateTime\u003c/code\u003eを要求していますが、実際に使われるのは時分秒の部分だけです。そのため、上のコード片では、（使われないので）年月日を1/1/1に指定しています。第２・第３引数は夏時間の開始/終了月日を指定します。\u003c/p\u003e\n\n\u003cp\u003e(4-1) \u003ccode\u003eTimeZoneInfo\u003c/code\u003eを作ったので、現在時刻を取得してみます。\u003ccode\u003eDateTimeOffset.Now\u003c/code\u003eでは、夏時間の無い日本時間（というか、OSのタイムゾーン）になってしまうので、これを \u003ccode\u003eTimeZoneInfo.ConvertTime()\u003c/code\u003e で変換する必要があります。変換した結果は、\u003ccode\u003e+11:00\u003c/code\u003e となっているので、二重夏時間が適用されています。\u003c/p\u003e\n\n\u003cp\u003e(4-2) 特定の日時を指定する場合、\u003ccode\u003eTimeZoneInfo#BaseUtcOffset\u003c/code\u003e は標準時間とUTCとの時差だけの値であるため（\u003ccode\u003eTimeZoneInfo.AdjustmentRule\u003c/code\u003e を考慮していない値であるため）、自分で夏時間であるかの判定を行い、\u003ccode\u003eTimeZoneInfo.AdjustmentRule\u003c/code\u003e の \u003ccode\u003eDaylightDelta\u003c/code\u003e を加えるしかありません。つまり入力の場合、\u003cstrong\u003e一度\u003ccode\u003eDateTime\u003c/code\u003eで時差情報のない日時オブジェクトを作り、夏時間/通常の判定をしたあと、\u003ccode\u003eDateTimeOffset\u003c/code\u003e をインスタンス化するとき、適切な \u003ccode\u003eTimeSpan\u003c/code\u003e を指定しなければならない\u003c/strong\u003eため、とても面倒なことになります。ちなみに出力の場合は、\u003ccode\u003eTimeZoneInfo.ConvertTime()\u003c/code\u003e で変換すればいいので面倒ではありません。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"timezoneinfo-だけでは対処できなさそうなこと\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#timezoneinfo-%E3%81%A0%E3%81%91%E3%81%A7%E3%81%AF%E5%AF%BE%E5%87%A6%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%95%E3%81%9D%E3%81%86%E3%81%AA%E3%81%93%E3%81%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eTimeZoneInfo\u003c/code\u003e だけでは対処できなさそうなこと\u003c/h1\u003e\n\n\u003cp\u003e先ほどちらっと「ユーザーへの画面入(出)力といった、日本時間自体が重要な箇所においては対処できない」と書きました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"夏時間の切り替えで発生する存在しない時間と重複する時間\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%81%A7%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B%E5%AD%98%E5%9C%A8%E3%81%97%E3%81%AA%E3%81%84%E6%99%82%E9%96%93%E3%81%A8%E9%87%8D%E8%A4%87%E3%81%99%E3%82%8B%E6%99%82%E9%96%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e夏時間の切り替えで発生する、存在しない時間と重複する時間\u003c/h2\u003e\n\n\u003cp\u003e問題点の話の前に、夏時間の切り替え前後で何が起こるのか、の話を書いておきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"存在しない時間\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AD%98%E5%9C%A8%E3%81%97%E3%81%AA%E3%81%84%E6%99%82%E9%96%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e存在しない時間\u003c/h3\u003e\n\n\u003cp\u003e例えば、1:00に通常→夏時間の切り替えが発生したとすると、（1:00の１秒後が3:00:01になるのか、0:59:59の１秒後が3:00:00になるのかは分かりませんが）下絵のように1:00=3:00になり、\u003cstrong\u003e1:00～3:00が存在しない時間\u003c/strong\u003eになります。１時だと思ったら３時だった…　という状況です。この時間帯のことを、Windows界では Invalid Time と呼ぶそうです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e日本時間視点\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/c697f1363d17e88a985f893345be1eecf4710733/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f38383065346531332d646135632d326665382d376431362d6232616263663830346566392e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F880e4e13-da5c-2fe8-7d16-b2abcf804ef9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=32557f057c3155419b218e15f26e44cd\" alt=\"2018-08-30_164130.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/208281/880e4e13-da5c-2fe8-7d16-b2abcf804ef9.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F880e4e13-da5c-2fe8-7d16-b2abcf804ef9.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=b8e5a13ea685a720a6194e90c914c37d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUTC視点\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/221f71752053eb80edf812a77130866ac4a41f23/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f64383162323732342d653535612d323766362d386331382d6362306235353032383438302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fd81b2724-e55a-27f6-8c18-cb0b55028480.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=90e0b8a06751629ee5a026cc67389675\" alt=\"2018-08-30_164209.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/208281/d81b2724-e55a-27f6-8c18-cb0b55028480.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fd81b2724-e55a-27f6-8c18-cb0b55028480.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=cdf3a69dedeb9b3dd518c4eea8a212af 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"重複する時間\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%87%8D%E8%A4%87%E3%81%99%E3%82%8B%E6%99%82%E9%96%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e重複する時間\u003c/h3\u003e\n\n\u003cp\u003e逆に夏時間→通常に切り替えのときは、同じ時間が繰り返されます。例えば 3:00 に切り替えがおきたとすると、下絵のように、1:00～3:00が２回発生します。Windows界では、この時間帯を Ambiguous Time と呼びます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e日本時間視点\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/1cd69bccba568892960aa224ed017296b8447f8e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f35346233323433312d633232302d343139362d396361612d6435346638663462616265352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F54b32431-c220-4196-9caa-d54f8f4babe5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e9723bbbb7284b0574219b4a2d08c083\" alt=\"2018-08-30_165317.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/208281/54b32431-c220-4196-9caa-d54f8f4babe5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F54b32431-c220-4196-9caa-d54f8f4babe5.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=3f52545e6d1b17013bd3b0003ee08a6f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUTC視点\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/33768577971cd53821c4dec84e985c4f7c7ed4ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230383238312f37343436376531362d303962362d623437382d343433382d3862616131666165663532372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F74467e16-09b6-b478-4438-8baa1faef527.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6e4f6f2e58dd57f659488defde21df31\" alt=\"2018-08-30_165340.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/208281/74467e16-09b6-b478-4438-8baa1faef527.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2F74467e16-09b6-b478-4438-8baa1faef527.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e51aec91c5961a2c09c4f554a1524856 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"問題点は\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%95%8F%E9%A1%8C%E7%82%B9%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e問題点は？\u003c/h3\u003e\n\n\u003cp\u003e日時の入力で特定の値を指定された場合、夏時間か通常の時間かの判定を自前でやらなければならない、と書きましたが、それだけではなく、Skipされている時間(Invalid Time)なのか重複する時間なのか(Ambiguous Time)の判定も必要になり、さらにエラー処理も増えるということです。\u003c/p\u003e\n\n\u003cp\u003e以下、私がとっさに思いついた問題が起こりそうな箇所を上げてみたいと思います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"時間で検索\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%99%82%E9%96%93%E3%81%A7%E6%A4%9C%E7%B4%A2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e時間で検索\u003c/h2\u003e\n\n\u003cp\u003e例えばユーザーが自分のアクセス履歴を見るために、0:30-1:30という時間の範囲指定で検索をしたとしましょう。夏時間→通常の切り替えが 1:00 にある場合、この「1:30」が夏時間中の「1:30(UTC+11:00)」なのか、通常の「1:30(UTC+09:00)」なのか区別が付きません。これに対応するには、画面に「サマータイム？」のチェックボックスを用意するしかないでしょう。つまり、画面の修正と入力項目が１つ増えることになります。\u003c/p\u003e\n\n\u003cp\u003e時間入力のエラーチェックも増えます。通常→夏時間の切り替えが 1:00 にある場合、1:00＝3:00になるので、つまり1:01～2:59は存在しない時間になるので、0:30-1:30という検索条件は、時間不正のエラーにする必要があります。0:00～23:59以外で時間の入力値チェックなんてしていないでしょうから、時間入力のある画面/APIにチェックを増やしていく作業が発生します。\u003c/p\u003e\n\n\u003cp\u003eいちおうC#には、日時がサマータイムでスキップされている時間であるか（\u003ccode\u003eTimeZoneInfo#IsInvalidTime\u003c/code\u003e ）、重複している時間であるか（\u003ccode\u003eTimeZoneInfo#IsAmbiguousTime\u003c/code\u003e ）を調べるメソッドがあります。しかしスキップされる時間範囲と重複する時間範囲を取得するメソッドはありません（簡単に作れますが）。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"データベースの時間\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E6%99%82%E9%96%93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデータベースの時間\u003c/h2\u003e\n\n\u003cp\u003e時間を格納している型がUTCか、UTCからの時差も含めて格納しているなら、問題なさそうです。しかし、\"20190102030405\"にように、日本時間を文字列で入れてしまっている場合、問題です。日付型に変換するか、文字列のままにするがUTCにするかしかなさそうです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"１時間後の処理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%EF%BC%91%E6%99%82%E9%96%93%E5%BE%8C%E3%81%AE%E5%87%A6%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e「１時間後」の処理\u003c/h2\u003e\n\n\u003cp\u003e0:30の１時間後が1:30ではななく3:30の場合があるので、ただ「足す」だけでは問題が起こる場合があります。もし、アプリケーション内部では時間はすべてUTCで扱っているなら、何の問題もありません。文字通り「足せ」ばいいだけです。\u003ccode\u003eDateTimeOffset\u003c/code\u003e は日時とUTCとの時差を持っているため、通常/夏時間の切り替わりは考えなくても大丈夫です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csharp\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"with-code\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// 現在時刻の１時間後(夏時間考慮込み)\u003c/span\u003e\n\u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003enow1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDateTimeOffset\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddHours\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// 結局出力は(自作した)TimeZoneInfoで変換するので、DateTimeOffsetなら問題ない\u003c/span\u003e\n\u003cspan class=\"n\"\u003ejddstTimeZone\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eConvertTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enow1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eサマータイムの設定はOS(Windows)に行われるのであり、プログラムやアプリケーションにするものではない。\u003c/li\u003e\n\u003cli\u003e現状（2018年8月時点）では、Windowsに日本のタイムゾーンはサマータイムの設定はない。しかし、Microsoftはサマータイムの設定をできるようにしてくれるかもしれない。\u003c/li\u003e\n\u003cli\u003eC#のプログラムでは、\u003ccode\u003eDateTimeOffset\u003c/code\u003e \u0026amp; \u003ccode\u003eTimeZoneInfo\u003c/code\u003e を使えば、とりあえずサマータイムの対処はできるようになる。逆に \u003ccode\u003eDateTime\u003c/code\u003e を使っていると、酷いことになる。\u003c/li\u003e\n\u003cli\u003eWindowsでサマータイムの設定ができるようにならない場合は、自分で「日本二重夏時間」を表す \u003ccode\u003eTimeZoneInfo\u003c/code\u003e を作ることが出来る。\u003c/li\u003e\n\u003cli\u003eそれでも外部からの入力値がある場合、自分で夏時間/通常の判定をしなければならないし、不正な時間であるかの判定とエラー処理も加える必要がある。\u003c/li\u003e\n\u003cli\u003eデータベースや時間指定の検索など、日時を使うシステムは、内部ではUTCにしておくのが無難。\u003c/li\u003e\n\u003cli\u003e\u003cdel\u003eシステム内部で（サマータイムの無い）UTCで時間を扱うなら、サマータイムなんていらないじゃん\u003c/del\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e最後に、OSの時間を２時間進める/遅らせるだけ、という対応はやめたほうがいいでしょう。アプリケーションが乗っているサーバーは、大抵NTPで時刻同期をしているでしょうから…\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考文献サイト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E3%82%B5%E3%82%A4%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考文献・サイト\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.slideshare.net/atsushikambara/handling-globaldatetime-27589220\" rel=\"nofollow noopener\" target=\"_blank\"\u003e日時の問題とC#での扱い方の話\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e時差の話がメインのようですが、夏時間の話もあります。C#の話に特化しているため、C#のプログラマーなら一読の価値はあります。スライドショーなので30分程度で全部読めますし。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://msdn.microsoft.com/ja-jp/library/system.timezoneinfo(v=vs.110).aspx\" rel=\"nofollow noopener\" target=\"_blank\"\u003eMicrosoftのドキュメント\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ccode\u003eTimeZoneInfo\u003c/code\u003eの使い方なんて、慣れている人はいないでしょうから、一度は見ておいたほうがいいでしょう。\u003c/p\u003e\n","createdAt":"2018-08-31T09:20:10Z","elapsedYearsFromLastModifiedAt":3,"encryptedId":"jPwR+xDBetFJzK8Orykv7cvjcOSLf8AS--xzzqSS5w8KO6+VfB--9JkuoQsUJ8uzr00XXgF8Lw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"lastModifiedAt":"2018-08-31T09:20:10Z","likesCount":17,"linkUrl":"https://qiita.com/rawr/items/f18d8a9fdf0ca74ba48c","organization":null,"originalId":685239,"stockedCount":5,"title":"サマータイムに対応したかった（Windows+C#編）","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#windows%E3%81%AF%E3%81%A9%E3%81%AE%E7%A8%8B%E5%BA%A6%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AB%E5%AF%BE%E5%BF%9C%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B\"\u003eWindowsはどの程度夏時間に対応している？\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#windows%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003eWindowsにおける夏時間の設定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#microsoft%E3%81%AF%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E5%AF%BE%E5%BF%9C%E3%82%92%E3%81%97%E3%81%A6%E3%81%8F%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8B\"\u003eMicrosoftは夏時間の対応をしてくれるのか\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#c%E3%81%A7%E5%A4%8F%E6%99%82%E9%96%93%E3%82%92%E6%89%B1%E3%81%86\"\u003eC#で夏時間を扱う\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#c%E3%81%A7%E6%97%A5%E6%99%82%E3%81%AF%E3%81%A9%E3%81%86%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%99%E3%82%8B%E3%82%93%E3%81%A0%E3%81%A3%E3%81%91\"\u003eC#で日時はどうプログラムするんだっけ？\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%97%A5%E6%9C%AC%E4%BA%8C%E9%87%8D%E5%A4%8F%E6%99%82%E9%96%93%E4%BB%AE%E7%A7%B0timezoneinfo%E3%82%92%E4%BD%9C%E3%82%8B\"\u003e日本二重夏時間（仮称）TimeZoneInfoを作る\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#timezoneinfo-%E3%81%A0%E3%81%91%E3%81%A7%E3%81%AF%E5%AF%BE%E5%87%A6%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%95%E3%81%9D%E3%81%86%E3%81%AA%E3%81%93%E3%81%A8\"\u003eTimeZoneInfo だけでは対処できなさそうなこと\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%A4%8F%E6%99%82%E9%96%93%E3%81%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88%E3%81%A7%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B%E5%AD%98%E5%9C%A8%E3%81%97%E3%81%AA%E3%81%84%E6%99%82%E9%96%93%E3%81%A8%E9%87%8D%E8%A4%87%E3%81%99%E3%82%8B%E6%99%82%E9%96%93\"\u003e夏時間の切り替えで発生する、存在しない時間と重複する時間\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AD%98%E5%9C%A8%E3%81%97%E3%81%AA%E3%81%84%E6%99%82%E9%96%93\"\u003e存在しない時間\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%87%8D%E8%A4%87%E3%81%99%E3%82%8B%E6%99%82%E9%96%93\"\u003e重複する時間\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%95%8F%E9%A1%8C%E7%82%B9%E3%81%AF\"\u003e問題点は？\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%99%82%E9%96%93%E3%81%A7%E6%A4%9C%E7%B4%A2\"\u003e時間で検索\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E6%99%82%E9%96%93\"\u003eデータベースの時間\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%EF%BC%91%E6%99%82%E9%96%93%E5%BE%8C%E3%81%AE%E5%87%A6%E7%90%86\"\u003e「１時間後」の処理\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eまとめ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E3%82%B5%E3%82%A4%E3%83%88\"\u003e参考文献・サイト\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":6124,"uuid":"f18d8a9fdf0ca74ba48c","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"1zInz1HLFuug4SIifFKUp7g69tSD--ulcM2BhYRndze7F+--k37JMjwHvoNITR6h4MlvIg==","originalId":208281,"description":"","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/208281/profile-images/1509075346","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fprofile-images%2F1509075346?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=34f7d7b8ec2bccee50d775828471173b","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F208281%2Fprofile-images%2F1509075346?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=b1e10ed34e8843471d132ef8abecbc16","urlName":"rawr","websiteUrl":null,"twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[{"node":{"encryptedId":"m2AG/fS1rgYf5GISLVacdMtUcGoPy6qwiB0=--UEtosYJkR27qPkc/--XITcQwL2F5WqN7pDJShN4w==","isBetaReleaseEnabled":false,"isFollowableByViewer":false,"isFollowedByViewer":false,"name":"株式会社野村総合研究所","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/2d2d149e908ace5e18742b0ffb417dc5d3426102/original.jpg?1606747309","urlName":"nri","description":"NRIは「コンサルティング」「金融 ITソリューション」「産業 ITソリューション」「IT 基盤サービス」の4事業でお客様のビジネスや快適な社会、暮らしを支えています。※各記事の内容は個人の見解であり、所属する組織の公式見解ではありません。","url":"https://www.nri.com/jp/"}}]}},"tags":[{"name":"C#","urlName":"csharp"},{"name":"サマータイム","urlName":"%e3%82%b5%e3%83%9e%e3%83%bc%e3%82%bf%e3%82%a4%e3%83%a0"}],"followingLikers":{"edges":[]},"comments":{"totalCount":5}},"comments":[],"client":null,"ads_event_emitter":null}}</script>
