More than 3 years have passed since last update.需要があるかわからないですが、C#でVPN接続する忘備録。
時間が経っているのでうろ覚え。。。C#って、こういう処理はすっごい簡単にできそうなんだけど
このVPNに関して言えば、それっぽいWIN　APIとかもなくて
とにかく困りました。softether　でVPNサーバーをたててWINアプリからそこにVPN接続したいと考えたんだけど
これがなかなかうまくいかない。
接続方式とか指定しなければもっと簡単に接続できるはずだが、
L2TP over IPsecの事前共有キーありの接続をするのが結構難しかった。参照でDotRasが必要だった気がする。
結構調べたが情報が古いものが多く、かなり調べると中華系のコミュニティで情報を発見。
で、色んな情報を組み合わせて試行錯誤したけどVISTAぐらいの時代に書かれたソースなので
Win8、Win10で動かないっぽかった。
そっからアレコレ更に試行錯誤してコード調整した記憶がある。下記はソース（クラス）。クッソ長い。呼び出すときはで、アプリ終了タイミングなど適切なタイミングでVPNを切断する場合は下記のようにする。

VPNAPI.rasDisConnectVPN('接続名'); 
正直よくわからん。


