More than 1 year has passed since last update..NET Framewokrk版のUIAutomationClientを使いましょう！
C++などから利用するCOM実装のUIAutomationや.NET Core版のUIAutomationではうまく動きません個人で開発している ExpTabBarというエクスプローラーにタブを付けるシェル拡張を開発している最中、タブ切り替え時にスクロール位置を復元する機能を実装しようと思い試行錯誤していたご存じの通りWindows10になってからのエクスプローラーのファイルビューは、ListViewなどの標準コンポーネントが使用されておらず　独自実装のウィンドウとなっており スクロールバーなどのUI部品から ウィンドウハンドルを取得できなくなっているウィンドウハンドルが取得できないのならどうしようといろいろ調べた結果
Windowsに標準実装されているUIAutomationという機能を使えばいいことが分かり
それではさっそくとUI Spyを使ってスクロールバーのElementを調査し、スクロール位置の取得と、RangeValuePatternを使ってスクロール位置の変更が確認できたので、自分のアプリケーションに実装してみたのだがget_CurrentValueで取れる値が、UISpyと異なり
さらにSetValueでスクロール位置の変更が効かなかった(UISpyでは変更できた)なんで動かねえんだよくそがあああああああああああああああああああああああああああああああああああああああああああああああああああああああああああああああああと、何十時間もの調査の結果
自分のコードでUIElementから取得したAutomationIdが"NonClientVerticalScrollBar"なのに対して、UISpyで表示されるAutomationIdが"Vertical ScrollBar"なことに気づく
googleでぐぐってみると以下のURLにたどり着いた
https://www.csharpcodi.com/csharp-examples/FlaUI.Core.Conditions.ConditionFactory.ByAutomationId(string)/UIA2とUIA3では同じように違っていた、
この違いが動かない原因なのでは...と、FlaUIというライブラリを調べて調査した結果が、結論に記したことであるちょっとマイクロソフトさん同じUIAutomationなのに、使ってるライブラリの違いで動くとか動かないとかいうバグを作るのはやめてくださいてっきり.NET版のUIAutomationCoreはCOM版のラッパーだと思ってたのに、こんな結果になるとは思わなかった同じ.NETでも.NET Coreの
using UIAutomationClient;
と書いて利用するUIAutomationは正常に動作しません正常に動作するC#版のソース
UIAutomationClientとUIAutomationTypesを参照に追加してね


