More than 1 year has passed since last update.WPFでDataGridの各セルを数値に応じて色付けする方法についてまとめます。
Excelで言うところの条件付き書式ルールのような表示です。下記画像はイメージです。
以下の流れで説明します。各セルに表示する情報と色をまとめたクラスを作成し、二次元配列として定義します。今回は色指定をViewModelで行いましたが、色指定のルールが単一であれば、Viewに色管理を任せた方がスッキリすると思います。初期値のGetSortedData()では、乱数により行列数を決めて、1から順にセル値を設定しています。（割愛）ItemsSourceの更新に合わせてセル色も更新するため、DataGridを継承したコントロールを定義し、OnItemsSourceChanged() をoverrideします。この辺りのBindingはxamlに押し込みたかったのですが、今の私には何ともできませんでした…　スマートな実装あればご教授下さいませ。自作コントロールのItemsSourceにViewModelの二次元配列をBindingします。（Converterは後述）ポイントは『AutoGenerateColumns="False"』で、Column追加をオートに任せず、コードビハインドにより自力で対応しています。その他諸々のプロパティはええ感じに変更して下さい。自作コントロールでデータを扱うため、二次元配列を行単位にまとめます。対応は以上です。Reflashボタンをクリックすると行列数がランダムに変化し、セルの値に応じて色が変わっています。セル色は行列数により正規化しているので、常に左上(最小値)と右下(最大値)は同じ色になっています。WPFのDataGridセルをExcelのように数値に応じて色付けする方法を紹介しました。xamlのみで実装できなかった（コードビハインドを使っちゃた）のは少し悔しいのですが、やりたいことは実現できたので良しとします。ソースコードはGithubにて公開しています。hsytkm/ColoredDataGridCellVisual Studio Community 2019
.NET Framework 4.6.1


