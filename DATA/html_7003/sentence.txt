More than 3 years have passed since last update.例として、以下のような「商品」クラスがあるとして商品コードと商品名で重複を除去して集計するには以下のようになる。なんだか若干分かりにくいが、上記のようにGroupBy、Select、FirstOrDefaultを組み合わせるとできる。
どうやらIGroupingインターフェイスをFirstOrDefaultすると最初のデータが取得されるらしい。
LINQ to ObjectsでもLINQ to EntitiesでもOK。
ちなみにEntity Frameworkの場合、LINQPadでSQLを確認すると以下のようなSQLが発行されている。※DISTINCTしたテーブルをOUTER APPLYしてSELECT TOP 1。
　うーん、あんまり見慣れない感じのSQLだけど集計効率的にはどうなのだろうか・・・あるデータに子要素が複数あって1件だけ取得したい場合も同様の実装で実現できる。
以下のようなUserクラスを内包するLoginクラスがあり、同じユーザーのレコードが複数あるとして、
※Userクラスの中身は割愛Userごとの1件分のLoginを取得するコードは以下のようになる。


