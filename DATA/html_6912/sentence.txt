More than 1 year has passed since last update.以前に Delphi で Windows コントロールパネルのアプレットを作成しました。
これを VB.NET で作り直せないかと思っていました。でもちゃんと作るのは面倒そうなんですね。そんなとき次の記事を見つけました。
How to Register Executable Control Panel Items (Windows)通常の実行ファイルをコントロールパネルに登録できるんですね。
アプレットでなくてこれでいいんじゃないかな。
これを参考にしてプログラムを書いてみました。通常のアプリケーションプログラムを作成します。
その実行ファイルがコントロールパネルのアイテムとして登録できるようにします。まず、「Windows フォーム アプリケーション」のプロジェクトを作成します。プロジェクトに「クラス」を新規追加します。ここではクラス名を「Register」にします。以下の属性を指定しておきます。作成しているアプリケーションプログラムが COM サーバとして登録できるようにします。まず、アセンブリを COM 参照可能にします。以下の手順で作業します。プロジェクトの「プロパティ」を開く。
「アプリケーション」タブを選択。
「アセンブリ情報」を押下。
ダイアログボックスで「アセンブリを COM 参照可能にする」にチェック。次に、アセンブリに署名します。以下の手順で作業します。プロジェクトの「プロパティ」を開く。
「署名」タブを選択。
「アセンブリに署名する」をチェック。
「厳密な名前のキーファイルを選択」で「新規作成」を選択。
ダイアログボックスで「キーファイル名」に任意のファイル名を指定。
「キーファイルをパスワードで保護する」は必須ではない。クラスに GUID を設定します。
GUID はクラスごとに新規作成して下さい。GUID を作成するのはこちら
Create GUID Tool in Visual Studio - TechNet Articles - United States (English) - TechNet Wiki登録および解除のためのメソッドを実装します。ビルドするとアセンブリファイルが作成されます。これを COM サーバとして Windows に登録します。C# または VB.NET で作成したアセンブリファイルを COM サーバとして登録するには、.NET Framework に同梱されている「regasm」ツールを使います。こんな記事を見かけました。ついに！Windows 10から｢コントロールパネル｣が消える | ギズモード・ジャパンこれが本当になると、この記事も意味なくなってしまいますね。


