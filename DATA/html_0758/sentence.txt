以前の以下の投稿で、.NET Core 1.1 での ASP.NET Core において appsettings.json からの値取得の方法を説明しました。今回は、.NET Core 3.1 での ASP.NET Core において、appsettings.json からの値取得の方法を説明します。
基本的な方法はほとんど同じです。appsettings.json を以下のように定義したとします。何もしなくても構成情報は、依存性の注入がされているので、コントローラーから、構成情報を IConfiguration で取得できます。前回の記事でも触れましたが、構成情報をクラスにバインドして、そこから取得した方が可読性があがりますね。JSON の定義に対応するクラスを定義します。
前回も説明しましたが、Visual Studio からクラス ファイルを追加し、JSON ファイルの文字列をコピーして、[編集] - [形式を選択して貼り付け] - [JSON をクラスとして貼り付ける] を選択すると、クラスの定義をペースト出来るので便利です。次に、StartUp.ConfigureServices からサービス コレクション経由で構成情報を注入します。これで、コントローラーから、注入した構成情報を取得できます。固有のクラス経由で構成情報を取得した方が、やはり可読性があがりますね。


