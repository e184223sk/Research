More than 1 year has passed since last update.gRPC ではリクエスト／レスポンスのデータサイズに上限があります。既定値は4MBです。
上限を変更することはできますが、データサイズが不定である場合はストリームを用いることが一般的です。リクエスト／レスポンスの一つ一つが上限を超えなければサイズ超過エラーは発生しません。この方法を採用しても、リクエスト／レスポンスの一つ一つのデータサイズが上限を超える場合はサイズ超過エラーが発生します。次のような場合の実装を考えてみました。今回は ProtocolBuffers で定義しました。bytes 型を使用しています。取得した画像のデータを1KBずつクライアントに送信しています。レスポンスとして受け取ったバイトデータをストリームに格納し、Eof を受け取った時点で画像を生成しています。


