需要があるかは知らないけれど、Apache POIでMicrosoft Word文書を操作できます。
普通はOLEやらマクロやらを使うけれど、POIでも操作できます。POIはJavaのライブラリですが、今回はC#用のNPOIでWord文書を操作してみました。まず、なにはともあれ新規プロジェクトを作成します。
VisualStudio2019を使って、コンソールアプリケーションを作成しました。
次に、NugetでNPOIを参照します。
そしてコードを書きましょう。
今回は
1. 新規ファイル作成
2. テキストを追加
3. 名前をつけて保存というシンプルなものを作成します。
本来はクラス化するのが良いですが、サンプルのため1ファイルにベタ書きします。XWPFDocumentインスタンスを生成します。
XWPFDocumentは拡張子がdocx、HWPFDocumentはdocです。
引数にFileStreamを渡すと、既存ファイルを開くことができます。Paragraph(段落)を追加します。Run(文字の塊)を追加します。Runの文字列を「テスト」にします。
これまた例文のセンスが無い。。。もうひとつRunを追加して、文字列を「モード」にします。
Runのフォントサイズを大きく太字にしてやります。ここまで設定したら、保存を行います。
書き込み用のFileStreamを用意して、保存します。保存されたファイルを開くと、無事に指定した文字が入っていることがわかります。
(「モード」の主張が強い！)
今回はものすごくシンプルに文字を入れるだけの超カンタンな操作でした。
実際は表挿入などもっといろいろなことができます。
いつかまたもう少し掘り下げたものを書こうと思います。


